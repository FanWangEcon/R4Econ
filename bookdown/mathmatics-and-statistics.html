<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Mathmatics and Statistics | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="Use Python in R with Reticulate" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Mathmatics and Statistics | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Use Python in R with Reticulate" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Mathmatics and Statistics | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="Use Python in R with Reticulate" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2020-09-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="optimization.html"/>
<link rel="next" href="tables-and-graphs.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Panel Data and Optimization with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#multiple-dimensional-list"><i class="fa fa-check"></i><b>1.1.1</b> Multiple Dimensional List</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-values"><i class="fa fa-check"></i><b>1.4.5</b> String Values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.1</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.2</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.3</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>4</b> Panel</a>
<ul>
<li class="chapter" data-level="4.1" data-path="panel.html"><a href="panel.html#generate-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="panel.html"><a href="panel.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="panel.html"><a href="panel.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="panel.html"><a href="panel.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="panel.html"><a href="panel.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="panel.html"><a href="panel.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.1</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.1.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.1.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.2</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.2.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>6</b> Nonlinear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html"><i class="fa fa-check"></i><b>8</b> Mathmatics and Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#distributions"><i class="fa fa-check"></i><b>8.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>8.1.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#analytical-solutions"><i class="fa fa-check"></i><b>8.2</b> Analytical Solutions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.2.1</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> Gini Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.2</b> Atkinson Inequality Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>9</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>9.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>9.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>9.2</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>9.2.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>10</b> Get Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>10.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>10.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="code-and-development.html"><a href="code-and-development.html"><i class="fa fa-check"></i><b>11</b> Code and Development</a>
<ul>
<li class="chapter" data-level="11.1" data-path="code-and-development.html"><a href="code-and-development.html#file-in-and-out"><i class="fa fa-check"></i><b>11.1</b> File in and Out</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="code-and-development.html"><a href="code-and-development.html#text-to-file"><i class="fa fa-check"></i><b>11.1.1</b> Text to File</a></li>
<li class="chapter" data-level="11.1.2" data-path="code-and-development.html"><a href="code-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>11.1.2</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="code-and-development.html"><a href="code-and-development.html#python-with-r"><i class="fa fa-check"></i><b>11.2</b> Python with R</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="code-and-development.html"><a href="code-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>11.2.1</b> Reticulate Basics</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#panel-links"><i class="fa fa-check"></i><b>A.4</b> Panel links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-and-joingenerate-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-regression-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear Regression links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Quantile Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathmatics-and-statistics-links"><i class="fa fa-check"></i><b>A.8</b> Mathmatics and Statistics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Distributions</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-analytical-solutionsanalytical-solutions-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Analytical Solutions</span> links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> <span>Section 8.3 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.9</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.9.2</b> <span>Section 9.2 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.10</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#code-and-development-links"><i class="fa fa-check"></i><b>A.11</b> Code and Development links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-file-in-and-outfile-in-and-out-links"><i class="fa fa-check"></i><b>A.11.1</b> <span>Section 11.1 File in and Out</span> links</a></li>
<li class="chapter" data-level="A.11.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.2-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.11.2</b> <span>Section 11.2 Python with R</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mathmatics-and-statistics" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Mathmatics and Statistics</h1>

<div id="distributions" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Distributions</h2>

<div id="integrate-over-normal-guassian-process-shock" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Integrate Over Normal Guassian Process Shock</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>Some Common parameters</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="mathmatics-and-statistics.html#cb401-1" aria-hidden="true"></a>fl_eps_mean =<span class="st"> </span><span class="dv">10</span></span>
<span id="cb401-2"><a href="mathmatics-and-statistics.html#cb401-2" aria-hidden="true"></a>fl_eps_sd =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb401-3"><a href="mathmatics-and-statistics.html#cb401-3" aria-hidden="true"></a>fl_cdf_min =<span class="st"> </span><span class="fl">0.000001</span></span>
<span id="cb401-4"><a href="mathmatics-and-statistics.html#cb401-4" aria-hidden="true"></a>fl_cdf_max =<span class="st"> </span><span class="fl">0.999999</span></span>
<span id="cb401-5"><a href="mathmatics-and-statistics.html#cb401-5" aria-hidden="true"></a>ar_it_draws &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span></code></pre></div>
<div id="randomly-sample-and-integrate-monte-carlo-integration" class="section level4" number="8.1.1.1">
<h4><span class="header-section-number">8.1.1.1</span> Randomly Sample and Integrate (Monte Carlo Integration)</h4>
<p>Compare randomly drawn normal shock mean and known mean. How does simulated mean change with draws. Actual integral equals to <span class="math inline">\(10\)</span>, as sample size increases, the sample mean approaches the integration results, but this is expensive, even with ten thousand draws, not very exact.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="mathmatics-and-statistics.html#cb402-1" aria-hidden="true"></a><span class="co"># Simulate Draws</span></span>
<span id="cb402-2"><a href="mathmatics-and-statistics.html#cb402-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb402-3"><a href="mathmatics-and-statistics.html#cb402-3" aria-hidden="true"></a>ar_fl_means &lt;-</span>
<span id="cb402-4"><a href="mathmatics-and-statistics.html#cb402-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb402-5"><a href="mathmatics-and-statistics.html#cb402-5" aria-hidden="true"></a>    <span class="kw">return</span>(<span class="kw">mean</span>(<span class="kw">rnorm</span>(x[<span class="dv">1</span>], <span class="dt">mean=</span>fl_eps_mean, <span class="dt">sd=</span>fl_eps_sd))))</span>
<span id="cb402-6"><a href="mathmatics-and-statistics.html#cb402-6" aria-hidden="true"></a>ar_fl_sd &lt;-</span>
<span id="cb402-7"><a href="mathmatics-and-statistics.html#cb402-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb402-8"><a href="mathmatics-and-statistics.html#cb402-8" aria-hidden="true"></a>    <span class="kw">return</span>(<span class="kw">sd</span>(<span class="kw">rnorm</span>(x[<span class="dv">1</span>], <span class="dt">mean=</span>fl_eps_mean, <span class="dt">sd=</span>fl_eps_sd))))</span>
<span id="cb402-9"><a href="mathmatics-and-statistics.html#cb402-9" aria-hidden="true"></a></span>
<span id="cb402-10"><a href="mathmatics-and-statistics.html#cb402-10" aria-hidden="true"></a>mt_sample_means &lt;-<span class="st"> </span><span class="kw">cbind</span>(ar_it_draws, ar_fl_means, ar_fl_sd)</span>
<span id="cb402-11"><a href="mathmatics-and-statistics.html#cb402-11" aria-hidden="true"></a><span class="kw">colnames</span>(mt_sample_means) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb402-12"><a href="mathmatics-and-statistics.html#cb402-12" aria-hidden="true"></a>tb_sample_means &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_sample_means)</span>
<span id="cb402-13"><a href="mathmatics-and-statistics.html#cb402-13" aria-hidden="true"></a></span>
<span id="cb402-14"><a href="mathmatics-and-statistics.html#cb402-14" aria-hidden="true"></a><span class="co"># Graph</span></span>
<span id="cb402-15"><a href="mathmatics-and-statistics.html#cb402-15" aria-hidden="true"></a><span class="co"># x-labels</span></span>
<span id="cb402-16"><a href="mathmatics-and-statistics.html#cb402-16" aria-hidden="true"></a>x.labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb402-17"><a href="mathmatics-and-statistics.html#cb402-17" aria-hidden="true"></a>x.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb402-18"><a href="mathmatics-and-statistics.html#cb402-18" aria-hidden="true"></a></span>
<span id="cb402-19"><a href="mathmatics-and-statistics.html#cb402-19" aria-hidden="true"></a><span class="co"># Shared Subtitle</span></span>
<span id="cb402-20"><a href="mathmatics-and-statistics.html#cb402-20" aria-hidden="true"></a>st_subtitle &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb402-21"><a href="mathmatics-and-statistics.html#cb402-21" aria-hidden="true"></a>                      <span class="st">&#39;R4Econ/math/integration/htmlpdfr/fs_integrate_normal.html&#39;</span>)</span>
<span id="cb402-22"><a href="mathmatics-and-statistics.html#cb402-22" aria-hidden="true"></a></span>
<span id="cb402-23"><a href="mathmatics-and-statistics.html#cb402-23" aria-hidden="true"></a><span class="co"># Shared Labels</span></span>
<span id="cb402-24"><a href="mathmatics-and-statistics.html#cb402-24" aria-hidden="true"></a>slb_title_shr =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;as Sample Size Increases</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb402-25"><a href="mathmatics-and-statistics.html#cb402-25" aria-hidden="true"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb402-26"><a href="mathmatics-and-statistics.html#cb402-26" aria-hidden="true"></a>slb_xtitle =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Sample Size&#39;</span>)</span>
<span id="cb402-27"><a href="mathmatics-and-statistics.html#cb402-27" aria-hidden="true"></a></span>
<span id="cb402-28"><a href="mathmatics-and-statistics.html#cb402-28" aria-hidden="true"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb402-29"><a href="mathmatics-and-statistics.html#cb402-29" aria-hidden="true"></a>plt_mean &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb402-30"><a href="mathmatics-and-statistics.html#cb402-30" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>mean)) <span class="op">+</span></span>
<span id="cb402-31"><a href="mathmatics-and-statistics.html#cb402-31" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb402-32"><a href="mathmatics-and-statistics.html#cb402-32" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Sample Mean &#39;</span>, slb_title_shr),</span>
<span id="cb402-33"><a href="mathmatics-and-statistics.html#cb402-33" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb402-34"><a href="mathmatics-and-statistics.html#cb402-34" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb402-35"><a href="mathmatics-and-statistics.html#cb402-35" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Sample Mean&#39;</span>,</span>
<span id="cb402-36"><a href="mathmatics-and-statistics.html#cb402-36" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Mean of Sample Integrates to True Mean&#39;</span>) <span class="op">+</span></span>
<span id="cb402-37"><a href="mathmatics-and-statistics.html#cb402-37" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb402-38"><a href="mathmatics-and-statistics.html#cb402-38" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb402-39"><a href="mathmatics-and-statistics.html#cb402-39" aria-hidden="true"></a><span class="kw">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-190-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="mathmatics-and-statistics.html#cb403-1" aria-hidden="true"></a>plt_sd &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb403-2"><a href="mathmatics-and-statistics.html#cb403-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>sd)) <span class="op">+</span></span>
<span id="cb403-3"><a href="mathmatics-and-statistics.html#cb403-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb403-4"><a href="mathmatics-and-statistics.html#cb403-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Sample Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb403-5"><a href="mathmatics-and-statistics.html#cb403-5" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb403-6"><a href="mathmatics-and-statistics.html#cb403-6" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb403-7"><a href="mathmatics-and-statistics.html#cb403-7" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Sample Standard Deviation&#39;</span>,</span>
<span id="cb403-8"><a href="mathmatics-and-statistics.html#cb403-8" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Standard Deviation of Sample Integrates to True SD&#39;</span>) <span class="op">+</span></span>
<span id="cb403-9"><a href="mathmatics-and-statistics.html#cb403-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb403-10"><a href="mathmatics-and-statistics.html#cb403-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb403-11"><a href="mathmatics-and-statistics.html#cb403-11" aria-hidden="true"></a><span class="kw">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-190-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-symmetric-uneven-rectangle" class="section level4" number="8.1.1.2">
<h4><span class="header-section-number">8.1.1.2</span> Integration By Symmetric Uneven Rectangle</h4>
<p>Draw on even grid from close to 0 to close to 1. Get the corresponding x points to these quantile levels. Distance between x points are not equi-distance but increasing and symmetric away from the mean. Under this approach, each rectangle aims to approximate the same area.</p>
<p>Resulting integration is rectangle based, but rectangle width differ. The rectangles have wider width as they move away from the mean, and thinner width close to the mean. This is much more stable than the random draw method, but note that it converges somewhat slowly to true values as well.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="mathmatics-and-statistics.html#cb404-1" aria-hidden="true"></a>mt_fl_means &lt;-</span>
<span id="cb404-2"><a href="mathmatics-and-statistics.html#cb404-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb404-3"><a href="mathmatics-and-statistics.html#cb404-3" aria-hidden="true"></a></span>
<span id="cb404-4"><a href="mathmatics-and-statistics.html#cb404-4" aria-hidden="true"></a>    fl_prob_break =<span class="st"> </span>(fl_cdf_max <span class="op">-</span><span class="st"> </span>fl_cdf_min)<span class="op">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb404-5"><a href="mathmatics-and-statistics.html#cb404-5" aria-hidden="true"></a>    ar_eps_bounds &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">seq</span>(fl_cdf_min, fl_cdf_max,</span>
<span id="cb404-6"><a href="mathmatics-and-statistics.html#cb404-6" aria-hidden="true"></a>                               <span class="dt">by=</span>(fl_cdf_max <span class="op">-</span><span class="st"> </span>fl_cdf_min)<span class="op">/</span>(x[<span class="dv">1</span>])),</span>
<span id="cb404-7"><a href="mathmatics-and-statistics.html#cb404-7" aria-hidden="true"></a>                           <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</span>
<span id="cb404-8"><a href="mathmatics-and-statistics.html#cb404-8" aria-hidden="true"></a>    ar_eps_val &lt;-<span class="st"> </span>(<span class="kw">tail</span>(ar_eps_bounds, <span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">head</span>(ar_eps_bounds, <span class="dv">-1</span>))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb404-9"><a href="mathmatics-and-statistics.html#cb404-9" aria-hidden="true"></a>    ar_eps_prb &lt;-<span class="st"> </span><span class="kw">rep</span>(fl_prob_break<span class="op">/</span>(fl_cdf_max <span class="op">-</span><span class="st"> </span>fl_cdf_min), x[<span class="dv">1</span>])</span>
<span id="cb404-10"><a href="mathmatics-and-statistics.html#cb404-10" aria-hidden="true"></a>    ar_eps_fev &lt;-<span class="st"> </span><span class="kw">dnorm</span>(ar_eps_val,</span>
<span id="cb404-11"><a href="mathmatics-and-statistics.html#cb404-11" aria-hidden="true"></a>                        <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</span>
<span id="cb404-12"><a href="mathmatics-and-statistics.html#cb404-12" aria-hidden="true"></a></span>
<span id="cb404-13"><a href="mathmatics-and-statistics.html#cb404-13" aria-hidden="true"></a>    fl_cdf_total_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_fev<span class="op">*</span><span class="kw">diff</span>(ar_eps_bounds))</span>
<span id="cb404-14"><a href="mathmatics-and-statistics.html#cb404-14" aria-hidden="true"></a>    fl_mean_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_val<span class="op">*</span>(ar_eps_fev<span class="op">*</span><span class="kw">diff</span>(ar_eps_bounds)))</span>
<span id="cb404-15"><a href="mathmatics-and-statistics.html#cb404-15" aria-hidden="true"></a>    fl_sd_approx &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>((ar_eps_val<span class="op">-</span>fl_mean_approx)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(ar_eps_fev<span class="op">*</span><span class="kw">diff</span>(ar_eps_bounds))))</span>
<span id="cb404-16"><a href="mathmatics-and-statistics.html#cb404-16" aria-hidden="true"></a></span>
<span id="cb404-17"><a href="mathmatics-and-statistics.html#cb404-17" aria-hidden="true"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">cdf=</span>fl_cdf_total_approx, <span class="dt">mean=</span>fl_mean_approx, <span class="dt">sd=</span>fl_sd_approx))</span>
<span id="cb404-18"><a href="mathmatics-and-statistics.html#cb404-18" aria-hidden="true"></a>  })</span>
<span id="cb404-19"><a href="mathmatics-and-statistics.html#cb404-19" aria-hidden="true"></a></span>
<span id="cb404-20"><a href="mathmatics-and-statistics.html#cb404-20" aria-hidden="true"></a>mt_sample_means &lt;-<span class="st"> </span><span class="kw">cbind</span>(ar_it_draws, <span class="kw">as_tibble</span>(<span class="kw">t</span>(mt_fl_means)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>())</span>
<span id="cb404-21"><a href="mathmatics-and-statistics.html#cb404-21" aria-hidden="true"></a><span class="kw">colnames</span>(mt_sample_means) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb404-22"><a href="mathmatics-and-statistics.html#cb404-22" aria-hidden="true"></a>tb_sample_means &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_sample_means)</span>
<span id="cb404-23"><a href="mathmatics-and-statistics.html#cb404-23" aria-hidden="true"></a></span>
<span id="cb404-24"><a href="mathmatics-and-statistics.html#cb404-24" aria-hidden="true"></a><span class="co"># Graph</span></span>
<span id="cb404-25"><a href="mathmatics-and-statistics.html#cb404-25" aria-hidden="true"></a><span class="co"># x-labels</span></span>
<span id="cb404-26"><a href="mathmatics-and-statistics.html#cb404-26" aria-hidden="true"></a>x.labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb404-27"><a href="mathmatics-and-statistics.html#cb404-27" aria-hidden="true"></a>x.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb404-28"><a href="mathmatics-and-statistics.html#cb404-28" aria-hidden="true"></a></span>
<span id="cb404-29"><a href="mathmatics-and-statistics.html#cb404-29" aria-hidden="true"></a><span class="co"># Shared Labels</span></span>
<span id="cb404-30"><a href="mathmatics-and-statistics.html#cb404-30" aria-hidden="true"></a>slb_title_shr =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;as Uneven Rectangle Count Increases</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb404-31"><a href="mathmatics-and-statistics.html#cb404-31" aria-hidden="true"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb404-32"><a href="mathmatics-and-statistics.html#cb404-32" aria-hidden="true"></a>slb_xtitle =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Number of Quantile Bins for Uneven Rectangles Approximation&#39;</span>)</span>
<span id="cb404-33"><a href="mathmatics-and-statistics.html#cb404-33" aria-hidden="true"></a></span>
<span id="cb404-34"><a href="mathmatics-and-statistics.html#cb404-34" aria-hidden="true"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb404-35"><a href="mathmatics-and-statistics.html#cb404-35" aria-hidden="true"></a>plt_mean &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb404-36"><a href="mathmatics-and-statistics.html#cb404-36" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>mean)) <span class="op">+</span></span>
<span id="cb404-37"><a href="mathmatics-and-statistics.html#cb404-37" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb404-38"><a href="mathmatics-and-statistics.html#cb404-38" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb404-39"><a href="mathmatics-and-statistics.html#cb404-39" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb404-40"><a href="mathmatics-and-statistics.html#cb404-40" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb404-41"><a href="mathmatics-and-statistics.html#cb404-41" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Approximated Mean&#39;</span>,</span>
<span id="cb404-42"><a href="mathmatics-and-statistics.html#cb404-42" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="op">+</span></span>
<span id="cb404-43"><a href="mathmatics-and-statistics.html#cb404-43" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb404-44"><a href="mathmatics-and-statistics.html#cb404-44" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb404-45"><a href="mathmatics-and-statistics.html#cb404-45" aria-hidden="true"></a><span class="kw">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-191-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="mathmatics-and-statistics.html#cb405-1" aria-hidden="true"></a>plt_sd &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb405-2"><a href="mathmatics-and-statistics.html#cb405-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>sd)) <span class="op">+</span></span>
<span id="cb405-3"><a href="mathmatics-and-statistics.html#cb405-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb405-4"><a href="mathmatics-and-statistics.html#cb405-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb405-5"><a href="mathmatics-and-statistics.html#cb405-5" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb405-6"><a href="mathmatics-and-statistics.html#cb405-6" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb405-7"><a href="mathmatics-and-statistics.html#cb405-7" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Approximated Standard Deviation&#39;</span>,</span>
<span id="cb405-8"><a href="mathmatics-and-statistics.html#cb405-8" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="op">+</span></span>
<span id="cb405-9"><a href="mathmatics-and-statistics.html#cb405-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb405-10"><a href="mathmatics-and-statistics.html#cb405-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb405-11"><a href="mathmatics-and-statistics.html#cb405-11" aria-hidden="true"></a><span class="kw">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-191-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="mathmatics-and-statistics.html#cb406-1" aria-hidden="true"></a>plt_cdf &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb406-2"><a href="mathmatics-and-statistics.html#cb406-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>cdf)) <span class="op">+</span></span>
<span id="cb406-3"><a href="mathmatics-and-statistics.html#cb406-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb406-4"><a href="mathmatics-and-statistics.html#cb406-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb406-5"><a href="mathmatics-and-statistics.html#cb406-5" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb406-6"><a href="mathmatics-and-statistics.html#cb406-6" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb406-7"><a href="mathmatics-and-statistics.html#cb406-7" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Sum of Uneven Rectangles&#39;</span>,</span>
<span id="cb406-8"><a href="mathmatics-and-statistics.html#cb406-8" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Uneven Rectangle Count Increases&#39;</span>) <span class="op">+</span></span>
<span id="cb406-9"><a href="mathmatics-and-statistics.html#cb406-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb406-10"><a href="mathmatics-and-statistics.html#cb406-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb406-11"><a href="mathmatics-and-statistics.html#cb406-11" aria-hidden="true"></a><span class="kw">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-191-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-constant-width-rectangle-trapezoidal-rule" class="section level4" number="8.1.1.3">
<h4><span class="header-section-number">8.1.1.3</span> Integration By Constant Width Rectangle (Trapezoidal rule)</h4>
<p>This is implementing even width recentagle, even along x-axix. Rectangle width are the same, height is <span class="math inline">\(f(x)\)</span>. This is even width, but uneven area. Note that this method approximates the true answer much better and more quickly than the prior methods.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="mathmatics-and-statistics.html#cb407-1" aria-hidden="true"></a>mt_fl_means &lt;-</span>
<span id="cb407-2"><a href="mathmatics-and-statistics.html#cb407-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb407-3"><a href="mathmatics-and-statistics.html#cb407-3" aria-hidden="true"></a></span>
<span id="cb407-4"><a href="mathmatics-and-statistics.html#cb407-4" aria-hidden="true"></a>    fl_eps_min &lt;-<span class="st"> </span><span class="kw">qnorm</span>(fl_cdf_min, <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</span>
<span id="cb407-5"><a href="mathmatics-and-statistics.html#cb407-5" aria-hidden="true"></a>    fl_eps_max &lt;-<span class="st"> </span><span class="kw">qnorm</span>(fl_cdf_max, <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</span>
<span id="cb407-6"><a href="mathmatics-and-statistics.html#cb407-6" aria-hidden="true"></a>    fl_gap &lt;-<span class="st"> </span>(fl_eps_max<span class="op">-</span>fl_eps_min)<span class="op">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb407-7"><a href="mathmatics-and-statistics.html#cb407-7" aria-hidden="true"></a>    ar_eps_bounds &lt;-<span class="st"> </span><span class="kw">seq</span>(fl_eps_min, fl_eps_max, <span class="dt">by=</span>fl_gap)</span>
<span id="cb407-8"><a href="mathmatics-and-statistics.html#cb407-8" aria-hidden="true"></a>    ar_eps_val &lt;-<span class="st"> </span>(<span class="kw">tail</span>(ar_eps_bounds, <span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">head</span>(ar_eps_bounds, <span class="dv">-1</span>))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb407-9"><a href="mathmatics-and-statistics.html#cb407-9" aria-hidden="true"></a>    ar_eps_prb &lt;-<span class="st"> </span><span class="kw">dnorm</span>(ar_eps_val, <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)<span class="op">*</span>fl_gap</span>
<span id="cb407-10"><a href="mathmatics-and-statistics.html#cb407-10" aria-hidden="true"></a></span>
<span id="cb407-11"><a href="mathmatics-and-statistics.html#cb407-11" aria-hidden="true"></a>    fl_cdf_total_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_prb)</span>
<span id="cb407-12"><a href="mathmatics-and-statistics.html#cb407-12" aria-hidden="true"></a>    fl_mean_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_val<span class="op">*</span>ar_eps_prb)</span>
<span id="cb407-13"><a href="mathmatics-and-statistics.html#cb407-13" aria-hidden="true"></a>    fl_sd_approx &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>((ar_eps_val<span class="op">-</span>fl_mean_approx)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>ar_eps_prb))</span>
<span id="cb407-14"><a href="mathmatics-and-statistics.html#cb407-14" aria-hidden="true"></a></span>
<span id="cb407-15"><a href="mathmatics-and-statistics.html#cb407-15" aria-hidden="true"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">cdf=</span>fl_cdf_total_approx, <span class="dt">mean=</span>fl_mean_approx, <span class="dt">sd=</span>fl_sd_approx))</span>
<span id="cb407-16"><a href="mathmatics-and-statistics.html#cb407-16" aria-hidden="true"></a>  })</span>
<span id="cb407-17"><a href="mathmatics-and-statistics.html#cb407-17" aria-hidden="true"></a></span>
<span id="cb407-18"><a href="mathmatics-and-statistics.html#cb407-18" aria-hidden="true"></a>mt_sample_means &lt;-<span class="st"> </span><span class="kw">cbind</span>(ar_it_draws, <span class="kw">as_tibble</span>(<span class="kw">t</span>(mt_fl_means)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>())</span>
<span id="cb407-19"><a href="mathmatics-and-statistics.html#cb407-19" aria-hidden="true"></a><span class="kw">colnames</span>(mt_sample_means) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb407-20"><a href="mathmatics-and-statistics.html#cb407-20" aria-hidden="true"></a>tb_sample_means &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_sample_means)</span>
<span id="cb407-21"><a href="mathmatics-and-statistics.html#cb407-21" aria-hidden="true"></a></span>
<span id="cb407-22"><a href="mathmatics-and-statistics.html#cb407-22" aria-hidden="true"></a><span class="co"># Graph</span></span>
<span id="cb407-23"><a href="mathmatics-and-statistics.html#cb407-23" aria-hidden="true"></a><span class="co"># x-labels</span></span>
<span id="cb407-24"><a href="mathmatics-and-statistics.html#cb407-24" aria-hidden="true"></a>x.labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb407-25"><a href="mathmatics-and-statistics.html#cb407-25" aria-hidden="true"></a>x.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb407-26"><a href="mathmatics-and-statistics.html#cb407-26" aria-hidden="true"></a></span>
<span id="cb407-27"><a href="mathmatics-and-statistics.html#cb407-27" aria-hidden="true"></a><span class="co"># Shared Labels</span></span>
<span id="cb407-28"><a href="mathmatics-and-statistics.html#cb407-28" aria-hidden="true"></a>slb_title_shr =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;as Even Rectangle Count Increases</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb407-29"><a href="mathmatics-and-statistics.html#cb407-29" aria-hidden="true"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb407-30"><a href="mathmatics-and-statistics.html#cb407-30" aria-hidden="true"></a>slb_xtitle =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Number Equi-distance Rectangles Bins&#39;</span>)</span>
<span id="cb407-31"><a href="mathmatics-and-statistics.html#cb407-31" aria-hidden="true"></a></span>
<span id="cb407-32"><a href="mathmatics-and-statistics.html#cb407-32" aria-hidden="true"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb407-33"><a href="mathmatics-and-statistics.html#cb407-33" aria-hidden="true"></a>plt_mean &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb407-34"><a href="mathmatics-and-statistics.html#cb407-34" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>mean)) <span class="op">+</span></span>
<span id="cb407-35"><a href="mathmatics-and-statistics.html#cb407-35" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb407-36"><a href="mathmatics-and-statistics.html#cb407-36" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb407-37"><a href="mathmatics-and-statistics.html#cb407-37" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb407-38"><a href="mathmatics-and-statistics.html#cb407-38" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb407-39"><a href="mathmatics-and-statistics.html#cb407-39" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Integrated Mean&#39;</span>,</span>
<span id="cb407-40"><a href="mathmatics-and-statistics.html#cb407-40" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="op">+</span></span>
<span id="cb407-41"><a href="mathmatics-and-statistics.html#cb407-41" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb407-42"><a href="mathmatics-and-statistics.html#cb407-42" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb407-43"><a href="mathmatics-and-statistics.html#cb407-43" aria-hidden="true"></a><span class="kw">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-192-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="mathmatics-and-statistics.html#cb408-1" aria-hidden="true"></a>plt_sd &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb408-2"><a href="mathmatics-and-statistics.html#cb408-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>sd)) <span class="op">+</span></span>
<span id="cb408-3"><a href="mathmatics-and-statistics.html#cb408-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb408-4"><a href="mathmatics-and-statistics.html#cb408-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb408-5"><a href="mathmatics-and-statistics.html#cb408-5" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb408-6"><a href="mathmatics-and-statistics.html#cb408-6" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb408-7"><a href="mathmatics-and-statistics.html#cb408-7" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Standard Deviation&#39;</span>,</span>
<span id="cb408-8"><a href="mathmatics-and-statistics.html#cb408-8" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="op">+</span></span>
<span id="cb408-9"><a href="mathmatics-and-statistics.html#cb408-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb408-10"><a href="mathmatics-and-statistics.html#cb408-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb408-11"><a href="mathmatics-and-statistics.html#cb408-11" aria-hidden="true"></a><span class="kw">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-192-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="mathmatics-and-statistics.html#cb409-1" aria-hidden="true"></a>plt_cdf &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></span>
<span id="cb409-2"><a href="mathmatics-and-statistics.html#cb409-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>cdf)) <span class="op">+</span></span>
<span id="cb409-3"><a href="mathmatics-and-statistics.html#cb409-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb409-4"><a href="mathmatics-and-statistics.html#cb409-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb409-5"><a href="mathmatics-and-statistics.html#cb409-5" aria-hidden="true"></a>       <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb409-6"><a href="mathmatics-and-statistics.html#cb409-6" aria-hidden="true"></a>       <span class="dt">x =</span> slb_xtitle,</span>
<span id="cb409-7"><a href="mathmatics-and-statistics.html#cb409-7" aria-hidden="true"></a>       <span class="dt">y =</span> <span class="st">&#39;Sum of Equi-Dist Rectangles&#39;</span>,</span>
<span id="cb409-8"><a href="mathmatics-and-statistics.html#cb409-8" aria-hidden="true"></a>       <span class="dt">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Equi-Dist Rectangle width decreases&#39;</span>) <span class="op">+</span></span>
<span id="cb409-9"><a href="mathmatics-and-statistics.html#cb409-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></span>
<span id="cb409-10"><a href="mathmatics-and-statistics.html#cb409-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb409-11"><a href="mathmatics-and-statistics.html#cb409-11" aria-hidden="true"></a><span class="kw">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-192-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="analytical-solutions" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Analytical Solutions</h2>

<div id="linear-scalar-fx0-solutions" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Linear Scalar f(x)=0 Solutions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="ratio" class="section level4" number="8.2.1.1">
<h4><span class="header-section-number">8.2.1.1</span> Ratio</h4>
<p>Here are some common ratios.</p>
<div id="unif-draw-min-and-max-ratio" class="section level5" number="8.2.1.1.1">
<h5><span class="header-section-number">8.2.1.1.1</span> Unif Draw Min and Max Ratio</h5>
<p>We want to draw numbers such that we have some mean <span class="math inline">\(b\)</span>, and that the possible maximum and minimum value drawn are at most <span class="math inline">\(a\)</span> times apart. Given <span class="math inline">\(b\)</span> and <span class="math inline">\(a\)</span>, solve for <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
f(x) = \frac{b+x}{b-x} - a = 0
\]</span></p>
<p><span class="math display">\[
b \cdot a - x \cdot a = b + x \\
b \cdot a - b = x + x \cdot a  \\
b \left(a - 1\right) = x \left( a+ 1\right)  \\
x = \frac{b\left(a-1\right)}{a+1}\\
\]</span></p>
<p>Uniformly draw</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="mathmatics-and-statistics.html#cb410-1" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb410-2"><a href="mathmatics-and-statistics.html#cb410-2" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb410-3"><a href="mathmatics-and-statistics.html#cb410-3" aria-hidden="true"></a>x &lt;-<span class="st"> </span>(b<span class="op">*</span>(a<span class="dv">-1</span>))<span class="op">/</span>(a<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb410-4"><a href="mathmatics-and-statistics.html#cb410-4" aria-hidden="true"></a>ar_unif_draws &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>, <span class="dt">min=</span>b<span class="op">-</span>x, <span class="dt">max=</span>b<span class="op">+</span>x)</span>
<span id="cb410-5"><a href="mathmatics-and-statistics.html#cb410-5" aria-hidden="true"></a>fl_max_min_ratio &lt;-<span class="st"> </span><span class="kw">max</span>(ar_unif_draws)<span class="op">/</span><span class="kw">min</span>(ar_unif_draws)</span>
<span id="cb410-6"><a href="mathmatics-and-statistics.html#cb410-6" aria-hidden="true"></a><span class="kw">cat</span>(<span class="st">&#39;fl_max_min_ratio =&#39;</span>, fl_max_min_ratio, <span class="st">&#39;is close to a =&#39;</span>, a, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## fl_max_min_ratio = 1.965882 is close to a = 2</code></pre>

</div>
</div>
</div>
</div>
<div id="inequality-models" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Inequality Models</h2>

<div id="gini-discrete-sample" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Gini Discrete Sample</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>This works out how the <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> function works from <a href="https://fanwangecon.github.io/">Fan</a>â€™s <em><a href="https://fanwangecon.github.io/REconTools/">REconTools</a></em> Package.</p>
<div id="gini-formula-for-discrete-sample" class="section level4" number="8.3.1.1">
<h4><span class="header-section-number">8.3.1.1</span> Gini Formula for Discrete Sample</h4>
<p>There is an vector values (all positive). This could be height information for N individuals. It could also be income information for N individuals. Calculate the <a href="https://en.wikipedia.org/wiki/Gini_coefficient">GINI</a> coefficient treating the given vector as population. This is not an estimation exercise where we want to estimate population gini based on a sample. The given array is the population. The population is discrete, and only has these N individuals in the length n vector.</p>
<p>Note that when the sample size is small, there is a limit to inequality using the formula defined below given each <span class="math inline">\(N\)</span>. So for small <span class="math inline">\(N\)</span>, can not really compare inequality across arrays with different <span class="math inline">\(N\)</span>, can only compare arrays with the same <span class="math inline">\(N\)</span>.</p>
<p>The GINI formula used here is:
<span class="math display">\[
 GINI =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p>Derive the formula in the steps below.</p>
<p><em>Step 1 Area Formula</em></p>
<p><span class="math display">\[
 \Gamma = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{x_j}{\sum_{\widehat{j}=1}^N x_{\widehat{j}} }
      \right)
  \right)
\]</span></p>
<p><em>Step 2 Total Area Given Perfect equality</em></p>
<p>With perfect equality <span class="math inline">\(x_i=a\)</span> for all <span class="math inline">\(i\)</span>, so need to divide by that.</p>
<p><span class="math display">\[
 \Gamma^{\text{equal}} = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{a}{\sum_{\widehat{j}=1}^N a }
      \right)
  \right)
  = \frac{N+1}{N}\cdot\frac{1}{2}
\]</span></p>
<p>As the number of elements of the vecotr increases:
<span class="math display">\[
 \lim_{N \rightarrow \infty}\Gamma^{\text{equal}}
  = \lim_{N \rightarrow \infty} \frac{N+1}{N}\cdot\frac{1}{2}
  = \frac{1}{2}
\]</span></p>
<p><em>Step 3 Arriving at Finite Vector Gini Formula</em></p>
<p>Given what we have from above, we obtain the gini formula, divide by total area below 45 degree line.</p>
<p><span class="math display">\[
 GINI =
  1 -
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    N \cdot \sum_{i=1}^N x_i
  \right)^{-1}
  \cdot
  \left( \frac{N+1}{N}\cdot\frac{1}{2} \right)^{-1}
  =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p><em>Step 4 Maximum Inequality given N</em></p>
<p>Suppose <span class="math inline">\(x_i=0\)</span> for all <span class="math inline">\(i&lt;N\)</span>, then:</p>
<p><span class="math display">\[
 GINI^{x_i = 0 \text{ except } i=N}
 =
  1 - \frac{2}{N+1}
  \cdot
  X_N
  \cdot
  \left(
    X_N
  \right)^{-1}
 =
 1 - \frac{2}{N+1}
\]</span></p>
<p><span class="math display">\[
 \lim_{N \rightarrow \infty} GINI^{x_i = 0 \text{ except } i=N}
 =
 1 -
 \lim_{N \rightarrow \infty}
 \frac{2}{N+1}
 = 1
\]</span></p>
<p>Note that for small N, for example if <span class="math inline">\(N=10\)</span>, even when one person holds all income, all others have 0 income, the formula will not produce gini is zero, but that gini is equal to <span class="math inline">\(\frac{2}{11}\approx 0.1818\)</span>. If <span class="math inline">\(N=2\)</span>, inequality is at most, <span class="math inline">\(\frac{2}{3}\approx 0.667\)</span>.</p>
<p><span class="math display">\[
 MostUnequalGINI\left(N\right) = 1 - \frac{2}{N+1} = \frac{N-1}{N+1}
\]</span></p>
</div>
<div id="implement-gini-formula" class="section level4" number="8.3.1.2">
<h4><span class="header-section-number">8.3.1.2</span> Implement GINI Formula</h4>
<p>The <strong>GINI</strong> formula just derived is trivial to compute.</p>
<ol style="list-style-type: decimal">
<li>scalar: <span class="math inline">\(\frac{2}{N+1}\)</span></li>
<li>cumsum: <span class="math inline">\(\sum_{j=1}^{i} x_j\)</span></li>
<li>sum of cumsum: <span class="math inline">\(\left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)\)</span></li>
<li>sum: <span class="math inline">\(\sum_{i=1}^N X_i\)</span></li>
</ol>
<p>There are no package dependencies. Define the formula here:</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="mathmatics-and-statistics.html#cb412-1" aria-hidden="true"></a><span class="co"># Formula, directly implement the GINI formula Following Step 4 above</span></span>
<span id="cb412-2"><a href="mathmatics-and-statistics.html#cb412-2" aria-hidden="true"></a>fv_dist_gini_vector_pos_test &lt;-<span class="st"> </span><span class="cf">function</span>(ar_pos) {</span>
<span id="cb412-3"><a href="mathmatics-and-statistics.html#cb412-3" aria-hidden="true"></a>  <span class="co"># Check length and given warning</span></span>
<span id="cb412-4"><a href="mathmatics-and-statistics.html#cb412-4" aria-hidden="true"></a>  it_n &lt;-<span class="st"> </span><span class="kw">length</span>(ar_pos)</span>
<span id="cb412-5"><a href="mathmatics-and-statistics.html#cb412-5" aria-hidden="true"></a>  <span class="cf">if</span> (it_n <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span>)  <span class="kw">warning</span>(<span class="st">&#39;Data vector has n=&#39;</span>,it_n,<span class="st">&#39;, max-inequality/max-gini=&#39;</span>,(it_n<span class="dv">-1</span>)<span class="op">/</span>(it_n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb412-6"><a href="mathmatics-and-statistics.html#cb412-6" aria-hidden="true"></a>  <span class="co"># Sort</span></span>
<span id="cb412-7"><a href="mathmatics-and-statistics.html#cb412-7" aria-hidden="true"></a>  ar_pos &lt;-<span class="st"> </span><span class="kw">sort</span>(ar_pos)</span>
<span id="cb412-8"><a href="mathmatics-and-statistics.html#cb412-8" aria-hidden="true"></a>  <span class="co"># formula implement</span></span>
<span id="cb412-9"><a href="mathmatics-and-statistics.html#cb412-9" aria-hidden="true"></a>  fl_gini &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>((<span class="dv">2</span><span class="op">/</span>(it_n<span class="op">+</span><span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">cumsum</span>(ar_pos))<span class="op">*</span>(<span class="kw">sum</span>(ar_pos))<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb412-10"><a href="mathmatics-and-statistics.html#cb412-10" aria-hidden="true"></a>  <span class="kw">return</span>(fl_gini)</span>
<span id="cb412-11"><a href="mathmatics-and-statistics.html#cb412-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>Generate a number of examples Arrays for testing</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="mathmatics-and-statistics.html#cb413-1" aria-hidden="true"></a><span class="co"># Example Arrays of data</span></span>
<span id="cb413-2"><a href="mathmatics-and-statistics.html#cb413-2" aria-hidden="true"></a>ar_equal_n1 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>)</span>
<span id="cb413-3"><a href="mathmatics-and-statistics.html#cb413-3" aria-hidden="true"></a>ar_ineql_n1 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>)</span>
<span id="cb413-4"><a href="mathmatics-and-statistics.html#cb413-4" aria-hidden="true"></a></span>
<span id="cb413-5"><a href="mathmatics-and-statistics.html#cb413-5" aria-hidden="true"></a>ar_equal_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb413-6"><a href="mathmatics-and-statistics.html#cb413-6" aria-hidden="true"></a>ar_ineql_alittle_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb413-7"><a href="mathmatics-and-statistics.html#cb413-7" aria-hidden="true"></a>ar_ineql_somewht_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb413-8"><a href="mathmatics-and-statistics.html#cb413-8" aria-hidden="true"></a>ar_ineql_alotine_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">5</span>)</span>
<span id="cb413-9"><a href="mathmatics-and-statistics.html#cb413-9" aria-hidden="true"></a>ar_ineql_veryvry_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">8</span>)</span>
<span id="cb413-10"><a href="mathmatics-and-statistics.html#cb413-10" aria-hidden="true"></a>ar_ineql_mostmst_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">13</span>)</span>
<span id="cb413-11"><a href="mathmatics-and-statistics.html#cb413-11" aria-hidden="true"></a></span>
<span id="cb413-12"><a href="mathmatics-and-statistics.html#cb413-12" aria-hidden="true"></a>ar_equal_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb413-13"><a href="mathmatics-and-statistics.html#cb413-13" aria-hidden="true"></a>ar_ineql_some_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">21</span>,<span class="dv">34</span>,<span class="dv">55</span>,<span class="dv">89</span>)</span>
<span id="cb413-14"><a href="mathmatics-and-statistics.html#cb413-14" aria-hidden="true"></a>ar_ineql_very_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">5</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">8</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">13</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">21</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">34</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">55</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">89</span><span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb413-15"><a href="mathmatics-and-statistics.html#cb413-15" aria-hidden="true"></a>ar_ineql_extr_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="op">^</span><span class="dv">3</span>,<span class="dv">5</span><span class="op">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="op">^</span><span class="dv">5</span>,<span class="dv">13</span><span class="op">^</span><span class="dv">6</span>,<span class="dv">21</span><span class="op">^</span><span class="dv">7</span>,<span class="dv">34</span><span class="op">^</span><span class="dv">8</span>,<span class="dv">55</span><span class="op">^</span><span class="dv">9</span>,<span class="dv">89</span><span class="op">^</span><span class="dv">10</span>)</span></code></pre></div>
<p>Now test the example arrays above using the function based no our formula:</p>
<pre><code>## 
## Small N=1 Hard-Code</code></pre>
<pre><code>## ar_equal_n1: 0</code></pre>
<pre><code>## ar_ineql_n1: 0</code></pre>
<pre><code>## 
## Small N=2 Hard-Code, converge to 1/3, see formula above</code></pre>
<pre><code>## ar_ineql_alittle_n2: 0.1111111</code></pre>
<pre><code>## ar_ineql_somewht_n2: 0.2592593</code></pre>
<pre><code>## ar_ineql_alotine_n2: 0.3131313</code></pre>
<pre><code>## ar_ineql_veryvry_n2: 0.3307393</code></pre>
<pre><code>## 
## Small N=10 Hard-Code, convege to 9/11=0.8181, see formula above</code></pre>
<pre><code>## ar_equal_n10: 0</code></pre>
<pre><code>## ar_ineql_some_n10: 0.5395514</code></pre>
<pre><code>## ar_ineql_very_n10: 0.7059554</code></pre>
<pre><code>## ar_ineql_extr_n10: 0.8181549</code></pre>

</div>
</div>
<div id="atkinson-inequality-index" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Atkinson Inequality Index</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="atkinson-inequality-measures" class="section level4" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Atkinson Inequality Measures</h4>
<p><a href="https://linkinghub.elsevier.com/retrieve/pii/0022053170900396">Atkinson (JET, 1970)</a> studies five standard inequality measures. Atkinson finds that given the same income data across countries, different inequality measure lead to different rankings of which country is more unequal. Atkinson develops an measure of inequality that changes depending on an inequality aversion parameter.</p>
<p><span class="math display">\[
\text{Atkinson Inequality} = 
A\left(
\left\{Y_i\right\}_{i=1}^N,
\lambda
\right) 
= 1 - 
\left(
\sum_{i=1}^N \frac{1}{N}
  \left(
    \frac{Y_i}{\sum_{j=1}^N \left( \frac{Y_j}{N} \right) }
  \right)^{\lambda}  
\right)^{\frac{1}{\lambda}}
\in \left[0,1\right]
\]</span></p>
<p><span class="math inline">\(A\left(\left\{Y_i\right\}_{i=1}^N,\lambda\right)\)</span> equals to zero is perfect equality. 1 is Perfect inequality. If <span class="math inline">\(\lambda=1\)</span>, the inequality measure is always equal to 0 because the planner does not care abouot inequality anymore.</p>
</div>
<div id="atkinson-inequality-function" class="section level4" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Atkinson Inequality Function</h4>
<p>Programming up the equation above, we have:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="mathmatics-and-statistics.html#cb427-1" aria-hidden="true"></a><span class="co"># Formula</span></span>
<span id="cb427-2"><a href="mathmatics-and-statistics.html#cb427-2" aria-hidden="true"></a>ffi_atkinson_ineq &lt;-<span class="st"> </span><span class="cf">function</span>(ar_data, fl_rho) {</span>
<span id="cb427-3"><a href="mathmatics-and-statistics.html#cb427-3" aria-hidden="true"></a>  ar_data_demean &lt;-<span class="st"> </span>ar_data<span class="op">/</span><span class="kw">mean</span>(ar_data)</span>
<span id="cb427-4"><a href="mathmatics-and-statistics.html#cb427-4" aria-hidden="true"></a>  it_len &lt;-<span class="st"> </span><span class="kw">length</span>(ar_data_demean)</span>
<span id="cb427-5"><a href="mathmatics-and-statistics.html#cb427-5" aria-hidden="true"></a>  fl_atkinson &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(ar_data_demean<span class="op">^</span>{fl_rho}<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>it_len))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>fl_rho)</span>
<span id="cb427-6"><a href="mathmatics-and-statistics.html#cb427-6" aria-hidden="true"></a>  <span class="kw">return</span>(fl_atkinson)</span>
<span id="cb427-7"><a href="mathmatics-and-statistics.html#cb427-7" aria-hidden="true"></a>}</span></code></pre></div>
</div>
<div id="atkinson-inequality-examples" class="section level4" number="8.3.2.3">
<h4><span class="header-section-number">8.3.2.3</span> Atkinson Inequality Examples</h4>
<p>Given a vectr of observables, compute the atkinson inequality measure given different inequality aversion.</p>
<p>Preference vector and data vector:</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="mathmatics-and-statistics.html#cb428-1" aria-hidden="true"></a><span class="co"># Preference Vector </span></span>
<span id="cb428-2"><a href="mathmatics-and-statistics.html#cb428-2" aria-hidden="true"></a>ar_rho &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">2.2</span>,<span class="fl">2.2</span>, <span class="dt">length.out=</span><span class="dv">60</span>)))))</span>
<span id="cb428-3"><a href="mathmatics-and-statistics.html#cb428-3" aria-hidden="true"></a>ar_rho &lt;-<span class="st"> </span><span class="kw">unique</span>(ar_rho)</span>
<span id="cb428-4"><a href="mathmatics-and-statistics.html#cb428-4" aria-hidden="true"></a>mt_rho &lt;-<span class="st"> </span><span class="kw">matrix</span>(ar_rho, <span class="dt">nrow=</span><span class="kw">length</span>(ar_rho), <span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb428-5"><a href="mathmatics-and-statistics.html#cb428-5" aria-hidden="true"></a>  </span>
<span id="cb428-6"><a href="mathmatics-and-statistics.html#cb428-6" aria-hidden="true"></a><span class="co"># Random Data Vector (not equal outcomes)</span></span>
<span id="cb428-7"><a href="mathmatics-and-statistics.html#cb428-7" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb428-8"><a href="mathmatics-and-statistics.html#cb428-8" aria-hidden="true"></a>ar_data_rand &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">15</span>, <span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb428-9"><a href="mathmatics-and-statistics.html#cb428-9" aria-hidden="true"></a>ar_data_rand &lt;-<span class="st"> </span>ar_data_rand <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(ar_data_rand) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb428-10"><a href="mathmatics-and-statistics.html#cb428-10" aria-hidden="true"></a></span>
<span id="cb428-11"><a href="mathmatics-and-statistics.html#cb428-11" aria-hidden="true"></a><span class="co"># Uniform Data Vector (Equal)</span></span>
<span id="cb428-12"><a href="mathmatics-and-statistics.html#cb428-12" aria-hidden="true"></a>ar_data_unif &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(ar_data_rand))</span>
<span id="cb428-13"><a href="mathmatics-and-statistics.html#cb428-13" aria-hidden="true"></a></span>
<span id="cb428-14"><a href="mathmatics-and-statistics.html#cb428-14" aria-hidden="true"></a><span class="co"># One Rich (last person has income equal to the sum of all others*100)</span></span>
<span id="cb428-15"><a href="mathmatics-and-statistics.html#cb428-15" aria-hidden="true"></a>ar_data_onerich &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.1</span>, <span class="kw">length</span>(ar_data_rand))</span>
<span id="cb428-16"><a href="mathmatics-and-statistics.html#cb428-16" aria-hidden="true"></a>ar_data_onerich[<span class="kw">length</span>(ar_data_onerich)] =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">head</span>(ar_data_onerich,<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="dv">10</span></span></code></pre></div>
<p>Testing Atkinson with different data arrays:</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="mathmatics-and-statistics.html#cb429-1" aria-hidden="true"></a><span class="co"># ATK = 0.1180513</span></span>
<span id="cb429-2"><a href="mathmatics-and-statistics.html#cb429-2" aria-hidden="true"></a><span class="kw">ffi_atkinson_ineq</span>(ar_data_rand, <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1180513</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="mathmatics-and-statistics.html#cb431-1" aria-hidden="true"></a><span class="co"># ATK = 0</span></span>
<span id="cb431-2"><a href="mathmatics-and-statistics.html#cb431-2" aria-hidden="true"></a><span class="kw">ffi_atkinson_ineq</span>(ar_data_unif, <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="mathmatics-and-statistics.html#cb433-1" aria-hidden="true"></a><span class="co"># ATK = 0.89</span></span>
<span id="cb433-2"><a href="mathmatics-and-statistics.html#cb433-2" aria-hidden="true"></a><span class="kw">ffi_atkinson_ineq</span>(ar_data_onerich, <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8956933</code></pre>
<div id="atkinson-inequality-as-inequality-aversion-changes" class="section level5" number="8.3.2.3.1">
<h5><span class="header-section-number">8.3.2.3.1</span> Atkinson Inequality as Inequality Aversion Changes</h5>
<p>This is the vector of inequality aversion parameters:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="mathmatics-and-statistics.html#cb435-1" aria-hidden="true"></a>ar_rho</span></code></pre></div>
<pre><code>##  [1]    1.00000000    0.99369043    0.99250837    0.99110487    0.98943842    0.98745978
##  [7]    0.98511046    0.98232100    0.97900896    0.97507643    0.97040717    0.96486316
## [13]    0.95828051    0.95046465    0.94118454    0.93016586    0.91708291    0.90154895
## [19]    0.88310482    0.86120530    0.83520306    0.80432947    0.76767192    0.72414684
## [25]    0.67246762    0.61110666    0.53825013    0.45174443    0.34903248    0.22707813
## [31]    0.08227648   -0.08965279   -0.29379184   -0.53617495   -0.82396688   -1.16567469
## [37]   -1.57139912   -2.05313328   -2.62511705   -3.30425810   -4.11063160   -5.06807371
## [43]   -6.20488608   -7.55467254   -9.15733231  -11.06023949  -13.31964342  -16.00233131
## [49]  -19.18760255  -22.96961271  -27.46015678  -32.79197376  -39.12267043  -46.63938010
## [55]  -55.56429426  -66.16123043  -78.74343059  -93.68282046 -111.42100351 -132.48231461
## [61] -157.48931925</code></pre>
<p>How does Atkinson Inequality measure change with respect to a vector of random data as inequality aversion shifts:</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="mathmatics-and-statistics.html#cb437-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">new=</span>T)</span>
<span id="cb437-2"><a href="mathmatics-and-statistics.html#cb437-2" aria-hidden="true"></a>st_x_label &lt;-<span class="st"> &#39;Lambda, left Rawlsian, right (1) is Utilitarian&#39;</span></span>
<span id="cb437-3"><a href="mathmatics-and-statistics.html#cb437-3" aria-hidden="true"></a>st_y_label &lt;-<span class="st"> &#39;Atkinson Inequality, 0 = perfect equal&#39;</span></span>
<span id="cb437-4"><a href="mathmatics-and-statistics.html#cb437-4" aria-hidden="true"></a>ar_ylim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb437-5"><a href="mathmatics-and-statistics.html#cb437-5" aria-hidden="true"></a><span class="kw">ffi_atkinson_ineq</span>(ar_data_rand, <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1180513</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="mathmatics-and-statistics.html#cb439-1" aria-hidden="true"></a>ar_atkinson &lt;-<span class="st"> </span><span class="kw">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="kw">ffi_atkinson_ineq</span>(ar_data_rand, row[<span class="dv">1</span>])})</span>
<span id="cb439-2"><a href="mathmatics-and-statistics.html#cb439-2" aria-hidden="true"></a><span class="kw">plot</span>(ar_rho, ar_atkinson, <span class="dt">ylim =</span> ar_ylim)</span>
<span id="cb439-3"><a href="mathmatics-and-statistics.html#cb439-3" aria-hidden="true"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&#39;A vector of Random data&#39;</span>, <span class="dt">xlab =</span> st_x_label, <span class="dt">ylab =</span> st_y_label)</span>
<span id="cb439-4"><a href="mathmatics-and-statistics.html#cb439-4" aria-hidden="true"></a><span class="kw">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-203-1.png" width="672" style="display: block; margin: auto;" />
Now with the one person has the wealth of all others in the vector times 10:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="mathmatics-and-statistics.html#cb440-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">new=</span>T)</span>
<span id="cb440-2"><a href="mathmatics-and-statistics.html#cb440-2" aria-hidden="true"></a><span class="kw">ffi_atkinson_ineq</span>(ar_data_onerich, <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8956933</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="mathmatics-and-statistics.html#cb442-1" aria-hidden="true"></a>ar_atkinson &lt;-<span class="st"> </span><span class="kw">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="kw">ffi_atkinson_ineq</span>(ar_data_onerich, row[<span class="dv">1</span>])})</span>
<span id="cb442-2"><a href="mathmatics-and-statistics.html#cb442-2" aria-hidden="true"></a><span class="kw">plot</span>(ar_rho, ar_atkinson, <span class="dt">ylim =</span> ar_ylim)</span>
<span id="cb442-3"><a href="mathmatics-and-statistics.html#cb442-3" aria-hidden="true"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&#39;1 person has the (income of all others summed up)*10&#39;</span>, <span class="dt">xlab =</span> st_x_label, <span class="dt">ylab =</span> st_y_label)</span>
<span id="cb442-4"><a href="mathmatics-and-statistics.html#cb442-4" aria-hidden="true"></a><span class="kw">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-204-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The Uniform Results, since allocations are uniform, zero for all:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="mathmatics-and-statistics.html#cb443-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">new=</span>T)</span>
<span id="cb443-2"><a href="mathmatics-and-statistics.html#cb443-2" aria-hidden="true"></a><span class="kw">ffi_atkinson_ineq</span>(ar_data_unif, <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="mathmatics-and-statistics.html#cb445-1" aria-hidden="true"></a>ar_atkinson &lt;-<span class="st"> </span><span class="kw">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="kw">ffi_atkinson_ineq</span>(ar_data_unif, row[<span class="dv">1</span>])})</span>
<span id="cb445-2"><a href="mathmatics-and-statistics.html#cb445-2" aria-hidden="true"></a><span class="kw">plot</span>(ar_rho, ar_atkinson, <span class="dt">ylim =</span> ar_ylim)</span>
<span id="cb445-3"><a href="mathmatics-and-statistics.html#cb445-3" aria-hidden="true"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&#39;uniform distribution&#39;</span>, <span class="dt">xlab =</span> st_x_label, <span class="dt">ylab =</span> st_y_label)</span>
<span id="cb445-4"><a href="mathmatics-and-statistics.html#cb445-4" aria-hidden="true"></a><span class="kw">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-205-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="analyzing-equation-mechanics" class="section level4" number="8.3.2.4">
<h4><span class="header-section-number">8.3.2.4</span> Analyzing Equation Mechanics</h4>
<p>How does the Aktinson Family utility function work? THe Atkinson Family Utility has the following functional form.</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
\alpha
\cdot
A^{\lambda}
+
\beta
\cdot
B^{\lambda}
\right)^{\frac{1}{\lambda}}
\]</span></p>
<p>Several key issues here:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(V^{\text{social}}\)</span> is the utility of some social planner</li>
<li><span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are allocations for Alex and Ben.</li>
<li><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are biases that a social planner has for Alex and Ben: <span class="math inline">\(\alpha+\beta=1\)</span>, <span class="math inline">\(\alpha&gt;0\)</span>, and <span class="math inline">\(\beta&gt;0\)</span></li>
<li><span class="math inline">\(-\infty &lt; \lambda \le 1\)</span> is a measure of inequality aversion
<ul>
<li><span class="math inline">\(\lambda=1\)</span> is when the planner cares about weighted total allocations (efficient, Utilitarian)</li>
<li><span class="math inline">\(\lambda=-\infty\)</span> is when the planner cares about only the minimum between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> allocations (equality, Rawlsian)</li>
</ul></li>
</ol>
<p>What if only care about Alex? Clearly, if the planner only cares about Ben, <span class="math inline">\(\beta=1\)</span>, then:</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
B^{\lambda}
\right)^{\frac{1}{\lambda}}
= B
\]</span></p>
<p>Clearly, regardless of the value of <span class="math inline">\(\lambda\)</span>, as <span class="math inline">\(B\)</span> increases <span class="math inline">\(V\)</span> increases. What Happens to V when A or B increases? What is the derivative of <span class="math inline">\(V\)</span> with respect to <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>?</p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \frac{1}{\lambda}
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1}{\lambda}-1}
    \cdot
    \lambda
    \alpha
    A^{\lambda -1}
\]</span></p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1-\lambda}{\lambda}}
    \cdot
    \alpha
    A^{\lambda -1}
    &gt;0
\]</span></p>
<p>Note that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span>. When <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(Z^{\lambda}&gt;0\)</span>. For example <span class="math inline">\(10^{-2}=\frac{1}{100}\)</span>. And For example <span class="math inline">\(0.1^{\frac{3}{-2}}=\frac{1}{0.1^{1.5}}\)</span>. Still Positive.</p>
<p>While the overall <span class="math inline">\(V\)</span> increases with increasing <span class="math inline">\(A\)</span>, but if we did not have the outter power term, the situation is different. In particular, when <span class="math inline">\(\lambda &lt; 0\)</span>:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{d \left(\alpha A^{\lambda} + \beta B^{\lambda}\right)}{dA}=\alpha\lambda A^{\lambda -1}&lt;0
\]</span>
Without the outter <span class="math inline">\(\frac{1}{\lambda}\)</span> power, negative <span class="math inline">\(\lambda\)</span> would lead to decreasing weighted sum. But:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{dG^{\frac{1}{\lambda}}}{dG}=\frac{1}{\lambda}\cdot G^{\frac{1-\lambda}{\lambda}}&lt;0
\]</span>
so when <span class="math inline">\(G\)</span> is increasing and <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> would decrease. But when <span class="math inline">\(G\left(A,B\right)\)</span> is decreasing, as is the case with increasing <span class="math inline">\(A\)</span> when <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> will actually increase. This confirms that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span> for <span class="math inline">\(\lambda &lt;0\)</span>. The result is symmetric for <span class="math inline">\(\lambda &gt;0\)</span>.</p>
</div>
<div id="indifference-curve-graph" class="section level4" number="8.3.2.5">
<h4><span class="header-section-number">8.3.2.5</span> Indifference Curve Graph</h4>
<p>Given <span class="math inline">\(V^{\ast}\)</span>, we can show the combinations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> points that provide the same utility. We want to be able to potentially draw multiple indifference curves at the same time. Note that indifference curves are defined by <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\lambda\)</span> only. Each indifference curve is a set of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> coordinates. So to generate multiple indifference curves means to generate many sets of <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> associated with different planner preferences, and then these could be graphed out.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="mathmatics-and-statistics.html#cb446-1" aria-hidden="true"></a><span class="co"># A as x-axis, need bounds on A</span></span>
<span id="cb446-2"><a href="mathmatics-and-statistics.html#cb446-2" aria-hidden="true"></a>fl_A_min =<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb446-3"><a href="mathmatics-and-statistics.html#cb446-3" aria-hidden="true"></a>fl_A_max =<span class="st"> </span><span class="dv">3</span></span>
<span id="cb446-4"><a href="mathmatics-and-statistics.html#cb446-4" aria-hidden="true"></a>it_A_grid =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb446-5"><a href="mathmatics-and-statistics.html#cb446-5" aria-hidden="true"></a></span>
<span id="cb446-6"><a href="mathmatics-and-statistics.html#cb446-6" aria-hidden="true"></a><span class="co"># Define parameters</span></span>
<span id="cb446-7"><a href="mathmatics-and-statistics.html#cb446-7" aria-hidden="true"></a><span class="co"># ar_lambda &lt;- 1 - (10^(c(seq(-2,2, length.out=3))))</span></span>
<span id="cb446-8"><a href="mathmatics-and-statistics.html#cb446-8" aria-hidden="true"></a>ar_lambda &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.06</span>, <span class="dv">-6</span>)</span>
<span id="cb446-9"><a href="mathmatics-and-statistics.html#cb446-9" aria-hidden="true"></a>ar_beta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="dt">length.out =</span> <span class="dv">3</span>)</span>
<span id="cb446-10"><a href="mathmatics-and-statistics.html#cb446-10" aria-hidden="true"></a>ar_beta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>)</span>
<span id="cb446-11"><a href="mathmatics-and-statistics.html#cb446-11" aria-hidden="true"></a>ar_v_star &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">1</span>)</span>
<span id="cb446-12"><a href="mathmatics-and-statistics.html#cb446-12" aria-hidden="true"></a>tb_pref &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">cbind</span>(ar_lambda)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-13"><a href="mathmatics-and-statistics.html#cb446-13" aria-hidden="true"></a><span class="st">  </span><span class="kw">expand_grid</span>(ar_beta) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">expand_grid</span>(ar_v_star) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-14"><a href="mathmatics-and-statistics.html#cb446-14" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename_all</span>(<span class="op">~</span><span class="kw">c</span>(<span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-15"><a href="mathmatics-and-statistics.html#cb446-15" aria-hidden="true"></a><span class="st">  </span><span class="kw">rowid_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;indiff_id&quot;</span>)</span>
<span id="cb446-16"><a href="mathmatics-and-statistics.html#cb446-16" aria-hidden="true"></a></span>
<span id="cb446-17"><a href="mathmatics-and-statistics.html#cb446-17" aria-hidden="true"></a><span class="co"># Generate indifference points with apply and anonymous function</span></span>
<span id="cb446-18"><a href="mathmatics-and-statistics.html#cb446-18" aria-hidden="true"></a><span class="co"># tb_pref, whatever is selected from it, must be all numeric</span></span>
<span id="cb446-19"><a href="mathmatics-and-statistics.html#cb446-19" aria-hidden="true"></a><span class="co"># if there are strings, would cause conversion error.</span></span>
<span id="cb446-20"><a href="mathmatics-and-statistics.html#cb446-20" aria-hidden="true"></a>ls_df_indiff &lt;-<span class="st"> </span><span class="kw">apply</span>(tb_pref, <span class="dv">1</span>, <span class="cf">function</span>(x){</span>
<span id="cb446-21"><a href="mathmatics-and-statistics.html#cb446-21" aria-hidden="true"></a>  indiff_id &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb446-22"><a href="mathmatics-and-statistics.html#cb446-22" aria-hidden="true"></a>  lambda &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</span>
<span id="cb446-23"><a href="mathmatics-and-statistics.html#cb446-23" aria-hidden="true"></a>  beta &lt;-<span class="st"> </span>x[<span class="dv">3</span>]</span>
<span id="cb446-24"><a href="mathmatics-and-statistics.html#cb446-24" aria-hidden="true"></a>  vstar &lt;-<span class="st"> </span>x[<span class="dv">4</span>]</span>
<span id="cb446-25"><a href="mathmatics-and-statistics.html#cb446-25" aria-hidden="true"></a>  ar_fl_A_indiff &lt;-<span class="st"> </span><span class="kw">seq</span>(fl_A_min, fl_A_max, <span class="dt">length.out=</span>it_A_grid)</span>
<span id="cb446-26"><a href="mathmatics-and-statistics.html#cb446-26" aria-hidden="true"></a>  ar_fl_B_indiff &lt;-<span class="st"> </span>(((vstar<span class="op">^</span>lambda) <span class="op">-</span><span class="st"> </span></span>
<span id="cb446-27"><a href="mathmatics-and-statistics.html#cb446-27" aria-hidden="true"></a><span class="st">                        </span>(beta<span class="op">*</span>ar_fl_A_indiff<span class="op">^</span>(lambda)))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>beta))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>lambda)</span>
<span id="cb446-28"><a href="mathmatics-and-statistics.html#cb446-28" aria-hidden="true"></a>  mt_A_B_indiff &lt;-<span class="st"> </span><span class="kw">cbind</span>(indiff_id, lambda, beta, vstar,</span>
<span id="cb446-29"><a href="mathmatics-and-statistics.html#cb446-29" aria-hidden="true"></a>                         ar_fl_A_indiff, ar_fl_B_indiff)</span>
<span id="cb446-30"><a href="mathmatics-and-statistics.html#cb446-30" aria-hidden="true"></a>  <span class="kw">colnames</span>(mt_A_B_indiff) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;indiff_id&#39;</span>, <span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>,</span>
<span id="cb446-31"><a href="mathmatics-and-statistics.html#cb446-31" aria-hidden="true"></a>                               <span class="st">&#39;indiff_A&#39;</span>, <span class="st">&#39;indiff_B&#39;</span>)</span>
<span id="cb446-32"><a href="mathmatics-and-statistics.html#cb446-32" aria-hidden="true"></a>  tb_A_B_indiff &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_A_B_indiff) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-33"><a href="mathmatics-and-statistics.html#cb446-33" aria-hidden="true"></a><span class="st">    </span><span class="kw">rowid_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;A_grid_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-34"><a href="mathmatics-and-statistics.html#cb446-34" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(indiff_B <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>indiff_B <span class="op">&lt;=</span><span class="st"> </span><span class="kw">max</span>(ar_fl_A_indiff))</span>
<span id="cb446-35"><a href="mathmatics-and-statistics.html#cb446-35" aria-hidden="true"></a>  <span class="kw">return</span>(tb_A_B_indiff)</span>
<span id="cb446-36"><a href="mathmatics-and-statistics.html#cb446-36" aria-hidden="true"></a>})</span>
<span id="cb446-37"><a href="mathmatics-and-statistics.html#cb446-37" aria-hidden="true"></a>df_indiff &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, ls_df_indiff) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>()</span></code></pre></div>
<p>Note that many more A grid points are needed to fully plot out the leontief line.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="mathmatics-and-statistics.html#cb447-1" aria-hidden="true"></a><span class="co"># Labeling</span></span>
<span id="cb447-2"><a href="mathmatics-and-statistics.html#cb447-2" aria-hidden="true"></a>st_title &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Indifference Curves Aktinson Atkinson Utility (CES)&#39;</span>)</span>
<span id="cb447-3"><a href="mathmatics-and-statistics.html#cb447-3" aria-hidden="true"></a>st_subtitle &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Each Panel Different beta=A</span><span class="ch">\&#39;</span><span class="st">s Weight lambda=inequality aversion</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb447-4"><a href="mathmatics-and-statistics.html#cb447-4" aria-hidden="true"></a>                      <span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb447-5"><a href="mathmatics-and-statistics.html#cb447-5" aria-hidden="true"></a>                      <span class="st">&#39;R4Econ/math/func_ineq/htmlpdfr/fs_atkinson_ces.html&#39;</span>)</span>
<span id="cb447-6"><a href="mathmatics-and-statistics.html#cb447-6" aria-hidden="true"></a>st_caption &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Indifference Curve 2 Individuals, &#39;</span>,</span>
<span id="cb447-7"><a href="mathmatics-and-statistics.html#cb447-7" aria-hidden="true"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb447-8"><a href="mathmatics-and-statistics.html#cb447-8" aria-hidden="true"></a>st_x_label &lt;-<span class="st"> &#39;A&#39;</span></span>
<span id="cb447-9"><a href="mathmatics-and-statistics.html#cb447-9" aria-hidden="true"></a>st_y_label &lt;-<span class="st"> &#39;B&#39;</span></span>
<span id="cb447-10"><a href="mathmatics-and-statistics.html#cb447-10" aria-hidden="true"></a></span>
<span id="cb447-11"><a href="mathmatics-and-statistics.html#cb447-11" aria-hidden="true"></a><span class="co"># Graphing</span></span>
<span id="cb447-12"><a href="mathmatics-and-statistics.html#cb447-12" aria-hidden="true"></a>plt_indiff &lt;-<span class="st"> </span></span>
<span id="cb447-13"><a href="mathmatics-and-statistics.html#cb447-13" aria-hidden="true"></a><span class="st">  </span>df_indiff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">lambda =</span> <span class="kw">as_factor</span>(lambda),</span>
<span id="cb447-14"><a href="mathmatics-and-statistics.html#cb447-14" aria-hidden="true"></a>                       <span class="dt">beta =</span> <span class="kw">as_factor</span>(beta),</span>
<span id="cb447-15"><a href="mathmatics-and-statistics.html#cb447-15" aria-hidden="true"></a>                       <span class="dt">vstar =</span> <span class="kw">as_factor</span>(vstar)) <span class="op">%&gt;%</span></span>
<span id="cb447-16"><a href="mathmatics-and-statistics.html#cb447-16" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>indiff_A, <span class="dt">y=</span>indiff_B,</span>
<span id="cb447-17"><a href="mathmatics-and-statistics.html#cb447-17" aria-hidden="true"></a>             <span class="dt">colour=</span>lambda)) <span class="op">+</span></span>
<span id="cb447-18"><a href="mathmatics-and-statistics.html#cb447-18" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>beta) <span class="op">+</span></span>
<span id="cb447-19"><a href="mathmatics-and-statistics.html#cb447-19" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb447-20"><a href="mathmatics-and-statistics.html#cb447-20" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> st_title, <span class="dt">subtitle =</span> st_subtitle,</span>
<span id="cb447-21"><a href="mathmatics-and-statistics.html#cb447-21" aria-hidden="true"></a>       <span class="dt">x =</span> st_x_label, <span class="dt">y =</span> st_y_label, <span class="dt">caption =</span> st_caption) <span class="op">+</span></span>
<span id="cb447-22"><a href="mathmatics-and-statistics.html#cb447-22" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb447-23"><a href="mathmatics-and-statistics.html#cb447-23" aria-hidden="true"></a></span>
<span id="cb447-24"><a href="mathmatics-and-statistics.html#cb447-24" aria-hidden="true"></a><span class="co"># show</span></span>
<span id="cb447-25"><a href="mathmatics-and-statistics.html#cb447-25" aria-hidden="true"></a><span class="kw">print</span>(plt_indiff)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-207-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="optimization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tables-and-graphs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
