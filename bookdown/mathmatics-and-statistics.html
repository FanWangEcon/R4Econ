<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Mathmatics and Statistics | Panel Data and Optimization with R</title>
  <meta name="description" content="R Examples Panel and Optimization." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Mathmatics and Statistics | Panel Data and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R Examples Panel and Optimization." />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Mathmatics and Statistics | Panel Data and Optimization with R" />
  
  <meta name="twitter:description" content="R Examples Panel and Optimization." />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2020-04-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="optimization.html"/>
<link rel="next" href="tables-and-graphs.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Panel Data and Optimization with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a><ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a><ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#multiple-dimensional-list"><i class="fa fa-check"></i><b>1.1.1</b> Multiple Dimensional List</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a><ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a><ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a><ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-values"><i class="fa fa-check"></i><b>1.4.5</b> String Values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a><ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a><ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a><ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a><ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.1</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.2</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.3</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a><ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a><ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a><ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a><ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mxq-to-mxp-rows"><i class="fa fa-check"></i><b>3.2.1</b> MxQ to MxP Rows</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mx1-to-mxq-rows"><i class="fa fa-check"></i><b>3.2.2</b> Mx1 to MxQ Rows</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a><ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-sapply-mutate"><i class="fa fa-check"></i><b>3.3.1</b> Apply, Sapply, Mutate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>4</b> Panel</a><ul>
<li class="chapter" data-level="4.1" data-path="panel.html"><a href="panel.html#generate-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate and Join</a><ul>
<li class="chapter" data-level="4.1.1" data-path="panel.html"><a href="panel.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="panel.html"><a href="panel.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="panel.html"><a href="panel.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a><ul>
<li class="chapter" data-level="4.2.1" data-path="panel.html"><a href="panel.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a><ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.1</b> OLS and IV</a><ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.1.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.1.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.2</b> Decomposition</a><ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.2.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>6</b> Nonlinear Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a><ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a><ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a><ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html"><i class="fa fa-check"></i><b>8</b> Mathmatics and Statistics</a><ul>
<li class="chapter" data-level="8.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#distributions"><i class="fa fa-check"></i><b>8.1</b> Distributions</a><ul>
<li class="chapter" data-level="8.1.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>8.1.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#analytical-solutions"><i class="fa fa-check"></i><b>8.2</b> Analytical Solutions</a><ul>
<li class="chapter" data-level="8.2.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.2.1</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a><ul>
<li class="chapter" data-level="8.3.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> Gini Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#atkinson-family-utility"><i class="fa fa-check"></i><b>8.3.2</b> Atkinson Family Utility</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>9</b> Tables and Graphs</a><ul>
<li class="chapter" data-level="9.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>9.1</b> R Base Plots</a><ul>
<li class="chapter" data-level="9.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>9.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>9.2</b> Write and Read Plots</a><ul>
<li class="chapter" data-level="9.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>9.2.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a><ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a><ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a><ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a><ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#panel-links"><i class="fa fa-check"></i><b>A.4</b> Panel links</a><ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-and-joingenerate-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a><ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-regression-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear Regression links</a><ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a><ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathmatics-and-statistics-links"><i class="fa fa-check"></i><b>A.8</b> Mathmatics and Statistics links</a><ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Distributions</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-analytical-solutionsanalytical-solutions-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Analytical Solutions</span> links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> <span>Section 8.3 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.9</b> Tables and Graphs links</a><ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.9.2</b> <span>Section 9.2 Write and Read Plots</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Panel Data and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mathmatics-and-statistics" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Mathmatics and Statistics</h1>

<div id="distributions" class="section level2">
<h2><span class="header-section-number">8.1</span> Distributions</h2>

<div id="integrate-over-normal-guassian-process-shock" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Integrate Over Normal Guassian Process Shock</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository.</p>
</blockquote>
<p>Some Common parameters</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb365-1" title="1">fl_eps_mean =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb365-2" title="2">fl_eps_sd =<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb365-3" title="3">fl_cdf_min =<span class="st"> </span><span class="fl">0.000001</span></a>
<a class="sourceLine" id="cb365-4" title="4">fl_cdf_max =<span class="st"> </span><span class="fl">0.999999</span></a>
<a class="sourceLine" id="cb365-5" title="5">ar_it_draws &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</a></code></pre></div>
<div id="randomly-sample-and-integrate-monte-carlo-integration" class="section level4">
<h4><span class="header-section-number">8.1.1.1</span> Randomly Sample and Integrate (Monte Carlo Integration)</h4>
<p>Compare randomly drawn normal shock mean and known mean. How does simulated mean change with draws. Actual integral equals to <span class="math inline">\(10\)</span>, as sample size increases, the sample mean approaches the integration results, but this is expensive, even with ten thousand draws, not very exact.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb366-1" title="1"><span class="co"># Simulate Draws</span></a>
<a class="sourceLine" id="cb366-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb366-3" title="3">ar_fl_means &lt;-</a>
<a class="sourceLine" id="cb366-4" title="4"><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb366-5" title="5">    <span class="kw">return</span>(<span class="kw">mean</span>(<span class="kw">rnorm</span>(x[<span class="dv">1</span>], <span class="dt">mean=</span>fl_eps_mean, <span class="dt">sd=</span>fl_eps_sd))))</a>
<a class="sourceLine" id="cb366-6" title="6">ar_fl_sd &lt;-</a>
<a class="sourceLine" id="cb366-7" title="7"><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb366-8" title="8">    <span class="kw">return</span>(<span class="kw">sd</span>(<span class="kw">rnorm</span>(x[<span class="dv">1</span>], <span class="dt">mean=</span>fl_eps_mean, <span class="dt">sd=</span>fl_eps_sd))))</a>
<a class="sourceLine" id="cb366-9" title="9"></a>
<a class="sourceLine" id="cb366-10" title="10">mt_sample_means &lt;-<span class="st"> </span><span class="kw">cbind</span>(ar_it_draws, ar_fl_means, ar_fl_sd)</a>
<a class="sourceLine" id="cb366-11" title="11"><span class="kw">colnames</span>(mt_sample_means) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</a>
<a class="sourceLine" id="cb366-12" title="12">tb_sample_means &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_sample_means)</a>
<a class="sourceLine" id="cb366-13" title="13"></a>
<a class="sourceLine" id="cb366-14" title="14"><span class="co"># Graph</span></a>
<a class="sourceLine" id="cb366-15" title="15"><span class="co"># x-labels</span></a>
<a class="sourceLine" id="cb366-16" title="16">x.labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</a>
<a class="sourceLine" id="cb366-17" title="17">x.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb366-18" title="18"></a>
<a class="sourceLine" id="cb366-19" title="19"><span class="co"># Shared Subtitle</span></a>
<a class="sourceLine" id="cb366-20" title="20">st_subtitle &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</a>
<a class="sourceLine" id="cb366-21" title="21">                      <span class="st">&#39;R4Econ/math/integration/htmlpdfr/fs_integrate_normal.html&#39;</span>)</a>
<a class="sourceLine" id="cb366-22" title="22"></a>
<a class="sourceLine" id="cb366-23" title="23"><span class="co"># Shared Labels</span></a>
<a class="sourceLine" id="cb366-24" title="24">slb_title_shr =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;as Sample Size Increases</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb366-25" title="25">                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</a>
<a class="sourceLine" id="cb366-26" title="26">slb_xtitle =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Sample Size&#39;</span>)</a>
<a class="sourceLine" id="cb366-27" title="27"></a>
<a class="sourceLine" id="cb366-28" title="28"><span class="co"># Graph Results--Draw</span></a>
<a class="sourceLine" id="cb366-29" title="29">plt_mean &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb366-30" title="30"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>mean)) <span class="op">+</span></a>
<a class="sourceLine" id="cb366-31" title="31"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb366-32" title="32"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Sample Mean &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb366-33" title="33">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb366-34" title="34">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb366-35" title="35">       <span class="dt">y =</span> <span class="st">&#39;Sample Mean&#39;</span>,</a>
<a class="sourceLine" id="cb366-36" title="36">       <span class="dt">caption =</span> <span class="st">&#39;Mean of Sample Integrates to True Mean&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb366-37" title="37"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb366-38" title="38"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb366-39" title="39"><span class="kw">print</span>(plt_mean)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-159-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb367-1" title="1">plt_sd &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb367-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>sd)) <span class="op">+</span></a>
<a class="sourceLine" id="cb367-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb367-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Sample Standard Deviation &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb367-5" title="5">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb367-6" title="6">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb367-7" title="7">       <span class="dt">y =</span> <span class="st">&#39;Sample Standard Deviation&#39;</span>,</a>
<a class="sourceLine" id="cb367-8" title="8">       <span class="dt">caption =</span> <span class="st">&#39;Standard Deviation of Sample Integrates to True SD&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb367-9" title="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb367-10" title="10"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb367-11" title="11"><span class="kw">print</span>(plt_sd)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-159-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-symmetric-uneven-rectangle" class="section level4">
<h4><span class="header-section-number">8.1.1.2</span> Integration By Symmetric Uneven Rectangle</h4>
<p>Draw on even grid from close to 0 to close to 1. Get the corresponding x points to these quantile levels. Distance between x points are not equi-distance but increasing and symmetric away from the mean. Under this approach, each rectangle aims to approximate the same area.</p>
<p>Resulting integration is rectangle based, but rectangle width differ. The rectangles have wider width as they move away from the mean, and thinner width close to the mean. This is much more stable than the random draw method, but note that it converges somewhat slowly to true values as well.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb368-1" title="1">mt_fl_means &lt;-</a>
<a class="sourceLine" id="cb368-2" title="2"><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb368-3" title="3"></a>
<a class="sourceLine" id="cb368-4" title="4">    fl_prob_break =<span class="st"> </span>(fl_cdf_max <span class="op">-</span><span class="st"> </span>fl_cdf_min)<span class="op">/</span>(x[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb368-5" title="5">    ar_eps_bounds &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">seq</span>(fl_cdf_min, fl_cdf_max,</a>
<a class="sourceLine" id="cb368-6" title="6">                               <span class="dt">by=</span>(fl_cdf_max <span class="op">-</span><span class="st"> </span>fl_cdf_min)<span class="op">/</span>(x[<span class="dv">1</span>])),</a>
<a class="sourceLine" id="cb368-7" title="7">                           <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</a>
<a class="sourceLine" id="cb368-8" title="8">    ar_eps_val &lt;-<span class="st"> </span>(<span class="kw">tail</span>(ar_eps_bounds, <span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">head</span>(ar_eps_bounds, <span class="dv">-1</span>))<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb368-9" title="9">    ar_eps_prb &lt;-<span class="st"> </span><span class="kw">rep</span>(fl_prob_break<span class="op">/</span>(fl_cdf_max <span class="op">-</span><span class="st"> </span>fl_cdf_min), x[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb368-10" title="10">    ar_eps_fev &lt;-<span class="st"> </span><span class="kw">dnorm</span>(ar_eps_val,</a>
<a class="sourceLine" id="cb368-11" title="11">                        <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</a>
<a class="sourceLine" id="cb368-12" title="12"></a>
<a class="sourceLine" id="cb368-13" title="13">    fl_cdf_total_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_fev<span class="op">*</span><span class="kw">diff</span>(ar_eps_bounds))</a>
<a class="sourceLine" id="cb368-14" title="14">    fl_mean_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_val<span class="op">*</span>(ar_eps_fev<span class="op">*</span><span class="kw">diff</span>(ar_eps_bounds)))</a>
<a class="sourceLine" id="cb368-15" title="15">    fl_sd_approx &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>((ar_eps_val<span class="op">-</span>fl_mean_approx)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(ar_eps_fev<span class="op">*</span><span class="kw">diff</span>(ar_eps_bounds))))</a>
<a class="sourceLine" id="cb368-16" title="16"></a>
<a class="sourceLine" id="cb368-17" title="17">    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">cdf=</span>fl_cdf_total_approx, <span class="dt">mean=</span>fl_mean_approx, <span class="dt">sd=</span>fl_sd_approx))</a>
<a class="sourceLine" id="cb368-18" title="18">  })</a>
<a class="sourceLine" id="cb368-19" title="19"></a>
<a class="sourceLine" id="cb368-20" title="20">mt_sample_means &lt;-<span class="st"> </span><span class="kw">cbind</span>(ar_it_draws, <span class="kw">as_tibble</span>(<span class="kw">t</span>(mt_fl_means)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>())</a>
<a class="sourceLine" id="cb368-21" title="21"><span class="kw">colnames</span>(mt_sample_means) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</a>
<a class="sourceLine" id="cb368-22" title="22">tb_sample_means &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_sample_means)</a>
<a class="sourceLine" id="cb368-23" title="23"></a>
<a class="sourceLine" id="cb368-24" title="24"><span class="co"># Graph</span></a>
<a class="sourceLine" id="cb368-25" title="25"><span class="co"># x-labels</span></a>
<a class="sourceLine" id="cb368-26" title="26">x.labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</a>
<a class="sourceLine" id="cb368-27" title="27">x.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb368-28" title="28"></a>
<a class="sourceLine" id="cb368-29" title="29"><span class="co"># Shared Labels</span></a>
<a class="sourceLine" id="cb368-30" title="30">slb_title_shr =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;as Uneven Rectangle Count Increases</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb368-31" title="31">                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</a>
<a class="sourceLine" id="cb368-32" title="32">slb_xtitle =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Number of Quantile Bins for Uneven Rectangles Approximation&#39;</span>)</a>
<a class="sourceLine" id="cb368-33" title="33"></a>
<a class="sourceLine" id="cb368-34" title="34"><span class="co"># Graph Results--Draw</span></a>
<a class="sourceLine" id="cb368-35" title="35">plt_mean &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb368-36" title="36"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>mean)) <span class="op">+</span></a>
<a class="sourceLine" id="cb368-37" title="37"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb368-38" title="38"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb368-39" title="39">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb368-40" title="40">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb368-41" title="41">       <span class="dt">y =</span> <span class="st">&#39;Approximated Mean&#39;</span>,</a>
<a class="sourceLine" id="cb368-42" title="42">       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb368-43" title="43"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb368-44" title="44"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb368-45" title="45"><span class="kw">print</span>(plt_mean)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-160-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb369-1" title="1">plt_sd &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb369-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>sd)) <span class="op">+</span></a>
<a class="sourceLine" id="cb369-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb369-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb369-5" title="5">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb369-6" title="6">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb369-7" title="7">       <span class="dt">y =</span> <span class="st">&#39;Approximated Standard Deviation&#39;</span>,</a>
<a class="sourceLine" id="cb369-8" title="8">       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb369-9" title="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb369-10" title="10"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb369-11" title="11"><span class="kw">print</span>(plt_sd)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-160-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb370-1" title="1">plt_cdf &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb370-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>cdf)) <span class="op">+</span></a>
<a class="sourceLine" id="cb370-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb370-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb370-5" title="5">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb370-6" title="6">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb370-7" title="7">       <span class="dt">y =</span> <span class="st">&#39;Sum of Uneven Rectangles&#39;</span>,</a>
<a class="sourceLine" id="cb370-8" title="8">       <span class="dt">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Uneven Rectangle Count Increases&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb370-9" title="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb370-10" title="10"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb370-11" title="11"><span class="kw">print</span>(plt_cdf)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-160-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-constant-width-rectangle-trapezoidal-rule" class="section level4">
<h4><span class="header-section-number">8.1.1.3</span> Integration By Constant Width Rectangle (Trapezoidal rule)</h4>
<p>This is implementing even width recentagle, even along x-axix. Rectangle width are the same, height is <span class="math inline">\(f(x)\)</span>. This is even width, but uneven area. Note that this method approximates the true answer much better and more quickly than the prior methods.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" title="1">mt_fl_means &lt;-</a>
<a class="sourceLine" id="cb371-2" title="2"><span class="st">  </span><span class="kw">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb371-3" title="3"></a>
<a class="sourceLine" id="cb371-4" title="4">    fl_eps_min &lt;-<span class="st"> </span><span class="kw">qnorm</span>(fl_cdf_min, <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</a>
<a class="sourceLine" id="cb371-5" title="5">    fl_eps_max &lt;-<span class="st"> </span><span class="kw">qnorm</span>(fl_cdf_max, <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)</a>
<a class="sourceLine" id="cb371-6" title="6">    fl_gap &lt;-<span class="st"> </span>(fl_eps_max<span class="op">-</span>fl_eps_min)<span class="op">/</span>(x[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb371-7" title="7">    ar_eps_bounds &lt;-<span class="st"> </span><span class="kw">seq</span>(fl_eps_min, fl_eps_max, <span class="dt">by=</span>fl_gap)</a>
<a class="sourceLine" id="cb371-8" title="8">    ar_eps_val &lt;-<span class="st"> </span>(<span class="kw">tail</span>(ar_eps_bounds, <span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">head</span>(ar_eps_bounds, <span class="dv">-1</span>))<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb371-9" title="9">    ar_eps_prb &lt;-<span class="st"> </span><span class="kw">dnorm</span>(ar_eps_val, <span class="dt">mean =</span> fl_eps_mean, <span class="dt">sd =</span> fl_eps_sd)<span class="op">*</span>fl_gap</a>
<a class="sourceLine" id="cb371-10" title="10"></a>
<a class="sourceLine" id="cb371-11" title="11">    fl_cdf_total_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_prb)</a>
<a class="sourceLine" id="cb371-12" title="12">    fl_mean_approx &lt;-<span class="st"> </span><span class="kw">sum</span>(ar_eps_val<span class="op">*</span>ar_eps_prb)</a>
<a class="sourceLine" id="cb371-13" title="13">    fl_sd_approx &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>((ar_eps_val<span class="op">-</span>fl_mean_approx)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>ar_eps_prb))</a>
<a class="sourceLine" id="cb371-14" title="14"></a>
<a class="sourceLine" id="cb371-15" title="15">    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">cdf=</span>fl_cdf_total_approx, <span class="dt">mean=</span>fl_mean_approx, <span class="dt">sd=</span>fl_sd_approx))</a>
<a class="sourceLine" id="cb371-16" title="16">  })</a>
<a class="sourceLine" id="cb371-17" title="17"></a>
<a class="sourceLine" id="cb371-18" title="18">mt_sample_means &lt;-<span class="st"> </span><span class="kw">cbind</span>(ar_it_draws, <span class="kw">as_tibble</span>(<span class="kw">t</span>(mt_fl_means)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>())</a>
<a class="sourceLine" id="cb371-19" title="19"><span class="kw">colnames</span>(mt_sample_means) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</a>
<a class="sourceLine" id="cb371-20" title="20">tb_sample_means &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_sample_means)</a>
<a class="sourceLine" id="cb371-21" title="21"></a>
<a class="sourceLine" id="cb371-22" title="22"><span class="co"># Graph</span></a>
<a class="sourceLine" id="cb371-23" title="23"><span class="co"># x-labels</span></a>
<a class="sourceLine" id="cb371-24" title="24">x.labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</a>
<a class="sourceLine" id="cb371-25" title="25">x.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb371-26" title="26"></a>
<a class="sourceLine" id="cb371-27" title="27"><span class="co"># Shared Labels</span></a>
<a class="sourceLine" id="cb371-28" title="28">slb_title_shr =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;as Even Rectangle Count Increases</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb371-29" title="29">                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</a>
<a class="sourceLine" id="cb371-30" title="30">slb_xtitle =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Number Equi-distance Rectangles Bins&#39;</span>)</a>
<a class="sourceLine" id="cb371-31" title="31"></a>
<a class="sourceLine" id="cb371-32" title="32"><span class="co"># Graph Results--Draw</span></a>
<a class="sourceLine" id="cb371-33" title="33">plt_mean &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb371-34" title="34"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>mean)) <span class="op">+</span></a>
<a class="sourceLine" id="cb371-35" title="35"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb371-36" title="36"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb371-37" title="37">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb371-38" title="38">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb371-39" title="39">       <span class="dt">y =</span> <span class="st">&#39;Integrated Mean&#39;</span>,</a>
<a class="sourceLine" id="cb371-40" title="40">       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb371-41" title="41"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb371-42" title="42"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb371-43" title="43"><span class="kw">print</span>(plt_mean)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-161-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb372-1" title="1">plt_sd &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb372-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>sd)) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb372-5" title="5">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb372-6" title="6">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb372-7" title="7">       <span class="dt">y =</span> <span class="st">&#39;Standard Deviation&#39;</span>,</a>
<a class="sourceLine" id="cb372-8" title="8">       <span class="dt">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-9" title="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-10" title="10"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb372-11" title="11"><span class="kw">print</span>(plt_sd)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-161-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" title="1">plt_cdf &lt;-<span class="st"> </span>tb_sample_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb373-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>draw_count, <span class="dt">y=</span>cdf)) <span class="op">+</span></a>
<a class="sourceLine" id="cb373-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb373-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</a>
<a class="sourceLine" id="cb373-5" title="5">       <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb373-6" title="6">       <span class="dt">x =</span> slb_xtitle,</a>
<a class="sourceLine" id="cb373-7" title="7">       <span class="dt">y =</span> <span class="st">&#39;Sum of Equi-Dist Rectangles&#39;</span>,</a>
<a class="sourceLine" id="cb373-8" title="8">       <span class="dt">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Equi-Dist Rectangle width decreases&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb373-9" title="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="dt">labels =</span> x.labels, <span class="dt">breaks =</span> x.breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb373-10" title="10"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb373-11" title="11"><span class="kw">print</span>(plt_cdf)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-161-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="analytical-solutions" class="section level2">
<h2><span class="header-section-number">8.2</span> Analytical Solutions</h2>

<div id="linear-scalar-fx0-solutions" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Linear Scalar f(x)=0 Solutions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository.</p>
</blockquote>
<div id="ratio" class="section level4">
<h4><span class="header-section-number">8.2.1.1</span> Ratio</h4>
<p>Here are some common ratios.</p>
<div id="unif-draw-min-and-max-ratio" class="section level5">
<h5><span class="header-section-number">8.2.1.1.1</span> Unif Draw Min and Max Ratio</h5>
<p>We want to draw numbers such that we have some mean <span class="math inline">\(b\)</span>, and that the possible maximum and minimum value drawn are at most <span class="math inline">\(a\)</span> times apart. Given <span class="math inline">\(b\)</span> and <span class="math inline">\(a\)</span>, solve for <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
f(x) = \frac{b+x}{b-x} - a = 0
\]</span></p>
<p><span class="math display">\[
b \cdot a - x \cdot a = b + x \\
b \cdot a - b = x + x \cdot a  \\
b \left(a - 1\right) = x \left( a+ 1\right)  \\
x = \frac{b\left(a-1\right)}{a+1}\\
\]</span></p>
<p>Uniformly draw</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb374-1" title="1">b &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb374-2" title="2">a &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb374-3" title="3">x &lt;-<span class="st"> </span>(b<span class="op">*</span>(a<span class="dv">-1</span>))<span class="op">/</span>(a<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb374-4" title="4">ar_unif_draws &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>, <span class="dt">min=</span>b<span class="op">-</span>x, <span class="dt">max=</span>b<span class="op">+</span>x)</a>
<a class="sourceLine" id="cb374-5" title="5">fl_max_min_ratio &lt;-<span class="st"> </span><span class="kw">max</span>(ar_unif_draws)<span class="op">/</span><span class="kw">min</span>(ar_unif_draws)</a>
<a class="sourceLine" id="cb374-6" title="6"><span class="kw">cat</span>(<span class="st">&#39;fl_max_min_ratio =&#39;</span>, fl_max_min_ratio, <span class="st">&#39;is close to a =&#39;</span>, a, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## fl_max_min_ratio = 1.965882 is close to a = 2</code></pre>

</div>
</div>
</div>
</div>
<div id="inequality-models" class="section level2">
<h2><span class="header-section-number">8.3</span> Inequality Models</h2>

<div id="gini-discrete-sample" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Gini Discrete Sample</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository.</p>
</blockquote>
<p>This works out how the <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> function works from <a href="https://fanwangecon.github.io/">Fan</a>â€™s <em><a href="https://fanwangecon.github.io/REconTools/">REconTools</a></em> Package.</p>
<div id="gini-formula-for-discrete-sample" class="section level4">
<h4><span class="header-section-number">8.3.1.1</span> Gini Formula for Discrete Sample</h4>
<p>There is an vector values (all positive). This could be height information for N individuals. It could also be income information for N individuals. Calculate the <a href="https://en.wikipedia.org/wiki/Gini_coefficient">GINI</a> coefficient treating the given vector as population. This is not an estimation exercise where we want to estimate population gini based on a sample. The given array is the population. The population is discrete, and only has these N individuals in the length n vector.</p>
<p>Note that when the sample size is small, there is a limit to inequality using the formula defined below given each <span class="math inline">\(N\)</span>. So for small <span class="math inline">\(N\)</span>, can not really compare inequality across arrays with different <span class="math inline">\(N\)</span>, can only compare arrays with the same <span class="math inline">\(N\)</span>. In another word, if 1 of N individual holds all resource, as <span class="math inline">\(N\)</span> increases, GINI will asymptote to 1, but it is very far away from 1 for low N.</p>
<p>The GINI formula used here is:
<span class="math display">\[
 GINI =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p>Derive the formula in the steps below.</p>
<p><em>Step 1 Area Formula</em></p>
<p><span class="math display">\[
 \Gamma = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{x_j}{\sum_{\widehat{j}=1}^N x_{\widehat{j}} }
      \right)
  \right)
\]</span></p>
<p><em>Step 2 Total Area Given Perfect equality</em></p>
<p>With perfect equality <span class="math inline">\(x_i=a\)</span> for all <span class="math inline">\(i\)</span>, so need to divide by that.</p>
<p><span class="math display">\[
 \Gamma^{\text{equal}} = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{a}{\sum_{\widehat{j}=1}^N a }
      \right)
  \right)
  = \frac{N+1}{N}\cdot\frac{1}{2}
\]</span></p>
<p>As the number of elements of the vecotr increases:
<span class="math display">\[
 \lim_{N \rightarrow \infty}\Gamma^{\text{equal}}
  = \lim_{N \rightarrow \infty} \frac{N+1}{N}\cdot\frac{1}{2}
  = \frac{1}{2}
\]</span></p>
<p><em>Step 3 Arriving at Finite Vector Gini Formula</em></p>
<p>Given what we have from above, we obtain the gini formula, divide by total area below 45 degree line.</p>
<p><span class="math display">\[
 GINI =
  1 -
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    N \cdot \sum_{i=1}^N x_i
  \right)^{-1}
  \cdot
  \left( \frac{N+1}{N}\cdot\frac{1}{2} \right)^{-1}
  =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p><em>Step 4 Maximum Inequality given N</em></p>
<p>Suppose <span class="math inline">\(x_i=0\)</span> for all <span class="math inline">\(i&lt;N\)</span>, then:</p>
<p><span class="math display">\[
 GINI^{x_i = 0 \text{ except } i=N}
 =
  1 - \frac{2}{N+1}
  \cdot
  X_N
  \cdot
  \left(
    X_N
  \right)^{-1}
 =
 1 - \frac{2}{N+1}
\]</span></p>
<p><span class="math display">\[
 \lim_{N \rightarrow \infty} GINI^{x_i = 0 \text{ except } i=N}
 =
 1 -
 \lim_{N \rightarrow \infty}
 \frac{2}{N+1}
 = 1
\]</span></p>
<p>Note that for small N, for example if <span class="math inline">\(N=10\)</span>, even when one person holds all income, all others have 0 income, the formula will not produce gini is zero, but that gini is equal to <span class="math inline">\(\frac{2}{11}\approx 0.1818\)</span>. If <span class="math inline">\(N=2\)</span>, inequality is at most, <span class="math inline">\(\frac{2}{3}\approx 0.667\)</span>.</p>
<p><span class="math display">\[
 MostUnequalGINI\left(N\right) = 1 - \frac{2}{N+1} = \frac{N-1}{N+1}
\]</span></p>
</div>
<div id="implement-gini-formula" class="section level4">
<h4><span class="header-section-number">8.3.1.2</span> Implement GINI Formula</h4>
<p>The <strong>GINI</strong> formula just derived is trivial to compute.</p>
<ol style="list-style-type: decimal">
<li>scalar: <span class="math inline">\(\frac{2}{N+1}\)</span></li>
<li>cumsum: <span class="math inline">\(\sum_{j=1}^{i} x_j\)</span></li>
<li>sum of cumsum: <span class="math inline">\(\left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)\)</span></li>
<li>sum: <span class="math inline">\(\sum_{i=1}^N X_i\)</span></li>
</ol>
<p>There are no package dependencies. Define the formula here:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb376-1" title="1"><span class="co"># Formula, directly implement the GINI formula Following Step 4 above</span></a>
<a class="sourceLine" id="cb376-2" title="2">fv_dist_gini_vector_pos_test &lt;-<span class="st"> </span><span class="cf">function</span>(ar_pos) {</a>
<a class="sourceLine" id="cb376-3" title="3">  <span class="co"># Check length and given warning</span></a>
<a class="sourceLine" id="cb376-4" title="4">  it_n &lt;-<span class="st"> </span><span class="kw">length</span>(ar_pos)</a>
<a class="sourceLine" id="cb376-5" title="5">  <span class="cf">if</span> (it_n <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span>)  <span class="kw">warning</span>(<span class="st">&#39;Data vector has n=&#39;</span>,it_n,<span class="st">&#39;, max-inequality/max-gini=&#39;</span>,(it_n<span class="dv">-1</span>)<span class="op">/</span>(it_n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb376-6" title="6">  <span class="co"># Sort</span></a>
<a class="sourceLine" id="cb376-7" title="7">  ar_pos &lt;-<span class="st"> </span><span class="kw">sort</span>(ar_pos)</a>
<a class="sourceLine" id="cb376-8" title="8">  <span class="co"># formula implement</span></a>
<a class="sourceLine" id="cb376-9" title="9">  fl_gini &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>((<span class="dv">2</span><span class="op">/</span>(it_n<span class="op">+</span><span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">cumsum</span>(ar_pos))<span class="op">*</span>(<span class="kw">sum</span>(ar_pos))<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb376-10" title="10">  <span class="kw">return</span>(fl_gini)</a>
<a class="sourceLine" id="cb376-11" title="11">}</a></code></pre></div>
<p>Generate a number of examples Arrays for testing</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" title="1"><span class="co"># Example Arrays of data</span></a>
<a class="sourceLine" id="cb377-2" title="2">ar_equal_n1 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb377-3" title="3">ar_ineql_n1 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb377-4" title="4"></a>
<a class="sourceLine" id="cb377-5" title="5">ar_equal_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb377-6" title="6">ar_ineql_alittle_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb377-7" title="7">ar_ineql_somewht_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb377-8" title="8">ar_ineql_alotine_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb377-9" title="9">ar_ineql_veryvry_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb377-10" title="10">ar_ineql_mostmst_n2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">13</span>)</a>
<a class="sourceLine" id="cb377-11" title="11"></a>
<a class="sourceLine" id="cb377-12" title="12">ar_equal_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb377-13" title="13">ar_ineql_some_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">21</span>,<span class="dv">34</span>,<span class="dv">55</span>,<span class="dv">89</span>)</a>
<a class="sourceLine" id="cb377-14" title="14">ar_ineql_very_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">5</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">8</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">13</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">21</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">34</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">55</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">89</span><span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb377-15" title="15">ar_ineql_extr_n10 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="op">^</span><span class="dv">3</span>,<span class="dv">5</span><span class="op">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="op">^</span><span class="dv">5</span>,<span class="dv">13</span><span class="op">^</span><span class="dv">6</span>,<span class="dv">21</span><span class="op">^</span><span class="dv">7</span>,<span class="dv">34</span><span class="op">^</span><span class="dv">8</span>,<span class="dv">55</span><span class="op">^</span><span class="dv">9</span>,<span class="dv">89</span><span class="op">^</span><span class="dv">10</span>)</a></code></pre></div>
<p>Now test the example arrays above using the function based no our formula:</p>
<pre><code>## 
## Small N=1 Hard-Code</code></pre>
<pre><code>## ar_equal_n1: 0</code></pre>
<pre><code>## ar_ineql_n1: 0</code></pre>
<pre><code>## 
## Small N=2 Hard-Code, converge to 1/3, see formula above</code></pre>
<pre><code>## ar_ineql_alittle_n2: 0.1111111</code></pre>
<pre><code>## ar_ineql_somewht_n2: 0.2592593</code></pre>
<pre><code>## ar_ineql_alotine_n2: 0.3131313</code></pre>
<pre><code>## ar_ineql_veryvry_n2: 0.3307393</code></pre>
<pre><code>## 
## Small N=10 Hard-Code, convege to 9/11=0.8181, see formula above</code></pre>
<pre><code>## ar_equal_n10: 0</code></pre>
<pre><code>## ar_ineql_some_n10: 0.5395514</code></pre>
<pre><code>## ar_ineql_very_n10: 0.7059554</code></pre>
<pre><code>## ar_ineql_extr_n10: 0.8181549</code></pre>

</div>
</div>
<div id="atkinson-family-utility" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Atkinson Family Utility</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository.</p>
</blockquote>
<div id="individual-outcomes-and-preference" class="section level4">
<h4><span class="header-section-number">8.3.2.1</span> Individual Outcomes and Preference</h4>
<p>How does the Aktinson Family utility function work? THe Atkinson Family Utility has the following functional form.</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
\alpha
\cdot
A^{\lambda}
+
\beta
\cdot
B^{\lambda}
\right)^{\frac{1}{\lambda}}
\]</span></p>
<p>Several key issues here:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(V^{\text{social}}\)</span> is the utility of some social planner</li>
<li><span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are allocations for Alex and Ben.</li>
<li><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are biases that a social planner has for Alex and Ben: <span class="math inline">\(\alpha+\beta=1\)</span>, <span class="math inline">\(\alpha&gt;0\)</span>, and <span class="math inline">\(\beta&gt;0\)</span></li>
<li><span class="math inline">\(-\infty &lt; \lambda \le 1\)</span> is a measure of inequality aversion
<ul>
<li><span class="math inline">\(\lambda=1\)</span> is when the planner cares about weighted total allocations (efficient, Utilitarian)</li>
<li><span class="math inline">\(\lambda=-\infty\)</span> is when the planner cares about only the minimum between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> allocations (equality, Rawlsian)</li>
</ul></li>
</ol>
<p>What if only care about Alex? Clearly, if the planner only cares about Ben, <span class="math inline">\(\beta=1\)</span>, then:</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
B^{\lambda}
\right)^{\frac{1}{\lambda}}
= B
\]</span></p>
<p>Clearly, regardless of the value of <span class="math inline">\(\lambda\)</span>, as <span class="math inline">\(B\)</span> increases <span class="math inline">\(V\)</span> increases. What Happens to V when A or B increases? What is the derivative of <span class="math inline">\(V\)</span> with respect to <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>?</p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \frac{1}{\lambda}
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1}{\lambda}-1}
    \cdot
    \lambda
    \alpha
    A^{\lambda -1}
\]</span></p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1-\lambda}{\lambda}}
    \cdot
    \alpha
    A^{\lambda -1}
    &gt;0
\]</span></p>
<p>Note that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span>. When <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(Z^{\lambda}&gt;0\)</span>. For example <span class="math inline">\(10^{-2}=\frac{1}{100}\)</span>. And For example <span class="math inline">\(0.1^{\frac{3}{-2}}=\frac{1}{0.1^{1.5}}\)</span>. Still Positive.</p>
<p>While the overall <span class="math inline">\(V\)</span> increases with increasing <span class="math inline">\(A\)</span>, but if we did not have the outter power term, the situation is different. In particular, when <span class="math inline">\(\lambda &lt; 0\)</span>:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{d \left(\alpha A^{\lambda} + \beta B^{\lambda}\right)}{dA}=\alpha\lambda A^{\lambda -1}&lt;0
\]</span>
Without the outter <span class="math inline">\(\frac{1}{\lambda}\)</span> power, negative <span class="math inline">\(\lambda\)</span> would lead to decreasing weighted sum. But:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{dG^{\frac{1}{\lambda}}}{dG}=\frac{1}{\lambda}\cdot G^{\frac{1-\lambda}{\lambda}}&lt;0
\]</span>
so when <span class="math inline">\(G\)</span> is increasing and <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> would decrease. But when <span class="math inline">\(G\left(A,B\right)\)</span> is decreasing, as is the case with increasing <span class="math inline">\(A\)</span> when <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> will actually increase. This confirms that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span> for <span class="math inline">\(\lambda &lt;0\)</span>. The result is symmetric for <span class="math inline">\(\lambda &gt;0\)</span>.</p>
</div>
<div id="indifference-curve-graph" class="section level4">
<h4><span class="header-section-number">8.3.2.2</span> Indifference Curve Graph</h4>
<p>Given <span class="math inline">\(V^{\ast}\)</span>, we can show the combinations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> points that provide the same utility. We want to be able to potentially draw multiple indifference curves at the same time. Note that indifference curves are defined by <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\lambda\)</span> only. Each indifference curve is a set of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> coordinates. So to generate multiple indifference curves means to generate many sets of <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> associated with different planner preferences, and then these could be graphed out.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb391-1" title="1"><span class="co"># A as x-axis, need bounds on A</span></a>
<a class="sourceLine" id="cb391-2" title="2">fl_A_min =<span class="st"> </span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb391-3" title="3">fl_A_max =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb391-4" title="4">it_A_grid =<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb391-5" title="5"></a>
<a class="sourceLine" id="cb391-6" title="6"><span class="co"># Define parameters</span></a>
<a class="sourceLine" id="cb391-7" title="7"><span class="co"># ar_lambda &lt;- 1 - (10^(c(seq(-2,2, length.out=3))))</span></a>
<a class="sourceLine" id="cb391-8" title="8">ar_lambda &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.06</span>, <span class="dv">-6</span>)</a>
<a class="sourceLine" id="cb391-9" title="9">ar_beta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="dt">length.out =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb391-10" title="10">ar_beta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb391-11" title="11">ar_v_star &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb391-12" title="12">tb_pref &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">cbind</span>(ar_lambda)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb391-13" title="13"><span class="st">  </span><span class="kw">expand_grid</span>(ar_beta) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">expand_grid</span>(ar_v_star) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb391-14" title="14"><span class="st">  </span><span class="kw">rename_all</span>(<span class="op">~</span><span class="kw">c</span>(<span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb391-15" title="15"><span class="st">  </span><span class="kw">rowid_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;indiff_id&quot;</span>)</a>
<a class="sourceLine" id="cb391-16" title="16"></a>
<a class="sourceLine" id="cb391-17" title="17"><span class="co"># Generate indifference points with apply and anonymous function</span></a>
<a class="sourceLine" id="cb391-18" title="18"><span class="co"># tb_pref, whatever is selected from it, must be all numeric</span></a>
<a class="sourceLine" id="cb391-19" title="19"><span class="co"># if there are strings, would cause conversion error.</span></a>
<a class="sourceLine" id="cb391-20" title="20">ls_df_indiff &lt;-<span class="st"> </span><span class="kw">apply</span>(tb_pref, <span class="dv">1</span>, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb391-21" title="21">  indiff_id &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb391-22" title="22">  lambda &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb391-23" title="23">  beta &lt;-<span class="st"> </span>x[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb391-24" title="24">  vstar &lt;-<span class="st"> </span>x[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb391-25" title="25">  ar_fl_A_indiff &lt;-<span class="st"> </span><span class="kw">seq</span>(fl_A_min, fl_A_max, <span class="dt">length.out=</span>it_A_grid)</a>
<a class="sourceLine" id="cb391-26" title="26">  ar_fl_B_indiff &lt;-<span class="st"> </span>(((vstar<span class="op">^</span>lambda) <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb391-27" title="27"><span class="st">                        </span>(beta<span class="op">*</span>ar_fl_A_indiff<span class="op">^</span>(lambda)))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>beta))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>lambda)</a>
<a class="sourceLine" id="cb391-28" title="28">  mt_A_B_indiff &lt;-<span class="st"> </span><span class="kw">cbind</span>(indiff_id, lambda, beta, vstar,</a>
<a class="sourceLine" id="cb391-29" title="29">                         ar_fl_A_indiff, ar_fl_B_indiff)</a>
<a class="sourceLine" id="cb391-30" title="30">  <span class="kw">colnames</span>(mt_A_B_indiff) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;indiff_id&#39;</span>, <span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>,</a>
<a class="sourceLine" id="cb391-31" title="31">                               <span class="st">&#39;indiff_A&#39;</span>, <span class="st">&#39;indiff_B&#39;</span>)</a>
<a class="sourceLine" id="cb391-32" title="32">  tb_A_B_indiff &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_A_B_indiff) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb391-33" title="33"><span class="st">    </span><span class="kw">rowid_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;A_grid_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb391-34" title="34"><span class="st">    </span><span class="kw">filter</span>(indiff_B <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>indiff_B <span class="op">&lt;=</span><span class="st"> </span><span class="kw">max</span>(ar_fl_A_indiff))</a>
<a class="sourceLine" id="cb391-35" title="35">  <span class="kw">return</span>(tb_A_B_indiff)</a>
<a class="sourceLine" id="cb391-36" title="36">})</a>
<a class="sourceLine" id="cb391-37" title="37">df_indiff &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, ls_df_indiff) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>()</a></code></pre></div>
<p>Note that many more A grid points are needed to fully plot out the leontief line.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb392-1" title="1"><span class="co"># Labeling</span></a>
<a class="sourceLine" id="cb392-2" title="2">st_title &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Indifference Curves Aktinson Atkinson Utility (CES)&#39;</span>)</a>
<a class="sourceLine" id="cb392-3" title="3">st_subtitle &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Each Panel Different beta=A</span><span class="ch">\&#39;</span><span class="st">s Weight lambda=inequality aversion</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb392-4" title="4">                      <span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</a>
<a class="sourceLine" id="cb392-5" title="5">                      <span class="st">&#39;R4Econ/math/func_ineq/htmlpdfr/fs_atkinson_ces.html&#39;</span>)</a>
<a class="sourceLine" id="cb392-6" title="6">st_caption &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Indifference Curve 2 Individuals, &#39;</span>,</a>
<a class="sourceLine" id="cb392-7" title="7">                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</a>
<a class="sourceLine" id="cb392-8" title="8">st_x_label &lt;-<span class="st"> &#39;A&#39;</span></a>
<a class="sourceLine" id="cb392-9" title="9">st_y_label &lt;-<span class="st"> &#39;B&#39;</span></a>
<a class="sourceLine" id="cb392-10" title="10"></a>
<a class="sourceLine" id="cb392-11" title="11"><span class="co"># Graphing</span></a>
<a class="sourceLine" id="cb392-12" title="12">plt_indiff &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb392-13" title="13"><span class="st">  </span>df_indiff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">lambda =</span> <span class="kw">as_factor</span>(lambda),</a>
<a class="sourceLine" id="cb392-14" title="14">                       <span class="dt">beta =</span> <span class="kw">as_factor</span>(beta),</a>
<a class="sourceLine" id="cb392-15" title="15">                       <span class="dt">vstar =</span> <span class="kw">as_factor</span>(vstar)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb392-16" title="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>indiff_A, <span class="dt">y=</span>indiff_B,</a>
<a class="sourceLine" id="cb392-17" title="17">             <span class="dt">colour=</span>lambda)) <span class="op">+</span></a>
<a class="sourceLine" id="cb392-18" title="18"><span class="st">  </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>beta) <span class="op">+</span></a>
<a class="sourceLine" id="cb392-19" title="19"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb392-20" title="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> st_title, <span class="dt">subtitle =</span> st_subtitle,</a>
<a class="sourceLine" id="cb392-21" title="21">       <span class="dt">x =</span> st_x_label, <span class="dt">y =</span> st_y_label, <span class="dt">caption =</span> st_caption) <span class="op">+</span></a>
<a class="sourceLine" id="cb392-22" title="22"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb392-23" title="23"></a>
<a class="sourceLine" id="cb392-24" title="24"><span class="co"># show</span></a>
<a class="sourceLine" id="cb392-25" title="25"><span class="kw">print</span>(plt_indiff)</a></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-169-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="optimization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tables-and-graphs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
