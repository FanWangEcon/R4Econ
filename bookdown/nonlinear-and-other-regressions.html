<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Nonlinear and Other Regressions | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Nonlinear and Other Regressions | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Nonlinear and Other Regressions | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2021-03-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="optimization.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-dataframes"><i class="fa fa-check"></i><b>1.4.5</b> String Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarize-data.html"><a href="summarize-data.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.2.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.3.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.4" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-compare"><i class="fa fa-check"></i><b>4.3</b> Join and Compare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.1</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.1.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.1.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.2</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.2.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#analytical-solutions"><i class="fa fa-check"></i><b>8.1</b> Analytical Solutions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.1</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.2</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.2</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.2.1</b> Gini Discrete Sample</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.2.2</b> Gini Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.2.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.2.3</b> Atkinson Inequality Index</a></li>
<li class="chapter" data-level="8.2.4" data-path="mathematics.html"><a href="mathematics.html#location-population-and-pollution"><i class="fa fa-check"></i><b>8.2.4</b> Location, Population, and Pollution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.1.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> GGplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> GGplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-and-development.html"><a href="code-and-development.html"><i class="fa fa-check"></i><b>12</b> Code and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="code-and-development.html"><a href="code-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.1</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="code-and-development.html"><a href="code-and-development.html#file-path"><i class="fa fa-check"></i><b>12.1.1</b> File Path</a></li>
<li class="chapter" data-level="12.1.2" data-path="code-and-development.html"><a href="code-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.1.2</b> Text to File</a></li>
<li class="chapter" data-level="12.1.3" data-path="code-and-development.html"><a href="code-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.1.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="code-and-development.html"><a href="code-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.2</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="code-and-development.html"><a href="code-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.2.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="code-and-development.html"><a href="code-and-development.html#command-line"><i class="fa fa-check"></i><b>12.3</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="code-and-development.html"><a href="code-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.3.1</b> Shell and System Commands</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate, Gather, Bind and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-join-and-comparejoin-and-compare-links"><i class="fa fa-check"></i><b>A.4.3</b> <span>Section 4.3 Join and Compare</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Quantile Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-analytical-solutionsanalytical-solutions-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Analytical Solutions</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 Distributions</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> <span>Section 10.2 GGplot Line Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> <span>Section 10.3 GGplot Scatter Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> <span>Section 10.4 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> <span>Section 11.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#code-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Code and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.1</b> <span>Section 12.1 Files In and Out</span> links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.2</b> <span>Section 12.2 Python with R</span> links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.3</b> <span>Section 12.3 Command Line</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nonlinear-and-other-regressions" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Nonlinear and Other Regressions</h1>

<div id="logit-regression" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Logit Regression</h2>

<div id="binary-logit" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Binary Logit</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p><em>Data Preparation</em></p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="nonlinear-and-other-regressions.html#cb392-1" aria-hidden="true" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb392-2"><a href="nonlinear-and-other-regressions.html#cb392-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-3"><a href="nonlinear-and-other-regressions.html#cb392-3" aria-hidden="true" tabindex="-1"></a><span class="co"># X-variables to use on RHS</span></span>
<span id="cb392-4"><a href="nonlinear-and-other-regressions.html#cb392-4" aria-hidden="true" tabindex="-1"></a>ls_st_xs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mpg&#39;</span>, <span class="st">&#39;qsec&#39;</span>)</span>
<span id="cb392-5"><a href="nonlinear-and-other-regressions.html#cb392-5" aria-hidden="true" tabindex="-1"></a>ls_st_xs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mpg&#39;</span>)</span>
<span id="cb392-6"><a href="nonlinear-and-other-regressions.html#cb392-6" aria-hidden="true" tabindex="-1"></a>ls_st_xs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;qsec&#39;</span>)</span>
<span id="cb392-7"><a href="nonlinear-and-other-regressions.html#cb392-7" aria-hidden="true" tabindex="-1"></a>ls_st_xs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;wt&#39;</span>)</span>
<span id="cb392-8"><a href="nonlinear-and-other-regressions.html#cb392-8" aria-hidden="true" tabindex="-1"></a>ls_st_xs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mpg&#39;</span>, <span class="st">&#39;wt&#39;</span>, <span class="st">&#39;vs&#39;</span>)</span>
<span id="cb392-9"><a href="nonlinear-and-other-regressions.html#cb392-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-10"><a href="nonlinear-and-other-regressions.html#cb392-10" aria-hidden="true" tabindex="-1"></a>svr_binary <span class="ot">&lt;-</span> <span class="st">&#39;hpLowHigh&#39;</span></span>
<span id="cb392-11"><a href="nonlinear-and-other-regressions.html#cb392-11" aria-hidden="true" tabindex="-1"></a>svr_binary_lb0 <span class="ot">&lt;-</span> <span class="st">&#39;LowHP&#39;</span></span>
<span id="cb392-12"><a href="nonlinear-and-other-regressions.html#cb392-12" aria-hidden="true" tabindex="-1"></a>svr_binary_lb1 <span class="ot">&lt;-</span> <span class="st">&#39;HighHP&#39;</span></span>
<span id="cb392-13"><a href="nonlinear-and-other-regressions.html#cb392-13" aria-hidden="true" tabindex="-1"></a>svr_outcome <span class="ot">&lt;-</span> <span class="st">&#39;am&#39;</span></span>
<span id="cb392-14"><a href="nonlinear-and-other-regressions.html#cb392-14" aria-hidden="true" tabindex="-1"></a>sdt_name <span class="ot">&lt;-</span> <span class="st">&#39;mtcars&#39;</span></span>
<span id="cb392-15"><a href="nonlinear-and-other-regressions.html#cb392-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-16"><a href="nonlinear-and-other-regressions.html#cb392-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Discretize hp</span></span>
<span id="cb392-17"><a href="nonlinear-and-other-regressions.html#cb392-17" aria-hidden="true" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb392-18"><a href="nonlinear-and-other-regressions.html#cb392-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_binary) <span class="sc">:</span><span class="er">=</span> <span class="fu">cut</span>(hp,</span>
<span id="cb392-19"><a href="nonlinear-and-other-regressions.html#cb392-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">210</span>, <span class="cn">Inf</span>),</span>
<span id="cb392-20"><a href="nonlinear-and-other-regressions.html#cb392-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels=</span><span class="fu">c</span>(svr_binary_lb0, svr_binary_lb1)))</span></code></pre></div>
<div id="logit-regresion-and-prediction" class="section level4" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Logit Regresion and Prediction</h4>
<p>logit regression with glm, and predict using estimation data. Prediction and estimation with one variable.</p>
<ul>
<li><a href="https://stats.idre.ucla.edu/r/dae/logit-regression/">LOGIT REGRESSION R DATA ANALYSIS EXAMPLES</a></li>
<li><a href="https://www.statmethods.net/advstats/glm.html">Generalized Linear Models</a></li>
</ul>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="nonlinear-and-other-regressions.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress</span></span>
<span id="cb393-2"><a href="nonlinear-and-other-regressions.html#cb393-2" aria-hidden="true" tabindex="-1"></a>rs_logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(svr_outcome, <span class="st">&quot;~&quot;</span>, <span class="fu">paste</span>(ls_st_xs, <span class="at">collapse=</span><span class="st">&quot;+&quot;</span>)))</span>
<span id="cb393-3"><a href="nonlinear-and-other-regressions.html#cb393-3" aria-hidden="true" tabindex="-1"></a>                ,<span class="at">data =</span> df_mtcars, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb393-4"><a href="nonlinear-and-other-regressions.html#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rs_logit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.formula(paste(svr_outcome, &quot;~&quot;, paste(ls_st_xs, 
##     collapse = &quot;+&quot;))), family = &quot;binomial&quot;, data = df_mtcars)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.73603  -0.25477  -0.04891   0.13402   1.90321  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept) 22.69008   13.95112   1.626   0.1039  
## mpg         -0.01786    0.33957  -0.053   0.9581  
## wt          -6.73804    3.01400  -2.236   0.0254 *
## vs          -4.44046    2.84247  -1.562   0.1182  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.230  on 31  degrees of freedom
## Residual deviance: 13.092  on 28  degrees of freedom
## AIC: 21.092
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="nonlinear-and-other-regressions.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predcit Using Regression Data</span></span>
<span id="cb395-2"><a href="nonlinear-and-other-regressions.html#cb395-2" aria-hidden="true" tabindex="-1"></a>df_mtcars<span class="sc">$</span>p_mpg <span class="ot">&lt;-</span> <span class="fu">predict</span>(rs_logit, <span class="at">newdata =</span> df_mtcars, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<div id="prediction-with-observed-binary-input" class="section level5" number="6.1.1.1.1">
<h5><span class="header-section-number">6.1.1.1.1</span> Prediction with Observed Binary Input</h5>
<p>Logit regression with a continuous variable and a binary variable. Predict outcome with observed continuous variable as well as observed binary input variable.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="nonlinear-and-other-regressions.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress</span></span>
<span id="cb396-2"><a href="nonlinear-and-other-regressions.html#cb396-2" aria-hidden="true" tabindex="-1"></a>rs_logit_bi <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(svr_outcome,</span>
<span id="cb396-3"><a href="nonlinear-and-other-regressions.html#cb396-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;~ factor(&quot;</span>, svr_binary,<span class="st">&quot;) + &quot;</span>,</span>
<span id="cb396-4"><a href="nonlinear-and-other-regressions.html#cb396-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">paste</span>(ls_st_xs, <span class="at">collapse=</span><span class="st">&quot;+&quot;</span>)))</span>
<span id="cb396-5"><a href="nonlinear-and-other-regressions.html#cb396-5" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">data =</span> df_mtcars, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb396-6"><a href="nonlinear-and-other-regressions.html#cb396-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rs_logit_bi)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.formula(paste(svr_outcome, &quot;~ factor(&quot;, svr_binary, 
##     &quot;) + &quot;, paste(ls_st_xs, collapse = &quot;+&quot;))), family = &quot;binomial&quot;, 
##     data = df_mtcars)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.45771  -0.09563  -0.00875   0.00555   1.87612  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)               3.8285    18.0390   0.212   0.8319  
## factor(hpLowHigh)HighHP   6.9907     5.5176   1.267   0.2052  
## mpg                       0.8985     0.8906   1.009   0.3131  
## wt                       -6.7291     3.3166  -2.029   0.0425 *
## vs                       -5.9206     4.1908  -1.413   0.1577  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.2297  on 31  degrees of freedom
## Residual deviance:  8.9777  on 27  degrees of freedom
## AIC: 18.978
## 
## Number of Fisher Scoring iterations: 9</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="nonlinear-and-other-regressions.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predcit Using Regresion Data</span></span>
<span id="cb398-2"><a href="nonlinear-and-other-regressions.html#cb398-2" aria-hidden="true" tabindex="-1"></a>df_mtcars<span class="sc">$</span>p_mpg_hp <span class="ot">&lt;-</span> <span class="fu">predict</span>(rs_logit_bi, <span class="at">newdata =</span> df_mtcars, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb398-3"><a href="nonlinear-and-other-regressions.html#cb398-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-4"><a href="nonlinear-and-other-regressions.html#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted Probabilities am on mgp with or without hp binary</span></span>
<span id="cb398-5"><a href="nonlinear-and-other-regressions.html#cb398-5" aria-hidden="true" tabindex="-1"></a>scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_mtcars, <span class="fu">aes</span>(<span class="at">x=</span>p_mpg_hp, <span class="at">y=</span>p_mpg)) <span class="sc">+</span></span>
<span id="cb398-6"><a href="nonlinear-and-other-regressions.html#cb398-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb398-7"><a href="nonlinear-and-other-regressions.html#cb398-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># geom_smooth(method=lm) + # Trend line</span></span>
<span id="cb398-8"><a href="nonlinear-and-other-regressions.html#cb398-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 45 degree line</span></span>
<span id="cb398-9"><a href="nonlinear-and-other-regressions.html#cb398-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Predicted Probabilities &#39;</span>, svr_outcome, <span class="st">&#39; on &#39;</span>, ls_st_xs, <span class="st">&#39; with or without hp binary&#39;</span>),</span>
<span id="cb398-10"><a href="nonlinear-and-other-regressions.html#cb398-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&#39;prediction with &#39;</span>, ls_st_xs, <span class="st">&#39; and binary &#39;</span>, svr_binary, <span class="st">&#39; indicator, 1 is high&#39;</span>),</span>
<span id="cb398-11"><a href="nonlinear-and-other-regressions.html#cb398-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&#39;prediction with only &#39;</span>, ls_st_xs),</span>
<span id="cb398-12"><a href="nonlinear-and-other-regressions.html#cb398-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">caption =</span> <span class="st">&#39;mtcars; prediction based on observed data&#39;</span>) <span class="sc">+</span></span>
<span id="cb398-13"><a href="nonlinear-and-other-regressions.html#cb398-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>()</span>
<span id="cb398-14"><a href="nonlinear-and-other-regressions.html#cb398-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/logit%20with%20binary%20and%20continuous%20RHS-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="prediction-with-binary-set-to-0-and-1" class="section level5" number="6.1.1.1.2">
<h5><span class="header-section-number">6.1.1.1.2</span> Prediction with Binary set to 0 and 1</h5>
<p>Now generate two predictions. One set where binary input is equal to 0, and another where the binary inputs are equal to 1. Ignore whether in data binary input is equal to 0 or 1. Use the same regression results as what was just derived.</p>
<p>Note that given the example here, the probability changes a lot when we</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="nonlinear-and-other-regressions.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Previous regression results</span></span>
<span id="cb399-2"><a href="nonlinear-and-other-regressions.html#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rs_logit_bi)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.formula(paste(svr_outcome, &quot;~ factor(&quot;, svr_binary, 
##     &quot;) + &quot;, paste(ls_st_xs, collapse = &quot;+&quot;))), family = &quot;binomial&quot;, 
##     data = df_mtcars)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.45771  -0.09563  -0.00875   0.00555   1.87612  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)               3.8285    18.0390   0.212   0.8319  
## factor(hpLowHigh)HighHP   6.9907     5.5176   1.267   0.2052  
## mpg                       0.8985     0.8906   1.009   0.3131  
## wt                       -6.7291     3.3166  -2.029   0.0425 *
## vs                       -5.9206     4.1908  -1.413   0.1577  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.2297  on 31  degrees of freedom
## Residual deviance:  8.9777  on 27  degrees of freedom
## AIC: 18.978
## 
## Number of Fisher Scoring iterations: 9</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="nonlinear-and-other-regressions.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two different dataframes, mutate the binary regressor</span></span>
<span id="cb401-2"><a href="nonlinear-and-other-regressions.html#cb401-2" aria-hidden="true" tabindex="-1"></a>df_mtcars_bi0 <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_binary) <span class="sc">:</span><span class="er">=</span> svr_binary_lb0)</span>
<span id="cb401-3"><a href="nonlinear-and-other-regressions.html#cb401-3" aria-hidden="true" tabindex="-1"></a>df_mtcars_bi1 <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_binary) <span class="sc">:</span><span class="er">=</span> svr_binary_lb1)</span>
<span id="cb401-4"><a href="nonlinear-and-other-regressions.html#cb401-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-5"><a href="nonlinear-and-other-regressions.html#cb401-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predcit Using Regresion Data</span></span>
<span id="cb401-6"><a href="nonlinear-and-other-regressions.html#cb401-6" aria-hidden="true" tabindex="-1"></a>df_mtcars<span class="sc">$</span>p_mpg_hp_bi0 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rs_logit_bi, <span class="at">newdata =</span> df_mtcars_bi0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb401-7"><a href="nonlinear-and-other-regressions.html#cb401-7" aria-hidden="true" tabindex="-1"></a>df_mtcars<span class="sc">$</span>p_mpg_hp_bi1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rs_logit_bi, <span class="at">newdata =</span> df_mtcars_bi1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb401-8"><a href="nonlinear-and-other-regressions.html#cb401-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-9"><a href="nonlinear-and-other-regressions.html#cb401-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted Probabilities and Binary Input</span></span>
<span id="cb401-10"><a href="nonlinear-and-other-regressions.html#cb401-10" aria-hidden="true" tabindex="-1"></a>scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_mtcars, <span class="fu">aes</span>(<span class="at">x=</span>p_mpg_hp_bi0)) <span class="sc">+</span></span>
<span id="cb401-11"><a href="nonlinear-and-other-regressions.html#cb401-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>p_mpg_hp), <span class="at">size=</span><span class="dv">4</span>, <span class="at">shape=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb401-12"><a href="nonlinear-and-other-regressions.html#cb401-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>p_mpg_hp_bi1), <span class="at">size=</span><span class="dv">2</span>, <span class="at">shape=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb401-13"><a href="nonlinear-and-other-regressions.html#cb401-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># geom_smooth(method=lm) + # Trend line</span></span>
<span id="cb401-14"><a href="nonlinear-and-other-regressions.html#cb401-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 45 degree line</span></span>
<span id="cb401-15"><a href="nonlinear-and-other-regressions.html#cb401-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Predicted Probabilities and Binary Input&#39;</span>,</span>
<span id="cb401-16"><a href="nonlinear-and-other-regressions.html#cb401-16" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&#39;</span><span class="sc">\n</span><span class="st">cross(shape=4)/red is predict actual binary data&#39;</span>,</span>
<span id="cb401-17"><a href="nonlinear-and-other-regressions.html#cb401-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&#39;</span><span class="sc">\n</span><span class="st">star(shape=8)/black is predict set binary = 1 for all&#39;</span>),</span>
<span id="cb401-18"><a href="nonlinear-and-other-regressions.html#cb401-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&#39;prediction with &#39;</span>, ls_st_xs, <span class="st">&#39; and binary &#39;</span>, svr_binary, <span class="st">&#39; = 0 for all&#39;</span>),</span>
<span id="cb401-19"><a href="nonlinear-and-other-regressions.html#cb401-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&#39;prediction with &#39;</span>, ls_st_xs, <span class="st">&#39; and binary &#39;</span>, svr_binary, <span class="st">&#39; = 1&#39;</span>),</span>
<span id="cb401-20"><a href="nonlinear-and-other-regressions.html#cb401-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">caption =</span> <span class="fu">paste0</span>(sdt_name)) <span class="sc">+</span></span>
<span id="cb401-21"><a href="nonlinear-and-other-regressions.html#cb401-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>()</span>
<span id="cb401-22"><a href="nonlinear-and-other-regressions.html#cb401-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/logit%20prediction%200%20vs%201-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="prediction-with-binary-set-to-0-and-1-difference" class="section level5" number="6.1.1.1.3">
<h5><span class="header-section-number">6.1.1.1.3</span> Prediction with Binary set to 0 and 1 Difference</h5>
<p>What is the difference in probability between binary = 0 vs binary = 1. How does that relate to the probability of outcome of interest when binary = 0 for all.</p>
<p>In the binary logit case, the relationship will be humpâ€“shaped by construction between <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span>. In the exponential wage cases, the relationship is convex upwards.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="nonlinear-and-other-regressions.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Gap Variable</span></span>
<span id="cb402-2"><a href="nonlinear-and-other-regressions.html#cb402-2" aria-hidden="true" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alpha_i =</span> p_mpg_hp_bi1 <span class="sc">-</span> p_mpg_hp_bi0) <span class="sc">%&gt;%</span></span>
<span id="cb402-3"><a href="nonlinear-and-other-regressions.html#cb402-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">A_i =</span> p_mpg_hp_bi0)</span>
<span id="cb402-4"><a href="nonlinear-and-other-regressions.html#cb402-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-5"><a href="nonlinear-and-other-regressions.html#cb402-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Binary Marginal Effects and Prediction without Binary</span></span>
<span id="cb402-6"><a href="nonlinear-and-other-regressions.html#cb402-6" aria-hidden="true" tabindex="-1"></a>scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_mtcars, <span class="fu">aes</span>(<span class="at">x=</span>A_i)) <span class="sc">+</span></span>
<span id="cb402-7"><a href="nonlinear-and-other-regressions.html#cb402-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>alpha_i), <span class="at">size=</span><span class="dv">4</span>, <span class="at">shape=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb402-8"><a href="nonlinear-and-other-regressions.html#cb402-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 45 degree line</span></span>
<span id="cb402-9"><a href="nonlinear-and-other-regressions.html#cb402-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Binary Marginal Effects and Prediction without Binary&#39;</span>),</span>
<span id="cb402-10"><a href="nonlinear-and-other-regressions.html#cb402-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">&#39;P(binary=0) for all&#39;</span>,</span>
<span id="cb402-11"><a href="nonlinear-and-other-regressions.html#cb402-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">&#39;P(binary=1) - P(binary=0) gap&#39;</span>,</span>
<span id="cb402-12"><a href="nonlinear-and-other-regressions.html#cb402-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">caption =</span> <span class="fu">paste0</span>(sdt_name)) <span class="sc">+</span></span>
<span id="cb402-13"><a href="nonlinear-and-other-regressions.html#cb402-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>()</span>
<span id="cb402-14"><a href="nonlinear-and-other-regressions.html#cb402-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/logit%20prediction%20marginal%20vs%20base-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="x-variables-and-a-and-alpha" class="section level5" number="6.1.1.1.4">
<h5><span class="header-section-number">6.1.1.1.4</span> X variables and A and alpha</h5>
<p>Given the x-variables included in the logit regression, how do they relate to A_i and alpha_i</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="nonlinear-and-other-regressions.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Gap Variable</span></span>
<span id="cb403-2"><a href="nonlinear-and-other-regressions.html#cb403-2" aria-hidden="true" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alpha_i =</span> p_mpg_hp_bi1 <span class="sc">-</span> p_mpg_hp_bi0) <span class="sc">%&gt;%</span></span>
<span id="cb403-3"><a href="nonlinear-and-other-regressions.html#cb403-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">A_i =</span> p_mpg_hp_bi0)</span>
<span id="cb403-4"><a href="nonlinear-and-other-regressions.html#cb403-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-5"><a href="nonlinear-and-other-regressions.html#cb403-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Binary Marginal Effects and Prediction without Binary</span></span>
<span id="cb403-6"><a href="nonlinear-and-other-regressions.html#cb403-6" aria-hidden="true" tabindex="-1"></a>ggplot.A.alpha.x <span class="ot">&lt;-</span> <span class="cf">function</span>(svr_x, df,</span>
<span id="cb403-7"><a href="nonlinear-and-other-regressions.html#cb403-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">svr_alpha =</span> <span class="st">&#39;alpha_i&#39;</span>, <span class="at">svr_A =</span> <span class="st">&quot;A_i&quot;</span>){</span>
<span id="cb403-8"><a href="nonlinear-and-other-regressions.html#cb403-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-9"><a href="nonlinear-and-other-regressions.html#cb403-9" aria-hidden="true" tabindex="-1"></a>  scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_x))) <span class="sc">+</span></span>
<span id="cb403-10"><a href="nonlinear-and-other-regressions.html#cb403-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>alpha_i), <span class="at">size=</span><span class="dv">4</span>, <span class="at">shape=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb403-11"><a href="nonlinear-and-other-regressions.html#cb403-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>A_i), <span class="at">size=</span><span class="dv">2</span>, <span class="at">shape=</span><span class="dv">8</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb403-12"><a href="nonlinear-and-other-regressions.html#cb403-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 45 degree line</span></span>
<span id="cb403-13"><a href="nonlinear-and-other-regressions.html#cb403-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;A (blue) and alpha (red) vs x variables=&#39;</span>, svr_x),</span>
<span id="cb403-14"><a href="nonlinear-and-other-regressions.html#cb403-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> svr_x,</span>
<span id="cb403-15"><a href="nonlinear-and-other-regressions.html#cb403-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Probabilities&#39;</span>,</span>
<span id="cb403-16"><a href="nonlinear-and-other-regressions.html#cb403-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="fu">paste0</span>(sdt_name)) <span class="sc">+</span></span>
<span id="cb403-17"><a href="nonlinear-and-other-regressions.html#cb403-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()</span>
<span id="cb403-18"><a href="nonlinear-and-other-regressions.html#cb403-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-19"><a href="nonlinear-and-other-regressions.html#cb403-19" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(scatter)</span>
<span id="cb403-20"><a href="nonlinear-and-other-regressions.html#cb403-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb403-21"><a href="nonlinear-and-other-regressions.html#cb403-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-22"><a href="nonlinear-and-other-regressions.html#cb403-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot over multiple</span></span>
<span id="cb403-23"><a href="nonlinear-and-other-regressions.html#cb403-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(ls_st_xs,</span>
<span id="cb403-24"><a href="nonlinear-and-other-regressions.html#cb403-24" aria-hidden="true" tabindex="-1"></a>       ggplot.A.alpha.x,</span>
<span id="cb403-25"><a href="nonlinear-and-other-regressions.html#cb403-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> df_mtcars)</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-206-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-206-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-206-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
<div id="quantile-regression" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Quantile Regression</h2>

<div id="quantile-regression-basics" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Quantile Regression Basics</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="estimate-mean-and-conditional-quantile-coefficients-using-mtcars-dataset" class="section level4" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> Estimate Mean and Conditional Quantile Coefficients using mtcars dataset</h4>
<p>Here, we conduct tests for using the <a href="https://cran.r-project.org/web/packages/quantreg/index.html">quantreg</a> package, using the built-in <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html">mtcars</a> dataset.</p>
<p>First, estimate the mean (OLS) regression:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="nonlinear-and-other-regressions.html#cb407-1" aria-hidden="true" tabindex="-1"></a>fit_mean <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">factor</span>(am) <span class="sc">+</span> <span class="fu">factor</span>(vs), <span class="at">data =</span> mtcars)</span>
<span id="cb407-2"><a href="nonlinear-and-other-regressions.html#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_mean)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp + hp + factor(am) + factor(vs), data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.7981 -1.9532  0.0111  1.5665  5.6321 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 24.832119   2.890418   8.591 3.32e-09 ***
## disp        -0.008304   0.010087  -0.823  0.41757    
## hp          -0.037623   0.013846  -2.717  0.01135 *  
## factor(am)1  4.419257   1.493243   2.960  0.00634 ** 
## factor(vs)1  2.052472   1.627096   1.261  0.21794    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.812 on 27 degrees of freedom
## Multiple R-squared:  0.8104, Adjusted R-squared:  0.7823 
## F-statistic: 28.85 on 4 and 27 DF,  p-value: 2.13e-09</code></pre>
<p>Now estimate conditional quantile regressions (not that this remains linear) at various quantiles, standard error obtained via bootstrap. Note that there is a gradient in the quantile hp coefficients as well as disp. disp sign reverses, also the coefficient on factor am is different by quantiles:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="nonlinear-and-other-regressions.html#cb409-1" aria-hidden="true" tabindex="-1"></a>ls_fl_quantiles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>)</span>
<span id="cb409-2"><a href="nonlinear-and-other-regressions.html#cb409-2" aria-hidden="true" tabindex="-1"></a>fit_quantiles <span class="ot">&lt;-</span> <span class="fu">rq</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">factor</span>(am),</span>
<span id="cb409-3"><a href="nonlinear-and-other-regressions.html#cb409-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">tau =</span> ls_fl_quantiles,</span>
<span id="cb409-4"><a href="nonlinear-and-other-regressions.html#cb409-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mtcars)</span>
<span id="cb409-5"><a href="nonlinear-and-other-regressions.html#cb409-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_quantiles, <span class="at">se =</span> <span class="st">&quot;boot&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call: rq(formula = mpg ~ disp + hp + factor(am), tau = ls_fl_quantiles, 
##     data = mtcars)
## 
## tau: [1] 0.25
## 
## Coefficients:
##             Value    Std. Error t value  Pr(&gt;|t|)
## (Intercept) 25.34665  1.38870   18.25209  0.00000
## disp        -0.02441  0.00798   -3.06028  0.00484
## hp          -0.01672  0.01409   -1.18621  0.24551
## factor(am)1  1.39719  1.41689    0.98610  0.33253
## 
## Call: rq(formula = mpg ~ disp + hp + factor(am), tau = ls_fl_quantiles, 
##     data = mtcars)
## 
## tau: [1] 0.5
## 
## Coefficients:
##             Value    Std. Error t value  Pr(&gt;|t|)
## (Intercept) 27.49722  1.75659   15.65379  0.00000
## disp        -0.02253  0.01634   -1.37904  0.17880
## hp          -0.02713  0.02414   -1.12386  0.27062
## factor(am)1  3.37328  2.25738    1.49434  0.14627
## 
## Call: rq(formula = mpg ~ disp + hp + factor(am), tau = ls_fl_quantiles, 
##     data = mtcars)
## 
## tau: [1] 0.75
## 
## Coefficients:
##             Value    Std. Error t value  Pr(&gt;|t|)
## (Intercept) 28.06384  1.68640   16.64124  0.00000
## disp         0.00445  0.01457    0.30566  0.76212
## hp          -0.06662  0.01795   -3.71247  0.00090
## factor(am)1  7.91402  2.36999    3.33926  0.00239</code></pre>
</div>
<div id="test-conditional-quantile-coefficients-if-different" class="section level4" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> Test Conditional Quantile Coefficients if Different</h4>
<p>Use the rq.anova function frm the quantile regression packge to conduct WALD test. Remember WALD test says given unrestricted modelâ€™s estimates, test where null is that the coefficients satisfy some linear restrictions.</p>
<p>To test, use the returned object from running rq with different numbers of quantiles, and set the option <em>joint</em> to true or false. When joint is true: â€œequality of slopes should be done as joint tests on all slope parameters,â€ when joint is false: â€œseparate tests on each of the slope parameters should be reported.â€ A slope parameter refers to one of the RHS variables.</p>
<p>Note that quantile tests are â€œparallel lineâ€ tests. Meaning that we should except to have different x-intercepts for each quantile, because they represents the levels of the conditional shocks distributions. However, if quantile coefficients for the slopes are all the same, then there are no quantile specific effects, mean effects would be sufficient.</p>
<p>see:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/32743758/anova-rq-in-quantreg-package-in-r">anova.rq() in quantreg package in R</a></li>
</ul>
<div id="test-statistical-difference-between-25th-and-50th-conditional-quantiles" class="section level5" number="6.2.1.2.1">
<h5><span class="header-section-number">6.2.1.2.1</span> Test Statistical Difference between 25th and 50th Conditional Quantiles</h5>
<p>Given the quantile estimates above, the difference between 0.25 and 0.50 quantiles exists, but are they sufficiently large to be statistically different? What is the p-value? Reviewing the results below, they are not statistically different.</p>
<p>First, joint = TRUE. This is not testing if the coefficien on disp is the same as the coefficient on hp. This is testing jointly if the coefficients for different quantiles of disp, and different quantiles of hp are the same for each RHS variable.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="nonlinear-and-other-regressions.html#cb411-1" aria-hidden="true" tabindex="-1"></a>ls_fl_quantiles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>)</span>
<span id="cb411-2"><a href="nonlinear-and-other-regressions.html#cb411-2" aria-hidden="true" tabindex="-1"></a>fit_quantiles <span class="ot">&lt;-</span> <span class="fu">rq</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">factor</span>(am),</span>
<span id="cb411-3"><a href="nonlinear-and-other-regressions.html#cb411-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">tau =</span> ls_fl_quantiles,</span>
<span id="cb411-4"><a href="nonlinear-and-other-regressions.html#cb411-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mtcars)</span>
<span id="cb411-5"><a href="nonlinear-and-other-regressions.html#cb411-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_quantiles, <span class="at">test =</span> <span class="st">&quot;Wald&quot;</span>, <span class="at">joint=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Quantile Regression Analysis of Deviance Table
## 
## Model: mpg ~ disp + hp + factor(am)
## Joint Test of Equality of Slopes: tau in {  0.25 0.5  }
## 
##   Df Resid Df F value Pr(&gt;F)
## 1  3       61  0.7986 0.4994</code></pre>
<p>Second, joint = False:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="nonlinear-and-other-regressions.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_quantiles, <span class="at">test =</span> <span class="st">&quot;Wald&quot;</span>, <span class="at">joint=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Quantile Regression Analysis of Deviance Table
## 
## Model: mpg ~ disp + hp + factor(am)
## Tests of Equality of Distinct Slopes: tau in {  0.25 0.5  }
## 
##             Df Resid Df F value Pr(&gt;F)
## disp         1       63  0.0304 0.8621
## hp           1       63  0.5397 0.4653
## factor(am)1  1       63  1.0957 0.2992</code></pre>
</div>
<div id="test-statistical-difference-between-25th-50th-and-75th-conditional-quantiles" class="section level5" number="6.2.1.2.2">
<h5><span class="header-section-number">6.2.1.2.2</span> Test Statistical Difference between 25th, 50th, and 75th Conditional Quantiles</h5>
<p>The 1st quartile and median do not seem to be statistically different, now include the 3rd quartile. As seen earlier, the quartiles jointly show a gradient. Now, we can see that idisp, hp and am are separately have statistically different</p>
<p>First, joint = TRUE:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="nonlinear-and-other-regressions.html#cb415-1" aria-hidden="true" tabindex="-1"></a>ls_fl_quantiles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>)</span>
<span id="cb415-2"><a href="nonlinear-and-other-regressions.html#cb415-2" aria-hidden="true" tabindex="-1"></a>fit_quantiles <span class="ot">&lt;-</span> <span class="fu">rq</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">factor</span>(am),</span>
<span id="cb415-3"><a href="nonlinear-and-other-regressions.html#cb415-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">tau =</span> ls_fl_quantiles,</span>
<span id="cb415-4"><a href="nonlinear-and-other-regressions.html#cb415-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mtcars)</span>
<span id="cb415-5"><a href="nonlinear-and-other-regressions.html#cb415-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_quantiles, <span class="at">test =</span> <span class="st">&quot;Wald&quot;</span>, <span class="at">joint=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Quantile Regression Analysis of Deviance Table
## 
## Model: mpg ~ disp + hp + factor(am)
## Joint Test of Equality of Slopes: tau in {  0.25 0.5 0.75  }
## 
##   Df Resid Df F value   Pr(&gt;F)   
## 1  6       90   3.957 0.001475 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Second, joint = False:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="nonlinear-and-other-regressions.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_quantiles, <span class="at">test =</span> <span class="st">&quot;Wald&quot;</span>, <span class="at">joint=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Quantile Regression Analysis of Deviance Table
## 
## Model: mpg ~ disp + hp + factor(am)
## Tests of Equality of Distinct Slopes: tau in {  0.25 0.5 0.75  }
## 
##             Df Resid Df F value    Pr(&gt;F)    
## disp         2       94  9.2284 0.0002191 ***
## hp           2       94  6.5798 0.0021162 ** 
## factor(am)1  2       94  3.6669 0.0292803 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
