<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Manipulate and Summarize Dataframes | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="Running parallel code in R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Manipulate and Summarize Dataframes | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Running parallel code in R" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Manipulate and Summarize Dataframes | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="Running parallel code in R" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="array-matrix-dataframe.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#regular-expression-date-etc."><i class="fa fa-check"></i><b>1.4</b> Regular Expression, Date, etc.</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-regular-expression"><i class="fa fa-check"></i><b>1.4.1</b> String Regular Expression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html"><i class="fa fa-check"></i><b>2</b> Manipulate and Summarize Dataframes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#variables-in-dataframes"><i class="fa fa-check"></i><b>2.1</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-dataframe"><i class="fa fa-check"></i><b>2.1.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="2.1.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-categorical-variables"><i class="fa fa-check"></i><b>2.1.2</b> Generate Categorical Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#drawly-random-rows"><i class="fa fa-check"></i><b>2.1.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="2.1.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>2.1.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="2.1.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#string-dataframes"><i class="fa fa-check"></i><b>2.1.5</b> String Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-observation"><i class="fa fa-check"></i><b>2.2</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-and-tabulations"><i class="fa fa-check"></i><b>2.2.1</b> Counting and Tabulations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.3</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-1"><i class="fa fa-check"></i><b>2.3.1</b> Sorting</a></li>
<li class="chapter" data-level="2.3.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.3.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#advanced-group-aggregation"><i class="fa fa-check"></i><b>2.4</b> Advanced Group Aggregation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.4.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.4.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#groups-statistics"><i class="fa fa-check"></i><b>2.4.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.4.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.4.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.4.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.4.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#distributional-statistics"><i class="fa fa-check"></i><b>2.5</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#histogram"><i class="fa fa-check"></i><b>2.5.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.6</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#apply-function-over-multiple-columns-and-rows"><i class="fa fa-check"></i><b>2.6.1</b> Apply Function Over Multiple Columns and Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-table-to-wide-table"><i class="fa fa-check"></i><b>4.2.1</b> Long Table to Wide Table</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-comparisons-and-statistics"><i class="fa fa-check"></i><b>4.3</b> Within Panel Comparisons and Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
<li class="chapter" data-level="4.3.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-cross-time-and-cross-group-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Within Panel Cross-time and Cross-group Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-merge-files-together-by-keys"><i class="fa fa-check"></i><b>4.4</b> Join and Merge Files Together by Keys</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#mesh-join"><i class="fa fa-check"></i><b>4.4.1</b> Mesh Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#linear-and-polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Linear and Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#fit-curves-through-points"><i class="fa fa-check"></i><b>5.1.1</b> Fit Curves Through Points</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#grid-based-optimization"><i class="fa fa-check"></i><b>7.1</b> Grid Based Optimization</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#find-maximum-by-iterating-over-grids"><i class="fa fa-check"></i><b>7.1.1</b> Find Maximum By Iterating Over Grids</a></li>
<li class="chapter" data-level="7.1.2" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1.2</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#polynomial-formulas-for-points"><i class="fa fa-check"></i><b>8.1.1</b> Polynomial Formulas for Points</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.3</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.4</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.5" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.5</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-functions"><i class="fa fa-check"></i><b>8.2</b> Production Functions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#latent-dynamic-health-production-function"><i class="fa fa-check"></i><b>8.2.2</b> Latent Dynamic Health Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot-basics"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot Basics</a></li>
<li class="chapter" data-level="10.2.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-advanced"><i class="fa fa-check"></i><b>10.2.2</b> ggplot Line Advanced</a></li>
<li class="chapter" data-level="10.2.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#time-series-plots-with-shaded-areas"><i class="fa fa-check"></i><b>10.2.3</b> Time-series Plots with Shaded Areas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="coding-and-development.html"><a href="coding-and-development.html"><i class="fa fa-check"></i><b>12</b> Coding and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="coding-and-development.html"><a href="coding-and-development.html#installation-and-packages"><i class="fa fa-check"></i><b>12.1</b> Installation and Packages</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="coding-and-development.html"><a href="coding-and-development.html#r-installation-and-set-up"><i class="fa fa-check"></i><b>12.1.1</b> R Installation and Set-Up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="coding-and-development.html"><a href="coding-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.2</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="coding-and-development.html"><a href="coding-and-development.html#file-path"><i class="fa fa-check"></i><b>12.2.1</b> File Path</a></li>
<li class="chapter" data-level="12.2.2" data-path="coding-and-development.html"><a href="coding-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.2.2</b> Text to File</a></li>
<li class="chapter" data-level="12.2.3" data-path="coding-and-development.html"><a href="coding-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.2.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="coding-and-development.html"><a href="coding-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.3</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="coding-and-development.html"><a href="coding-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.3.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="coding-and-development.html"><a href="coding-and-development.html#command-line"><i class="fa fa-check"></i><b>12.4</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="coding-and-development.html"><a href="coding-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.4.1</b> Shell and System Commands</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="coding-and-development.html"><a href="coding-and-development.html#run-code-in-parallel-in-r"><i class="fa fa-check"></i><b>12.5</b> Run Code in Parallel in R</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="coding-and-development.html"><a href="coding-and-development.html#parallel-loop-in-r"><i class="fa fa-check"></i><b>12.5.1</b> Parallel Loop in R</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> Section 1.1 List links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> Section 1.2 Array links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> Section 1.3 Matrix links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-regular-expression-date-etc.regular-expression-date-etc.-links"><i class="fa fa-check"></i><b>A.1.4</b> Section 1.4 Regular Expression, Date, etc. links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#manipulate-and-summarize-dataframes-links"><i class="fa fa-check"></i><b>A.2</b> Manipulate and Summarize Dataframes links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.2.1</b> Section 2.1 Variables in Dataframes links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.2</b> Section 2.2 Counting Observation links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.3</b> Section 2.3 Sorting, Indexing, Slicing links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-advanced-group-aggregationadvanced-group-aggregation-links"><i class="fa fa-check"></i><b>A.2.4</b> Section 2.4 Advanced Group Aggregation links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.5</b> Section 2.5 Distributional Statistics links</a></li>
<li class="chapter" data-level="A.2.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.6-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.6</b> Section 2.6 Summarize Multiple Variables links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> Section 3.1 Dataframe Mutate links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> Section 3.2 Dataframe Do Anything links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> Section 3.3 Apply and pmap links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> Section 4.1 Generate, Gather, Bind and Join links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> Section 4.2 Wide and Long links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-within-panel-comparisons-and-statisticswithin-panel-comparisons-and-statistics-links"><i class="fa fa-check"></i><b>A.4.3</b> Section 4.3 Within Panel Comparisons and Statistics links</a></li>
<li class="chapter" data-level="A.4.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.4-join-and-merge-files-together-by-keysjoin-and-merge-files-together-by-keys-links"><i class="fa fa-check"></i><b>A.4.4</b> Section 4.4 Join and Merge Files Together by Keys links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-linear-and-polynomial-fittinglinear-and-polynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> Section 5.1 Linear and Polynomial Fitting links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> Section 5.2 OLS and IV links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> Section 5.3 Decomposition links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> Section 6.1 Logit Regression links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> Section 6.2 Quantile Regression links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-grid-based-optimizationgrid-based-optimization-links"><i class="fa fa-check"></i><b>A.7.1</b> Section 7.1 Grid Based Optimization links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> Section 8.1 Basics links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionsproduction-functions-links"><i class="fa fa-check"></i><b>A.8.2</b> Section 8.2 Production Functions links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> Section 8.3 Inequality Models links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> Section 9.1 Random Draws links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> Section 9.2 Distributions links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> Section 9.3 Discrete Random Variable links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> Section 10.1 R Base Plots links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> Section 10.2 ggplot Line Related Plots links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> Section 10.3 ggplot Scatter Related Plots links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> Section 10.4 Write and Read Plots links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> Section 11.1 Environmental Data links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#coding-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Coding and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-installation-and-packagesinstallation-and-packages-links"><i class="fa fa-check"></i><b>A.12.1</b> Section 12.1 Installation and Packages links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.2</b> Section 12.2 Files In and Out links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.3</b> Section 12.3 Python with R links</a></li>
<li class="chapter" data-level="A.12.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.4-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.4</b> Section 12.4 Command Line links</a></li>
<li class="chapter" data-level="A.12.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.5-run-code-in-parallel-in-rrun-code-in-parallel-in-r-links"><i class="fa fa-check"></i><b>A.12.5</b> Section 12.5 Run Code in Parallel in R links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipulate-and-summarize-dataframes" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Manipulate and Summarize Dataframes<a href="manipulate-and-summarize-dataframes.html#manipulate-and-summarize-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="variables-in-dataframes" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Variables in Dataframes<a href="manipulate-and-summarize-dataframes.html#variables-in-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<!-- includes:
  in_header: ../../preamble.tex -->
<div id="generate-dataframe" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Generate Dataframe<a href="manipulate-and-summarize-dataframes.html#generate-dataframe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="simple-dataframe-name-columns" class="section level4 hasAnchor" number="2.1.1.1">
<h4><span class="header-section-number">2.1.1.1</span> Simple Dataframe, Name Columns<a href="manipulate-and-summarize-dataframes.html#simple-dataframe-name-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="manipulate-and-summarize-dataframes.html#cb227-1" tabindex="-1"></a><span class="co"># 5 by 3 matrix</span></span>
<span id="cb227-2"><a href="manipulate-and-summarize-dataframes.html#cb227-2" tabindex="-1"></a>mt_rnorm_a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb227-3"><a href="manipulate-and-summarize-dataframes.html#cb227-3" tabindex="-1"></a></span>
<span id="cb227-4"><a href="manipulate-and-summarize-dataframes.html#cb227-4" tabindex="-1"></a><span class="co"># Column Names</span></span>
<span id="cb227-5"><a href="manipulate-and-summarize-dataframes.html#cb227-5" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>,<span class="st">&#39;var1&#39;</span>,<span class="st">&#39;varb&#39;</span>,<span class="st">&#39;vartheta&#39;</span>)</span>
<span id="cb227-6"><a href="manipulate-and-summarize-dataframes.html#cb227-6" tabindex="-1"></a></span>
<span id="cb227-7"><a href="manipulate-and-summarize-dataframes.html#cb227-7" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb227-8"><a href="manipulate-and-summarize-dataframes.html#cb227-8" tabindex="-1"></a>tb_combine <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_rnorm_a) <span class="sc">%&gt;%</span></span>
<span id="cb227-9"><a href="manipulate-and-summarize-dataframes.html#cb227-9" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-10"><a href="manipulate-and-summarize-dataframes.html#cb227-10" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb227-11"><a href="manipulate-and-summarize-dataframes.html#cb227-11" tabindex="-1"></a></span>
<span id="cb227-12"><a href="manipulate-and-summarize-dataframes.html#cb227-12" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb227-13"><a href="manipulate-and-summarize-dataframes.html#cb227-13" tabindex="-1"></a><span class="fu">kable</span>(tb_combine) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
varb
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vartheta
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1.1655448
</td>
<td style="text-align:right;">
-0.8185157
</td>
<td style="text-align:right;">
0.6849361
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.8185157
</td>
<td style="text-align:right;">
0.6849361
</td>
<td style="text-align:right;">
-0.3200564
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.6849361
</td>
<td style="text-align:right;">
-0.3200564
</td>
<td style="text-align:right;">
-1.1655448
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-0.3200564
</td>
<td style="text-align:right;">
-1.1655448
</td>
<td style="text-align:right;">
-0.8185157
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-1.1655448
</td>
<td style="text-align:right;">
-0.8185157
</td>
<td style="text-align:right;">
0.6849361
</td>
</tr>
</tbody>
</table>
</div>
<div id="dataframe-with-row-and-column-names-and-export" class="section level4 hasAnchor" number="2.1.1.2">
<h4><span class="header-section-number">2.1.1.2</span> Dataframe with Row and Column Names and Export<a href="manipulate-and-summarize-dataframes.html#dataframe-with-row-and-column-names-and-export" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, we generate an empty matrix. Second, we compute values to fill in matrix cells.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="manipulate-and-summarize-dataframes.html#cb228-1" tabindex="-1"></a><span class="co"># an NA matrix</span></span>
<span id="cb228-2"><a href="manipulate-and-summarize-dataframes.html#cb228-2" tabindex="-1"></a>it_nrow <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb228-3"><a href="manipulate-and-summarize-dataframes.html#cb228-3" tabindex="-1"></a>it_ncol <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb228-4"><a href="manipulate-and-summarize-dataframes.html#cb228-4" tabindex="-1"></a>mt_na <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span>it_nrow, <span class="at">ncol=</span>it_ncol)</span>
<span id="cb228-5"><a href="manipulate-and-summarize-dataframes.html#cb228-5" tabindex="-1"></a></span>
<span id="cb228-6"><a href="manipulate-and-summarize-dataframes.html#cb228-6" tabindex="-1"></a><span class="co"># array of nrow values</span></span>
<span id="cb228-7"><a href="manipulate-and-summarize-dataframes.html#cb228-7" tabindex="-1"></a>ar_it_nrow <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, it_nrow)</span>
<span id="cb228-8"><a href="manipulate-and-summarize-dataframes.html#cb228-8" tabindex="-1"></a>ar_it_ncol <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, it_ncol)</span>
<span id="cb228-9"><a href="manipulate-and-summarize-dataframes.html#cb228-9" tabindex="-1"></a></span>
<span id="cb228-10"><a href="manipulate-and-summarize-dataframes.html#cb228-10" tabindex="-1"></a><span class="co"># Generate values in matrix</span></span>
<span id="cb228-11"><a href="manipulate-and-summarize-dataframes.html#cb228-11" tabindex="-1"></a><span class="cf">for</span> (it_row <span class="cf">in</span> ar_it_nrow) {</span>
<span id="cb228-12"><a href="manipulate-and-summarize-dataframes.html#cb228-12" tabindex="-1"></a>  <span class="cf">for</span> (it_col <span class="cf">in</span> ar_it_ncol) {</span>
<span id="cb228-13"><a href="manipulate-and-summarize-dataframes.html#cb228-13" tabindex="-1"></a>    <span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;row={it_row} and col={it_col}&quot;</span>))</span>
<span id="cb228-14"><a href="manipulate-and-summarize-dataframes.html#cb228-14" tabindex="-1"></a>    mt_na[it_row, it_col] <span class="ot">=</span> it_row<span class="sc">*</span>it_col <span class="sc">+</span> it_row <span class="sc">+</span> it_col</span>
<span id="cb228-15"><a href="manipulate-and-summarize-dataframes.html#cb228-15" tabindex="-1"></a>  }</span>
<span id="cb228-16"><a href="manipulate-and-summarize-dataframes.html#cb228-16" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## row=1 and col=1
## row=1 and col=2
## row=1 and col=3
## row=2 and col=1
## row=2 and col=2
## row=2 and col=3
## row=3 and col=1
## row=3 and col=2
## row=3 and col=3
## row=4 and col=1
## row=4 and col=2
## row=4 and col=3
## row=5 and col=1
## row=5 and col=2
## row=5 and col=3</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="manipulate-and-summarize-dataframes.html#cb230-1" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb230-2"><a href="manipulate-and-summarize-dataframes.html#cb230-2" tabindex="-1"></a><span class="fu">kable</span>(mt_na) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
19
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
23
</td>
</tr>
</tbody>
</table>
<p>Third, we label the rows and the columns. Note that we will include the column names as column names, but the row names will be included as a variable.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="manipulate-and-summarize-dataframes.html#cb231-1" tabindex="-1"></a><span class="co"># Column Names</span></span>
<span id="cb231-2"><a href="manipulate-and-summarize-dataframes.html#cb231-2" tabindex="-1"></a>ar_st_col_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;colval=&#39;</span>, ar_it_ncol) </span>
<span id="cb231-3"><a href="manipulate-and-summarize-dataframes.html#cb231-3" tabindex="-1"></a>ar_st_row_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;rowval=&#39;</span>, ar_it_nrow) </span>
<span id="cb231-4"><a href="manipulate-and-summarize-dataframes.html#cb231-4" tabindex="-1"></a></span>
<span id="cb231-5"><a href="manipulate-and-summarize-dataframes.html#cb231-5" tabindex="-1"></a><span class="co"># Create tibble, and add in column and row names</span></span>
<span id="cb231-6"><a href="manipulate-and-summarize-dataframes.html#cb231-6" tabindex="-1"></a>tb_row_col_named <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_na) <span class="sc">%&gt;%</span></span>
<span id="cb231-7"><a href="manipulate-and-summarize-dataframes.html#cb231-7" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_col_names)) <span class="sc">%&gt;%</span></span>
<span id="cb231-8"><a href="manipulate-and-summarize-dataframes.html#cb231-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row_name =</span> ar_st_row_names) <span class="sc">%&gt;%</span></span>
<span id="cb231-9"><a href="manipulate-and-summarize-dataframes.html#cb231-9" tabindex="-1"></a>  <span class="fu">select</span>(row_name, <span class="fu">everything</span>())</span>
<span id="cb231-10"><a href="manipulate-and-summarize-dataframes.html#cb231-10" tabindex="-1"></a></span>
<span id="cb231-11"><a href="manipulate-and-summarize-dataframes.html#cb231-11" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb231-12"><a href="manipulate-and-summarize-dataframes.html#cb231-12" tabindex="-1"></a><span class="fu">kable</span>(tb_row_col_named) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
row_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
colval=1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
colval=2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
colval=3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
rowval=1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
rowval=2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
rowval=3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
rowval=4
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
19
</td>
</tr>
<tr>
<td style="text-align:left;">
rowval=5
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
23
</td>
</tr>
</tbody>
</table>
<p>Finally, we generate a file name for exporting this tibble to a CSV file. We create a file name with a time stamp.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="manipulate-and-summarize-dataframes.html#cb232-1" tabindex="-1"></a><span class="co"># Create a file name with date stamp</span></span>
<span id="cb232-2"><a href="manipulate-and-summarize-dataframes.html#cb232-2" tabindex="-1"></a>st_datetime <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">format</span>(<span class="fu">Sys.time</span>(),  <span class="st">&quot;%Y%m%d-%H%M%S&quot;</span>)</span>
<span id="cb232-3"><a href="manipulate-and-summarize-dataframes.html#cb232-3" tabindex="-1"></a><span class="co"># Copying a fixed date to avoid generating multiple testing files</span></span>
<span id="cb232-4"><a href="manipulate-and-summarize-dataframes.html#cb232-4" tabindex="-1"></a><span class="co"># The date string below is generated by Sys.time()</span></span>
<span id="cb232-5"><a href="manipulate-and-summarize-dataframes.html#cb232-5" tabindex="-1"></a>st_snm_filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;tibble_out_test_&quot;</span>, st_datetime, <span class="st">&#39;.csv&#39;</span>)</span>
<span id="cb232-6"><a href="manipulate-and-summarize-dataframes.html#cb232-6" tabindex="-1"></a></span>
<span id="cb232-7"><a href="manipulate-and-summarize-dataframes.html#cb232-7" tabindex="-1"></a><span class="co"># Create a file name with the time stamp. </span></span>
<span id="cb232-8"><a href="manipulate-and-summarize-dataframes.html#cb232-8" tabindex="-1"></a>spn_file_path <span class="ot">=</span> <span class="fu">file.path</span>(</span>
<span id="cb232-9"><a href="manipulate-and-summarize-dataframes.html#cb232-9" tabindex="-1"></a>  <span class="st">&quot;C:&quot;</span>, <span class="st">&quot;Users&quot;</span>, <span class="st">&quot;fan&quot;</span>, </span>
<span id="cb232-10"><a href="manipulate-and-summarize-dataframes.html#cb232-10" tabindex="-1"></a>  <span class="st">&quot;R4Econ&quot;</span>, <span class="st">&quot;amto&quot;</span>, <span class="st">&quot;tibble&quot;</span>, <span class="st">&quot;_file&quot;</span>,</span>
<span id="cb232-11"><a href="manipulate-and-summarize-dataframes.html#cb232-11" tabindex="-1"></a>  st_snm_filename,</span>
<span id="cb232-12"><a href="manipulate-and-summarize-dataframes.html#cb232-12" tabindex="-1"></a>  <span class="at">fsep =</span> .Platform<span class="sc">$</span>file.sep)</span>
<span id="cb232-13"><a href="manipulate-and-summarize-dataframes.html#cb232-13" tabindex="-1"></a></span>
<span id="cb232-14"><a href="manipulate-and-summarize-dataframes.html#cb232-14" tabindex="-1"></a><span class="co"># Save to file</span></span>
<span id="cb232-15"><a href="manipulate-and-summarize-dataframes.html#cb232-15" tabindex="-1"></a><span class="fu">write_csv</span>(tb_row_col_named, spn_file_path)</span></code></pre></div>
</div>
<div id="generate-tibble-given-matrixes-and-arrays" class="section level4 hasAnchor" number="2.1.1.3">
<h4><span class="header-section-number">2.1.1.3</span> Generate Tibble given Matrixes and Arrays<a href="manipulate-and-summarize-dataframes.html#generate-tibble-given-matrixes-and-arrays" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given Arrays and Matrixes, Generate Tibble and Name Variables/Columns</p>
<ul>
<li>naming tibble columns</li>
<li>tibble variable names</li>
<li>dplyr rename tibble</li>
<li>dplyr rename tibble all variables</li>
<li>dplyr rename all columns by index</li>
<li>dplyr tibble add index column</li>
<li>see also: <a href="https://stackoverflow.com/questions/45535157/difference-between-dplyrrename-and-dplyrrename-all">SO-51205520</a></li>
</ul>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="manipulate-and-summarize-dataframes.html#cb233-1" tabindex="-1"></a><span class="co"># Base Inputs</span></span>
<span id="cb233-2"><a href="manipulate-and-summarize-dataframes.html#cb233-2" tabindex="-1"></a>ar_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb233-3"><a href="manipulate-and-summarize-dataframes.html#cb233-3" tabindex="-1"></a>mt_rnorm_a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb233-4"><a href="manipulate-and-summarize-dataframes.html#cb233-4" tabindex="-1"></a>mt_rnorm_b <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb233-5"><a href="manipulate-and-summarize-dataframes.html#cb233-5" tabindex="-1"></a></span>
<span id="cb233-6"><a href="manipulate-and-summarize-dataframes.html#cb233-6" tabindex="-1"></a><span class="co"># Combine Matrix</span></span>
<span id="cb233-7"><a href="manipulate-and-summarize-dataframes.html#cb233-7" tabindex="-1"></a>mt_combine <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_col, mt_rnorm_a, mt_rnorm_b)</span>
<span id="cb233-8"><a href="manipulate-and-summarize-dataframes.html#cb233-8" tabindex="-1"></a><span class="fu">colnames</span>(mt_combine) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;ar_col&#39;</span>,</span>
<span id="cb233-9"><a href="manipulate-and-summarize-dataframes.html#cb233-9" tabindex="-1"></a>                          <span class="fu">paste0</span>(<span class="st">&#39;matcolvar_grpa_&#39;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">dim</span>(mt_rnorm_a)[<span class="dv">2</span>])),</span>
<span id="cb233-10"><a href="manipulate-and-summarize-dataframes.html#cb233-10" tabindex="-1"></a>                          <span class="fu">paste0</span>(<span class="st">&#39;matcolvar_grpb_&#39;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">dim</span>(mt_rnorm_b)[<span class="dv">2</span>])))</span>
<span id="cb233-11"><a href="manipulate-and-summarize-dataframes.html#cb233-11" tabindex="-1"></a></span>
<span id="cb233-12"><a href="manipulate-and-summarize-dataframes.html#cb233-12" tabindex="-1"></a><span class="co"># Variable Names</span></span>
<span id="cb233-13"><a href="manipulate-and-summarize-dataframes.html#cb233-13" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;var_one&#39;</span>,</span>
<span id="cb233-14"><a href="manipulate-and-summarize-dataframes.html#cb233-14" tabindex="-1"></a>                    <span class="fu">paste0</span>(<span class="st">&#39;tibcolvar_ga_&#39;</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)),</span>
<span id="cb233-15"><a href="manipulate-and-summarize-dataframes.html#cb233-15" tabindex="-1"></a>                    <span class="fu">paste0</span>(<span class="st">&#39;tibcolvar_gb_&#39;</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)))</span>
<span id="cb233-16"><a href="manipulate-and-summarize-dataframes.html#cb233-16" tabindex="-1"></a></span>
<span id="cb233-17"><a href="manipulate-and-summarize-dataframes.html#cb233-17" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb233-18"><a href="manipulate-and-summarize-dataframes.html#cb233-18" tabindex="-1"></a>tb_combine <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_combine) <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb233-19"><a href="manipulate-and-summarize-dataframes.html#cb233-19" tabindex="-1"></a></span>
<span id="cb233-20"><a href="manipulate-and-summarize-dataframes.html#cb233-20" tabindex="-1"></a><span class="co"># Add an index column to the dataframe, ID column</span></span>
<span id="cb233-21"><a href="manipulate-and-summarize-dataframes.html#cb233-21" tabindex="-1"></a>tb_combine <span class="ot">&lt;-</span> tb_combine <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb233-22"><a href="manipulate-and-summarize-dataframes.html#cb233-22" tabindex="-1"></a></span>
<span id="cb233-23"><a href="manipulate-and-summarize-dataframes.html#cb233-23" tabindex="-1"></a><span class="co"># Change all gb variable names</span></span>
<span id="cb233-24"><a href="manipulate-and-summarize-dataframes.html#cb233-24" tabindex="-1"></a>tb_combine <span class="ot">&lt;-</span> tb_combine <span class="sc">%&gt;%</span></span>
<span id="cb233-25"><a href="manipulate-and-summarize-dataframes.html#cb233-25" tabindex="-1"></a>                  <span class="fu">rename_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;tibcolvar_gb_&quot;</span>)),</span>
<span id="cb233-26"><a href="manipulate-and-summarize-dataframes.html#cb233-26" tabindex="-1"></a>                            <span class="fu">funs</span>(<span class="fu">str_replace</span>(., <span class="st">&quot;_gb_&quot;</span>, <span class="st">&quot;_gbrenamed_&quot;</span>)))</span>
<span id="cb233-27"><a href="manipulate-and-summarize-dataframes.html#cb233-27" tabindex="-1"></a></span>
<span id="cb233-28"><a href="manipulate-and-summarize-dataframes.html#cb233-28" tabindex="-1"></a><span class="co"># Tibble back to matrix</span></span>
<span id="cb233-29"><a href="manipulate-and-summarize-dataframes.html#cb233-29" tabindex="-1"></a>mt_tb_combine_back <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(tb_combine)</span>
<span id="cb233-30"><a href="manipulate-and-summarize-dataframes.html#cb233-30" tabindex="-1"></a></span>
<span id="cb233-31"><a href="manipulate-and-summarize-dataframes.html#cb233-31" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb233-32"><a href="manipulate-and-summarize-dataframes.html#cb233-32" tabindex="-1"></a><span class="fu">kable</span>(mt_combine) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_col
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
matcolvar_grpa_1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
matcolvar_grpa_2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
matcolvar_grpb_1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
matcolvar_grpb_2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
matcolvar_grpb_3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
matcolvar_grpb_4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1.3115224
</td>
<td style="text-align:right;">
-0.1294107
</td>
<td style="text-align:right;">
-0.1513960
</td>
<td style="text-align:right;">
-3.2273228
</td>
<td style="text-align:right;">
-0.1513960
</td>
<td style="text-align:right;">
-3.2273228
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5996083
</td>
<td style="text-align:right;">
0.8867361
</td>
<td style="text-align:right;">
0.3297912
</td>
<td style="text-align:right;">
-0.7717918
</td>
<td style="text-align:right;">
0.3297912
</td>
<td style="text-align:right;">
-0.7717918
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="manipulate-and-summarize-dataframes.html#cb234-1" tabindex="-1"></a><span class="fu">kable</span>(tb_combine) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var_one
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_ga_1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_ga_2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1.3115224
</td>
<td style="text-align:right;">
-0.1294107
</td>
<td style="text-align:right;">
-0.1513960
</td>
<td style="text-align:right;">
-3.2273228
</td>
<td style="text-align:right;">
-0.1513960
</td>
<td style="text-align:right;">
-3.2273228
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5996083
</td>
<td style="text-align:right;">
0.8867361
</td>
<td style="text-align:right;">
0.3297912
</td>
<td style="text-align:right;">
-0.7717918
</td>
<td style="text-align:right;">
0.3297912
</td>
<td style="text-align:right;">
-0.7717918
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="manipulate-and-summarize-dataframes.html#cb235-1" tabindex="-1"></a><span class="fu">kable</span>(mt_tb_combine_back) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var_one
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_ga_1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_ga_2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tibcolvar_gbrenamed_4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1.3115224
</td>
<td style="text-align:right;">
-0.1294107
</td>
<td style="text-align:right;">
-0.1513960
</td>
<td style="text-align:right;">
-3.2273228
</td>
<td style="text-align:right;">
-0.1513960
</td>
<td style="text-align:right;">
-3.2273228
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5996083
</td>
<td style="text-align:right;">
0.8867361
</td>
<td style="text-align:right;">
0.3297912
</td>
<td style="text-align:right;">
-0.7717918
</td>
<td style="text-align:right;">
0.3297912
</td>
<td style="text-align:right;">
-0.7717918
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="generate-a-table-from-lists" class="section level4 hasAnchor" number="2.1.1.4">
<h4><span class="header-section-number">2.1.1.4</span> Generate a Table from Lists<a href="manipulate-and-summarize-dataframes.html#generate-a-table-from-lists" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We run some function, whose outputs are named list, we store the values of the named list as additional rows into a dataframe whose column names are the names from named list.</p>
<p>First, we generate the function that returns named lists.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="manipulate-and-summarize-dataframes.html#cb236-1" tabindex="-1"></a><span class="co"># Define a function</span></span>
<span id="cb236-2"><a href="manipulate-and-summarize-dataframes.html#cb236-2" tabindex="-1"></a>ffi_list_generator <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">it_seed=</span><span class="dv">123</span>) {</span>
<span id="cb236-3"><a href="manipulate-and-summarize-dataframes.html#cb236-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_seed)</span>
<span id="cb236-4"><a href="manipulate-and-summarize-dataframes.html#cb236-4" tabindex="-1"></a>  fl_abc <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb236-5"><a href="manipulate-and-summarize-dataframes.html#cb236-5" tabindex="-1"></a>  ar_efg <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">3</span>)</span>
<span id="cb236-6"><a href="manipulate-and-summarize-dataframes.html#cb236-6" tabindex="-1"></a>  st_word <span class="ot">&lt;-</span> <span class="fu">sample</span>(LETTERS, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb236-7"><a href="manipulate-and-summarize-dataframes.html#cb236-7" tabindex="-1"></a>  ls_return <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;abc&quot;</span> <span class="ot">=</span> fl_abc, <span class="st">&quot;efg&quot;</span> <span class="ot">=</span> ar_efg, <span class="st">&quot;opq&quot;</span> <span class="ot">=</span> st_word)</span>
<span id="cb236-8"><a href="manipulate-and-summarize-dataframes.html#cb236-8" tabindex="-1"></a>  <span class="fu">return</span>(ls_return)</span>
<span id="cb236-9"><a href="manipulate-and-summarize-dataframes.html#cb236-9" tabindex="-1"></a>}</span>
<span id="cb236-10"><a href="manipulate-and-summarize-dataframes.html#cb236-10" tabindex="-1"></a><span class="co"># Run the function</span></span>
<span id="cb236-11"><a href="manipulate-and-summarize-dataframes.html#cb236-11" tabindex="-1"></a>it_seed<span class="ot">=</span><span class="dv">123</span></span>
<span id="cb236-12"><a href="manipulate-and-summarize-dataframes.html#cb236-12" tabindex="-1"></a>ls_return <span class="ot">&lt;-</span> <span class="fu">ffi_list_generator</span>(it_seed) </span>
<span id="cb236-13"><a href="manipulate-and-summarize-dataframes.html#cb236-13" tabindex="-1"></a><span class="fu">print</span>(ls_return)</span></code></pre></div>
<pre><code>## $abc
## [1] -0.5604756
## 
## $efg
## [1] -0.23017749  1.55870831  0.07050839
## 
## $opq
## [1] &quot;K&quot; &quot;E&quot; &quot;T&quot; &quot;N&quot; &quot;V&quot;</code></pre>
<p>Second, we list of lists by running the function above with different starting seeds. We store results in a <a href="https://fanwangecon.github.io/R4Econ/amto/list/htmlpdfr/fs_lst_basics.html#15_Two_Dimensional_Unnamed_List">two-dimensional list</a>.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="manipulate-and-summarize-dataframes.html#cb238-1" tabindex="-1"></a><span class="co"># Run function once to get length</span></span>
<span id="cb238-2"><a href="manipulate-and-summarize-dataframes.html#cb238-2" tabindex="-1"></a>ls_return_test <span class="ot">&lt;-</span> <span class="fu">ffi_list_generator</span>(<span class="at">it_seed=</span><span class="dv">123</span>) </span>
<span id="cb238-3"><a href="manipulate-and-summarize-dataframes.html#cb238-3" tabindex="-1"></a>it_list_len <span class="ot">&lt;-</span> <span class="fu">length</span>(ls_return_test)</span>
<span id="cb238-4"><a href="manipulate-and-summarize-dataframes.html#cb238-4" tabindex="-1"></a></span>
<span id="cb238-5"><a href="manipulate-and-summarize-dataframes.html#cb238-5" tabindex="-1"></a><span class="co"># list of list frame</span></span>
<span id="cb238-6"><a href="manipulate-and-summarize-dataframes.html#cb238-6" tabindex="-1"></a>it_list_of_list_len <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb238-7"><a href="manipulate-and-summarize-dataframes.html#cb238-7" tabindex="-1"></a>ls_ls_return <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> it_list_of_list_len<span class="sc">*</span>it_list_len)</span>
<span id="cb238-8"><a href="manipulate-and-summarize-dataframes.html#cb238-8" tabindex="-1"></a><span class="fu">dim</span>(ls_ls_return) <span class="ot">&lt;-</span> <span class="fu">c</span>(it_list_of_list_len, it_list_len)</span>
<span id="cb238-9"><a href="manipulate-and-summarize-dataframes.html#cb238-9" tabindex="-1"></a></span>
<span id="cb238-10"><a href="manipulate-and-summarize-dataframes.html#cb238-10" tabindex="-1"></a><span class="co"># Fill list of list</span></span>
<span id="cb238-11"><a href="manipulate-and-summarize-dataframes.html#cb238-11" tabindex="-1"></a>ar_seeds <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">123</span>, <span class="dv">123</span> <span class="sc">+</span> it_list_of_list_len <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb238-12"><a href="manipulate-and-summarize-dataframes.html#cb238-12" tabindex="-1"></a>it_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb238-13"><a href="manipulate-and-summarize-dataframes.html#cb238-13" tabindex="-1"></a><span class="cf">for</span> (it_seed <span class="cf">in</span> ar_seeds) {</span>
<span id="cb238-14"><a href="manipulate-and-summarize-dataframes.html#cb238-14" tabindex="-1"></a>  <span class="fu">print</span>(it_seed)</span>
<span id="cb238-15"><a href="manipulate-and-summarize-dataframes.html#cb238-15" tabindex="-1"></a>  it_ctr <span class="ot">&lt;-</span> it_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb238-16"><a href="manipulate-and-summarize-dataframes.html#cb238-16" tabindex="-1"></a>  ls_return <span class="ot">&lt;-</span> <span class="fu">ffi_list_generator</span>(it_seed) </span>
<span id="cb238-17"><a href="manipulate-and-summarize-dataframes.html#cb238-17" tabindex="-1"></a>  ls_ls_return[it_ctr,] <span class="ot">&lt;-</span> ls_return</span>
<span id="cb238-18"><a href="manipulate-and-summarize-dataframes.html#cb238-18" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 123
## [1] 124
## [1] 125
## [1] 126
## [1] 127</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="manipulate-and-summarize-dataframes.html#cb240-1" tabindex="-1"></a><span class="co"># print 2d list</span></span>
<span id="cb240-2"><a href="manipulate-and-summarize-dataframes.html#cb240-2" tabindex="-1"></a><span class="fu">print</span>(ls_ls_return)</span></code></pre></div>
<pre><code>##      [,1]       [,2]      [,3]       
## [1,] -0.5604756 numeric,3 character,5
## [2,] -1.385071  numeric,3 character,5
## [3,] 0.933327   numeric,3 character,5
## [4,] 0.366734   numeric,3 character,5
## [5,] -0.5677337 numeric,3 character,5</code></pre>
<p>Third, we convert the list to a tibble dataframe. Prior to conversion we add names to the 1st and 2nd dimensions of the list. Then we print the results.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="manipulate-and-summarize-dataframes.html#cb242-1" tabindex="-1"></a><span class="co"># get names from named list</span></span>
<span id="cb242-2"><a href="manipulate-and-summarize-dataframes.html#cb242-2" tabindex="-1"></a>ar_st_names <span class="ot">&lt;-</span> <span class="fu">names</span>(ls_return_test)</span>
<span id="cb242-3"><a href="manipulate-and-summarize-dataframes.html#cb242-3" tabindex="-1"></a><span class="fu">dimnames</span>(ls_ls_return)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> ar_st_names</span>
<span id="cb242-4"><a href="manipulate-and-summarize-dataframes.html#cb242-4" tabindex="-1"></a><span class="fu">dimnames</span>(ls_ls_return)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;seed_&#39;</span>, ar_seeds)</span>
<span id="cb242-5"><a href="manipulate-and-summarize-dataframes.html#cb242-5" tabindex="-1"></a></span>
<span id="cb242-6"><a href="manipulate-and-summarize-dataframes.html#cb242-6" tabindex="-1"></a><span class="co"># Convert to dataframe</span></span>
<span id="cb242-7"><a href="manipulate-and-summarize-dataframes.html#cb242-7" tabindex="-1"></a>tb_ls_ls_return <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ls_ls_return)</span>
<span id="cb242-8"><a href="manipulate-and-summarize-dataframes.html#cb242-8" tabindex="-1"></a></span>
<span id="cb242-9"><a href="manipulate-and-summarize-dataframes.html#cb242-9" tabindex="-1"></a><span class="co"># print</span></span>
<span id="cb242-10"><a href="manipulate-and-summarize-dataframes.html#cb242-10" tabindex="-1"></a><span class="fu">kable</span>(tb_ls_ls_return) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
abc
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
efg
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
opq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
-0.5604756
</td>
<td style="text-align:left;">
-0.23017749, 1.55870831, 0.07050839
</td>
<td style="text-align:left;">
K, E, T, N, V
</td>
</tr>
<tr>
<td style="text-align:left;">
-1.385071
</td>
<td style="text-align:left;">
0.03832318, -0.76303016, 0.21230614
</td>
<td style="text-align:left;">
J, A, O, T, N
</td>
</tr>
<tr>
<td style="text-align:left;">
0.933327
</td>
<td style="text-align:left;">
-0.52503178, 1.81443979, 0.08304562
</td>
<td style="text-align:left;">
C, T, M, S, K
</td>
</tr>
<tr>
<td style="text-align:left;">
0.366734
</td>
<td style="text-align:left;">
0.3964520, -0.7318437, 0.9462364
</td>
<td style="text-align:left;">
Z, L, J, Y, P
</td>
</tr>
<tr>
<td style="text-align:left;">
-0.5677337
</td>
<td style="text-align:left;">
-0.814760579, -0.493939596, 0.001818846
</td>
<td style="text-align:left;">
Y, C, O, F, U
</td>
</tr>
</tbody>
</table>
<p>Fourth, to export list to csv file, we need to unlist list contents. See also <a href="https://stackoverflow.com/a/48036488/8280804">Create a tibble containing list columns</a></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="manipulate-and-summarize-dataframes.html#cb243-1" tabindex="-1"></a><span class="co"># Unlist </span></span>
<span id="cb243-2"><a href="manipulate-and-summarize-dataframes.html#cb243-2" tabindex="-1"></a>tb_unlisted <span class="ot">&lt;-</span> tb_ls_ls_return <span class="sc">%&gt;%</span></span>
<span id="cb243-3"><a href="manipulate-and-summarize-dataframes.html#cb243-3" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb243-4"><a href="manipulate-and-summarize-dataframes.html#cb243-4" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.list, </span>
<span id="cb243-5"><a href="manipulate-and-summarize-dataframes.html#cb243-5" tabindex="-1"></a>    <span class="fu">funs</span>(<span class="fu">paste</span>(<span class="fu">unlist</span>(.), <span class="at">sep=</span><span class="st">&#39;&#39;</span>, <span class="at">collapse=</span><span class="st">&#39;, &#39;</span>)))</span>
<span id="cb243-6"><a href="manipulate-and-summarize-dataframes.html#cb243-6" tabindex="-1"></a><span class="co"># print on screen, can see values</span></span>
<span id="cb243-7"><a href="manipulate-and-summarize-dataframes.html#cb243-7" tabindex="-1"></a><span class="fu">print</span>(tb_unlisted)</span></code></pre></div>
</div>
<div id="rename-tibble-with-numeric-column-names" class="section level4 hasAnchor" number="2.1.1.5">
<h4><span class="header-section-number">2.1.1.5</span> Rename Tibble with Numeric Column Names<a href="manipulate-and-summarize-dataframes.html#rename-tibble-with-numeric-column-names" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After reshaping, often could end up with variable names that are all numeric, intgers for example, how to rename these variables to add a common prefix for example.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="manipulate-and-summarize-dataframes.html#cb244-1" tabindex="-1"></a><span class="co"># Base Inputs</span></span>
<span id="cb244-2"><a href="manipulate-and-summarize-dataframes.html#cb244-2" tabindex="-1"></a>ar_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb244-3"><a href="manipulate-and-summarize-dataframes.html#cb244-3" tabindex="-1"></a>mt_rnorm_c <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">10</span>)</span>
<span id="cb244-4"><a href="manipulate-and-summarize-dataframes.html#cb244-4" tabindex="-1"></a>mt_combine <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_col, mt_rnorm_c)</span>
<span id="cb244-5"><a href="manipulate-and-summarize-dataframes.html#cb244-5" tabindex="-1"></a></span>
<span id="cb244-6"><a href="manipulate-and-summarize-dataframes.html#cb244-6" tabindex="-1"></a><span class="co"># Variable Names</span></span>
<span id="cb244-7"><a href="manipulate-and-summarize-dataframes.html#cb244-7" tabindex="-1"></a>ar_it_cols_ctr <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mt_rnorm_c)[<span class="dv">2</span>])</span>
<span id="cb244-8"><a href="manipulate-and-summarize-dataframes.html#cb244-8" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;var_one&#39;</span>, ar_it_cols_ctr)</span>
<span id="cb244-9"><a href="manipulate-and-summarize-dataframes.html#cb244-9" tabindex="-1"></a></span>
<span id="cb244-10"><a href="manipulate-and-summarize-dataframes.html#cb244-10" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb244-11"><a href="manipulate-and-summarize-dataframes.html#cb244-11" tabindex="-1"></a>tb_combine <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_combine) <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb244-12"><a href="manipulate-and-summarize-dataframes.html#cb244-12" tabindex="-1"></a></span>
<span id="cb244-13"><a href="manipulate-and-summarize-dataframes.html#cb244-13" tabindex="-1"></a><span class="co"># Add an index column to the dataframe, ID column</span></span>
<span id="cb244-14"><a href="manipulate-and-summarize-dataframes.html#cb244-14" tabindex="-1"></a>tb_combine_ori <span class="ot">&lt;-</span> tb_combine <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb244-15"><a href="manipulate-and-summarize-dataframes.html#cb244-15" tabindex="-1"></a></span>
<span id="cb244-16"><a href="manipulate-and-summarize-dataframes.html#cb244-16" tabindex="-1"></a><span class="co"># Change all gb variable names</span></span>
<span id="cb244-17"><a href="manipulate-and-summarize-dataframes.html#cb244-17" tabindex="-1"></a>tb_combine <span class="ot">&lt;-</span> tb_combine_ori <span class="sc">%&gt;%</span></span>
<span id="cb244-18"><a href="manipulate-and-summarize-dataframes.html#cb244-18" tabindex="-1"></a>                  <span class="fu">rename_at</span>(</span>
<span id="cb244-19"><a href="manipulate-and-summarize-dataframes.html#cb244-19" tabindex="-1"></a>                    <span class="fu">vars</span>(<span class="fu">num_range</span>(<span class="st">&#39;&#39;</span>,ar_it_cols_ctr)),</span>
<span id="cb244-20"><a href="manipulate-and-summarize-dataframes.html#cb244-20" tabindex="-1"></a>                    <span class="fu">funs</span>(<span class="fu">paste0</span>(<span class="st">&quot;rho&quot;</span>, . , <span class="st">&#39;var&#39;</span>))</span>
<span id="cb244-21"><a href="manipulate-and-summarize-dataframes.html#cb244-21" tabindex="-1"></a>                    )</span>
<span id="cb244-22"><a href="manipulate-and-summarize-dataframes.html#cb244-22" tabindex="-1"></a></span>
<span id="cb244-23"><a href="manipulate-and-summarize-dataframes.html#cb244-23" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb244-24"><a href="manipulate-and-summarize-dataframes.html#cb244-24" tabindex="-1"></a><span class="fu">kable</span>(tb_combine_ori) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var_one
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
7
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
9
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="manipulate-and-summarize-dataframes.html#cb245-1" tabindex="-1"></a><span class="fu">kable</span>(tb_combine) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var_one
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho1var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho2var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho3var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho4var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho5var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho6var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho7var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho8var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho9var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rho10var
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
<td style="text-align:right;">
0.1335086
</td>
<td style="text-align:right;">
-0.1059632
</td>
<td style="text-align:right;">
-0.1255472
</td>
<td style="text-align:right;">
0.5646199
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="tibble-row-and-column-and-summarize" class="section level4 hasAnchor" number="2.1.1.6">
<h4><span class="header-section-number">2.1.1.6</span> Tibble Row and Column and Summarize<a href="manipulate-and-summarize-dataframes.html#tibble-row-and-column-and-summarize" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Show what is in the table: 1, column and row names; 2, contents inside table.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="manipulate-and-summarize-dataframes.html#cb246-1" tabindex="-1"></a>tb_iris <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span>
<span id="cb246-2"><a href="manipulate-and-summarize-dataframes.html#cb246-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">rownames</span>(tb_iris))</span></code></pre></div>
<pre><code>##   [1] &quot;1&quot;   &quot;2&quot;   &quot;3&quot;   &quot;4&quot;   &quot;5&quot;   &quot;6&quot;   &quot;7&quot;   &quot;8&quot;   &quot;9&quot;   &quot;10&quot;  &quot;11&quot;  &quot;12&quot;  &quot;13&quot; 
##  [14] &quot;14&quot;  &quot;15&quot;  &quot;16&quot;  &quot;17&quot;  &quot;18&quot;  &quot;19&quot;  &quot;20&quot;  &quot;21&quot;  &quot;22&quot;  &quot;23&quot;  &quot;24&quot;  &quot;25&quot;  &quot;26&quot; 
##  [27] &quot;27&quot;  &quot;28&quot;  &quot;29&quot;  &quot;30&quot;  &quot;31&quot;  &quot;32&quot;  &quot;33&quot;  &quot;34&quot;  &quot;35&quot;  &quot;36&quot;  &quot;37&quot;  &quot;38&quot;  &quot;39&quot; 
##  [40] &quot;40&quot;  &quot;41&quot;  &quot;42&quot;  &quot;43&quot;  &quot;44&quot;  &quot;45&quot;  &quot;46&quot;  &quot;47&quot;  &quot;48&quot;  &quot;49&quot;  &quot;50&quot;  &quot;51&quot;  &quot;52&quot; 
##  [53] &quot;53&quot;  &quot;54&quot;  &quot;55&quot;  &quot;56&quot;  &quot;57&quot;  &quot;58&quot;  &quot;59&quot;  &quot;60&quot;  &quot;61&quot;  &quot;62&quot;  &quot;63&quot;  &quot;64&quot;  &quot;65&quot; 
##  [66] &quot;66&quot;  &quot;67&quot;  &quot;68&quot;  &quot;69&quot;  &quot;70&quot;  &quot;71&quot;  &quot;72&quot;  &quot;73&quot;  &quot;74&quot;  &quot;75&quot;  &quot;76&quot;  &quot;77&quot;  &quot;78&quot; 
##  [79] &quot;79&quot;  &quot;80&quot;  &quot;81&quot;  &quot;82&quot;  &quot;83&quot;  &quot;84&quot;  &quot;85&quot;  &quot;86&quot;  &quot;87&quot;  &quot;88&quot;  &quot;89&quot;  &quot;90&quot;  &quot;91&quot; 
##  [92] &quot;92&quot;  &quot;93&quot;  &quot;94&quot;  &quot;95&quot;  &quot;96&quot;  &quot;97&quot;  &quot;98&quot;  &quot;99&quot;  &quot;100&quot; &quot;101&quot; &quot;102&quot; &quot;103&quot; &quot;104&quot;
## [105] &quot;105&quot; &quot;106&quot; &quot;107&quot; &quot;108&quot; &quot;109&quot; &quot;110&quot; &quot;111&quot; &quot;112&quot; &quot;113&quot; &quot;114&quot; &quot;115&quot; &quot;116&quot; &quot;117&quot;
## [118] &quot;118&quot; &quot;119&quot; &quot;120&quot; &quot;121&quot; &quot;122&quot; &quot;123&quot; &quot;124&quot; &quot;125&quot; &quot;126&quot; &quot;127&quot; &quot;128&quot; &quot;129&quot; &quot;130&quot;
## [131] &quot;131&quot; &quot;132&quot; &quot;133&quot; &quot;134&quot; &quot;135&quot; &quot;136&quot; &quot;137&quot; &quot;138&quot; &quot;139&quot; &quot;140&quot; &quot;141&quot; &quot;142&quot; &quot;143&quot;
## [144] &quot;144&quot; &quot;145&quot; &quot;146&quot; &quot;147&quot; &quot;148&quot; &quot;149&quot; &quot;150&quot;</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="manipulate-and-summarize-dataframes.html#cb248-1" tabindex="-1"></a><span class="fu">colnames</span>(tb_iris)</span></code></pre></div>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="manipulate-and-summarize-dataframes.html#cb250-1" tabindex="-1"></a><span class="fu">colnames</span>(tb_iris)</span></code></pre></div>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="manipulate-and-summarize-dataframes.html#cb252-1" tabindex="-1"></a><span class="fu">summary</span>(tb_iris)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width          Species  
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100   setosa    :50  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300   versicolor:50  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300   virginica :50  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199                  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800                  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500</code></pre>
</div>
<div id="sorting-and-rank" class="section level4 hasAnchor" number="2.1.1.7">
<h4><span class="header-section-number">2.1.1.7</span> Sorting and Rank<a href="manipulate-and-summarize-dataframes.html#sorting-and-rank" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="sorting" class="section level5 hasAnchor" number="2.1.1.7.1">
<h5><span class="header-section-number">2.1.1.7.1</span> Sorting<a href="manipulate-and-summarize-dataframes.html#sorting" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li>dplyr arrange desc reverse</li>
<li>dplyr sort</li>
</ul>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="manipulate-and-summarize-dataframes.html#cb254-1" tabindex="-1"></a><span class="co"># Sort in Ascending Order</span></span>
<span id="cb254-2"><a href="manipulate-and-summarize-dataframes.html#cb254-2" tabindex="-1"></a>tb_iris <span class="sc">%&gt;%</span> <span class="fu">select</span>(Species, Sepal.Length, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb254-3"><a href="manipulate-and-summarize-dataframes.html#cb254-3" tabindex="-1"></a>  <span class="fu">arrange</span>(Species, Sepal.Length) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb254-4"><a href="manipulate-and-summarize-dataframes.html#cb254-4" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Width
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Width
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.5
</td>
<td style="text-align:right;">
2.3
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="manipulate-and-summarize-dataframes.html#cb255-1" tabindex="-1"></a><span class="co"># Sort in Descending Order</span></span>
<span id="cb255-2"><a href="manipulate-and-summarize-dataframes.html#cb255-2" tabindex="-1"></a>tb_iris <span class="sc">%&gt;%</span> <span class="fu">select</span>(Species, Sepal.Length, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb255-3"><a href="manipulate-and-summarize-dataframes.html#cb255-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Species), <span class="fu">desc</span>(Sepal.Length)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb255-4"><a href="manipulate-and-summarize-dataframes.html#cb255-4" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Width
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Width
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.9
</td>
<td style="text-align:right;">
3.8
</td>
<td style="text-align:right;">
6.4
</td>
<td style="text-align:right;">
2.0
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.7
</td>
<td style="text-align:right;">
3.8
</td>
<td style="text-align:right;">
6.7
</td>
<td style="text-align:right;">
2.2
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.7
</td>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:right;">
6.9
</td>
<td style="text-align:right;">
2.3
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.7
</td>
<td style="text-align:right;">
2.8
</td>
<td style="text-align:right;">
6.7
</td>
<td style="text-align:right;">
2.0
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.7
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
6.1
</td>
<td style="text-align:right;">
2.3
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.6
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
6.6
</td>
<td style="text-align:right;">
2.1
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.4
</td>
<td style="text-align:right;">
2.8
</td>
<td style="text-align:right;">
6.1
</td>
<td style="text-align:right;">
1.9
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.3
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:right;">
6.3
</td>
<td style="text-align:right;">
1.8
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.2
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
6.1
</td>
<td style="text-align:right;">
2.5
</td>
</tr>
<tr>
<td style="text-align:left;">
virginica
</td>
<td style="text-align:right;">
7.2
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
1.8
</td>
</tr>
</tbody>
</table>
</div>
<div id="create-a-ranking-variable" class="section level5 hasAnchor" number="2.1.1.7.2">
<h5><span class="header-section-number">2.1.1.7.2</span> Create a Ranking Variable<a href="manipulate-and-summarize-dataframes.html#create-a-ranking-variable" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We use dplyr’s <a href="https://dplyr.tidyverse.org/reference/ranking.html">ranking</a> functions to generate different types of ranking variables.</p>
<p>The example below demonstrates the differences between the functions <a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number()</a>, <a href="https://dplyr.tidyverse.org/reference/ranking.html">min_rank()</a>, and <a href="https://dplyr.tidyverse.org/reference/ranking.html">dense_rank()</a>.</p>
<ul>
<li><em>row_number</em>: Given 10 observations, generates index from 1 to 10, ties are given different ranks.</li>
<li><em>min_rank</em>: Given 10 observations, generates rank where second-rank ties are both given “silver”, and the 4th highest ranked variable not given medal.</li>
<li><em>dense_rank</em>: Given 10 observations, generates rank where second-rank ties are both given “silver” (2nd rank), and the 4th highest ranked variable is given “bronze” (3rd rank), there are no gaps between ranks.</li>
</ul>
<p>Note that we have “desc(var_name)” in order to generate the variable based on descending sort of the the “var_name” variable.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="manipulate-and-summarize-dataframes.html#cb256-1" tabindex="-1"></a>tb_iris <span class="sc">%&gt;%</span></span>
<span id="cb256-2"><a href="manipulate-and-summarize-dataframes.html#cb256-2" tabindex="-1"></a>  <span class="fu">select</span>(Species, Sepal.Length) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb256-3"><a href="manipulate-and-summarize-dataframes.html#cb256-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row_number =</span> <span class="fu">row_number</span>(<span class="fu">desc</span>(Sepal.Length)),</span>
<span id="cb256-4"><a href="manipulate-and-summarize-dataframes.html#cb256-4" tabindex="-1"></a>         <span class="at">min_rank =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(Sepal.Length)),</span>
<span id="cb256-5"><a href="manipulate-and-summarize-dataframes.html#cb256-5" tabindex="-1"></a>         <span class="at">dense_rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(Sepal.Length))) <span class="sc">%&gt;%</span></span>
<span id="cb256-6"><a href="manipulate-and-summarize-dataframes.html#cb256-6" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;Ranking variable&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-91">Table 2.1: </span>Ranking variable
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
row_number
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
min_rank
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dense_rank
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="recontools-summarize-over-tible" class="section level4 hasAnchor" number="2.1.1.8">
<h4><span class="header-section-number">2.1.1.8</span> REconTools Summarize over Tible<a href="manipulate-and-summarize-dataframes.html#recontools-summarize-over-tible" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Use R4Econ’s summary tool.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="manipulate-and-summarize-dataframes.html#cb257-1" tabindex="-1"></a>df_summ_stats <span class="ot">&lt;-</span> REconTools<span class="sc">::</span><span class="fu">ff_summ_percentiles</span>(tb_iris)</span>
<span id="cb257-2"><a href="manipulate-and-summarize-dataframes.html#cb257-2" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">t</span>(df_summ_stats)) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
stats
</td>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
unique
</td>
<td style="text-align:left;">
NAobs
</td>
<td style="text-align:left;">
ZEROobs
</td>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
cv
</td>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
p01
</td>
<td style="text-align:left;">
p05
</td>
<td style="text-align:left;">
p10
</td>
<td style="text-align:left;">
p25
</td>
<td style="text-align:left;">
p50
</td>
<td style="text-align:left;">
p75
</td>
<td style="text-align:left;">
p90
</td>
<td style="text-align:left;">
p95
</td>
<td style="text-align:left;">
p99
</td>
<td style="text-align:left;">
max
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
3.758000
</td>
<td style="text-align:left;">
1.7652982
</td>
<td style="text-align:left;">
0.4697441
</td>
<td style="text-align:left;">
1.0
</td>
<td style="text-align:left;">
1.149
</td>
<td style="text-align:left;">
1.300
</td>
<td style="text-align:left;">
1.4
</td>
<td style="text-align:left;">
1.6
</td>
<td style="text-align:left;">
4.35
</td>
<td style="text-align:left;">
5.1
</td>
<td style="text-align:left;">
5.80
</td>
<td style="text-align:left;">
6.100
</td>
<td style="text-align:left;">
6.700
</td>
<td style="text-align:left;">
6.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.199333
</td>
<td style="text-align:left;">
0.7622377
</td>
<td style="text-align:left;">
0.6355511
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.100
</td>
<td style="text-align:left;">
0.200
</td>
<td style="text-align:left;">
0.2
</td>
<td style="text-align:left;">
0.3
</td>
<td style="text-align:left;">
1.30
</td>
<td style="text-align:left;">
1.8
</td>
<td style="text-align:left;">
2.20
</td>
<td style="text-align:left;">
2.300
</td>
<td style="text-align:left;">
2.500
</td>
<td style="text-align:left;">
2.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
5.843333
</td>
<td style="text-align:left;">
0.8280661
</td>
<td style="text-align:left;">
0.1417113
</td>
<td style="text-align:left;">
4.3
</td>
<td style="text-align:left;">
4.400
</td>
<td style="text-align:left;">
4.600
</td>
<td style="text-align:left;">
4.8
</td>
<td style="text-align:left;">
5.1
</td>
<td style="text-align:left;">
5.80
</td>
<td style="text-align:left;">
6.4
</td>
<td style="text-align:left;">
6.90
</td>
<td style="text-align:left;">
7.255
</td>
<td style="text-align:left;">
7.700
</td>
<td style="text-align:left;">
7.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Width
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
3.057333
</td>
<td style="text-align:left;">
0.4358663
</td>
<td style="text-align:left;">
0.1425642
</td>
<td style="text-align:left;">
2.0
</td>
<td style="text-align:left;">
2.200
</td>
<td style="text-align:left;">
2.345
</td>
<td style="text-align:left;">
2.5
</td>
<td style="text-align:left;">
2.8
</td>
<td style="text-align:left;">
3.00
</td>
<td style="text-align:left;">
3.3
</td>
<td style="text-align:left;">
3.61
</td>
<td style="text-align:left;">
3.800
</td>
<td style="text-align:left;">
4.151
</td>
<td style="text-align:left;">
4.4
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div id="generate-categorical-variables" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Generate Categorical Variables<a href="manipulate-and-summarize-dataframes.html#generate-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="cut-continuous-variable-to-categorical-variable" class="section level4 hasAnchor" number="2.1.2.1">
<h4><span class="header-section-number">2.1.2.1</span> Cut Continuous Variable to Categorical Variable<a href="manipulate-and-summarize-dataframes.html#cut-continuous-variable-to-categorical-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have a continuous variable, we cut it with explicitly specified cuts to generate a categorical variable, and label it. We will use <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/cut">base::cut()</a>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="manipulate-and-summarize-dataframes.html#cb258-1" tabindex="-1"></a><span class="co"># break points to specific</span></span>
<span id="cb258-2"><a href="manipulate-and-summarize-dataframes.html#cb258-2" tabindex="-1"></a>fl_min_mpg <span class="ot">&lt;-</span> <span class="fu">min</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb258-3"><a href="manipulate-and-summarize-dataframes.html#cb258-3" tabindex="-1"></a>fl_max_mpg <span class="ot">&lt;-</span> <span class="fu">max</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb258-4"><a href="manipulate-and-summarize-dataframes.html#cb258-4" tabindex="-1"></a>ar_fl_cuts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>)</span>
<span id="cb258-5"><a href="manipulate-and-summarize-dataframes.html#cb258-5" tabindex="-1"></a><span class="co"># generate labels</span></span>
<span id="cb258-6"><a href="manipulate-and-summarize-dataframes.html#cb258-6" tabindex="-1"></a>ar_st_cuts_lab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;10&lt;=mpg&lt;20&quot;</span>, <span class="st">&quot;20&lt;=mpg&lt;30&quot;</span>, <span class="st">&quot;30&lt;=mpg&lt;40&quot;</span>)</span>
<span id="cb258-7"><a href="manipulate-and-summarize-dataframes.html#cb258-7" tabindex="-1"></a><span class="co"># generate new variable</span></span>
<span id="cb258-8"><a href="manipulate-and-summarize-dataframes.html#cb258-8" tabindex="-1"></a>mtcars_cate <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb258-9"><a href="manipulate-and-summarize-dataframes.html#cb258-9" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;cars&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb258-10"><a href="manipulate-and-summarize-dataframes.html#cb258-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mpg_grp =</span> base<span class="sc">::</span><span class="fu">cut</span>(mpg,</span>
<span id="cb258-11"><a href="manipulate-and-summarize-dataframes.html#cb258-11" tabindex="-1"></a>      <span class="at">breaks =</span> ar_fl_cuts, </span>
<span id="cb258-12"><a href="manipulate-and-summarize-dataframes.html#cb258-12" tabindex="-1"></a>      <span class="at">labels =</span> ar_st_cuts_lab,</span>
<span id="cb258-13"><a href="manipulate-and-summarize-dataframes.html#cb258-13" tabindex="-1"></a>      <span class="co"># if right is FALSE, interval is closed on the left</span></span>
<span id="cb258-14"><a href="manipulate-and-summarize-dataframes.html#cb258-14" tabindex="-1"></a>      <span class="at">right =</span> <span class="cn">FALSE</span></span>
<span id="cb258-15"><a href="manipulate-and-summarize-dataframes.html#cb258-15" tabindex="-1"></a>    )</span>
<span id="cb258-16"><a href="manipulate-and-summarize-dataframes.html#cb258-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(cars, mpg_grp, mpg) <span class="sc">%&gt;%</span> </span>
<span id="cb258-17"><a href="manipulate-and-summarize-dataframes.html#cb258-17" tabindex="-1"></a>  <span class="fu">arrange</span>(mpg) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(mpg_grp) <span class="sc">%&gt;%</span></span>
<span id="cb258-18"><a href="manipulate-and-summarize-dataframes.html#cb258-18" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb258-19"><a href="manipulate-and-summarize-dataframes.html#cb258-19" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb258-20"><a href="manipulate-and-summarize-dataframes.html#cb258-20" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="st">&quot;Cuts a continuous var to a categorical var with labels&quot;</span></span>
<span id="cb258-21"><a href="manipulate-and-summarize-dataframes.html#cb258-21" tabindex="-1"></a><span class="fu">kable</span>(mtcars_cate,</span>
<span id="cb258-22"><a href="manipulate-and-summarize-dataframes.html#cb258-22" tabindex="-1"></a>    <span class="at">caption =</span> st_caption</span>
<span id="cb258-23"><a href="manipulate-and-summarize-dataframes.html#cb258-23" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-94">Table 2.2: </span>Cuts a continuous var to a categorical var with labels
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cars
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
mpg_grp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cadillac Fleetwood
</td>
<td style="text-align:left;">
10&lt;=mpg&lt;20
</td>
<td style="text-align:right;">
10.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Lincoln Continental
</td>
<td style="text-align:left;">
10&lt;=mpg&lt;20
</td>
<td style="text-align:right;">
10.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Camaro Z28
</td>
<td style="text-align:left;">
10&lt;=mpg&lt;20
</td>
<td style="text-align:right;">
13.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:left;">
20&lt;=mpg&lt;30
</td>
<td style="text-align:right;">
21.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:left;">
20&lt;=mpg&lt;30
</td>
<td style="text-align:right;">
21.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:left;">
20&lt;=mpg&lt;30
</td>
<td style="text-align:right;">
21.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Honda Civic
</td>
<td style="text-align:left;">
30&lt;=mpg&lt;40
</td>
<td style="text-align:right;">
30.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Lotus Europa
</td>
<td style="text-align:left;">
30&lt;=mpg&lt;40
</td>
<td style="text-align:right;">
30.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Fiat 128
</td>
<td style="text-align:left;">
30&lt;=mpg&lt;40
</td>
<td style="text-align:right;">
32.4
</td>
</tr>
</tbody>
</table>
</div>
<div id="factor-label-cross-and-graph" class="section level4 hasAnchor" number="2.1.2.2">
<h4><span class="header-section-number">2.1.2.2</span> Factor, Label, Cross and Graph<a href="manipulate-and-summarize-dataframes.html#factor-label-cross-and-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Generate a Scatter plot with different colors representing different categories. There are multiple underlying factor/categorical variables, for example two binary variables. Generate scatter plot with colors for the combinations of these two binary variables.</p>
<p>We combine here the <em>vs</em> and <em>am</em> variables from the <em>mtcars</em> dataset. <em>vs</em> is engine shape, <em>am</em> is auto or manual shift. We will generate a scatter plot of <em>mpg</em> and <em>qsec</em> over four categories with different colors.</p>
<ul>
<li><em>am</em>: Transmission (0 = automatic, 1 = manual)</li>
<li><em>vs</em>: Engine (0 = V-shaped, 1 = straight)</li>
<li><em>mpg</em>: miles per galon</li>
<li><em>qsec</em>: 1/4 mile time</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="manipulate-and-summarize-dataframes.html#cb259-1" tabindex="-1"></a><span class="co"># First make sure these are factors</span></span>
<span id="cb259-2"><a href="manipulate-and-summarize-dataframes.html#cb259-2" tabindex="-1"></a>tb_mtcars <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mtcars) <span class="sc">%&gt;%</span> </span>
<span id="cb259-3"><a href="manipulate-and-summarize-dataframes.html#cb259-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs =</span> <span class="fu">as_factor</span>(vs), <span class="at">am =</span> <span class="fu">as_factor</span>(am))</span>
<span id="cb259-4"><a href="manipulate-and-summarize-dataframes.html#cb259-4" tabindex="-1"></a></span>
<span id="cb259-5"><a href="manipulate-and-summarize-dataframes.html#cb259-5" tabindex="-1"></a><span class="co"># Second Label the Factors</span></span>
<span id="cb259-6"><a href="manipulate-and-summarize-dataframes.html#cb259-6" tabindex="-1"></a>am_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">auto_shift =</span> <span class="st">&quot;0&quot;</span>, <span class="at">manual_shift =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb259-7"><a href="manipulate-and-summarize-dataframes.html#cb259-7" tabindex="-1"></a>vs_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">vshaped_engine =</span> <span class="st">&quot;0&quot;</span>, <span class="at">straight_engine =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb259-8"><a href="manipulate-and-summarize-dataframes.html#cb259-8" tabindex="-1"></a>tb_mtcars <span class="ot">&lt;-</span> tb_mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb259-9"><a href="manipulate-and-summarize-dataframes.html#cb259-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs =</span> <span class="fu">fct_recode</span>(vs, <span class="sc">!!!</span>vs_levels),</span>
<span id="cb259-10"><a href="manipulate-and-summarize-dataframes.html#cb259-10" tabindex="-1"></a>         <span class="at">am =</span> <span class="fu">fct_recode</span>(am, <span class="sc">!!!</span>am_levels))</span>
<span id="cb259-11"><a href="manipulate-and-summarize-dataframes.html#cb259-11" tabindex="-1"></a></span>
<span id="cb259-12"><a href="manipulate-and-summarize-dataframes.html#cb259-12" tabindex="-1"></a><span class="co"># Third Combine Factors</span></span>
<span id="cb259-13"><a href="manipulate-and-summarize-dataframes.html#cb259-13" tabindex="-1"></a>tb_mtcars_selected <span class="ot">&lt;-</span> tb_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb259-14"><a href="manipulate-and-summarize-dataframes.html#cb259-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs_am =</span> <span class="fu">fct_cross</span>(vs, am, <span class="at">sep=</span><span class="st">&#39;_&#39;</span>, <span class="at">keep_empty =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb259-15"><a href="manipulate-and-summarize-dataframes.html#cb259-15" tabindex="-1"></a>  <span class="fu">select</span>(mpg, qsec, vs_am)</span>
<span id="cb259-16"><a href="manipulate-and-summarize-dataframes.html#cb259-16" tabindex="-1"></a></span>
<span id="cb259-17"><a href="manipulate-and-summarize-dataframes.html#cb259-17" tabindex="-1"></a><span class="co"># relabel interaction variables</span></span>
<span id="cb259-18"><a href="manipulate-and-summarize-dataframes.html#cb259-18" tabindex="-1"></a>am_vs_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;vshape (engine) and auto (shift)&quot;</span> <span class="ot">=</span> <span class="st">&quot;vshaped_engine_auto_shift&quot;</span>, </span>
<span id="cb259-19"><a href="manipulate-and-summarize-dataframes.html#cb259-19" tabindex="-1"></a>                  <span class="st">&quot;vshape (engine) and manual (shift)&quot;</span> <span class="ot">=</span> <span class="st">&quot;vshaped_engine_manual_shift&quot;</span>, </span>
<span id="cb259-20"><a href="manipulate-and-summarize-dataframes.html#cb259-20" tabindex="-1"></a>                  <span class="st">&quot;straight (engine) and auto (shift)&quot;</span> <span class="ot">=</span> <span class="st">&quot;straight_engine_auto_shift&quot;</span>, </span>
<span id="cb259-21"><a href="manipulate-and-summarize-dataframes.html#cb259-21" tabindex="-1"></a>                  <span class="st">&quot;straight (engine) and manual (shift)&quot;</span> <span class="ot">=</span> <span class="st">&quot;straight_engine_manual_shift&quot;</span>)</span>
<span id="cb259-22"><a href="manipulate-and-summarize-dataframes.html#cb259-22" tabindex="-1"></a>tb_mtcars_selected <span class="ot">&lt;-</span> tb_mtcars_selected <span class="sc">%&gt;%</span></span>
<span id="cb259-23"><a href="manipulate-and-summarize-dataframes.html#cb259-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs_am =</span> <span class="fu">fct_recode</span>(vs_am, <span class="sc">!!!</span>am_vs_levels))</span>
<span id="cb259-24"><a href="manipulate-and-summarize-dataframes.html#cb259-24" tabindex="-1"></a></span>
<span id="cb259-25"><a href="manipulate-and-summarize-dataframes.html#cb259-25" tabindex="-1"></a><span class="co"># Show</span></span>
<span id="cb259-26"><a href="manipulate-and-summarize-dataframes.html#cb259-26" tabindex="-1"></a><span class="fu">print</span>(tb_mtcars_selected[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])</span></code></pre></div>
<p>Now we generate scatter plot based on the combined factors</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="manipulate-and-summarize-dataframes.html#cb260-1" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb260-2"><a href="manipulate-and-summarize-dataframes.html#cb260-2" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Distribution of MPG and QSEC from mtcars&#39;</span>)</span>
<span id="cb260-3"><a href="manipulate-and-summarize-dataframes.html#cb260-3" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb260-4"><a href="manipulate-and-summarize-dataframes.html#cb260-4" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/amto/tibble/htmlpdfr/fs_tib_factors.html&#39;</span>)</span>
<span id="cb260-5"><a href="manipulate-and-summarize-dataframes.html#cb260-5" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;mtcars dataset, &#39;</span>,</span>
<span id="cb260-6"><a href="manipulate-and-summarize-dataframes.html#cb260-6" tabindex="-1"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb260-7"><a href="manipulate-and-summarize-dataframes.html#cb260-7" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;MPG = Miles per Gallon&#39;</span></span>
<span id="cb260-8"><a href="manipulate-and-summarize-dataframes.html#cb260-8" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;QSEC = time for 1/4 Miles&#39;</span></span>
<span id="cb260-9"><a href="manipulate-and-summarize-dataframes.html#cb260-9" tabindex="-1"></a></span>
<span id="cb260-10"><a href="manipulate-and-summarize-dataframes.html#cb260-10" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb260-11"><a href="manipulate-and-summarize-dataframes.html#cb260-11" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> </span>
<span id="cb260-12"><a href="manipulate-and-summarize-dataframes.html#cb260-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(tb_mtcars_selected, </span>
<span id="cb260-13"><a href="manipulate-and-summarize-dataframes.html#cb260-13" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x=</span>mpg, <span class="at">y=</span>qsec, <span class="at">colour=</span>vs_am, <span class="at">shape=</span>vs_am)) <span class="sc">+</span></span>
<span id="cb260-14"><a href="manipulate-and-summarize-dataframes.html#cb260-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb260-15"><a href="manipulate-and-summarize-dataframes.html#cb260-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb260-16"><a href="manipulate-and-summarize-dataframes.html#cb260-16" tabindex="-1"></a>       <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption) <span class="sc">+</span></span>
<span id="cb260-17"><a href="manipulate-and-summarize-dataframes.html#cb260-17" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb260-18"><a href="manipulate-and-summarize-dataframes.html#cb260-18" tabindex="-1"></a></span>
<span id="cb260-19"><a href="manipulate-and-summarize-dataframes.html#cb260-19" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb260-20"><a href="manipulate-and-summarize-dataframes.html#cb260-20" tabindex="-1"></a><span class="fu">print</span>(plt_mtcars_scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-95-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="drawly-random-rows" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Drawly Random Rows<a href="manipulate-and-summarize-dataframes.html#drawly-random-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="draw-random-subset-of-sample" class="section level4 hasAnchor" number="2.1.3.1">
<h4><span class="header-section-number">2.1.3.1</span> Draw Random Subset of Sample<a href="manipulate-and-summarize-dataframes.html#draw-random-subset-of-sample" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>r random discrete</li>
</ul>
<p>We have a sample of N individuals in some dataframe. Draw without replacement a subset <span class="math inline">\(M&lt;N\)</span> of rows.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="manipulate-and-summarize-dataframes.html#cb261-1" tabindex="-1"></a><span class="co"># parameters, it_M &lt; it_N</span></span>
<span id="cb261-2"><a href="manipulate-and-summarize-dataframes.html#cb261-2" tabindex="-1"></a>it_N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb261-3"><a href="manipulate-and-summarize-dataframes.html#cb261-3" tabindex="-1"></a>it_M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb261-4"><a href="manipulate-and-summarize-dataframes.html#cb261-4" tabindex="-1"></a></span>
<span id="cb261-5"><a href="manipulate-and-summarize-dataframes.html#cb261-5" tabindex="-1"></a><span class="co"># Draw it_m from indexed list of it_N</span></span>
<span id="cb261-6"><a href="manipulate-and-summarize-dataframes.html#cb261-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb261-7"><a href="manipulate-and-summarize-dataframes.html#cb261-7" tabindex="-1"></a>ar_it_rand_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(it_N, it_M, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb261-8"><a href="manipulate-and-summarize-dataframes.html#cb261-8" tabindex="-1"></a></span>
<span id="cb261-9"><a href="manipulate-and-summarize-dataframes.html#cb261-9" tabindex="-1"></a><span class="co"># dataframe</span></span>
<span id="cb261-10"><a href="manipulate-and-summarize-dataframes.html#cb261-10" tabindex="-1"></a>df_full <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>), <span class="at">nrow=</span>it_N, <span class="at">ncol=</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb261-11"><a href="manipulate-and-summarize-dataframes.html#cb261-11" tabindex="-1"></a></span>
<span id="cb261-12"><a href="manipulate-and-summarize-dataframes.html#cb261-12" tabindex="-1"></a><span class="co"># random Subset</span></span>
<span id="cb261-13"><a href="manipulate-and-summarize-dataframes.html#cb261-13" tabindex="-1"></a>df_rand_sub_a <span class="ot">&lt;-</span> df_full[ar_it_rand_idx,]</span>
<span id="cb261-14"><a href="manipulate-and-summarize-dataframes.html#cb261-14" tabindex="-1"></a></span>
<span id="cb261-15"><a href="manipulate-and-summarize-dataframes.html#cb261-15" tabindex="-1"></a><span class="co"># Random subset also</span></span>
<span id="cb261-16"><a href="manipulate-and-summarize-dataframes.html#cb261-16" tabindex="-1"></a>df_rand_sub_b <span class="ot">&lt;-</span> df_full[<span class="fu">sample</span>(<span class="fu">dim</span>(df_full)[<span class="dv">1</span>], it_M, <span class="at">replace=</span><span class="cn">FALSE</span>),]</span>
<span id="cb261-17"><a href="manipulate-and-summarize-dataframes.html#cb261-17" tabindex="-1"></a></span>
<span id="cb261-18"><a href="manipulate-and-summarize-dataframes.html#cb261-18" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb261-19"><a href="manipulate-and-summarize-dataframes.html#cb261-19" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb261-20"><a href="manipulate-and-summarize-dataframes.html#cb261-20" tabindex="-1"></a><span class="fu">kable</span>(df_full) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="manipulate-and-summarize-dataframes.html#cb262-1" tabindex="-1"></a><span class="fu">kable</span>(df_rand_sub_a) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="manipulate-and-summarize-dataframes.html#cb263-1" tabindex="-1"></a><span class="fu">kable</span>(df_rand_sub_b) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
0.4609162
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.7150650
</td>
</tr>
</tbody>
</table>
</div>
<div id="random-subset-of-panel" class="section level4 hasAnchor" number="2.1.3.2">
<h4><span class="header-section-number">2.1.3.2</span> Random Subset of Panel<a href="manipulate-and-summarize-dataframes.html#random-subset-of-panel" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are <span class="math inline">\(N\)</span> individuals, each could be observed <span class="math inline">\(M\)</span> times, but then select a subset of rows only, so each person is randomly observed only a subset of times. Specifically, there there are 3 unique students with student ids, and the second variable shows the random dates in which the student showed up in class, out of the 10 classes available.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="manipulate-and-summarize-dataframes.html#cb264-1" tabindex="-1"></a><span class="co"># Define</span></span>
<span id="cb264-2"><a href="manipulate-and-summarize-dataframes.html#cb264-2" tabindex="-1"></a>it_N <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb264-3"><a href="manipulate-and-summarize-dataframes.html#cb264-3" tabindex="-1"></a>it_M <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb264-4"><a href="manipulate-and-summarize-dataframes.html#cb264-4" tabindex="-1"></a>svr_id <span class="ot">&lt;-</span> <span class="st">&#39;student_id&#39;</span></span>
<span id="cb264-5"><a href="manipulate-and-summarize-dataframes.html#cb264-5" tabindex="-1"></a></span>
<span id="cb264-6"><a href="manipulate-and-summarize-dataframes.html#cb264-6" tabindex="-1"></a><span class="co"># dataframe</span></span>
<span id="cb264-7"><a href="manipulate-and-summarize-dataframes.html#cb264-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb264-8"><a href="manipulate-and-summarize-dataframes.html#cb264-8" tabindex="-1"></a>df_panel_rand <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">matrix</span>(it_M, <span class="at">nrow=</span>it_N, <span class="at">ncol=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-9"><a href="manipulate-and-summarize-dataframes.html#cb264-9" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> svr_id) <span class="sc">%&gt;%</span></span>
<span id="cb264-10"><a href="manipulate-and-summarize-dataframes.html#cb264-10" tabindex="-1"></a>  <span class="fu">uncount</span>(V1) <span class="sc">%&gt;%</span></span>
<span id="cb264-11"><a href="manipulate-and-summarize-dataframes.html#cb264-11" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_id)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb264-12"><a href="manipulate-and-summarize-dataframes.html#cb264-12" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">in_class =</span> <span class="fu">case_when</span>(<span class="fu">rnorm</span>(<span class="fu">n</span>(),<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-13"><a href="manipulate-and-summarize-dataframes.html#cb264-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(in_class <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_id), date) <span class="sc">%&gt;%</span></span>
<span id="cb264-14"><a href="manipulate-and-summarize-dataframes.html#cb264-14" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date_in_class =</span> date)</span>
<span id="cb264-15"><a href="manipulate-and-summarize-dataframes.html#cb264-15" tabindex="-1"></a></span>
<span id="cb264-16"><a href="manipulate-and-summarize-dataframes.html#cb264-16" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb264-17"><a href="manipulate-and-summarize-dataframes.html#cb264-17" tabindex="-1"></a><span class="fu">kable</span>(df_panel_rand) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
student_id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date_in_class
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
9
</td>
</tr>
</tbody>
</table>

</div>
</div>
<div id="generate-variables-conditional-on-others" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Generate Variables Conditional On Others<a href="manipulate-and-summarize-dataframes.html#generate-variables-conditional-on-others" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="categorical-variable-based-on-several-variables" class="section level4 hasAnchor" number="2.1.4.1">
<h4><span class="header-section-number">2.1.4.1</span> Categorical Variable based on Several Variables<a href="manipulate-and-summarize-dataframes.html#categorical-variable-based-on-several-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given several other variables, and generate a new variable when these varaibles satisfy conditions. Note that case_when are ifelse type statements. So below</p>
<ol style="list-style-type: decimal">
<li>group one is below 16 MPG</li>
<li>when do <em>qsec &gt;= 20</em> second line that is elseif, only those that are <em>&gt;=16</em> are considered here</li>
<li>then think about two dimensional mpg and qsec grid, the lower-right area, give another category to manual cars in that group</li>
</ol>
<p>First, we generate categorical variables based on the characteristics of several variables.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="manipulate-and-summarize-dataframes.html#cb265-1" tabindex="-1"></a><span class="co"># Get mtcars</span></span>
<span id="cb265-2"><a href="manipulate-and-summarize-dataframes.html#cb265-2" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb265-3"><a href="manipulate-and-summarize-dataframes.html#cb265-3" tabindex="-1"></a></span>
<span id="cb265-4"><a href="manipulate-and-summarize-dataframes.html#cb265-4" tabindex="-1"></a><span class="co"># case_when with mtcars</span></span>
<span id="cb265-5"><a href="manipulate-and-summarize-dataframes.html#cb265-5" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb265-6"><a href="manipulate-and-summarize-dataframes.html#cb265-6" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb265-7"><a href="manipulate-and-summarize-dataframes.html#cb265-7" tabindex="-1"></a>        <span class="at">mpg_qsec_am_grp =</span></span>
<span id="cb265-8"><a href="manipulate-and-summarize-dataframes.html#cb265-8" tabindex="-1"></a>            <span class="fu">case_when</span>(</span>
<span id="cb265-9"><a href="manipulate-and-summarize-dataframes.html#cb265-9" tabindex="-1"></a>                mpg <span class="sc">&lt;</span> <span class="dv">16</span> <span class="sc">~</span> <span class="st">&quot;&lt; 16 MPG&quot;</span>,</span>
<span id="cb265-10"><a href="manipulate-and-summarize-dataframes.html#cb265-10" tabindex="-1"></a>                qsec <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">&quot;&gt; 16 MPG &amp; qsec &gt;= 20&quot;</span>,</span>
<span id="cb265-11"><a href="manipulate-and-summarize-dataframes.html#cb265-11" tabindex="-1"></a>                am <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;&gt; 16 MPG &amp; asec &lt; 20 &amp; manual&quot;</span>,</span>
<span id="cb265-12"><a href="manipulate-and-summarize-dataframes.html#cb265-12" tabindex="-1"></a>                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Others&quot;</span></span>
<span id="cb265-13"><a href="manipulate-and-summarize-dataframes.html#cb265-13" tabindex="-1"></a>            )</span>
<span id="cb265-14"><a href="manipulate-and-summarize-dataframes.html#cb265-14" tabindex="-1"></a>    )</span></code></pre></div>
<p>Now we generate scatter plot based on the combined factors</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="manipulate-and-summarize-dataframes.html#cb266-1" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb266-2"><a href="manipulate-and-summarize-dataframes.html#cb266-2" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Use case_when To Generate ifelse Groupings&quot;</span>)</span>
<span id="cb266-3"><a href="manipulate-and-summarize-dataframes.html#cb266-3" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb266-4"><a href="manipulate-and-summarize-dataframes.html#cb266-4" tabindex="-1"></a>    <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb266-5"><a href="manipulate-and-summarize-dataframes.html#cb266-5" tabindex="-1"></a>    <span class="st">&quot;R4Econ/amto/tibble/htmlpdfr/fs_tib_na.html&quot;</span></span>
<span id="cb266-6"><a href="manipulate-and-summarize-dataframes.html#cb266-6" tabindex="-1"></a>)</span>
<span id="cb266-7"><a href="manipulate-and-summarize-dataframes.html#cb266-7" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb266-8"><a href="manipulate-and-summarize-dataframes.html#cb266-8" tabindex="-1"></a>    <span class="st">&quot;mtcars dataset, &quot;</span>,</span>
<span id="cb266-9"><a href="manipulate-and-summarize-dataframes.html#cb266-9" tabindex="-1"></a>    <span class="st">&quot;https://fanwangecon.github.io/R4Econ/&quot;</span></span>
<span id="cb266-10"><a href="manipulate-and-summarize-dataframes.html#cb266-10" tabindex="-1"></a>)</span>
<span id="cb266-11"><a href="manipulate-and-summarize-dataframes.html#cb266-11" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&quot;MPG = Miles per Gallon&quot;</span></span>
<span id="cb266-12"><a href="manipulate-and-summarize-dataframes.html#cb266-12" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&quot;QSEC = time for 1/4 Miles&quot;</span></span>
<span id="cb266-13"><a href="manipulate-and-summarize-dataframes.html#cb266-13" tabindex="-1"></a></span>
<span id="cb266-14"><a href="manipulate-and-summarize-dataframes.html#cb266-14" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb266-15"><a href="manipulate-and-summarize-dataframes.html#cb266-15" tabindex="-1"></a>plt_mtcars_casewhen_scatter <span class="ot">&lt;-</span></span>
<span id="cb266-16"><a href="manipulate-and-summarize-dataframes.html#cb266-16" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb266-17"><a href="manipulate-and-summarize-dataframes.html#cb266-17" tabindex="-1"></a>        df_mtcars,</span>
<span id="cb266-18"><a href="manipulate-and-summarize-dataframes.html#cb266-18" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb266-19"><a href="manipulate-and-summarize-dataframes.html#cb266-19" tabindex="-1"></a>            <span class="at">x =</span> mpg, <span class="at">y =</span> qsec,</span>
<span id="cb266-20"><a href="manipulate-and-summarize-dataframes.html#cb266-20" tabindex="-1"></a>            <span class="at">colour =</span> mpg_qsec_am_grp,</span>
<span id="cb266-21"><a href="manipulate-and-summarize-dataframes.html#cb266-21" tabindex="-1"></a>            <span class="at">shape =</span> mpg_qsec_am_grp</span>
<span id="cb266-22"><a href="manipulate-and-summarize-dataframes.html#cb266-22" tabindex="-1"></a>        )</span>
<span id="cb266-23"><a href="manipulate-and-summarize-dataframes.html#cb266-23" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb266-24"><a href="manipulate-and-summarize-dataframes.html#cb266-24" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb266-25"><a href="manipulate-and-summarize-dataframes.html#cb266-25" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb266-26"><a href="manipulate-and-summarize-dataframes.html#cb266-26" tabindex="-1"></a>        <span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb266-27"><a href="manipulate-and-summarize-dataframes.html#cb266-27" tabindex="-1"></a>        <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption</span>
<span id="cb266-28"><a href="manipulate-and-summarize-dataframes.html#cb266-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb266-29"><a href="manipulate-and-summarize-dataframes.html#cb266-29" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb266-30"><a href="manipulate-and-summarize-dataframes.html#cb266-30" tabindex="-1"></a></span>
<span id="cb266-31"><a href="manipulate-and-summarize-dataframes.html#cb266-31" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb266-32"><a href="manipulate-and-summarize-dataframes.html#cb266-32" tabindex="-1"></a><span class="fu">print</span>(plt_mtcars_casewhen_scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-100-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="categorical-variables-based-on-one-continuous-variable" class="section level4 hasAnchor" number="2.1.4.2">
<h4><span class="header-section-number">2.1.4.2</span> Categorical Variables based on one Continuous Variable<a href="manipulate-and-summarize-dataframes.html#categorical-variables-based-on-one-continuous-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We generate one categorical variable for gear, based on “continuous” gear values. Note that the same categorical label appears for gear is 3 as well as gear is 5.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="manipulate-and-summarize-dataframes.html#cb267-1" tabindex="-1"></a><span class="co"># Generate a categorical variable</span></span>
<span id="cb267-2"><a href="manipulate-and-summarize-dataframes.html#cb267-2" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb267-3"><a href="manipulate-and-summarize-dataframes.html#cb267-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gear_cate =</span> <span class="fu">case_when</span>(</span>
<span id="cb267-4"><a href="manipulate-and-summarize-dataframes.html#cb267-4" tabindex="-1"></a>        gear <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">&quot;gear is 3&quot;</span>,</span>
<span id="cb267-5"><a href="manipulate-and-summarize-dataframes.html#cb267-5" tabindex="-1"></a>        gear <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;gear is 4&quot;</span>,</span>
<span id="cb267-6"><a href="manipulate-and-summarize-dataframes.html#cb267-6" tabindex="-1"></a>        gear <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span> hp <span class="sc">&lt;=</span> <span class="dv">110</span> <span class="sc">~</span> <span class="st">&quot;gear 5 hp les sequal 110&quot;</span>,</span>
<span id="cb267-7"><a href="manipulate-and-summarize-dataframes.html#cb267-7" tabindex="-1"></a>        gear <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span> hp <span class="sc">&gt;</span> <span class="dv">110</span> <span class="sc">&amp;</span> hp <span class="sc">&lt;=</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">&quot;gear 5 hp 110 to 130&quot;</span>,</span>
<span id="cb267-8"><a href="manipulate-and-summarize-dataframes.html#cb267-8" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;otherwise&quot;</span></span>
<span id="cb267-9"><a href="manipulate-and-summarize-dataframes.html#cb267-9" tabindex="-1"></a>    ))</span>
<span id="cb267-10"><a href="manipulate-and-summarize-dataframes.html#cb267-10" tabindex="-1"></a><span class="co"># Tabulate</span></span>
<span id="cb267-11"><a href="manipulate-and-summarize-dataframes.html#cb267-11" tabindex="-1"></a>df_mtcars_gear_tb <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb267-12"><a href="manipulate-and-summarize-dataframes.html#cb267-12" tabindex="-1"></a>  <span class="fu">group_by</span>(gear_cate, gear) <span class="sc">%&gt;%</span></span>
<span id="cb267-13"><a href="manipulate-and-summarize-dataframes.html#cb267-13" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb267-14"><a href="manipulate-and-summarize-dataframes.html#cb267-14" tabindex="-1"></a>  <span class="fu">spread</span>(gear_cate, n)</span>
<span id="cb267-15"><a href="manipulate-and-summarize-dataframes.html#cb267-15" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb267-16"><a href="manipulate-and-summarize-dataframes.html#cb267-16" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="st">&quot;Categorical from continuous with non-continuous values matching to same key&quot;</span></span>
<span id="cb267-17"><a href="manipulate-and-summarize-dataframes.html#cb267-17" tabindex="-1"></a>df_mtcars_gear_tb <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">caption =</span> st_title) <span class="sc">%&gt;%</span></span>
<span id="cb267-18"><a href="manipulate-and-summarize-dataframes.html#cb267-18" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-101">Table 2.3: </span>Categorical from continuous with non-continuous values matching to same key
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear 5 hp 110 to 130
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear 5 hp les sequal 110
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear is 3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear is 4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
otherwise
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<div id="generate-na-values-if-variables-have-certain-value" class="section level4 hasAnchor" number="2.1.4.3">
<h4><span class="header-section-number">2.1.4.3</span> Generate NA values if Variables have Certain Value<a href="manipulate-and-summarize-dataframes.html#generate-na-values-if-variables-have-certain-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the example below, in one line:</p>
<ol style="list-style-type: decimal">
<li>generate a random standard normal vector</li>
<li>two set na methods:
<ul>
<li>if the value of the standard normal is negative, set value to -999, otherwise MPG, replace the value <em>-999</em> with <em>NA</em></li>
<li>case_when only with type specific NA values</li>
<li><a href="https://github.com/tidyverse/dplyr/issues/3202#issuecomment-343601409">Assigning NA yields error in case_when</a></li>
<li>note we need to conform NA to type</li>
</ul></li>
<li>generate new categorical variable based on NA condition using is.na with both string and numeric NAs jointly considered.
<ul>
<li>fake NA string to be printed on chart</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="manipulate-and-summarize-dataframes.html#cb268-1" tabindex="-1"></a><span class="co"># Get mtcars</span></span>
<span id="cb268-2"><a href="manipulate-and-summarize-dataframes.html#cb268-2" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb268-3"><a href="manipulate-and-summarize-dataframes.html#cb268-3" tabindex="-1"></a></span>
<span id="cb268-4"><a href="manipulate-and-summarize-dataframes.html#cb268-4" tabindex="-1"></a><span class="co"># Make some values of mpg randomly NA</span></span>
<span id="cb268-5"><a href="manipulate-and-summarize-dataframes.html#cb268-5" tabindex="-1"></a><span class="co"># the NA has to conform to the type of the remaining values for the new variable</span></span>
<span id="cb268-6"><a href="manipulate-and-summarize-dataframes.html#cb268-6" tabindex="-1"></a><span class="co"># NA_real_, NA_character_, NA_integer_, NA_complex_</span></span>
<span id="cb268-7"><a href="manipulate-and-summarize-dataframes.html#cb268-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2341</span>)</span>
<span id="cb268-8"><a href="manipulate-and-summarize-dataframes.html#cb268-8" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb268-9"><a href="manipulate-and-summarize-dataframes.html#cb268-9" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mpg_wth_NA1 =</span> <span class="fu">na_if</span>(</span>
<span id="cb268-10"><a href="manipulate-and-summarize-dataframes.html#cb268-10" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb268-11"><a href="manipulate-and-summarize-dataframes.html#cb268-11" tabindex="-1"></a>            <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">999</span>,</span>
<span id="cb268-12"><a href="manipulate-and-summarize-dataframes.html#cb268-12" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> mpg</span>
<span id="cb268-13"><a href="manipulate-and-summarize-dataframes.html#cb268-13" tabindex="-1"></a>        ),</span>
<span id="cb268-14"><a href="manipulate-and-summarize-dataframes.html#cb268-14" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">999</span></span>
<span id="cb268-15"><a href="manipulate-and-summarize-dataframes.html#cb268-15" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb268-16"><a href="manipulate-and-summarize-dataframes.html#cb268-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mpg_wth_NA2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb268-17"><a href="manipulate-and-summarize-dataframes.html#cb268-17" tabindex="-1"></a>        <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb268-18"><a href="manipulate-and-summarize-dataframes.html#cb268-18" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> mpg</span>
<span id="cb268-19"><a href="manipulate-and-summarize-dataframes.html#cb268-19" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb268-20"><a href="manipulate-and-summarize-dataframes.html#cb268-20" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mpg_wth_NA3 =</span> <span class="fu">case_when</span>(</span>
<span id="cb268-21"><a href="manipulate-and-summarize-dataframes.html#cb268-21" tabindex="-1"></a>        <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb268-22"><a href="manipulate-and-summarize-dataframes.html#cb268-22" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;shock &gt; 0 string&quot;</span></span>
<span id="cb268-23"><a href="manipulate-and-summarize-dataframes.html#cb268-23" tabindex="-1"></a>    ))</span>
<span id="cb268-24"><a href="manipulate-and-summarize-dataframes.html#cb268-24" tabindex="-1"></a></span>
<span id="cb268-25"><a href="manipulate-and-summarize-dataframes.html#cb268-25" tabindex="-1"></a><span class="co"># Generate New Variables based on if mpg_wth_NA is NA or not</span></span>
<span id="cb268-26"><a href="manipulate-and-summarize-dataframes.html#cb268-26" tabindex="-1"></a><span class="co"># same variable as above, but now first a category based on if NA</span></span>
<span id="cb268-27"><a href="manipulate-and-summarize-dataframes.html#cb268-27" tabindex="-1"></a><span class="co"># And we generate a fake string &quot;NA&quot; variable, this is not NA</span></span>
<span id="cb268-28"><a href="manipulate-and-summarize-dataframes.html#cb268-28" tabindex="-1"></a><span class="co"># the String NA allows for it to be printed on figure</span></span>
<span id="cb268-29"><a href="manipulate-and-summarize-dataframes.html#cb268-29" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> df_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb268-30"><a href="manipulate-and-summarize-dataframes.html#cb268-30" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb268-31"><a href="manipulate-and-summarize-dataframes.html#cb268-31" tabindex="-1"></a>        <span class="at">group_with_na =</span></span>
<span id="cb268-32"><a href="manipulate-and-summarize-dataframes.html#cb268-32" tabindex="-1"></a>            <span class="fu">case_when</span>(</span>
<span id="cb268-33"><a href="manipulate-and-summarize-dataframes.html#cb268-33" tabindex="-1"></a>                <span class="fu">is.na</span>(mpg_wth_NA2) <span class="sc">&amp;</span> <span class="fu">is.na</span>(mpg_wth_NA3) <span class="sc">~</span></span>
<span id="cb268-34"><a href="manipulate-and-summarize-dataframes.html#cb268-34" tabindex="-1"></a>                    <span class="st">&quot;Rand String and Rand Numeric both NA&quot;</span>,</span>
<span id="cb268-35"><a href="manipulate-and-summarize-dataframes.html#cb268-35" tabindex="-1"></a>                mpg <span class="sc">&lt;</span> <span class="dv">16</span> <span class="sc">~</span> <span class="st">&quot;&lt; 16 MPG&quot;</span>,</span>
<span id="cb268-36"><a href="manipulate-and-summarize-dataframes.html#cb268-36" tabindex="-1"></a>                qsec <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">&quot;&gt; 16 MPG &amp; qsec &gt;= 20&quot;</span>,</span>
<span id="cb268-37"><a href="manipulate-and-summarize-dataframes.html#cb268-37" tabindex="-1"></a>                am <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;&gt; 16 MPG &amp; asec &lt; 20 &amp; manual&quot;</span>,</span>
<span id="cb268-38"><a href="manipulate-and-summarize-dataframes.html#cb268-38" tabindex="-1"></a>                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Fake String NA&quot;</span></span>
<span id="cb268-39"><a href="manipulate-and-summarize-dataframes.html#cb268-39" tabindex="-1"></a>            )</span>
<span id="cb268-40"><a href="manipulate-and-summarize-dataframes.html#cb268-40" tabindex="-1"></a>    )</span>
<span id="cb268-41"><a href="manipulate-and-summarize-dataframes.html#cb268-41" tabindex="-1"></a></span>
<span id="cb268-42"><a href="manipulate-and-summarize-dataframes.html#cb268-42" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb268-43"><a href="manipulate-and-summarize-dataframes.html#cb268-43" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(df_mtcars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;mpg&quot;</span>)), <span class="dv">13</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb268-44"><a href="manipulate-and-summarize-dataframes.html#cb268-44" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg_wth_NA1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg_wth_NA2
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
mpg_wth_NA3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
shock &gt; 0 string
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Valiant
</td>
<td style="text-align:right;">
18.1
</td>
<td style="text-align:right;">
18.1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
shock &gt; 0 string
</td>
</tr>
<tr>
<td style="text-align:left;">
Duster 360
</td>
<td style="text-align:right;">
14.3
</td>
<td style="text-align:right;">
14.3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
shock &gt; 0 string
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 240D
</td>
<td style="text-align:right;">
24.4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
24.4
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 230
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 280
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 280C
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 450SE
</td>
<td style="text-align:right;">
16.4
</td>
<td style="text-align:right;">
16.4
</td>
<td style="text-align:right;">
16.4
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 450SL
</td>
<td style="text-align:right;">
17.3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
shock &gt; 0 string
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="manipulate-and-summarize-dataframes.html#cb269-1" tabindex="-1"></a><span class="co"># # Setting to NA</span></span>
<span id="cb269-2"><a href="manipulate-and-summarize-dataframes.html#cb269-2" tabindex="-1"></a><span class="co"># df.reg.use &lt;- df.reg.guat %&gt;% filter(!!sym(var.mth) != 0)</span></span>
<span id="cb269-3"><a href="manipulate-and-summarize-dataframes.html#cb269-3" tabindex="-1"></a><span class="co"># df.reg.use.log &lt;- df.reg.use</span></span>
<span id="cb269-4"><a href="manipulate-and-summarize-dataframes.html#cb269-4" tabindex="-1"></a><span class="co"># df.reg.use.log[which(is.nan(df.reg.use$prot.imputed.log)),] = NA</span></span>
<span id="cb269-5"><a href="manipulate-and-summarize-dataframes.html#cb269-5" tabindex="-1"></a><span class="co"># df.reg.use.log[which(df.reg.use$prot.imputed.log==Inf),] = NA</span></span>
<span id="cb269-6"><a href="manipulate-and-summarize-dataframes.html#cb269-6" tabindex="-1"></a><span class="co"># df.reg.use.log[which(df.reg.use$prot.imputed.log==-Inf),] = NA</span></span>
<span id="cb269-7"><a href="manipulate-and-summarize-dataframes.html#cb269-7" tabindex="-1"></a><span class="co"># df.reg.use.log &lt;- df.reg.use.log %&gt;% drop_na(prot.imputed.log)</span></span>
<span id="cb269-8"><a href="manipulate-and-summarize-dataframes.html#cb269-8" tabindex="-1"></a><span class="co"># # df.reg.use.log$prot.imputed.log</span></span></code></pre></div>
<p>Now we generate scatter plot based on the combined factors, but now with the NA category</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="manipulate-and-summarize-dataframes.html#cb270-1" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb270-2"><a href="manipulate-and-summarize-dataframes.html#cb270-2" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb270-3"><a href="manipulate-and-summarize-dataframes.html#cb270-3" tabindex="-1"></a>    <span class="st">&quot;Use na_if and is.na to Generate and Distinguish NA Values</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb270-4"><a href="manipulate-and-summarize-dataframes.html#cb270-4" tabindex="-1"></a>    <span class="st">&quot;NA_real_, NA_character_, NA_integer_, NA_complex_&quot;</span></span>
<span id="cb270-5"><a href="manipulate-and-summarize-dataframes.html#cb270-5" tabindex="-1"></a>)</span>
<span id="cb270-6"><a href="manipulate-and-summarize-dataframes.html#cb270-6" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb270-7"><a href="manipulate-and-summarize-dataframes.html#cb270-7" tabindex="-1"></a>    <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb270-8"><a href="manipulate-and-summarize-dataframes.html#cb270-8" tabindex="-1"></a>    <span class="st">&quot;R4Econ/amto/tibble/htmlpdfr/fs_tib_na.html&quot;</span></span>
<span id="cb270-9"><a href="manipulate-and-summarize-dataframes.html#cb270-9" tabindex="-1"></a>)</span>
<span id="cb270-10"><a href="manipulate-and-summarize-dataframes.html#cb270-10" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb270-11"><a href="manipulate-and-summarize-dataframes.html#cb270-11" tabindex="-1"></a>    <span class="st">&quot;mtcars dataset, &quot;</span>,</span>
<span id="cb270-12"><a href="manipulate-and-summarize-dataframes.html#cb270-12" tabindex="-1"></a>    <span class="st">&quot;https://fanwangecon.github.io/R4Econ/&quot;</span></span>
<span id="cb270-13"><a href="manipulate-and-summarize-dataframes.html#cb270-13" tabindex="-1"></a>)</span>
<span id="cb270-14"><a href="manipulate-and-summarize-dataframes.html#cb270-14" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&quot;MPG = Miles per Gallon&quot;</span></span>
<span id="cb270-15"><a href="manipulate-and-summarize-dataframes.html#cb270-15" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&quot;QSEC = time for 1/4 Miles&quot;</span></span>
<span id="cb270-16"><a href="manipulate-and-summarize-dataframes.html#cb270-16" tabindex="-1"></a></span>
<span id="cb270-17"><a href="manipulate-and-summarize-dataframes.html#cb270-17" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb270-18"><a href="manipulate-and-summarize-dataframes.html#cb270-18" tabindex="-1"></a>plt_mtcars_ifisna_scatter <span class="ot">&lt;-</span></span>
<span id="cb270-19"><a href="manipulate-and-summarize-dataframes.html#cb270-19" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb270-20"><a href="manipulate-and-summarize-dataframes.html#cb270-20" tabindex="-1"></a>        df_mtcars,</span>
<span id="cb270-21"><a href="manipulate-and-summarize-dataframes.html#cb270-21" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb270-22"><a href="manipulate-and-summarize-dataframes.html#cb270-22" tabindex="-1"></a>            <span class="at">x =</span> mpg, <span class="at">y =</span> qsec,</span>
<span id="cb270-23"><a href="manipulate-and-summarize-dataframes.html#cb270-23" tabindex="-1"></a>            <span class="at">colour =</span> group_with_na,</span>
<span id="cb270-24"><a href="manipulate-and-summarize-dataframes.html#cb270-24" tabindex="-1"></a>            <span class="at">shape =</span> group_with_na</span>
<span id="cb270-25"><a href="manipulate-and-summarize-dataframes.html#cb270-25" tabindex="-1"></a>        )</span>
<span id="cb270-26"><a href="manipulate-and-summarize-dataframes.html#cb270-26" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb270-27"><a href="manipulate-and-summarize-dataframes.html#cb270-27" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb270-28"><a href="manipulate-and-summarize-dataframes.html#cb270-28" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb270-29"><a href="manipulate-and-summarize-dataframes.html#cb270-29" tabindex="-1"></a>        <span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb270-30"><a href="manipulate-and-summarize-dataframes.html#cb270-30" tabindex="-1"></a>        <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption</span>
<span id="cb270-31"><a href="manipulate-and-summarize-dataframes.html#cb270-31" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb270-32"><a href="manipulate-and-summarize-dataframes.html#cb270-32" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb270-33"><a href="manipulate-and-summarize-dataframes.html#cb270-33" tabindex="-1"></a></span>
<span id="cb270-34"><a href="manipulate-and-summarize-dataframes.html#cb270-34" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb270-35"><a href="manipulate-and-summarize-dataframes.html#cb270-35" tabindex="-1"></a><span class="fu">print</span>(plt_mtcars_ifisna_scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-103-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="approximate-values-comparison" class="section level4 hasAnchor" number="2.1.4.4">
<h4><span class="header-section-number">2.1.4.4</span> Approximate Values Comparison<a href="manipulate-and-summarize-dataframes.html#approximate-values-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>r values almost the same</li>
<li><a href="https://stat.ethz.ch/R-manual/R-patched/library/base/html/all.equal.html">all.equal</a></li>
</ul>
<p>From numeric approximation, often values are very close, and should be set to equal. Use <em>isTRUE(all.equal)</em>. In the example below, we randomly generates four arrays. Two of the arrays have slightly higher variance, two arrays have slightly lower variance. They sd are to be 10 times below or 10 times above the tolerance comparison level. The values are not the same in any of the columns, but by allowing for almost true given some tolerance level, in the low standard deviation case, the values differences are within tolerance, so they are equal.</p>
<p>This is an essential issue when dealing with optimization results.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="manipulate-and-summarize-dataframes.html#cb271-1" tabindex="-1"></a><span class="co"># Set tolerance</span></span>
<span id="cb271-2"><a href="manipulate-and-summarize-dataframes.html#cb271-2" tabindex="-1"></a>tol_lvl <span class="ot">&lt;-</span> <span class="fl">1.5e-3</span></span>
<span id="cb271-3"><a href="manipulate-and-summarize-dataframes.html#cb271-3" tabindex="-1"></a>sd_lower_than_tol <span class="ot">&lt;-</span> tol_lvl <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb271-4"><a href="manipulate-and-summarize-dataframes.html#cb271-4" tabindex="-1"></a>sd_higher_than_tol <span class="ot">&lt;-</span> tol_lvl <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb271-5"><a href="manipulate-and-summarize-dataframes.html#cb271-5" tabindex="-1"></a></span>
<span id="cb271-6"><a href="manipulate-and-summarize-dataframes.html#cb271-6" tabindex="-1"></a><span class="co"># larger SD</span></span>
<span id="cb271-7"><a href="manipulate-and-summarize-dataframes.html#cb271-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb271-8"><a href="manipulate-and-summarize-dataframes.html#cb271-8" tabindex="-1"></a>mt_runif_standard <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sd_higher_than_tol), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb271-9"><a href="manipulate-and-summarize-dataframes.html#cb271-9" tabindex="-1"></a></span>
<span id="cb271-10"><a href="manipulate-and-summarize-dataframes.html#cb271-10" tabindex="-1"></a><span class="co"># small SD</span></span>
<span id="cb271-11"><a href="manipulate-and-summarize-dataframes.html#cb271-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb271-12"><a href="manipulate-and-summarize-dataframes.html#cb271-12" tabindex="-1"></a>mt_rnorm_small_sd <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sd_lower_than_tol), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb271-13"><a href="manipulate-and-summarize-dataframes.html#cb271-13" tabindex="-1"></a></span>
<span id="cb271-14"><a href="manipulate-and-summarize-dataframes.html#cb271-14" tabindex="-1"></a><span class="co"># Generates Random Matirx</span></span>
<span id="cb271-15"><a href="manipulate-and-summarize-dataframes.html#cb271-15" tabindex="-1"></a>tb_rnorm_runif <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(mt_rnorm_small_sd, mt_runif_standard))</span>
<span id="cb271-16"><a href="manipulate-and-summarize-dataframes.html#cb271-16" tabindex="-1"></a></span>
<span id="cb271-17"><a href="manipulate-and-summarize-dataframes.html#cb271-17" tabindex="-1"></a><span class="co"># Are Variables the same, not for strict comparison</span></span>
<span id="cb271-18"><a href="manipulate-and-summarize-dataframes.html#cb271-18" tabindex="-1"></a>tb_rnorm_runif_approxi_same <span class="ot">&lt;-</span> tb_rnorm_runif <span class="sc">%&gt;%</span></span>
<span id="cb271-19"><a href="manipulate-and-summarize-dataframes.html#cb271-19" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb271-20"><a href="manipulate-and-summarize-dataframes.html#cb271-20" tabindex="-1"></a>        <span class="at">V1_V2_ALMOST_SAME =</span></span>
<span id="cb271-21"><a href="manipulate-and-summarize-dataframes.html#cb271-21" tabindex="-1"></a>            <span class="fu">case_when</span>(</span>
<span id="cb271-22"><a href="manipulate-and-summarize-dataframes.html#cb271-22" tabindex="-1"></a>                <span class="fu">isTRUE</span>(<span class="fu">all.equal</span>(V1, V2, <span class="at">tolerance =</span> tol_lvl)) <span class="sc">~</span></span>
<span id="cb271-23"><a href="manipulate-and-summarize-dataframes.html#cb271-23" tabindex="-1"></a>                    <span class="fu">paste0</span>(<span class="st">&quot;TOL=&quot;</span>, sd_lower_than_tol, <span class="st">&quot;, SAME ALMOST&quot;</span>),</span>
<span id="cb271-24"><a href="manipulate-and-summarize-dataframes.html#cb271-24" tabindex="-1"></a>                <span class="cn">TRUE</span> <span class="sc">~</span></span>
<span id="cb271-25"><a href="manipulate-and-summarize-dataframes.html#cb271-25" tabindex="-1"></a>                    <span class="fu">paste0</span>(<span class="st">&quot;TOL=&quot;</span>, sd_lower_than_tol, <span class="st">&quot;, NOT SAME ALMOST&quot;</span>)</span>
<span id="cb271-26"><a href="manipulate-and-summarize-dataframes.html#cb271-26" tabindex="-1"></a>            )</span>
<span id="cb271-27"><a href="manipulate-and-summarize-dataframes.html#cb271-27" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb271-28"><a href="manipulate-and-summarize-dataframes.html#cb271-28" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb271-29"><a href="manipulate-and-summarize-dataframes.html#cb271-29" tabindex="-1"></a>        <span class="at">V3_V4_ALMOST_SAME =</span></span>
<span id="cb271-30"><a href="manipulate-and-summarize-dataframes.html#cb271-30" tabindex="-1"></a>            <span class="fu">case_when</span>(</span>
<span id="cb271-31"><a href="manipulate-and-summarize-dataframes.html#cb271-31" tabindex="-1"></a>                <span class="fu">isTRUE</span>(<span class="fu">all.equal</span>(V3, V4, <span class="at">tolerance =</span> tol_lvl)) <span class="sc">~</span></span>
<span id="cb271-32"><a href="manipulate-and-summarize-dataframes.html#cb271-32" tabindex="-1"></a>                    <span class="fu">paste0</span>(<span class="st">&quot;TOL=&quot;</span>, sd_higher_than_tol, <span class="st">&quot;, SAME ALMOST&quot;</span>),</span>
<span id="cb271-33"><a href="manipulate-and-summarize-dataframes.html#cb271-33" tabindex="-1"></a>                <span class="cn">TRUE</span> <span class="sc">~</span></span>
<span id="cb271-34"><a href="manipulate-and-summarize-dataframes.html#cb271-34" tabindex="-1"></a>                    <span class="fu">paste0</span>(<span class="st">&quot;TOL=&quot;</span>, sd_higher_than_tol, <span class="st">&quot;, NOT SAME ALMOST&quot;</span>)</span>
<span id="cb271-35"><a href="manipulate-and-summarize-dataframes.html#cb271-35" tabindex="-1"></a>            )</span>
<span id="cb271-36"><a href="manipulate-and-summarize-dataframes.html#cb271-36" tabindex="-1"></a>    )</span>
<span id="cb271-37"><a href="manipulate-and-summarize-dataframes.html#cb271-37" tabindex="-1"></a></span>
<span id="cb271-38"><a href="manipulate-and-summarize-dataframes.html#cb271-38" tabindex="-1"></a><span class="co"># Pring</span></span>
<span id="cb271-39"><a href="manipulate-and-summarize-dataframes.html#cb271-39" tabindex="-1"></a><span class="fu">kable</span>(tb_rnorm_runif_approxi_same) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
V4
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
V1_V2_ALMOST_SAME
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
V3_V4_ALMOST_SAME
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.0000841
</td>
<td style="text-align:right;">
0.0002573
</td>
<td style="text-align:right;">
-0.0084071
</td>
<td style="text-align:right;">
0.0257260
</td>
<td style="text-align:left;">
TOL=0.00015, SAME ALMOST
</td>
<td style="text-align:left;">
TOL=0.015, NOT SAME ALMOST
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0000345
</td>
<td style="text-align:right;">
0.0000691
</td>
<td style="text-align:right;">
-0.0034527
</td>
<td style="text-align:right;">
0.0069137
</td>
<td style="text-align:left;">
TOL=0.00015, SAME ALMOST
</td>
<td style="text-align:left;">
TOL=0.015, NOT SAME ALMOST
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0002338
</td>
<td style="text-align:right;">
-0.0001898
</td>
<td style="text-align:right;">
0.0233806
</td>
<td style="text-align:right;">
-0.0189759
</td>
<td style="text-align:left;">
TOL=0.00015, SAME ALMOST
</td>
<td style="text-align:left;">
TOL=0.015, NOT SAME ALMOST
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0000106
</td>
<td style="text-align:right;">
-0.0001030
</td>
<td style="text-align:right;">
0.0010576
</td>
<td style="text-align:right;">
-0.0103028
</td>
<td style="text-align:left;">
TOL=0.00015, SAME ALMOST
</td>
<td style="text-align:left;">
TOL=0.015, NOT SAME ALMOST
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0000194
</td>
<td style="text-align:right;">
-0.0000668
</td>
<td style="text-align:right;">
0.0019393
</td>
<td style="text-align:right;">
-0.0066849
</td>
<td style="text-align:left;">
TOL=0.00015, SAME ALMOST
</td>
<td style="text-align:left;">
TOL=0.015, NOT SAME ALMOST
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div id="string-dataframes" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> String Dataframes<a href="manipulate-and-summarize-dataframes.html#string-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="list-of-strings-to-tibble-datfare" class="section level4 hasAnchor" number="2.1.5.1">
<h4><span class="header-section-number">2.1.5.1</span> List of Strings to Tibble Datfare<a href="manipulate-and-summarize-dataframes.html#list-of-strings-to-tibble-datfare" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are several lists of strings, store them as variables in a dataframe.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="manipulate-and-summarize-dataframes.html#cb272-1" tabindex="-1"></a><span class="co"># Sting data inputs</span></span>
<span id="cb272-2"><a href="manipulate-and-summarize-dataframes.html#cb272-2" tabindex="-1"></a>ls_st_abc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>)</span>
<span id="cb272-3"><a href="manipulate-and-summarize-dataframes.html#cb272-3" tabindex="-1"></a>ls_st_efg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;e&#39;</span>, <span class="st">&#39;f&#39;</span>, <span class="st">&#39;g&#39;</span>)</span>
<span id="cb272-4"><a href="manipulate-and-summarize-dataframes.html#cb272-4" tabindex="-1"></a>ls_st_opq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;o&#39;</span>, <span class="st">&#39;p&#39;</span>, <span class="st">&#39;q&#39;</span>)</span>
<span id="cb272-5"><a href="manipulate-and-summarize-dataframes.html#cb272-5" tabindex="-1"></a>mt_str <span class="ot">=</span> <span class="fu">cbind</span>(ls_st_abc, ls_st_efg, ls_st_opq)</span>
<span id="cb272-6"><a href="manipulate-and-summarize-dataframes.html#cb272-6" tabindex="-1"></a></span>
<span id="cb272-7"><a href="manipulate-and-summarize-dataframes.html#cb272-7" tabindex="-1"></a><span class="co"># Column Names</span></span>
<span id="cb272-8"><a href="manipulate-and-summarize-dataframes.html#cb272-8" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>,<span class="st">&#39;var1&#39;</span>,<span class="st">&#39;var2&#39;</span>,<span class="st">&#39;var3&#39;</span>)</span>
<span id="cb272-9"><a href="manipulate-and-summarize-dataframes.html#cb272-9" tabindex="-1"></a></span>
<span id="cb272-10"><a href="manipulate-and-summarize-dataframes.html#cb272-10" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb272-11"><a href="manipulate-and-summarize-dataframes.html#cb272-11" tabindex="-1"></a>tb_st_combine <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_str) <span class="sc">%&gt;%</span></span>
<span id="cb272-12"><a href="manipulate-and-summarize-dataframes.html#cb272-12" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb272-13"><a href="manipulate-and-summarize-dataframes.html#cb272-13" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb272-14"><a href="manipulate-and-summarize-dataframes.html#cb272-14" tabindex="-1"></a></span>
<span id="cb272-15"><a href="manipulate-and-summarize-dataframes.html#cb272-15" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb272-16"><a href="manipulate-and-summarize-dataframes.html#cb272-16" tabindex="-1"></a><span class="fu">kable</span>(tb_st_combine) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
var1
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
var2
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
var3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
e
</td>
<td style="text-align:left;">
o
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
f
</td>
<td style="text-align:left;">
p
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
c
</td>
<td style="text-align:left;">
g
</td>
<td style="text-align:left;">
q
</td>
</tr>
</tbody>
</table>
</div>
<div id="find-and-replace" class="section level4 hasAnchor" number="2.1.5.2">
<h4><span class="header-section-number">2.1.5.2</span> Find and Replace<a href="manipulate-and-summarize-dataframes.html#find-and-replace" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Find and Replace in Dataframe.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="manipulate-and-summarize-dataframes.html#cb273-1" tabindex="-1"></a><span class="co"># if string value is contained in variable</span></span>
<span id="cb273-2"><a href="manipulate-and-summarize-dataframes.html#cb273-2" tabindex="-1"></a>(<span class="st">&quot;bridex.B&quot;</span> <span class="sc">%in%</span> (df.reg.out.all<span class="sc">$</span>vars_var.y))</span>
<span id="cb273-3"><a href="manipulate-and-summarize-dataframes.html#cb273-3" tabindex="-1"></a><span class="co"># if string value is not contained in variable:</span></span>
<span id="cb273-4"><a href="manipulate-and-summarize-dataframes.html#cb273-4" tabindex="-1"></a><span class="co"># 1. type is variable name</span></span>
<span id="cb273-5"><a href="manipulate-and-summarize-dataframes.html#cb273-5" tabindex="-1"></a><span class="co"># 2. Toyota|Mazda are strings to be excluded</span></span>
<span id="cb273-6"><a href="manipulate-and-summarize-dataframes.html#cb273-6" tabindex="-1"></a><span class="fu">filter</span>(mtcars, <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;Toyota|Mazda&#39;</span>, type))</span>
<span id="cb273-7"><a href="manipulate-and-summarize-dataframes.html#cb273-7" tabindex="-1"></a></span>
<span id="cb273-8"><a href="manipulate-and-summarize-dataframes.html#cb273-8" tabindex="-1"></a><span class="co"># filter does not contain string</span></span>
<span id="cb273-9"><a href="manipulate-and-summarize-dataframes.html#cb273-9" tabindex="-1"></a>rs_hgt_prot_log_tidy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(term, <span class="st">&#39;prot&#39;</span>))</span></code></pre></div>

</div>
</div>
</div>
<div id="counting-observation" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Counting Observation<a href="manipulate-and-summarize-dataframes.html#counting-observation" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="counting-and-tabulations" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Counting and Tabulations<a href="manipulate-and-summarize-dataframes.html#counting-and-tabulations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="tabulate-two-categorial-variables" class="section level4 hasAnchor" number="2.2.1.1">
<h4><span class="header-section-number">2.2.1.1</span> Tabulate Two Categorial Variables<a href="manipulate-and-summarize-dataframes.html#tabulate-two-categorial-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, we tabulate a dataset, and show categories as rows, and display frequencies.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="manipulate-and-summarize-dataframes.html#cb274-1" tabindex="-1"></a><span class="co"># We use the mtcars dataset</span></span>
<span id="cb274-2"><a href="manipulate-and-summarize-dataframes.html#cb274-2" tabindex="-1"></a>tb_tab_joint <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb274-3"><a href="manipulate-and-summarize-dataframes.html#cb274-3" tabindex="-1"></a>    <span class="fu">group_by</span>(gear, am) <span class="sc">%&gt;%</span></span>
<span id="cb274-4"><a href="manipulate-and-summarize-dataframes.html#cb274-4" tabindex="-1"></a>    <span class="fu">tally</span>()</span>
<span id="cb274-5"><a href="manipulate-and-summarize-dataframes.html#cb274-5" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb274-6"><a href="manipulate-and-summarize-dataframes.html#cb274-6" tabindex="-1"></a>tb_tab_joint <span class="sc">%&gt;%</span></span>
<span id="cb274-7"><a href="manipulate-and-summarize-dataframes.html#cb274-7" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;cross tabulation, stacked&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb274-8"><a href="manipulate-and-summarize-dataframes.html#cb274-8" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-108">Table 2.4: </span>cross tabulation, stacked
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
am
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>We can present this as cross tabs.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="manipulate-and-summarize-dataframes.html#cb275-1" tabindex="-1"></a><span class="co"># We use the mtcars dataset</span></span>
<span id="cb275-2"><a href="manipulate-and-summarize-dataframes.html#cb275-2" tabindex="-1"></a>tb_cross_tab <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb275-3"><a href="manipulate-and-summarize-dataframes.html#cb275-3" tabindex="-1"></a>    <span class="fu">group_by</span>(gear, am) <span class="sc">%&gt;%</span></span>
<span id="cb275-4"><a href="manipulate-and-summarize-dataframes.html#cb275-4" tabindex="-1"></a>    <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb275-5"><a href="manipulate-and-summarize-dataframes.html#cb275-5" tabindex="-1"></a>    <span class="fu">spread</span>(am, n)</span>
<span id="cb275-6"><a href="manipulate-and-summarize-dataframes.html#cb275-6" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb275-7"><a href="manipulate-and-summarize-dataframes.html#cb275-7" tabindex="-1"></a>tb_cross_tab <span class="sc">%&gt;%</span></span>
<span id="cb275-8"><a href="manipulate-and-summarize-dataframes.html#cb275-8" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;cross tabulation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb275-9"><a href="manipulate-and-summarize-dataframes.html#cb275-9" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-109">Table 2.5: </span>cross tabulation
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
</div>
<div id="tabulate-once-each-distinct-subgroup" class="section level4 hasAnchor" number="2.2.1.2">
<h4><span class="header-section-number">2.2.1.2</span> Tabulate Once Each Distinct Subgroup<a href="manipulate-and-summarize-dataframes.html#tabulate-once-each-distinct-subgroup" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have two variables variables, am and mpg, the mpg values are not unique. We want to know how many unique mpg levels are there for each am group. We use the <a href="https://dplyr.tidyverse.org/reference/distinct.html">dplyr::distinct</a> function to achieve this.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="manipulate-and-summarize-dataframes.html#cb276-1" tabindex="-1"></a>tb_dist_tab <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb276-2"><a href="manipulate-and-summarize-dataframes.html#cb276-2" tabindex="-1"></a>    <span class="co"># .keep_all to keep all variables</span></span>
<span id="cb276-3"><a href="manipulate-and-summarize-dataframes.html#cb276-3" tabindex="-1"></a>    <span class="fu">distinct</span>(am, mpg, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb276-4"><a href="manipulate-and-summarize-dataframes.html#cb276-4" tabindex="-1"></a>    <span class="fu">group_by</span>(am) <span class="sc">%&gt;%</span></span>
<span id="cb276-5"><a href="manipulate-and-summarize-dataframes.html#cb276-5" tabindex="-1"></a>    <span class="fu">tally</span>()</span>
<span id="cb276-6"><a href="manipulate-and-summarize-dataframes.html#cb276-6" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb276-7"><a href="manipulate-and-summarize-dataframes.html#cb276-7" tabindex="-1"></a>tb_dist_tab <span class="sc">%&gt;%</span></span>
<span id="cb276-8"><a href="manipulate-and-summarize-dataframes.html#cb276-8" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;Tabulate distinct groups&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb276-9"><a href="manipulate-and-summarize-dataframes.html#cb276-9" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-110">Table 2.6: </span>Tabulate distinct groups
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
am
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
</tr>
</tbody>
</table>
</div>
<div id="expanding-to-panel" class="section level4 hasAnchor" number="2.2.1.3">
<h4><span class="header-section-number">2.2.1.3</span> Expanding to Panel<a href="manipulate-and-summarize-dataframes.html#expanding-to-panel" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are <span class="math inline">\(N\)</span> individuals, each observed for <span class="math inline">\(Y_i\)</span> years. We start with a dataframe where individuals are the unit of observation, we expand this to a panel with a row for each of the years that the individual is in the survey for.</p>
<p><em>Algorithm</em>:</p>
<ol style="list-style-type: decimal">
<li>generate testing frame, the individual attribute dataset with invariant information over panel</li>
<li>uncount, duplicate rows by years in survey</li>
<li>group and generate sorted index</li>
<li>add indiviual specific stat year to index</li>
</ol>
<p>First, we construct the dataframe where each row is an individual.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="manipulate-and-summarize-dataframes.html#cb277-1" tabindex="-1"></a><span class="co"># 1. Array of Years in the Survey</span></span>
<span id="cb277-2"><a href="manipulate-and-summarize-dataframes.html#cb277-2" tabindex="-1"></a>ar_years_in_survey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb277-3"><a href="manipulate-and-summarize-dataframes.html#cb277-3" tabindex="-1"></a>ar_start_yaer <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb277-4"><a href="manipulate-and-summarize-dataframes.html#cb277-4" tabindex="-1"></a>ar_end_year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb277-5"><a href="manipulate-and-summarize-dataframes.html#cb277-5" tabindex="-1"></a>mt_combine <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_years_in_survey, ar_start_yaer, ar_end_year)</span>
<span id="cb277-6"><a href="manipulate-and-summarize-dataframes.html#cb277-6" tabindex="-1"></a></span>
<span id="cb277-7"><a href="manipulate-and-summarize-dataframes.html#cb277-7" tabindex="-1"></a><span class="co"># This is the individual attribute dataset, attributes that are invariant acrosss years</span></span>
<span id="cb277-8"><a href="manipulate-and-summarize-dataframes.html#cb277-8" tabindex="-1"></a>tb_indi_attributes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_combine) <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb277-9"><a href="manipulate-and-summarize-dataframes.html#cb277-9" tabindex="-1"></a></span>
<span id="cb277-10"><a href="manipulate-and-summarize-dataframes.html#cb277-10" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb277-11"><a href="manipulate-and-summarize-dataframes.html#cb277-11" tabindex="-1"></a>tb_indi_attributes <span class="sc">%&gt;%</span></span>
<span id="cb277-12"><a href="manipulate-and-summarize-dataframes.html#cb277-12" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb277-13"><a href="manipulate-and-summarize-dataframes.html#cb277-13" tabindex="-1"></a>    <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb277-14"><a href="manipulate-and-summarize-dataframes.html#cb277-14" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_years_in_survey
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_start_yaer
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_end_year
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>Second, we change the dataframe so that each unit of observation is an individual in an year. This means we will duplicate the information in the prior table, so if an individual appears for 4 years in the survey, we will now have four rows for this individual. We generate a new variable that is the calendar year. This is now a panel dataset.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="manipulate-and-summarize-dataframes.html#cb278-1" tabindex="-1"></a><span class="co"># 2. Sort and generate variable equal to sorted index</span></span>
<span id="cb278-2"><a href="manipulate-and-summarize-dataframes.html#cb278-2" tabindex="-1"></a>tb_indi_panel <span class="ot">&lt;-</span> tb_indi_attributes <span class="sc">%&gt;%</span> <span class="fu">uncount</span>(ar_years_in_survey)</span>
<span id="cb278-3"><a href="manipulate-and-summarize-dataframes.html#cb278-3" tabindex="-1"></a></span>
<span id="cb278-4"><a href="manipulate-and-summarize-dataframes.html#cb278-4" tabindex="-1"></a><span class="co"># 3. Panel now construct exactly which year in survey, note that all needed is sort index</span></span>
<span id="cb278-5"><a href="manipulate-and-summarize-dataframes.html#cb278-5" tabindex="-1"></a><span class="co"># Note sorting not needed, all rows identical now</span></span>
<span id="cb278-6"><a href="manipulate-and-summarize-dataframes.html#cb278-6" tabindex="-1"></a>tb_indi_panel <span class="ot">&lt;-</span> tb_indi_panel <span class="sc">%&gt;%</span></span>
<span id="cb278-7"><a href="manipulate-and-summarize-dataframes.html#cb278-7" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb278-8"><a href="manipulate-and-summarize-dataframes.html#cb278-8" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">yr_in_survey =</span> <span class="fu">row_number</span>())</span>
<span id="cb278-9"><a href="manipulate-and-summarize-dataframes.html#cb278-9" tabindex="-1"></a></span>
<span id="cb278-10"><a href="manipulate-and-summarize-dataframes.html#cb278-10" tabindex="-1"></a>tb_indi_panel <span class="ot">&lt;-</span> tb_indi_panel <span class="sc">%&gt;%</span></span>
<span id="cb278-11"><a href="manipulate-and-summarize-dataframes.html#cb278-11" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">calendar_year =</span> yr_in_survey <span class="sc">+</span> ar_start_yaer <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb278-12"><a href="manipulate-and-summarize-dataframes.html#cb278-12" tabindex="-1"></a></span>
<span id="cb278-13"><a href="manipulate-and-summarize-dataframes.html#cb278-13" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb278-14"><a href="manipulate-and-summarize-dataframes.html#cb278-14" tabindex="-1"></a>tb_indi_panel <span class="sc">%&gt;%</span></span>
<span id="cb278-15"><a href="manipulate-and-summarize-dataframes.html#cb278-15" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb278-16"><a href="manipulate-and-summarize-dataframes.html#cb278-16" tabindex="-1"></a>    <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb278-17"><a href="manipulate-and-summarize-dataframes.html#cb278-17" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_start_yaer
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_end_year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
yr_in_survey
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
calendar_year
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="sorting-indexing-slicing" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Sorting, Indexing, Slicing<a href="manipulate-and-summarize-dataframes.html#sorting-indexing-slicing" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="sorting-1" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Sorting<a href="manipulate-and-summarize-dataframes.html#sorting-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="generate-sorted-index-within-group-with-repeating-values" class="section level4 hasAnchor" number="2.3.1.1">
<h4><span class="header-section-number">2.3.1.1</span> Generate Sorted Index within Group with Repeating Values<a href="manipulate-and-summarize-dataframes.html#generate-sorted-index-within-group-with-repeating-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is a variable, sort by this variable, then generate index from 1 to N representing sorted values of this index. If there are repeating values, still assign index, different index each value.</p>
<ul>
<li>r generate index sort</li>
<li>dplyr mutate equals index</li>
</ul>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="manipulate-and-summarize-dataframes.html#cb279-1" tabindex="-1"></a><span class="co"># Sort and generate variable equal to sorted index</span></span>
<span id="cb279-2"><a href="manipulate-and-summarize-dataframes.html#cb279-2" tabindex="-1"></a>df_iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Sepal.Length) <span class="sc">%&gt;%</span></span>
<span id="cb279-3"><a href="manipulate-and-summarize-dataframes.html#cb279-3" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Index =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb279-4"><a href="manipulate-and-summarize-dataframes.html#cb279-4" tabindex="-1"></a>              <span class="fu">select</span>(Sepal.Length, Sepal.Len.Index, <span class="fu">everything</span>())</span>
<span id="cb279-5"><a href="manipulate-and-summarize-dataframes.html#cb279-5" tabindex="-1"></a></span>
<span id="cb279-6"><a href="manipulate-and-summarize-dataframes.html#cb279-6" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb279-7"><a href="manipulate-and-summarize-dataframes.html#cb279-7" tabindex="-1"></a>df_iris <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb279-8"><a href="manipulate-and-summarize-dataframes.html#cb279-8" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb279-9"><a href="manipulate-and-summarize-dataframes.html#cb279-9" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Index
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Width
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Width
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2.3
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="populate-value-from-lowest-index-to-all-other-rows" class="section level4 hasAnchor" number="2.3.1.2">
<h4><span class="header-section-number">2.3.1.2</span> Populate Value from Lowest Index to All other Rows<a href="manipulate-and-summarize-dataframes.html#populate-value-from-lowest-index-to-all-other-rows" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We would like to calculate for example the ratio of each individual’s highest to the the person with the lowest height in a dataset. We first need to generated sorted index from lowest to highest, and then populate the lowest height to all rows, and then divide.</p>
<p><em>Search Terms</em>:</p>
<ul>
<li>r spread value to all rows from one row</li>
<li>r other rows equal to the value of one row</li>
<li>Conditional assignment of one variable to the value of one of two other variables</li>
<li>dplyr mutate conditional</li>
<li>dplyr value from one row to all rows</li>
<li>dplyr mutate equal to value in another cell</li>
</ul>
<p><em>Links</em>:</p>
<ul>
<li>see: dplyr <a href="https://dplyr.tidyverse.org/reference/ranking.html">rank</a></li>
<li>see: dplyr <a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></li>
</ul>
<div id="short-method-mutate-and-min" class="section level5 hasAnchor" number="2.3.1.2.1">
<h5><span class="header-section-number">2.3.1.2.1</span> Short Method: mutate and min<a href="manipulate-and-summarize-dataframes.html#short-method-mutate-and-min" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We just want the lowest value to be in its own column, so that we can compute various statistics using the lowest value variable and the original variable.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="manipulate-and-summarize-dataframes.html#cb280-1" tabindex="-1"></a><span class="co"># 1. Sort</span></span>
<span id="cb280-2"><a href="manipulate-and-summarize-dataframes.html#cb280-2" tabindex="-1"></a>df_iris_m1 <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Sepal.Len.Lowest.all =</span> <span class="fu">min</span>(Sepal.Length)) <span class="sc">%&gt;%</span></span>
<span id="cb280-3"><a href="manipulate-and-summarize-dataframes.html#cb280-3" tabindex="-1"></a>                <span class="fu">select</span>(Sepal.Length, Sepal.Len.Lowest.all, <span class="fu">everything</span>())</span>
<span id="cb280-4"><a href="manipulate-and-summarize-dataframes.html#cb280-4" tabindex="-1"></a></span>
<span id="cb280-5"><a href="manipulate-and-summarize-dataframes.html#cb280-5" tabindex="-1"></a></span>
<span id="cb280-6"><a href="manipulate-and-summarize-dataframes.html#cb280-6" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb280-7"><a href="manipulate-and-summarize-dataframes.html#cb280-7" tabindex="-1"></a>df_iris_m1 <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb280-8"><a href="manipulate-and-summarize-dataframes.html#cb280-8" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb280-9"><a href="manipulate-and-summarize-dataframes.html#cb280-9" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Lowest.all
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Width
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Petal.Width
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
1.7
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="long-method-row_number-and-case_when" class="section level5 hasAnchor" number="2.3.1.2.2">
<h5><span class="header-section-number">2.3.1.2.2</span> Long Method: row_number and case_when<a href="manipulate-and-summarize-dataframes.html#long-method-row_number-and-case_when" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This is the long method, using row_number, and case_when. The benefit of this method is that it generates several intermediate variables that might be useful. And the key final step is to set a new variable (A=<em>Sepal.Len.Lowest.all</em>) equal to another variable’s (B=<em>Sepal.Length</em>’s) value at the index that satisfies condition based a third variable (C=<em>Sepal.Len.Index</em>).</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="manipulate-and-summarize-dataframes.html#cb281-1" tabindex="-1"></a><span class="co"># 1. Sort</span></span>
<span id="cb281-2"><a href="manipulate-and-summarize-dataframes.html#cb281-2" tabindex="-1"></a><span class="co"># 2. generate index</span></span>
<span id="cb281-3"><a href="manipulate-and-summarize-dataframes.html#cb281-3" tabindex="-1"></a><span class="co"># 3. value at lowest index (case_when)</span></span>
<span id="cb281-4"><a href="manipulate-and-summarize-dataframes.html#cb281-4" tabindex="-1"></a><span class="co"># 4. spread value from lowest index to other rows</span></span>
<span id="cb281-5"><a href="manipulate-and-summarize-dataframes.html#cb281-5" tabindex="-1"></a><span class="co"># Note step 4 does not require step 3</span></span>
<span id="cb281-6"><a href="manipulate-and-summarize-dataframes.html#cb281-6" tabindex="-1"></a>df_iris_m2 <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Sepal.Length) <span class="sc">%&gt;%</span></span>
<span id="cb281-7"><a href="manipulate-and-summarize-dataframes.html#cb281-7" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Index =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb281-8"><a href="manipulate-and-summarize-dataframes.html#cb281-8" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Lowest.one =</span></span>
<span id="cb281-9"><a href="manipulate-and-summarize-dataframes.html#cb281-9" tabindex="-1"></a>                       <span class="fu">case_when</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> Sepal.Length)) <span class="sc">%&gt;%</span></span>
<span id="cb281-10"><a href="manipulate-and-summarize-dataframes.html#cb281-10" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Lowest.all =</span></span>
<span id="cb281-11"><a href="manipulate-and-summarize-dataframes.html#cb281-11" tabindex="-1"></a>                       Sepal.Length[Sepal.Len.Index<span class="sc">==</span><span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb281-12"><a href="manipulate-and-summarize-dataframes.html#cb281-12" tabindex="-1"></a>              <span class="fu">select</span>(Sepal.Length, Sepal.Len.Index,</span>
<span id="cb281-13"><a href="manipulate-and-summarize-dataframes.html#cb281-13" tabindex="-1"></a>                     Sepal.Len.Lowest.one, Sepal.Len.Lowest.all)</span>
<span id="cb281-14"><a href="manipulate-and-summarize-dataframes.html#cb281-14" tabindex="-1"></a></span>
<span id="cb281-15"><a href="manipulate-and-summarize-dataframes.html#cb281-15" tabindex="-1"></a></span>
<span id="cb281-16"><a href="manipulate-and-summarize-dataframes.html#cb281-16" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb281-17"><a href="manipulate-and-summarize-dataframes.html#cb281-17" tabindex="-1"></a>df_iris_m2 <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-18"><a href="manipulate-and-summarize-dataframes.html#cb281-18" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb281-19"><a href="manipulate-and-summarize-dataframes.html#cb281-19" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Index
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Lowest.one
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Lowest.all
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="generate-sorted-index-based-on-deviations" class="section level4 hasAnchor" number="2.3.1.3">
<h4><span class="header-section-number">2.3.1.3</span> Generate Sorted Index based on Deviations<a href="manipulate-and-summarize-dataframes.html#generate-sorted-index-based-on-deviations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Generate Positive and Negative Index based on Ordered Deviation from some Number.</p>
<p>There is a variable that is continuous, substract a number from this variable, and generate index based on deviations. Think of the index as generating intervals indicating where the value lies. 0th index indicates the largest value in sequence that is smaller than or equal to number <span class="math inline">\(x\)</span>, 1st index indicates the smallest value in sequence that is larger than number <span class="math inline">\(x\)</span>.</p>
<p>The solution below is a little bit convoluated and long, there is likely a much quicker way. The process below shows various intermediary outputs that help arrive at deviation index <em>Sepal.Len.Devi.Index</em> from initial sorted index <em>Sepal.Len.Index</em>.</p>
<p><em>search</em>:</p>
<ul>
<li>dplyr arrange ignore na</li>
<li>dplyr index deviation from order number sequence</li>
<li>dplyr index below above</li>
<li>dplyr index order below above value</li>
</ul>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="manipulate-and-summarize-dataframes.html#cb282-1" tabindex="-1"></a><span class="co"># 1. Sort and generate variable equal to sorted index</span></span>
<span id="cb282-2"><a href="manipulate-and-summarize-dataframes.html#cb282-2" tabindex="-1"></a><span class="co"># 2. Plus or minus deviations from some value</span></span>
<span id="cb282-3"><a href="manipulate-and-summarize-dataframes.html#cb282-3" tabindex="-1"></a><span class="co"># 3. Find the zero, which means, the number closests to zero including zero from the negative side</span></span>
<span id="cb282-4"><a href="manipulate-and-summarize-dataframes.html#cb282-4" tabindex="-1"></a><span class="co"># 4. Find the index at the highest zero and below deviation point</span></span>
<span id="cb282-5"><a href="manipulate-and-summarize-dataframes.html#cb282-5" tabindex="-1"></a><span class="co"># 5. Difference of zero index and original sorted index</span></span>
<span id="cb282-6"><a href="manipulate-and-summarize-dataframes.html#cb282-6" tabindex="-1"></a>sc_val_x <span class="ot">&lt;-</span> <span class="fl">4.65</span></span>
<span id="cb282-7"><a href="manipulate-and-summarize-dataframes.html#cb282-7" tabindex="-1"></a>df_iris_deviate <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Sepal.Length) <span class="sc">%&gt;%</span></span>
<span id="cb282-8"><a href="manipulate-and-summarize-dataframes.html#cb282-8" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Index =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb282-9"><a href="manipulate-and-summarize-dataframes.html#cb282-9" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Devi =</span> (Sepal.Length <span class="sc">-</span> sc_val_x)) <span class="sc">%&gt;%</span></span>
<span id="cb282-10"><a href="manipulate-and-summarize-dataframes.html#cb282-10" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Devi.Neg =</span></span>
<span id="cb282-11"><a href="manipulate-and-summarize-dataframes.html#cb282-11" tabindex="-1"></a>                       <span class="fu">case_when</span>(Sepal.Len.Devi <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">~</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(Sepal.Len.Devi))) <span class="sc">%&gt;%</span></span>
<span id="cb282-12"><a href="manipulate-and-summarize-dataframes.html#cb282-12" tabindex="-1"></a>              <span class="fu">arrange</span>((Sepal.Len.Devi.Neg), <span class="fu">desc</span>(Sepal.Len.Index)) <span class="sc">%&gt;%</span></span>
<span id="cb282-13"><a href="manipulate-and-summarize-dataframes.html#cb282-13" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Index.Zero =</span></span>
<span id="cb282-14"><a href="manipulate-and-summarize-dataframes.html#cb282-14" tabindex="-1"></a>                       <span class="fu">case_when</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> Sepal.Len.Index)) <span class="sc">%&gt;%</span></span>
<span id="cb282-15"><a href="manipulate-and-summarize-dataframes.html#cb282-15" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Sepal.Len.Devi.Index =</span></span>
<span id="cb282-16"><a href="manipulate-and-summarize-dataframes.html#cb282-16" tabindex="-1"></a>                       Sepal.Len.Index <span class="sc">-</span> Sepal.Len.Index.Zero[<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb282-17"><a href="manipulate-and-summarize-dataframes.html#cb282-17" tabindex="-1"></a>              <span class="fu">arrange</span>(Sepal.Len.Index) <span class="sc">%&gt;%</span></span>
<span id="cb282-18"><a href="manipulate-and-summarize-dataframes.html#cb282-18" tabindex="-1"></a>              <span class="fu">select</span>(Sepal.Length, Sepal.Len.Index, Sepal.Len.Devi,</span>
<span id="cb282-19"><a href="manipulate-and-summarize-dataframes.html#cb282-19" tabindex="-1"></a>                     Sepal.Len.Devi.Neg, Sepal.Len.Index.Zero, Sepal.Len.Devi.Index)</span>
<span id="cb282-20"><a href="manipulate-and-summarize-dataframes.html#cb282-20" tabindex="-1"></a></span>
<span id="cb282-21"><a href="manipulate-and-summarize-dataframes.html#cb282-21" tabindex="-1"></a></span>
<span id="cb282-22"><a href="manipulate-and-summarize-dataframes.html#cb282-22" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb282-23"><a href="manipulate-and-summarize-dataframes.html#cb282-23" tabindex="-1"></a>df_iris_deviate <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb282-24"><a href="manipulate-and-summarize-dataframes.html#cb282-24" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb282-25"><a href="manipulate-and-summarize-dataframes.html#cb282-25" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Length
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Index
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Devi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Devi.Neg
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Index.Zero
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Sepal.Len.Devi.Index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.35
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-8
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-7
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-6
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-5
</td>
</tr>
<tr>
<td style="text-align:right;">
4.5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-4
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-2
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
11
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div id="group-sort-and-slice" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Group, Sort and Slice<a href="manipulate-and-summarize-dataframes.html#group-sort-and-slice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="sort-in-ascending-and-descending-orders" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Sort in Ascending and Descending Orders<a href="manipulate-and-summarize-dataframes.html#sort-in-ascending-and-descending-orders" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We sort the mtcars dataset, sorting in <em>ascending</em> order by cyl, and in <em>descending</em> order by mpg. Using <em>arrange</em>, <em>desc(disp)</em> means sorting the disp variable in descending order. In the table shown below, <em>cyc</em> is increasing, and <em>disp</em> id decreasing within each <em>cyc</em> group.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="manipulate-and-summarize-dataframes.html#cb283-1" tabindex="-1"></a><span class="fu">kable</span>(mtcars <span class="sc">%&gt;%</span></span>
<span id="cb283-2"><a href="manipulate-and-summarize-dataframes.html#cb283-2" tabindex="-1"></a>  <span class="fu">arrange</span>(cyl, <span class="fu">desc</span>(disp)) <span class="sc">%&gt;%</span></span>
<span id="cb283-3"><a href="manipulate-and-summarize-dataframes.html#cb283-3" tabindex="-1"></a>    <span class="co"># Select and filter to reduce display clutter</span></span>
<span id="cb283-4"><a href="manipulate-and-summarize-dataframes.html#cb283-4" tabindex="-1"></a>    <span class="fu">select</span>(cyl, disp, mpg)) <span class="sc">%&gt;%</span></span>
<span id="cb283-5"><a href="manipulate-and-summarize-dataframes.html#cb283-5" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cyl
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Merc 240D
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
146.7
</td>
<td style="text-align:right;">
24.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 230
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
140.8
</td>
<td style="text-align:right;">
22.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Volvo 142E
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
121.0
</td>
<td style="text-align:right;">
21.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Porsche 914-2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
120.3
</td>
<td style="text-align:right;">
26.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Toyota Corona
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
120.1
</td>
<td style="text-align:right;">
21.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
108.0
</td>
<td style="text-align:right;">
22.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Lotus Europa
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
95.1
</td>
<td style="text-align:right;">
30.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Fiat X1-9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
79.0
</td>
<td style="text-align:right;">
27.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Fiat 128
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
78.7
</td>
<td style="text-align:right;">
32.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Honda Civic
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
75.7
</td>
<td style="text-align:right;">
30.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Toyota Corolla
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
71.1
</td>
<td style="text-align:right;">
33.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
258.0
</td>
<td style="text-align:right;">
21.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Valiant
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
225.0
</td>
<td style="text-align:right;">
18.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 280
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
167.6
</td>
<td style="text-align:right;">
19.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 280C
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
167.6
</td>
<td style="text-align:right;">
17.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160.0
</td>
<td style="text-align:right;">
21.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160.0
</td>
<td style="text-align:right;">
21.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Ferrari Dino
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
145.0
</td>
<td style="text-align:right;">
19.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Cadillac Fleetwood
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
472.0
</td>
<td style="text-align:right;">
10.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Lincoln Continental
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
460.0
</td>
<td style="text-align:right;">
10.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Chrysler Imperial
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
440.0
</td>
<td style="text-align:right;">
14.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Pontiac Firebird
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
400.0
</td>
<td style="text-align:right;">
19.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
360.0
</td>
<td style="text-align:right;">
18.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Duster 360
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
360.0
</td>
<td style="text-align:right;">
14.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Ford Pantera L
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
351.0
</td>
<td style="text-align:right;">
15.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Camaro Z28
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
350.0
</td>
<td style="text-align:right;">
13.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Dodge Challenger
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
318.0
</td>
<td style="text-align:right;">
15.5
</td>
</tr>
<tr>
<td style="text-align:left;">
AMC Javelin
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
304.0
</td>
<td style="text-align:right;">
15.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Maserati Bora
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
301.0
</td>
<td style="text-align:right;">
15.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 450SE
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
275.8
</td>
<td style="text-align:right;">
16.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 450SL
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
275.8
</td>
<td style="text-align:right;">
17.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 450SLC
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
275.8
</td>
<td style="text-align:right;">
15.2
</td>
</tr>
</tbody>
</table>
</div>
<div id="get-highest-values-from-groups" class="section level4 hasAnchor" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> Get Highest Values from Groups<a href="manipulate-and-summarize-dataframes.html#get-highest-values-from-groups" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is a dataframe with a grouping variable with N unique values, for example N classes. Find the top three highest scoring students from each class. In the example below, group by <em>cyl</em> and get the cars with the highest and second highest <em>mpg</em> cars in each <em>cyl</em> group.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="manipulate-and-summarize-dataframes.html#cb284-1" tabindex="-1"></a><span class="co"># use mtcars: slice_head gets the lowest sorted value</span></span>
<span id="cb284-2"><a href="manipulate-and-summarize-dataframes.html#cb284-2" tabindex="-1"></a>df_groupby_top_mpg <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb284-3"><a href="manipulate-and-summarize-dataframes.html#cb284-3" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;car&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-4"><a href="manipulate-and-summarize-dataframes.html#cb284-4" tabindex="-1"></a>  <span class="fu">arrange</span>(cyl, <span class="fu">desc</span>(mpg)) <span class="sc">%&gt;%</span></span>
<span id="cb284-5"><a href="manipulate-and-summarize-dataframes.html#cb284-5" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb284-6"><a href="manipulate-and-summarize-dataframes.html#cb284-6" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-7"><a href="manipulate-and-summarize-dataframes.html#cb284-7" tabindex="-1"></a>  <span class="fu">select</span>(car, cyl, mpg, disp, hp)</span>
<span id="cb284-8"><a href="manipulate-and-summarize-dataframes.html#cb284-8" tabindex="-1"></a></span>
<span id="cb284-9"><a href="manipulate-and-summarize-dataframes.html#cb284-9" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb284-10"><a href="manipulate-and-summarize-dataframes.html#cb284-10" tabindex="-1"></a><span class="fu">kable</span>(df_groupby_top_mpg) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
car
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cyl
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Toyota Corolla
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
33.9
</td>
<td style="text-align:right;">
71.1
</td>
<td style="text-align:right;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
Fiat 128
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
32.4
</td>
<td style="text-align:right;">
78.7
</td>
<td style="text-align:right;">
66
</td>
</tr>
<tr>
<td style="text-align:left;">
Honda Civic
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
30.4
</td>
<td style="text-align:right;">
75.7
</td>
<td style="text-align:right;">
52
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
258.0
</td>
<td style="text-align:right;">
110
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
160.0
</td>
<td style="text-align:right;">
110
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
160.0
</td>
<td style="text-align:right;">
110
</td>
</tr>
<tr>
<td style="text-align:left;">
Pontiac Firebird
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:right;">
400.0
</td>
<td style="text-align:right;">
175
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
360.0
</td>
<td style="text-align:right;">
175
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 450SL
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
17.3
</td>
<td style="text-align:right;">
275.8
</td>
<td style="text-align:right;">
180
</td>
</tr>
</tbody>
</table>
</div>
<div id="differences-in-within-group-sorted-value" class="section level4 hasAnchor" number="2.3.2.3">
<h4><span class="header-section-number">2.3.2.3</span> Differences in Within-group Sorted Value<a href="manipulate-and-summarize-dataframes.html#differences-in-within-group-sorted-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We first take the largest N values in M groups, then we difference between the ranked top values in each group.</p>
<p>We have N classes, and M students in each class. We first select the 3 students with the highest scores from each class, then we take the difference between 1st and 2nd, and the difference between the 2nd and the 3rd students.</p>
<p>Note that when are using descending sort, so <em>lead</em> means the next value in descending sequencing, and <em>lag</em> means the last value which was higher in descending order.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="manipulate-and-summarize-dataframes.html#cb285-1" tabindex="-1"></a><span class="co"># We use what we just created in the last block.</span></span>
<span id="cb285-2"><a href="manipulate-and-summarize-dataframes.html#cb285-2" tabindex="-1"></a>df_groupby_top_mpg_diff <span class="ot">&lt;-</span> df_groupby_top_mpg <span class="sc">%&gt;%</span></span>
<span id="cb285-3"><a href="manipulate-and-summarize-dataframes.html#cb285-3" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb285-4"><a href="manipulate-and-summarize-dataframes.html#cb285-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mpg_diff_higher_minus_lower =</span> mpg <span class="sc">-</span> <span class="fu">lead</span>(mpg)) <span class="sc">%&gt;%</span></span>
<span id="cb285-5"><a href="manipulate-and-summarize-dataframes.html#cb285-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mpg_diff_lower_minus_higher =</span> mpg <span class="sc">-</span> <span class="fu">lag</span>(mpg))</span>
<span id="cb285-6"><a href="manipulate-and-summarize-dataframes.html#cb285-6" tabindex="-1"></a></span>
<span id="cb285-7"><a href="manipulate-and-summarize-dataframes.html#cb285-7" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb285-8"><a href="manipulate-and-summarize-dataframes.html#cb285-8" tabindex="-1"></a><span class="fu">kable</span>(df_groupby_top_mpg_diff)  <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
car
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cyl
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg_diff_higher_minus_lower
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg_diff_lower_minus_higher
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Toyota Corolla
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
33.9
</td>
<td style="text-align:right;">
71.1
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Fiat 128
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
32.4
</td>
<td style="text-align:right;">
78.7
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
-1.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Honda Civic
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
30.4
</td>
<td style="text-align:right;">
75.7
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-2.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
258.0
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
160.0
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
160.0
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Pontiac Firebird
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:right;">
400.0
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
360.0
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
-0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Merc 450SL
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
17.3
</td>
<td style="text-align:right;">
275.8
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-1.4
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="advanced-group-aggregation" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Advanced Group Aggregation<a href="manipulate-and-summarize-dataframes.html#advanced-group-aggregation" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="cumulative-statistics-within-group" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Cumulative Statistics within Group<a href="manipulate-and-summarize-dataframes.html#cumulative-statistics-within-group" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="cumulative-mean" class="section level4 hasAnchor" number="2.4.1.1">
<h4><span class="header-section-number">2.4.1.1</span> Cumulative Mean<a href="manipulate-and-summarize-dataframes.html#cumulative-mean" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is a dataset where there are different types of individuals, perhaps household size, that is the grouping variable. Within each group, we compute the incremental marginal propensity to consume for each additional check. We now also want to know the average propensity to consume up to each check considering all allocated checks. We needed to calculatet this for <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3691091">Nygaard, Sørensen and Wang (2021)</a>. This can be dealt with by using the <a href="https://dplyr.tidyverse.org/reference/cumall.html">cumall</a> function.</p>
<p>Use the <a href="https://fanwangecon.github.io/REconTools/reference/df_hgt_wgt.html">df_hgt_wgt</a> as the testing dataset. In the example below, group by individual id, sort by survey month, and cumulative mean over the protein variable.</p>
<p>In the protein example</p>
<p>First select the testing dataset and variables.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="manipulate-and-summarize-dataframes.html#cb286-1" tabindex="-1"></a><span class="co"># Load the REconTools Dataset df_hgt_wgt</span></span>
<span id="cb286-2"><a href="manipulate-and-summarize-dataframes.html#cb286-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;df_hgt_wgt&quot;</span>)</span>
<span id="cb286-3"><a href="manipulate-and-summarize-dataframes.html#cb286-3" tabindex="-1"></a><span class="co"># str(df_hgt_wgt)</span></span>
<span id="cb286-4"><a href="manipulate-and-summarize-dataframes.html#cb286-4" tabindex="-1"></a></span>
<span id="cb286-5"><a href="manipulate-and-summarize-dataframes.html#cb286-5" tabindex="-1"></a><span class="co"># Select several rows</span></span>
<span id="cb286-6"><a href="manipulate-and-summarize-dataframes.html#cb286-6" tabindex="-1"></a>df_hgt_wgt_sel <span class="ot">&lt;-</span> df_hgt_wgt <span class="sc">%&gt;%</span> </span>
<span id="cb286-7"><a href="manipulate-and-summarize-dataframes.html#cb286-7" tabindex="-1"></a>  <span class="fu">filter</span>(S.country <span class="sc">==</span> <span class="st">&quot;Cebu&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb286-8"><a href="manipulate-and-summarize-dataframes.html#cb286-8" tabindex="-1"></a>  <span class="fu">select</span>(indi.id, svymthRound, prot)</span></code></pre></div>
<p>Second, arrange, groupby, and cumulative mean. The protein variable is protein for each survey month, from month 2 to higher as babies grow. The protein intake observed is increasing quickly, hence, the cumulative mean is lower than the observed value for the survey month of the baby.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="manipulate-and-summarize-dataframes.html#cb287-1" tabindex="-1"></a><span class="co"># Group by indi.id and sort by protein</span></span>
<span id="cb287-2"><a href="manipulate-and-summarize-dataframes.html#cb287-2" tabindex="-1"></a>df_hgt_wgt_sel_cummean <span class="ot">&lt;-</span> df_hgt_wgt_sel <span class="sc">%&gt;%</span></span>
<span id="cb287-3"><a href="manipulate-and-summarize-dataframes.html#cb287-3" tabindex="-1"></a>  <span class="fu">arrange</span>(indi.id, svymthRound) <span class="sc">%&gt;%</span></span>
<span id="cb287-4"><a href="manipulate-and-summarize-dataframes.html#cb287-4" tabindex="-1"></a>  <span class="fu">group_by</span>(indi.id) <span class="sc">%&gt;%</span></span>
<span id="cb287-5"><a href="manipulate-and-summarize-dataframes.html#cb287-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prot_cummean =</span> <span class="fu">cummean</span>(prot))</span>
<span id="cb287-6"><a href="manipulate-and-summarize-dataframes.html#cb287-6" tabindex="-1"></a></span>
<span id="cb287-7"><a href="manipulate-and-summarize-dataframes.html#cb287-7" tabindex="-1"></a><span class="co"># display results</span></span>
<span id="cb287-8"><a href="manipulate-and-summarize-dataframes.html#cb287-8" tabindex="-1"></a>REconTools<span class="sc">::</span><span class="fu">ff_summ_percentiles</span>(df_hgt_wgt_sel_cummean)</span>
<span id="cb287-9"><a href="manipulate-and-summarize-dataframes.html#cb287-9" tabindex="-1"></a><span class="co"># display results</span></span>
<span id="cb287-10"><a href="manipulate-and-summarize-dataframes.html#cb287-10" tabindex="-1"></a>df_hgt_wgt_sel_cummean <span class="sc">%&gt;%</span> <span class="fu">filter</span>(indi.id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">18</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb287-11"><a href="manipulate-and-summarize-dataframes.html#cb287-11" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_cummean
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.5000000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
0.6000000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.5666667
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.5500000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6.1
</td>
<td style="text-align:right;">
1.6600000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
2.2166667
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6.4
</td>
<td style="text-align:right;">
2.8142857
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
20.1
</td>
<td style="text-align:right;">
4.9750000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
20.1
</td>
<td style="text-align:right;">
6.6555556
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:right;">
8.2900000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
24.9
</td>
<td style="text-align:right;">
9.8000000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
20.1
</td>
<td style="text-align:right;">
10.6583333
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
10.1
</td>
<td style="text-align:right;">
10.6153846
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
224
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
1.2000000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
2.9500000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
17.2
</td>
<td style="text-align:right;">
7.7000000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
18.6
</td>
<td style="text-align:right;">
10.4250000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
16.8
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
15.7
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
224
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>Third, in the basic implementation above, if an incremental month has NA, no values computed at that point or after. This is the case for individual 18 above. To ignore NA, we have, from <a href="https://stackoverflow.com/a/49906718/8280804">this</a>. Note how results for individual 18 changes.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="manipulate-and-summarize-dataframes.html#cb288-1" tabindex="-1"></a><span class="co"># https://stackoverflow.com/a/49906718/8280804</span></span>
<span id="cb288-2"><a href="manipulate-and-summarize-dataframes.html#cb288-2" tabindex="-1"></a><span class="co"># Group by indi.id and sort by protein</span></span>
<span id="cb288-3"><a href="manipulate-and-summarize-dataframes.html#cb288-3" tabindex="-1"></a>df_hgt_wgt_sel_cummean_noNA <span class="ot">&lt;-</span> df_hgt_wgt_sel <span class="sc">%&gt;%</span></span>
<span id="cb288-4"><a href="manipulate-and-summarize-dataframes.html#cb288-4" tabindex="-1"></a>  <span class="fu">arrange</span>(indi.id, svymthRound) <span class="sc">%&gt;%</span></span>
<span id="cb288-5"><a href="manipulate-and-summarize-dataframes.html#cb288-5" tabindex="-1"></a>  <span class="fu">group_by</span>(indi.id, <span class="at">isna =</span> <span class="fu">is.na</span>(prot)) <span class="sc">%&gt;%</span></span>
<span id="cb288-6"><a href="manipulate-and-summarize-dataframes.html#cb288-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prot_cummean =</span> <span class="fu">ifelse</span>(isna, <span class="cn">NA</span>, <span class="fu">cummean</span>(prot)))</span>
<span id="cb288-7"><a href="manipulate-and-summarize-dataframes.html#cb288-7" tabindex="-1"></a></span>
<span id="cb288-8"><a href="manipulate-and-summarize-dataframes.html#cb288-8" tabindex="-1"></a><span class="co"># display results</span></span>
<span id="cb288-9"><a href="manipulate-and-summarize-dataframes.html#cb288-9" tabindex="-1"></a>df_hgt_wgt_sel_cummean_noNA <span class="sc">%&gt;%</span> <span class="fu">filter</span>(indi.id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">18</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb288-10"><a href="manipulate-and-summarize-dataframes.html#cb288-10" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
isna
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_cummean
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.5000000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.6000000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.5666667
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.5500000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6.1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1.6600000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2.2166667
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6.4
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2.8142857
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
20.1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
4.9750000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
20.1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
6.6555556
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
8.2900000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
24.9
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
9.8000000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
20.1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
10.6583333
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
10.1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
10.6153846
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
224
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1.2000000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2.9500000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
17.2
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
7.7000000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
18.6
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
10.4250000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
16.8
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
11.7000000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
15.7
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
12.3666667
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
13.8142857
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
224
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>

</div>
</div>
<div id="groups-statistics" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Groups Statistics<a href="manipulate-and-summarize-dataframes.html#groups-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="aggrgate-groups-only-unique-group-and-count" class="section level4 hasAnchor" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> Aggrgate Groups only Unique Group and Count<a href="manipulate-and-summarize-dataframes.html#aggrgate-groups-only-unique-group-and-count" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are two variables that are numeric, we want to find all the unique groups of these two variables in a dataset and count how many times each unique group occurs</p>
<ul>
<li>r unique occurrence of numeric groups</li>
<li>How to add count of unique values by group to R data.frame</li>
</ul>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="manipulate-and-summarize-dataframes.html#cb289-1" tabindex="-1"></a><span class="co"># Numeric value combinations unique Groups</span></span>
<span id="cb289-2"><a href="manipulate-and-summarize-dataframes.html#cb289-2" tabindex="-1"></a>vars.group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb289-3"><a href="manipulate-and-summarize-dataframes.html#cb289-3" tabindex="-1"></a></span>
<span id="cb289-4"><a href="manipulate-and-summarize-dataframes.html#cb289-4" tabindex="-1"></a><span class="co"># dataset subsetting</span></span>
<span id="cb289-5"><a href="manipulate-and-summarize-dataframes.html#cb289-5" tabindex="-1"></a>df_use <span class="ot">&lt;-</span> df_hgt_wgt <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!!!</span><span class="fu">syms</span>(<span class="fu">c</span>(vars.group))) <span class="sc">%&gt;%</span></span>
<span id="cb289-6"><a href="manipulate-and-summarize-dataframes.html#cb289-6" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">hgt0 =</span> <span class="fu">round</span>(hgt0<span class="sc">/</span><span class="dv">5</span>)<span class="sc">*</span><span class="dv">5</span>, <span class="at">wgt0 =</span> <span class="fu">round</span>(wgt0<span class="sc">/</span><span class="dv">2000</span>)<span class="sc">*</span><span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-7"><a href="manipulate-and-summarize-dataframes.html#cb289-7" tabindex="-1"></a>            <span class="fu">drop_na</span>()</span>
<span id="cb289-8"><a href="manipulate-and-summarize-dataframes.html#cb289-8" tabindex="-1"></a></span>
<span id="cb289-9"><a href="manipulate-and-summarize-dataframes.html#cb289-9" tabindex="-1"></a><span class="co"># Group, count and generate means for each numeric variables</span></span>
<span id="cb289-10"><a href="manipulate-and-summarize-dataframes.html#cb289-10" tabindex="-1"></a><span class="co"># mutate_at(vars.group, funs(as.factor(.))) %&gt;%</span></span>
<span id="cb289-11"><a href="manipulate-and-summarize-dataframes.html#cb289-11" tabindex="-1"></a>df.group.count <span class="ot">&lt;-</span> df_use <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.group)) <span class="sc">%&gt;%</span></span>
<span id="cb289-12"><a href="manipulate-and-summarize-dataframes.html#cb289-12" tabindex="-1"></a>                    <span class="fu">arrange</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.group)) <span class="sc">%&gt;%</span></span>
<span id="cb289-13"><a href="manipulate-and-summarize-dataframes.html#cb289-13" tabindex="-1"></a>                    <span class="fu">summarise</span>(<span class="at">n_obs_group=</span><span class="fu">n</span>())</span>
<span id="cb289-14"><a href="manipulate-and-summarize-dataframes.html#cb289-14" tabindex="-1"></a></span>
<span id="cb289-15"><a href="manipulate-and-summarize-dataframes.html#cb289-15" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb289-16"><a href="manipulate-and-summarize-dataframes.html#cb289-16" tabindex="-1"></a>df.group.count <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n_obs_group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
122
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
4586
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
4000
</td>
<td style="text-align:right;">
470
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
9691
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
4000
</td>
<td style="text-align:right;">
13106
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
126
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
4000
</td>
<td style="text-align:right;">
1900
</td>
</tr>
<tr>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
6000
</td>
<td style="text-align:right;">
18
</td>
</tr>
</tbody>
</table>
</div>
<div id="aggrgate-groups-only-unique-group-show-up-with-means" class="section level4 hasAnchor" number="2.4.2.2">
<h4><span class="header-section-number">2.4.2.2</span> Aggrgate Groups only Unique Group Show up With Means<a href="manipulate-and-summarize-dataframes.html#aggrgate-groups-only-unique-group-show-up-with-means" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Several variables that are grouping identifiers. Several variables that are values which mean be unique for each group members. For example, a Panel of income for N households over T years with also household education information that is invariant over time. Want to generate a dataset where the unit of observation are households, rather than household years. Take average of all numeric variables that are household and year specific.</p>
<p>A complicating factor potentially is that the number of observations differ within group, for example, income might be observed for all years for some households but not for other households.</p>
<ul>
<li>r dplyr aggregate group average</li>
<li>Aggregating and analyzing data with dplyr</li>
<li>column can’t be modified because it is a grouping variable</li>
<li>see also: <a href="https://datacarpentry.org/dc_zurich/R-ecology/04-dplyr.html">Aggregating and analyzing data with dplyr</a></li>
</ul>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="manipulate-and-summarize-dataframes.html#cb290-1" tabindex="-1"></a><span class="co"># In the df_hgt_wgt from R4Econ, there is a country id, village id,</span></span>
<span id="cb290-2"><a href="manipulate-and-summarize-dataframes.html#cb290-2" tabindex="-1"></a><span class="co"># and individual id, and various other statistics</span></span>
<span id="cb290-3"><a href="manipulate-and-summarize-dataframes.html#cb290-3" tabindex="-1"></a>vars.group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;S.country&#39;</span>, <span class="st">&#39;vil.id&#39;</span>, <span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb290-4"><a href="manipulate-and-summarize-dataframes.html#cb290-4" tabindex="-1"></a>vars.values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>, <span class="st">&#39;momEdu&#39;</span>)</span>
<span id="cb290-5"><a href="manipulate-and-summarize-dataframes.html#cb290-5" tabindex="-1"></a></span>
<span id="cb290-6"><a href="manipulate-and-summarize-dataframes.html#cb290-6" tabindex="-1"></a><span class="co"># dataset subsetting</span></span>
<span id="cb290-7"><a href="manipulate-and-summarize-dataframes.html#cb290-7" tabindex="-1"></a>df_use <span class="ot">&lt;-</span> df_hgt_wgt <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!!!</span><span class="fu">syms</span>(<span class="fu">c</span>(vars.group, vars.values)))</span>
<span id="cb290-8"><a href="manipulate-and-summarize-dataframes.html#cb290-8" tabindex="-1"></a></span>
<span id="cb290-9"><a href="manipulate-and-summarize-dataframes.html#cb290-9" tabindex="-1"></a><span class="co"># Group, count and generate means for each numeric variables</span></span>
<span id="cb290-10"><a href="manipulate-and-summarize-dataframes.html#cb290-10" tabindex="-1"></a>df.group <span class="ot">&lt;-</span> df_use <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.group)) <span class="sc">%&gt;%</span></span>
<span id="cb290-11"><a href="manipulate-and-summarize-dataframes.html#cb290-11" tabindex="-1"></a>            <span class="fu">arrange</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.group)) <span class="sc">%&gt;%</span></span>
<span id="cb290-12"><a href="manipulate-and-summarize-dataframes.html#cb290-12" tabindex="-1"></a>            <span class="fu">summarise_if</span>(is.numeric,</span>
<span id="cb290-13"><a href="manipulate-and-summarize-dataframes.html#cb290-13" tabindex="-1"></a>                         <span class="fu">funs</span>(<span class="at">mean =</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb290-14"><a href="manipulate-and-summarize-dataframes.html#cb290-14" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb290-15"><a href="manipulate-and-summarize-dataframes.html#cb290-15" tabindex="-1"></a>                              <span class="at">n =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.)<span class="sc">==</span><span class="dv">0</span>)))</span>
<span id="cb290-16"><a href="manipulate-and-summarize-dataframes.html#cb290-16" tabindex="-1"></a></span>
<span id="cb290-17"><a href="manipulate-and-summarize-dataframes.html#cb290-17" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb290-18"><a href="manipulate-and-summarize-dataframes.html#cb290-18" tabindex="-1"></a>df.group <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb290-19"><a href="manipulate-and-summarize-dataframes.html#cb290-19" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb290-20"><a href="manipulate-and-summarize-dataframes.html#cb290-20" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
momEdu_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt_sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
momEdu_sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt_n
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
momEdu_n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
61.80000
</td>
<td style="text-align:right;">
5.3
</td>
<td style="text-align:right;">
9.520504
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
68.86154
</td>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
9.058931
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
80.45882
</td>
<td style="text-align:right;">
9.4
</td>
<td style="text-align:right;">
29.894231
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
88.10000
</td>
<td style="text-align:right;">
13.9
</td>
<td style="text-align:right;">
35.533166
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
97.70556
</td>
<td style="text-align:right;">
11.3
</td>
<td style="text-align:right;">
41.090366
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
87.49444
</td>
<td style="text-align:right;">
7.3
</td>
<td style="text-align:right;">
35.586439
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
90.79412
</td>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
38.722385
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
68.45385
</td>
<td style="text-align:right;">
13.5
</td>
<td style="text-align:right;">
10.011961
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
86.21111
</td>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
35.126057
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
87.67222
</td>
<td style="text-align:right;">
10.5
</td>
<td style="text-align:right;">
36.508127
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="manipulate-and-summarize-dataframes.html#cb291-1" tabindex="-1"></a><span class="co"># Show results Head 10</span></span>
<span id="cb291-2"><a href="manipulate-and-summarize-dataframes.html#cb291-2" tabindex="-1"></a>df.group <span class="sc">%&gt;%</span> <span class="fu">tail</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb291-3"><a href="manipulate-and-summarize-dataframes.html#cb291-3" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb291-4"><a href="manipulate-and-summarize-dataframes.html#cb291-4" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
momEdu_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt_sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
momEdu_sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt_n
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
momEdu_n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
66.97000
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
8.967974
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
71.71818
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
11.399984
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
66.33000
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
9.490352
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
76.40769
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
14.827871
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
74.55385
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
12.707846
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;">
70.47500
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
11.797390
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2020
</td>
<td style="text-align:right;">
60.28750
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
7.060036
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2021
</td>
<td style="text-align:right;">
84.96000
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
15.446193
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2022
</td>
<td style="text-align:right;">
79.38667
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
15.824749
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2023
</td>
<td style="text-align:right;">
66.50000
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
8.613113
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div id="one-variable-group-summary" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> One Variable Group Summary<a href="manipulate-and-summarize-dataframes.html#one-variable-group-summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>There is a categorical variable (based on one or the interaction of multiple variables), there is a continuous variable, obtain statistics for the continuous variable conditional on the categorical variable, but also unconditionally.</p>
<p>Store results in a matrix, but also flatten results wide to row with appropriate keys/variable-names for all group statistics.</p>
<p>Pick which statistics to be included in final wide row</p>
<div id="build-program" class="section level4 hasAnchor" number="2.4.3.1">
<h4><span class="header-section-number">2.4.3.1</span> Build Program<a href="manipulate-and-summarize-dataframes.html#build-program" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="manipulate-and-summarize-dataframes.html#cb292-1" tabindex="-1"></a><span class="co"># Single Variable Group Statistics (also generate overall statistics)</span></span>
<span id="cb292-2"><a href="manipulate-and-summarize-dataframes.html#cb292-2" tabindex="-1"></a>ff_summ_by_group_summ_one <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb292-3"><a href="manipulate-and-summarize-dataframes.html#cb292-3" tabindex="-1"></a>  df, vars.group, var.numeric, <span class="at">str.stats.group =</span> <span class="st">&#39;main&#39;</span>,</span>
<span id="cb292-4"><a href="manipulate-and-summarize-dataframes.html#cb292-4" tabindex="-1"></a>  <span class="at">str.stats.specify =</span> <span class="cn">NULL</span>, <span class="at">boo.overall.stats =</span> <span class="cn">TRUE</span>){</span>
<span id="cb292-5"><a href="manipulate-and-summarize-dataframes.html#cb292-5" tabindex="-1"></a>  </span>
<span id="cb292-6"><a href="manipulate-and-summarize-dataframes.html#cb292-6" tabindex="-1"></a>  <span class="co"># List of statistics</span></span>
<span id="cb292-7"><a href="manipulate-and-summarize-dataframes.html#cb292-7" tabindex="-1"></a>  <span class="co"># https://rdrr.io/cran/dplyr/man/summarise.html</span></span>
<span id="cb292-8"><a href="manipulate-and-summarize-dataframes.html#cb292-8" tabindex="-1"></a>  strs.center <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;median&#39;</span>)</span>
<span id="cb292-9"><a href="manipulate-and-summarize-dataframes.html#cb292-9" tabindex="-1"></a>  strs.spread <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sd&#39;</span>, <span class="st">&#39;IQR&#39;</span>, <span class="st">&#39;mad&#39;</span>)</span>
<span id="cb292-10"><a href="manipulate-and-summarize-dataframes.html#cb292-10" tabindex="-1"></a>  strs.range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;min&#39;</span>, <span class="st">&#39;max&#39;</span>)</span>
<span id="cb292-11"><a href="manipulate-and-summarize-dataframes.html#cb292-11" tabindex="-1"></a>  strs.pos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;first&#39;</span>, <span class="st">&#39;last&#39;</span>)</span>
<span id="cb292-12"><a href="manipulate-and-summarize-dataframes.html#cb292-12" tabindex="-1"></a>  strs.count <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n_distinct&#39;</span>)</span>
<span id="cb292-13"><a href="manipulate-and-summarize-dataframes.html#cb292-13" tabindex="-1"></a>  </span>
<span id="cb292-14"><a href="manipulate-and-summarize-dataframes.html#cb292-14" tabindex="-1"></a>  <span class="co"># Grouping of Statistics</span></span>
<span id="cb292-15"><a href="manipulate-and-summarize-dataframes.html#cb292-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(str.stats.specify)) {</span>
<span id="cb292-16"><a href="manipulate-and-summarize-dataframes.html#cb292-16" tabindex="-1"></a>    <span class="cf">if</span> (str.stats.group <span class="sc">==</span> <span class="st">&#39;main&#39;</span>) {</span>
<span id="cb292-17"><a href="manipulate-and-summarize-dataframes.html#cb292-17" tabindex="-1"></a>      strs.all <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;min&#39;</span>, <span class="st">&#39;max&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb292-18"><a href="manipulate-and-summarize-dataframes.html#cb292-18" tabindex="-1"></a>    }</span>
<span id="cb292-19"><a href="manipulate-and-summarize-dataframes.html#cb292-19" tabindex="-1"></a>    <span class="cf">if</span> (str.stats.group <span class="sc">==</span> <span class="st">&#39;all&#39;</span>) {</span>
<span id="cb292-20"><a href="manipulate-and-summarize-dataframes.html#cb292-20" tabindex="-1"></a>      strs.all <span class="ot">&lt;-</span> <span class="fu">c</span>(strs.center, strs.spread, strs.range, strs.pos, strs.count)</span>
<span id="cb292-21"><a href="manipulate-and-summarize-dataframes.html#cb292-21" tabindex="-1"></a>    }</span>
<span id="cb292-22"><a href="manipulate-and-summarize-dataframes.html#cb292-22" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb292-23"><a href="manipulate-and-summarize-dataframes.html#cb292-23" tabindex="-1"></a>    strs.all <span class="ot">&lt;-</span> str.stats.specify</span>
<span id="cb292-24"><a href="manipulate-and-summarize-dataframes.html#cb292-24" tabindex="-1"></a>  }</span>
<span id="cb292-25"><a href="manipulate-and-summarize-dataframes.html#cb292-25" tabindex="-1"></a>  </span>
<span id="cb292-26"><a href="manipulate-and-summarize-dataframes.html#cb292-26" tabindex="-1"></a>  <span class="co"># Start Transform</span></span>
<span id="cb292-27"><a href="manipulate-and-summarize-dataframes.html#cb292-27" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb292-28"><a href="manipulate-and-summarize-dataframes.html#cb292-28" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span>(var.numeric) <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="sc">!!</span><span class="fu">sym</span>(var.numeric)))</span>
<span id="cb292-29"><a href="manipulate-and-summarize-dataframes.html#cb292-29" tabindex="-1"></a>  </span>
<span id="cb292-30"><a href="manipulate-and-summarize-dataframes.html#cb292-30" tabindex="-1"></a>  <span class="co"># Overall Statistics</span></span>
<span id="cb292-31"><a href="manipulate-and-summarize-dataframes.html#cb292-31" tabindex="-1"></a>  <span class="cf">if</span> (boo.overall.stats) {</span>
<span id="cb292-32"><a href="manipulate-and-summarize-dataframes.html#cb292-32" tabindex="-1"></a>    df.overall.stats <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb292-33"><a href="manipulate-and-summarize-dataframes.html#cb292-33" tabindex="-1"></a>      <span class="fu">summarize_at</span>(<span class="fu">vars</span>(var.numeric), <span class="fu">funs</span>(<span class="sc">!!!</span>strs.all))</span>
<span id="cb292-34"><a href="manipulate-and-summarize-dataframes.html#cb292-34" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(strs.all) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb292-35"><a href="manipulate-and-summarize-dataframes.html#cb292-35" tabindex="-1"></a>      <span class="co"># give it a name, otherwise if only one stat, name of stat not saved</span></span>
<span id="cb292-36"><a href="manipulate-and-summarize-dataframes.html#cb292-36" tabindex="-1"></a>      df.overall.stats <span class="ot">&lt;-</span> df.overall.stats <span class="sc">%&gt;%</span> </span>
<span id="cb292-37"><a href="manipulate-and-summarize-dataframes.html#cb292-37" tabindex="-1"></a>        <span class="fu">rename</span>(<span class="sc">!!</span><span class="at">strs.all :=</span> <span class="sc">!!</span><span class="fu">sym</span>(var.numeric))</span>
<span id="cb292-38"><a href="manipulate-and-summarize-dataframes.html#cb292-38" tabindex="-1"></a>    }</span>
<span id="cb292-39"><a href="manipulate-and-summarize-dataframes.html#cb292-39" tabindex="-1"></a>    <span class="fu">names</span>(df.overall.stats) <span class="ot">&lt;-</span> </span>
<span id="cb292-40"><a href="manipulate-and-summarize-dataframes.html#cb292-40" tabindex="-1"></a>      <span class="fu">paste0</span>(var.numeric, <span class="st">&#39;.&#39;</span>, <span class="fu">names</span>(df.overall.stats))</span>
<span id="cb292-41"><a href="manipulate-and-summarize-dataframes.html#cb292-41" tabindex="-1"></a>  }</span>
<span id="cb292-42"><a href="manipulate-and-summarize-dataframes.html#cb292-42" tabindex="-1"></a>  </span>
<span id="cb292-43"><a href="manipulate-and-summarize-dataframes.html#cb292-43" tabindex="-1"></a>  <span class="co"># Group Sort</span></span>
<span id="cb292-44"><a href="manipulate-and-summarize-dataframes.html#cb292-44" tabindex="-1"></a>  df.select <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb292-45"><a href="manipulate-and-summarize-dataframes.html#cb292-45" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.group)) <span class="sc">%&gt;%</span></span>
<span id="cb292-46"><a href="manipulate-and-summarize-dataframes.html#cb292-46" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="sc">!!!</span><span class="fu">syms</span>(<span class="fu">c</span>(vars.group, var.numeric)))</span>
<span id="cb292-47"><a href="manipulate-and-summarize-dataframes.html#cb292-47" tabindex="-1"></a>  </span>
<span id="cb292-48"><a href="manipulate-and-summarize-dataframes.html#cb292-48" tabindex="-1"></a>  <span class="co"># Table of Statistics</span></span>
<span id="cb292-49"><a href="manipulate-and-summarize-dataframes.html#cb292-49" tabindex="-1"></a>  df.table.grp.stats <span class="ot">&lt;-</span> df.select <span class="sc">%&gt;%</span> </span>
<span id="cb292-50"><a href="manipulate-and-summarize-dataframes.html#cb292-50" tabindex="-1"></a>    <span class="fu">summarize_at</span>(<span class="fu">vars</span>(var.numeric), <span class="fu">funs</span>(<span class="sc">!!!</span>strs.all))</span>
<span id="cb292-51"><a href="manipulate-and-summarize-dataframes.html#cb292-51" tabindex="-1"></a>  </span>
<span id="cb292-52"><a href="manipulate-and-summarize-dataframes.html#cb292-52" tabindex="-1"></a>  <span class="co"># Add Stat Name</span></span>
<span id="cb292-53"><a href="manipulate-and-summarize-dataframes.html#cb292-53" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(strs.all) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb292-54"><a href="manipulate-and-summarize-dataframes.html#cb292-54" tabindex="-1"></a>    <span class="co"># give it a name, otherwise if only one stat, name of stat not saved</span></span>
<span id="cb292-55"><a href="manipulate-and-summarize-dataframes.html#cb292-55" tabindex="-1"></a>    df.table.grp.stats <span class="ot">&lt;-</span> df.table.grp.stats <span class="sc">%&gt;%</span> </span>
<span id="cb292-56"><a href="manipulate-and-summarize-dataframes.html#cb292-56" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="sc">!!</span><span class="at">strs.all :=</span> <span class="sc">!!</span><span class="fu">sym</span>(var.numeric))</span>
<span id="cb292-57"><a href="manipulate-and-summarize-dataframes.html#cb292-57" tabindex="-1"></a>  }</span>
<span id="cb292-58"><a href="manipulate-and-summarize-dataframes.html#cb292-58" tabindex="-1"></a>  </span>
<span id="cb292-59"><a href="manipulate-and-summarize-dataframes.html#cb292-59" tabindex="-1"></a>  </span>
<span id="cb292-60"><a href="manipulate-and-summarize-dataframes.html#cb292-60" tabindex="-1"></a>  <span class="co"># Row of Statistics</span></span>
<span id="cb292-61"><a href="manipulate-and-summarize-dataframes.html#cb292-61" tabindex="-1"></a>  str.vars.group.combine <span class="ot">&lt;-</span> <span class="fu">paste0</span>(vars.group, <span class="at">collapse=</span><span class="st">&#39;_&#39;</span>)</span>
<span id="cb292-62"><a href="manipulate-and-summarize-dataframes.html#cb292-62" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(vars.group) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb292-63"><a href="manipulate-and-summarize-dataframes.html#cb292-63" tabindex="-1"></a>    df.row.grp.stats <span class="ot">&lt;-</span> df.table.grp.stats <span class="sc">%&gt;%</span></span>
<span id="cb292-64"><a href="manipulate-and-summarize-dataframes.html#cb292-64" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="sc">!!</span>(str.vars.group.combine) <span class="sc">:=</span> </span>
<span id="cb292-65"><a href="manipulate-and-summarize-dataframes.html#cb292-65" tabindex="-1"></a>               <span class="fu">paste0</span>(var.numeric, <span class="st">&#39;.&#39;</span>,</span>
<span id="cb292-66"><a href="manipulate-and-summarize-dataframes.html#cb292-66" tabindex="-1"></a>                      vars.group, <span class="st">&#39;.g&#39;</span>,</span>
<span id="cb292-67"><a href="manipulate-and-summarize-dataframes.html#cb292-67" tabindex="-1"></a>                      (<span class="sc">!!!</span><span class="fu">syms</span>(vars.group)))) <span class="sc">%&gt;%</span></span>
<span id="cb292-68"><a href="manipulate-and-summarize-dataframes.html#cb292-68" tabindex="-1"></a>      <span class="fu">gather</span>(variable, value, <span class="sc">-</span><span class="fu">one_of</span>(vars.group)) <span class="sc">%&gt;%</span></span>
<span id="cb292-69"><a href="manipulate-and-summarize-dataframes.html#cb292-69" tabindex="-1"></a>      <span class="fu">unite</span>(str.vars.group.combine, <span class="fu">c</span>(str.vars.group.combine, <span class="st">&#39;variable&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb292-70"><a href="manipulate-and-summarize-dataframes.html#cb292-70" tabindex="-1"></a>      <span class="fu">spread</span>(str.vars.group.combine, value)</span>
<span id="cb292-71"><a href="manipulate-and-summarize-dataframes.html#cb292-71" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb292-72"><a href="manipulate-and-summarize-dataframes.html#cb292-72" tabindex="-1"></a>    df.row.grp.stats <span class="ot">&lt;-</span> df.table.grp.stats <span class="sc">%&gt;%</span> </span>
<span id="cb292-73"><a href="manipulate-and-summarize-dataframes.html#cb292-73" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">vars.groups.combine :=</span> </span>
<span id="cb292-74"><a href="manipulate-and-summarize-dataframes.html#cb292-74" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="fu">paste0</span>(vars.group, <span class="at">collapse=</span><span class="st">&#39;.&#39;</span>)),</span>
<span id="cb292-75"><a href="manipulate-and-summarize-dataframes.html#cb292-75" tabindex="-1"></a>             <span class="sc">!!</span>(str.vars.group.combine) <span class="sc">:=</span> </span>
<span id="cb292-76"><a href="manipulate-and-summarize-dataframes.html#cb292-76" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="fu">interaction</span>(<span class="sc">!!!</span>(<span class="fu">syms</span>(vars.group))))) <span class="sc">%&gt;%</span></span>
<span id="cb292-77"><a href="manipulate-and-summarize-dataframes.html#cb292-77" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="sc">!!</span>(str.vars.group.combine) <span class="sc">:=</span> </span>
<span id="cb292-78"><a href="manipulate-and-summarize-dataframes.html#cb292-78" tabindex="-1"></a>               <span class="fu">paste0</span>(var.numeric, <span class="st">&#39;.&#39;</span>, vars.groups.combine, <span class="st">&#39;.&#39;</span>,</span>
<span id="cb292-79"><a href="manipulate-and-summarize-dataframes.html#cb292-79" tabindex="-1"></a>                      (<span class="sc">!!</span><span class="fu">sym</span>(str.vars.group.combine)))) <span class="sc">%&gt;%</span></span>
<span id="cb292-80"><a href="manipulate-and-summarize-dataframes.html#cb292-80" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb292-81"><a href="manipulate-and-summarize-dataframes.html#cb292-81" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>vars.groups.combine, <span class="sc">-</span><span class="fu">one_of</span>(vars.group)) <span class="sc">%&gt;%</span></span>
<span id="cb292-82"><a href="manipulate-and-summarize-dataframes.html#cb292-82" tabindex="-1"></a>      <span class="fu">gather</span>(variable, value, <span class="sc">-</span><span class="fu">one_of</span>(str.vars.group.combine)) <span class="sc">%&gt;%</span></span>
<span id="cb292-83"><a href="manipulate-and-summarize-dataframes.html#cb292-83" tabindex="-1"></a>      <span class="fu">unite</span>(str.vars.group.combine, <span class="fu">c</span>(str.vars.group.combine, <span class="st">&#39;variable&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb292-84"><a href="manipulate-and-summarize-dataframes.html#cb292-84" tabindex="-1"></a>      <span class="fu">spread</span>(str.vars.group.combine, value)</span>
<span id="cb292-85"><a href="manipulate-and-summarize-dataframes.html#cb292-85" tabindex="-1"></a>  }</span>
<span id="cb292-86"><a href="manipulate-and-summarize-dataframes.html#cb292-86" tabindex="-1"></a>  </span>
<span id="cb292-87"><a href="manipulate-and-summarize-dataframes.html#cb292-87" tabindex="-1"></a>  <span class="co"># Clean up name strings</span></span>
<span id="cb292-88"><a href="manipulate-and-summarize-dataframes.html#cb292-88" tabindex="-1"></a>  <span class="fu">names</span>(df.table.grp.stats) <span class="ot">&lt;-</span> </span>
<span id="cb292-89"><a href="manipulate-and-summarize-dataframes.html#cb292-89" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="at">x =</span> <span class="fu">names</span>(df.table.grp.stats),<span class="at">pattern =</span> <span class="st">&quot;_&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span>
<span id="cb292-90"><a href="manipulate-and-summarize-dataframes.html#cb292-90" tabindex="-1"></a>  <span class="fu">names</span>(df.row.grp.stats) <span class="ot">&lt;-</span> </span>
<span id="cb292-91"><a href="manipulate-and-summarize-dataframes.html#cb292-91" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="at">x =</span> <span class="fu">names</span>(df.row.grp.stats),<span class="at">pattern =</span> <span class="st">&quot;_&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span>
<span id="cb292-92"><a href="manipulate-and-summarize-dataframes.html#cb292-92" tabindex="-1"></a>  </span>
<span id="cb292-93"><a href="manipulate-and-summarize-dataframes.html#cb292-93" tabindex="-1"></a>  <span class="co"># Return</span></span>
<span id="cb292-94"><a href="manipulate-and-summarize-dataframes.html#cb292-94" tabindex="-1"></a>  list.return <span class="ot">&lt;-</span> </span>
<span id="cb292-95"><a href="manipulate-and-summarize-dataframes.html#cb292-95" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">df_table_grp_stats =</span> df.table.grp.stats, </span>
<span id="cb292-96"><a href="manipulate-and-summarize-dataframes.html#cb292-96" tabindex="-1"></a>         <span class="at">df_row_grp_stats =</span> df.row.grp.stats)</span>
<span id="cb292-97"><a href="manipulate-and-summarize-dataframes.html#cb292-97" tabindex="-1"></a>  </span>
<span id="cb292-98"><a href="manipulate-and-summarize-dataframes.html#cb292-98" tabindex="-1"></a>  <span class="co"># Overall Statistics, without grouping</span></span>
<span id="cb292-99"><a href="manipulate-and-summarize-dataframes.html#cb292-99" tabindex="-1"></a>  <span class="cf">if</span> (boo.overall.stats) {</span>
<span id="cb292-100"><a href="manipulate-and-summarize-dataframes.html#cb292-100" tabindex="-1"></a>    df.row.stats.all <span class="ot">&lt;-</span> <span class="fu">c</span>(df.row.grp.stats, df.overall.stats)</span>
<span id="cb292-101"><a href="manipulate-and-summarize-dataframes.html#cb292-101" tabindex="-1"></a>    list.return <span class="ot">&lt;-</span> <span class="fu">append</span>(list.return, </span>
<span id="cb292-102"><a href="manipulate-and-summarize-dataframes.html#cb292-102" tabindex="-1"></a>                          <span class="fu">list</span>(<span class="at">df_overall_stats =</span> df.overall.stats,</span>
<span id="cb292-103"><a href="manipulate-and-summarize-dataframes.html#cb292-103" tabindex="-1"></a>                               <span class="at">df_row_stats_all =</span> df.row.stats.all))</span>
<span id="cb292-104"><a href="manipulate-and-summarize-dataframes.html#cb292-104" tabindex="-1"></a>  }</span>
<span id="cb292-105"><a href="manipulate-and-summarize-dataframes.html#cb292-105" tabindex="-1"></a>  </span>
<span id="cb292-106"><a href="manipulate-and-summarize-dataframes.html#cb292-106" tabindex="-1"></a>  <span class="co"># Return</span></span>
<span id="cb292-107"><a href="manipulate-and-summarize-dataframes.html#cb292-107" tabindex="-1"></a>  <span class="fu">return</span>(list.return)</span>
<span id="cb292-108"><a href="manipulate-and-summarize-dataframes.html#cb292-108" tabindex="-1"></a>  </span>
<span id="cb292-109"><a href="manipulate-and-summarize-dataframes.html#cb292-109" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="test" class="section level4 hasAnchor" number="2.4.3.2">
<h4><span class="header-section-number">2.4.3.2</span> Test<a href="manipulate-and-summarize-dataframes.html#test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Load data and test</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="manipulate-and-summarize-dataframes.html#cb293-1" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb293-2"><a href="manipulate-and-summarize-dataframes.html#cb293-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb293-3"><a href="manipulate-and-summarize-dataframes.html#cb293-3" tabindex="-1"></a></span>
<span id="cb293-4"><a href="manipulate-and-summarize-dataframes.html#cb293-4" tabindex="-1"></a><span class="co"># Load Sample Data</span></span>
<span id="cb293-5"><a href="manipulate-and-summarize-dataframes.html#cb293-5" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb293-6"><a href="manipulate-and-summarize-dataframes.html#cb293-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span></code></pre></div>
<div id="function-testing-by-gender-groups" class="section level5 hasAnchor" number="2.4.3.2.1">
<h5><span class="header-section-number">2.4.3.2.1</span> Function Testing By Gender Groups<a href="manipulate-and-summarize-dataframes.html#function-testing-by-gender-groups" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Need two variables, a group variable that is a factor, and a numeric</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="manipulate-and-summarize-dataframes.html#cb294-1" tabindex="-1"></a>vars.group <span class="ot">&lt;-</span> <span class="st">&#39;sex&#39;</span></span>
<span id="cb294-2"><a href="manipulate-and-summarize-dataframes.html#cb294-2" tabindex="-1"></a>var.numeric <span class="ot">&lt;-</span> <span class="st">&#39;hgt&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="manipulate-and-summarize-dataframes.html#cb295-1" tabindex="-1"></a>df.select <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">one_of</span>(vars.group, var.numeric)) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code></pre></div>
<p>Main Statistics:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="manipulate-and-summarize-dataframes.html#cb296-1" tabindex="-1"></a><span class="co"># Single Variable Group Statistics</span></span>
<span id="cb296-2"><a href="manipulate-and-summarize-dataframes.html#cb296-2" tabindex="-1"></a><span class="fu">ff_summ_by_group_summ_one</span>(</span>
<span id="cb296-3"><a href="manipulate-and-summarize-dataframes.html#cb296-3" tabindex="-1"></a>  df.select, <span class="at">vars.group =</span> vars.group, <span class="at">var.numeric =</span> var.numeric, </span>
<span id="cb296-4"><a href="manipulate-and-summarize-dataframes.html#cb296-4" tabindex="-1"></a>  <span class="at">str.stats.group =</span> <span class="st">&#39;main&#39;</span>)<span class="sc">$</span>df_table_grp_stats</span></code></pre></div>
<p>Specify Two Specific Statistics:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="manipulate-and-summarize-dataframes.html#cb297-1" tabindex="-1"></a><span class="fu">ff_summ_by_group_summ_one</span>(</span>
<span id="cb297-2"><a href="manipulate-and-summarize-dataframes.html#cb297-2" tabindex="-1"></a>  df.select, <span class="at">vars.group =</span> vars.group, <span class="at">var.numeric =</span> var.numeric, </span>
<span id="cb297-3"><a href="manipulate-and-summarize-dataframes.html#cb297-3" tabindex="-1"></a>  <span class="at">str.stats.specify =</span> <span class="fu">c</span>(<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>))<span class="sc">$</span>df_table_grp_stats</span></code></pre></div>
<p>Specify One Specific Statistics:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="manipulate-and-summarize-dataframes.html#cb298-1" tabindex="-1"></a><span class="fu">ff_summ_by_group_summ_one</span>(</span>
<span id="cb298-2"><a href="manipulate-and-summarize-dataframes.html#cb298-2" tabindex="-1"></a>  df.select, <span class="at">vars.group =</span> vars.group, <span class="at">var.numeric =</span> var.numeric, </span>
<span id="cb298-3"><a href="manipulate-and-summarize-dataframes.html#cb298-3" tabindex="-1"></a>  <span class="at">str.stats.specify =</span> <span class="fu">c</span>(<span class="st">&#39;mean&#39;</span>))<span class="sc">$</span>df_table_grp_stats</span></code></pre></div>
</div>
<div id="function-testing-by-country-and-gender-groups" class="section level5 hasAnchor" number="2.4.3.2.2">
<h5><span class="header-section-number">2.4.3.2.2</span> Function Testing By Country and Gender Groups<a href="manipulate-and-summarize-dataframes.html#function-testing-by-country-and-gender-groups" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Need two variables, a group variable that is a factor, and a numeric. Now joint grouping variables.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="manipulate-and-summarize-dataframes.html#cb299-1" tabindex="-1"></a>vars.group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;S.country&#39;</span>, <span class="st">&#39;sex&#39;</span>)</span>
<span id="cb299-2"><a href="manipulate-and-summarize-dataframes.html#cb299-2" tabindex="-1"></a>var.numeric <span class="ot">&lt;-</span> <span class="st">&#39;hgt&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="manipulate-and-summarize-dataframes.html#cb300-1" tabindex="-1"></a>df.select <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">one_of</span>(vars.group, var.numeric)) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code></pre></div>
<p>Main Statistics:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="manipulate-and-summarize-dataframes.html#cb301-1" tabindex="-1"></a><span class="fu">ff_summ_by_group_summ_one</span>(</span>
<span id="cb301-2"><a href="manipulate-and-summarize-dataframes.html#cb301-2" tabindex="-1"></a>  df.select, <span class="at">vars.group =</span> vars.group, <span class="at">var.numeric =</span> var.numeric, </span>
<span id="cb301-3"><a href="manipulate-and-summarize-dataframes.html#cb301-3" tabindex="-1"></a>  <span class="at">str.stats.group =</span> <span class="st">&#39;main&#39;</span>)<span class="sc">$</span>df_table_grp_stats</span></code></pre></div>
<p>Specify Two Specific Statistics:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="manipulate-and-summarize-dataframes.html#cb302-1" tabindex="-1"></a><span class="fu">ff_summ_by_group_summ_one</span>(</span>
<span id="cb302-2"><a href="manipulate-and-summarize-dataframes.html#cb302-2" tabindex="-1"></a>  df.select, <span class="at">vars.group =</span> vars.group, <span class="at">var.numeric =</span> var.numeric, </span>
<span id="cb302-3"><a href="manipulate-and-summarize-dataframes.html#cb302-3" tabindex="-1"></a>  <span class="at">str.stats.specify =</span> <span class="fu">c</span>(<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>))<span class="sc">$</span>df_table_grp_stats</span></code></pre></div>
<p>Specify One Specific Statistics:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="manipulate-and-summarize-dataframes.html#cb303-1" tabindex="-1"></a><span class="fu">ff_summ_by_group_summ_one</span>(</span>
<span id="cb303-2"><a href="manipulate-and-summarize-dataframes.html#cb303-2" tabindex="-1"></a>  df.select, <span class="at">vars.group =</span> vars.group, <span class="at">var.numeric =</span> var.numeric, </span>
<span id="cb303-3"><a href="manipulate-and-summarize-dataframes.html#cb303-3" tabindex="-1"></a>  <span class="at">str.stats.specify =</span> <span class="fu">c</span>(<span class="st">&#39;mean&#39;</span>))<span class="sc">$</span>df_table_grp_stats</span></code></pre></div>

</div>
</div>
</div>
<div id="nested-within-group-stats" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Nested within Group Stats<a href="manipulate-and-summarize-dataframes.html#nested-within-group-stats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>By Multiple within Individual Groups Variables, Averages for All Numeric Variables within All Groups of All Group Variables (Long to very Wide). Suppose you have an individual level final outcome. The individual is observed for N periods, where each period the inputs differ. What inputs impacted the final outcome?</p>
<p>Suppose we can divide N periods in which the individual is in the data into a number of years, a number of semi-years, a number of quarters, or uneven-staggered lengths. We might want to generate averages across individuals and within each of these different possible groups averages of inputs.</p>
<p>Then we want to version of the data where each row is an individual, one of the variables is the final outcome, and the other variables are these different averages: averages for the 1st, 2nd, 3rd year in which indivdiual is in data, averages for 1st, …, final quarter in which indivdiual is in data.</p>
<div id="build-function" class="section level4 hasAnchor" number="2.4.4.1">
<h4><span class="header-section-number">2.4.4.1</span> Build Function<a href="manipulate-and-summarize-dataframes.html#build-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function takes as inputs:</p>
<ol style="list-style-type: decimal">
<li><strong>vars.not.groups2avg</strong>: a list of variables that are not the within-indivdiual or across-individual grouping variables, but the variables we want to average over. Withnin indivdiual grouping averages will be calculated for these variables using the not-listed variables as within indivdiual groups (excluding vars.indi.grp groups).</li>
<li><strong>vars.indi.grp</strong>: a list or individual variables, and also perhaps villages, province, etc id variables that are higher than individual ID. Note the groups are are ACROSS individual higher level group variables.</li>
<li>the remaining variables are all within individual grouping variables.</li>
</ol>
<p>the function output is a dataframe:</p>
<ol style="list-style-type: decimal">
<li>each row is an individual</li>
<li>initial variables individual ID and across individual groups from <em>vars.indi.grp</em>.</li>
<li>other variables are all averages for the variables in <em>vars.not.groups2avg</em>
<ul>
<li>if there are 2 within individual group variables, and the first has 3 groups (years), the second has 6 groups (semi-years), then there would be 9 average variables.</li>
<li>each average variables has the original variable name from vars.not.groups2avg plus the name of the within individual grouping variable, and at the end ‘c_x’, where x is a integer representing the category within the group (if 3 years, x=1, 2, 3)</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="manipulate-and-summarize-dataframes.html#cb304-1" tabindex="-1"></a><span class="co"># Data Function</span></span>
<span id="cb304-2"><a href="manipulate-and-summarize-dataframes.html#cb304-2" tabindex="-1"></a><span class="co"># https://fanwangecon.github.io/R4Econ/summarize/summ/ByGroupsSummWide.html</span></span>
<span id="cb304-3"><a href="manipulate-and-summarize-dataframes.html#cb304-3" tabindex="-1"></a>f.by.groups.summ.wide <span class="ot">&lt;-</span> <span class="cf">function</span>(df.groups.to.average,</span>
<span id="cb304-4"><a href="manipulate-and-summarize-dataframes.html#cb304-4" tabindex="-1"></a>                                  vars.not.groups2avg,</span>
<span id="cb304-5"><a href="manipulate-and-summarize-dataframes.html#cb304-5" tabindex="-1"></a>                                  <span class="at">vars.indi.grp =</span> <span class="fu">c</span>(<span class="st">&#39;S.country&#39;</span>,<span class="st">&#39;ID&#39;</span>),</span>
<span id="cb304-6"><a href="manipulate-and-summarize-dataframes.html#cb304-6" tabindex="-1"></a>                                  <span class="at">display=</span><span class="cn">TRUE</span>) {</span>
<span id="cb304-7"><a href="manipulate-and-summarize-dataframes.html#cb304-7" tabindex="-1"></a></span>
<span id="cb304-8"><a href="manipulate-and-summarize-dataframes.html#cb304-8" tabindex="-1"></a><span class="co"># 1. generate categoricals for full year (m.12), half year (m.6), quarter year (m.4)</span></span>
<span id="cb304-9"><a href="manipulate-and-summarize-dataframes.html#cb304-9" tabindex="-1"></a><span class="co"># 2. generate categoricals also for uneven years (m12t14) using </span></span>
<span id="cb304-10"><a href="manipulate-and-summarize-dataframes.html#cb304-10" tabindex="-1"></a><span class="co">#  stagger (+2 rather than -1)</span></span>
<span id="cb304-11"><a href="manipulate-and-summarize-dataframes.html#cb304-11" tabindex="-1"></a><span class="co"># 3. reshape wide to long, so that all categorical date groups appear in var=value,</span></span>
<span id="cb304-12"><a href="manipulate-and-summarize-dataframes.html#cb304-12" tabindex="-1"></a>    <span class="co"># and categories in var=variable</span></span>
<span id="cb304-13"><a href="manipulate-and-summarize-dataframes.html#cb304-13" tabindex="-1"></a><span class="co"># 4. calculate mean for all numeric variables for all date groups</span></span>
<span id="cb304-14"><a href="manipulate-and-summarize-dataframes.html#cb304-14" tabindex="-1"></a><span class="co"># 5. combine date categorical variable and value, single var:</span></span>
<span id="cb304-15"><a href="manipulate-and-summarize-dataframes.html#cb304-15" tabindex="-1"></a>    <span class="co"># m.12.c1= first year average from m.12 averaging</span></span>
<span id="cb304-16"><a href="manipulate-and-summarize-dataframes.html#cb304-16" tabindex="-1"></a></span>
<span id="cb304-17"><a href="manipulate-and-summarize-dataframes.html#cb304-17" tabindex="-1"></a><span class="do">######## ######## ######## ######## #######</span></span>
<span id="cb304-18"><a href="manipulate-and-summarize-dataframes.html#cb304-18" tabindex="-1"></a><span class="co"># Step 1</span></span>
<span id="cb304-19"><a href="manipulate-and-summarize-dataframes.html#cb304-19" tabindex="-1"></a><span class="do">######## ######## ######## ######## #######</span></span>
<span id="cb304-20"><a href="manipulate-and-summarize-dataframes.html#cb304-20" tabindex="-1"></a><span class="co"># 1. generate categoricals for full year (m.12), half year (m.6), quarter year (m.4)</span></span>
<span id="cb304-21"><a href="manipulate-and-summarize-dataframes.html#cb304-21" tabindex="-1"></a><span class="co"># 2. generate categoricals also for uneven years (m12t14) using stagger </span></span>
<span id="cb304-22"><a href="manipulate-and-summarize-dataframes.html#cb304-22" tabindex="-1"></a><span class="co">#  (+2 rather than -1)</span></span>
<span id="cb304-23"><a href="manipulate-and-summarize-dataframes.html#cb304-23" tabindex="-1"></a></span>
<span id="cb304-24"><a href="manipulate-and-summarize-dataframes.html#cb304-24" tabindex="-1"></a><span class="do">######## ######## ######## ######## #######</span></span>
<span id="cb304-25"><a href="manipulate-and-summarize-dataframes.html#cb304-25" tabindex="-1"></a><span class="co"># S2: reshape wide to long, so that all categorical date groups appear in var=value,</span></span>
<span id="cb304-26"><a href="manipulate-and-summarize-dataframes.html#cb304-26" tabindex="-1"></a><span class="co"># and categories in var=variable; calculate mean for all </span></span>
<span id="cb304-27"><a href="manipulate-and-summarize-dataframes.html#cb304-27" tabindex="-1"></a><span class="co"># numeric variables for all date groups</span></span>
<span id="cb304-28"><a href="manipulate-and-summarize-dataframes.html#cb304-28" tabindex="-1"></a><span class="do">######## ######## ######## ######## #######</span></span>
<span id="cb304-29"><a href="manipulate-and-summarize-dataframes.html#cb304-29" tabindex="-1"></a>df.avg.long <span class="ot">&lt;-</span> df.groups.to.average <span class="sc">%&gt;%</span></span>
<span id="cb304-30"><a href="manipulate-and-summarize-dataframes.html#cb304-30" tabindex="-1"></a>       <span class="fu">gather</span>(variable, value, <span class="sc">-</span><span class="fu">one_of</span>(<span class="fu">c</span>(vars.indi.grp,</span>
<span id="cb304-31"><a href="manipulate-and-summarize-dataframes.html#cb304-31" tabindex="-1"></a>                                         vars.not.groups2avg))) <span class="sc">%&gt;%</span></span>
<span id="cb304-32"><a href="manipulate-and-summarize-dataframes.html#cb304-32" tabindex="-1"></a>       <span class="fu">group_by</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.indi.grp), variable, value) <span class="sc">%&gt;%</span></span>
<span id="cb304-33"><a href="manipulate-and-summarize-dataframes.html#cb304-33" tabindex="-1"></a>       <span class="fu">summarise_if</span>(is.numeric, <span class="fu">funs</span>(<span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb304-34"><a href="manipulate-and-summarize-dataframes.html#cb304-34" tabindex="-1"></a></span>
<span id="cb304-35"><a href="manipulate-and-summarize-dataframes.html#cb304-35" tabindex="-1"></a><span class="cf">if</span> (display){</span>
<span id="cb304-36"><a href="manipulate-and-summarize-dataframes.html#cb304-36" tabindex="-1"></a>  <span class="fu">dim</span>(df.avg.long)</span>
<span id="cb304-37"><a href="manipulate-and-summarize-dataframes.html#cb304-37" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">repr.matrix.max.rows=</span><span class="dv">10</span>, <span class="at">repr.matrix.max.cols=</span><span class="dv">20</span>)</span>
<span id="cb304-38"><a href="manipulate-and-summarize-dataframes.html#cb304-38" tabindex="-1"></a>  <span class="fu">print</span>(df.avg.long)</span>
<span id="cb304-39"><a href="manipulate-and-summarize-dataframes.html#cb304-39" tabindex="-1"></a>}</span>
<span id="cb304-40"><a href="manipulate-and-summarize-dataframes.html#cb304-40" tabindex="-1"></a></span>
<span id="cb304-41"><a href="manipulate-and-summarize-dataframes.html#cb304-41" tabindex="-1"></a><span class="do">######## ######## ######## ######## #######</span></span>
<span id="cb304-42"><a href="manipulate-and-summarize-dataframes.html#cb304-42" tabindex="-1"></a><span class="co"># S3 combine date categorical variable and value, single var:</span></span>
<span id="cb304-43"><a href="manipulate-and-summarize-dataframes.html#cb304-43" tabindex="-1"></a><span class="co"># m.12.c1= first year average from m.12 averaging; to do this make </span></span>
<span id="cb304-44"><a href="manipulate-and-summarize-dataframes.html#cb304-44" tabindex="-1"></a><span class="co"># data even longer first</span></span>
<span id="cb304-45"><a href="manipulate-and-summarize-dataframes.html#cb304-45" tabindex="-1"></a><span class="do">######## ######## ######## ######## #######</span></span>
<span id="cb304-46"><a href="manipulate-and-summarize-dataframes.html#cb304-46" tabindex="-1"></a></span>
<span id="cb304-47"><a href="manipulate-and-summarize-dataframes.html#cb304-47" tabindex="-1"></a><span class="co"># We already have the averages, but we want them to show up as variables,</span></span>
<span id="cb304-48"><a href="manipulate-and-summarize-dataframes.html#cb304-48" tabindex="-1"></a>    <span class="co"># mean for each group of each variable.</span></span>
<span id="cb304-49"><a href="manipulate-and-summarize-dataframes.html#cb304-49" tabindex="-1"></a>df.avg.allvars.wide <span class="ot">&lt;-</span> df.avg.long <span class="sc">%&gt;%</span></span>
<span id="cb304-50"><a href="manipulate-and-summarize-dataframes.html#cb304-50" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb304-51"><a href="manipulate-and-summarize-dataframes.html#cb304-51" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">all_m_cate =</span> <span class="fu">paste0</span>(variable, <span class="st">&#39;_c&#39;</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb304-52"><a href="manipulate-and-summarize-dataframes.html#cb304-52" tabindex="-1"></a>   <span class="fu">select</span>(all_m_cate, <span class="fu">everything</span>(), <span class="sc">-</span>variable, <span class="sc">-</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb304-53"><a href="manipulate-and-summarize-dataframes.html#cb304-53" tabindex="-1"></a>   <span class="fu">gather</span>(variable, value, <span class="sc">-</span><span class="fu">one_of</span>(vars.indi.grp), <span class="sc">-</span>all_m_cate) <span class="sc">%&gt;%</span></span>
<span id="cb304-54"><a href="manipulate-and-summarize-dataframes.html#cb304-54" tabindex="-1"></a>   <span class="fu">unite</span>(<span class="st">&#39;var_mcate&#39;</span>, variable, all_m_cate) <span class="sc">%&gt;%</span></span>
<span id="cb304-55"><a href="manipulate-and-summarize-dataframes.html#cb304-55" tabindex="-1"></a>   <span class="fu">spread</span>(var_mcate, value)</span>
<span id="cb304-56"><a href="manipulate-and-summarize-dataframes.html#cb304-56" tabindex="-1"></a></span>
<span id="cb304-57"><a href="manipulate-and-summarize-dataframes.html#cb304-57" tabindex="-1"></a><span class="cf">if</span> (display){</span>
<span id="cb304-58"><a href="manipulate-and-summarize-dataframes.html#cb304-58" tabindex="-1"></a>  <span class="fu">dim</span>(df.avg.allvars.wide)</span>
<span id="cb304-59"><a href="manipulate-and-summarize-dataframes.html#cb304-59" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">repr.matrix.max.rows=</span><span class="dv">10</span>, <span class="at">repr.matrix.max.cols=</span><span class="dv">10</span>)</span>
<span id="cb304-60"><a href="manipulate-and-summarize-dataframes.html#cb304-60" tabindex="-1"></a>  <span class="fu">print</span>(df.avg.allvars.wide)</span>
<span id="cb304-61"><a href="manipulate-and-summarize-dataframes.html#cb304-61" tabindex="-1"></a>}</span>
<span id="cb304-62"><a href="manipulate-and-summarize-dataframes.html#cb304-62" tabindex="-1"></a></span>
<span id="cb304-63"><a href="manipulate-and-summarize-dataframes.html#cb304-63" tabindex="-1"></a><span class="fu">return</span>(df.avg.allvars.wide)</span>
<span id="cb304-64"><a href="manipulate-and-summarize-dataframes.html#cb304-64" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="test-program" class="section level4 hasAnchor" number="2.4.4.2">
<h4><span class="header-section-number">2.4.4.2</span> Test Program<a href="manipulate-and-summarize-dataframes.html#test-program" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In our sample dataset, the number of nutrition/height/income etc information observed within each country and month of age group are different. We have a panel dataset for children observed over different months of age.</p>
<p>We have two key grouping variables:
1. country: data are observed for guatemala and cebu
2. month-age (survey month round=svymthRound): different months of age at which each individual child is observed</p>
<p>A child could be observed for many months, or just a few months. A child’s height information could be observed for more months-of-age than nutritional intake information. We eventually want to run regressions where the outcome is height/weight and the input is nutrition. The regressions will be at the month-of-age level. We need to know how many times different variables are observed at the month-of-age level.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="manipulate-and-summarize-dataframes.html#cb305-1" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb305-2"><a href="manipulate-and-summarize-dataframes.html#cb305-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb305-3"><a href="manipulate-and-summarize-dataframes.html#cb305-3" tabindex="-1"></a></span>
<span id="cb305-4"><a href="manipulate-and-summarize-dataframes.html#cb305-4" tabindex="-1"></a><span class="co"># Load Sample Data</span></span>
<span id="cb305-5"><a href="manipulate-and-summarize-dataframes.html#cb305-5" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb305-6"><a href="manipulate-and-summarize-dataframes.html#cb305-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span></code></pre></div>
<div id="generate-within-individual-groups" class="section level5 hasAnchor" number="2.4.4.2.1">
<h5><span class="header-section-number">2.4.4.2.1</span> Generate Within Individual Groups<a href="manipulate-and-summarize-dataframes.html#generate-within-individual-groups" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In the data, children are observed for different number of months since birth. We want to calculate quarterly, semi-year, annual, etc average nutritional intakes. First generate these within-individual grouping variables. We can also generate uneven-staggered calendar groups as shown below.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="manipulate-and-summarize-dataframes.html#cb306-1" tabindex="-1"></a>mth.var <span class="ot">&lt;-</span> <span class="st">&#39;svymthRound&#39;</span></span>
<span id="cb306-2"><a href="manipulate-and-summarize-dataframes.html#cb306-2" tabindex="-1"></a>df.groups.to.average<span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb306-3"><a href="manipulate-and-summarize-dataframes.html#cb306-3" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="sc">!!</span><span class="fu">sym</span>(mth.var) <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(mth.var) <span class="sc">&lt;=</span> <span class="dv">24</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb306-4"><a href="manipulate-and-summarize-dataframes.html#cb306-4" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">m12t24=</span>(<span class="fu">floor</span>((<span class="sc">!!</span><span class="fu">sym</span>(mth.var) <span class="sc">-</span> <span class="dv">12</span>) <span class="sc">%/%</span> <span class="dv">14</span>) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb306-5"><a href="manipulate-and-summarize-dataframes.html#cb306-5" tabindex="-1"></a>               <span class="at">m8t24=</span>(<span class="fu">floor</span>((<span class="sc">!!</span><span class="fu">sym</span>(mth.var) <span class="sc">-</span> <span class="dv">8</span>) <span class="sc">%/%</span> <span class="dv">18</span>) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb306-6"><a href="manipulate-and-summarize-dataframes.html#cb306-6" tabindex="-1"></a>               <span class="at">m12 =</span> <span class="fu">pmax</span>((<span class="fu">floor</span>((<span class="sc">!!</span><span class="fu">sym</span>(mth.var)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%/%</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="dv">1</span>), <span class="dv">1</span>),</span>
<span id="cb306-7"><a href="manipulate-and-summarize-dataframes.html#cb306-7" tabindex="-1"></a>               <span class="at">m6 =</span> <span class="fu">pmax</span>((<span class="fu">floor</span>((<span class="sc">!!</span><span class="fu">sym</span>(mth.var)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%/%</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="dv">1</span>), <span class="dv">1</span>),</span>
<span id="cb306-8"><a href="manipulate-and-summarize-dataframes.html#cb306-8" tabindex="-1"></a>               <span class="at">m3 =</span> <span class="fu">pmax</span>((<span class="fu">floor</span>((<span class="sc">!!</span><span class="fu">sym</span>(mth.var)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%/%</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="dv">1</span>), <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="manipulate-and-summarize-dataframes.html#cb307-1" tabindex="-1"></a><span class="co"># Show Results</span></span>
<span id="cb307-2"><a href="manipulate-and-summarize-dataframes.html#cb307-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.matrix.max.rows=</span><span class="dv">30</span>, <span class="at">repr.matrix.max.cols=</span><span class="dv">20</span>)</span>
<span id="cb307-3"><a href="manipulate-and-summarize-dataframes.html#cb307-3" tabindex="-1"></a>vars.arrange <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;S.country&#39;</span>,<span class="st">&#39;indi.id&#39;</span>,<span class="st">&#39;svymthRound&#39;</span>)</span>
<span id="cb307-4"><a href="manipulate-and-summarize-dataframes.html#cb307-4" tabindex="-1"></a>vars.groups.within.indi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;m12t24&#39;</span>, <span class="st">&#39;m8t24&#39;</span>, <span class="st">&#39;m12&#39;</span>, <span class="st">&#39;m6&#39;</span>, <span class="st">&#39;m3&#39;</span>)</span>
<span id="cb307-5"><a href="manipulate-and-summarize-dataframes.html#cb307-5" tabindex="-1"></a><span class="fu">as.tibble</span>(df.groups.to.average <span class="sc">%&gt;%</span></span>
<span id="cb307-6"><a href="manipulate-and-summarize-dataframes.html#cb307-6" tabindex="-1"></a>          <span class="fu">group_by</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.arrange)) <span class="sc">%&gt;%</span></span>
<span id="cb307-7"><a href="manipulate-and-summarize-dataframes.html#cb307-7" tabindex="-1"></a>          <span class="fu">arrange</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.arrange)) <span class="sc">%&gt;%</span></span>
<span id="cb307-8"><a href="manipulate-and-summarize-dataframes.html#cb307-8" tabindex="-1"></a>          <span class="fu">select</span>(<span class="sc">!!!</span><span class="fu">syms</span>(vars.arrange), <span class="sc">!!!</span><span class="fu">syms</span>(vars.groups.within.indi)))</span></code></pre></div>
</div>
<div id="within-group-averages" class="section level5 hasAnchor" number="2.4.4.2.2">
<h5><span class="header-section-number">2.4.4.2.2</span> Within Group Averages<a href="manipulate-and-summarize-dataframes.html#within-group-averages" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>With the within-group averages created, we can generate averages for all variables within these groups.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="manipulate-and-summarize-dataframes.html#cb308-1" tabindex="-1"></a>vars.not.groups2avg <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>, <span class="st">&#39;cal&#39;</span>)</span>
<span id="cb308-2"><a href="manipulate-and-summarize-dataframes.html#cb308-2" tabindex="-1"></a>vars.indi.grp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;S.country&#39;</span>, <span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb308-3"><a href="manipulate-and-summarize-dataframes.html#cb308-3" tabindex="-1"></a>vars.groups.within.indi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;m12t24&#39;</span>, <span class="st">&#39;m8t24&#39;</span>, <span class="st">&#39;m12&#39;</span>, <span class="st">&#39;m6&#39;</span>, <span class="st">&#39;m3&#39;</span>)</span>
<span id="cb308-4"><a href="manipulate-and-summarize-dataframes.html#cb308-4" tabindex="-1"></a></span>
<span id="cb308-5"><a href="manipulate-and-summarize-dataframes.html#cb308-5" tabindex="-1"></a>df.groups.to.average.select <span class="ot">&lt;-</span> df.groups.to.average <span class="sc">%&gt;%</span></span>
<span id="cb308-6"><a href="manipulate-and-summarize-dataframes.html#cb308-6" tabindex="-1"></a>                        <span class="fu">select</span>(<span class="fu">one_of</span>(<span class="fu">c</span>(vars.indi.grp,</span>
<span id="cb308-7"><a href="manipulate-and-summarize-dataframes.html#cb308-7" tabindex="-1"></a>                                        vars.not.groups2avg,</span>
<span id="cb308-8"><a href="manipulate-and-summarize-dataframes.html#cb308-8" tabindex="-1"></a>                                        vars.groups.within.indi)))</span>
<span id="cb308-9"><a href="manipulate-and-summarize-dataframes.html#cb308-9" tabindex="-1"></a>df.avg.allvars.wide <span class="ot">&lt;-</span> <span class="fu">f.by.groups.summ.wide</span>(df.groups.to.average.select,</span>
<span id="cb308-10"><a href="manipulate-and-summarize-dataframes.html#cb308-10" tabindex="-1"></a>                                             vars.not.groups2avg,</span>
<span id="cb308-11"><a href="manipulate-and-summarize-dataframes.html#cb308-11" tabindex="-1"></a>                                             vars.indi.grp, <span class="at">display=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>This is the tabular version of results</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="manipulate-and-summarize-dataframes.html#cb309-1" tabindex="-1"></a><span class="fu">dim</span>(df.avg.allvars.wide)</span></code></pre></div>
<pre><code>## [1] 2023   38</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="manipulate-and-summarize-dataframes.html#cb311-1" tabindex="-1"></a><span class="fu">names</span>(df.avg.allvars.wide)</span></code></pre></div>
<pre><code>##  [1] &quot;S.country&quot;      &quot;indi.id&quot;        &quot;cal_m12_c1&quot;     &quot;cal_m12_c2&quot;    
##  [5] &quot;cal_m12t24_c0&quot;  &quot;cal_m12t24_c1&quot;  &quot;cal_m3_c1&quot;      &quot;cal_m3_c2&quot;     
##  [9] &quot;cal_m3_c3&quot;      &quot;cal_m3_c4&quot;      &quot;cal_m3_c5&quot;      &quot;cal_m3_c6&quot;     
## [13] &quot;cal_m3_c7&quot;      &quot;cal_m3_c8&quot;      &quot;cal_m6_c1&quot;      &quot;cal_m6_c2&quot;     
## [17] &quot;cal_m6_c3&quot;      &quot;cal_m6_c4&quot;      &quot;cal_m8t24_c0&quot;   &quot;cal_m8t24_c1&quot;  
## [21] &quot;prot_m12_c1&quot;    &quot;prot_m12_c2&quot;    &quot;prot_m12t24_c0&quot; &quot;prot_m12t24_c1&quot;
## [25] &quot;prot_m3_c1&quot;     &quot;prot_m3_c2&quot;     &quot;prot_m3_c3&quot;     &quot;prot_m3_c4&quot;    
## [29] &quot;prot_m3_c5&quot;     &quot;prot_m3_c6&quot;     &quot;prot_m3_c7&quot;     &quot;prot_m3_c8&quot;    
## [33] &quot;prot_m6_c1&quot;     &quot;prot_m6_c2&quot;     &quot;prot_m6_c3&quot;     &quot;prot_m6_c4&quot;    
## [37] &quot;prot_m8t24_c0&quot;  &quot;prot_m8t24_c1&quot;</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="manipulate-and-summarize-dataframes.html#cb313-1" tabindex="-1"></a>df.avg.allvars.wide[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,] <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m12_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m12_c2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m12t24_c0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m12t24_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c7
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m3_c8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m6_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m6_c2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m6_c3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m6_c4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m8t24_c0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cal_m8t24_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m12_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m12_c2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m12t24_c0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m12t24_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c7
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m3_c8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m6_c1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m6_c2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m6_c3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m6_c4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m8t24_c0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_m8t24_c1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
132.15714
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
97.08333
</td>
<td style="text-align:right;">
342.6000
</td>
<td style="text-align:right;">
9.10
</td>
<td style="text-align:right;">
95.50
</td>
<td style="text-align:right;">
85.3
</td>
<td style="text-align:right;">
315.30
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
52.300
</td>
<td style="text-align:right;">
238.63333
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
52.300
</td>
<td style="text-align:right;">
238.6333
</td>
<td style="text-align:right;">
5.3571429
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
4.3666667
</td>
<td style="text-align:right;">
11.300000
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
3.65
</td>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:right;">
13.15
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
2.150
</td>
<td style="text-align:right;">
9.6333333
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
2.150
</td>
<td style="text-align:right;">
9.633333
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
90.72857
</td>
<td style="text-align:right;">
255.6500
</td>
<td style="text-align:right;">
81.46667
</td>
<td style="text-align:right;">
240.0286
</td>
<td style="text-align:right;">
83.35
</td>
<td style="text-align:right;">
12.30
</td>
<td style="text-align:right;">
155.1
</td>
<td style="text-align:right;">
144.35
</td>
<td style="text-align:right;">
228.0
</td>
<td style="text-align:right;">
152.85
</td>
<td style="text-align:right;">
305.0
</td>
<td style="text-align:right;">
347.60
</td>
<td style="text-align:right;">
47.825
</td>
<td style="text-align:right;">
147.93333
</td>
<td style="text-align:right;">
177.9000
</td>
<td style="text-align:right;">
333.4000
</td>
<td style="text-align:right;">
47.825
</td>
<td style="text-align:right;">
219.7444
</td>
<td style="text-align:right;">
3.1857143
</td>
<td style="text-align:right;">
8.550000
</td>
<td style="text-align:right;">
2.7333333
</td>
<td style="text-align:right;">
8.171429
</td>
<td style="text-align:right;">
3.20
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
5.2
</td>
<td style="text-align:right;">
4.10
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
5.15
</td>
<td style="text-align:right;">
7.7
</td>
<td style="text-align:right;">
13.95
</td>
<td style="text-align:right;">
2.225
</td>
<td style="text-align:right;">
4.4666667
</td>
<td style="text-align:right;">
5.233333
</td>
<td style="text-align:right;">
11.866667
</td>
<td style="text-align:right;">
2.225
</td>
<td style="text-align:right;">
7.188889
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
96.80000
</td>
<td style="text-align:right;">
658.8167
</td>
<td style="text-align:right;">
31.56667
</td>
<td style="text-align:right;">
634.4429
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
28.85
</td>
<td style="text-align:right;">
57.0
</td>
<td style="text-align:right;">
280.95
</td>
<td style="text-align:right;">
459.3
</td>
<td style="text-align:right;">
549.95
</td>
<td style="text-align:right;">
612.0
</td>
<td style="text-align:right;">
890.85
</td>
<td style="text-align:right;">
14.675
</td>
<td style="text-align:right;">
206.30000
</td>
<td style="text-align:right;">
519.7333
</td>
<td style="text-align:right;">
797.9000
</td>
<td style="text-align:right;">
14.675
</td>
<td style="text-align:right;">
507.9778
</td>
<td style="text-align:right;">
4.5000000
</td>
<td style="text-align:right;">
21.116667
</td>
<td style="text-align:right;">
1.6833333
</td>
<td style="text-align:right;">
21.157143
</td>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:right;">
2.15
</td>
<td style="text-align:right;">
2.3
</td>
<td style="text-align:right;">
11.40
</td>
<td style="text-align:right;">
18.5
</td>
<td style="text-align:right;">
18.05
</td>
<td style="text-align:right;">
18.0
</td>
<td style="text-align:right;">
27.05
</td>
<td style="text-align:right;">
1.600
</td>
<td style="text-align:right;">
8.3666667
</td>
<td style="text-align:right;">
18.200000
</td>
<td style="text-align:right;">
24.033333
</td>
<td style="text-align:right;">
1.600
</td>
<td style="text-align:right;">
16.866667
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
27.45714
</td>
<td style="text-align:right;">
371.7000
</td>
<td style="text-align:right;">
24.55000
</td>
<td style="text-align:right;">
325.0143
</td>
<td style="text-align:right;">
4.50
</td>
<td style="text-align:right;">
25.95
</td>
<td style="text-align:right;">
39.4
</td>
<td style="text-align:right;">
45.95
</td>
<td style="text-align:right;">
221.2
</td>
<td style="text-align:right;">
271.00
</td>
<td style="text-align:right;">
581.3
</td>
<td style="text-align:right;">
442.85
</td>
<td style="text-align:right;">
15.225
</td>
<td style="text-align:right;">
43.76667
</td>
<td style="text-align:right;">
254.4000
</td>
<td style="text-align:right;">
489.0000
</td>
<td style="text-align:right;">
15.225
</td>
<td style="text-align:right;">
262.3889
</td>
<td style="text-align:right;">
0.8714286
</td>
<td style="text-align:right;">
6.850000
</td>
<td style="text-align:right;">
0.9000000
</td>
<td style="text-align:right;">
5.971429
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
1.8
</td>
<td style="text-align:right;">
4.85
</td>
<td style="text-align:right;">
10.1
</td>
<td style="text-align:right;">
9.75
</td>
<td style="text-align:right;">
0.925
</td>
<td style="text-align:right;">
0.8000000
</td>
<td style="text-align:right;">
3.833333
</td>
<td style="text-align:right;">
9.866667
</td>
<td style="text-align:right;">
0.925
</td>
<td style="text-align:right;">
4.833333
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
101.34286
</td>
<td style="text-align:right;">
1080.8500
</td>
<td style="text-align:right;">
79.15000
</td>
<td style="text-align:right;">
959.9429
</td>
<td style="text-align:right;">
14.10
</td>
<td style="text-align:right;">
143.80
</td>
<td style="text-align:right;">
71.3
</td>
<td style="text-align:right;">
161.15
</td>
<td style="text-align:right;">
452.6
</td>
<td style="text-align:right;">
1345.20
</td>
<td style="text-align:right;">
1178.1
</td>
<td style="text-align:right;">
1082.00
</td>
<td style="text-align:right;">
78.950
</td>
<td style="text-align:right;">
131.20000
</td>
<td style="text-align:right;">
1047.6667
</td>
<td style="text-align:right;">
1114.0333
</td>
<td style="text-align:right;">
78.950
</td>
<td style="text-align:right;">
764.3000
</td>
<td style="text-align:right;">
2.4000000
</td>
<td style="text-align:right;">
19.483333
</td>
<td style="text-align:right;">
2.3166667
</td>
<td style="text-align:right;">
17.114286
</td>
<td style="text-align:right;">
1.35
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
2.35
</td>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
23.15
</td>
<td style="text-align:right;">
24.5
</td>
<td style="text-align:right;">
19.50
</td>
<td style="text-align:right;">
2.175
</td>
<td style="text-align:right;">
2.7000000
</td>
<td style="text-align:right;">
17.800000
</td>
<td style="text-align:right;">
21.166667
</td>
<td style="text-align:right;">
2.175
</td>
<td style="text-align:right;">
13.888889
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
185.35714
</td>
<td style="text-align:right;">
521.5333
</td>
<td style="text-align:right;">
162.23333
</td>
<td style="text-align:right;">
493.3286
</td>
<td style="text-align:right;">
23.85
</td>
<td style="text-align:right;">
184.70
</td>
<td style="text-align:right;">
169.1
</td>
<td style="text-align:right;">
355.65
</td>
<td style="text-align:right;">
653.4
</td>
<td style="text-align:right;">
506.50
</td>
<td style="text-align:right;">
416.8
</td>
<td style="text-align:right;">
523.00
</td>
<td style="text-align:right;">
104.275
</td>
<td style="text-align:right;">
293.46667
</td>
<td style="text-align:right;">
555.4667
</td>
<td style="text-align:right;">
487.6000
</td>
<td style="text-align:right;">
104.275
</td>
<td style="text-align:right;">
445.5111
</td>
<td style="text-align:right;">
8.4000000
</td>
<td style="text-align:right;">
15.116667
</td>
<td style="text-align:right;">
7.3833333
</td>
<td style="text-align:right;">
15.028571
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
7.40
</td>
<td style="text-align:right;">
9.8
</td>
<td style="text-align:right;">
16.25
</td>
<td style="text-align:right;">
26.8
</td>
<td style="text-align:right;">
14.10
</td>
<td style="text-align:right;">
11.4
</td>
<td style="text-align:right;">
12.15
</td>
<td style="text-align:right;">
4.125
</td>
<td style="text-align:right;">
14.1000000
</td>
<td style="text-align:right;">
18.333333
</td>
<td style="text-align:right;">
11.900000
</td>
<td style="text-align:right;">
4.125
</td>
<td style="text-align:right;">
14.777778
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
157.25714
</td>
<td style="text-align:right;">
570.9800
</td>
<td style="text-align:right;">
145.50000
</td>
<td style="text-align:right;">
513.7833
</td>
<td style="text-align:right;">
8.30
</td>
<td style="text-align:right;">
137.80
</td>
<td style="text-align:right;">
407.8
</td>
<td style="text-align:right;">
200.40
</td>
<td style="text-align:right;">
390.6
</td>
<td style="text-align:right;">
637.10
</td>
<td style="text-align:right;">
688.1
</td>
<td style="text-align:right;">
569.55
</td>
<td style="text-align:right;">
73.050
</td>
<td style="text-align:right;">
269.53333
</td>
<td style="text-align:right;">
513.8500
</td>
<td style="text-align:right;">
609.0667
</td>
<td style="text-align:right;">
73.050
</td>
<td style="text-align:right;">
457.9375
</td>
<td style="text-align:right;">
3.3000000
</td>
<td style="text-align:right;">
20.440000
</td>
<td style="text-align:right;">
2.7833333
</td>
<td style="text-align:right;">
18.100000
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
1.70
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
4.60
</td>
<td style="text-align:right;">
16.4
</td>
<td style="text-align:right;">
23.00
</td>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:right;">
20.65
</td>
<td style="text-align:right;">
1.325
</td>
<td style="text-align:right;">
5.9333333
</td>
<td style="text-align:right;">
19.700000
</td>
<td style="text-align:right;">
20.933333
</td>
<td style="text-align:right;">
1.325
</td>
<td style="text-align:right;">
15.000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
471.92857
</td>
<td style="text-align:right;">
844.8333
</td>
<td style="text-align:right;">
379.20000
</td>
<td style="text-align:right;">
871.0429
</td>
<td style="text-align:right;">
158.95
</td>
<td style="text-align:right;">
423.00
</td>
<td style="text-align:right;">
417.5
</td>
<td style="text-align:right;">
861.05
</td>
<td style="text-align:right;">
691.3
</td>
<td style="text-align:right;">
897.95
</td>
<td style="text-align:right;">
637.1
</td>
<td style="text-align:right;">
972.35
</td>
<td style="text-align:right;">
290.975
</td>
<td style="text-align:right;">
713.20000
</td>
<td style="text-align:right;">
829.0667
</td>
<td style="text-align:right;">
860.6000
</td>
<td style="text-align:right;">
290.975
</td>
<td style="text-align:right;">
800.9556
</td>
<td style="text-align:right;">
13.6857143
</td>
<td style="text-align:right;">
32.716667
</td>
<td style="text-align:right;">
11.0166667
</td>
<td style="text-align:right;">
32.285714
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
11.35
</td>
<td style="text-align:right;">
10.8
</td>
<td style="text-align:right;">
27.25
</td>
<td style="text-align:right;">
42.7
</td>
<td style="text-align:right;">
26.45
</td>
<td style="text-align:right;">
25.8
</td>
<td style="text-align:right;">
37.45
</td>
<td style="text-align:right;">
7.625
</td>
<td style="text-align:right;">
21.7666667
</td>
<td style="text-align:right;">
31.866667
</td>
<td style="text-align:right;">
33.566667
</td>
<td style="text-align:right;">
7.625
</td>
<td style="text-align:right;">
29.066667
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
32.27143
</td>
<td style="text-align:right;">
415.2167
</td>
<td style="text-align:right;">
16.58333
</td>
<td style="text-align:right;">
373.9571
</td>
<td style="text-align:right;">
5.05
</td>
<td style="text-align:right;">
10.40
</td>
<td style="text-align:right;">
15.1
</td>
<td style="text-align:right;">
89.95
</td>
<td style="text-align:right;">
142.4
</td>
<td style="text-align:right;">
203.60
</td>
<td style="text-align:right;">
753.2
</td>
<td style="text-align:right;">
594.25
</td>
<td style="text-align:right;">
7.725
</td>
<td style="text-align:right;">
65.00000
</td>
<td style="text-align:right;">
183.2000
</td>
<td style="text-align:right;">
647.2333
</td>
<td style="text-align:right;">
7.725
</td>
<td style="text-align:right;">
298.4778
</td>
<td style="text-align:right;">
0.9571429
</td>
<td style="text-align:right;">
18.283333
</td>
<td style="text-align:right;">
0.9166667
</td>
<td style="text-align:right;">
15.842857
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
2.10
</td>
<td style="text-align:right;">
4.2
</td>
<td style="text-align:right;">
10.85
</td>
<td style="text-align:right;">
39.5
</td>
<td style="text-align:right;">
22.15
</td>
<td style="text-align:right;">
0.500
</td>
<td style="text-align:right;">
1.5666667
</td>
<td style="text-align:right;">
8.633333
</td>
<td style="text-align:right;">
27.933333
</td>
<td style="text-align:right;">
0.500
</td>
<td style="text-align:right;">
12.711111
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
67.18571
</td>
<td style="text-align:right;">
395.2500
</td>
<td style="text-align:right;">
68.58333
</td>
<td style="text-align:right;">
347.1857
</td>
<td style="text-align:right;">
9.55
</td>
<td style="text-align:right;">
26.40
</td>
<td style="text-align:right;">
164.6
</td>
<td style="text-align:right;">
116.90
</td>
<td style="text-align:right;">
296.6
</td>
<td style="text-align:right;">
303.00
</td>
<td style="text-align:right;">
385.1
</td>
<td style="text-align:right;">
541.90
</td>
<td style="text-align:right;">
17.975
</td>
<td style="text-align:right;">
132.80000
</td>
<td style="text-align:right;">
300.8667
</td>
<td style="text-align:right;">
489.6333
</td>
<td style="text-align:right;">
17.975
</td>
<td style="text-align:right;">
307.7667
</td>
<td style="text-align:right;">
2.0428571
</td>
<td style="text-align:right;">
8.466667
</td>
<td style="text-align:right;">
1.9333333
</td>
<td style="text-align:right;">
7.642857
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
3.35
</td>
<td style="text-align:right;">
7.5
</td>
<td style="text-align:right;">
6.05
</td>
<td style="text-align:right;">
9.2
</td>
<td style="text-align:right;">
11.00
</td>
<td style="text-align:right;">
0.675
</td>
<td style="text-align:right;">
3.8666667
</td>
<td style="text-align:right;">
6.533333
</td>
<td style="text-align:right;">
10.400000
</td>
<td style="text-align:right;">
0.675
</td>
<td style="text-align:right;">
6.933333
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
14.90000
</td>
<td style="text-align:right;">
245.3833
</td>
<td style="text-align:right;">
11.80000
</td>
<td style="text-align:right;">
215.1143
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
5.20
</td>
<td style="text-align:right;">
30.0
</td>
<td style="text-align:right;">
31.45
</td>
<td style="text-align:right;">
126.2
</td>
<td style="text-align:right;">
223.05
</td>
<td style="text-align:right;">
239.6
</td>
<td style="text-align:right;">
330.20
</td>
<td style="text-align:right;">
2.850
</td>
<td style="text-align:right;">
30.96667
</td>
<td style="text-align:right;">
190.7667
</td>
<td style="text-align:right;">
300.0000
</td>
<td style="text-align:right;">
2.850
</td>
<td style="text-align:right;">
173.9111
</td>
<td style="text-align:right;">
1.0285714
</td>
<td style="text-align:right;">
6.833333
</td>
<td style="text-align:right;">
1.1166667
</td>
<td style="text-align:right;">
5.928571
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
1.70
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
6.35
</td>
<td style="text-align:right;">
7.3
</td>
<td style="text-align:right;">
8.70
</td>
<td style="text-align:right;">
1.250
</td>
<td style="text-align:right;">
0.7333333
</td>
<td style="text-align:right;">
5.433333
</td>
<td style="text-align:right;">
8.233333
</td>
<td style="text-align:right;">
1.250
</td>
<td style="text-align:right;">
4.800000
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
453.61429
</td>
<td style="text-align:right;">
745.6833
</td>
<td style="text-align:right;">
419.51667
</td>
<td style="text-align:right;">
733.1857
</td>
<td style="text-align:right;">
325.60
</td>
<td style="text-align:right;">
483.65
</td>
<td style="text-align:right;">
463.0
</td>
<td style="text-align:right;">
546.90
</td>
<td style="text-align:right;">
766.8
</td>
<td style="text-align:right;">
676.85
</td>
<td style="text-align:right;">
998.5
</td>
<td style="text-align:right;">
677.55
</td>
<td style="text-align:right;">
404.625
</td>
<td style="text-align:right;">
518.93333
</td>
<td style="text-align:right;">
706.8333
</td>
<td style="text-align:right;">
784.5333
</td>
<td style="text-align:right;">
404.625
</td>
<td style="text-align:right;">
670.1000
</td>
<td style="text-align:right;">
14.7714286
</td>
<td style="text-align:right;">
22.133333
</td>
<td style="text-align:right;">
14.1666667
</td>
<td style="text-align:right;">
21.600000
</td>
<td style="text-align:right;">
7.40
</td>
<td style="text-align:right;">
13.60
</td>
<td style="text-align:right;">
26.6
</td>
<td style="text-align:right;">
17.40
</td>
<td style="text-align:right;">
18.6
</td>
<td style="text-align:right;">
20.35
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
23.95
</td>
<td style="text-align:right;">
10.500
</td>
<td style="text-align:right;">
20.4666667
</td>
<td style="text-align:right;">
19.766667
</td>
<td style="text-align:right;">
24.500000
</td>
<td style="text-align:right;">
10.500
</td>
<td style="text-align:right;">
21.577778
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
47.51429
</td>
<td style="text-align:right;">
210.2500
</td>
<td style="text-align:right;">
36.81667
</td>
<td style="text-align:right;">
196.1714
</td>
<td style="text-align:right;">
17.45
</td>
<td style="text-align:right;">
40.00
</td>
<td style="text-align:right;">
28.5
</td>
<td style="text-align:right;">
94.60
</td>
<td style="text-align:right;">
216.9
</td>
<td style="text-align:right;">
195.15
</td>
<td style="text-align:right;">
281.3
</td>
<td style="text-align:right;">
186.50
</td>
<td style="text-align:right;">
28.725
</td>
<td style="text-align:right;">
72.56667
</td>
<td style="text-align:right;">
202.4000
</td>
<td style="text-align:right;">
218.1000
</td>
<td style="text-align:right;">
28.725
</td>
<td style="text-align:right;">
164.3556
</td>
<td style="text-align:right;">
1.9571429
</td>
<td style="text-align:right;">
6.800000
</td>
<td style="text-align:right;">
1.6666667
</td>
<td style="text-align:right;">
6.357143
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:right;">
2.1
</td>
<td style="text-align:right;">
3.60
</td>
<td style="text-align:right;">
8.3
</td>
<td style="text-align:right;">
4.75
</td>
<td style="text-align:right;">
6.2
</td>
<td style="text-align:right;">
8.40
</td>
<td style="text-align:right;">
1.100
</td>
<td style="text-align:right;">
3.1000000
</td>
<td style="text-align:right;">
5.933333
</td>
<td style="text-align:right;">
7.666667
</td>
<td style="text-align:right;">
1.100
</td>
<td style="text-align:right;">
5.566667
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
608.85714
</td>
<td style="text-align:right;">
924.5833
</td>
<td style="text-align:right;">
527.30000
</td>
<td style="text-align:right;">
949.3857
</td>
<td style="text-align:right;">
259.05
</td>
<td style="text-align:right;">
554.30
</td>
<td style="text-align:right;">
688.1
</td>
<td style="text-align:right;">
973.60
</td>
<td style="text-align:right;">
525.5
</td>
<td style="text-align:right;">
1039.60
</td>
<td style="text-align:right;">
800.0
</td>
<td style="text-align:right;">
1071.40
</td>
<td style="text-align:right;">
406.675
</td>
<td style="text-align:right;">
878.43333
</td>
<td style="text-align:right;">
868.2333
</td>
<td style="text-align:right;">
980.9333
</td>
<td style="text-align:right;">
406.675
</td>
<td style="text-align:right;">
909.2000
</td>
<td style="text-align:right;">
24.6714286
</td>
<td style="text-align:right;">
28.050000
</td>
<td style="text-align:right;">
23.0833333
</td>
<td style="text-align:right;">
28.928571
</td>
<td style="text-align:right;">
15.05
</td>
<td style="text-align:right;">
28.85
</td>
<td style="text-align:right;">
32.6
</td>
<td style="text-align:right;">
26.15
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
29.75
</td>
<td style="text-align:right;">
29.5
</td>
<td style="text-align:right;">
33.30
</td>
<td style="text-align:right;">
21.950
</td>
<td style="text-align:right;">
28.3000000
</td>
<td style="text-align:right;">
24.066667
</td>
<td style="text-align:right;">
32.033333
</td>
<td style="text-align:right;">
21.950
</td>
<td style="text-align:right;">
28.133333
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
74.67143
</td>
<td style="text-align:right;">
440.0833
</td>
<td style="text-align:right;">
64.21667
</td>
<td style="text-align:right;">
396.8429
</td>
<td style="text-align:right;">
62.40
</td>
<td style="text-align:right;">
39.60
</td>
<td style="text-align:right;">
80.1
</td>
<td style="text-align:right;">
119.30
</td>
<td style="text-align:right;">
292.5
</td>
<td style="text-align:right;">
237.45
</td>
<td style="text-align:right;">
607.8
</td>
<td style="text-align:right;">
632.65
</td>
<td style="text-align:right;">
51.000
</td>
<td style="text-align:right;">
106.23333
</td>
<td style="text-align:right;">
255.8000
</td>
<td style="text-align:right;">
624.3667
</td>
<td style="text-align:right;">
51.000
</td>
<td style="text-align:right;">
328.8000
</td>
<td style="text-align:right;">
2.2571429
</td>
<td style="text-align:right;">
10.633333
</td>
<td style="text-align:right;">
1.6333333
</td>
<td style="text-align:right;">
9.971429
</td>
<td style="text-align:right;">
1.65
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
4.60
</td>
<td style="text-align:right;">
9.4
</td>
<td style="text-align:right;">
5.80
</td>
<td style="text-align:right;">
13.6
</td>
<td style="text-align:right;">
14.60
</td>
<td style="text-align:right;">
1.275
</td>
<td style="text-align:right;">
3.5666667
</td>
<td style="text-align:right;">
7.000000
</td>
<td style="text-align:right;">
14.266667
</td>
<td style="text-align:right;">
1.275
</td>
<td style="text-align:right;">
8.277778
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
128.45714
</td>
<td style="text-align:right;">
519.9333
</td>
<td style="text-align:right;">
90.50000
</td>
<td style="text-align:right;">
496.5429
</td>
<td style="text-align:right;">
4.80
</td>
<td style="text-align:right;">
11.00
</td>
<td style="text-align:right;">
205.3
</td>
<td style="text-align:right;">
331.15
</td>
<td style="text-align:right;">
290.8
</td>
<td style="text-align:right;">
354.50
</td>
<td style="text-align:right;">
563.3
</td>
<td style="text-align:right;">
778.25
</td>
<td style="text-align:right;">
7.900
</td>
<td style="text-align:right;">
289.20000
</td>
<td style="text-align:right;">
333.2667
</td>
<td style="text-align:right;">
706.6000
</td>
<td style="text-align:right;">
7.900
</td>
<td style="text-align:right;">
443.0222
</td>
<td style="text-align:right;">
4.6857143
</td>
<td style="text-align:right;">
18.083333
</td>
<td style="text-align:right;">
4.1000000
</td>
<td style="text-align:right;">
16.671429
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
2.70
</td>
<td style="text-align:right;">
8.7
</td>
<td style="text-align:right;">
8.70
</td>
<td style="text-align:right;">
7.8
</td>
<td style="text-align:right;">
12.95
</td>
<td style="text-align:right;">
25.9
</td>
<td style="text-align:right;">
24.45
</td>
<td style="text-align:right;">
1.675
</td>
<td style="text-align:right;">
8.7000000
</td>
<td style="text-align:right;">
11.233333
</td>
<td style="text-align:right;">
24.933333
</td>
<td style="text-align:right;">
1.675
</td>
<td style="text-align:right;">
14.955556
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
130.78571
</td>
<td style="text-align:right;">
718.8667
</td>
<td style="text-align:right;">
97.48333
</td>
<td style="text-align:right;">
663.4000
</td>
<td style="text-align:right;">
5.50
</td>
<td style="text-align:right;">
7.80
</td>
<td style="text-align:right;">
249.9
</td>
<td style="text-align:right;">
319.50
</td>
<td style="text-align:right;">
774.6
</td>
<td style="text-align:right;">
892.90
</td>
<td style="text-align:right;">
551.9
</td>
<td style="text-align:right;">
600.45
</td>
<td style="text-align:right;">
6.650
</td>
<td style="text-align:right;">
296.30000
</td>
<td style="text-align:right;">
853.4667
</td>
<td style="text-align:right;">
584.2667
</td>
<td style="text-align:right;">
6.650
</td>
<td style="text-align:right;">
578.0111
</td>
<td style="text-align:right;">
2.8142857
</td>
<td style="text-align:right;">
19.716667
</td>
<td style="text-align:right;">
2.2166667
</td>
<td style="text-align:right;">
17.814286
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
6.1
</td>
<td style="text-align:right;">
5.70
</td>
<td style="text-align:right;">
20.1
</td>
<td style="text-align:right;">
21.55
</td>
<td style="text-align:right;">
24.9
</td>
<td style="text-align:right;">
15.10
</td>
<td style="text-align:right;">
0.550
</td>
<td style="text-align:right;">
5.8333333
</td>
<td style="text-align:right;">
21.066667
</td>
<td style="text-align:right;">
18.366667
</td>
<td style="text-align:right;">
0.550
</td>
<td style="text-align:right;">
15.088889
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
172.64000
</td>
<td style="text-align:right;">
497.9500
</td>
<td style="text-align:right;">
172.64000
</td>
<td style="text-align:right;">
497.9500
</td>
<td style="text-align:right;">
29.60
</td>
<td style="text-align:right;">
234.40
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
335.20
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
497.95
</td>
<td style="text-align:right;">
132.000
</td>
<td style="text-align:right;">
335.20000
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
497.9500
</td>
<td style="text-align:right;">
132.000
</td>
<td style="text-align:right;">
443.7000
</td>
<td style="text-align:right;">
11.7000000
</td>
<td style="text-align:right;">
19.100000
</td>
<td style="text-align:right;">
11.7000000
</td>
<td style="text-align:right;">
19.100000
</td>
<td style="text-align:right;">
2.95
</td>
<td style="text-align:right;">
17.90
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
16.80
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
19.10
</td>
<td style="text-align:right;">
10.425
</td>
<td style="text-align:right;">
16.8000000
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
19.100000
</td>
<td style="text-align:right;">
10.425
</td>
<td style="text-align:right;">
18.333333
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
74.45714
</td>
<td style="text-align:right;">
314.7333
</td>
<td style="text-align:right;">
80.10000
</td>
<td style="text-align:right;">
275.5714
</td>
<td style="text-align:right;">
3.65
</td>
<td style="text-align:right;">
95.70
</td>
<td style="text-align:right;">
171.3
</td>
<td style="text-align:right;">
75.60
</td>
<td style="text-align:right;">
131.3
</td>
<td style="text-align:right;">
350.50
</td>
<td style="text-align:right;">
304.6
</td>
<td style="text-align:right;">
375.75
</td>
<td style="text-align:right;">
49.675
</td>
<td style="text-align:right;">
107.50000
</td>
<td style="text-align:right;">
277.4333
</td>
<td style="text-align:right;">
352.0333
</td>
<td style="text-align:right;">
49.675
</td>
<td style="text-align:right;">
245.6556
</td>
<td style="text-align:right;">
2.5428571
</td>
<td style="text-align:right;">
10.466667
</td>
<td style="text-align:right;">
2.8833333
</td>
<td style="text-align:right;">
9.042857
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
2.95
</td>
<td style="text-align:right;">
6.7
</td>
<td style="text-align:right;">
2.10
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
11.40
</td>
<td style="text-align:right;">
12.3
</td>
<td style="text-align:right;">
12.15
</td>
<td style="text-align:right;">
1.725
</td>
<td style="text-align:right;">
3.6333333
</td>
<td style="text-align:right;">
8.733333
</td>
<td style="text-align:right;">
12.200000
</td>
<td style="text-align:right;">
1.725
</td>
<td style="text-align:right;">
8.188889
</td>
</tr>
<tr>
<td style="text-align:left;">
Cebu
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
110.90000
</td>
<td style="text-align:right;">
583.2000
</td>
<td style="text-align:right;">
80.51667
</td>
<td style="text-align:right;">
541.7714
</td>
<td style="text-align:right;">
7.30
</td>
<td style="text-align:right;">
120.65
</td>
<td style="text-align:right;">
77.8
</td>
<td style="text-align:right;">
221.30
</td>
<td style="text-align:right;">
391.2
</td>
<td style="text-align:right;">
582.10
</td>
<td style="text-align:right;">
466.1
</td>
<td style="text-align:right;">
738.85
</td>
<td style="text-align:right;">
63.975
</td>
<td style="text-align:right;">
173.46667
</td>
<td style="text-align:right;">
518.4667
</td>
<td style="text-align:right;">
647.9333
</td>
<td style="text-align:right;">
63.975
</td>
<td style="text-align:right;">
446.6222
</td>
<td style="text-align:right;">
3.2000000
</td>
<td style="text-align:right;">
16.966667
</td>
<td style="text-align:right;">
2.1833333
</td>
<td style="text-align:right;">
15.871429
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
5.50
</td>
<td style="text-align:right;">
7.9
</td>
<td style="text-align:right;">
20.15
</td>
<td style="text-align:right;">
11.8
</td>
<td style="text-align:right;">
20.90
</td>
<td style="text-align:right;">
2.175
</td>
<td style="text-align:right;">
4.5666667
</td>
<td style="text-align:right;">
16.066667
</td>
<td style="text-align:right;">
17.866667
</td>
<td style="text-align:right;">
2.175
</td>
<td style="text-align:right;">
12.833333
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</div>
</div>
<div id="distributional-statistics" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Distributional Statistics<a href="manipulate-and-summarize-dataframes.html#distributional-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="histogram" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Histogram<a href="manipulate-and-summarize-dataframes.html#histogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="generate-test-score-dataset" class="section level4 hasAnchor" number="2.5.1.1">
<h4><span class="header-section-number">2.5.1.1</span> Generate Test Score Dataset<a href="manipulate-and-summarize-dataframes.html#generate-test-score-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<ul>
<li>r generate text string as csv</li>
<li>r tibble matrix hand input</li>
</ul>
<p>First, we will generate a test score dataset, directly from string. Below we type line by line a dataset with four variables in comma separated (csv) format, where the first row includes the variables names. These texts could be stored in a separate file, or they could be directly included in code and read in as csv</p>
<div id="a-dataset-with-only-two-continuous-variable" class="section level5 hasAnchor" number="2.5.1.1.1">
<h5><span class="header-section-number">2.5.1.1.1</span> A Dataset with only Two Continuous Variable<a href="manipulate-and-summarize-dataframes.html#a-dataset-with-only-two-continuous-variable" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="manipulate-and-summarize-dataframes.html#cb314-1" tabindex="-1"></a>ar_test_scores_ec3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">107.72</span>,<span class="fl">101.28</span>,<span class="fl">105.92</span>,<span class="fl">109.31</span>,<span class="fl">104.27</span>,<span class="fl">110.27</span>,<span class="fl">91.92846154</span>,<span class="fl">81.8</span>,<span class="fl">109.0071429</span>,<span class="fl">103.07</span>,<span class="fl">98.97923077</span>,<span class="fl">101.91</span>,<span class="fl">96.49</span>,<span class="fl">97.79923077</span>,<span class="fl">99.07846154</span>,<span class="fl">99.17</span>,<span class="fl">103.51</span>,<span class="fl">112.2225</span>,<span class="fl">101.2964286</span>,<span class="fl">94.5</span>,<span class="fl">98.92</span>,<span class="fl">97.09</span>,<span class="fl">93.83989011</span>,<span class="fl">97.36304945</span>,<span class="fl">80.34</span>,<span class="fl">65.74</span>,<span class="fl">85.275</span>,<span class="fl">82.19708791</span>,<span class="fl">86.53758242</span>,<span class="fl">86.2025</span>,<span class="fl">86.63</span>,<span class="fl">82.57392857</span>,<span class="fl">83.66</span>,<span class="fl">79.76</span>,<span class="fl">75.55642857</span>,<span class="fl">86.32571429</span>,<span class="fl">66.41</span>,<span class="fl">76.06</span>,<span class="fl">44.225</span>,<span class="fl">82.28</span>,<span class="fl">47.77392857</span>,<span class="fl">70.005</span>,<span class="fl">69.13769231</span>,<span class="fl">73.52571429</span>,<span class="fl">60.51</span>,<span class="fl">56.04</span>)</span>
<span id="cb314-2"><a href="manipulate-and-summarize-dataframes.html#cb314-2" tabindex="-1"></a>ar_test_scores_ec1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">101.72</span>,<span class="fl">101.28</span>,<span class="fl">99.92</span>,<span class="fl">103.31</span>,<span class="fl">100.27</span>,<span class="fl">104.27</span>,<span class="fl">90.23615385</span>,<span class="fl">77.8</span>,<span class="fl">103.4357143</span>,<span class="fl">97.07</span>,<span class="fl">93.13307692</span>,<span class="fl">95.91</span>,<span class="fl">92.49</span>,<span class="fl">93.95307692</span>,<span class="fl">95.38615385</span>,<span class="fl">97.17</span>,<span class="fl">99.51</span>,<span class="fl">100.3475</span>,<span class="fl">95.83214286</span>,<span class="fl">92.5</span>,<span class="fl">94.92</span>,<span class="fl">91.09</span>,<span class="fl">90.4332967</span>,<span class="fl">93.52101648</span>,<span class="fl">80.34</span>,<span class="fl">59.74</span>,<span class="fl">79.525</span>,<span class="fl">77.67236264</span>,<span class="fl">81.59252747</span>,<span class="fl">82.3275</span>,<span class="fl">80.63</span>,<span class="fl">76.98464286</span>,<span class="fl">81.66</span>,<span class="fl">79.76</span>,<span class="fl">70.59214286</span>,<span class="fl">82.46857143</span>,<span class="fl">66.41</span>,<span class="fl">74.06</span>,<span class="fl">40.475</span>,<span class="fl">76.28</span>,<span class="fl">44.18464286</span>,<span class="fl">66.255</span>,<span class="fl">65.59923077</span>,<span class="fl">69.66857143</span>,<span class="fl">60.51</span>,<span class="fl">56.04</span>)</span>
<span id="cb314-3"><a href="manipulate-and-summarize-dataframes.html#cb314-3" tabindex="-1"></a>mt_test_scores <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_test_scores_ec1, ar_test_scores_ec3)</span>
<span id="cb314-4"><a href="manipulate-and-summarize-dataframes.html#cb314-4" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;course_total_ec1p&#39;</span>,<span class="st">&#39;course_total_ec3p&#39;</span>)</span>
<span id="cb314-5"><a href="manipulate-and-summarize-dataframes.html#cb314-5" tabindex="-1"></a>tb_final_twovar <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_test_scores) <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb314-6"><a href="manipulate-and-summarize-dataframes.html#cb314-6" tabindex="-1"></a><span class="fu">summary</span>(tb_final_twovar)</span></code></pre></div>
<pre><code>##  course_total_ec1p course_total_ec3p
##  Min.   : 40.48    Min.   : 44.23   
##  1st Qu.: 76.46    1st Qu.: 79.91   
##  Median : 86.35    Median : 89.28   
##  Mean   : 83.88    Mean   : 87.90   
##  3rd Qu.: 95.89    3rd Qu.:100.75   
##  Max.   :104.27    Max.   :112.22</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="manipulate-and-summarize-dataframes.html#cb316-1" tabindex="-1"></a><span class="fu">ff_summ_percentiles</span>(<span class="at">df =</span> tb_final_twovar, <span class="at">bl_statsasrows =</span> <span class="cn">TRUE</span>, <span class="at">col2varname =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="a-dataset-with-one-continuous-variable-and-histogram" class="section level5 hasAnchor" number="2.5.1.1.2">
<h5><span class="header-section-number">2.5.1.1.2</span> A Dataset with one Continuous Variable and Histogram<a href="manipulate-and-summarize-dataframes.html#a-dataset-with-one-continuous-variable-and-histogram" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="manipulate-and-summarize-dataframes.html#cb317-1" tabindex="-1"></a>ar_final_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">94.28442509</span>,<span class="fl">95.68817475</span>,<span class="fl">97.25219512</span>,<span class="fl">77.89268293</span>,<span class="fl">95.08795497</span>,<span class="fl">93.27380863</span>,<span class="fl">92.3</span>,<span class="fl">84.25317073</span>,<span class="fl">86.08642991</span>,<span class="fl">84.69219512</span>,<span class="fl">71.43634146</span>,<span class="fl">76.21365854</span>,<span class="fl">71.68878049</span>,<span class="fl">77.46142589</span>,<span class="fl">79.29579268</span>,<span class="fl">43.7285453</span>,<span class="fl">63.80634146</span>,<span class="fl">67.92994774</span>,<span class="fl">100.8980488</span>,<span class="fl">100.0857143</span>,<span class="fl">99.93073171</span>,<span class="fl">98.4102439</span>,<span class="fl">97.93</span>,<span class="fl">97.10359756</span>,<span class="fl">96.97121951</span>,<span class="fl">96.60292683</span>,<span class="fl">96.23317073</span>,<span class="fl">93.92243902</span>,<span class="fl">93.82243902</span>,<span class="fl">92.75390244</span>,<span class="fl">92.65775261</span>,<span class="fl">92.20444653</span>,<span class="fl">91.73463415</span>,<span class="fl">90.38321161</span>,<span class="fl">89.37414634</span>,<span class="fl">86.95932458</span>,<span class="fl">79.58686411</span>,<span class="fl">78.70878049</span>,<span class="fl">77.2497561</span>,<span class="fl">76.88195122</span>,<span class="fl">76.52987805</span>,<span class="fl">74.72114313</span>,<span class="fl">74.27488676</span>,<span class="fl">71.30268293</span>,<span class="fl">63.70256098</span>,<span class="fl">37.90426829</span>,<span class="fl">2.292682927</span>)</span>
<span id="cb317-2"><a href="manipulate-and-summarize-dataframes.html#cb317-2" tabindex="-1"></a>mt_test_scores <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">length</span>(ar_final_scores)), ar_final_scores)</span>
<span id="cb317-3"><a href="manipulate-and-summarize-dataframes.html#cb317-3" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;index&#39;</span>, <span class="st">&#39;course_final&#39;</span>)</span>
<span id="cb317-4"><a href="manipulate-and-summarize-dataframes.html#cb317-4" tabindex="-1"></a>tb_onevar <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_test_scores) <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb317-5"><a href="manipulate-and-summarize-dataframes.html#cb317-5" tabindex="-1"></a><span class="fu">summary</span>(tb_onevar)</span></code></pre></div>
<pre><code>##      index       course_final    
##  Min.   : 1.0   Min.   :  2.293  
##  1st Qu.:12.5   1st Qu.: 76.372  
##  Median :24.0   Median : 86.959  
##  Mean   :24.0   Mean   : 82.415  
##  3rd Qu.:35.5   3rd Qu.: 94.686  
##  Max.   :47.0   Max.   :100.898</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="manipulate-and-summarize-dataframes.html#cb319-1" tabindex="-1"></a><span class="fu">ff_summ_percentiles</span>(<span class="at">df =</span> tb_onevar, <span class="at">bl_statsasrows =</span> <span class="cn">TRUE</span>, <span class="at">col2varname =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="a-dataset-with-multiple-variables" class="section level5 hasAnchor" number="2.5.1.1.3">
<h5><span class="header-section-number">2.5.1.1.3</span> A Dataset with Multiple Variables<a href="manipulate-and-summarize-dataframes.html#a-dataset-with-multiple-variables" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="manipulate-and-summarize-dataframes.html#cb320-1" tabindex="-1"></a><span class="co">#load in data empirically by hand</span></span>
<span id="cb320-2"><a href="manipulate-and-summarize-dataframes.html#cb320-2" tabindex="-1"></a>txt_test_data <span class="ot">&lt;-</span> <span class="st">&quot;init_prof, later_prof, class_id, exam_score</span></span>
<span id="cb320-3"><a href="manipulate-and-summarize-dataframes.html#cb320-3" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 102</span></span>
<span id="cb320-4"><a href="manipulate-and-summarize-dataframes.html#cb320-4" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 102</span></span>
<span id="cb320-5"><a href="manipulate-and-summarize-dataframes.html#cb320-5" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 101</span></span>
<span id="cb320-6"><a href="manipulate-and-summarize-dataframes.html#cb320-6" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 100</span></span>
<span id="cb320-7"><a href="manipulate-and-summarize-dataframes.html#cb320-7" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 100</span></span>
<span id="cb320-8"><a href="manipulate-and-summarize-dataframes.html#cb320-8" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 99</span></span>
<span id="cb320-9"><a href="manipulate-and-summarize-dataframes.html#cb320-9" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 98.5</span></span>
<span id="cb320-10"><a href="manipulate-and-summarize-dataframes.html#cb320-10" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 98.5</span></span>
<span id="cb320-11"><a href="manipulate-and-summarize-dataframes.html#cb320-11" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 97</span></span>
<span id="cb320-12"><a href="manipulate-and-summarize-dataframes.html#cb320-12" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 95</span></span>
<span id="cb320-13"><a href="manipulate-and-summarize-dataframes.html#cb320-13" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 94</span></span>
<span id="cb320-14"><a href="manipulate-and-summarize-dataframes.html#cb320-14" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 91</span></span>
<span id="cb320-15"><a href="manipulate-and-summarize-dataframes.html#cb320-15" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 91</span></span>
<span id="cb320-16"><a href="manipulate-and-summarize-dataframes.html#cb320-16" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 90</span></span>
<span id="cb320-17"><a href="manipulate-and-summarize-dataframes.html#cb320-17" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 89</span></span>
<span id="cb320-18"><a href="manipulate-and-summarize-dataframes.html#cb320-18" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 88.5</span></span>
<span id="cb320-19"><a href="manipulate-and-summarize-dataframes.html#cb320-19" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 88</span></span>
<span id="cb320-20"><a href="manipulate-and-summarize-dataframes.html#cb320-20" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 87</span></span>
<span id="cb320-21"><a href="manipulate-and-summarize-dataframes.html#cb320-21" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 87</span></span>
<span id="cb320-22"><a href="manipulate-and-summarize-dataframes.html#cb320-22" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 87</span></span>
<span id="cb320-23"><a href="manipulate-and-summarize-dataframes.html#cb320-23" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 86</span></span>
<span id="cb320-24"><a href="manipulate-and-summarize-dataframes.html#cb320-24" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 86</span></span>
<span id="cb320-25"><a href="manipulate-and-summarize-dataframes.html#cb320-25" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 84</span></span>
<span id="cb320-26"><a href="manipulate-and-summarize-dataframes.html#cb320-26" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 82</span></span>
<span id="cb320-27"><a href="manipulate-and-summarize-dataframes.html#cb320-27" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 78.5</span></span>
<span id="cb320-28"><a href="manipulate-and-summarize-dataframes.html#cb320-28" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 76</span></span>
<span id="cb320-29"><a href="manipulate-and-summarize-dataframes.html#cb320-29" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 72</span></span>
<span id="cb320-30"><a href="manipulate-and-summarize-dataframes.html#cb320-30" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 70.5</span></span>
<span id="cb320-31"><a href="manipulate-and-summarize-dataframes.html#cb320-31" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 67.5</span></span>
<span id="cb320-32"><a href="manipulate-and-summarize-dataframes.html#cb320-32" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 67.5</span></span>
<span id="cb320-33"><a href="manipulate-and-summarize-dataframes.html#cb320-33" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 67</span></span>
<span id="cb320-34"><a href="manipulate-and-summarize-dataframes.html#cb320-34" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 63.5</span></span>
<span id="cb320-35"><a href="manipulate-and-summarize-dataframes.html#cb320-35" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 60</span></span>
<span id="cb320-36"><a href="manipulate-and-summarize-dataframes.html#cb320-36" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 59</span></span>
<span id="cb320-37"><a href="manipulate-and-summarize-dataframes.html#cb320-37" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 44.5</span></span>
<span id="cb320-38"><a href="manipulate-and-summarize-dataframes.html#cb320-38" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 44</span></span>
<span id="cb320-39"><a href="manipulate-and-summarize-dataframes.html#cb320-39" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 42.5</span></span>
<span id="cb320-40"><a href="manipulate-and-summarize-dataframes.html#cb320-40" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 40.5</span></span>
<span id="cb320-41"><a href="manipulate-and-summarize-dataframes.html#cb320-41" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 40.5</span></span>
<span id="cb320-42"><a href="manipulate-and-summarize-dataframes.html#cb320-42" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 36.5</span></span>
<span id="cb320-43"><a href="manipulate-and-summarize-dataframes.html#cb320-43" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 35.5</span></span>
<span id="cb320-44"><a href="manipulate-and-summarize-dataframes.html#cb320-44" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 21.5</span></span>
<span id="cb320-45"><a href="manipulate-and-summarize-dataframes.html#cb320-45" tabindex="-1"></a><span class="st"> &#39;SW&#39;, &#39;SW&#39;, 1, 4</span></span>
<span id="cb320-46"><a href="manipulate-and-summarize-dataframes.html#cb320-46" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 105</span></span>
<span id="cb320-47"><a href="manipulate-and-summarize-dataframes.html#cb320-47" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 103</span></span>
<span id="cb320-48"><a href="manipulate-and-summarize-dataframes.html#cb320-48" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 102</span></span>
<span id="cb320-49"><a href="manipulate-and-summarize-dataframes.html#cb320-49" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 101</span></span>
<span id="cb320-50"><a href="manipulate-and-summarize-dataframes.html#cb320-50" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 101</span></span>
<span id="cb320-51"><a href="manipulate-and-summarize-dataframes.html#cb320-51" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 100.5</span></span>
<span id="cb320-52"><a href="manipulate-and-summarize-dataframes.html#cb320-52" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 100</span></span>
<span id="cb320-53"><a href="manipulate-and-summarize-dataframes.html#cb320-53" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 99</span></span>
<span id="cb320-54"><a href="manipulate-and-summarize-dataframes.html#cb320-54" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 97</span></span>
<span id="cb320-55"><a href="manipulate-and-summarize-dataframes.html#cb320-55" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 97</span></span>
<span id="cb320-56"><a href="manipulate-and-summarize-dataframes.html#cb320-56" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 97</span></span>
<span id="cb320-57"><a href="manipulate-and-summarize-dataframes.html#cb320-57" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 97</span></span>
<span id="cb320-58"><a href="manipulate-and-summarize-dataframes.html#cb320-58" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 96</span></span>
<span id="cb320-59"><a href="manipulate-and-summarize-dataframes.html#cb320-59" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 95</span></span>
<span id="cb320-60"><a href="manipulate-and-summarize-dataframes.html#cb320-60" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 91</span></span>
<span id="cb320-61"><a href="manipulate-and-summarize-dataframes.html#cb320-61" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 89</span></span>
<span id="cb320-62"><a href="manipulate-and-summarize-dataframes.html#cb320-62" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 85</span></span>
<span id="cb320-63"><a href="manipulate-and-summarize-dataframes.html#cb320-63" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 84</span></span>
<span id="cb320-64"><a href="manipulate-and-summarize-dataframes.html#cb320-64" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 84</span></span>
<span id="cb320-65"><a href="manipulate-and-summarize-dataframes.html#cb320-65" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 84</span></span>
<span id="cb320-66"><a href="manipulate-and-summarize-dataframes.html#cb320-66" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 83.5</span></span>
<span id="cb320-67"><a href="manipulate-and-summarize-dataframes.html#cb320-67" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 82.5</span></span>
<span id="cb320-68"><a href="manipulate-and-summarize-dataframes.html#cb320-68" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 81.5</span></span>
<span id="cb320-69"><a href="manipulate-and-summarize-dataframes.html#cb320-69" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 80.5</span></span>
<span id="cb320-70"><a href="manipulate-and-summarize-dataframes.html#cb320-70" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 80</span></span>
<span id="cb320-71"><a href="manipulate-and-summarize-dataframes.html#cb320-71" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 77</span></span>
<span id="cb320-72"><a href="manipulate-and-summarize-dataframes.html#cb320-72" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 77</span></span>
<span id="cb320-73"><a href="manipulate-and-summarize-dataframes.html#cb320-73" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 75</span></span>
<span id="cb320-74"><a href="manipulate-and-summarize-dataframes.html#cb320-74" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 75</span></span>
<span id="cb320-75"><a href="manipulate-and-summarize-dataframes.html#cb320-75" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 71</span></span>
<span id="cb320-76"><a href="manipulate-and-summarize-dataframes.html#cb320-76" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 70</span></span>
<span id="cb320-77"><a href="manipulate-and-summarize-dataframes.html#cb320-77" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 68</span></span>
<span id="cb320-78"><a href="manipulate-and-summarize-dataframes.html#cb320-78" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 63</span></span>
<span id="cb320-79"><a href="manipulate-and-summarize-dataframes.html#cb320-79" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 56</span></span>
<span id="cb320-80"><a href="manipulate-and-summarize-dataframes.html#cb320-80" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 56</span></span>
<span id="cb320-81"><a href="manipulate-and-summarize-dataframes.html#cb320-81" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 55.5</span></span>
<span id="cb320-82"><a href="manipulate-and-summarize-dataframes.html#cb320-82" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 49.5</span></span>
<span id="cb320-83"><a href="manipulate-and-summarize-dataframes.html#cb320-83" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 48.5</span></span>
<span id="cb320-84"><a href="manipulate-and-summarize-dataframes.html#cb320-84" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 47.5</span></span>
<span id="cb320-85"><a href="manipulate-and-summarize-dataframes.html#cb320-85" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 44.5</span></span>
<span id="cb320-86"><a href="manipulate-and-summarize-dataframes.html#cb320-86" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 34.5</span></span>
<span id="cb320-87"><a href="manipulate-and-summarize-dataframes.html#cb320-87" tabindex="-1"></a><span class="st"> &#39;MP&#39;, &#39;MP&#39;, 2, 29.5</span></span>
<span id="cb320-88"><a href="manipulate-and-summarize-dataframes.html#cb320-88" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 103</span></span>
<span id="cb320-89"><a href="manipulate-and-summarize-dataframes.html#cb320-89" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 103</span></span>
<span id="cb320-90"><a href="manipulate-and-summarize-dataframes.html#cb320-90" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 101</span></span>
<span id="cb320-91"><a href="manipulate-and-summarize-dataframes.html#cb320-91" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 96.5</span></span>
<span id="cb320-92"><a href="manipulate-and-summarize-dataframes.html#cb320-92" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 93.5</span></span>
<span id="cb320-93"><a href="manipulate-and-summarize-dataframes.html#cb320-93" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 93</span></span>
<span id="cb320-94"><a href="manipulate-and-summarize-dataframes.html#cb320-94" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 93</span></span>
<span id="cb320-95"><a href="manipulate-and-summarize-dataframes.html#cb320-95" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 92</span></span>
<span id="cb320-96"><a href="manipulate-and-summarize-dataframes.html#cb320-96" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 90</span></span>
<span id="cb320-97"><a href="manipulate-and-summarize-dataframes.html#cb320-97" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 90</span></span>
<span id="cb320-98"><a href="manipulate-and-summarize-dataframes.html#cb320-98" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 89</span></span>
<span id="cb320-99"><a href="manipulate-and-summarize-dataframes.html#cb320-99" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 86.5</span></span>
<span id="cb320-100"><a href="manipulate-and-summarize-dataframes.html#cb320-100" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 84.5</span></span>
<span id="cb320-101"><a href="manipulate-and-summarize-dataframes.html#cb320-101" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 83</span></span>
<span id="cb320-102"><a href="manipulate-and-summarize-dataframes.html#cb320-102" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 83</span></span>
<span id="cb320-103"><a href="manipulate-and-summarize-dataframes.html#cb320-103" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 82</span></span>
<span id="cb320-104"><a href="manipulate-and-summarize-dataframes.html#cb320-104" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 78</span></span>
<span id="cb320-105"><a href="manipulate-and-summarize-dataframes.html#cb320-105" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 75</span></span>
<span id="cb320-106"><a href="manipulate-and-summarize-dataframes.html#cb320-106" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 74.5</span></span>
<span id="cb320-107"><a href="manipulate-and-summarize-dataframes.html#cb320-107" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 70</span></span>
<span id="cb320-108"><a href="manipulate-and-summarize-dataframes.html#cb320-108" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 54.5</span></span>
<span id="cb320-109"><a href="manipulate-and-summarize-dataframes.html#cb320-109" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 52</span></span>
<span id="cb320-110"><a href="manipulate-and-summarize-dataframes.html#cb320-110" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 50</span></span>
<span id="cb320-111"><a href="manipulate-and-summarize-dataframes.html#cb320-111" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 42</span></span>
<span id="cb320-112"><a href="manipulate-and-summarize-dataframes.html#cb320-112" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 36.5</span></span>
<span id="cb320-113"><a href="manipulate-and-summarize-dataframes.html#cb320-113" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 28</span></span>
<span id="cb320-114"><a href="manipulate-and-summarize-dataframes.html#cb320-114" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 26</span></span>
<span id="cb320-115"><a href="manipulate-and-summarize-dataframes.html#cb320-115" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;MP&#39;, 3, 11</span></span>
<span id="cb320-116"><a href="manipulate-and-summarize-dataframes.html#cb320-116" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 103</span></span>
<span id="cb320-117"><a href="manipulate-and-summarize-dataframes.html#cb320-117" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 103</span></span>
<span id="cb320-118"><a href="manipulate-and-summarize-dataframes.html#cb320-118" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 102</span></span>
<span id="cb320-119"><a href="manipulate-and-summarize-dataframes.html#cb320-119" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 102</span></span>
<span id="cb320-120"><a href="manipulate-and-summarize-dataframes.html#cb320-120" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 101</span></span>
<span id="cb320-121"><a href="manipulate-and-summarize-dataframes.html#cb320-121" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 100</span></span>
<span id="cb320-122"><a href="manipulate-and-summarize-dataframes.html#cb320-122" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 98</span></span>
<span id="cb320-123"><a href="manipulate-and-summarize-dataframes.html#cb320-123" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 98</span></span>
<span id="cb320-124"><a href="manipulate-and-summarize-dataframes.html#cb320-124" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 98</span></span>
<span id="cb320-125"><a href="manipulate-and-summarize-dataframes.html#cb320-125" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 95</span></span>
<span id="cb320-126"><a href="manipulate-and-summarize-dataframes.html#cb320-126" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 95</span></span>
<span id="cb320-127"><a href="manipulate-and-summarize-dataframes.html#cb320-127" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 92.5</span></span>
<span id="cb320-128"><a href="manipulate-and-summarize-dataframes.html#cb320-128" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 92</span></span>
<span id="cb320-129"><a href="manipulate-and-summarize-dataframes.html#cb320-129" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 91</span></span>
<span id="cb320-130"><a href="manipulate-and-summarize-dataframes.html#cb320-130" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 90</span></span>
<span id="cb320-131"><a href="manipulate-and-summarize-dataframes.html#cb320-131" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 85.5</span></span>
<span id="cb320-132"><a href="manipulate-and-summarize-dataframes.html#cb320-132" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 84</span></span>
<span id="cb320-133"><a href="manipulate-and-summarize-dataframes.html#cb320-133" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 82.5</span></span>
<span id="cb320-134"><a href="manipulate-and-summarize-dataframes.html#cb320-134" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 81</span></span>
<span id="cb320-135"><a href="manipulate-and-summarize-dataframes.html#cb320-135" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 77.5</span></span>
<span id="cb320-136"><a href="manipulate-and-summarize-dataframes.html#cb320-136" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 77</span></span>
<span id="cb320-137"><a href="manipulate-and-summarize-dataframes.html#cb320-137" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 72</span></span>
<span id="cb320-138"><a href="manipulate-and-summarize-dataframes.html#cb320-138" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 71.5</span></span>
<span id="cb320-139"><a href="manipulate-and-summarize-dataframes.html#cb320-139" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 69</span></span>
<span id="cb320-140"><a href="manipulate-and-summarize-dataframes.html#cb320-140" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 68.5</span></span>
<span id="cb320-141"><a href="manipulate-and-summarize-dataframes.html#cb320-141" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 68</span></span>
<span id="cb320-142"><a href="manipulate-and-summarize-dataframes.html#cb320-142" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 67</span></span>
<span id="cb320-143"><a href="manipulate-and-summarize-dataframes.html#cb320-143" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 65.5</span></span>
<span id="cb320-144"><a href="manipulate-and-summarize-dataframes.html#cb320-144" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 62.5</span></span>
<span id="cb320-145"><a href="manipulate-and-summarize-dataframes.html#cb320-145" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 62</span></span>
<span id="cb320-146"><a href="manipulate-and-summarize-dataframes.html#cb320-146" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 61.5</span></span>
<span id="cb320-147"><a href="manipulate-and-summarize-dataframes.html#cb320-147" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 61</span></span>
<span id="cb320-148"><a href="manipulate-and-summarize-dataframes.html#cb320-148" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 57.5</span></span>
<span id="cb320-149"><a href="manipulate-and-summarize-dataframes.html#cb320-149" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 54</span></span>
<span id="cb320-150"><a href="manipulate-and-summarize-dataframes.html#cb320-150" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 52.5</span></span>
<span id="cb320-151"><a href="manipulate-and-summarize-dataframes.html#cb320-151" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 51</span></span>
<span id="cb320-152"><a href="manipulate-and-summarize-dataframes.html#cb320-152" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 50.5</span></span>
<span id="cb320-153"><a href="manipulate-and-summarize-dataframes.html#cb320-153" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 50</span></span>
<span id="cb320-154"><a href="manipulate-and-summarize-dataframes.html#cb320-154" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 49</span></span>
<span id="cb320-155"><a href="manipulate-and-summarize-dataframes.html#cb320-155" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 43</span></span>
<span id="cb320-156"><a href="manipulate-and-summarize-dataframes.html#cb320-156" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 39.5</span></span>
<span id="cb320-157"><a href="manipulate-and-summarize-dataframes.html#cb320-157" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 32.5</span></span>
<span id="cb320-158"><a href="manipulate-and-summarize-dataframes.html#cb320-158" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 25.5</span></span>
<span id="cb320-159"><a href="manipulate-and-summarize-dataframes.html#cb320-159" tabindex="-1"></a><span class="st"> &#39;CA&#39;, &#39;SN&#39;, 4, 18&quot;</span></span>
<span id="cb320-160"><a href="manipulate-and-summarize-dataframes.html#cb320-160" tabindex="-1"></a></span>
<span id="cb320-161"><a href="manipulate-and-summarize-dataframes.html#cb320-161" tabindex="-1"></a>csv_test_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="at">text=</span>txt_test_data, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb320-162"><a href="manipulate-and-summarize-dataframes.html#cb320-162" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;first_half_professor&#39;</span>,</span>
<span id="cb320-163"><a href="manipulate-and-summarize-dataframes.html#cb320-163" tabindex="-1"></a>                    <span class="st">&#39;second_half_professor&#39;</span>,</span>
<span id="cb320-164"><a href="manipulate-and-summarize-dataframes.html#cb320-164" tabindex="-1"></a>                    <span class="st">&#39;course_id&#39;</span>, <span class="st">&#39;exam_score&#39;</span>)</span>
<span id="cb320-165"><a href="manipulate-and-summarize-dataframes.html#cb320-165" tabindex="-1"></a>tb_test_data <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(csv_test_data) <span class="sc">%&gt;%</span> </span>
<span id="cb320-166"><a href="manipulate-and-summarize-dataframes.html#cb320-166" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb320-167"><a href="manipulate-and-summarize-dataframes.html#cb320-167" tabindex="-1"></a><span class="fu">summary</span>(tb_test_data)</span></code></pre></div>
<pre><code>##  first_half_professor second_half_professor   course_id       exam_score    
##  Length:157           Length:157            Min.   :1.000   Min.   :  4.00  
##  Class :character     Class :character      1st Qu.:1.000   1st Qu.: 60.00  
##  Mode  :character     Mode  :character      Median :2.000   Median : 82.00  
##                                             Mean   :2.465   Mean   : 75.08  
##                                             3rd Qu.:4.000   3rd Qu.: 94.00  
##                                             Max.   :4.000   Max.   :105.00</code></pre>
</div>
</div>
<div id="test-score-distributions" class="section level4 hasAnchor" number="2.5.1.2">
<h4><span class="header-section-number">2.5.1.2</span> Test Score Distributions<a href="manipulate-and-summarize-dataframes.html#test-score-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="histogram-1" class="section level5 hasAnchor" number="2.5.1.2.1">
<h5><span class="header-section-number">2.5.1.2.1</span> Histogram<a href="manipulate-and-summarize-dataframes.html#histogram-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="manipulate-and-summarize-dataframes.html#cb322-1" tabindex="-1"></a><span class="fu">ggplot</span>(tb_final_twovar, <span class="fu">aes</span>(<span class="at">x=</span>ar_test_scores_ec3)) <span class="sc">+</span></span>
<span id="cb322-2"><a href="manipulate-and-summarize-dataframes.html#cb322-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb322-3"><a href="manipulate-and-summarize-dataframes.html#cb322-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Sandbox: Final Distribution (Econ 2370, FW)&#39;</span>),</span>
<span id="cb322-4"><a href="manipulate-and-summarize-dataframes.html#cb322-4" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&#39;FW Section, formula:&#39;</span>,</span>
<span id="cb322-5"><a href="manipulate-and-summarize-dataframes.html#cb322-5" tabindex="-1"></a>                        <span class="st">&#39;0.3*exam1Perc + 0.3*exam2Perc + &#39;</span>,</span>
<span id="cb322-6"><a href="manipulate-and-summarize-dataframes.html#cb322-6" tabindex="-1"></a>                        <span class="st">&#39;0.42*HWtotalPerc + 0.03*AttendancePerc </span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb322-7"><a href="manipulate-and-summarize-dataframes.html#cb322-7" tabindex="-1"></a>                        <span class="st">&#39;+ perfect attendance + 0.03 per Extra Credit&#39;</span>)) <span class="sc">+</span></span>
<span id="cb322-8"><a href="manipulate-and-summarize-dataframes.html#cb322-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-154-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="manipulate-and-summarize-dataframes.html#cb323-1" tabindex="-1"></a><span class="fu">ggplot</span>(tb_test_data, <span class="fu">aes</span>(<span class="at">x=</span>exam_score)) <span class="sc">+</span></span>
<span id="cb323-2"><a href="manipulate-and-summarize-dataframes.html#cb323-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb323-3"><a href="manipulate-and-summarize-dataframes.html#cb323-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Exam Distribution&#39;</span>),</span>
<span id="cb323-4"><a href="manipulate-and-summarize-dataframes.html#cb323-4" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;All Sections&#39;</span>) <span class="sc">+</span></span>
<span id="cb323-5"><a href="manipulate-and-summarize-dataframes.html#cb323-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-155-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
<div id="summarize-multiple-variables" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Summarize Multiple Variables<a href="manipulate-and-summarize-dataframes.html#summarize-multiple-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="apply-function-over-multiple-columns-and-rows" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Apply Function Over Multiple Columns and Rows<a href="manipulate-and-summarize-dataframes.html#apply-function-over-multiple-columns-and-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="convert-subset-of-variables-to-numeric" class="section level4 hasAnchor" number="2.6.1.1">
<h4><span class="header-section-number">2.6.1.1</span> Convert Subset of Variables to Numeric<a href="manipulate-and-summarize-dataframes.html#convert-subset-of-variables-to-numeric" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Multiply a subset of variables all by 10. We use dplyr’s <a href="https://dplyr.tidyverse.org/reference/across.html">across</a> function to achieve this.</p>
<p>Note that in the example below, we also use <a href="https://dplyr.tidyverse.org/reference/across.html">across</a> with group by to include a string array of grouping by variables.</p>
<p>Note: “across() makes it easy to apply the same transformation to multiple columns, allowing you to use select() semantics inside in”data-masking” functions like summarise() and mutate().”</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="manipulate-and-summarize-dataframes.html#cb324-1" tabindex="-1"></a><span class="co"># grouping by variables</span></span>
<span id="cb324-2"><a href="manipulate-and-summarize-dataframes.html#cb324-2" tabindex="-1"></a>ar_st_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gear&quot;</span>, <span class="st">&quot;carb&quot;</span>)</span>
<span id="cb324-3"><a href="manipulate-and-summarize-dataframes.html#cb324-3" tabindex="-1"></a><span class="co"># use across to conduct operation over multiple variables</span></span>
<span id="cb324-4"><a href="manipulate-and-summarize-dataframes.html#cb324-4" tabindex="-1"></a>mtcars_3var_times10 <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb324-5"><a href="manipulate-and-summarize-dataframes.html#cb324-5" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">one_of</span>(ar_st_groups))) <span class="sc">%&gt;%</span></span>
<span id="cb324-6"><a href="manipulate-and-summarize-dataframes.html#cb324-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">matches</span>(<span class="st">&quot;mpg|cyl|disp&quot;</span>), <span class="sc">~</span> .x <span class="sc">*</span> <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb324-7"><a href="manipulate-and-summarize-dataframes.html#cb324-7" tabindex="-1"></a>  <span class="fu">select</span>(gear, carb, mpg, cyl, disp) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb324-8"><a href="manipulate-and-summarize-dataframes.html#cb324-8" tabindex="-1"></a><span class="co"># pring</span></span>
<span id="cb324-9"><a href="manipulate-and-summarize-dataframes.html#cb324-9" tabindex="-1"></a><span class="co"># Multiply several variables by 10</span></span>
<span id="cb324-10"><a href="manipulate-and-summarize-dataframes.html#cb324-10" tabindex="-1"></a><span class="fu">kable</span>(mtcars_3var_times10 <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb324-11"><a href="manipulate-and-summarize-dataframes.html#cb324-11" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
carb
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mpg
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cyl
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
disp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
214
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
2580
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
3600
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
228
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1080
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
1600
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
1600
</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-row-specific-quantiles-using-data-across-columns" class="section level4 hasAnchor" number="2.6.1.2">
<h4><span class="header-section-number">2.6.1.2</span> Compute Row-specific Quantiles using Data Across Columns<a href="manipulate-and-summarize-dataframes.html#compute-row-specific-quantiles-using-data-across-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We want to compute quantiles for each location, based on monthly variations in columns.</p>
<p>First, we generate a table with 12 columns (for months) and 3 rows (for locations).</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="manipulate-and-summarize-dataframes.html#cb325-1" tabindex="-1"></a><span class="co"># Generate data, 12 months as columns, and </span></span>
<span id="cb325-2"><a href="manipulate-and-summarize-dataframes.html#cb325-2" tabindex="-1"></a>mt_data_rand <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">36</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">12</span>)</span>
<span id="cb325-3"><a href="manipulate-and-summarize-dataframes.html#cb325-3" tabindex="-1"></a>it_rows <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mt_data_rand)[<span class="dv">1</span>])</span>
<span id="cb325-4"><a href="manipulate-and-summarize-dataframes.html#cb325-4" tabindex="-1"></a>it_cols <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mt_data_rand)[<span class="dv">2</span>])</span>
<span id="cb325-5"><a href="manipulate-and-summarize-dataframes.html#cb325-5" tabindex="-1"></a><span class="co"># convert to table, column as month with leading 0</span></span>
<span id="cb325-6"><a href="manipulate-and-summarize-dataframes.html#cb325-6" tabindex="-1"></a><span class="fu">colnames</span>(mt_data_rand) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;m&#39;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, it_cols))</span>
<span id="cb325-7"><a href="manipulate-and-summarize-dataframes.html#cb325-7" tabindex="-1"></a>tb_data_full <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_data_rand, <span class="at">rownames =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb325-8"><a href="manipulate-and-summarize-dataframes.html#cb325-8" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">loc =</span> <span class="fu">paste0</span>(<span class="st">&quot;loc&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%02d&quot;</span>, <span class="fu">row_number</span>()))) <span class="sc">%&gt;%</span></span>
<span id="cb325-9"><a href="manipulate-and-summarize-dataframes.html#cb325-9" tabindex="-1"></a>    <span class="fu">select</span>(loc, <span class="fu">everything</span>())</span>
<span id="cb325-10"><a href="manipulate-and-summarize-dataframes.html#cb325-10" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb325-11"><a href="manipulate-and-summarize-dataframes.html#cb325-11" tabindex="-1"></a><span class="fu">kable</span>(tb_data_full) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()  </span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
loc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m01
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m02
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m03
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m04
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m05
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m06
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m07
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m08
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m09
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m11
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
m12
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
loc01
</td>
<td style="text-align:right;">
1.2240818
</td>
<td style="text-align:right;">
0.1106827
</td>
<td style="text-align:right;">
0.4978505
</td>
<td style="text-align:right;">
-0.4727914
</td>
<td style="text-align:right;">
-1.0260044
</td>
<td style="text-align:right;">
-1.6866933
</td>
<td style="text-align:right;">
-1.1381369
</td>
<td style="text-align:right;">
-0.2950715
</td>
<td style="text-align:right;">
0.8215811
</td>
<td style="text-align:right;">
-0.0619117
</td>
<td style="text-align:right;">
-0.6947070
</td>
<td style="text-align:right;">
2.168956
</td>
</tr>
<tr>
<td style="text-align:left;">
loc02
</td>
<td style="text-align:right;">
0.3598138
</td>
<td style="text-align:right;">
-0.5558411
</td>
<td style="text-align:right;">
-1.9666172
</td>
<td style="text-align:right;">
-1.0678237
</td>
<td style="text-align:right;">
-0.7288912
</td>
<td style="text-align:right;">
0.8377870
</td>
<td style="text-align:right;">
1.2538149
</td>
<td style="text-align:right;">
0.8951257
</td>
<td style="text-align:right;">
0.6886403
</td>
<td style="text-align:right;">
-0.3059627
</td>
<td style="text-align:right;">
-0.2079173
</td>
<td style="text-align:right;">
1.207962
</td>
</tr>
<tr>
<td style="text-align:left;">
loc03
</td>
<td style="text-align:right;">
0.4007715
</td>
<td style="text-align:right;">
1.7869131
</td>
<td style="text-align:right;">
0.7013559
</td>
<td style="text-align:right;">
-0.2179749
</td>
<td style="text-align:right;">
-0.6250393
</td>
<td style="text-align:right;">
0.1533731
</td>
<td style="text-align:right;">
0.4264642
</td>
<td style="text-align:right;">
0.8781335
</td>
<td style="text-align:right;">
0.5539177
</td>
<td style="text-align:right;">
-0.3804710
</td>
<td style="text-align:right;">
-1.2653964
</td>
<td style="text-align:right;">
-1.123109
</td>
</tr>
</tbody>
</table>
</div>
<p>Second, using apply to compute quantiles, row by row</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="manipulate-and-summarize-dataframes.html#cb326-1" tabindex="-1"></a><span class="co"># Extract the data components from the tibble, tibble has row and column names</span></span>
<span id="cb326-2"><a href="manipulate-and-summarize-dataframes.html#cb326-2" tabindex="-1"></a>tb_data_only <span class="ot">&lt;-</span> tb_data_full <span class="sc">%&gt;%</span> </span>
<span id="cb326-3"><a href="manipulate-and-summarize-dataframes.html#cb326-3" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">&quot;loc&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb326-4"><a href="manipulate-and-summarize-dataframes.html#cb326-4" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;m&quot;</span>))</span>
<span id="cb326-5"><a href="manipulate-and-summarize-dataframes.html#cb326-5" tabindex="-1"></a><span class="co"># Compute row specific quantiles</span></span>
<span id="cb326-6"><a href="manipulate-and-summarize-dataframes.html#cb326-6" tabindex="-1"></a>ar_quantiles_by_row <span class="ot">&lt;-</span> <span class="fu">apply</span>(tb_data_only, <span class="dv">1</span>, quantile, <span class="at">probs=</span><span class="fl">0.75</span>)</span>
<span id="cb326-7"><a href="manipulate-and-summarize-dataframes.html#cb326-7" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb326-8"><a href="manipulate-and-summarize-dataframes.html#cb326-8" tabindex="-1"></a><span class="fu">print</span>(ar_quantiles_by_row)</span></code></pre></div>
<pre><code>##     loc01     loc02     loc03 
## 0.5787831 0.8521217 0.5907772</code></pre>
<p>Third, generate matrix of two columns, ID and quantile.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="manipulate-and-summarize-dataframes.html#cb328-1" tabindex="-1"></a><span class="co"># One particular quantil from location</span></span>
<span id="cb328-2"><a href="manipulate-and-summarize-dataframes.html#cb328-2" tabindex="-1"></a>tb_loc_quantile <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ar_quantiles_by_row) <span class="sc">%&gt;%</span> </span>
<span id="cb328-3"><a href="manipulate-and-summarize-dataframes.html#cb328-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">loc =</span> <span class="fu">names</span>(ar_quantiles_by_row)) <span class="sc">%&gt;%</span></span>
<span id="cb328-4"><a href="manipulate-and-summarize-dataframes.html#cb328-4" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">quantile =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb328-5"><a href="manipulate-and-summarize-dataframes.html#cb328-5" tabindex="-1"></a>    <span class="fu">select</span>(loc, <span class="fu">everything</span>())</span>
<span id="cb328-6"><a href="manipulate-and-summarize-dataframes.html#cb328-6" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb328-7"><a href="manipulate-and-summarize-dataframes.html#cb328-7" tabindex="-1"></a><span class="fu">kable</span>(tb_loc_quantile) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()  </span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
loc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
quantile
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
loc01
</td>
<td style="text-align:right;">
0.5787831
</td>
</tr>
<tr>
<td style="text-align:left;">
loc02
</td>
<td style="text-align:right;">
0.8521217
</td>
</tr>
<tr>
<td style="text-align:left;">
loc03
</td>
<td style="text-align:right;">
0.5907772
</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-row-specific-sums-using-data-across-columns" class="section level4 hasAnchor" number="2.6.1.3">
<h4><span class="header-section-number">2.6.1.3</span> Compute Row-specific Sums using Data Across Columns<a href="manipulate-and-summarize-dataframes.html#compute-row-specific-sums-using-data-across-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We compute sum over several variables in the mtcars dataset. We will sum over several variables with shared prefix, after adding these prefix first. We introduce an NA value to make sure that we can sum ignoring NA</p>
<p>We sum using three different methods below: (1) <a href="https://purrr.tidyverse.org/reference/reduce.html">purrr:reduce()</a>, (2) <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/colSums">base::rowSums()</a>, (3) Manual sum. Note that the rowSums option is able to sum ignoring NA.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="manipulate-and-summarize-dataframes.html#cb329-1" tabindex="-1"></a><span class="co"># we introduce NA value to first row</span></span>
<span id="cb329-2"><a href="manipulate-and-summarize-dataframes.html#cb329-2" tabindex="-1"></a>mtcars[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb329-3"><a href="manipulate-and-summarize-dataframes.html#cb329-3" tabindex="-1"></a><span class="co"># Rename variables, and sum across</span></span>
<span id="cb329-4"><a href="manipulate-and-summarize-dataframes.html#cb329-4" tabindex="-1"></a>mtcars_rowsum <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb329-5"><a href="manipulate-and-summarize-dataframes.html#cb329-5" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">stats_mpg =</span> mpg, <span class="at">stats_cyl =</span> cyl, <span class="at">stats_hp =</span> hp) <span class="sc">%&gt;%</span></span>
<span id="cb329-6"><a href="manipulate-and-summarize-dataframes.html#cb329-6" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb329-7"><a href="manipulate-and-summarize-dataframes.html#cb329-7" tabindex="-1"></a>        <span class="at">cs_reduce =</span> purrr<span class="sc">::</span><span class="fu">reduce</span>(</span>
<span id="cb329-8"><a href="manipulate-and-summarize-dataframes.html#cb329-8" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">pick</span>(<span class="fu">contains</span>(<span class="st">&quot;stats&quot;</span>)),</span>
<span id="cb329-9"><a href="manipulate-and-summarize-dataframes.html#cb329-9" tabindex="-1"></a>            <span class="st">`</span><span class="at">+</span><span class="st">`</span></span>
<span id="cb329-10"><a href="manipulate-and-summarize-dataframes.html#cb329-10" tabindex="-1"></a>        ),</span>
<span id="cb329-11"><a href="manipulate-and-summarize-dataframes.html#cb329-11" tabindex="-1"></a>        <span class="at">cs_rowsum =</span> base<span class="sc">::</span><span class="fu">rowSums</span>(</span>
<span id="cb329-12"><a href="manipulate-and-summarize-dataframes.html#cb329-12" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">pick</span>(<span class="fu">contains</span>(<span class="st">&quot;stats&quot;</span>)),</span>
<span id="cb329-13"><a href="manipulate-and-summarize-dataframes.html#cb329-13" tabindex="-1"></a>            <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb329-14"><a href="manipulate-and-summarize-dataframes.html#cb329-14" tabindex="-1"></a>        ),</span>
<span id="cb329-15"><a href="manipulate-and-summarize-dataframes.html#cb329-15" tabindex="-1"></a>        <span class="at">cs_manual =</span> stats_mpg <span class="sc">+</span> stats_cyl <span class="sc">+</span> stats_hp</span>
<span id="cb329-16"><a href="manipulate-and-summarize-dataframes.html#cb329-16" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb329-17"><a href="manipulate-and-summarize-dataframes.html#cb329-17" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">&quot;stats|cs&quot;</span>), gear)</span>
<span id="cb329-18"><a href="manipulate-and-summarize-dataframes.html#cb329-18" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb329-19"><a href="manipulate-and-summarize-dataframes.html#cb329-19" tabindex="-1"></a><span class="co"># caption: &quot;sum across columns&quot;</span></span>
<span id="cb329-20"><a href="manipulate-and-summarize-dataframes.html#cb329-20" tabindex="-1"></a><span class="fu">kable</span>(mtcars_rowsum <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
stats_mpg
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
stats_cyl
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
stats_hp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cs_reduce
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cs_rowsum
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cs_manual
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
116.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
137.0
</td>
<td style="text-align:right;">
137.0
</td>
<td style="text-align:right;">
137.0
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
119.8
</td>
<td style="text-align:right;">
119.8
</td>
<td style="text-align:right;">
119.8
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
137.4
</td>
<td style="text-align:right;">
137.4
</td>
<td style="text-align:right;">
137.4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
201.7
</td>
<td style="text-align:right;">
201.7
</td>
<td style="text-align:right;">
201.7
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
</div>
<p>See <a href="https://stackoverflow.com/a/72069394/8280804">this</a> discussion for column sum peed comparisons.</p>
</div>
<div id="sum-across-rows-within-group" class="section level4 hasAnchor" number="2.6.1.4">
<h4><span class="header-section-number">2.6.1.4</span> Sum Across Rows within Group<a href="manipulate-and-summarize-dataframes.html#sum-across-rows-within-group" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Following from the prior section, we now sum across rows within group.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="manipulate-and-summarize-dataframes.html#cb330-1" tabindex="-1"></a><span class="co"># we introduce NA value to first row</span></span>
<span id="cb330-2"><a href="manipulate-and-summarize-dataframes.html#cb330-2" tabindex="-1"></a><span class="co"># mtcars[1,1] &lt;- NA</span></span>
<span id="cb330-3"><a href="manipulate-and-summarize-dataframes.html#cb330-3" tabindex="-1"></a><span class="co"># Rename variables, and sum across</span></span>
<span id="cb330-4"><a href="manipulate-and-summarize-dataframes.html#cb330-4" tabindex="-1"></a>mtcars_grpsum <span class="ot">&lt;-</span> mtcars_rowsum <span class="sc">%&gt;%</span>  </span>
<span id="cb330-5"><a href="manipulate-and-summarize-dataframes.html#cb330-5" tabindex="-1"></a>    <span class="fu">arrange</span>(gear) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb330-6"><a href="manipulate-and-summarize-dataframes.html#cb330-6" tabindex="-1"></a>    <span class="co"># srs = sum row sum</span></span>
<span id="cb330-7"><a href="manipulate-and-summarize-dataframes.html#cb330-7" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">matches</span>(<span class="st">&quot;stats|cs&quot;</span>)), </span>
<span id="cb330-8"><a href="manipulate-and-summarize-dataframes.html#cb330-8" tabindex="-1"></a>        <span class="at">.funs =</span> <span class="fu">list</span>(<span class="at">gs =</span> <span class="sc">~</span><span class="fu">sum</span>(., <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb330-9"><a href="manipulate-and-summarize-dataframes.html#cb330-9" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb330-10"><a href="manipulate-and-summarize-dataframes.html#cb330-10" tabindex="-1"></a>    <span class="fu">select</span>(gear, <span class="fu">matches</span>(<span class="st">&quot;gs&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb330-11"><a href="manipulate-and-summarize-dataframes.html#cb330-11" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">1</span>)</span>
<span id="cb330-12"><a href="manipulate-and-summarize-dataframes.html#cb330-12" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb330-13"><a href="manipulate-and-summarize-dataframes.html#cb330-13" tabindex="-1"></a><span class="co"># caption: &quot;gs = group sum, cs = col sum over the columns </span></span>
<span id="cb330-14"><a href="manipulate-and-summarize-dataframes.html#cb330-14" tabindex="-1"></a><span class="co"># with stats as prefix, sum across rows after col sum; gear = 4 </span></span>
<span id="cb330-15"><a href="manipulate-and-summarize-dataframes.html#cb330-15" tabindex="-1"></a><span class="co"># difference for cs-rowsum-gs because it allowed for summing </span></span>
<span id="cb330-16"><a href="manipulate-and-summarize-dataframes.html#cb330-16" tabindex="-1"></a><span class="co"># ignoring NA for values across columns&quot;</span></span>
<span id="cb330-17"><a href="manipulate-and-summarize-dataframes.html#cb330-17" tabindex="-1"></a><span class="fu">kable</span>(mtcars_grpsum) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gear
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
stats_mpg_gs
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
stats_cyl_gs
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
stats_hp_gs
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cs_reduce_gs
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cs_rowsum_gs
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cs_manual_gs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
241.6
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
2642
</td>
<td style="text-align:right;">
2995.6
</td>
<td style="text-align:right;">
2995.6
</td>
<td style="text-align:right;">
2995.6
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
273.4
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
1074
</td>
<td style="text-align:right;">
1287.4
</td>
<td style="text-align:right;">
1403.4
</td>
<td style="text-align:right;">
1287.4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
106.9
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
978
</td>
<td style="text-align:right;">
1114.9
</td>
<td style="text-align:right;">
1114.9
</td>
<td style="text-align:right;">
1114.9
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="replace-na-for-multiple-variables" class="section level4 hasAnchor" number="2.6.1.5">
<h4><span class="header-section-number">2.6.1.5</span> Replace NA for Multiple Variables<a href="manipulate-and-summarize-dataframes.html#replace-na-for-multiple-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Replace some variables NA by some values, and other variables’ NAs by other values.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="manipulate-and-summarize-dataframes.html#cb331-1" tabindex="-1"></a><span class="co"># Define</span></span>
<span id="cb331-2"><a href="manipulate-and-summarize-dataframes.html#cb331-2" tabindex="-1"></a>it_N <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb331-3"><a href="manipulate-and-summarize-dataframes.html#cb331-3" tabindex="-1"></a>it_M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb331-4"><a href="manipulate-and-summarize-dataframes.html#cb331-4" tabindex="-1"></a>svr_id <span class="ot">&lt;-</span> <span class="st">&quot;date&quot;</span></span>
<span id="cb331-5"><a href="manipulate-and-summarize-dataframes.html#cb331-5" tabindex="-1"></a></span>
<span id="cb331-6"><a href="manipulate-and-summarize-dataframes.html#cb331-6" tabindex="-1"></a><span class="co"># NA dataframe, note need to define as NA_real_</span></span>
<span id="cb331-7"><a href="manipulate-and-summarize-dataframes.html#cb331-7" tabindex="-1"></a><span class="co"># if define as NA, will not be able to replace with 99 column</span></span>
<span id="cb331-8"><a href="manipulate-and-summarize-dataframes.html#cb331-8" tabindex="-1"></a><span class="co"># would be logical rather than double.</span></span>
<span id="cb331-9"><a href="manipulate-and-summarize-dataframes.html#cb331-9" tabindex="-1"></a>df_NA <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">matrix</span>(<span class="cn">NA_real_</span>, <span class="at">nrow =</span> it_N, <span class="at">ncol =</span> it_M)) <span class="sc">%&gt;%</span></span>
<span id="cb331-10"><a href="manipulate-and-summarize-dataframes.html#cb331-10" tabindex="-1"></a>    <span class="fu">rowid_to_column</span>(<span class="at">var =</span> svr_id) <span class="sc">%&gt;%</span></span>
<span id="cb331-11"><a href="manipulate-and-summarize-dataframes.html#cb331-11" tabindex="-1"></a>    <span class="fu">rename_at</span>(</span>
<span id="cb331-12"><a href="manipulate-and-summarize-dataframes.html#cb331-12" tabindex="-1"></a>        <span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;V&quot;</span>)),</span>
<span id="cb331-13"><a href="manipulate-and-summarize-dataframes.html#cb331-13" tabindex="-1"></a>        <span class="fu">funs</span>(<span class="fu">str_replace</span>(., <span class="st">&quot;V&quot;</span>, <span class="st">&quot;var&quot;</span>))</span>
<span id="cb331-14"><a href="manipulate-and-summarize-dataframes.html#cb331-14" tabindex="-1"></a>    )</span>
<span id="cb331-15"><a href="manipulate-and-summarize-dataframes.html#cb331-15" tabindex="-1"></a><span class="fu">kable</span>(df_NA) <span class="sc">%&gt;%</span></span>
<span id="cb331-16"><a href="manipulate-and-summarize-dataframes.html#cb331-16" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="manipulate-and-summarize-dataframes.html#cb332-1" tabindex="-1"></a><span class="co"># Replace NA</span></span>
<span id="cb332-2"><a href="manipulate-and-summarize-dataframes.html#cb332-2" tabindex="-1"></a>df_NA_replace <span class="ot">&lt;-</span> df_NA <span class="sc">%&gt;%</span></span>
<span id="cb332-3"><a href="manipulate-and-summarize-dataframes.html#cb332-3" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">one_of</span>(<span class="fu">c</span>(<span class="st">&quot;var1&quot;</span>, <span class="st">&quot;var2&quot;</span>))), <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb332-4"><a href="manipulate-and-summarize-dataframes.html#cb332-4" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">one_of</span>(<span class="fu">c</span>(<span class="st">&quot;var3&quot;</span>, <span class="st">&quot;var5&quot;</span>))), <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">99</span>)))</span>
<span id="cb332-5"><a href="manipulate-and-summarize-dataframes.html#cb332-5" tabindex="-1"></a></span>
<span id="cb332-6"><a href="manipulate-and-summarize-dataframes.html#cb332-6" tabindex="-1"></a><span class="fu">kable</span>(df_NA_replace) <span class="sc">%&gt;%</span></span>
<span id="cb332-7"><a href="manipulate-and-summarize-dataframes.html#cb332-7" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
var5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
99
</td>
</tr>
</tbody>
</table>
</div>
<div id="cumulative-sum-multiple-variables" class="section level4 hasAnchor" number="2.6.1.6">
<h4><span class="header-section-number">2.6.1.6</span> Cumulative Sum Multiple Variables<a href="manipulate-and-summarize-dataframes.html#cumulative-sum-multiple-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Each row is a different date, each column is the profit a firms earns on a date, we want to compute cumulatively how much a person is earning. Also renames variable names below jointly.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="manipulate-and-summarize-dataframes.html#cb333-1" tabindex="-1"></a><span class="co"># Define</span></span>
<span id="cb333-2"><a href="manipulate-and-summarize-dataframes.html#cb333-2" tabindex="-1"></a>it_N <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb333-3"><a href="manipulate-and-summarize-dataframes.html#cb333-3" tabindex="-1"></a>it_M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb333-4"><a href="manipulate-and-summarize-dataframes.html#cb333-4" tabindex="-1"></a>svr_id <span class="ot">&lt;-</span> <span class="st">&quot;date&quot;</span></span>
<span id="cb333-5"><a href="manipulate-and-summarize-dataframes.html#cb333-5" tabindex="-1"></a></span>
<span id="cb333-6"><a href="manipulate-and-summarize-dataframes.html#cb333-6" tabindex="-1"></a><span class="co"># random dataframe, daily profit of firms</span></span>
<span id="cb333-7"><a href="manipulate-and-summarize-dataframes.html#cb333-7" tabindex="-1"></a><span class="co"># dp_fx: daily profit firm ID something</span></span>
<span id="cb333-8"><a href="manipulate-and-summarize-dataframes.html#cb333-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb333-9"><a href="manipulate-and-summarize-dataframes.html#cb333-9" tabindex="-1"></a>df_daily_profit <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(it_N <span class="sc">*</span> it_M), <span class="at">nrow =</span> it_N, <span class="at">ncol =</span> it_M)) <span class="sc">%&gt;%</span></span>
<span id="cb333-10"><a href="manipulate-and-summarize-dataframes.html#cb333-10" tabindex="-1"></a>    <span class="fu">rowid_to_column</span>(<span class="at">var =</span> svr_id) <span class="sc">%&gt;%</span></span>
<span id="cb333-11"><a href="manipulate-and-summarize-dataframes.html#cb333-11" tabindex="-1"></a>    <span class="fu">rename_at</span>(</span>
<span id="cb333-12"><a href="manipulate-and-summarize-dataframes.html#cb333-12" tabindex="-1"></a>        <span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;V&quot;</span>)),</span>
<span id="cb333-13"><a href="manipulate-and-summarize-dataframes.html#cb333-13" tabindex="-1"></a>        <span class="fu">funs</span>(<span class="fu">str_replace</span>(., <span class="st">&quot;V&quot;</span>, <span class="st">&quot;dp_f&quot;</span>))</span>
<span id="cb333-14"><a href="manipulate-and-summarize-dataframes.html#cb333-14" tabindex="-1"></a>    )</span>
<span id="cb333-15"><a href="manipulate-and-summarize-dataframes.html#cb333-15" tabindex="-1"></a><span class="fu">kable</span>(df_daily_profit) <span class="sc">%&gt;%</span></span>
<span id="cb333-16"><a href="manipulate-and-summarize-dataframes.html#cb333-16" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5604756
</td>
<td style="text-align:right;">
0.0705084
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
-0.4456620
</td>
<td style="text-align:right;">
0.4007715
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.2301775
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.2240818
</td>
<td style="text-align:right;">
0.1106827
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.5587083
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-0.6868529
</td>
<td style="text-align:right;">
0.3598138
</td>
<td style="text-align:right;">
-0.5558411
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="manipulate-and-summarize-dataframes.html#cb334-1" tabindex="-1"></a><span class="co"># cumulative sum with suffix</span></span>
<span id="cb334-2"><a href="manipulate-and-summarize-dataframes.html#cb334-2" tabindex="-1"></a>df_cumu_profit_suffix <span class="ot">&lt;-</span> df_daily_profit <span class="sc">%&gt;%</span></span>
<span id="cb334-3"><a href="manipulate-and-summarize-dataframes.html#cb334-3" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(<span class="st">&quot;dp_f&quot;</span>)), <span class="at">.funs =</span> <span class="fu">list</span>(<span class="at">cumu =</span> <span class="sc">~</span> <span class="fu">cumsum</span>(.)))</span>
<span id="cb334-4"><a href="manipulate-and-summarize-dataframes.html#cb334-4" tabindex="-1"></a><span class="fu">kable</span>(df_cumu_profit_suffix) <span class="sc">%&gt;%</span></span>
<span id="cb334-5"><a href="manipulate-and-summarize-dataframes.html#cb334-5" tabindex="-1"></a>    <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f1_cumu
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f2_cumu
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f3_cumu
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f4_cumu
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f5_cumu
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5604756
</td>
<td style="text-align:right;">
0.0705084
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
-0.4456620
</td>
<td style="text-align:right;">
0.4007715
</td>
<td style="text-align:right;">
-0.5604756
</td>
<td style="text-align:right;">
0.0705084
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
-0.4456620
</td>
<td style="text-align:right;">
0.4007715
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.2301775
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.2240818
</td>
<td style="text-align:right;">
0.1106827
</td>
<td style="text-align:right;">
-0.7906531
</td>
<td style="text-align:right;">
0.1997961
</td>
<td style="text-align:right;">
-0.8041450
</td>
<td style="text-align:right;">
0.7784198
</td>
<td style="text-align:right;">
0.5114542
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.5587083
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-0.6868529
</td>
<td style="text-align:right;">
0.3598138
</td>
<td style="text-align:right;">
-0.5558411
</td>
<td style="text-align:right;">
0.7680552
</td>
<td style="text-align:right;">
1.9148611
</td>
<td style="text-align:right;">
-1.4909979
</td>
<td style="text-align:right;">
1.1382337
</td>
<td style="text-align:right;">
-0.0443870
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="manipulate-and-summarize-dataframes.html#cb335-1" tabindex="-1"></a><span class="co"># cumulative sum variables naming to prefix</span></span>
<span id="cb335-2"><a href="manipulate-and-summarize-dataframes.html#cb335-2" tabindex="-1"></a>df_cumu_profit <span class="ot">&lt;-</span> df_cumu_profit_suffix <span class="sc">%&gt;%</span></span>
<span id="cb335-3"><a href="manipulate-and-summarize-dataframes.html#cb335-3" tabindex="-1"></a>    <span class="fu">rename_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(<span class="st">&quot;_cumu&quot;</span>)), <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">paste</span>(<span class="st">&quot;cp_f&quot;</span>, <span class="fu">gsub</span>(<span class="st">&quot;_cumu&quot;</span>, <span class="st">&quot;&quot;</span>, .), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb335-4"><a href="manipulate-and-summarize-dataframes.html#cb335-4" tabindex="-1"></a>    <span class="fu">rename_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(<span class="st">&quot;cp_f&quot;</span>)), <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot;dp_f&quot;</span>, <span class="st">&quot;&quot;</span>, .)))</span>
<span id="cb335-5"><a href="manipulate-and-summarize-dataframes.html#cb335-5" tabindex="-1"></a><span class="fu">kable</span>(df_cumu_profit) <span class="sc">%&gt;%</span></span>
<span id="cb335-6"><a href="manipulate-and-summarize-dataframes.html#cb335-6" tabindex="-1"></a>    <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dp_f5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cp_f1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cp_f2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cp_f3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cp_f4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cp_f5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.5604756
</td>
<td style="text-align:right;">
0.0705084
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
-0.4456620
</td>
<td style="text-align:right;">
0.4007715
</td>
<td style="text-align:right;">
-0.5604756
</td>
<td style="text-align:right;">
0.0705084
</td>
<td style="text-align:right;">
0.4609162
</td>
<td style="text-align:right;">
-0.4456620
</td>
<td style="text-align:right;">
0.4007715
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.2301775
</td>
<td style="text-align:right;">
0.1292877
</td>
<td style="text-align:right;">
-1.2650612
</td>
<td style="text-align:right;">
1.2240818
</td>
<td style="text-align:right;">
0.1106827
</td>
<td style="text-align:right;">
-0.7906531
</td>
<td style="text-align:right;">
0.1997961
</td>
<td style="text-align:right;">
-0.8041450
</td>
<td style="text-align:right;">
0.7784198
</td>
<td style="text-align:right;">
0.5114542
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.5587083
</td>
<td style="text-align:right;">
1.7150650
</td>
<td style="text-align:right;">
-0.6868529
</td>
<td style="text-align:right;">
0.3598138
</td>
<td style="text-align:right;">
-0.5558411
</td>
<td style="text-align:right;">
0.7680552
</td>
<td style="text-align:right;">
1.9148611
</td>
<td style="text-align:right;">
-1.4909979
</td>
<td style="text-align:right;">
1.1382337
</td>
<td style="text-align:right;">
-0.0443870
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="array-matrix-dataframe.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
