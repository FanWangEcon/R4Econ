<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Statistics | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Statistics | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Statistics | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2021-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mathematics.html"/>
<link rel="next" href="tables-and-graphs.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-dataframes"><i class="fa fa-check"></i><b>1.4.5</b> String Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarize-data.html"><a href="summarize-data.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.2.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.3.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.4" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-compare"><i class="fa fa-check"></i><b>4.3</b> Join and Compare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.1</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.1</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.3</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.4</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-function"><i class="fa fa-check"></i><b>8.2</b> Production Function</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
<li class="chapter" data-level="8.3.4" data-path="mathematics.html"><a href="mathematics.html#location-population-and-pollution"><i class="fa fa-check"></i><b>8.3.4</b> Location, Population, and Pollution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
<li class="chapter" data-level="9.3.2" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-marginal-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.3.2</b> Obtaining Joint Distribution from Marginal with Rectilinear Restrictions</a></li>
<li class="chapter" data-level="9.3.3" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-conditional-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.3.3</b> Obtaining Joint Distribution from Conditional with Rectilinear Restrictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-and-development.html"><a href="code-and-development.html"><i class="fa fa-check"></i><b>12</b> Code and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="code-and-development.html"><a href="code-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.1</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="code-and-development.html"><a href="code-and-development.html#file-path"><i class="fa fa-check"></i><b>12.1.1</b> File Path</a></li>
<li class="chapter" data-level="12.1.2" data-path="code-and-development.html"><a href="code-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.1.2</b> Text to File</a></li>
<li class="chapter" data-level="12.1.3" data-path="code-and-development.html"><a href="code-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.1.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="code-and-development.html"><a href="code-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.2</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="code-and-development.html"><a href="code-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.2.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="code-and-development.html"><a href="code-and-development.html#command-line"><i class="fa fa-check"></i><b>12.3</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="code-and-development.html"><a href="code-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.3.1</b> Shell and System Commands</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate, Gather, Bind and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-join-and-comparejoin-and-compare-links"><i class="fa fa-check"></i><b>A.4.3</b> <span>Section 4.3 Join and Compare</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-polynomial-fittingpolynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 Polynomial Fitting</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> <span>Section 5.3 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Quantile Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Basics</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionproduction-function-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Production Function</span> links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> <span>Section 8.3 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 Random Draws</span> links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> <span>Section 9.2 Distributions</span> links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> <span>Section 9.3 Discrete Random Variable</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> <span>Section 10.2 ggplot Line Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> <span>Section 10.3 ggplot Scatter Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> <span>Section 10.4 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> <span>Section 11.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#code-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Code and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.1</b> <span>Section 12.1 Files In and Out</span> links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.2</b> <span>Section 12.2 Python with R</span> links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.3</b> <span>Section 12.3 Command Line</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Statistics</h1>

<div id="random-draws" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Random Draws</h2>

<div id="randomly-perturbing-a-parameter" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Randomly Perturbing a Parameter</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="perturbation-normally-with-log-normal-magnitude-scaling-value" class="section level4" number="9.1.1.1">
<h4><span class="header-section-number">9.1.1.1</span> Perturbation Normally with Log-Normal Magnitude Scaling Value</h4>
<p>During estimation, we have some starting estimation parameter value. We want to do multi-start estimation by perturbing initial starting points. The perturbing process follows the rules specified below, implemented in the function below.</p>
<ol style="list-style-type: decimal">
<li>Select from 0 to 1, 0 closest to the existing parameter value, 1 very far from it.</li>
<li>Log normal distribution with 1st quartile = 0.185, and mu of normal = 0. The value from (1) correspond to a cumulative mass point of this log normal distribution.</li>
<li>Draw a value randomly from standard normal</li>
<li>Transform the randomly drawn value to current parameter scale with inverse z-score, the resulting value is the parameter of interest.</li>
</ol>
<p>Test and implement the ideas above.</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="statistics.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 0</span></span>
<span id="cb611-2"><a href="statistics.html#cb611-2" aria-hidden="true" tabindex="-1"></a>ar_fl_original_param <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb611-3"><a href="statistics.html#cb611-3" aria-hidden="true" tabindex="-1"></a>ar_fl_original_param <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb611-4"><a href="statistics.html#cb611-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1</span></span>
<span id="cb611-5"><a href="statistics.html#cb611-5" aria-hidden="true" tabindex="-1"></a>ar_zero_to_one_select <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-3</span>, <span class="dv">1</span> <span class="sc">-</span> <span class="fl">1e-3</span>, <span class="at">length.out =</span> <span class="dv">11</span>)</span>
<span id="cb611-6"><a href="statistics.html#cb611-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2</span></span>
<span id="cb611-7"><a href="statistics.html#cb611-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume mean of normal = 0, with sdlog = 2, 25th percentile is 0.185</span></span>
<span id="cb611-8"><a href="statistics.html#cb611-8" aria-hidden="true" tabindex="-1"></a>fl_sdlog <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb611-9"><a href="statistics.html#cb611-9" aria-hidden="true" tabindex="-1"></a>fl_p25_logn <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.25</span>, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb611-10"><a href="statistics.html#cb611-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3</span></span>
<span id="cb611-11"><a href="statistics.html#cb611-11" aria-hidden="true" tabindex="-1"></a><span class="co"># random draw, for now fix at positive number, which means to &quot;randomly&quot; expand</span></span>
<span id="cb611-12"><a href="statistics.html#cb611-12" aria-hidden="true" tabindex="-1"></a>fl_draw_znorm <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb611-13"><a href="statistics.html#cb611-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4</span></span>
<span id="cb611-14"><a href="statistics.html#cb611-14" aria-hidden="true" tabindex="-1"></a>mt_collect <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb611-15"><a href="statistics.html#cb611-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="cn">NA</span>,</span>
<span id="cb611-16"><a href="statistics.html#cb611-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">length</span>(ar_zero_to_one_select),</span>
<span id="cb611-17"><a href="statistics.html#cb611-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="fu">length</span>(ar_fl_original_param)</span>
<span id="cb611-18"><a href="statistics.html#cb611-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb611-19"><a href="statistics.html#cb611-19" aria-hidden="true" tabindex="-1"></a>it_col_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb611-20"><a href="statistics.html#cb611-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (fl_original_param <span class="cf">in</span> ar_fl_original_param) {</span>
<span id="cb611-21"><a href="statistics.html#cb611-21" aria-hidden="true" tabindex="-1"></a>  it_col_ctr <span class="ot">&lt;-</span> it_col_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb611-22"><a href="statistics.html#cb611-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inverse z-score</span></span>
<span id="cb611-23"><a href="statistics.html#cb611-23" aria-hidden="true" tabindex="-1"></a>  ar_logn_coef_of_var <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="dv">1</span><span class="sc">-</span>ar_zero_to_one_select, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb611-24"><a href="statistics.html#cb611-24" aria-hidden="true" tabindex="-1"></a>  ar_logn_sd <span class="ot">&lt;-</span> fl_original_param<span class="sc">/</span>ar_logn_coef_of_var</span>
<span id="cb611-25"><a href="statistics.html#cb611-25" aria-hidden="true" tabindex="-1"></a>  ar_param_perturbed <span class="ot">&lt;-</span> fl_draw_znorm <span class="sc">*</span> ar_logn_sd <span class="sc">+</span> fl_original_param</span>
<span id="cb611-26"><a href="statistics.html#cb611-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill matrix</span></span>
<span id="cb611-27"><a href="statistics.html#cb611-27" aria-hidden="true" tabindex="-1"></a>  mt_collect[, it_col_ctr] <span class="ot">&lt;-</span> (ar_param_perturbed)</span>
<span id="cb611-28"><a href="statistics.html#cb611-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb611-29"><a href="statistics.html#cb611-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Out to table</span></span>
<span id="cb611-30"><a href="statistics.html#cb611-30" aria-hidden="true" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;zero_one_scalar&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;ori_val=&quot;</span>, ar_fl_original_param))</span>
<span id="cb611-31"><a href="statistics.html#cb611-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb611-32"><a href="statistics.html#cb611-32" aria-hidden="true" tabindex="-1"></a>tb_collect <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_zero_to_one_select, mt_collect)) <span class="sc">%&gt;%</span></span>
<span id="cb611-33"><a href="statistics.html#cb611-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb611-34"><a href="statistics.html#cb611-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb611-35"><a href="statistics.html#cb611-35" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tb_collect) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
zero_one_scalar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=-10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=-0.1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=0.1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
-10.00441
</td>
<td style="text-align:right;">
-0.1000441
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1000441
</td>
<td style="text-align:right;">
10.00441
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1008
</td>
<td style="text-align:right;">
-10.41068
</td>
<td style="text-align:right;">
-0.1041068
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1041068
</td>
<td style="text-align:right;">
10.41068
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2006
</td>
<td style="text-align:right;">
-11.22616
</td>
<td style="text-align:right;">
-0.1122616
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1122616
</td>
<td style="text-align:right;">
11.22616
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3004
</td>
<td style="text-align:right;">
-12.70326
</td>
<td style="text-align:right;">
-0.1270326
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1270326
</td>
<td style="text-align:right;">
12.70326
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4002
</td>
<td style="text-align:right;">
-15.31489
</td>
<td style="text-align:right;">
-0.1531489
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1531489
</td>
<td style="text-align:right;">
15.31489
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5000
</td>
<td style="text-align:right;">
-20.00000
</td>
<td style="text-align:right;">
-0.2000000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
20.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5998
</td>
<td style="text-align:right;">
-28.81508
</td>
<td style="text-align:right;">
-0.2881508
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2881508
</td>
<td style="text-align:right;">
28.81508
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6996
</td>
<td style="text-align:right;">
-46.99235
</td>
<td style="text-align:right;">
-0.4699235
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4699235
</td>
<td style="text-align:right;">
46.99235
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7994
</td>
<td style="text-align:right;">
-91.55561
</td>
<td style="text-align:right;">
-0.9155561
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.9155561
</td>
<td style="text-align:right;">
91.55561
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8992
</td>
<td style="text-align:right;">
-253.49612
</td>
<td style="text-align:right;">
-2.5349612
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.5349612
</td>
<td style="text-align:right;">
253.49612
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9990
</td>
<td style="text-align:right;">
-22665.67969
</td>
<td style="text-align:right;">
-226.6567969
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
226.6567969
</td>
<td style="text-align:right;">
22665.67969
</td>
</tr>
</tbody>
</table>
<p>Implement the above idea with a function.</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="statistics.html#cb612-1" aria-hidden="true" tabindex="-1"></a>ffi_param_logn_perturber <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb612-2"><a href="statistics.html#cb612-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">param_original=</span><span class="dv">5</span>, <span class="at">scaler_0t1=</span><span class="fl">0.5</span>, </span>
<span id="cb612-3"><a href="statistics.html#cb612-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">it_rand_seed=</span><span class="dv">1</span>, <span class="at">fl_sdlog=</span><span class="fl">2.5</span>, <span class="at">fl_min_quantile=</span><span class="fl">1e-3</span>) {</span>
<span id="cb612-4"><a href="statistics.html#cb612-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param float original current parameter value to be perturbed</span></span>
<span id="cb612-5"><a href="statistics.html#cb612-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param scaler_0t1 float, must be between 0 to 1, 0 means don&#39;t scale much, 1 mean a lot</span></span>
<span id="cb612-6"><a href="statistics.html#cb612-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param it_rand_seed integer randomly sperturbing seed</span></span>
<span id="cb612-7"><a href="statistics.html#cb612-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param fl_sdlog float the sdlog parameter</span></span>
<span id="cb612-8"><a href="statistics.html#cb612-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param fl_min_quantile float minimum quantile point (and 1 - max) to allow for selecting 0 and 1 for scalar_0t1</span></span>
<span id="cb612-9"><a href="statistics.html#cb612-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb612-10"><a href="statistics.html#cb612-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw randomly</span></span>
<span id="cb612-11"><a href="statistics.html#cb612-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_rand_seed)</span>
<span id="cb612-12"><a href="statistics.html#cb612-12" aria-hidden="true" tabindex="-1"></a>  fl_draw_znorm <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb612-13"><a href="statistics.html#cb612-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># logn value at quantile</span></span>
<span id="cb612-14"><a href="statistics.html#cb612-14" aria-hidden="true" tabindex="-1"></a>  scaler_0t1 <span class="ot">&lt;-</span> scaler_0t1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_min_quantile<span class="sc">*</span><span class="dv">2</span>) <span class="sc">+</span> fl_min_quantile</span>
<span id="cb612-15"><a href="statistics.html#cb612-15" aria-hidden="true" tabindex="-1"></a>  logn_coef_of_var <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="dv">1</span><span class="sc">-</span>scaler_0t1, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb612-16"><a href="statistics.html#cb612-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coefficient of variation</span></span>
<span id="cb612-17"><a href="statistics.html#cb612-17" aria-hidden="true" tabindex="-1"></a>  ar_logn_sd <span class="ot">&lt;-</span> param_original<span class="sc">/</span>logn_coef_of_var</span>
<span id="cb612-18"><a href="statistics.html#cb612-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Invert z-score</span></span>
<span id="cb612-19"><a href="statistics.html#cb612-19" aria-hidden="true" tabindex="-1"></a>  param_perturbed <span class="ot">&lt;-</span> fl_draw_znorm <span class="sc">*</span> ar_logn_sd <span class="sc">+</span> param_original</span>
<span id="cb612-20"><a href="statistics.html#cb612-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-21"><a href="statistics.html#cb612-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(param_perturbed)</span>
<span id="cb612-22"><a href="statistics.html#cb612-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Test the function with differently randomly drawn parameters, and visualize.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="statistics.html#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start image</span></span>
<span id="cb613-2"><a href="statistics.html#cb613-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over different scalars</span></span>
<span id="cb613-3"><a href="statistics.html#cb613-3" aria-hidden="true" tabindex="-1"></a>param_original <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb613-4"><a href="statistics.html#cb613-4" aria-hidden="true" tabindex="-1"></a>ar_scaler_0t1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>)</span>
<span id="cb613-5"><a href="statistics.html#cb613-5" aria-hidden="true" tabindex="-1"></a>ar_color_strs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb613-6"><a href="statistics.html#cb613-6" aria-hidden="true" tabindex="-1"></a>it_scalar_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb613-7"><a href="statistics.html#cb613-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (scaler_0t1 <span class="cf">in</span> ar_scaler_0t1) {</span>
<span id="cb613-8"><a href="statistics.html#cb613-8" aria-hidden="true" tabindex="-1"></a>  it_scalar_ctr <span class="ot">&lt;-</span> it_scalar_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb613-9"><a href="statistics.html#cb613-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-10"><a href="statistics.html#cb613-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate differently perturbed parameters</span></span>
<span id="cb613-11"><a href="statistics.html#cb613-11" aria-hidden="true" tabindex="-1"></a>  ar_param_perturbed <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb613-12"><a href="statistics.html#cb613-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_rand_seed <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)) {</span>
<span id="cb613-13"><a href="statistics.html#cb613-13" aria-hidden="true" tabindex="-1"></a>    param_perturbed <span class="ot">&lt;-</span> <span class="fu">ffi_param_logn_perturber</span>(</span>
<span id="cb613-14"><a href="statistics.html#cb613-14" aria-hidden="true" tabindex="-1"></a>      param_original, scaler_0t1, <span class="at">it_rand_seed=</span>it_rand_seed)</span>
<span id="cb613-15"><a href="statistics.html#cb613-15" aria-hidden="true" tabindex="-1"></a>    ar_param_perturbed <span class="ot">&lt;-</span> <span class="fu">c</span>(ar_param_perturbed, param_perturbed)</span>
<span id="cb613-16"><a href="statistics.html#cb613-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb613-17"><a href="statistics.html#cb613-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-18"><a href="statistics.html#cb613-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Line through origin</span></span>
<span id="cb613-19"><a href="statistics.html#cb613-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb613-20"><a href="statistics.html#cb613-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(ar_param_perturbed, <span class="at">col =</span> ar_color_strs[it_scalar_ctr], </span>
<span id="cb613-21"><a href="statistics.html#cb613-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb613-22"><a href="statistics.html#cb613-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Original parameter line</span></span>
<span id="cb613-23"><a href="statistics.html#cb613-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(</span>
<span id="cb613-24"><a href="statistics.html#cb613-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">v =</span> param_original,</span>
<span id="cb613-25"><a href="statistics.html#cb613-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span></span>
<span id="cb613-26"><a href="statistics.html#cb613-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb613-27"><a href="statistics.html#cb613-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Titles</span></span>
<span id="cb613-28"><a href="statistics.html#cb613-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(</span>
<span id="cb613-29"><a href="statistics.html#cb613-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb613-30"><a href="statistics.html#cb613-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Randomly perturbing some parameter, original value red line</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb613-31"><a href="statistics.html#cb613-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Log normal scalar ratio 0 to 1 = &quot;</span>, scaler_0t1</span>
<span id="cb613-32"><a href="statistics.html#cb613-32" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb613-33"><a href="statistics.html#cb613-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">sub =</span> <span class="fu">paste0</span>(</span>
<span id="cb613-34"><a href="statistics.html#cb613-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Based on 1000 random draws&quot;</span></span>
<span id="cb613-35"><a href="statistics.html#cb613-35" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb613-36"><a href="statistics.html#cb613-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Perturbed values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb613-37"><a href="statistics.html#cb613-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb613-38"><a href="statistics.html#cb613-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-308-1.png" width="672" style="display: block; margin: auto;" /><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-308-2.png" width="672" style="display: block; margin: auto;" /><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-308-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="distributions" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Distributions</h2>

<div id="integrate-over-normal-guassian-process-shock" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Integrate Over Normal Guassian Process Shock</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>Some Common parameters</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="statistics.html#cb614-1" aria-hidden="true" tabindex="-1"></a>fl_eps_mean <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb614-2"><a href="statistics.html#cb614-2" aria-hidden="true" tabindex="-1"></a>fl_eps_sd <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb614-3"><a href="statistics.html#cb614-3" aria-hidden="true" tabindex="-1"></a>fl_cdf_min <span class="ot">=</span> <span class="fl">0.000001</span></span>
<span id="cb614-4"><a href="statistics.html#cb614-4" aria-hidden="true" tabindex="-1"></a>fl_cdf_max <span class="ot">=</span> <span class="fl">0.999999</span></span>
<span id="cb614-5"><a href="statistics.html#cb614-5" aria-hidden="true" tabindex="-1"></a>ar_it_draws <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span></code></pre></div>
<div id="randomly-sample-and-integrate-monte-carlo-integration" class="section level4" number="9.2.1.1">
<h4><span class="header-section-number">9.2.1.1</span> Randomly Sample and Integrate (Monte Carlo Integration)</h4>
<p>Compare randomly drawn normal shock mean and known mean. How does simulated mean change with draws. Actual integral equals to <span class="math inline">\(10\)</span>, as sample size increases, the sample mean approaches the integration results, but this is expensive, even with ten thousand draws, not very exact.</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="statistics.html#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Draws</span></span>
<span id="cb615-2"><a href="statistics.html#cb615-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb615-3"><a href="statistics.html#cb615-3" aria-hidden="true" tabindex="-1"></a>ar_fl_means <span class="ot">&lt;-</span></span>
<span id="cb615-4"><a href="statistics.html#cb615-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb615-5"><a href="statistics.html#cb615-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">rnorm</span>(x[<span class="dv">1</span>], <span class="at">mean=</span>fl_eps_mean, <span class="at">sd=</span>fl_eps_sd))))</span>
<span id="cb615-6"><a href="statistics.html#cb615-6" aria-hidden="true" tabindex="-1"></a>ar_fl_sd <span class="ot">&lt;-</span></span>
<span id="cb615-7"><a href="statistics.html#cb615-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb615-8"><a href="statistics.html#cb615-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sd</span>(<span class="fu">rnorm</span>(x[<span class="dv">1</span>], <span class="at">mean=</span>fl_eps_mean, <span class="at">sd=</span>fl_eps_sd))))</span>
<span id="cb615-9"><a href="statistics.html#cb615-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-10"><a href="statistics.html#cb615-10" aria-hidden="true" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, ar_fl_means, ar_fl_sd)</span>
<span id="cb615-11"><a href="statistics.html#cb615-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb615-12"><a href="statistics.html#cb615-12" aria-hidden="true" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb615-13"><a href="statistics.html#cb615-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-14"><a href="statistics.html#cb615-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb615-15"><a href="statistics.html#cb615-15" aria-hidden="true" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb615-16"><a href="statistics.html#cb615-16" aria-hidden="true" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb615-17"><a href="statistics.html#cb615-17" aria-hidden="true" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb615-18"><a href="statistics.html#cb615-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-19"><a href="statistics.html#cb615-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Subtitle</span></span>
<span id="cb615-20"><a href="statistics.html#cb615-20" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb615-21"><a href="statistics.html#cb615-21" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/integration/htmlpdfr/fs_integrate_normal.html&#39;</span>)</span>
<span id="cb615-22"><a href="statistics.html#cb615-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-23"><a href="statistics.html#cb615-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb615-24"><a href="statistics.html#cb615-24" aria-hidden="true" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Sample Size Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb615-25"><a href="statistics.html#cb615-25" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb615-26"><a href="statistics.html#cb615-26" aria-hidden="true" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Size&#39;</span>)</span>
<span id="cb615-27"><a href="statistics.html#cb615-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-28"><a href="statistics.html#cb615-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb615-29"><a href="statistics.html#cb615-29" aria-hidden="true" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb615-30"><a href="statistics.html#cb615-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb615-31"><a href="statistics.html#cb615-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb615-32"><a href="statistics.html#cb615-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Mean &#39;</span>, slb_title_shr),</span>
<span id="cb615-33"><a href="statistics.html#cb615-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb615-34"><a href="statistics.html#cb615-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb615-35"><a href="statistics.html#cb615-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sample Mean&#39;</span>,</span>
<span id="cb615-36"><a href="statistics.html#cb615-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Mean of Sample Integrates to True Mean&#39;</span>) <span class="sc">+</span></span>
<span id="cb615-37"><a href="statistics.html#cb615-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb615-38"><a href="statistics.html#cb615-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb615-39"><a href="statistics.html#cb615-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-311-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="statistics.html#cb616-1" aria-hidden="true" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb616-2"><a href="statistics.html#cb616-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb616-3"><a href="statistics.html#cb616-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb616-4"><a href="statistics.html#cb616-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb616-5"><a href="statistics.html#cb616-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb616-6"><a href="statistics.html#cb616-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb616-7"><a href="statistics.html#cb616-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sample Standard Deviation&#39;</span>,</span>
<span id="cb616-8"><a href="statistics.html#cb616-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Standard Deviation of Sample Integrates to True SD&#39;</span>) <span class="sc">+</span></span>
<span id="cb616-9"><a href="statistics.html#cb616-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb616-10"><a href="statistics.html#cb616-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb616-11"><a href="statistics.html#cb616-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-311-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-symmetric-uneven-rectangle" class="section level4" number="9.2.1.2">
<h4><span class="header-section-number">9.2.1.2</span> Integration By Symmetric Uneven Rectangle</h4>
<p>Draw on even grid from close to 0 to close to 1. Get the corresponding x points to these quantile levels. Distance between x points are not equi-distance but increasing and symmetric away from the mean. Under this approach, each rectangle aims to approximate the same area.</p>
<p>Resulting integration is rectangle based, but rectangle width differ. The rectangles have wider width as they move away from the mean, and thinner width close to the mean. This is much more stable than the random draw method, but note that it converges somewhat slowly to true values as well.</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="statistics.html#cb617-1" aria-hidden="true" tabindex="-1"></a>mt_fl_means <span class="ot">&lt;-</span></span>
<span id="cb617-2"><a href="statistics.html#cb617-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb617-3"><a href="statistics.html#cb617-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-4"><a href="statistics.html#cb617-4" aria-hidden="true" tabindex="-1"></a>    fl_prob_break <span class="ot">=</span> (fl_cdf_max <span class="sc">-</span> fl_cdf_min)<span class="sc">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb617-5"><a href="statistics.html#cb617-5" aria-hidden="true" tabindex="-1"></a>    ar_eps_bounds <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">seq</span>(fl_cdf_min, fl_cdf_max,</span>
<span id="cb617-6"><a href="statistics.html#cb617-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">by=</span>(fl_cdf_max <span class="sc">-</span> fl_cdf_min)<span class="sc">/</span>(x[<span class="dv">1</span>])),</span>
<span id="cb617-7"><a href="statistics.html#cb617-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb617-8"><a href="statistics.html#cb617-8" aria-hidden="true" tabindex="-1"></a>    ar_eps_val <span class="ot">&lt;-</span> (<span class="fu">tail</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">head</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb617-9"><a href="statistics.html#cb617-9" aria-hidden="true" tabindex="-1"></a>    ar_eps_prb <span class="ot">&lt;-</span> <span class="fu">rep</span>(fl_prob_break<span class="sc">/</span>(fl_cdf_max <span class="sc">-</span> fl_cdf_min), x[<span class="dv">1</span>])</span>
<span id="cb617-10"><a href="statistics.html#cb617-10" aria-hidden="true" tabindex="-1"></a>    ar_eps_fev <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(ar_eps_val,</span>
<span id="cb617-11"><a href="statistics.html#cb617-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb617-12"><a href="statistics.html#cb617-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-13"><a href="statistics.html#cb617-13" aria-hidden="true" tabindex="-1"></a>    fl_cdf_total_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds))</span>
<span id="cb617-14"><a href="statistics.html#cb617-14" aria-hidden="true" tabindex="-1"></a>    fl_mean_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_val<span class="sc">*</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds)))</span>
<span id="cb617-15"><a href="statistics.html#cb617-15" aria-hidden="true" tabindex="-1"></a>    fl_sd_approx <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((ar_eps_val<span class="sc">-</span>fl_mean_approx)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds))))</span>
<span id="cb617-16"><a href="statistics.html#cb617-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-17"><a href="statistics.html#cb617-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">cdf=</span>fl_cdf_total_approx, <span class="at">mean=</span>fl_mean_approx, <span class="at">sd=</span>fl_sd_approx))</span>
<span id="cb617-18"><a href="statistics.html#cb617-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb617-19"><a href="statistics.html#cb617-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-20"><a href="statistics.html#cb617-20" aria-hidden="true" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, <span class="fu">as_tibble</span>(<span class="fu">t</span>(mt_fl_means)) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>())</span>
<span id="cb617-21"><a href="statistics.html#cb617-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb617-22"><a href="statistics.html#cb617-22" aria-hidden="true" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb617-23"><a href="statistics.html#cb617-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-24"><a href="statistics.html#cb617-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb617-25"><a href="statistics.html#cb617-25" aria-hidden="true" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb617-26"><a href="statistics.html#cb617-26" aria-hidden="true" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb617-27"><a href="statistics.html#cb617-27" aria-hidden="true" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb617-28"><a href="statistics.html#cb617-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-29"><a href="statistics.html#cb617-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb617-30"><a href="statistics.html#cb617-30" aria-hidden="true" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Uneven Rectangle Count Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb617-31"><a href="statistics.html#cb617-31" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb617-32"><a href="statistics.html#cb617-32" aria-hidden="true" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Number of Quantile Bins for Uneven Rectangles Approximation&#39;</span>)</span>
<span id="cb617-33"><a href="statistics.html#cb617-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-34"><a href="statistics.html#cb617-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb617-35"><a href="statistics.html#cb617-35" aria-hidden="true" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb617-36"><a href="statistics.html#cb617-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb617-37"><a href="statistics.html#cb617-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb617-38"><a href="statistics.html#cb617-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb617-39"><a href="statistics.html#cb617-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb617-40"><a href="statistics.html#cb617-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb617-41"><a href="statistics.html#cb617-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Approximated Mean&#39;</span>,</span>
<span id="cb617-42"><a href="statistics.html#cb617-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb617-43"><a href="statistics.html#cb617-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb617-44"><a href="statistics.html#cb617-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb617-45"><a href="statistics.html#cb617-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-312-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="statistics.html#cb618-1" aria-hidden="true" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb618-2"><a href="statistics.html#cb618-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb618-3"><a href="statistics.html#cb618-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb618-4"><a href="statistics.html#cb618-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb618-5"><a href="statistics.html#cb618-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb618-6"><a href="statistics.html#cb618-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb618-7"><a href="statistics.html#cb618-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Approximated Standard Deviation&#39;</span>,</span>
<span id="cb618-8"><a href="statistics.html#cb618-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb618-9"><a href="statistics.html#cb618-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb618-10"><a href="statistics.html#cb618-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb618-11"><a href="statistics.html#cb618-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-312-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="statistics.html#cb619-1" aria-hidden="true" tabindex="-1"></a>plt_cdf <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb619-2"><a href="statistics.html#cb619-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>cdf)) <span class="sc">+</span></span>
<span id="cb619-3"><a href="statistics.html#cb619-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb619-4"><a href="statistics.html#cb619-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb619-5"><a href="statistics.html#cb619-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb619-6"><a href="statistics.html#cb619-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb619-7"><a href="statistics.html#cb619-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sum of Uneven Rectangles&#39;</span>,</span>
<span id="cb619-8"><a href="statistics.html#cb619-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb619-9"><a href="statistics.html#cb619-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb619-10"><a href="statistics.html#cb619-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb619-11"><a href="statistics.html#cb619-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-312-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-constant-width-rectangle-trapezoidal-rule" class="section level4" number="9.2.1.3">
<h4><span class="header-section-number">9.2.1.3</span> Integration By Constant Width Rectangle (Trapezoidal rule)</h4>
<p>This is implementing even width recentagle, even along x-axix. Rectangle width are the same, height is <span class="math inline">\(f(x)\)</span>. This is even width, but uneven area. Note that this method approximates the true answer much better and more quickly than the prior methods.</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="statistics.html#cb620-1" aria-hidden="true" tabindex="-1"></a>mt_fl_means <span class="ot">&lt;-</span></span>
<span id="cb620-2"><a href="statistics.html#cb620-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb620-3"><a href="statistics.html#cb620-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb620-4"><a href="statistics.html#cb620-4" aria-hidden="true" tabindex="-1"></a>    fl_eps_min <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(fl_cdf_min, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb620-5"><a href="statistics.html#cb620-5" aria-hidden="true" tabindex="-1"></a>    fl_eps_max <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(fl_cdf_max, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb620-6"><a href="statistics.html#cb620-6" aria-hidden="true" tabindex="-1"></a>    fl_gap <span class="ot">&lt;-</span> (fl_eps_max<span class="sc">-</span>fl_eps_min)<span class="sc">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb620-7"><a href="statistics.html#cb620-7" aria-hidden="true" tabindex="-1"></a>    ar_eps_bounds <span class="ot">&lt;-</span> <span class="fu">seq</span>(fl_eps_min, fl_eps_max, <span class="at">by=</span>fl_gap)</span>
<span id="cb620-8"><a href="statistics.html#cb620-8" aria-hidden="true" tabindex="-1"></a>    ar_eps_val <span class="ot">&lt;-</span> (<span class="fu">tail</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">head</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb620-9"><a href="statistics.html#cb620-9" aria-hidden="true" tabindex="-1"></a>    ar_eps_prb <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(ar_eps_val, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)<span class="sc">*</span>fl_gap</span>
<span id="cb620-10"><a href="statistics.html#cb620-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb620-11"><a href="statistics.html#cb620-11" aria-hidden="true" tabindex="-1"></a>    fl_cdf_total_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_prb)</span>
<span id="cb620-12"><a href="statistics.html#cb620-12" aria-hidden="true" tabindex="-1"></a>    fl_mean_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_val<span class="sc">*</span>ar_eps_prb)</span>
<span id="cb620-13"><a href="statistics.html#cb620-13" aria-hidden="true" tabindex="-1"></a>    fl_sd_approx <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((ar_eps_val<span class="sc">-</span>fl_mean_approx)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>ar_eps_prb))</span>
<span id="cb620-14"><a href="statistics.html#cb620-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb620-15"><a href="statistics.html#cb620-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">cdf=</span>fl_cdf_total_approx, <span class="at">mean=</span>fl_mean_approx, <span class="at">sd=</span>fl_sd_approx))</span>
<span id="cb620-16"><a href="statistics.html#cb620-16" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb620-17"><a href="statistics.html#cb620-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb620-18"><a href="statistics.html#cb620-18" aria-hidden="true" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, <span class="fu">as_tibble</span>(<span class="fu">t</span>(mt_fl_means)) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>())</span>
<span id="cb620-19"><a href="statistics.html#cb620-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb620-20"><a href="statistics.html#cb620-20" aria-hidden="true" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb620-21"><a href="statistics.html#cb620-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb620-22"><a href="statistics.html#cb620-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb620-23"><a href="statistics.html#cb620-23" aria-hidden="true" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb620-24"><a href="statistics.html#cb620-24" aria-hidden="true" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb620-25"><a href="statistics.html#cb620-25" aria-hidden="true" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb620-26"><a href="statistics.html#cb620-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb620-27"><a href="statistics.html#cb620-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb620-28"><a href="statistics.html#cb620-28" aria-hidden="true" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Even Rectangle Count Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb620-29"><a href="statistics.html#cb620-29" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb620-30"><a href="statistics.html#cb620-30" aria-hidden="true" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Number Equi-distance Rectangles Bins&#39;</span>)</span>
<span id="cb620-31"><a href="statistics.html#cb620-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb620-32"><a href="statistics.html#cb620-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb620-33"><a href="statistics.html#cb620-33" aria-hidden="true" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb620-34"><a href="statistics.html#cb620-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb620-35"><a href="statistics.html#cb620-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb620-36"><a href="statistics.html#cb620-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb620-37"><a href="statistics.html#cb620-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb620-38"><a href="statistics.html#cb620-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb620-39"><a href="statistics.html#cb620-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Integrated Mean&#39;</span>,</span>
<span id="cb620-40"><a href="statistics.html#cb620-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb620-41"><a href="statistics.html#cb620-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb620-42"><a href="statistics.html#cb620-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb620-43"><a href="statistics.html#cb620-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-313-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="statistics.html#cb621-1" aria-hidden="true" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb621-2"><a href="statistics.html#cb621-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb621-3"><a href="statistics.html#cb621-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb621-4"><a href="statistics.html#cb621-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb621-5"><a href="statistics.html#cb621-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb621-6"><a href="statistics.html#cb621-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb621-7"><a href="statistics.html#cb621-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Standard Deviation&#39;</span>,</span>
<span id="cb621-8"><a href="statistics.html#cb621-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb621-9"><a href="statistics.html#cb621-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb621-10"><a href="statistics.html#cb621-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb621-11"><a href="statistics.html#cb621-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-313-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="statistics.html#cb622-1" aria-hidden="true" tabindex="-1"></a>plt_cdf <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb622-2"><a href="statistics.html#cb622-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>cdf)) <span class="sc">+</span></span>
<span id="cb622-3"><a href="statistics.html#cb622-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb622-4"><a href="statistics.html#cb622-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb622-5"><a href="statistics.html#cb622-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb622-6"><a href="statistics.html#cb622-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb622-7"><a href="statistics.html#cb622-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sum of Equi-Dist Rectangles&#39;</span>,</span>
<span id="cb622-8"><a href="statistics.html#cb622-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Equi-Dist Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb622-9"><a href="statistics.html#cb622-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb622-10"><a href="statistics.html#cb622-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb622-11"><a href="statistics.html#cb622-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-313-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="discrete-random-variable" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Discrete Random Variable</h2>

<div id="discrete-approximation-of-continuous-random-variables" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Discrete Approximation of Continuous Random Variables</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="use-binomial-discrete-random-variable-to-approximate-continuous-normal" class="section level4" number="9.3.1.1">
<h4><span class="header-section-number">9.3.1.1</span> Use Binomial Discrete Random Variable to Approximate Continuous Normal</h4>
<p>First, draw from a Continuous Random Variable. Sample <span class="math inline">\(N\)</span> draws from a normal random variable.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="statistics.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random normal Data Vector (not equal outcomes)</span></span>
<span id="cb623-2"><a href="statistics.html#cb623-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb623-3"><a href="statistics.html#cb623-3" aria-hidden="true" tabindex="-1"></a>it_sample_N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb623-4"><a href="statistics.html#cb623-4" aria-hidden="true" tabindex="-1"></a>fl_rnorm_mean <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb623-5"><a href="statistics.html#cb623-5" aria-hidden="true" tabindex="-1"></a>fl_rnorm_sd <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb623-6"><a href="statistics.html#cb623-6" aria-hidden="true" tabindex="-1"></a>ar_data_rnorm <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(it_sample_N, <span class="at">mean =</span> fl_rnorm_mean, <span class="at">sd =</span> fl_rnorm_sd)</span>
<span id="cb623-7"><a href="statistics.html#cb623-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb623-8"><a href="statistics.html#cb623-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb623-9"><a href="statistics.html#cb623-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ar_data_rnorm, <span class="at">xlab =</span> <span class="st">&quot;x Values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Frequencies&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb623-10"><a href="statistics.html#cb623-10" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;Continuous Normal Random Variable Draws&quot;</span>)</span>
<span id="cb623-11"><a href="statistics.html#cb623-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-315-1.png" width="672" style="display: block; margin: auto;" />
We use the <a href="https://en.wikipedia.org/wiki/Binomial_distribution">binomial to approximate the normal distribution</a>. Let <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> be the mean and standard deviations of the normal random variable, and <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> be the number of “trials” and the “probability-of-success” for the binomial distribution. We know that these relationships are approximately true, :</p>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;= n\cdot p\\
n &amp;= \frac{\mu}{p}\\
\sigma^2 &amp;= n\cdot p\cdot(1-p) = \mu\cdot(1-p)\\
\end{aligned}
\]</span></p>
<p>Given these, we have can translate between the normal random variable’s parameters and the binomial discrete random variable’s parameters:</p>
<p><span class="math display">\[
\begin{aligned}
p &amp;= 1 - \frac{\sigma^2}{\mu}\\
n &amp;= \frac{\mu}{1 - \frac{\sigma^2}{\mu}} = \frac{\mu}{\frac{\mu - \sigma^2}{\mu}} = \frac{\mu^2}{\mu - \sigma^2}
\end{aligned}
\]</span></p>
<p>There are two important aspects to note here:</p>
<ol style="list-style-type: decimal">
<li>Since <span class="math inline">\(p\)</span> must be positive, this means <span class="math inline">\(\frac{\sigma^2}{\mu}&lt;1\)</span> and <span class="math inline">\(\sigma^2&lt;\mu\)</span>, which is the condition for the above transformation to work.</li>
<li>The binomial discrete random variable will have non-zero mass for very small probability events at the left-tail. These very low outcome events are highly unlikely to be observed or drawn from sampling the continuous random variable. The presence of these left-tail values might impact the computation of certain statistics, for example the <a href="https://fanwangecon.github.io/R4Econ/math/func_ineq/htmlpdfr/fs_atkinson_ces.html">Atkinson Index for highly inequality averse planners</a>.</li>
</ol>
<p>Create a function for converting between normal and binomial parameters:</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="statistics.html#cb624-1" aria-hidden="true" tabindex="-1"></a>ffi_binom_approx_nomr <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_rnorm_mean, fl_rnorm_sd) {</span>
<span id="cb624-2"><a href="statistics.html#cb624-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param fl_rnorm_mean float normal mean</span></span>
<span id="cb624-3"><a href="statistics.html#cb624-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param fl_rnorm_sd float normal standard deviation</span></span>
<span id="cb624-4"><a href="statistics.html#cb624-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (fl_rnorm_mean <span class="sc">&lt;=</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span>) {</span>
<span id="cb624-5"><a href="statistics.html#cb624-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Normal mean must be larger than the variance for conversion&quot;</span>)</span>
<span id="cb624-6"><a href="statistics.html#cb624-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb624-7"><a href="statistics.html#cb624-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use binomial to approximate normal</span></span>
<span id="cb624-8"><a href="statistics.html#cb624-8" aria-hidden="true" tabindex="-1"></a>    fl_p_binom <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> fl_rnorm_mean</span>
<span id="cb624-9"><a href="statistics.html#cb624-9" aria-hidden="true" tabindex="-1"></a>    fl_n_binom <span class="ot">&lt;-</span> <span class="fu">round</span>(fl_rnorm_mean<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (fl_rnorm_mean <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb624-10"><a href="statistics.html#cb624-10" aria-hidden="true" tabindex="-1"></a>    fl_binom_mean <span class="ot">&lt;-</span> fl_n_binom <span class="sc">*</span> fl_p_binom</span>
<span id="cb624-11"><a href="statistics.html#cb624-11" aria-hidden="true" tabindex="-1"></a>    fl_binom_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(fl_n_binom <span class="sc">*</span> fl_p_binom <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fl_p_binom))</span>
<span id="cb624-12"><a href="statistics.html#cb624-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return</span></span>
<span id="cb624-13"><a href="statistics.html#cb624-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb624-14"><a href="statistics.html#cb624-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">fl_p_binom =</span> fl_p_binom, <span class="at">fl_n_binom =</span> fl_n_binom,</span>
<span id="cb624-15"><a href="statistics.html#cb624-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">fl_binom_mean =</span> fl_binom_mean, <span class="at">fl_binom_sd =</span> fl_binom_sd</span>
<span id="cb624-16"><a href="statistics.html#cb624-16" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb624-17"><a href="statistics.html#cb624-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb624-18"><a href="statistics.html#cb624-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Call the function to generate binomial parameters:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="statistics.html#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with these parameters, does not work</span></span>
<span id="cb625-2"><a href="statistics.html#cb625-2" aria-hidden="true" tabindex="-1"></a>ls_binom_params <span class="ot">&lt;-</span> <span class="fu">ffi_binom_approx_nomr</span>(<span class="at">fl_rnorm_mean =</span> <span class="dv">10</span>, <span class="at">fl_rnorm_sd =</span> <span class="dv">3</span>)</span>
<span id="cb625-3"><a href="statistics.html#cb625-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Call function with parameters, defined earlier, that work</span></span>
<span id="cb625-4"><a href="statistics.html#cb625-4" aria-hidden="true" tabindex="-1"></a>ls_binom_params <span class="ot">&lt;-</span> <span class="fu">ffi_binom_approx_nomr</span>(fl_rnorm_mean, fl_rnorm_sd)</span>
<span id="cb625-5"><a href="statistics.html#cb625-5" aria-hidden="true" tabindex="-1"></a>fl_binom_mean <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_binom_mean</span>
<span id="cb625-6"><a href="statistics.html#cb625-6" aria-hidden="true" tabindex="-1"></a>fl_binom_sd <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_binom_sd</span>
<span id="cb625-7"><a href="statistics.html#cb625-7" aria-hidden="true" tabindex="-1"></a>fl_n_binom <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_n_binom</span>
<span id="cb625-8"><a href="statistics.html#cb625-8" aria-hidden="true" tabindex="-1"></a>fl_p_binom <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_p_binom</span>
<span id="cb625-9"><a href="statistics.html#cb625-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean and sd</span></span>
<span id="cb625-10"><a href="statistics.html#cb625-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;BINOMI mean=&quot;</span>, ls_binom_params<span class="sc">$</span>fl_binom_mean))</span></code></pre></div>
<pre><code>## [1] &quot;BINOMI mean=99.84&quot;</code></pre>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="statistics.html#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;BINOMI mean=&quot;</span>, ls_binom_params<span class="sc">$</span>fl_binom_sd))</span></code></pre></div>
<pre><code>## [1] &quot;BINOMI mean=5.99519807846246&quot;</code></pre>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="statistics.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drv = discrete random variable</span></span>
<span id="cb629-2"><a href="statistics.html#cb629-2" aria-hidden="true" tabindex="-1"></a>ar_drv_rbinom_xval <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, fl_n_binom)</span>
<span id="cb629-3"><a href="statistics.html#cb629-3" aria-hidden="true" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_drv_rbinom_xval,</span>
<span id="cb629-4"><a href="statistics.html#cb629-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> fl_n_binom, <span class="at">prob =</span> fl_p_binom</span>
<span id="cb629-5"><a href="statistics.html#cb629-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb629-6"><a href="statistics.html#cb629-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore weight at x=0</span></span>
<span id="cb629-7"><a href="statistics.html#cb629-7" aria-hidden="true" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> ar_drv_rbinom_prob <span class="sc">/</span> <span class="fu">sum</span>(ar_drv_rbinom_prob)</span></code></pre></div>
<p>Visualize the binomial discrete random variable:</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="statistics.html#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb630-2"><a href="statistics.html#cb630-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb630-3"><a href="statistics.html#cb630-3" aria-hidden="true" tabindex="-1"></a>ar_ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb630-4"><a href="statistics.html#cb630-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_drv_rbinom_xval, ar_drv_rbinom_prob,</span>
<span id="cb630-5"><a href="statistics.html#cb630-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Binomial x Values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Discrete Probabilitys, P(x)&quot;</span></span>
<span id="cb630-6"><a href="statistics.html#cb630-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb630-7"><a href="statistics.html#cb630-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb630-8"><a href="statistics.html#cb630-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Binomial Approximate of Normal Random Variable&quot;</span>),</span>
<span id="cb630-9"><a href="statistics.html#cb630-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub =</span> <span class="fu">paste0</span>(</span>
<span id="cb630-10"><a href="statistics.html#cb630-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;binop=&quot;</span>, <span class="fu">round</span>(fl_p_binom, <span class="dv">2</span>),</span>
<span id="cb630-11"><a href="statistics.html#cb630-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;;binon=&quot;</span>, <span class="fu">round</span>(fl_n_binom, <span class="dv">2</span>),</span>
<span id="cb630-12"><a href="statistics.html#cb630-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;;binomean=&quot;</span>, <span class="fu">round</span>(fl_binom_mean, <span class="dv">2</span>),</span>
<span id="cb630-13"><a href="statistics.html#cb630-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;;binomsd=&quot;</span>, <span class="fu">round</span>(fl_binom_sd, <span class="dv">2</span>),</span>
<span id="cb630-14"><a href="statistics.html#cb630-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;;normmean=&quot;</span>, <span class="fu">round</span>(fl_rnorm_mean, <span class="dv">2</span>), <span class="st">&quot;;normsd=&quot;</span>, <span class="fu">round</span>(fl_rnorm_sd, <span class="dv">2</span>)</span>
<span id="cb630-15"><a href="statistics.html#cb630-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb630-16"><a href="statistics.html#cb630-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb630-17"><a href="statistics.html#cb630-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-318-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="obtaining-joint-distribution-from-marginal-with-rectilinear-restrictions" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Obtaining Joint Distribution from Marginal with Rectilinear Restrictions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>Suppose we want to know the joint probability mass function <span class="math inline">\(P(E,A)\)</span> where <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span> are both discrete. <span class="math inline">\(E\)</span> could be education groups, and <span class="math inline">\(A\)</span> could be age groups. But we only know <span class="math inline">\(P(E)\)</span> and <span class="math inline">\(P(A)\)</span>, under what conditions can we obtain the joint distribution from the marginals?</p>
<div id="unrestricted-joint-2-by-2-distribution" class="section level4" number="9.3.2.1">
<h4><span class="header-section-number">9.3.2.1</span> Unrestricted Joint 2 by 2 Distribution</h4>
<p>Suppose there are two unique states for <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span>. For example, suppose we know the unemployment probability for better or worse educated, and also for low and high age groups. We want to know the joint probability of been both better educated and lower age, better educated and higher age, worse educated and lower age, and worse educated and higher age. Then:</p>
<p><span class="math display">\[
\begin{aligned}
P(E_1) = P(A_1,E_1) + P(A_2,E_1)\\
P(E_2) = P(A_1,E_2) + P(A_2,E_2)\\
P(A_1) = P(A_1,E_1) + P(A_1,E_2)\\
P(A_2) = P(A_2,E_1) + P(A_2,E_2)
\end{aligned}
\]</span></p>
<p>We know <span class="math inline">\(P(E_1)\)</span>, <span class="math inline">\(P(E_2)\)</span>, <span class="math inline">\(P(A_1)\)</span> and <span class="math inline">\(P(A_2)\)</span>, but not <span class="math inline">\(P(A_i,E_i)\)</span>. Let <span class="math inline">\(X,W,Y,Z\)</span> be unknowns and <span class="math inline">\(A,B,C,D\)</span> are known. It might seem like that with four equations and four unknowns, we can find <span class="math inline">\(X,W,Y,Z\)</span>. But because what we know are probabilities: the marginals along each dimension sums up to 1. Without restrictions, there are no unique solutions to this problem. but many possible solutions. For example, Suppose <span class="math inline">\(P(E_1)=0.5\)</span> and <span class="math inline">\(P(A_1)=0.5\)</span>, rewrite the above problem as:</p>
<p><span class="math display">\[
\begin{aligned}
0.5 = X + W\\
0.5 = Y + Z\\
0.5 = W + Y\\
0.5 = X + Z\\
\end{aligned}
\]</span></p>
<p>Solutions include:</p>
<ul>
<li><span class="math inline">\(X=0.2\)</span>, <span class="math inline">\(W=0.3\)</span>, <span class="math inline">\(Y=0.2\)</span>, <span class="math inline">\(Z=0.3\)</span></li>
<li><span class="math inline">\(X=0.4\)</span>, <span class="math inline">\(W=0.1\)</span>, <span class="math inline">\(Y=0.4\)</span>, <span class="math inline">\(Z=0.1\)</span></li>
<li>and infinitely many others …</li>
</ul>
<p>There are no unique solutions, because, when we write the linear system above in matrix form as shown below, the <span class="math inline">\(A\)</span> coefficient matrix is not full rank, but has a rank of 3.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 1 \\
1 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 1 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
W \\
X \\
Y \\
Z
\end{bmatrix}
&amp; =
\begin{bmatrix}
A \\
B \\
C \\
D \\
\end{bmatrix}\\
A \cdot \mathbb{X} &amp; =  b
\end{aligned}
\]</span>
We can see the rank of a matrix with the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/qr.html">qr</a> function (QR decomposition):</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="statistics.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb631-2"><a href="statistics.html#cb631-2" aria-hidden="true" tabindex="-1"></a>mt_a <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb631-3"><a href="statistics.html#cb631-3" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb631-4"><a href="statistics.html#cb631-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb631-5"><a href="statistics.html#cb631-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb631-6"><a href="statistics.html#cb631-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rank Check with the qr function:</span></span>
<span id="cb631-7"><a href="statistics.html#cb631-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">qr</span>(mt_a))</span></code></pre></div>
<pre><code>## $qr
##            [,1]       [,2]       [,3]          [,4]
## [1,] -1.4142136 -0.7071068 -0.7071068  0.000000e+00
## [2,]  0.0000000 -1.2247449  0.4082483 -8.164966e-01
## [3,]  0.7071068 -0.5773503 -1.1547005 -1.154701e+00
## [4,]  0.0000000  0.8164966 -0.4184316 -2.775558e-16
## 
## $rank
## [1] 3
## 
## $qraux
## [1] 1.707107e+00 1.000000e+00 1.908248e+00 2.775558e-16
## 
## $pivot
## [1] 1 2 3 4
## 
## attr(,&quot;class&quot;)
## [1] &quot;qr&quot;</code></pre>
</div>
<div id="rectilinear-restriction-on-joint-2-by-2-distribution" class="section level4" number="9.3.2.2">
<h4><span class="header-section-number">9.3.2.2</span> Rectilinear Restriction on Joint 2 by 2 Distribution</h4>
<p>So in the section above, it is demonstrated that it is not possible to uniquely identify the joint probability mass function from marginal probability mass functions.</p>
<p>However, sometimes, we need to find some reasonable joint distribution, when we only observe marginal distributions. This joint distribution might be an input transition matrix in a model we simulate. If we just use one of the infinitely possible joint mass that match up with the marginals, then the model would have infinitely many simulation results depending on our arbitrary choice of joint mass.</p>
<p>Ideally, one should try to obtain data to estimate the underlying joint distribution, when this is not possible, we can impose additional non-parametric restrictions on the structures of the joint probability mass that would lead to unique joint mass from marginals.</p>
<p>Specifically, I will assume the incremental changes across rows and across columns of the joint mass matrix are row or column specific, is this sufficient? (In Some Cases it Will Not be):</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = P(A_1,E_2) - P(A_1,E_1) = P(A_2,E_2) - P(A_2,E_1)\\
\Delta^{A}_{12} = P(A_2,E_1) - P(A_1,E_1) = P(A_2,E_2) - P(A_1,E_2)\\
\end{aligned}
\]</span>
The assumption is non-parametric. This is effectively an rectilinear assumption on the joint Cumulative Probability Mass Function.</p>
<p>Given this assumption, now we have:
<span class="math display">\[
\begin{aligned}
P(E_2) - P(E_1) = P(A_1,E_2) + P(A_2,E_2) - P(A_1,E_1) - P(A_2,E_1)\\
P(A_2) - P(A_1) = P(A_2,E_1) + P(A_2,E_2) - P(A_1,E_1) - P(A_1,E_2)\\
\end{aligned}
\]</span></p>
<p>Which become:
<span class="math display">\[
\begin{aligned}
P(E_2) - P(E_1) = 2\cdot\Delta^{E}_{12}\\
P(A_2) - P(A_1) = 2\cdot\Delta^{A}_{12}
\end{aligned}
\]</span>
Suppose <span class="math inline">\(P(E_1)=0.5\)</span> and <span class="math inline">\(P(A_1)=0.5\)</span>:</p>
<ul>
<li><span class="math inline">\(\phi=0\)</span></li>
<li><span class="math inline">\(\rho=0\)</span></li>
<li>hence: <span class="math inline">\(P(A_1,E_1) = P(A_1,E_2) = P(A_2,E_1) = P(A_2,E_2) = 0.25\)</span></li>
</ul>
<p>Suppose <span class="math inline">\(P(E_1)=0.4\)</span> and <span class="math inline">\(P(A_1)=0.7\)</span>:</p>
<ul>
<li><span class="math inline">\(\Delta^{E}_{12}=0.1\)</span></li>
<li><span class="math inline">\(\Delta^{A}_{12}=-0.20\)</span></li>
</ul>
<p>Hence:</p>
<p><span class="math display">\[
\begin{aligned}
0.4 = P(A_1,E_1) + P(A_2,E_1)
    = P(A_1,E_1) + P(A_1,E_1) + \Delta^{A}_{12}
    = 2\cdot P(A_1,E_1) - 0.20\\
\end{aligned}
\]</span></p>
<p>And:
<span class="math display">\[
\begin{aligned}
P(A_1,E_1) = \frac{0.60}{2}=0.30\\
P(A_2,E_1) = 0.4-0.30=0.10\\
P(A_1,E_2) = 0.7-0.30=0.40\\
P(A_2,E_2) = 0.3-0.10=0.20\\
\end{aligned}
\]</span></p>
<p>These joint mass sum up to 1, satisfy the marginal mass requirements from the data, and are unique given the rectilinear assumption.</p>
</div>
<div id="rectilinear-restriction-diamond-on-joint-2-by-2-distribution" class="section level4" number="9.3.2.3">
<h4><span class="header-section-number">9.3.2.3</span> Rectilinear Restriction Diamond on Joint 2 by 2 Distribution</h4>
<p>The rectilinear assumptions, however, do not necessarily lead to positive values for each element of the joint mass function. In this section, I discuss under what conditions the rectilinear restriction leads to positive mass at all points of the joint probability mass function.</p>
<p>We can write these:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1)
=
\frac{1}{4}
\left(
  1
  - \Delta^{E}_{12}\cdot 2
  - \Delta^{A}_{12}\cdot 2
\right)\\
P(A_2, E_1)
= P(A_1, E_1) + \Delta^{A}_{12}\\
P(A_1, E_2)
= P(A_1, E_1) + \Delta^{E}_{12}\\
P(A_2, E_2)
= P(A_1, E_1) + \Delta^{A}_{12} + \Delta^{E}_{12}\\
\end{aligned}
\]</span>
Plugging the Values for <span class="math inline">\(P(A_1, E_1)\)</span> in, we have:
<span class="math display">\[
\begin{aligned}
P(A_1, E_1)
=
\frac{1}{4}
\left(
  1
  - \Delta^{E}_{12}\cdot 2
  - \Delta^{A}_{12}\cdot 2
\right)\\
P(A_2, E_1)
=
\frac{1}{4}
\left(
  1
  - \Delta^{E}_{12}\cdot 2
  + \Delta^{A}_{12}\cdot 2
\right)
\\
P(A_1, E_2)
=
\frac{1}{4}
\left(
  1
  + \Delta^{E}_{12}\cdot 2
  - \Delta^{A}_{12}\cdot 2
\right)
\\
P(A_2, E_2)
=
\frac{1}{4}
\left(
  1
  + \Delta^{E}_{12}\cdot 2
  + \Delta^{A}_{12}\cdot 2
\right)\\
\end{aligned}
\]</span>
When are these terms positive:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1) \ge 0
\text{ iff }
\frac{1}{2} \ge \Delta^{E}_{12} + \Delta^{A}_{12}
\\
P(A_2, E_1) \ge 0
\text{ iff }
\frac{1}{2} \ge \Delta^{E}_{12} - \Delta^{A}_{12}
\\
P(A_1, E_2) \ge 0
\text{ iff }
\frac{1}{2} \ge - \Delta^{E}_{12} + \Delta^{A}_{12}
\\
P(A_2, E_2) \ge 0
\text{ iff }
\frac{1}{2} \ge - \Delta^{E}_{12} - \Delta^{A}_{12}
\\
\end{aligned}
\]</span>
Rewriting the positivity conditions, we have:
<span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} \le \frac{1}{2} - \Delta^{A}_{12}
\\
\Delta^{E}_{12} \le \frac{1}{2} + \Delta^{A}_{12}
\\
\Delta^{E}_{12} \ge -\frac{1}{2} + \Delta^{A}_{12}
\\
\Delta^{E}_{12} \ge -\frac{1}{2} - \Delta^{A}_{12}
\\
\end{aligned}
\]</span>
The four conditions above create a diamond, Following the rectilinear restriction, if the <span class="math inline">\(\delta^E\)</span> and <span class="math inline">\(\delta^A\)</span> values fall within the diamond region, then the mass for at all joint probability points will be positive. Basically the restriction is that when the jumps in mass are more extreme, rectilinear restriction will not return positive mass at all points. The requirement is that:
<span class="math display">\[
\mid \Delta^{A}_{12} \mid + \mid \Delta^{E}_{12} \mid \le \frac{1}{2}
\]</span></p>
<p>Graphically:</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="statistics.html#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb633-2"><a href="statistics.html#cb633-2" aria-hidden="true" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;2 by 2 Joint Mass from Marginal Rectilinear Assumption</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb633-3"><a href="statistics.html#cb633-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;Intersecting Area Positive Mass at all Joint Discrete Points</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb633-4"><a href="statistics.html#cb633-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;x-axis and y-axis values will never exceed -0.5 or 0.5&#39;</span>)</span>
<span id="cb633-5"><a href="statistics.html#cb633-5" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb633-6"><a href="statistics.html#cb633-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/discrandvar/htmlpdfr/fs_drm_mass.html&#39;</span>)</span>
<span id="cb633-7"><a href="statistics.html#cb633-7" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;delta A&#39;</span></span>
<span id="cb633-8"><a href="statistics.html#cb633-8" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;delta E&#39;</span></span>
<span id="cb633-9"><a href="statistics.html#cb633-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-10"><a href="statistics.html#cb633-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 1</span></span>
<span id="cb633-11"><a href="statistics.html#cb633-11" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb633-12"><a href="statistics.html#cb633-12" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">-</span>x1</span>
<span id="cb633-13"><a href="statistics.html#cb633-13" aria-hidden="true" tabindex="-1"></a>st_legend1 <span class="ot">&lt;-</span> <span class="st">&#39;Below This Line</span><span class="sc">\n</span><span class="st"> P_A1_E1&gt;0 Restriction&#39;</span></span>
<span id="cb633-14"><a href="statistics.html#cb633-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 2</span></span>
<span id="cb633-15"><a href="statistics.html#cb633-15" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb633-16"><a href="statistics.html#cb633-16" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">+</span>x2</span>
<span id="cb633-17"><a href="statistics.html#cb633-17" aria-hidden="true" tabindex="-1"></a>st_legend2 <span class="ot">&lt;-</span> <span class="st">&#39;Below This Line</span><span class="sc">\n</span><span class="st"> P_A2_E1&gt;0 Restriction&#39;</span></span>
<span id="cb633-18"><a href="statistics.html#cb633-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 3</span></span>
<span id="cb633-19"><a href="statistics.html#cb633-19" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb633-20"><a href="statistics.html#cb633-20" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">+</span>x3</span>
<span id="cb633-21"><a href="statistics.html#cb633-21" aria-hidden="true" tabindex="-1"></a>st_legend3 <span class="ot">&lt;-</span> <span class="st">&#39;Above This Line</span><span class="sc">\n</span><span class="st"> P_A1_E2&gt;0 Restriction&#39;</span></span>
<span id="cb633-22"><a href="statistics.html#cb633-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 4</span></span>
<span id="cb633-23"><a href="statistics.html#cb633-23" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb633-24"><a href="statistics.html#cb633-24" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">-</span>x4</span>
<span id="cb633-25"><a href="statistics.html#cb633-25" aria-hidden="true" tabindex="-1"></a>st_legend4 <span class="ot">&lt;-</span> <span class="st">&#39;Above This Line</span><span class="sc">\n</span><span class="st"> P_A1_E2&gt;0 Restriction&#39;</span></span>
<span id="cb633-26"><a href="statistics.html#cb633-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-27"><a href="statistics.html#cb633-27" aria-hidden="true" tabindex="-1"></a><span class="co"># line lty</span></span>
<span id="cb633-28"><a href="statistics.html#cb633-28" aria-hidden="true" tabindex="-1"></a>st_line_1_lty <span class="ot">&lt;-</span> <span class="st">&#39;solid&#39;</span></span>
<span id="cb633-29"><a href="statistics.html#cb633-29" aria-hidden="true" tabindex="-1"></a>st_line_2_lty <span class="ot">&lt;-</span> <span class="st">&#39;dashed&#39;</span></span>
<span id="cb633-30"><a href="statistics.html#cb633-30" aria-hidden="true" tabindex="-1"></a>st_line_3_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotted&#39;</span></span>
<span id="cb633-31"><a href="statistics.html#cb633-31" aria-hidden="true" tabindex="-1"></a>st_line_4_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotdash&#39;</span></span>
<span id="cb633-32"><a href="statistics.html#cb633-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-33"><a href="statistics.html#cb633-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Share xlim and ylim</span></span>
<span id="cb633-34"><a href="statistics.html#cb633-34" aria-hidden="true" tabindex="-1"></a>ar_xlim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="fl">0.75</span>)</span>
<span id="cb633-35"><a href="statistics.html#cb633-35" aria-hidden="true" tabindex="-1"></a>ar_ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="fl">0.75</span>)</span>
<span id="cb633-36"><a href="statistics.html#cb633-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-37"><a href="statistics.html#cb633-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb633-38"><a href="statistics.html#cb633-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb633-39"><a href="statistics.html#cb633-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_1_lty,</span>
<span id="cb633-40"><a href="statistics.html#cb633-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb633-41"><a href="statistics.html#cb633-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb633-42"><a href="statistics.html#cb633-42" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb633-43"><a href="statistics.html#cb633-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_2_lty,</span>
<span id="cb633-44"><a href="statistics.html#cb633-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb633-45"><a href="statistics.html#cb633-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb633-46"><a href="statistics.html#cb633-46" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb633-47"><a href="statistics.html#cb633-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x3, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_3_lty,</span>
<span id="cb633-48"><a href="statistics.html#cb633-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb633-49"><a href="statistics.html#cb633-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb633-50"><a href="statistics.html#cb633-50" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb633-51"><a href="statistics.html#cb633-51" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x4, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_4_lty,</span>
<span id="cb633-52"><a href="statistics.html#cb633-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb633-53"><a href="statistics.html#cb633-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb633-54"><a href="statistics.html#cb633-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-55"><a href="statistics.html#cb633-55" aria-hidden="true" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb633-56"><a href="statistics.html#cb633-56" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb633-57"><a href="statistics.html#cb633-57" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_small <span class="ot">=</span> <span class="fl">0.75</span></span>
<span id="cb633-58"><a href="statistics.html#cb633-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-59"><a href="statistics.html#cb633-59" aria-hidden="true" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb633-60"><a href="statistics.html#cb633-60" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb633-61"><a href="statistics.html#cb633-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.lab=</span>fl_ces_fig_reg,</span>
<span id="cb633-62"><a href="statistics.html#cb633-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.main=</span>fl_ces_fig_reg,</span>
<span id="cb633-63"><a href="statistics.html#cb633-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.sub=</span>fl_ces_fig_small)</span>
<span id="cb633-64"><a href="statistics.html#cb633-64" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb633-65"><a href="statistics.html#cb633-65" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb633-66"><a href="statistics.html#cb633-66" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb633-67"><a href="statistics.html#cb633-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-68"><a href="statistics.html#cb633-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb633-69"><a href="statistics.html#cb633-69" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb633-70"><a href="statistics.html#cb633-70" aria-hidden="true" tabindex="-1"></a>       <span class="at">inset=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="dv">0</span>),</span>
<span id="cb633-71"><a href="statistics.html#cb633-71" aria-hidden="true" tabindex="-1"></a>       <span class="at">xpd=</span><span class="cn">TRUE</span>,</span>
<span id="cb633-72"><a href="statistics.html#cb633-72" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(st_legend1, st_legend2, st_legend3, st_legend4),</span>
<span id="cb633-73"><a href="statistics.html#cb633-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb633-74"><a href="statistics.html#cb633-74" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(st_line_1_lty, st_line_2_lty, st_line_3_lty, st_line_4_lty),</span>
<span id="cb633-75"><a href="statistics.html#cb633-75" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Legends&#39;</span>,</span>
<span id="cb633-76"><a href="statistics.html#cb633-76" aria-hidden="true" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-321-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Programmatically, With different random values, we have:</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="statistics.html#cb634-1" aria-hidden="true" tabindex="-1"></a>it_warning <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb634-2"><a href="statistics.html#cb634-2" aria-hidden="true" tabindex="-1"></a>it_neg <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb634-3"><a href="statistics.html#cb634-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_rand_seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb634-4"><a href="statistics.html#cb634-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate two marginal MASS</span></span>
<span id="cb634-5"><a href="statistics.html#cb634-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_rand_seed)</span>
<span id="cb634-6"><a href="statistics.html#cb634-6" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span>)</span>
<span id="cb634-7"><a href="statistics.html#cb634-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_E_marginal &lt;- c(0.01, 0.99)</span></span>
<span id="cb634-8"><a href="statistics.html#cb634-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_E_marginal &lt;- c(0.49, 0.51)</span></span>
<span id="cb634-9"><a href="statistics.html#cb634-9" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> ar_E_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_E_marginal)</span>
<span id="cb634-10"><a href="statistics.html#cb634-10" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span>)</span>
<span id="cb634-11"><a href="statistics.html#cb634-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_A_marginal &lt;- c(0.01, 0.99)</span></span>
<span id="cb634-12"><a href="statistics.html#cb634-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_A_marginal &lt;- c(0.01, 0.99)</span></span>
<span id="cb634-13"><a href="statistics.html#cb634-13" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> ar_A_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_A_marginal)</span>
<span id="cb634-14"><a href="statistics.html#cb634-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_E_marginal)</span></span>
<span id="cb634-15"><a href="statistics.html#cb634-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_A_marginal)</span></span>
<span id="cb634-16"><a href="statistics.html#cb634-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Differences in Marginal Points</span></span>
<span id="cb634-17"><a href="statistics.html#cb634-17" aria-hidden="true" tabindex="-1"></a>  ar_delta_E <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb634-18"><a href="statistics.html#cb634-18" aria-hidden="true" tabindex="-1"></a>  ar_delta_A <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb634-19"><a href="statistics.html#cb634-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(paste0(&#39;deltaE + deltaA:&#39;, diff(ar_E_marginal) + diff(ar_A_marginal)))</span></span>
<span id="cb634-20"><a href="statistics.html#cb634-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some cell negativity condition:</span></span>
<span id="cb634-21"><a href="statistics.html#cb634-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">diff</span>(ar_E_marginal))) <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">diff</span>(ar_A_marginal))) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb634-22"><a href="statistics.html#cb634-22" aria-hidden="true" tabindex="-1"></a>    it_warning <span class="ot">=</span> it_warning <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb634-23"><a href="statistics.html#cb634-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># warning(&#39;Outside of Diamond, Rectilinear Restriction Leads to Negative Values in Some Cells\n&#39;)</span></span>
<span id="cb634-24"><a href="statistics.html#cb634-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb634-25"><a href="statistics.html#cb634-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># What is P(A1,E1), implemetning the formula above</span></span>
<span id="cb634-26"><a href="statistics.html#cb634-26" aria-hidden="true" tabindex="-1"></a>  fl_P_A1_E1 <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">rbind</span>(ar_delta_E, ar_delta_A) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">2</span>))))<span class="sc">/</span>(<span class="dv">4</span>)</span>
<span id="cb634-27"><a href="statistics.html#cb634-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Getting the Entire P_A_E matrix</span></span>
<span id="cb634-28"><a href="statistics.html#cb634-28" aria-hidden="true" tabindex="-1"></a>  mt_P_A_E <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb634-29"><a href="statistics.html#cb634-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_E_marginal)){</span>
<span id="cb634-30"><a href="statistics.html#cb634-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_A_marginal)){</span>
<span id="cb634-31"><a href="statistics.html#cb634-31" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_P_A1_E1</span>
<span id="cb634-32"><a href="statistics.html#cb634-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb634-33"><a href="statistics.html#cb634-33" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_E[<span class="dv">1</span><span class="sc">:</span>(it_row<span class="dv">-1</span>)])</span>
<span id="cb634-34"><a href="statistics.html#cb634-34" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb634-35"><a href="statistics.html#cb634-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb634-36"><a href="statistics.html#cb634-36" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_A[<span class="dv">1</span><span class="sc">:</span>(it_col<span class="dv">-1</span>)])</span>
<span id="cb634-37"><a href="statistics.html#cb634-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb634-38"><a href="statistics.html#cb634-38" aria-hidden="true" tabindex="-1"></a>      mt_P_A_E[it_row, it_col] <span class="ot">=</span> fl_p_value</span>
<span id="cb634-39"><a href="statistics.html#cb634-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb634-40"><a href="statistics.html#cb634-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb634-41"><a href="statistics.html#cb634-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(mt_P_A_E)</span></span>
<span id="cb634-42"><a href="statistics.html#cb634-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(mt_P_A_E)</span>
<span id="cb634-43"><a href="statistics.html#cb634-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(mt_P_A_E)</span>
<span id="cb634-44"><a href="statistics.html#cb634-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(mt_P_A_E)</span>
<span id="cb634-45"><a href="statistics.html#cb634-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(mt_P_A_E[mt_P_A_E<span class="sc">&lt;</span><span class="dv">0</span>])<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb634-46"><a href="statistics.html#cb634-46" aria-hidden="true" tabindex="-1"></a>      it_neg <span class="ot">=</span> it_neg <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb634-47"><a href="statistics.html#cb634-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb634-48"><a href="statistics.html#cb634-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb634-49"><a href="statistics.html#cb634-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_warning:&#39;</span>,it_warning))</span></code></pre></div>
<pre><code>## [1] &quot;it_warning:283&quot;</code></pre>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="statistics.html#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_neg:&#39;</span>,it_neg))</span></code></pre></div>
<pre><code>## [1] &quot;it_neg:283&quot;</code></pre>
</div>
<div id="restricted-joint-3-by-3-distribution" class="section level4" number="9.3.2.4">
<h4><span class="header-section-number">9.3.2.4</span> Restricted Joint 3 by 3 Distribution</h4>
<p>The idea can be applied to when there are three discrete random outcomes along each dimension. Find an unique 3 by 3 probability joint mass distribution from marginal distributions. Similar to the 2 by 2 case, only when marginal mass changes are within a change diamond will this method lead to positive mass at all points of the joint distribution.</p>
<p>Given this assumption:</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = P(A_1,E_2) - P(A_1,E_1) = P(A_2,E_2) - P(A_2,E_1) = P(A_3,E_2) - P(A_3,E_1)\\
\Delta^{E}_{23} = P(A_1,E_3) - P(A_1,E_2) = P(A_2,E_3) - P(A_2,E_2) = P(A_3,E_3) - P(A_3,E_2)\\
\Delta^{A}_{12} = P(A_2,E_1) - P(A_1,E_1) = P(A_2,E_2) - P(A_1,E_2) = P(A_2,E_3) - P(A_1,E_3)\\
\Delta^{A}_{23} = P(A_3,E_1) - P(A_2,E_1) = P(A_3,E_2) - P(A_2,E_2) = P(A_3,E_3) - P(A_2,E_3)\\
\end{aligned}
\]</span></p>
<p>Following the two by two example, the restriction above just means we can use the differences between the marginal distribution’s discrete points to back out.</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = \frac{P(A_2) - P(A_1)}{3}\\
\Delta^{E}_{23} = \frac{P(A_3) - P(A_2)}{3}\\
\Delta^{A}_{12} = \frac{P(E_2) - P(E_1)}{3}\\
\Delta^{A}_{23} = \frac{P(E_3) - P(E_2)}{3}
\end{aligned}
\]</span></p>
<p>Given these <span class="math inline">\(\Delta\)</span> values, we can solve for <span class="math inline">\((A_1, E_1)\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
1 = 3 \cdot 3 \cdot P(A_1, E_1) + \Delta^{E}_{12}\cdot 3 \cdot (3-1) + \Delta^{E}_{23}\cdot 3 + \Delta^{A}_{12}\cdot 3 \cdot (3-1) + \Delta^{A}_{12}\cdot 3 \\
P(A_1, E_1) =
\frac{1}{9}
\left(
  1
  - \Delta^{E}_{12}\cdot 3 \cdot (3-1)
  - \Delta^{E}_{23}\cdot 3
  - \Delta^{A}_{12}\cdot 3 \cdot (3-1)
  - \Delta^{A}_{12}\cdot 3
\right)
\end{aligned}
\]</span>
In Matrix form:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1) =
\frac{1}{3\cdot 3}
\left(
1 -
\begin{aligned}
\begin{bmatrix}
1 &amp; 1 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\Delta^{E}_{12} &amp; \Delta^{E}_{23} \\
\Delta^{A}_{12} &amp; \Delta^{A}_{23} \\
\end{bmatrix}
\cdot
\begin{bmatrix}
3\cdot\left(3-1\right) \\
3
\end{bmatrix}
\end{aligned}
\right)
\end{aligned}
\]</span></p>
<p>Following the 2 by 2 case, the condition needed for positive mass at all points is:
<span class="math display">\[
\mid \Delta^{A}_{12} \mid + \mid \Delta^{A}_{23} \mid + \mid \Delta^{E}_{12} + \mid \Delta^{E}_{23} \mid \le \frac{1}{3}
\]</span></p>
<p>Implementing the formulas, we have:</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="statistics.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate two marginal MASS</span></span>
<span id="cb638-2"><a href="statistics.html#cb638-2" aria-hidden="true" tabindex="-1"></a>it_warning <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb638-3"><a href="statistics.html#cb638-3" aria-hidden="true" tabindex="-1"></a>it_neg <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb638-4"><a href="statistics.html#cb638-4" aria-hidden="true" tabindex="-1"></a>it_concur <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb638-5"><a href="statistics.html#cb638-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_rand_seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb638-6"><a href="statistics.html#cb638-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_rand_seed)</span>
<span id="cb638-7"><a href="statistics.html#cb638-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set.seed(333)</span></span>
<span id="cb638-8"><a href="statistics.html#cb638-8" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb638-9"><a href="statistics.html#cb638-9" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> ar_E_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_E_marginal)</span>
<span id="cb638-10"><a href="statistics.html#cb638-10" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb638-11"><a href="statistics.html#cb638-11" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> ar_A_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_A_marginal)</span>
<span id="cb638-12"><a href="statistics.html#cb638-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_E_marginal)</span></span>
<span id="cb638-13"><a href="statistics.html#cb638-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_A_marginal)</span></span>
<span id="cb638-14"><a href="statistics.html#cb638-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Differences in Marginal Points</span></span>
<span id="cb638-15"><a href="statistics.html#cb638-15" aria-hidden="true" tabindex="-1"></a>  ar_delta_E_m <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)</span>
<span id="cb638-16"><a href="statistics.html#cb638-16" aria-hidden="true" tabindex="-1"></a>  ar_delta_A_m <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)</span>
<span id="cb638-17"><a href="statistics.html#cb638-17" aria-hidden="true" tabindex="-1"></a>  ar_delta_E <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb638-18"><a href="statistics.html#cb638-18" aria-hidden="true" tabindex="-1"></a>  ar_delta_A <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb638-19"><a href="statistics.html#cb638-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some cell negativity condition: this condition is incorrect</span></span>
<span id="cb638-20"><a href="statistics.html#cb638-20" aria-hidden="true" tabindex="-1"></a>  bl_count_warn <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb638-21"><a href="statistics.html#cb638-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_delta_E)){</span>
<span id="cb638-22"><a href="statistics.html#cb638-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_delta_A)){</span>
<span id="cb638-23"><a href="statistics.html#cb638-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ((<span class="fu">abs</span>(<span class="fu">sum</span>(ar_delta_E_m[<span class="dv">1</span><span class="sc">:</span>it_row])) <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">sum</span>(ar_delta_A_m[<span class="dv">1</span><span class="sc">:</span>it_col]))) <span class="sc">&gt;</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>) {</span>
<span id="cb638-24"><a href="statistics.html#cb638-24" aria-hidden="true" tabindex="-1"></a>        bl_count_warn <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb638-25"><a href="statistics.html#cb638-25" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb638-26"><a href="statistics.html#cb638-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ((<span class="fu">abs</span>(ar_delta_E_m[it_row]) <span class="sc">+</span> <span class="fu">abs</span>(ar_delta_A_m[it_col])) <span class="sc">&gt;</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>) {</span>
<span id="cb638-27"><a href="statistics.html#cb638-27" aria-hidden="true" tabindex="-1"></a>        bl_count_warn <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb638-28"><a href="statistics.html#cb638-28" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb638-29"><a href="statistics.html#cb638-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb638-30"><a href="statistics.html#cb638-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb638-31"><a href="statistics.html#cb638-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_count_warn) {</span>
<span id="cb638-32"><a href="statistics.html#cb638-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if (max(abs(diff(ar_E_marginal))) + max(abs(diff(ar_A_marginal))) &gt; 2/3){</span></span>
<span id="cb638-33"><a href="statistics.html#cb638-33" aria-hidden="true" tabindex="-1"></a>    it_warning <span class="ot">=</span> it_warning <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb638-34"><a href="statistics.html#cb638-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb638-35"><a href="statistics.html#cb638-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># warning(&#39;Outside of Diamond, Rectilinear Restriction Leads to Negative Values in Some Cells\n&#39;)</span></span>
<span id="cb638-36"><a href="statistics.html#cb638-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb638-37"><a href="statistics.html#cb638-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># What is P(A1,E1), implemetning the formula above</span></span>
<span id="cb638-38"><a href="statistics.html#cb638-38" aria-hidden="true" tabindex="-1"></a>  fl_P_A1_E1 <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">rbind</span>(ar_delta_E, ar_delta_A) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>, <span class="dv">3</span>))))<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb638-39"><a href="statistics.html#cb638-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Getting the Entire P_A_E matrix</span></span>
<span id="cb638-40"><a href="statistics.html#cb638-40" aria-hidden="true" tabindex="-1"></a>  mt_P_A_E <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb638-41"><a href="statistics.html#cb638-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_E_marginal)){</span>
<span id="cb638-42"><a href="statistics.html#cb638-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_A_marginal)){</span>
<span id="cb638-43"><a href="statistics.html#cb638-43" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_P_A1_E1</span>
<span id="cb638-44"><a href="statistics.html#cb638-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb638-45"><a href="statistics.html#cb638-45" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_E[<span class="dv">1</span><span class="sc">:</span>(it_row<span class="dv">-1</span>)])</span>
<span id="cb638-46"><a href="statistics.html#cb638-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb638-47"><a href="statistics.html#cb638-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb638-48"><a href="statistics.html#cb638-48" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_A[<span class="dv">1</span><span class="sc">:</span>(it_col<span class="dv">-1</span>)])</span>
<span id="cb638-49"><a href="statistics.html#cb638-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb638-50"><a href="statistics.html#cb638-50" aria-hidden="true" tabindex="-1"></a>      mt_P_A_E[it_row, it_col] <span class="ot">=</span> fl_p_value</span>
<span id="cb638-51"><a href="statistics.html#cb638-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb638-52"><a href="statistics.html#cb638-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb638-53"><a href="statistics.html#cb638-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(mt_P_A_E)</span></span>
<span id="cb638-54"><a href="statistics.html#cb638-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(mt_P_A_E)</span>
<span id="cb638-55"><a href="statistics.html#cb638-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(mt_P_A_E)</span>
<span id="cb638-56"><a href="statistics.html#cb638-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(mt_P_A_E)</span>
<span id="cb638-57"><a href="statistics.html#cb638-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(mt_P_A_E[mt_P_A_E<span class="sc">&lt;</span><span class="dv">0</span>])<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb638-58"><a href="statistics.html#cb638-58" aria-hidden="true" tabindex="-1"></a>      it_neg <span class="ot">=</span> it_neg <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb638-59"><a href="statistics.html#cb638-59" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (bl_count_warn) {</span>
<span id="cb638-60"><a href="statistics.html#cb638-60" aria-hidden="true" tabindex="-1"></a>        it_concur <span class="ot">=</span> it_concur <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb638-61"><a href="statistics.html#cb638-61" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb638-62"><a href="statistics.html#cb638-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb638-63"><a href="statistics.html#cb638-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb638-64"><a href="statistics.html#cb638-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_warning:&#39;</span>,it_warning))</span></code></pre></div>
<pre><code>## [1] &quot;it_warning:797&quot;</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="statistics.html#cb640-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_neg:&#39;</span>,it_neg))</span></code></pre></div>
<pre><code>## [1] &quot;it_neg:592&quot;</code></pre>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="statistics.html#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_concur:&#39;</span>,it_concur))</span></code></pre></div>
<pre><code>## [1] &quot;it_concur:592&quot;</code></pre>
</div>
<div id="restricted-joint-5-by-5-distribution" class="section level4" number="9.3.2.5">
<h4><span class="header-section-number">9.3.2.5</span> Restricted Joint 5 by 5 Distribution</h4>
<p>For a Five by Five Problem, we have:</p>
<p>In Matrix form:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1) =
\frac{1}{5\cdot 5}
\left(
1 -
\begin{aligned}
\begin{bmatrix}
1 &amp; 1 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\Delta^{E}_{12} &amp; \Delta^{E}_{23} &amp; \Delta^{E}_{34} &amp; \Delta^{E}_{45} \\
\Delta^{A}_{45} &amp; \Delta^{A}_{45} &amp; \Delta^{A}_{45} &amp; \Delta^{A}_{45} \\
\end{bmatrix}
\cdot
\begin{bmatrix}
5\cdot4 \\
5\cdot3 \\
5\cdot2 \\
5\cdot1 \\
\end{bmatrix}
\end{aligned}
\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="statistics.html#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pi_j=[0.22;0.175;0.16;0.165;0.22]; % Probability of unemployment in 2020 by age groups from Cajner et al. (2020, NBER)</span></span>
<span id="cb644-2"><a href="statistics.html#cb644-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pi_w=[0.360;0.22;0.17;0.14;0.09]; % Probability of unemployment in 2020 by wage quintiles from Cajner et al. (2020, NBER)</span></span>
<span id="cb644-3"><a href="statistics.html#cb644-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate two marginal MASS</span></span>
<span id="cb644-4"><a href="statistics.html#cb644-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb644-5"><a href="statistics.html#cb644-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(333)</span></span>
<span id="cb644-6"><a href="statistics.html#cb644-6" aria-hidden="true" tabindex="-1"></a>ar_E_marginal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.22</span>, <span class="fl">0.175</span>, <span class="fl">0.16</span>, <span class="fl">0.165</span>, <span class="fl">0.22</span>)</span>
<span id="cb644-7"><a href="statistics.html#cb644-7" aria-hidden="true" tabindex="-1"></a>ar_E_marginal <span class="ot">&lt;-</span> ar_E_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_E_marginal)</span>
<span id="cb644-8"><a href="statistics.html#cb644-8" aria-hidden="true" tabindex="-1"></a>ar_A_marginal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.360</span>, <span class="fl">0.22</span>, <span class="fl">0.17</span>, <span class="fl">0.14</span>, <span class="fl">0.09</span>)</span>
<span id="cb644-9"><a href="statistics.html#cb644-9" aria-hidden="true" tabindex="-1"></a>ar_A_marginal <span class="ot">&lt;-</span> ar_A_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_A_marginal)</span>
<span id="cb644-10"><a href="statistics.html#cb644-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ar_E_marginal)</span></code></pre></div>
<pre><code>## [1] 0.2340426 0.1861702 0.1702128 0.1755319 0.2340426</code></pre>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="statistics.html#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ar_A_marginal)</span></code></pre></div>
<pre><code>## [1] 0.36734694 0.22448980 0.17346939 0.14285714 0.09183673</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="statistics.html#cb648-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Differences in Marginal Points</span></span>
<span id="cb648-2"><a href="statistics.html#cb648-2" aria-hidden="true" tabindex="-1"></a>ar_delta_E <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb648-3"><a href="statistics.html#cb648-3" aria-hidden="true" tabindex="-1"></a>ar_delta_A <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb648-4"><a href="statistics.html#cb648-4" aria-hidden="true" tabindex="-1"></a><span class="co"># What is P(A1,E1), implemetning the formula above</span></span>
<span id="cb648-5"><a href="statistics.html#cb648-5" aria-hidden="true" tabindex="-1"></a>fl_P_A1_E1 <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">rbind</span>(ar_delta_E, ar_delta_A) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">15</span>,<span class="dv">10</span>,<span class="dv">5</span>))))<span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">5</span>)</span>
<span id="cb648-6"><a href="statistics.html#cb648-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the Entire P_A_E matrix</span></span>
<span id="cb648-7"><a href="statistics.html#cb648-7" aria-hidden="true" tabindex="-1"></a>mt_P_A_E <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb648-8"><a href="statistics.html#cb648-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_E_marginal)){</span>
<span id="cb648-9"><a href="statistics.html#cb648-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_A_marginal)){</span>
<span id="cb648-10"><a href="statistics.html#cb648-10" aria-hidden="true" tabindex="-1"></a>    fl_p_value <span class="ot">=</span> fl_P_A1_E1</span>
<span id="cb648-11"><a href="statistics.html#cb648-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (it_row <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb648-12"><a href="statistics.html#cb648-12" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_E[<span class="dv">1</span><span class="sc">:</span>(it_row<span class="dv">-1</span>)])</span>
<span id="cb648-13"><a href="statistics.html#cb648-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb648-14"><a href="statistics.html#cb648-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (it_col <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb648-15"><a href="statistics.html#cb648-15" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_A[<span class="dv">1</span><span class="sc">:</span>(it_col<span class="dv">-1</span>)])</span>
<span id="cb648-16"><a href="statistics.html#cb648-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb648-17"><a href="statistics.html#cb648-17" aria-hidden="true" tabindex="-1"></a>    mt_P_A_E[it_row, it_col] <span class="ot">=</span> fl_p_value</span>
<span id="cb648-18"><a href="statistics.html#cb648-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb648-19"><a href="statistics.html#cb648-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb648-20"><a href="statistics.html#cb648-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] 0.08027790 0.05170647 0.04150239 0.03537994 0.02517586
## [2,] 0.07070343 0.04213200 0.03192792 0.02580547 0.01560139
## [3,] 0.06751194 0.03894051 0.02873643 0.02261398 0.01240990
## [4,] 0.06857577 0.04000434 0.02980026 0.02367781 0.01347373
## [5,] 0.08027790 0.05170647 0.04150239 0.03537994 0.02517586</code></pre>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="statistics.html#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="statistics.html#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>## [1] 0.2340426 0.1861702 0.1702128 0.1755319 0.2340426</code></pre>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="statistics.html#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>## [1] 0.36734694 0.22448980 0.17346939 0.14285714 0.09183673</code></pre>

</div>
</div>
<div id="obtaining-joint-distribution-from-conditional-with-rectilinear-restrictions" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Obtaining Joint Distribution from Conditional with Rectilinear Restrictions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="by-2-joint-from-marginal-probability-mass-functions" class="section level4" number="9.3.3.1">
<h4><span class="header-section-number">9.3.3.1</span> 2 by 2 Joint from Marginal Probability Mass Functions</h4>
<p>We know the <span class="math inline">\(P(U|E)\)</span>, the probability of unemployment by educational types. I also know <span class="math inline">\(P(U|A)\)</span>, the probability of unemployment by age groups. Additionally, I also know the <span class="math inline">\(P(E,A)\)</span>, the mass of individuals at discrete <span class="math inline">\((E,A)\)</span> combinations. What is the <span class="math inline">\(P(U|E,A)\)</span>, the probability of unemployment by age and education groups?</p>
<div id="generate-data-structure" class="section level5" number="9.3.3.1.1">
<h5><span class="header-section-number">9.3.3.1.1</span> Generate Data Structure</h5>
<p>Generate the data structure. First, a function that generates random joint probabilities of mass at different points. This data-structure will work for 2 by 2, 3 by 3, or 4 by 4 problems.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="statistics.html#cb656-1" aria-hidden="true" tabindex="-1"></a>ffi_gen_rand_joint_mass <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">it_seed =</span> <span class="dv">123</span>,</span>
<span id="cb656-2"><a href="statistics.html#cb656-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>,</span>
<span id="cb656-3"><a href="statistics.html#cb656-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb656-4"><a href="statistics.html#cb656-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-5"><a href="statistics.html#cb656-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set random seed</span></span>
<span id="cb656-6"><a href="statistics.html#cb656-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_seed)</span>
<span id="cb656-7"><a href="statistics.html#cb656-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-8"><a href="statistics.html#cb656-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate prob list</span></span>
<span id="cb656-9"><a href="statistics.html#cb656-9" aria-hidden="true" tabindex="-1"></a>  ls_2d <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> it_Q<span class="sc">*</span>it_M)</span>
<span id="cb656-10"><a href="statistics.html#cb656-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(ls_2d) <span class="ot">&lt;-</span> <span class="fu">c</span>(it_Q, it_M)</span>
<span id="cb656-11"><a href="statistics.html#cb656-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-12"><a href="statistics.html#cb656-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Random joint mass</span></span>
<span id="cb656-13"><a href="statistics.html#cb656-13" aria-hidden="true" tabindex="-1"></a>  ar_rand <span class="ot">&lt;-</span> <span class="fu">runif</span>(it_Q<span class="sc">*</span>it_M)</span>
<span id="cb656-14"><a href="statistics.html#cb656-14" aria-hidden="true" tabindex="-1"></a>  ar_rand <span class="ot">&lt;-</span> ar_rand<span class="sc">/</span><span class="fu">sum</span>(ar_rand)</span>
<span id="cb656-15"><a href="statistics.html#cb656-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-16"><a href="statistics.html#cb656-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill with values</span></span>
<span id="cb656-17"><a href="statistics.html#cb656-17" aria-hidden="true" tabindex="-1"></a>  it_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb656-18"><a href="statistics.html#cb656-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_Q_ctr <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,it_Q)) {</span>
<span id="cb656-19"><a href="statistics.html#cb656-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_M_ctr <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,it_M)) {</span>
<span id="cb656-20"><a href="statistics.html#cb656-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># linear index</span></span>
<span id="cb656-21"><a href="statistics.html#cb656-21" aria-hidden="true" tabindex="-1"></a>      ls_2d[[it_M_ctr, it_Q_ctr]] <span class="ot">&lt;-</span> ar_rand[(it_Q_ctr<span class="dv">-1</span>)<span class="sc">*</span>it_M<span class="sc">+</span>it_M_ctr]</span>
<span id="cb656-22"><a href="statistics.html#cb656-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb656-23"><a href="statistics.html#cb656-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb656-24"><a href="statistics.html#cb656-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-25"><a href="statistics.html#cb656-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace row names, note rownames does not work</span></span>
<span id="cb656-26"><a href="statistics.html#cb656-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dimnames</span>(ls_2d)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;E&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span>,it_M))</span>
<span id="cb656-27"><a href="statistics.html#cb656-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dimnames</span>(ls_2d)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;A&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span>,it_Q))</span>
<span id="cb656-28"><a href="statistics.html#cb656-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-29"><a href="statistics.html#cb656-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename</span></span>
<span id="cb656-30"><a href="statistics.html#cb656-30" aria-hidden="true" tabindex="-1"></a>  ls_prob_joint_E_A <span class="ot">&lt;-</span> ls_2d</span>
<span id="cb656-31"><a href="statistics.html#cb656-31" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(ls_prob_joint_E_A), <span class="at">ncol=</span>it_M, <span class="at">byrow=</span>F)</span>
<span id="cb656-32"><a href="statistics.html#cb656-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-33"><a href="statistics.html#cb656-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb656-34"><a href="statistics.html#cb656-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;ls_prob_joint_E_A&#39;</span>)</span>
<span id="cb656-35"><a href="statistics.html#cb656-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ls_prob_joint_E_A)</span>
<span id="cb656-36"><a href="statistics.html#cb656-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(mt_prob_joint_E_A)</span>
<span id="cb656-37"><a href="statistics.html#cb656-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb656-38"><a href="statistics.html#cb656-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-39"><a href="statistics.html#cb656-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb656-40"><a href="statistics.html#cb656-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mt_prob_joint_E_A=</span>mt_prob_joint_E_A,</span>
<span id="cb656-41"><a href="statistics.html#cb656-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">ls_prob_joint_E_A=</span>ls_prob_joint_E_A))</span>
<span id="cb656-42"><a href="statistics.html#cb656-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Second, given joint mass at different points, generate conditional unemployment probabilities along each discrete variable’s values that works for 2 by 2 case. We have two unique levels for E and for A separately, so these are four points where there is mass. Generate random mass at these points. Then generate given these four additional mass points: <span class="math inline">\(F=P(A_1|E_1)\)</span>, <span class="math inline">\(B=P(A_1|E_2)\)</span>, <span class="math inline">\(C=P(E_1|A_1)\)</span>, <span class="math inline">\(D=P(E_1|A_2)\)</span>. Use code from <a href="https://fanwangecon.github.io/R4Econ/amto/list/htmlpdfr/fs_lst_basics.html#16_Define_Two_Dimensional_Named_LIst">fs_lst_basics</a>.</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="statistics.html#cb657-1" aria-hidden="true" tabindex="-1"></a>ffi_gen_condi_unemploy_prob_2by2 <span class="ot">&lt;-</span> <span class="cf">function</span>(mt_prob_joint_E_A,</span>
<span id="cb657-2"><a href="statistics.html#cb657-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fl_alpha =</span> <span class="fl">0.25</span>, <span class="at">fl_beta =</span> <span class="fl">0.05</span>,</span>
<span id="cb657-3"><a href="statistics.html#cb657-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fl_gamma =</span> <span class="fl">0.31</span>, <span class="at">fl_delta =</span> <span class="fl">0.50</span>,</span>
<span id="cb657-4"><a href="statistics.html#cb657-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb657-5"><a href="statistics.html#cb657-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-6"><a href="statistics.html#cb657-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># From joint probability, generate conditional probabilities</span></span>
<span id="cb657-7"><a href="statistics.html#cb657-7" aria-hidden="true" tabindex="-1"></a>  fl_F <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb657-8"><a href="statistics.html#cb657-8" aria-hidden="true" tabindex="-1"></a>  fl_B <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb657-9"><a href="statistics.html#cb657-9" aria-hidden="true" tabindex="-1"></a>  fl_C <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb657-10"><a href="statistics.html#cb657-10" aria-hidden="true" tabindex="-1"></a>  fl_D <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb657-11"><a href="statistics.html#cb657-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb657-12"><a href="statistics.html#cb657-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_F=&#39;</span>, fl_F, <span class="st">&#39;,fl_B=&#39;</span>,fl_B,<span class="st">&#39;,fl_C=&#39;</span>,fl_C,<span class="st">&#39;,fl_D=&#39;</span>,fl_D))</span>
<span id="cb657-13"><a href="statistics.html#cb657-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb657-14"><a href="statistics.html#cb657-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-15"><a href="statistics.html#cb657-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Also generate random W X Y Z</span></span>
<span id="cb657-16"><a href="statistics.html#cb657-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_b &lt;- runif(4)</span></span>
<span id="cb657-17"><a href="statistics.html#cb657-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-18"><a href="statistics.html#cb657-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_Delta_A_true &lt;- 0.05</span></span>
<span id="cb657-19"><a href="statistics.html#cb657-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_Delta_E_true &lt;- 0.11</span></span>
<span id="cb657-20"><a href="statistics.html#cb657-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-21"><a href="statistics.html#cb657-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_alpha_true &lt;- 0.25</span></span>
<span id="cb657-22"><a href="statistics.html#cb657-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_beta_true &lt;- fl_alpha_true + fl_Delta_A_true</span></span>
<span id="cb657-23"><a href="statistics.html#cb657-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_gamma_true &lt;- fl_alpha_true + fl_Delta_E_true</span></span>
<span id="cb657-24"><a href="statistics.html#cb657-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_delta_true &lt;- fl_alpha_true + fl_Delta_E_true + fl_Delta_A_true</span></span>
<span id="cb657-25"><a href="statistics.html#cb657-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-26"><a href="statistics.html#cb657-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_beta_true &lt;- 0.31</span></span>
<span id="cb657-27"><a href="statistics.html#cb657-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_gamma_true &lt;- 0.50</span></span>
<span id="cb657-28"><a href="statistics.html#cb657-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_delta_true &lt;- 0.16</span></span>
<span id="cb657-29"><a href="statistics.html#cb657-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-30"><a href="statistics.html#cb657-30" aria-hidden="true" tabindex="-1"></a>  fl_W <span class="ot">&lt;-</span> fl_alpha<span class="sc">*</span>fl_F <span class="sc">+</span> fl_beta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_F)</span>
<span id="cb657-31"><a href="statistics.html#cb657-31" aria-hidden="true" tabindex="-1"></a>  fl_X <span class="ot">&lt;-</span> fl_gamma<span class="sc">*</span>fl_B <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_B)</span>
<span id="cb657-32"><a href="statistics.html#cb657-32" aria-hidden="true" tabindex="-1"></a>  fl_Y <span class="ot">&lt;-</span> fl_alpha<span class="sc">*</span>fl_C <span class="sc">+</span> fl_gamma<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_C)</span>
<span id="cb657-33"><a href="statistics.html#cb657-33" aria-hidden="true" tabindex="-1"></a>  fl_Z <span class="ot">&lt;-</span> fl_beta<span class="sc">*</span>fl_D <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_D)</span>
<span id="cb657-34"><a href="statistics.html#cb657-34" aria-hidden="true" tabindex="-1"></a>  fl_V <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_alpha_true <span class="sc">+</span></span>
<span id="cb657-35"><a href="statistics.html#cb657-35" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_beta_true <span class="sc">+</span></span>
<span id="cb657-36"><a href="statistics.html#cb657-36" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_gamma_true <span class="sc">+</span></span>
<span id="cb657-37"><a href="statistics.html#cb657-37" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_delta_true</span>
<span id="cb657-38"><a href="statistics.html#cb657-38" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">c</span>(fl_W, fl_X, fl_Y, fl_Z)</span>
<span id="cb657-39"><a href="statistics.html#cb657-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-40"><a href="statistics.html#cb657-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb657-41"><a href="statistics.html#cb657-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;ar_b=&#39;</span>,ar_b))</span>
<span id="cb657-42"><a href="statistics.html#cb657-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_V=&#39;</span>,fl_V))</span>
<span id="cb657-43"><a href="statistics.html#cb657-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb657-44"><a href="statistics.html#cb657-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-45"><a href="statistics.html#cb657-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb657-46"><a href="statistics.html#cb657-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">F=</span>fl_F, <span class="at">B=</span>fl_B, <span class="at">C=</span>fl_C, <span class="at">D=</span>fl_D,</span>
<span id="cb657-47"><a href="statistics.html#cb657-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">W=</span>fl_W, <span class="at">X=</span>fl_X, <span class="at">Y=</span>fl_Y, <span class="at">Z=</span>fl_Z, <span class="at">V=</span>fl_V))</span>
<span id="cb657-48"><a href="statistics.html#cb657-48" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="unrestricted-joint-2-by-2-distribution-1" class="section level5" number="9.3.3.1.2">
<h5><span class="header-section-number">9.3.3.1.2</span> Unrestricted Joint 2 by 2 Distribution</h5>
<p>Suppose there are two unique states for <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span>. For example, suppose we know the unemployment probability for better or worse educated, and also for low and high age groups. We also know the proportion of people who are in each one of the four cells (regardless of unemployment or not). We also know the aggregate proportion of people in the population that is unemployed.</p>
<p>We want to know the joint probability of unemployment for the four types: both better educated and lower age, better educated and higher age, worse educated and lower age, and worse educated and higher age. Then:</p>
<p><span class="math display">\[
\begin{aligned}
P(U|E_1) &amp;= P(U|A_1, E_1) \cdot P(A_1|E_1) + P(U|A_2, E_1) \cdot P(A_2|E_1)\\
P(U|E_2) &amp;= P(U|A_1, E_2) \cdot P(A_1|E_2) + P(U|A_2, E_2) \cdot P(A_2|E_2)\\
P(U|A_1) &amp;= P(U|A_1, E_1) \cdot P(E_1|A_1) + P(U|A_1, E_2) \cdot P(E_2|A_1)\\
P(U|A_2) &amp;= P(U|A_2, E_1) \cdot P(E_1|A_2) + P(U|A_2, E_2) \cdot P(E_2|A_2)\\
\end{aligned}
\]</span></p>
<p>And, we also have the extra equation:</p>
<p><span class="math display">\[
P(U) = P(U|A_1, E_1) \cdot P(E_1, A_1) + P(U|A_2, E_1) \cdot P(E_2, A_1) + P(U|A_1, E_2) \cdot P(E_1, A_2) + P(U|A_2, E_2) \cdot P(E_2, A_2)
\]</span></p>
<p>We know <span class="math inline">\(P(A|E)\)</span>, and we know <span class="math inline">\(P(U|E)\)</span> as well as <span class="math inline">\(P(U|A)\)</span>. Let Roman letter represent what we know, and greek letters represent what we do not know, then we have four equations and four unknowns in a linear system. We use the letter F because A and E are taken.</p>
<p><span class="math display">\[
\begin{aligned}
W = \alpha F + \beta (1-F)\\
X = \gamma B + \delta (1-B)\\
Y = \alpha C + \gamma (1-C)\\
Z = \beta D + \delta (1-D)\\
\end{aligned}
\]</span></p>
<p>And we have also:</p>
<p><span class="math display">\[
V = \alpha P(E_1, A_1) + \beta P(E_2, A_1) + \gamma P(E_1, A_2) + \delta P(E_2, A_2)
\]</span></p>
<p>There are no unique solutions for the linear system. When we write the linear system above in matrix form as shown below, the <span class="math inline">\(\Omega\)</span> coefficient matrix is not full rank.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
F &amp; (1-F) &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; B &amp; (1-B) \\
C &amp; 0 &amp; (1-C) &amp; 0 \\
0 &amp; D &amp; 0 &amp; (1-D) \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\beta \\
\gamma \\
\delta
\end{bmatrix}
&amp; =
\begin{bmatrix}
W \\
X \\
Y \\
Z \\
\end{bmatrix}\\
\Omega \cdot \mathbb{X} &amp; =  b
\end{aligned}
\]</span></p>
<p>Get data from the data generation functions created prior:</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="statistics.html#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="co"># JOint mass of population at all cells</span></span>
<span id="cb658-2"><a href="statistics.html#cb658-2" aria-hidden="true" tabindex="-1"></a>ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(<span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>, <span class="at">bl_verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ls_prob_joint_E_A&quot;
##    A1        A2       
## E1 0.1214495 0.1727188
## E2 0.3329164 0.3729152
##           [,1]      [,2]
## [1,] 0.1214495 0.1727188
## [2,] 0.3329164 0.3729152</code></pre>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="statistics.html#cb660-1" aria-hidden="true" tabindex="-1"></a>mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb660-2"><a href="statistics.html#cb660-2" aria-hidden="true" tabindex="-1"></a><span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb660-3"><a href="statistics.html#cb660-3" aria-hidden="true" tabindex="-1"></a>fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb660-4"><a href="statistics.html#cb660-4" aria-hidden="true" tabindex="-1"></a>fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb660-5"><a href="statistics.html#cb660-5" aria-hidden="true" tabindex="-1"></a>fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb660-6"><a href="statistics.html#cb660-6" aria-hidden="true" tabindex="-1"></a>fl_beta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb660-7"><a href="statistics.html#cb660-7" aria-hidden="true" tabindex="-1"></a>fl_gamma_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true</span>
<span id="cb660-8"><a href="statistics.html#cb660-8" aria-hidden="true" tabindex="-1"></a>fl_delta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb660-9"><a href="statistics.html#cb660-9" aria-hidden="true" tabindex="-1"></a>ls_FBCDWXYZV <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_2by2</span>(mt_prob_joint_E_A,</span>
<span id="cb660-10"><a href="statistics.html#cb660-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fl_alpha =</span> fl_alpha_true, <span class="at">fl_beta =</span> fl_beta_true,</span>
<span id="cb660-11"><a href="statistics.html#cb660-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">fl_gamma =</span> fl_gamma_true, <span class="at">fl_delta =</span> fl_delta_true, <span class="at">bl_verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;fl_F=0.412857205138471,fl_B=0.471665472604598,fl_C=0.267294503388642,fl_D=0.316546995323062&quot;
## [1] &quot;ar_b=0.279357139743076&quot; &quot;ar_b=0.38641672636977&quot;  &quot;ar_b=0.330597604627249&quot; &quot;ar_b=0.375179830514463&quot;
## [1] &quot;fl_V=0.354923185445584&quot;</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="statistics.html#cb662-1" aria-hidden="true" tabindex="-1"></a>fl_F <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>F</span>
<span id="cb662-2"><a href="statistics.html#cb662-2" aria-hidden="true" tabindex="-1"></a>fl_B <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>B</span>
<span id="cb662-3"><a href="statistics.html#cb662-3" aria-hidden="true" tabindex="-1"></a>fl_C <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>C</span>
<span id="cb662-4"><a href="statistics.html#cb662-4" aria-hidden="true" tabindex="-1"></a>fl_D <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>D</span>
<span id="cb662-5"><a href="statistics.html#cb662-5" aria-hidden="true" tabindex="-1"></a>fl_W <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>W</span>
<span id="cb662-6"><a href="statistics.html#cb662-6" aria-hidden="true" tabindex="-1"></a>fl_X <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>X</span>
<span id="cb662-7"><a href="statistics.html#cb662-7" aria-hidden="true" tabindex="-1"></a>fl_Y <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Y</span>
<span id="cb662-8"><a href="statistics.html#cb662-8" aria-hidden="true" tabindex="-1"></a>fl_Z <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Z</span>
<span id="cb662-9"><a href="statistics.html#cb662-9" aria-hidden="true" tabindex="-1"></a>fl_V <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>V</span></code></pre></div>
<p>We can see the rank of a matrix with the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/qr.html">qr</a> function (QR decomposition), regardless of the random seed chosen above, the <span class="math inline">\(\Omega\)</span> matrix is not full ranked.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="statistics.html#cb663-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does not matter if joint sum is used or the alternative</span></span>
<span id="cb663-2"><a href="statistics.html#cb663-2" aria-hidden="true" tabindex="-1"></a>bl_use_joint_sum <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb663-3"><a href="statistics.html#cb663-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (bl_use_joint_sum) {</span>
<span id="cb663-4"><a href="statistics.html#cb663-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb663-5"><a href="statistics.html#cb663-5" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA <span class="ot">=</span> <span class="fu">t</span>(</span>
<span id="cb663-6"><a href="statistics.html#cb663-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(fl_F, <span class="dv">1</span><span class="sc">-</span>fl_F, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb663-7"><a href="statistics.html#cb663-7" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">0</span>, <span class="dv">0</span>, fl_B, <span class="dv">1</span><span class="sc">-</span>fl_B,</span>
<span id="cb663-8"><a href="statistics.html#cb663-8" aria-hidden="true" tabindex="-1"></a>                  fl_C, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_C, <span class="dv">0</span>,</span>
<span id="cb663-9"><a href="statistics.html#cb663-9" aria-hidden="true" tabindex="-1"></a>                  mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>],  mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb663-10"><a href="statistics.html#cb663-10" aria-hidden="true" tabindex="-1"></a>                  mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>],  mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]), <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb663-11"><a href="statistics.html#cb663-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb663-12"><a href="statistics.html#cb663-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb663-13"><a href="statistics.html#cb663-13" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(fl_F, <span class="dv">1</span><span class="sc">-</span>fl_F, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb663-14"><a href="statistics.html#cb663-14" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">0</span>, <span class="dv">0</span>, fl_B, <span class="dv">1</span><span class="sc">-</span>fl_B,</span>
<span id="cb663-15"><a href="statistics.html#cb663-15" aria-hidden="true" tabindex="-1"></a>                             fl_C, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_C, <span class="dv">0</span>,</span>
<span id="cb663-16"><a href="statistics.html#cb663-16" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">0</span>, fl_D, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_D), <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb663-17"><a href="statistics.html#cb663-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-18"><a href="statistics.html#cb663-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb663-19"><a href="statistics.html#cb663-19" aria-hidden="true" tabindex="-1"></a><span class="co"># rank Check with the qr function:</span></span>
<span id="cb663-20"><a href="statistics.html#cb663-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">qr</span>(mt_OMEGA))</span></code></pre></div>
<pre><code>## $qr
##            [,1]       [,2]       [,3]          [,4]
## [1,] -0.4918307 -0.4928650 -0.3982024  0.000000e+00
## [2,]  0.0000000 -0.4494694  0.4366482 -4.813342e-01
## [3,]  0.5434685 -0.7099340 -0.6403896 -7.173303e-01
## [4,]  0.0000000  0.7042682 -0.0385102 -2.081668e-17
## 
## $rank
## [1] 3
## 
## $qraux
## [1] 1.839430e+00 1.000000e+00 1.999258e+00 2.081668e-17
## 
## $pivot
## [1] 1 2 3 4
## 
## attr(,&quot;class&quot;)
## [1] &quot;qr&quot;</code></pre>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="statistics.html#cb665-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rank Check with the qr function:</span></span></code></pre></div>
<p>We cannot solve the linear equations using <em>solve</em> because this is NOT full rank.</p>
</div>
<div id="rectilinear-restriction-on-joint-2-by-2-distribution-1" class="section level5" number="9.3.3.1.3">
<h5><span class="header-section-number">9.3.3.1.3</span> Rectilinear Restriction on Joint 2 by 2 Distribution</h5>
<p>So in the section above, it is demonstrated that it is not possible to uniquely identify the joint probability mass function from marginal probability mass functions.</p>
<p>However, sometimes, we need to find some reasonable joint distribution, when we only observe marginal distributions. This joint distribution might be an input transition matrix in a model we simulate. If we just use one of the infinitely possible joint mass that match up with the marginals, then the model would have infinitely many simulation results depending on our arbitrary choice of joint mass.</p>
<p>Ideally, one should try to obtain data to estimate the underlying joint distribution, when this is not possible, we can impose additional non-parametric restrictions on the structures of the joint probability mass that would lead to unique joint mass from marginals.</p>
<p>Specifically, we will assume the incremental changes across rows and across columns of the joint mass matrix are row or column specific, is this sufficient? (In Some Cases it Will Not be):</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = P(A_1,E_2) - P(A_1,E_1) = \gamma - \alpha = P(A_2,E_2) - P(A_2,E_1) = \delta - \beta \\
\Delta^{A}_{12} = P(A_2,E_1) - P(A_1,E_1) = \beta -  \alpha = P(A_2,E_2) - P(A_1,E_2) = \delta - \gamma \\
\end{aligned}
\]</span>
The assumption is non-parametric. This is effectively an rectilinear assumption on the joint Cumulative Probability Mass Function. The assumption means that if we know <span class="math inline">\(\Delta^E_{12}\)</span> and <span class="math inline">\(\Delta^{A}_{12}\)</span> and say <span class="math inline">\(\alpha\)</span>, we have:</p>
<p><span class="math display">\[
\beta = \alpha + \Delta^A_{12}\\
\gamma = \alpha + \Delta^E_{12}\\
\delta = \gamma\left(\alpha, \Delta^E_{12}\right) + \Delta^A_{12}\\
\]</span>
Alernatively, we can also say that if we know <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>, then we know <span class="math inline">\(\delta\)</span>:</p>
<p><span class="math display">\[
\Delta^A_{12} = \beta - \alpha\\
\delta = \gamma + \Delta^A_{12} = \gamma + \beta - \alpha\\
\]</span></p>
</div>
<div id="by-2-problem-with-rectlinear-restrictions" class="section level5" number="9.3.3.1.4">
<h5><span class="header-section-number">9.3.3.1.4</span> 2 by 2 Problem with Rectlinear Restrictions</h5>
<p>We have these three equations, where <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\Delta^A\)</span> and <span class="math inline">\(\Delta^E\)</span> are not known:</p>
<p><span class="math display">\[
\begin{aligned}
W &amp;= \alpha F + \alpha(1-F) + \Delta^{A} (1-F)\\
X &amp;= \alpha B + \Delta^{E} B + \alpha (1-B) + \Delta^{A} (1-B) + \Delta^{E} (1-B)\\
Y &amp;= \alpha C + \alpha(1-C)+\Delta^{E}(1-C)
\end{aligned}
\]</span>
Rewriting a little bit, we have the following linear system:</p>
<p><span class="math display">\[
\begin{aligned}
W &amp;= \alpha + \Delta^{A} (1-F)\\
X &amp;= \alpha + \Delta^{A} (1-B) + \Delta^{E}\\
Y &amp;= \alpha + \Delta^{E}(1-C)\\
V &amp;=
\alpha
+
\Delta^A \left(
P(E_2, A_1) + P(E_2, A_2)
\right)
+
\Delta^E \left(
P(E_1, A_2) + P(E_2, A_2)
\right)
\end{aligned}
\]</span>
Using the First three equations, we have:
<span class="math display">\[
\begin{aligned}
\begin{bmatrix}
1 &amp; (1-F) &amp; 0 \\
1 &amp; (1-B) &amp; 1 \\
1 &amp; 0 &amp; (1-C) \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\Delta^{A} \\
\Delta^{E}
\end{bmatrix}
&amp; =
\begin{bmatrix}
W \\
X \\
Y \\
\end{bmatrix}\\
\end{aligned}
\]</span>
<span class="math display">\[
\widehat{\Omega} \cdot \widehat{\mathbb{X}} = \widehat{b}
\]</span></p>
</div>
<div id="solution-program-for-2-by-2-problem-with-rectlinear-restrictions" class="section level5" number="9.3.3.1.5">
<h5><span class="header-section-number">9.3.3.1.5</span> Solution Program for 2 by 2 Problem with Rectlinear Restrictions</h5>
<p>Using the same <span class="math inline">\(F\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> values obtained from prior, we have now a full ranked 3 by 3 matrix:</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="statistics.html#cb666-1" aria-hidden="true" tabindex="-1"></a>ffi_solve_2by2_rectilinear <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_F, fl_B, fl_C,</span>
<span id="cb666-2"><a href="statistics.html#cb666-2" aria-hidden="true" tabindex="-1"></a>                                       fl_W, fl_X, fl_Y,</span>
<span id="cb666-3"><a href="statistics.html#cb666-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">bl_verbose=</span><span class="cn">FALSE</span>) {</span>
<span id="cb666-4"><a href="statistics.html#cb666-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-5"><a href="statistics.html#cb666-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb666-6"><a href="statistics.html#cb666-6" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA_hat <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(</span>
<span id="cb666-7"><a href="statistics.html#cb666-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">-</span>fl_F, <span class="dv">0</span>,</span>
<span id="cb666-8"><a href="statistics.html#cb666-8" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">1</span><span class="sc">-</span>fl_B, <span class="dv">1</span>,</span>
<span id="cb666-9"><a href="statistics.html#cb666-9" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_C), <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb666-10"><a href="statistics.html#cb666-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-11"><a href="statistics.html#cb666-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rank Check with the qr function:</span></span>
<span id="cb666-12"><a href="statistics.html#cb666-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb666-13"><a href="statistics.html#cb666-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">qr</span>(mt_OMEGA_hat))</span>
<span id="cb666-14"><a href="statistics.html#cb666-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb666-15"><a href="statistics.html#cb666-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-16"><a href="statistics.html#cb666-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bhat</span></span>
<span id="cb666-17"><a href="statistics.html#cb666-17" aria-hidden="true" tabindex="-1"></a>  ar_b_hat <span class="ot">&lt;-</span> <span class="fu">c</span>(fl_W, fl_X, fl_Y)</span>
<span id="cb666-18"><a href="statistics.html#cb666-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-19"><a href="statistics.html#cb666-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve</span></span>
<span id="cb666-20"><a href="statistics.html#cb666-20" aria-hidden="true" tabindex="-1"></a>  ar_solution <span class="ot">&lt;-</span> <span class="fu">solve</span>(mt_OMEGA_hat, ar_b_hat)</span>
<span id="cb666-21"><a href="statistics.html#cb666-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-22"><a href="statistics.html#cb666-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get alpha and Delta from solution</span></span>
<span id="cb666-23"><a href="statistics.html#cb666-23" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ar_solution[<span class="dv">1</span>]</span>
<span id="cb666-24"><a href="statistics.html#cb666-24" aria-hidden="true" tabindex="-1"></a>  fl_Delta_A <span class="ot">&lt;-</span> ar_solution[<span class="dv">2</span>]</span>
<span id="cb666-25"><a href="statistics.html#cb666-25" aria-hidden="true" tabindex="-1"></a>  fl_Delta_E <span class="ot">&lt;-</span> ar_solution[<span class="dv">3</span>]</span>
<span id="cb666-26"><a href="statistics.html#cb666-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb666-27"><a href="statistics.html#cb666-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_A=&#39;</span>,fl_Delta_A))</span>
<span id="cb666-28"><a href="statistics.html#cb666-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_E=&#39;</span>,fl_Delta_E))</span>
<span id="cb666-29"><a href="statistics.html#cb666-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb666-30"><a href="statistics.html#cb666-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-31"><a href="statistics.html#cb666-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get beta gamma , delta</span></span>
<span id="cb666-32"><a href="statistics.html#cb666-32" aria-hidden="true" tabindex="-1"></a>  fl_beta <span class="ot">&lt;-</span> fl_alpha <span class="sc">+</span> fl_Delta_A</span>
<span id="cb666-33"><a href="statistics.html#cb666-33" aria-hidden="true" tabindex="-1"></a>  fl_gamma <span class="ot">&lt;-</span> fl_alpha <span class="sc">+</span> fl_Delta_E</span>
<span id="cb666-34"><a href="statistics.html#cb666-34" aria-hidden="true" tabindex="-1"></a>  fl_delta <span class="ot">&lt;-</span> fl_gamma <span class="sc">+</span> fl_Delta_A</span>
<span id="cb666-35"><a href="statistics.html#cb666-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb666-36"><a href="statistics.html#cb666-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_alpha=&#39;</span>,fl_alpha))</span>
<span id="cb666-37"><a href="statistics.html#cb666-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_beta=&#39;</span>,fl_beta))</span>
<span id="cb666-38"><a href="statistics.html#cb666-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gamma=&#39;</span>,fl_gamma))</span>
<span id="cb666-39"><a href="statistics.html#cb666-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_delta=&#39;</span>,fl_delta))</span>
<span id="cb666-40"><a href="statistics.html#cb666-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">1</span>] <span class="sc">-</span> (fl_alpha<span class="sc">*</span>fl_F <span class="sc">+</span> fl_beta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_F))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb666-41"><a href="statistics.html#cb666-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;W matched&#39;</span>)</span>
<span id="cb666-42"><a href="statistics.html#cb666-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb666-43"><a href="statistics.html#cb666-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">2</span>] <span class="sc">-</span> (fl_gamma<span class="sc">*</span>fl_B <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_B))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb666-44"><a href="statistics.html#cb666-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;X matched&#39;</span>)</span>
<span id="cb666-45"><a href="statistics.html#cb666-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb666-46"><a href="statistics.html#cb666-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">3</span>] <span class="sc">-</span> (fl_alpha<span class="sc">*</span>fl_C <span class="sc">+</span> fl_gamma<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_C))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb666-47"><a href="statistics.html#cb666-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;Y matched&#39;</span>)</span>
<span id="cb666-48"><a href="statistics.html#cb666-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb666-49"><a href="statistics.html#cb666-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">4</span>] <span class="sc">-</span> (fl_beta<span class="sc">*</span>fl_D <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_D))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb666-50"><a href="statistics.html#cb666-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;Z matched&#39;</span>)</span>
<span id="cb666-51"><a href="statistics.html#cb666-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb666-52"><a href="statistics.html#cb666-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(fl_V <span class="sc">-</span> (mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_alpha <span class="sc">+</span></span>
<span id="cb666-53"><a href="statistics.html#cb666-53" aria-hidden="true" tabindex="-1"></a>                    mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_beta <span class="sc">+</span></span>
<span id="cb666-54"><a href="statistics.html#cb666-54" aria-hidden="true" tabindex="-1"></a>                    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_gamma <span class="sc">+</span></span>
<span id="cb666-55"><a href="statistics.html#cb666-55" aria-hidden="true" tabindex="-1"></a>                    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_delta)) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb666-56"><a href="statistics.html#cb666-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;V matched&#39;</span>)</span>
<span id="cb666-57"><a href="statistics.html#cb666-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb666-58"><a href="statistics.html#cb666-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb666-59"><a href="statistics.html#cb666-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-60"><a href="statistics.html#cb666-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Delta_A=</span>fl_Delta_A, <span class="at">Delta_E=</span>fl_Delta_E,</span>
<span id="cb666-61"><a href="statistics.html#cb666-61" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha=</span>fl_alpha, <span class="at">beta=</span>fl_beta,</span>
<span id="cb666-62"><a href="statistics.html#cb666-62" aria-hidden="true" tabindex="-1"></a>              <span class="at">gamma=</span>fl_gamma, <span class="at">delta=</span>fl_delta))</span>
<span id="cb666-63"><a href="statistics.html#cb666-63" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now solve for <span class="math inline">\(\widehat{\mathbb{X}}\)</span> using <em>solve</em> given <span class="math inline">\(\widehat{\Omega}\)</span> and <span class="math inline">\(\widehat{b}\)</span>. Solving different assumptions on underlying joint probabilities.</p>
</div>
<div id="testing-program-for-2-by-2-problem-with-rectlinear-restrictions" class="section level5" number="9.3.3.1.6">
<h5><span class="header-section-number">9.3.3.1.6</span> Testing Program for 2 by 2 Problem with Rectlinear Restrictions</h5>
<p>Solving first when rectilinear assumption is valid:</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="statistics.html#cb667-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb667-2"><a href="statistics.html#cb667-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-3"><a href="statistics.html#cb667-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb667-4"><a href="statistics.html#cb667-4" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb667-5"><a href="statistics.html#cb667-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb667-6"><a href="statistics.html#cb667-6" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb667-7"><a href="statistics.html#cb667-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-8"><a href="statistics.html#cb667-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb667-9"><a href="statistics.html#cb667-9" aria-hidden="true" tabindex="-1"></a>  fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb667-10"><a href="statistics.html#cb667-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb667-11"><a href="statistics.html#cb667-11" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb667-12"><a href="statistics.html#cb667-12" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb667-13"><a href="statistics.html#cb667-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb667-14"><a href="statistics.html#cb667-14" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.21</span></span>
<span id="cb667-15"><a href="statistics.html#cb667-15" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb667-16"><a href="statistics.html#cb667-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb667-17"><a href="statistics.html#cb667-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb667-18"><a href="statistics.html#cb667-18" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.11</span></span>
<span id="cb667-19"><a href="statistics.html#cb667-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb667-20"><a href="statistics.html#cb667-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-21"><a href="statistics.html#cb667-21" aria-hidden="true" tabindex="-1"></a>  fl_beta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb667-22"><a href="statistics.html#cb667-22" aria-hidden="true" tabindex="-1"></a>  fl_gamma_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true</span>
<span id="cb667-23"><a href="statistics.html#cb667-23" aria-hidden="true" tabindex="-1"></a>  fl_delta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb667-24"><a href="statistics.html#cb667-24" aria-hidden="true" tabindex="-1"></a>  ls_FBCDWXYZV <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_2by2</span>(</span>
<span id="cb667-25"><a href="statistics.html#cb667-25" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A,</span>
<span id="cb667-26"><a href="statistics.html#cb667-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_alpha =</span> fl_alpha_true, <span class="at">fl_beta =</span> fl_beta_true,</span>
<span id="cb667-27"><a href="statistics.html#cb667-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_gamma =</span> fl_gamma_true, <span class="at">fl_delta =</span> fl_delta_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb667-28"><a href="statistics.html#cb667-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-29"><a href="statistics.html#cb667-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb667-30"><a href="statistics.html#cb667-30" aria-hidden="true" tabindex="-1"></a>  fl_F <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>F</span>
<span id="cb667-31"><a href="statistics.html#cb667-31" aria-hidden="true" tabindex="-1"></a>  fl_B <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>B</span>
<span id="cb667-32"><a href="statistics.html#cb667-32" aria-hidden="true" tabindex="-1"></a>  fl_C <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>C</span>
<span id="cb667-33"><a href="statistics.html#cb667-33" aria-hidden="true" tabindex="-1"></a>  fl_D <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>D</span>
<span id="cb667-34"><a href="statistics.html#cb667-34" aria-hidden="true" tabindex="-1"></a>  fl_W <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>W</span>
<span id="cb667-35"><a href="statistics.html#cb667-35" aria-hidden="true" tabindex="-1"></a>  fl_X <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>X</span>
<span id="cb667-36"><a href="statistics.html#cb667-36" aria-hidden="true" tabindex="-1"></a>  fl_Y <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Y</span>
<span id="cb667-37"><a href="statistics.html#cb667-37" aria-hidden="true" tabindex="-1"></a>  fl_Z <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Z</span>
<span id="cb667-38"><a href="statistics.html#cb667-38" aria-hidden="true" tabindex="-1"></a>  fl_V <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>V</span>
<span id="cb667-39"><a href="statistics.html#cb667-39" aria-hidden="true" tabindex="-1"></a>  ls_solution <span class="ot">&lt;-</span> <span class="fu">ffi_solve_2by2_rectilinear</span>(</span>
<span id="cb667-40"><a href="statistics.html#cb667-40" aria-hidden="true" tabindex="-1"></a>    fl_F, fl_B, fl_C,</span>
<span id="cb667-41"><a href="statistics.html#cb667-41" aria-hidden="true" tabindex="-1"></a>    fl_W, fl_X, fl_Y)</span>
<span id="cb667-42"><a href="statistics.html#cb667-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-43"><a href="statistics.html#cb667-43" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>alpha</span>
<span id="cb667-44"><a href="statistics.html#cb667-44" aria-hidden="true" tabindex="-1"></a>  fl_beta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>beta</span>
<span id="cb667-45"><a href="statistics.html#cb667-45" aria-hidden="true" tabindex="-1"></a>  fl_gamma <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>gamma</span>
<span id="cb667-46"><a href="statistics.html#cb667-46" aria-hidden="true" tabindex="-1"></a>  fl_delta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>delta</span>
<span id="cb667-47"><a href="statistics.html#cb667-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-48"><a href="statistics.html#cb667-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb667-49"><a href="statistics.html#cb667-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb667-50"><a href="statistics.html#cb667-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_alpha=&#39;</span>, fl_alpha, <span class="st">&#39;, fl_alpha_true=&#39;</span>, fl_alpha_true))</span>
<span id="cb667-51"><a href="statistics.html#cb667-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_beta=&#39;</span>, fl_beta, <span class="st">&#39;, fl_beta_true=&#39;</span>, fl_beta_true))</span>
<span id="cb667-52"><a href="statistics.html#cb667-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gamma=&#39;</span>, fl_gamma, <span class="st">&#39;, fl_gamma_true=&#39;</span>, fl_gamma_true))</span>
<span id="cb667-53"><a href="statistics.html#cb667-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_delta=&#39;</span>, fl_delta, <span class="st">&#39;, fl_delta_true=&#39;</span>, fl_delta_true))</span>
<span id="cb667-54"><a href="statistics.html#cb667-54" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;fl_alpha=0.25, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.3, fl_beta_true=0.3&quot;
## [1] &quot;fl_gamma=0.36, fl_gamma_true=0.36&quot;
## [1] &quot;fl_delta=0.41, fl_delta_true=0.41&quot;
## [1] &quot;it_i=2&quot;
## [1] &quot;fl_alpha=0.25, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.46, fl_beta_true=0.46&quot;
## [1] &quot;fl_gamma=0.28, fl_gamma_true=0.28&quot;
## [1] &quot;fl_delta=0.49, fl_delta_true=0.49&quot;
## [1] &quot;it_i=3&quot;
## [1] &quot;fl_alpha=0.25, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.2, fl_beta_true=0.2&quot;
## [1] &quot;fl_gamma=0.14, fl_gamma_true=0.14&quot;
## [1] &quot;fl_delta=0.0900000000000001, fl_delta_true=0.09&quot;</code></pre>
<p>Solving when rectilinear assumption is NOT valid, results can be approximately correct. However, note that we do not have positive mass in all cases. See case three below, the alpha backed out is negative.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="statistics.html#cb669-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb669-2"><a href="statistics.html#cb669-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-3"><a href="statistics.html#cb669-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb669-4"><a href="statistics.html#cb669-4" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb669-5"><a href="statistics.html#cb669-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb669-6"><a href="statistics.html#cb669-6" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb669-7"><a href="statistics.html#cb669-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-8"><a href="statistics.html#cb669-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb669-9"><a href="statistics.html#cb669-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb669-10"><a href="statistics.html#cb669-10" aria-hidden="true" tabindex="-1"></a>    fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb669-11"><a href="statistics.html#cb669-11" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb669-12"><a href="statistics.html#cb669-12" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb669-13"><a href="statistics.html#cb669-13" aria-hidden="true" tabindex="-1"></a>    fl_Delta_AE_true <span class="ot">&lt;-</span> <span class="fl">0.10</span></span>
<span id="cb669-14"><a href="statistics.html#cb669-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb669-15"><a href="statistics.html#cb669-15" aria-hidden="true" tabindex="-1"></a>    fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.55</span></span>
<span id="cb669-16"><a href="statistics.html#cb669-16" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.21</span></span>
<span id="cb669-17"><a href="statistics.html#cb669-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb669-18"><a href="statistics.html#cb669-18" aria-hidden="true" tabindex="-1"></a>    fl_Delta_AE_true <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb669-19"><a href="statistics.html#cb669-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb669-20"><a href="statistics.html#cb669-20" aria-hidden="true" tabindex="-1"></a>    fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb669-21"><a href="statistics.html#cb669-21" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb669-22"><a href="statistics.html#cb669-22" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.11</span></span>
<span id="cb669-23"><a href="statistics.html#cb669-23" aria-hidden="true" tabindex="-1"></a>    fl_Delta_AE_true <span class="ot">&lt;-</span> <span class="fl">0.30</span></span>
<span id="cb669-24"><a href="statistics.html#cb669-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb669-25"><a href="statistics.html#cb669-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-26"><a href="statistics.html#cb669-26" aria-hidden="true" tabindex="-1"></a>  fl_beta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb669-27"><a href="statistics.html#cb669-27" aria-hidden="true" tabindex="-1"></a>  fl_gamma_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true</span>
<span id="cb669-28"><a href="statistics.html#cb669-28" aria-hidden="true" tabindex="-1"></a>  fl_delta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_AE_true</span>
<span id="cb669-29"><a href="statistics.html#cb669-29" aria-hidden="true" tabindex="-1"></a>  ls_FBCDWXYZV <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_2by2</span>(</span>
<span id="cb669-30"><a href="statistics.html#cb669-30" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A,</span>
<span id="cb669-31"><a href="statistics.html#cb669-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_alpha =</span> fl_alpha_true, <span class="at">fl_beta =</span> fl_beta_true,</span>
<span id="cb669-32"><a href="statistics.html#cb669-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_gamma =</span> fl_gamma_true, <span class="at">fl_delta =</span> fl_delta_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb669-33"><a href="statistics.html#cb669-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-34"><a href="statistics.html#cb669-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb669-35"><a href="statistics.html#cb669-35" aria-hidden="true" tabindex="-1"></a>  fl_F <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>F</span>
<span id="cb669-36"><a href="statistics.html#cb669-36" aria-hidden="true" tabindex="-1"></a>  fl_B <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>B</span>
<span id="cb669-37"><a href="statistics.html#cb669-37" aria-hidden="true" tabindex="-1"></a>  fl_C <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>C</span>
<span id="cb669-38"><a href="statistics.html#cb669-38" aria-hidden="true" tabindex="-1"></a>  fl_D <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>D</span>
<span id="cb669-39"><a href="statistics.html#cb669-39" aria-hidden="true" tabindex="-1"></a>  fl_W <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>W</span>
<span id="cb669-40"><a href="statistics.html#cb669-40" aria-hidden="true" tabindex="-1"></a>  fl_X <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>X</span>
<span id="cb669-41"><a href="statistics.html#cb669-41" aria-hidden="true" tabindex="-1"></a>  fl_Y <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Y</span>
<span id="cb669-42"><a href="statistics.html#cb669-42" aria-hidden="true" tabindex="-1"></a>  fl_Z <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Z</span>
<span id="cb669-43"><a href="statistics.html#cb669-43" aria-hidden="true" tabindex="-1"></a>  fl_V <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>V</span>
<span id="cb669-44"><a href="statistics.html#cb669-44" aria-hidden="true" tabindex="-1"></a>  ls_solution <span class="ot">&lt;-</span> <span class="fu">ffi_solve_2by2_rectilinear</span>(</span>
<span id="cb669-45"><a href="statistics.html#cb669-45" aria-hidden="true" tabindex="-1"></a>    fl_F, fl_B, fl_C,</span>
<span id="cb669-46"><a href="statistics.html#cb669-46" aria-hidden="true" tabindex="-1"></a>    fl_W, fl_X, fl_Y)</span>
<span id="cb669-47"><a href="statistics.html#cb669-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-48"><a href="statistics.html#cb669-48" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>alpha</span>
<span id="cb669-49"><a href="statistics.html#cb669-49" aria-hidden="true" tabindex="-1"></a>  fl_beta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>beta</span>
<span id="cb669-50"><a href="statistics.html#cb669-50" aria-hidden="true" tabindex="-1"></a>  fl_gamma <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>gamma</span>
<span id="cb669-51"><a href="statistics.html#cb669-51" aria-hidden="true" tabindex="-1"></a>  fl_delta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>delta</span>
<span id="cb669-52"><a href="statistics.html#cb669-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-53"><a href="statistics.html#cb669-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb669-54"><a href="statistics.html#cb669-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb669-55"><a href="statistics.html#cb669-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_alpha=&#39;</span>, fl_alpha, <span class="st">&#39;, fl_alpha_true=&#39;</span>, fl_alpha_true))</span>
<span id="cb669-56"><a href="statistics.html#cb669-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_beta=&#39;</span>, fl_beta, <span class="st">&#39;, fl_beta_true=&#39;</span>, fl_beta_true))</span>
<span id="cb669-57"><a href="statistics.html#cb669-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gamma=&#39;</span>, fl_gamma, <span class="st">&#39;, fl_gamma_true=&#39;</span>, fl_gamma_true))</span>
<span id="cb669-58"><a href="statistics.html#cb669-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_delta=&#39;</span>, fl_delta, <span class="st">&#39;, fl_delta_true=&#39;</span>, fl_delta_true))</span>
<span id="cb669-59"><a href="statistics.html#cb669-59" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;fl_alpha=0.275066384524696, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.282374240902959, fl_beta_true=0.3&quot;
## [1] &quot;fl_gamma=0.350855661880163, fl_gamma_true=0.36&quot;
## [1] &quot;fl_delta=0.358163518258426, fl_delta_true=0.35&quot;
## [1] &quot;it_i=2&quot;
## [1] &quot;fl_alpha=0.587599576787045, fl_alpha_true=0.55&quot;
## [1] &quot;fl_beta=0.733561361354439, fl_beta_true=0.76&quot;
## [1] &quot;fl_gamma=0.566283492820244, fl_gamma_true=0.58&quot;
## [1] &quot;fl_delta=0.712245277387639, fl_delta_true=0.7&quot;
## [1] &quot;it_i=3&quot;
## [1] &quot;fl_alpha=-0.0421756146893388, fl_alpha_true=0.15&quot;
## [1] &quot;fl_beta=0.235130819743977, fl_beta_true=0.1&quot;
## [1] &quot;fl_gamma=0.110106592252085, fl_gamma_true=0.04&quot;
## [1] &quot;fl_delta=0.387413026685401, fl_delta_true=0.45&quot;</code></pre>
</div>
</div>
<div id="by-3-joint-from-marginal-probability-mass-functions-with-rectilinear-assumptions" class="section level4" number="9.3.3.2">
<h4><span class="header-section-number">9.3.3.2</span> 3 by 3 Joint from Marginal Probability Mass Functions with Rectilinear Assumptions</h4>
<div id="the-3-by-3-problem" class="section level5" number="9.3.3.2.1">
<h5><span class="header-section-number">9.3.3.2.1</span> The 3 by 3 Problem</h5>
<p>We append the 2 by 2 problem to a 3 by 3 problem.</p>
<p><span class="math display">\[
\begin{aligned}
P(U|E_1) =
P(U|A_1, E_1) \cdot P(A_1|E_1) +
P(U|A_2, E_1) \cdot P(A_2|E_1) +
P(U|A_3, E_1) \cdot P(A_3|E_1)
\\
P(U|E_2) =
P(U|A_1, E_2) \cdot P(A_1|E_2) +
P(U|A_2, E_2) \cdot P(A_2|E_2) +
P(U|A_3, E_2) \cdot P(A_3|E_2)
\\
P(U|E_3) =
P(U|A_1, E_3) \cdot P(A_1|E_3) +
P(U|A_2, E_3) \cdot P(A_2|E_3) +
P(U|A_3, E_3) \cdot P(A_3|E_3)
\\
P(U|A_1) =
P(U|A_1, E_1) \cdot P(E_1|A_1) +
P(U|A_1, E_2) \cdot P(E_2|A_1) +
P(U|A_1, E_3) \cdot P(E_3|A_1)
\\
P(U|A_2) =
P(U|A_2, E_1) \cdot P(E_1|A_2) +
P(U|A_2, E_2) \cdot P(E_2|A_2) +
P(U|A_2, E_3) \cdot P(E_3|A_2)
\\
P(U|A_3) =
P(U|A_3, E_1) \cdot P(E_1|A_3) +
P(U|A_3, E_2) \cdot P(E_2|A_3) +
P(U|A_3, E_3) \cdot P(E_3|A_3)
\\
\end{aligned}
\]</span>
Similar to before, let Roman letter represent what we know, and greek letters represent what we do not know. There are nine potential unknown conditional unemployment probabilities <span class="math inline">\(\alpha_{ij}\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
V_1 &amp;= \alpha_{11} B_{11} + \alpha_{21} B_{21} + \alpha_{31} B_{31}
\\
V_2 &amp;= \alpha_{12} B_{12} + \alpha_{22} B_{22} + \alpha_{32} B_{32}
\\
V_3 &amp;= \alpha_{13} B_{13} + \alpha_{23} B_{23} + \alpha_{33} B_{33}
\\
W_1 &amp;= \alpha_{11} C_{11} + \alpha_{12} C_{21} + \alpha_{13} C_{31}
\\
W_2 &amp;= \alpha_{21} C_{12} + \alpha_{22} C_{22} + \alpha_{23} C_{32}
\\
W_3 &amp;= \alpha_{31} C_{13} + \alpha_{32} C_{23} + \alpha_{33} C_{33}
\end{aligned}
\]</span></p>
</div>
<div id="by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.3.3.2.2">
<h5><span class="header-section-number">9.3.3.2.2</span> 3 by 3 Problem with Rectlinear Restrictions</h5>
<p>With rectilinear assumptions, we have now rather than nine parameters, five parameters.</p>
<p><span class="math display">\[
\begin{aligned}
V_1 &amp;= \alpha B_{11} + (\alpha + \delta^{21}) B_{21} + (\alpha + \delta^{21} + \delta^{31}) B_{31}
\\
V_2 &amp;= (\alpha + \delta^{12}) B_{12} + (\alpha + \delta^{12} + \delta^{21}) B_{22} + (\alpha + \delta^{12} + \delta^{21} + \delta^{31}) B_{32}
\\
V_3 &amp;= (\alpha + \delta^{12} + \delta^{13}) B_{13} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21}) B_{23} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21} + \delta^{31}) B_{33}
\\
W_1 &amp;= \alpha C_{11} + (\alpha + \delta^{12}) C_{21} + (\alpha + \delta^{12} + \delta^{13}) C_{31}
\\
W_2 &amp;= (\alpha + \delta^{21}) C_{12} + (\alpha + \delta^{12} + \delta^{21}) C_{22} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21}) C_{32}
\\
W_3 &amp;= (\alpha + \delta^{21} + \delta^{31}) C_{13} + (\alpha + \delta^{12} + \delta^{21} + \delta^{31}) C_{23} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21} + \delta^{31}) C_{33}
\end{aligned}
\]</span>
Write these in matrix form:</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
(B_{11} + B_{21} + B_{31}) &amp; (B_{21} + B_{31}) &amp; (B_{31}) &amp; 0 &amp; 0 \\
(B_{12} + B_{22} + B_{32}) &amp; (B_{22} + B_{32}) &amp; (B_{32}) &amp; (B_{12} + B_{22} + B_{32}) &amp; 0 \\
(B_{13} + B_{23} + B_{33}) &amp; (B_{23} + B_{33}) &amp; (B_{33}) &amp; (B_{13} + B_{23} + B_{33}) &amp; (B_{13} + B_{23} + B_{33}) \\
(C_{11} + C_{21} + C_{31}) &amp; 0 &amp; 0 &amp; (C_{21} + C_{31}) &amp; (C_{31}) \\
(C_{12} + C_{22} + C_{33}) &amp; (C_{12} + C_{22} + C_{32}) &amp; 0 &amp; (C_{22} + C_{32}) &amp; (C_{32})\\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\delta^{21} \\
\delta^{31} \\
\delta^{12} \\
\delta^{13}
\end{bmatrix}
&amp; =
\begin{bmatrix}
V_1 \\
V_2 \\
V_3 \\
W_1 \\
W_2 \\
\end{bmatrix}\\
\end{aligned}
\]</span>
<span class="math display">\[
\widehat{\Omega} \cdot \widehat{\mathbb{X}} = \widehat{b}
\]</span></p>
<p>Simplify slightly for where the probabilities sum to 1, which arrives at a matrix form that is similar to the matrix form arrived at for the 2 by 2 problem.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
1 &amp; (B_{21} + B_{31}) &amp; (B_{31}) &amp; 0 &amp; 0 \\
1 &amp; (B_{22} + B_{32}) &amp; (B_{32}) &amp; 1 &amp; 0 \\
1 &amp; (B_{23} + B_{33}) &amp; (B_{33}) &amp; 1 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; (C_{21} + C_{31}) &amp; (C_{31}) \\
1 &amp; 1 &amp; 0 &amp; (C_{22} + C_{32}) &amp; (C_{32})\\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\delta^{21} \\
\delta^{31} \\
\delta^{12} \\
\delta^{13}
\end{bmatrix}
&amp; =
\begin{bmatrix}
V_1 \\
V_2 \\
V_3 \\
W_1 \\
W_2 \\
\end{bmatrix}\\\end{aligned}
\]</span>
<span class="math display">\[
\widehat{\Omega} \cdot \widehat{\mathbb{X}} = \widehat{b}
\]</span></p>
</div>
<div id="data-program-for-3-by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.3.3.2.3">
<h5><span class="header-section-number">9.3.3.2.3</span> Data Program for 3 by 3 Problem with Rectlinear Restrictions</h5>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="statistics.html#cb671-1" aria-hidden="true" tabindex="-1"></a>ffi_gen_condi_unemploy_prob_3by3 <span class="ot">&lt;-</span> <span class="cf">function</span>(mt_prob_joint_E_A, mt_alpha, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb671-2"><a href="statistics.html#cb671-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-3"><a href="statistics.html#cb671-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># From joint probability, generate conditional probabilities</span></span>
<span id="cb671-4"><a href="statistics.html#cb671-4" aria-hidden="true" tabindex="-1"></a>  fl_B21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb671-5"><a href="statistics.html#cb671-5" aria-hidden="true" tabindex="-1"></a>  fl_B31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb671-6"><a href="statistics.html#cb671-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-7"><a href="statistics.html#cb671-7" aria-hidden="true" tabindex="-1"></a>  fl_B22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb671-8"><a href="statistics.html#cb671-8" aria-hidden="true" tabindex="-1"></a>  fl_B32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb671-9"><a href="statistics.html#cb671-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-10"><a href="statistics.html#cb671-10" aria-hidden="true" tabindex="-1"></a>  fl_B23 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb671-11"><a href="statistics.html#cb671-11" aria-hidden="true" tabindex="-1"></a>  fl_B33 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb671-12"><a href="statistics.html#cb671-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-13"><a href="statistics.html#cb671-13" aria-hidden="true" tabindex="-1"></a>  fl_C21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb671-14"><a href="statistics.html#cb671-14" aria-hidden="true" tabindex="-1"></a>  fl_C31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb671-15"><a href="statistics.html#cb671-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-16"><a href="statistics.html#cb671-16" aria-hidden="true" tabindex="-1"></a>  fl_C22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb671-17"><a href="statistics.html#cb671-17" aria-hidden="true" tabindex="-1"></a>  fl_C32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb671-18"><a href="statistics.html#cb671-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-19"><a href="statistics.html#cb671-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb671-20"><a href="statistics.html#cb671-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_B21=&#39;</span>, fl_B21, <span class="st">&#39;,fl_B31=&#39;</span>,fl_B31))</span>
<span id="cb671-21"><a href="statistics.html#cb671-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_B22=&#39;</span>, fl_B22, <span class="st">&#39;,fl_B22=&#39;</span>,fl_B22))</span>
<span id="cb671-22"><a href="statistics.html#cb671-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_B23=&#39;</span>, fl_B23, <span class="st">&#39;,fl_B33=&#39;</span>,fl_B33))</span>
<span id="cb671-23"><a href="statistics.html#cb671-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_C21=&#39;</span>, fl_C21, <span class="st">&#39;,fl_C31=&#39;</span>,fl_C31))</span>
<span id="cb671-24"><a href="statistics.html#cb671-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_C22=&#39;</span>, fl_C22, <span class="st">&#39;,fl_C32=&#39;</span>,fl_C32))</span>
<span id="cb671-25"><a href="statistics.html#cb671-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb671-26"><a href="statistics.html#cb671-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-27"><a href="statistics.html#cb671-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random W X Y</span></span>
<span id="cb671-28"><a href="statistics.html#cb671-28" aria-hidden="true" tabindex="-1"></a>  fl_V1 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_B21 <span class="sc">-</span> fl_B31) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_B21 <span class="sc">+</span> mt_alpha[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_B31</span>
<span id="cb671-29"><a href="statistics.html#cb671-29" aria-hidden="true" tabindex="-1"></a>  fl_V2 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_B22 <span class="sc">-</span> fl_B32) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_B22 <span class="sc">+</span> mt_alpha[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_B32</span>
<span id="cb671-30"><a href="statistics.html#cb671-30" aria-hidden="true" tabindex="-1"></a>  fl_V3 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_B23 <span class="sc">-</span> fl_B33) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_B23 <span class="sc">+</span> mt_alpha[<span class="dv">3</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_B33</span>
<span id="cb671-31"><a href="statistics.html#cb671-31" aria-hidden="true" tabindex="-1"></a>  fl_W1 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_C21 <span class="sc">-</span> fl_C31) <span class="sc">+</span> mt_alpha[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_C21 <span class="sc">+</span> mt_alpha[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_C31</span>
<span id="cb671-32"><a href="statistics.html#cb671-32" aria-hidden="true" tabindex="-1"></a>  fl_W2 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_C22 <span class="sc">-</span> fl_C32) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_C22 <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_C32</span>
<span id="cb671-33"><a href="statistics.html#cb671-33" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">c</span>(fl_V1, fl_V2, fl_V3, fl_W1, fl_W2)</span>
<span id="cb671-34"><a href="statistics.html#cb671-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-35"><a href="statistics.html#cb671-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb671-36"><a href="statistics.html#cb671-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;ar_b=&#39;</span>,ar_b))</span>
<span id="cb671-37"><a href="statistics.html#cb671-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb671-38"><a href="statistics.html#cb671-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-39"><a href="statistics.html#cb671-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb671-40"><a href="statistics.html#cb671-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ar_b)</span>
<span id="cb671-41"><a href="statistics.html#cb671-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="solution-program-for-3-by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.3.3.2.4">
<h5><span class="header-section-number">9.3.3.2.4</span> Solution Program for 3 by 3 Problem with Rectlinear Restrictions</h5>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="statistics.html#cb672-1" aria-hidden="true" tabindex="-1"></a>ffi_solve_3by3_rectilinear <span class="ot">&lt;-</span> <span class="cf">function</span>(mt_prob_joint_E_A, ar_b, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>) {</span>
<span id="cb672-2"><a href="statistics.html#cb672-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-3"><a href="statistics.html#cb672-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># From joint probability, generate conditional probabilities</span></span>
<span id="cb672-4"><a href="statistics.html#cb672-4" aria-hidden="true" tabindex="-1"></a>  fl_B21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb672-5"><a href="statistics.html#cb672-5" aria-hidden="true" tabindex="-1"></a>  fl_B31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb672-6"><a href="statistics.html#cb672-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-7"><a href="statistics.html#cb672-7" aria-hidden="true" tabindex="-1"></a>  fl_B22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb672-8"><a href="statistics.html#cb672-8" aria-hidden="true" tabindex="-1"></a>  fl_B32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb672-9"><a href="statistics.html#cb672-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-10"><a href="statistics.html#cb672-10" aria-hidden="true" tabindex="-1"></a>  fl_B23 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb672-11"><a href="statistics.html#cb672-11" aria-hidden="true" tabindex="-1"></a>  fl_B33 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb672-12"><a href="statistics.html#cb672-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-13"><a href="statistics.html#cb672-13" aria-hidden="true" tabindex="-1"></a>  fl_C21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb672-14"><a href="statistics.html#cb672-14" aria-hidden="true" tabindex="-1"></a>  fl_C31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb672-15"><a href="statistics.html#cb672-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-16"><a href="statistics.html#cb672-16" aria-hidden="true" tabindex="-1"></a>  fl_C22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb672-17"><a href="statistics.html#cb672-17" aria-hidden="true" tabindex="-1"></a>  fl_C32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb672-18"><a href="statistics.html#cb672-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-19"><a href="statistics.html#cb672-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb672-20"><a href="statistics.html#cb672-20" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(</span>
<span id="cb672-21"><a href="statistics.html#cb672-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>, fl_B21<span class="sc">+</span>fl_B31, fl_B31, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb672-22"><a href="statistics.html#cb672-22" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, fl_B22<span class="sc">+</span>fl_B32, fl_B32, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb672-23"><a href="statistics.html#cb672-23" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, fl_B23<span class="sc">+</span>fl_B33, fl_B33, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb672-24"><a href="statistics.html#cb672-24" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, fl_C21<span class="sc">+</span>fl_C31, fl_C31,</span>
<span id="cb672-25"><a href="statistics.html#cb672-25" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, fl_C22<span class="sc">+</span>fl_C32, fl_C32), <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">5</span>))</span>
<span id="cb672-26"><a href="statistics.html#cb672-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-27"><a href="statistics.html#cb672-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rank Check with the qr function:</span></span>
<span id="cb672-28"><a href="statistics.html#cb672-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb672-29"><a href="statistics.html#cb672-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">qr</span>(mt_OMEGA_hat))</span>
<span id="cb672-30"><a href="statistics.html#cb672-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb672-31"><a href="statistics.html#cb672-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-32"><a href="statistics.html#cb672-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve</span></span>
<span id="cb672-33"><a href="statistics.html#cb672-33" aria-hidden="true" tabindex="-1"></a>  ar_solution <span class="ot">&lt;-</span> <span class="fu">solve</span>(mt_OMEGA, ar_b)</span>
<span id="cb672-34"><a href="statistics.html#cb672-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-35"><a href="statistics.html#cb672-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get alpha and Delta from solution</span></span>
<span id="cb672-36"><a href="statistics.html#cb672-36" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ar_solution[<span class="dv">1</span>]</span>
<span id="cb672-37"><a href="statistics.html#cb672-37" aria-hidden="true" tabindex="-1"></a>  fl_Delta_21 <span class="ot">&lt;-</span> ar_solution[<span class="dv">2</span>]</span>
<span id="cb672-38"><a href="statistics.html#cb672-38" aria-hidden="true" tabindex="-1"></a>  fl_Delta_31 <span class="ot">&lt;-</span> ar_solution[<span class="dv">3</span>]</span>
<span id="cb672-39"><a href="statistics.html#cb672-39" aria-hidden="true" tabindex="-1"></a>  fl_Delta_12 <span class="ot">&lt;-</span> ar_solution[<span class="dv">4</span>]</span>
<span id="cb672-40"><a href="statistics.html#cb672-40" aria-hidden="true" tabindex="-1"></a>  fl_Delta_13 <span class="ot">&lt;-</span> ar_solution[<span class="dv">5</span>]</span>
<span id="cb672-41"><a href="statistics.html#cb672-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb672-42"><a href="statistics.html#cb672-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_21=&#39;</span>,fl_Delta_21))</span>
<span id="cb672-43"><a href="statistics.html#cb672-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_31=&#39;</span>,fl_Delta_31))</span>
<span id="cb672-44"><a href="statistics.html#cb672-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_12=&#39;</span>,fl_Delta_12))</span>
<span id="cb672-45"><a href="statistics.html#cb672-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_13=&#39;</span>,fl_Delta_13))</span>
<span id="cb672-46"><a href="statistics.html#cb672-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb672-47"><a href="statistics.html#cb672-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-48"><a href="statistics.html#cb672-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get beta gamma , delta</span></span>
<span id="cb672-49"><a href="statistics.html#cb672-49" aria-hidden="true" tabindex="-1"></a>  mt_alpha <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb672-50"><a href="statistics.html#cb672-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb672-51"><a href="statistics.html#cb672-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb672-52"><a href="statistics.html#cb672-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-53"><a href="statistics.html#cb672-53" aria-hidden="true" tabindex="-1"></a>      fl_current_val <span class="ot">&lt;-</span> fl_alpha</span>
<span id="cb672-54"><a href="statistics.html#cb672-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-55"><a href="statistics.html#cb672-55" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb672-56"><a href="statistics.html#cb672-56" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21</span>
<span id="cb672-57"><a href="statistics.html#cb672-57" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb672-58"><a href="statistics.html#cb672-58" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb672-59"><a href="statistics.html#cb672-59" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> fl_Delta_31</span>
<span id="cb672-60"><a href="statistics.html#cb672-60" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb672-61"><a href="statistics.html#cb672-61" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb672-62"><a href="statistics.html#cb672-62" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12</span>
<span id="cb672-63"><a href="statistics.html#cb672-63" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb672-64"><a href="statistics.html#cb672-64" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb672-65"><a href="statistics.html#cb672-65" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> fl_Delta_13</span>
<span id="cb672-66"><a href="statistics.html#cb672-66" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb672-67"><a href="statistics.html#cb672-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-68"><a href="statistics.html#cb672-68" aria-hidden="true" tabindex="-1"></a>      mt_alpha[it_row, it_col] <span class="ot">&lt;-</span> fl_current_val</span>
<span id="cb672-69"><a href="statistics.html#cb672-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb672-70"><a href="statistics.html#cb672-70" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb672-71"><a href="statistics.html#cb672-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-72"><a href="statistics.html#cb672-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-73"><a href="statistics.html#cb672-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mt_alpha)</span>
<span id="cb672-74"><a href="statistics.html#cb672-74" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="testing-program-for-3-by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.3.3.2.5">
<h5><span class="header-section-number">9.3.3.2.5</span> Testing Program for 3 by 3 Problem with Rectlinear Restrictions</h5>
<p>Solving first when rectilinear assumption is valid:</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="statistics.html#cb673-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb673-2"><a href="statistics.html#cb673-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-3"><a href="statistics.html#cb673-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb673-4"><a href="statistics.html#cb673-4" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb673-5"><a href="statistics.html#cb673-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">3</span>, <span class="at">it_M =</span> <span class="dv">3</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb673-6"><a href="statistics.html#cb673-6" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb673-7"><a href="statistics.html#cb673-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-8"><a href="statistics.html#cb673-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb673-9"><a href="statistics.html#cb673-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb673-10"><a href="statistics.html#cb673-10" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb673-11"><a href="statistics.html#cb673-11" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb673-12"><a href="statistics.html#cb673-12" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="fl">0.07</span></span>
<span id="cb673-13"><a href="statistics.html#cb673-13" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb673-14"><a href="statistics.html#cb673-14" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb673-15"><a href="statistics.html#cb673-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb673-16"><a href="statistics.html#cb673-16" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb673-17"><a href="statistics.html#cb673-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb673-18"><a href="statistics.html#cb673-18" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.07</span></span>
<span id="cb673-19"><a href="statistics.html#cb673-19" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb673-20"><a href="statistics.html#cb673-20" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.03</span></span>
<span id="cb673-21"><a href="statistics.html#cb673-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb673-22"><a href="statistics.html#cb673-22" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb673-23"><a href="statistics.html#cb673-23" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb673-24"><a href="statistics.html#cb673-24" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb673-25"><a href="statistics.html#cb673-25" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb673-26"><a href="statistics.html#cb673-26" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.1</span></span>
<span id="cb673-27"><a href="statistics.html#cb673-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb673-28"><a href="statistics.html#cb673-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-29"><a href="statistics.html#cb673-29" aria-hidden="true" tabindex="-1"></a>  mt_alpha_true <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb673-30"><a href="statistics.html#cb673-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb673-31"><a href="statistics.html#cb673-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb673-32"><a href="statistics.html#cb673-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-33"><a href="statistics.html#cb673-33" aria-hidden="true" tabindex="-1"></a>      fl_current_val <span class="ot">&lt;-</span> fl_alpha</span>
<span id="cb673-34"><a href="statistics.html#cb673-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-35"><a href="statistics.html#cb673-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb673-36"><a href="statistics.html#cb673-36" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21</span>
<span id="cb673-37"><a href="statistics.html#cb673-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb673-38"><a href="statistics.html#cb673-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb673-39"><a href="statistics.html#cb673-39" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> fl_Delta_31</span>
<span id="cb673-40"><a href="statistics.html#cb673-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb673-41"><a href="statistics.html#cb673-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb673-42"><a href="statistics.html#cb673-42" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12</span>
<span id="cb673-43"><a href="statistics.html#cb673-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb673-44"><a href="statistics.html#cb673-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb673-45"><a href="statistics.html#cb673-45" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> fl_Delta_13</span>
<span id="cb673-46"><a href="statistics.html#cb673-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb673-47"><a href="statistics.html#cb673-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-48"><a href="statistics.html#cb673-48" aria-hidden="true" tabindex="-1"></a>      mt_alpha_true[it_row, it_col] <span class="ot">&lt;-</span> fl_current_val</span>
<span id="cb673-49"><a href="statistics.html#cb673-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb673-50"><a href="statistics.html#cb673-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb673-51"><a href="statistics.html#cb673-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-52"><a href="statistics.html#cb673-52" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_3by3</span>(mt_prob_joint_E_A, mt_alpha_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb673-53"><a href="statistics.html#cb673-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-54"><a href="statistics.html#cb673-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb673-55"><a href="statistics.html#cb673-55" aria-hidden="true" tabindex="-1"></a>  mt_alpha_solu <span class="ot">&lt;-</span> <span class="fu">ffi_solve_3by3_rectilinear</span>(mt_prob_joint_E_A, ar_b)</span>
<span id="cb673-56"><a href="statistics.html#cb673-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-57"><a href="statistics.html#cb673-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb673-58"><a href="statistics.html#cb673-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb673-59"><a href="statistics.html#cb673-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_true&#39;</span>)</span>
<span id="cb673-60"><a href="statistics.html#cb673-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_true)</span>
<span id="cb673-61"><a href="statistics.html#cb673-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_solu&#39;</span>)</span>
<span id="cb673-62"><a href="statistics.html#cb673-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_solu)</span>
<span id="cb673-63"><a href="statistics.html#cb673-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-64"><a href="statistics.html#cb673-64" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;mt_alpha_true&quot;
##      [,1] [,2] [,3]
## [1,] 0.10 0.19 0.22
## [2,] 0.15 0.24 0.27
## [3,] 0.22 0.31 0.34
## [1] &quot;mt_alpha_solu&quot;
##      [,1] [,2] [,3]
## [1,] 0.10 0.19 0.22
## [2,] 0.15 0.24 0.27
## [3,] 0.22 0.31 0.34
## [1] &quot;it_i=2&quot;
## [1] &quot;mt_alpha_true&quot;
##      [,1] [,2] [,3]
## [1,] 0.20 0.29 0.26
## [2,] 0.15 0.24 0.21
## [3,] 0.22 0.31 0.28
## [1] &quot;mt_alpha_solu&quot;
##      [,1] [,2] [,3]
## [1,] 0.20 0.29 0.26
## [2,] 0.15 0.24 0.21
## [3,] 0.22 0.31 0.28
## [1] &quot;it_i=3&quot;
## [1] &quot;mt_alpha_true&quot;
##      [,1] [,2] [,3]
## [1,] 0.15 0.15 0.25
## [2,] 0.26 0.26 0.36
## [3,] 0.25 0.25 0.35
## [1] &quot;mt_alpha_solu&quot;
##      [,1] [,2] [,3]
## [1,] 0.15 0.15 0.25
## [2,] 0.26 0.26 0.36
## [3,] 0.25 0.25 0.35</code></pre>
<p>Solving first when rectilinear assumption is NOT VALID, same as above, except add randomness at each point. Note that the solution is approximately the same as the actual in the examples here.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="statistics.html#cb675-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb675-2"><a href="statistics.html#cb675-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb675-3"><a href="statistics.html#cb675-3" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over alternatives</span></span>
<span id="cb675-4"><a href="statistics.html#cb675-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb675-5"><a href="statistics.html#cb675-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-6"><a href="statistics.html#cb675-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb675-7"><a href="statistics.html#cb675-7" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb675-8"><a href="statistics.html#cb675-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">3</span>, <span class="at">it_M =</span> <span class="dv">3</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb675-9"><a href="statistics.html#cb675-9" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb675-10"><a href="statistics.html#cb675-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-11"><a href="statistics.html#cb675-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb675-12"><a href="statistics.html#cb675-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb675-13"><a href="statistics.html#cb675-13" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb675-14"><a href="statistics.html#cb675-14" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb675-15"><a href="statistics.html#cb675-15" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="fl">0.07</span></span>
<span id="cb675-16"><a href="statistics.html#cb675-16" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb675-17"><a href="statistics.html#cb675-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb675-18"><a href="statistics.html#cb675-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb675-19"><a href="statistics.html#cb675-19" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb675-20"><a href="statistics.html#cb675-20" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb675-21"><a href="statistics.html#cb675-21" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.07</span></span>
<span id="cb675-22"><a href="statistics.html#cb675-22" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb675-23"><a href="statistics.html#cb675-23" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.03</span></span>
<span id="cb675-24"><a href="statistics.html#cb675-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb675-25"><a href="statistics.html#cb675-25" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb675-26"><a href="statistics.html#cb675-26" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb675-27"><a href="statistics.html#cb675-27" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb675-28"><a href="statistics.html#cb675-28" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb675-29"><a href="statistics.html#cb675-29" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.1</span></span>
<span id="cb675-30"><a href="statistics.html#cb675-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb675-31"><a href="statistics.html#cb675-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-32"><a href="statistics.html#cb675-32" aria-hidden="true" tabindex="-1"></a>  mt_alpha_true <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb675-33"><a href="statistics.html#cb675-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb675-34"><a href="statistics.html#cb675-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb675-35"><a href="statistics.html#cb675-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-36"><a href="statistics.html#cb675-36" aria-hidden="true" tabindex="-1"></a>      fl_current_val <span class="ot">&lt;-</span> fl_alpha</span>
<span id="cb675-37"><a href="statistics.html#cb675-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-38"><a href="statistics.html#cb675-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb675-39"><a href="statistics.html#cb675-39" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb675-40"><a href="statistics.html#cb675-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb675-41"><a href="statistics.html#cb675-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb675-42"><a href="statistics.html#cb675-42" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> fl_Delta_31 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb675-43"><a href="statistics.html#cb675-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb675-44"><a href="statistics.html#cb675-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb675-45"><a href="statistics.html#cb675-45" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb675-46"><a href="statistics.html#cb675-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb675-47"><a href="statistics.html#cb675-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb675-48"><a href="statistics.html#cb675-48" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> fl_Delta_13 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb675-49"><a href="statistics.html#cb675-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb675-50"><a href="statistics.html#cb675-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-51"><a href="statistics.html#cb675-51" aria-hidden="true" tabindex="-1"></a>      mt_alpha_true[it_row, it_col] <span class="ot">&lt;-</span> fl_current_val</span>
<span id="cb675-52"><a href="statistics.html#cb675-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb675-53"><a href="statistics.html#cb675-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb675-54"><a href="statistics.html#cb675-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-55"><a href="statistics.html#cb675-55" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_3by3</span>(mt_prob_joint_E_A, mt_alpha_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb675-56"><a href="statistics.html#cb675-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-57"><a href="statistics.html#cb675-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb675-58"><a href="statistics.html#cb675-58" aria-hidden="true" tabindex="-1"></a>  mt_alpha_solu <span class="ot">&lt;-</span> <span class="fu">ffi_solve_3by3_rectilinear</span>(mt_prob_joint_E_A, ar_b)</span>
<span id="cb675-59"><a href="statistics.html#cb675-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-60"><a href="statistics.html#cb675-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb675-61"><a href="statistics.html#cb675-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb675-62"><a href="statistics.html#cb675-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_true&#39;</span>)</span>
<span id="cb675-63"><a href="statistics.html#cb675-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_true)</span>
<span id="cb675-64"><a href="statistics.html#cb675-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_solu&#39;</span>)</span>
<span id="cb675-65"><a href="statistics.html#cb675-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_solu)</span>
<span id="cb675-66"><a href="statistics.html#cb675-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-67"><a href="statistics.html#cb675-67" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;mt_alpha_true&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1000000 0.2813229 0.4113667
## [2,] 0.2406668 0.4900408 0.4705499
## [3,] 0.2692175 0.3839961 0.7088086
## [1] &quot;mt_alpha_solu&quot;
##            [,1]      [,2]      [,3]
## [1,] 0.06922205 0.2610615 0.4720626
## [2,] 0.26540144 0.4572409 0.6682420
## [3,] 0.24462011 0.4364596 0.6474607
## [1] &quot;it_i=2&quot;
## [1] &quot;mt_alpha_true&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.2000000 0.3813229 0.4513667
## [2,] 0.2406668 0.4900408 0.4105499
## [3,] 0.2692175 0.3839961 0.6488086
## [1] &quot;mt_alpha_solu&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1692221 0.3610615 0.5120626
## [2,] 0.2654014 0.4572409 0.6082420
## [3,] 0.2446201 0.4364596 0.5874607
## [1] &quot;it_i=3&quot;
## [1] &quot;mt_alpha_true&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1500000 0.2413229 0.4413667
## [2,] 0.3506668 0.5100408 0.5605499
## [3,] 0.2992175 0.3239961 0.7188086
## [1] &quot;mt_alpha_solu&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1192221 0.2210615 0.5020626
## [2,] 0.3754014 0.4772409 0.7582420
## [3,] 0.2746201 0.3764596 0.6574607</code></pre>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mathematics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tables-and-graphs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
