<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Statistics | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Statistics | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Statistics | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2021-05-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mathematics.html"/>
<link rel="next" href="tables-and-graphs.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-dataframes"><i class="fa fa-check"></i><b>1.4.5</b> String Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarize-data.html"><a href="summarize-data.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.2.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.3.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.4" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-compare"><i class="fa fa-check"></i><b>4.3</b> Join and Compare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.1</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.1.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.1.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.2</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.2.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.1</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#positive-and-negative-exponents"><i class="fa fa-check"></i><b>8.1.2</b> Positive and Negative Exponents</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.3</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.2</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.2.1</b> Gini Discrete Sample</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.2.2</b> Gini Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.2.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.2.3</b> Atkinson Inequality Index</a></li>
<li class="chapter" data-level="8.2.4" data-path="mathematics.html"><a href="mathematics.html#location-population-and-pollution"><i class="fa fa-check"></i><b>8.2.4</b> Location, Population, and Pollution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.1.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.2</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-marginal-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.2.1</b> Obtaining Joint Distribution from Marginal with Rectilinear Restrictions</a></li>
<li class="chapter" data-level="9.2.2" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-conditional-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.2.2</b> Obtaining Joint Distribution from Conditional with Rectilinear Restrictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-and-development.html"><a href="code-and-development.html"><i class="fa fa-check"></i><b>12</b> Code and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="code-and-development.html"><a href="code-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.1</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="code-and-development.html"><a href="code-and-development.html#file-path"><i class="fa fa-check"></i><b>12.1.1</b> File Path</a></li>
<li class="chapter" data-level="12.1.2" data-path="code-and-development.html"><a href="code-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.1.2</b> Text to File</a></li>
<li class="chapter" data-level="12.1.3" data-path="code-and-development.html"><a href="code-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.1.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="code-and-development.html"><a href="code-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.2</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="code-and-development.html"><a href="code-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.2.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="code-and-development.html"><a href="code-and-development.html#command-line"><i class="fa fa-check"></i><b>12.3</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="code-and-development.html"><a href="code-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.3.1</b> Shell and System Commands</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate, Gather, Bind and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-join-and-comparejoin-and-compare-links"><i class="fa fa-check"></i><b>A.4.3</b> <span>Section 4.3 Join and Compare</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Quantile Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Basics</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 Distributions</span> links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.2</b> <span>Section 9.2 Discrete Random Variable</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> <span>Section 10.2 ggplot Line Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> <span>Section 10.3 ggplot Scatter Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> <span>Section 10.4 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> <span>Section 11.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#code-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Code and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.1</b> <span>Section 12.1 Files In and Out</span> links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.2</b> <span>Section 12.2 Python with R</span> links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.3</b> <span>Section 12.3 Command Line</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Statistics</h1>

<div id="distributions" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Distributions</h2>

<div id="integrate-over-normal-guassian-process-shock" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Integrate Over Normal Guassian Process Shock</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>Some Common parameters</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="statistics.html#cb527-1" aria-hidden="true" tabindex="-1"></a>fl_eps_mean <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb527-2"><a href="statistics.html#cb527-2" aria-hidden="true" tabindex="-1"></a>fl_eps_sd <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb527-3"><a href="statistics.html#cb527-3" aria-hidden="true" tabindex="-1"></a>fl_cdf_min <span class="ot">=</span> <span class="fl">0.000001</span></span>
<span id="cb527-4"><a href="statistics.html#cb527-4" aria-hidden="true" tabindex="-1"></a>fl_cdf_max <span class="ot">=</span> <span class="fl">0.999999</span></span>
<span id="cb527-5"><a href="statistics.html#cb527-5" aria-hidden="true" tabindex="-1"></a>ar_it_draws <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span></code></pre></div>
<div id="randomly-sample-and-integrate-monte-carlo-integration" class="section level4" number="9.1.1.1">
<h4><span class="header-section-number">9.1.1.1</span> Randomly Sample and Integrate (Monte Carlo Integration)</h4>
<p>Compare randomly drawn normal shock mean and known mean. How does simulated mean change with draws. Actual integral equals to <span class="math inline">\(10\)</span>, as sample size increases, the sample mean approaches the integration results, but this is expensive, even with ten thousand draws, not very exact.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="statistics.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Draws</span></span>
<span id="cb528-2"><a href="statistics.html#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb528-3"><a href="statistics.html#cb528-3" aria-hidden="true" tabindex="-1"></a>ar_fl_means <span class="ot">&lt;-</span></span>
<span id="cb528-4"><a href="statistics.html#cb528-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb528-5"><a href="statistics.html#cb528-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">rnorm</span>(x[<span class="dv">1</span>], <span class="at">mean=</span>fl_eps_mean, <span class="at">sd=</span>fl_eps_sd))))</span>
<span id="cb528-6"><a href="statistics.html#cb528-6" aria-hidden="true" tabindex="-1"></a>ar_fl_sd <span class="ot">&lt;-</span></span>
<span id="cb528-7"><a href="statistics.html#cb528-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb528-8"><a href="statistics.html#cb528-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sd</span>(<span class="fu">rnorm</span>(x[<span class="dv">1</span>], <span class="at">mean=</span>fl_eps_mean, <span class="at">sd=</span>fl_eps_sd))))</span>
<span id="cb528-9"><a href="statistics.html#cb528-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-10"><a href="statistics.html#cb528-10" aria-hidden="true" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, ar_fl_means, ar_fl_sd)</span>
<span id="cb528-11"><a href="statistics.html#cb528-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb528-12"><a href="statistics.html#cb528-12" aria-hidden="true" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb528-13"><a href="statistics.html#cb528-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-14"><a href="statistics.html#cb528-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb528-15"><a href="statistics.html#cb528-15" aria-hidden="true" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb528-16"><a href="statistics.html#cb528-16" aria-hidden="true" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb528-17"><a href="statistics.html#cb528-17" aria-hidden="true" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb528-18"><a href="statistics.html#cb528-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-19"><a href="statistics.html#cb528-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Subtitle</span></span>
<span id="cb528-20"><a href="statistics.html#cb528-20" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb528-21"><a href="statistics.html#cb528-21" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/integration/htmlpdfr/fs_integrate_normal.html&#39;</span>)</span>
<span id="cb528-22"><a href="statistics.html#cb528-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-23"><a href="statistics.html#cb528-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb528-24"><a href="statistics.html#cb528-24" aria-hidden="true" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Sample Size Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb528-25"><a href="statistics.html#cb528-25" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb528-26"><a href="statistics.html#cb528-26" aria-hidden="true" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Size&#39;</span>)</span>
<span id="cb528-27"><a href="statistics.html#cb528-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-28"><a href="statistics.html#cb528-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb528-29"><a href="statistics.html#cb528-29" aria-hidden="true" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb528-30"><a href="statistics.html#cb528-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb528-31"><a href="statistics.html#cb528-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb528-32"><a href="statistics.html#cb528-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Mean &#39;</span>, slb_title_shr),</span>
<span id="cb528-33"><a href="statistics.html#cb528-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb528-34"><a href="statistics.html#cb528-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb528-35"><a href="statistics.html#cb528-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sample Mean&#39;</span>,</span>
<span id="cb528-36"><a href="statistics.html#cb528-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Mean of Sample Integrates to True Mean&#39;</span>) <span class="sc">+</span></span>
<span id="cb528-37"><a href="statistics.html#cb528-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb528-38"><a href="statistics.html#cb528-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb528-39"><a href="statistics.html#cb528-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-271-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="statistics.html#cb529-1" aria-hidden="true" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb529-2"><a href="statistics.html#cb529-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb529-3"><a href="statistics.html#cb529-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb529-4"><a href="statistics.html#cb529-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb529-5"><a href="statistics.html#cb529-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb529-6"><a href="statistics.html#cb529-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb529-7"><a href="statistics.html#cb529-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sample Standard Deviation&#39;</span>,</span>
<span id="cb529-8"><a href="statistics.html#cb529-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Standard Deviation of Sample Integrates to True SD&#39;</span>) <span class="sc">+</span></span>
<span id="cb529-9"><a href="statistics.html#cb529-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb529-10"><a href="statistics.html#cb529-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb529-11"><a href="statistics.html#cb529-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-271-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-symmetric-uneven-rectangle" class="section level4" number="9.1.1.2">
<h4><span class="header-section-number">9.1.1.2</span> Integration By Symmetric Uneven Rectangle</h4>
<p>Draw on even grid from close to 0 to close to 1. Get the corresponding x points to these quantile levels. Distance between x points are not equi-distance but increasing and symmetric away from the mean. Under this approach, each rectangle aims to approximate the same area.</p>
<p>Resulting integration is rectangle based, but rectangle width differ. The rectangles have wider width as they move away from the mean, and thinner width close to the mean. This is much more stable than the random draw method, but note that it converges somewhat slowly to true values as well.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="statistics.html#cb530-1" aria-hidden="true" tabindex="-1"></a>mt_fl_means <span class="ot">&lt;-</span></span>
<span id="cb530-2"><a href="statistics.html#cb530-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb530-3"><a href="statistics.html#cb530-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-4"><a href="statistics.html#cb530-4" aria-hidden="true" tabindex="-1"></a>    fl_prob_break <span class="ot">=</span> (fl_cdf_max <span class="sc">-</span> fl_cdf_min)<span class="sc">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb530-5"><a href="statistics.html#cb530-5" aria-hidden="true" tabindex="-1"></a>    ar_eps_bounds <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">seq</span>(fl_cdf_min, fl_cdf_max,</span>
<span id="cb530-6"><a href="statistics.html#cb530-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">by=</span>(fl_cdf_max <span class="sc">-</span> fl_cdf_min)<span class="sc">/</span>(x[<span class="dv">1</span>])),</span>
<span id="cb530-7"><a href="statistics.html#cb530-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb530-8"><a href="statistics.html#cb530-8" aria-hidden="true" tabindex="-1"></a>    ar_eps_val <span class="ot">&lt;-</span> (<span class="fu">tail</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">head</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb530-9"><a href="statistics.html#cb530-9" aria-hidden="true" tabindex="-1"></a>    ar_eps_prb <span class="ot">&lt;-</span> <span class="fu">rep</span>(fl_prob_break<span class="sc">/</span>(fl_cdf_max <span class="sc">-</span> fl_cdf_min), x[<span class="dv">1</span>])</span>
<span id="cb530-10"><a href="statistics.html#cb530-10" aria-hidden="true" tabindex="-1"></a>    ar_eps_fev <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(ar_eps_val,</span>
<span id="cb530-11"><a href="statistics.html#cb530-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb530-12"><a href="statistics.html#cb530-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-13"><a href="statistics.html#cb530-13" aria-hidden="true" tabindex="-1"></a>    fl_cdf_total_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds))</span>
<span id="cb530-14"><a href="statistics.html#cb530-14" aria-hidden="true" tabindex="-1"></a>    fl_mean_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_val<span class="sc">*</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds)))</span>
<span id="cb530-15"><a href="statistics.html#cb530-15" aria-hidden="true" tabindex="-1"></a>    fl_sd_approx <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((ar_eps_val<span class="sc">-</span>fl_mean_approx)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds))))</span>
<span id="cb530-16"><a href="statistics.html#cb530-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-17"><a href="statistics.html#cb530-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">cdf=</span>fl_cdf_total_approx, <span class="at">mean=</span>fl_mean_approx, <span class="at">sd=</span>fl_sd_approx))</span>
<span id="cb530-18"><a href="statistics.html#cb530-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb530-19"><a href="statistics.html#cb530-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-20"><a href="statistics.html#cb530-20" aria-hidden="true" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, <span class="fu">as_tibble</span>(<span class="fu">t</span>(mt_fl_means)) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>())</span>
<span id="cb530-21"><a href="statistics.html#cb530-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb530-22"><a href="statistics.html#cb530-22" aria-hidden="true" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb530-23"><a href="statistics.html#cb530-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-24"><a href="statistics.html#cb530-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb530-25"><a href="statistics.html#cb530-25" aria-hidden="true" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb530-26"><a href="statistics.html#cb530-26" aria-hidden="true" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb530-27"><a href="statistics.html#cb530-27" aria-hidden="true" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb530-28"><a href="statistics.html#cb530-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-29"><a href="statistics.html#cb530-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb530-30"><a href="statistics.html#cb530-30" aria-hidden="true" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Uneven Rectangle Count Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb530-31"><a href="statistics.html#cb530-31" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb530-32"><a href="statistics.html#cb530-32" aria-hidden="true" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Number of Quantile Bins for Uneven Rectangles Approximation&#39;</span>)</span>
<span id="cb530-33"><a href="statistics.html#cb530-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-34"><a href="statistics.html#cb530-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb530-35"><a href="statistics.html#cb530-35" aria-hidden="true" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb530-36"><a href="statistics.html#cb530-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb530-37"><a href="statistics.html#cb530-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb530-38"><a href="statistics.html#cb530-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb530-39"><a href="statistics.html#cb530-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb530-40"><a href="statistics.html#cb530-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb530-41"><a href="statistics.html#cb530-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Approximated Mean&#39;</span>,</span>
<span id="cb530-42"><a href="statistics.html#cb530-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb530-43"><a href="statistics.html#cb530-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb530-44"><a href="statistics.html#cb530-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb530-45"><a href="statistics.html#cb530-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-272-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="statistics.html#cb531-1" aria-hidden="true" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb531-2"><a href="statistics.html#cb531-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb531-3"><a href="statistics.html#cb531-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb531-4"><a href="statistics.html#cb531-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb531-5"><a href="statistics.html#cb531-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb531-6"><a href="statistics.html#cb531-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb531-7"><a href="statistics.html#cb531-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Approximated Standard Deviation&#39;</span>,</span>
<span id="cb531-8"><a href="statistics.html#cb531-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb531-9"><a href="statistics.html#cb531-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb531-10"><a href="statistics.html#cb531-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb531-11"><a href="statistics.html#cb531-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-272-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="statistics.html#cb532-1" aria-hidden="true" tabindex="-1"></a>plt_cdf <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb532-2"><a href="statistics.html#cb532-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>cdf)) <span class="sc">+</span></span>
<span id="cb532-3"><a href="statistics.html#cb532-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb532-4"><a href="statistics.html#cb532-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb532-5"><a href="statistics.html#cb532-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb532-6"><a href="statistics.html#cb532-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb532-7"><a href="statistics.html#cb532-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sum of Uneven Rectangles&#39;</span>,</span>
<span id="cb532-8"><a href="statistics.html#cb532-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb532-9"><a href="statistics.html#cb532-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb532-10"><a href="statistics.html#cb532-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb532-11"><a href="statistics.html#cb532-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-272-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-constant-width-rectangle-trapezoidal-rule" class="section level4" number="9.1.1.3">
<h4><span class="header-section-number">9.1.1.3</span> Integration By Constant Width Rectangle (Trapezoidal rule)</h4>
<p>This is implementing even width recentagle, even along x-axix. Rectangle width are the same, height is <span class="math inline">\(f(x)\)</span>. This is even width, but uneven area. Note that this method approximates the true answer much better and more quickly than the prior methods.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="statistics.html#cb533-1" aria-hidden="true" tabindex="-1"></a>mt_fl_means <span class="ot">&lt;-</span></span>
<span id="cb533-2"><a href="statistics.html#cb533-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb533-3"><a href="statistics.html#cb533-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-4"><a href="statistics.html#cb533-4" aria-hidden="true" tabindex="-1"></a>    fl_eps_min <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(fl_cdf_min, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb533-5"><a href="statistics.html#cb533-5" aria-hidden="true" tabindex="-1"></a>    fl_eps_max <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(fl_cdf_max, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb533-6"><a href="statistics.html#cb533-6" aria-hidden="true" tabindex="-1"></a>    fl_gap <span class="ot">&lt;-</span> (fl_eps_max<span class="sc">-</span>fl_eps_min)<span class="sc">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb533-7"><a href="statistics.html#cb533-7" aria-hidden="true" tabindex="-1"></a>    ar_eps_bounds <span class="ot">&lt;-</span> <span class="fu">seq</span>(fl_eps_min, fl_eps_max, <span class="at">by=</span>fl_gap)</span>
<span id="cb533-8"><a href="statistics.html#cb533-8" aria-hidden="true" tabindex="-1"></a>    ar_eps_val <span class="ot">&lt;-</span> (<span class="fu">tail</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">head</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb533-9"><a href="statistics.html#cb533-9" aria-hidden="true" tabindex="-1"></a>    ar_eps_prb <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(ar_eps_val, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)<span class="sc">*</span>fl_gap</span>
<span id="cb533-10"><a href="statistics.html#cb533-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-11"><a href="statistics.html#cb533-11" aria-hidden="true" tabindex="-1"></a>    fl_cdf_total_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_prb)</span>
<span id="cb533-12"><a href="statistics.html#cb533-12" aria-hidden="true" tabindex="-1"></a>    fl_mean_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_val<span class="sc">*</span>ar_eps_prb)</span>
<span id="cb533-13"><a href="statistics.html#cb533-13" aria-hidden="true" tabindex="-1"></a>    fl_sd_approx <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((ar_eps_val<span class="sc">-</span>fl_mean_approx)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>ar_eps_prb))</span>
<span id="cb533-14"><a href="statistics.html#cb533-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-15"><a href="statistics.html#cb533-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">cdf=</span>fl_cdf_total_approx, <span class="at">mean=</span>fl_mean_approx, <span class="at">sd=</span>fl_sd_approx))</span>
<span id="cb533-16"><a href="statistics.html#cb533-16" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb533-17"><a href="statistics.html#cb533-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-18"><a href="statistics.html#cb533-18" aria-hidden="true" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, <span class="fu">as_tibble</span>(<span class="fu">t</span>(mt_fl_means)) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>())</span>
<span id="cb533-19"><a href="statistics.html#cb533-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb533-20"><a href="statistics.html#cb533-20" aria-hidden="true" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb533-21"><a href="statistics.html#cb533-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-22"><a href="statistics.html#cb533-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb533-23"><a href="statistics.html#cb533-23" aria-hidden="true" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb533-24"><a href="statistics.html#cb533-24" aria-hidden="true" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb533-25"><a href="statistics.html#cb533-25" aria-hidden="true" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb533-26"><a href="statistics.html#cb533-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-27"><a href="statistics.html#cb533-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb533-28"><a href="statistics.html#cb533-28" aria-hidden="true" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Even Rectangle Count Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb533-29"><a href="statistics.html#cb533-29" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb533-30"><a href="statistics.html#cb533-30" aria-hidden="true" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Number Equi-distance Rectangles Bins&#39;</span>)</span>
<span id="cb533-31"><a href="statistics.html#cb533-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-32"><a href="statistics.html#cb533-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb533-33"><a href="statistics.html#cb533-33" aria-hidden="true" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb533-34"><a href="statistics.html#cb533-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb533-35"><a href="statistics.html#cb533-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb533-36"><a href="statistics.html#cb533-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb533-37"><a href="statistics.html#cb533-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb533-38"><a href="statistics.html#cb533-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb533-39"><a href="statistics.html#cb533-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Integrated Mean&#39;</span>,</span>
<span id="cb533-40"><a href="statistics.html#cb533-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb533-41"><a href="statistics.html#cb533-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb533-42"><a href="statistics.html#cb533-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb533-43"><a href="statistics.html#cb533-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-273-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="statistics.html#cb534-1" aria-hidden="true" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb534-2"><a href="statistics.html#cb534-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb534-3"><a href="statistics.html#cb534-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb534-4"><a href="statistics.html#cb534-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb534-5"><a href="statistics.html#cb534-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb534-6"><a href="statistics.html#cb534-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb534-7"><a href="statistics.html#cb534-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Standard Deviation&#39;</span>,</span>
<span id="cb534-8"><a href="statistics.html#cb534-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb534-9"><a href="statistics.html#cb534-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb534-10"><a href="statistics.html#cb534-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb534-11"><a href="statistics.html#cb534-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-273-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="statistics.html#cb535-1" aria-hidden="true" tabindex="-1"></a>plt_cdf <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb535-2"><a href="statistics.html#cb535-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>cdf)) <span class="sc">+</span></span>
<span id="cb535-3"><a href="statistics.html#cb535-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb535-4"><a href="statistics.html#cb535-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb535-5"><a href="statistics.html#cb535-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb535-6"><a href="statistics.html#cb535-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb535-7"><a href="statistics.html#cb535-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sum of Equi-Dist Rectangles&#39;</span>,</span>
<span id="cb535-8"><a href="statistics.html#cb535-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Equi-Dist Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb535-9"><a href="statistics.html#cb535-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb535-10"><a href="statistics.html#cb535-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb535-11"><a href="statistics.html#cb535-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-273-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="discrete-random-variable" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Discrete Random Variable</h2>

<div id="obtaining-joint-distribution-from-marginal-with-rectilinear-restrictions" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Obtaining Joint Distribution from Marginal with Rectilinear Restrictions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>Suppose we want to know the joint probability mass function <span class="math inline">\(P(E,A)\)</span> where <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span> are both discrete. <span class="math inline">\(E\)</span> could be education groups, and <span class="math inline">\(A\)</span> could be age groups. But we only know <span class="math inline">\(P(E)\)</span> and <span class="math inline">\(P(A)\)</span>, under what conditions can we obtain the joint distribution from the marginals?</p>
<div id="unrestricted-joint-2-by-2-distribution" class="section level4" number="9.2.1.1">
<h4><span class="header-section-number">9.2.1.1</span> Unrestricted Joint 2 by 2 Distribution</h4>
<p>Suppose there are two unique states for <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span>. For example, suppose we know the unemployment probability for better or worse educated, and also for low and high age groups. We want to know the joint probability of been both better educated and lower age, better educated and higher age, worse educated and lower age, and worse educated and higher age. Then:</p>
<p><span class="math display">\[
\begin{aligned}
P(E_1) = P(A_1,E_1) + P(A_2,E_1)\\
P(E_2) = P(A_1,E_2) + P(A_2,E_2)\\
P(A_1) = P(A_1,E_1) + P(A_1,E_2)\\
P(A_2) = P(A_2,E_1) + P(A_2,E_2)
\end{aligned}
\]</span></p>
<p>We know <span class="math inline">\(P(E_1)\)</span>, <span class="math inline">\(P(E_2)\)</span>, <span class="math inline">\(P(A_1)\)</span> and <span class="math inline">\(P(A_2)\)</span>, but not <span class="math inline">\(P(A_i,E_i)\)</span>. Let <span class="math inline">\(X,W,Y,Z\)</span> be unknowns and <span class="math inline">\(A,B,C,D\)</span> are known. It might seem like that with four equations and four unknowns, we can find <span class="math inline">\(X,W,Y,Z\)</span>. But because what we know are probabilities: the marginals along each dimension sums up to 1. Without restrictions, there are no unique solutions to this problem. but many possible solutions. For example, Suppose <span class="math inline">\(P(E_1)=0.5\)</span> and <span class="math inline">\(P(A_1)=0.5\)</span>, rewrite the above problem as:</p>
<p><span class="math display">\[
\begin{aligned}
0.5 = X + W\\
0.5 = Y + Z\\
0.5 = W + Y\\
0.5 = X + Z\\
\end{aligned}
\]</span></p>
<p>Solutions include:</p>
<ul>
<li><span class="math inline">\(X=0.2\)</span>, <span class="math inline">\(W=0.3\)</span>, <span class="math inline">\(Y=0.2\)</span>, <span class="math inline">\(Z=0.3\)</span></li>
<li><span class="math inline">\(X=0.4\)</span>, <span class="math inline">\(W=0.1\)</span>, <span class="math inline">\(Y=0.4\)</span>, <span class="math inline">\(Z=0.1\)</span></li>
<li>and infinitely many others â€¦</li>
</ul>
<p>There are no unique solutions, because, when we write the linear system above in matrix form as shown below, the <span class="math inline">\(A\)</span> coefficient matrix is not full rank, but has a rank of 3.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 1 \\
1 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 1 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
W \\
X \\
Y \\
Z
\end{bmatrix}
&amp; =
\begin{bmatrix}
A \\
B \\
C \\
D \\
\end{bmatrix}\\
A \cdot \mathbb{X} &amp; =  b
\end{aligned}
\]</span>
We can see the rank of a matrix with the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/qr.html">qr</a> function (QR decomposition):</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="statistics.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb536-2"><a href="statistics.html#cb536-2" aria-hidden="true" tabindex="-1"></a>mt_a <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb536-3"><a href="statistics.html#cb536-3" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb536-4"><a href="statistics.html#cb536-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb536-5"><a href="statistics.html#cb536-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb536-6"><a href="statistics.html#cb536-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rank Check with the qr function:</span></span>
<span id="cb536-7"><a href="statistics.html#cb536-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">qr</span>(mt_a))</span></code></pre></div>
<pre><code>## $qr
##            [,1]       [,2]       [,3]          [,4]
## [1,] -1.4142136 -0.7071068 -0.7071068  0.000000e+00
## [2,]  0.0000000 -1.2247449  0.4082483 -8.164966e-01
## [3,]  0.7071068 -0.5773503 -1.1547005 -1.154701e+00
## [4,]  0.0000000  0.8164966 -0.4184316 -2.775558e-16
## 
## $rank
## [1] 3
## 
## $qraux
## [1] 1.707107e+00 1.000000e+00 1.908248e+00 2.775558e-16
## 
## $pivot
## [1] 1 2 3 4
## 
## attr(,&quot;class&quot;)
## [1] &quot;qr&quot;</code></pre>
</div>
<div id="rectilinear-restriction-on-joint-2-by-2-distribution" class="section level4" number="9.2.1.2">
<h4><span class="header-section-number">9.2.1.2</span> Rectilinear Restriction on Joint 2 by 2 Distribution</h4>
<p>So in the section above, it is demonstrated that it is not possible to uniquely identify the joint probability mass function from marginal probability mass functions.</p>
<p>However, sometimes, we need to find some reasonable joint distribution, when we only observe marginal distributions. This joint distribution might be an input transition matrix in a model we simulate. If we just use one of the infinitely possible joint mass that match up with the marginals, then the model would have infinitely many simulation results depending on our arbitrary choice of joint mass.</p>
<p>Ideally, one should try to obtain data to estimate the underlying joint distribution, when this is not possible, we can impose additional non-parametric restrictions on the structures of the joint probability mass that would lead to unique joint mass from marginals.</p>
<p>Specifically, I will assume the incremental changes across rows and across columns of the joint mass matrix are row or column specific, is this sufficient? (In Some Cases it Will Not be):</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = P(A_1,E_2) - P(A_1,E_1) = P(A_2,E_2) - P(A_2,E_1)\\
\Delta^{A}_{12} = P(A_2,E_1) - P(A_1,E_1) = P(A_2,E_2) - P(A_1,E_2)\\
\end{aligned}
\]</span>
The assumption is non-parametric. This is effectively an rectilinear assumption on the joint Cumulative Probability Mass Function.</p>
<p>Given this assumption, now we have:
<span class="math display">\[
\begin{aligned}
P(E_2) - P(E_1) = P(A_1,E_2) + P(A_2,E_2) - P(A_1,E_1) - P(A_2,E_1)\\
P(A_2) - P(A_1) = P(A_2,E_1) + P(A_2,E_2) - P(A_1,E_1) - P(A_1,E_2)\\
\end{aligned}
\]</span></p>
<p>Which become:
<span class="math display">\[
\begin{aligned}
P(E_2) - P(E_1) = 2\cdot\Delta^{E}_{12}\\
P(A_2) - P(A_1) = 2\cdot\Delta^{A}_{12}
\end{aligned}
\]</span>
Suppose <span class="math inline">\(P(E_1)=0.5\)</span> and <span class="math inline">\(P(A_1)=0.5\)</span>:</p>
<ul>
<li><span class="math inline">\(\phi=0\)</span></li>
<li><span class="math inline">\(\rho=0\)</span></li>
<li>hence: <span class="math inline">\(P(A_1,E_1) = P(A_1,E_2) = P(A_2,E_1) = P(A_2,E_2) = 0.25\)</span></li>
</ul>
<p>Suppose <span class="math inline">\(P(E_1)=0.4\)</span> and <span class="math inline">\(P(A_1)=0.7\)</span>:</p>
<ul>
<li><span class="math inline">\(\Delta^{E}_{12}=0.1\)</span></li>
<li><span class="math inline">\(\Delta^{A}_{12}=-0.20\)</span></li>
</ul>
<p>Hence:</p>
<p><span class="math display">\[
\begin{aligned}
0.4 = P(A_1,E_1) + P(A_2,E_1)
    = P(A_1,E_1) + P(A_1,E_1) + \Delta^{A}_{12}
    = 2\cdot P(A_1,E_1) - 0.20\\
\end{aligned}
\]</span></p>
<p>And:
<span class="math display">\[
\begin{aligned}
P(A_1,E_1) = \frac{0.60}{2}=0.30\\
P(A_2,E_1) = 0.4-0.30=0.10\\
P(A_1,E_2) = 0.7-0.30=0.40\\
P(A_2,E_2) = 0.3-0.10=0.20\\
\end{aligned}
\]</span></p>
<p>These joint mass sum up to 1, satisfy the marginal mass requirements from the data, and are unique given the rectilinear assumption.</p>
</div>
<div id="rectilinear-restriction-diamond-on-joint-2-by-2-distribution" class="section level4" number="9.2.1.3">
<h4><span class="header-section-number">9.2.1.3</span> Rectilinear Restriction Diamond on Joint 2 by 2 Distribution</h4>
<p>The rectilinear assumptions, however, do not necessarily lead to positive values for each element of the joint mass function. In this section, I discuss under what conditions the rectilinear restriction leads to positive mass at all points of the joint probability mass function.</p>
<p>We can write these:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1)
=
\frac{1}{4}
\left(
  1
  - \Delta^{E}_{12}\cdot 2
  - \Delta^{A}_{12}\cdot 2
\right)\\
P(A_2, E_1)
= P(A_1, E_1) + \Delta^{A}_{12}\\
P(A_1, E_2)
= P(A_1, E_1) + \Delta^{E}_{12}\\
P(A_2, E_2)
= P(A_1, E_1) + \Delta^{A}_{12} + \Delta^{E}_{12}\\
\end{aligned}
\]</span>
Plugging the Values for <span class="math inline">\(P(A_1, E_1)\)</span> in, we have:
<span class="math display">\[
\begin{aligned}
P(A_1, E_1)
=
\frac{1}{4}
\left(
  1
  - \Delta^{E}_{12}\cdot 2
  - \Delta^{A}_{12}\cdot 2
\right)\\
P(A_2, E_1)
=
\frac{1}{4}
\left(
  1
  - \Delta^{E}_{12}\cdot 2
  + \Delta^{A}_{12}\cdot 2
\right)
\\
P(A_1, E_2)
=
\frac{1}{4}
\left(
  1
  + \Delta^{E}_{12}\cdot 2
  - \Delta^{A}_{12}\cdot 2
\right)
\\
P(A_2, E_2)
=
\frac{1}{4}
\left(
  1
  + \Delta^{E}_{12}\cdot 2
  + \Delta^{A}_{12}\cdot 2
\right)\\
\end{aligned}
\]</span>
When are these terms positive:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1) \ge 0
\text{ iff }
\frac{1}{2} \ge \Delta^{E}_{12} + \Delta^{A}_{12}
\\
P(A_2, E_1) \ge 0
\text{ iff }
\frac{1}{2} \ge \Delta^{E}_{12} - \Delta^{A}_{12}
\\
P(A_1, E_2) \ge 0
\text{ iff }
\frac{1}{2} \ge - \Delta^{E}_{12} + \Delta^{A}_{12}
\\
P(A_2, E_2) \ge 0
\text{ iff }
\frac{1}{2} \ge - \Delta^{E}_{12} - \Delta^{A}_{12}
\\
\end{aligned}
\]</span>
Rewriting the positivity conditions, we have:
<span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} \le \frac{1}{2} - \Delta^{A}_{12}
\\
\Delta^{E}_{12} \le \frac{1}{2} + \Delta^{A}_{12}
\\
\Delta^{E}_{12} \ge -\frac{1}{2} + \Delta^{A}_{12}
\\
\Delta^{E}_{12} \ge -\frac{1}{2} - \Delta^{A}_{12}
\\
\end{aligned}
\]</span>
The four conditions above create a diamond, Following the rectilinear restriction, if the <span class="math inline">\(\delta^E\)</span> and <span class="math inline">\(\delta^A\)</span> values fall within the diamond region, then the mass for at all joint probability points will be positive. Basically the restriction is that when the jumps in mass are more extreme, rectilinear restriction will not return positive mass at all points. The requirement is that:
<span class="math display">\[
\mid \Delta^{A}_{12} \mid + \mid \Delta^{E}_{12} \mid \le \frac{1}{2}
\]</span></p>
<p>Graphically:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="statistics.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb538-2"><a href="statistics.html#cb538-2" aria-hidden="true" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;2 by 2 Joint Mass from Marginal Rectilinear Assumption</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb538-3"><a href="statistics.html#cb538-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;Intersecting Area Positive Mass at all Joint Discrete Points</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb538-4"><a href="statistics.html#cb538-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;x-axis and y-axis values will never exceed -0.5 or 0.5&#39;</span>)</span>
<span id="cb538-5"><a href="statistics.html#cb538-5" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb538-6"><a href="statistics.html#cb538-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/discrandvar/htmlpdfr/fs_drm_mass.html&#39;</span>)</span>
<span id="cb538-7"><a href="statistics.html#cb538-7" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;delta A&#39;</span></span>
<span id="cb538-8"><a href="statistics.html#cb538-8" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;delta E&#39;</span></span>
<span id="cb538-9"><a href="statistics.html#cb538-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-10"><a href="statistics.html#cb538-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 1</span></span>
<span id="cb538-11"><a href="statistics.html#cb538-11" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb538-12"><a href="statistics.html#cb538-12" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">-</span>x1</span>
<span id="cb538-13"><a href="statistics.html#cb538-13" aria-hidden="true" tabindex="-1"></a>st_legend1 <span class="ot">&lt;-</span> <span class="st">&#39;Below This Line</span><span class="sc">\n</span><span class="st"> P_A1_E1&gt;0 Restriction&#39;</span></span>
<span id="cb538-14"><a href="statistics.html#cb538-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 2</span></span>
<span id="cb538-15"><a href="statistics.html#cb538-15" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb538-16"><a href="statistics.html#cb538-16" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">+</span>x2</span>
<span id="cb538-17"><a href="statistics.html#cb538-17" aria-hidden="true" tabindex="-1"></a>st_legend2 <span class="ot">&lt;-</span> <span class="st">&#39;Below This Line</span><span class="sc">\n</span><span class="st"> P_A2_E1&gt;0 Restriction&#39;</span></span>
<span id="cb538-18"><a href="statistics.html#cb538-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 3</span></span>
<span id="cb538-19"><a href="statistics.html#cb538-19" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb538-20"><a href="statistics.html#cb538-20" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">+</span>x3</span>
<span id="cb538-21"><a href="statistics.html#cb538-21" aria-hidden="true" tabindex="-1"></a>st_legend3 <span class="ot">&lt;-</span> <span class="st">&#39;Above This Line</span><span class="sc">\n</span><span class="st"> P_A1_E2&gt;0 Restriction&#39;</span></span>
<span id="cb538-22"><a href="statistics.html#cb538-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 4</span></span>
<span id="cb538-23"><a href="statistics.html#cb538-23" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb538-24"><a href="statistics.html#cb538-24" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">-</span>x4</span>
<span id="cb538-25"><a href="statistics.html#cb538-25" aria-hidden="true" tabindex="-1"></a>st_legend4 <span class="ot">&lt;-</span> <span class="st">&#39;Above This Line</span><span class="sc">\n</span><span class="st"> P_A1_E2&gt;0 Restriction&#39;</span></span>
<span id="cb538-26"><a href="statistics.html#cb538-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-27"><a href="statistics.html#cb538-27" aria-hidden="true" tabindex="-1"></a><span class="co"># line lty</span></span>
<span id="cb538-28"><a href="statistics.html#cb538-28" aria-hidden="true" tabindex="-1"></a>st_line_1_lty <span class="ot">&lt;-</span> <span class="st">&#39;solid&#39;</span></span>
<span id="cb538-29"><a href="statistics.html#cb538-29" aria-hidden="true" tabindex="-1"></a>st_line_2_lty <span class="ot">&lt;-</span> <span class="st">&#39;dashed&#39;</span></span>
<span id="cb538-30"><a href="statistics.html#cb538-30" aria-hidden="true" tabindex="-1"></a>st_line_3_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotted&#39;</span></span>
<span id="cb538-31"><a href="statistics.html#cb538-31" aria-hidden="true" tabindex="-1"></a>st_line_4_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotdash&#39;</span></span>
<span id="cb538-32"><a href="statistics.html#cb538-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-33"><a href="statistics.html#cb538-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Share xlim and ylim</span></span>
<span id="cb538-34"><a href="statistics.html#cb538-34" aria-hidden="true" tabindex="-1"></a>ar_xlim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="fl">0.75</span>)</span>
<span id="cb538-35"><a href="statistics.html#cb538-35" aria-hidden="true" tabindex="-1"></a>ar_ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="fl">0.75</span>)</span>
<span id="cb538-36"><a href="statistics.html#cb538-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-37"><a href="statistics.html#cb538-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb538-38"><a href="statistics.html#cb538-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb538-39"><a href="statistics.html#cb538-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_1_lty,</span>
<span id="cb538-40"><a href="statistics.html#cb538-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb538-41"><a href="statistics.html#cb538-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb538-42"><a href="statistics.html#cb538-42" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb538-43"><a href="statistics.html#cb538-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_2_lty,</span>
<span id="cb538-44"><a href="statistics.html#cb538-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb538-45"><a href="statistics.html#cb538-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb538-46"><a href="statistics.html#cb538-46" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb538-47"><a href="statistics.html#cb538-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x3, y3, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_3_lty,</span>
<span id="cb538-48"><a href="statistics.html#cb538-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb538-49"><a href="statistics.html#cb538-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb538-50"><a href="statistics.html#cb538-50" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb538-51"><a href="statistics.html#cb538-51" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x4, y4, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> st_line_4_lty,</span>
<span id="cb538-52"><a href="statistics.html#cb538-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb538-53"><a href="statistics.html#cb538-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb538-54"><a href="statistics.html#cb538-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-55"><a href="statistics.html#cb538-55" aria-hidden="true" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb538-56"><a href="statistics.html#cb538-56" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb538-57"><a href="statistics.html#cb538-57" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_small <span class="ot">=</span> <span class="fl">0.75</span></span>
<span id="cb538-58"><a href="statistics.html#cb538-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-59"><a href="statistics.html#cb538-59" aria-hidden="true" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb538-60"><a href="statistics.html#cb538-60" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb538-61"><a href="statistics.html#cb538-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.lab=</span>fl_ces_fig_reg,</span>
<span id="cb538-62"><a href="statistics.html#cb538-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.main=</span>fl_ces_fig_reg,</span>
<span id="cb538-63"><a href="statistics.html#cb538-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.sub=</span>fl_ces_fig_small)</span>
<span id="cb538-64"><a href="statistics.html#cb538-64" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb538-65"><a href="statistics.html#cb538-65" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb538-66"><a href="statistics.html#cb538-66" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb538-67"><a href="statistics.html#cb538-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-68"><a href="statistics.html#cb538-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb538-69"><a href="statistics.html#cb538-69" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb538-70"><a href="statistics.html#cb538-70" aria-hidden="true" tabindex="-1"></a>       <span class="at">inset=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="dv">0</span>),</span>
<span id="cb538-71"><a href="statistics.html#cb538-71" aria-hidden="true" tabindex="-1"></a>       <span class="at">xpd=</span><span class="cn">TRUE</span>,</span>
<span id="cb538-72"><a href="statistics.html#cb538-72" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(st_legend1, st_legend2, st_legend3, st_legend4),</span>
<span id="cb538-73"><a href="statistics.html#cb538-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb538-74"><a href="statistics.html#cb538-74" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(st_line_1_lty, st_line_2_lty, st_line_3_lty, st_line_4_lty),</span>
<span id="cb538-75"><a href="statistics.html#cb538-75" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Legends&#39;</span>,</span>
<span id="cb538-76"><a href="statistics.html#cb538-76" aria-hidden="true" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-276-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Programmatically, With different random values, we have:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="statistics.html#cb539-1" aria-hidden="true" tabindex="-1"></a>it_warning <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb539-2"><a href="statistics.html#cb539-2" aria-hidden="true" tabindex="-1"></a>it_neg <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb539-3"><a href="statistics.html#cb539-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_rand_seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb539-4"><a href="statistics.html#cb539-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate two marginal MASS</span></span>
<span id="cb539-5"><a href="statistics.html#cb539-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_rand_seed)</span>
<span id="cb539-6"><a href="statistics.html#cb539-6" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span>)</span>
<span id="cb539-7"><a href="statistics.html#cb539-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_E_marginal &lt;- c(0.01, 0.99)</span></span>
<span id="cb539-8"><a href="statistics.html#cb539-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_E_marginal &lt;- c(0.49, 0.51)</span></span>
<span id="cb539-9"><a href="statistics.html#cb539-9" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> ar_E_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_E_marginal)</span>
<span id="cb539-10"><a href="statistics.html#cb539-10" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span>)</span>
<span id="cb539-11"><a href="statistics.html#cb539-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_A_marginal &lt;- c(0.01, 0.99)</span></span>
<span id="cb539-12"><a href="statistics.html#cb539-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_A_marginal &lt;- c(0.01, 0.99)</span></span>
<span id="cb539-13"><a href="statistics.html#cb539-13" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> ar_A_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_A_marginal)</span>
<span id="cb539-14"><a href="statistics.html#cb539-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_E_marginal)</span></span>
<span id="cb539-15"><a href="statistics.html#cb539-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_A_marginal)</span></span>
<span id="cb539-16"><a href="statistics.html#cb539-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Differences in Marginal Points</span></span>
<span id="cb539-17"><a href="statistics.html#cb539-17" aria-hidden="true" tabindex="-1"></a>  ar_delta_E <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb539-18"><a href="statistics.html#cb539-18" aria-hidden="true" tabindex="-1"></a>  ar_delta_A <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb539-19"><a href="statistics.html#cb539-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(paste0(&#39;deltaE + deltaA:&#39;, diff(ar_E_marginal) + diff(ar_A_marginal)))</span></span>
<span id="cb539-20"><a href="statistics.html#cb539-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some cell negativity condition:</span></span>
<span id="cb539-21"><a href="statistics.html#cb539-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">diff</span>(ar_E_marginal))) <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">diff</span>(ar_A_marginal))) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb539-22"><a href="statistics.html#cb539-22" aria-hidden="true" tabindex="-1"></a>    it_warning <span class="ot">=</span> it_warning <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb539-23"><a href="statistics.html#cb539-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># warning(&#39;Outside of Diamond, Rectilinear Restriction Leads to Negative Values in Some Cells\n&#39;)</span></span>
<span id="cb539-24"><a href="statistics.html#cb539-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb539-25"><a href="statistics.html#cb539-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># What is P(A1,E1), implemetning the formula above</span></span>
<span id="cb539-26"><a href="statistics.html#cb539-26" aria-hidden="true" tabindex="-1"></a>  fl_P_A1_E1 <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">rbind</span>(ar_delta_E, ar_delta_A) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">2</span>))))<span class="sc">/</span>(<span class="dv">4</span>)</span>
<span id="cb539-27"><a href="statistics.html#cb539-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Getting the Entire P_A_E matrix</span></span>
<span id="cb539-28"><a href="statistics.html#cb539-28" aria-hidden="true" tabindex="-1"></a>  mt_P_A_E <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb539-29"><a href="statistics.html#cb539-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_E_marginal)){</span>
<span id="cb539-30"><a href="statistics.html#cb539-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_A_marginal)){</span>
<span id="cb539-31"><a href="statistics.html#cb539-31" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_P_A1_E1</span>
<span id="cb539-32"><a href="statistics.html#cb539-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb539-33"><a href="statistics.html#cb539-33" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_E[<span class="dv">1</span><span class="sc">:</span>(it_row<span class="dv">-1</span>)])</span>
<span id="cb539-34"><a href="statistics.html#cb539-34" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb539-35"><a href="statistics.html#cb539-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb539-36"><a href="statistics.html#cb539-36" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_A[<span class="dv">1</span><span class="sc">:</span>(it_col<span class="dv">-1</span>)])</span>
<span id="cb539-37"><a href="statistics.html#cb539-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb539-38"><a href="statistics.html#cb539-38" aria-hidden="true" tabindex="-1"></a>      mt_P_A_E[it_row, it_col] <span class="ot">=</span> fl_p_value</span>
<span id="cb539-39"><a href="statistics.html#cb539-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb539-40"><a href="statistics.html#cb539-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb539-41"><a href="statistics.html#cb539-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(mt_P_A_E)</span></span>
<span id="cb539-42"><a href="statistics.html#cb539-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(mt_P_A_E)</span>
<span id="cb539-43"><a href="statistics.html#cb539-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(mt_P_A_E)</span>
<span id="cb539-44"><a href="statistics.html#cb539-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(mt_P_A_E)</span>
<span id="cb539-45"><a href="statistics.html#cb539-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(mt_P_A_E[mt_P_A_E<span class="sc">&lt;</span><span class="dv">0</span>])<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb539-46"><a href="statistics.html#cb539-46" aria-hidden="true" tabindex="-1"></a>      it_neg <span class="ot">=</span> it_neg <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb539-47"><a href="statistics.html#cb539-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb539-48"><a href="statistics.html#cb539-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb539-49"><a href="statistics.html#cb539-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_warning:&#39;</span>,it_warning))</span></code></pre></div>
<pre><code>## [1] &quot;it_warning:283&quot;</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="statistics.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_neg:&#39;</span>,it_neg))</span></code></pre></div>
<pre><code>## [1] &quot;it_neg:283&quot;</code></pre>
</div>
<div id="restricted-joint-3-by-3-distribution" class="section level4" number="9.2.1.4">
<h4><span class="header-section-number">9.2.1.4</span> Restricted Joint 3 by 3 Distribution</h4>
<p>The idea can be applied to when there are three discrete random outcomes along each dimension. Find an unique 3 by 3 probability joint mass distribution from marginal distributions. Similar to the 2 by 2 case, only when marginal mass changes are within a change diamond will this method lead to positive mass at all points of the joint distribution.</p>
<p>Given this assumption:</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = P(A_1,E_2) - P(A_1,E_1) = P(A_2,E_2) - P(A_2,E_1) = P(A_3,E_2) - P(A_3,E_1)\\
\Delta^{E}_{23} = P(A_1,E_3) - P(A_1,E_2) = P(A_2,E_3) - P(A_2,E_2) = P(A_3,E_3) - P(A_3,E_2)\\
\Delta^{A}_{12} = P(A_2,E_1) - P(A_1,E_1) = P(A_2,E_2) - P(A_1,E_2) = P(A_2,E_3) - P(A_1,E_3)\\
\Delta^{A}_{23} = P(A_3,E_1) - P(A_2,E_1) = P(A_3,E_2) - P(A_2,E_2) = P(A_3,E_3) - P(A_2,E_3)\\
\end{aligned}
\]</span></p>
<p>Following the two by two example, the restriction above just means we can use the differences between the marginal distributionâ€™s discrete points to back out.</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = \frac{P(A_2) - P(A_1)}{3}\\
\Delta^{E}_{23} = \frac{P(A_3) - P(A_2)}{3}\\
\Delta^{A}_{12} = \frac{P(E_2) - P(E_1)}{3}\\
\Delta^{A}_{23} = \frac{P(E_3) - P(E_2)}{3}
\end{aligned}
\]</span></p>
<p>Given these <span class="math inline">\(\Delta\)</span> values, we can solve for <span class="math inline">\((A_1, E_1)\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
1 = 3 \cdot 3 \cdot P(A_1, E_1) + \Delta^{E}_{12}\cdot 3 \cdot (3-1) + \Delta^{E}_{23}\cdot 3 + \Delta^{A}_{12}\cdot 3 \cdot (3-1) + \Delta^{A}_{12}\cdot 3 \\
P(A_1, E_1) =
\frac{1}{9}
\left(
  1
  - \Delta^{E}_{12}\cdot 3 \cdot (3-1)
  - \Delta^{E}_{23}\cdot 3
  - \Delta^{A}_{12}\cdot 3 \cdot (3-1)
  - \Delta^{A}_{12}\cdot 3
\right)
\end{aligned}
\]</span>
In Matrix form:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1) =
\frac{1}{3\cdot 3}
\left(
1 -
\begin{aligned}
\begin{bmatrix}
1 &amp; 1 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\Delta^{E}_{12} &amp; \Delta^{E}_{23} \\
\Delta^{A}_{12} &amp; \Delta^{A}_{23} \\
\end{bmatrix}
\cdot
\begin{bmatrix}
3\cdot\left(3-1\right) \\
3
\end{bmatrix}
\end{aligned}
\right)
\end{aligned}
\]</span></p>
<p>Following the 2 by 2 case, the condition needed for positive mass at all points is:
<span class="math display">\[
\mid \Delta^{A}_{12} \mid + \mid \Delta^{A}_{23} \mid + \mid \Delta^{E}_{12} + \mid \Delta^{E}_{23} \mid \le \frac{1}{3}
\]</span></p>
<p>Implementing the formulas, we have:</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="statistics.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate two marginal MASS</span></span>
<span id="cb543-2"><a href="statistics.html#cb543-2" aria-hidden="true" tabindex="-1"></a>it_warning <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb543-3"><a href="statistics.html#cb543-3" aria-hidden="true" tabindex="-1"></a>it_neg <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb543-4"><a href="statistics.html#cb543-4" aria-hidden="true" tabindex="-1"></a>it_concur <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb543-5"><a href="statistics.html#cb543-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_rand_seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb543-6"><a href="statistics.html#cb543-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_rand_seed)</span>
<span id="cb543-7"><a href="statistics.html#cb543-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set.seed(333)</span></span>
<span id="cb543-8"><a href="statistics.html#cb543-8" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb543-9"><a href="statistics.html#cb543-9" aria-hidden="true" tabindex="-1"></a>  ar_E_marginal <span class="ot">&lt;-</span> ar_E_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_E_marginal)</span>
<span id="cb543-10"><a href="statistics.html#cb543-10" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb543-11"><a href="statistics.html#cb543-11" aria-hidden="true" tabindex="-1"></a>  ar_A_marginal <span class="ot">&lt;-</span> ar_A_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_A_marginal)</span>
<span id="cb543-12"><a href="statistics.html#cb543-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_E_marginal)</span></span>
<span id="cb543-13"><a href="statistics.html#cb543-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(ar_A_marginal)</span></span>
<span id="cb543-14"><a href="statistics.html#cb543-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Differences in Marginal Points</span></span>
<span id="cb543-15"><a href="statistics.html#cb543-15" aria-hidden="true" tabindex="-1"></a>  ar_delta_E_m <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)</span>
<span id="cb543-16"><a href="statistics.html#cb543-16" aria-hidden="true" tabindex="-1"></a>  ar_delta_A_m <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)</span>
<span id="cb543-17"><a href="statistics.html#cb543-17" aria-hidden="true" tabindex="-1"></a>  ar_delta_E <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb543-18"><a href="statistics.html#cb543-18" aria-hidden="true" tabindex="-1"></a>  ar_delta_A <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb543-19"><a href="statistics.html#cb543-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some cell negativity condition: this condition is incorrect</span></span>
<span id="cb543-20"><a href="statistics.html#cb543-20" aria-hidden="true" tabindex="-1"></a>  bl_count_warn <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb543-21"><a href="statistics.html#cb543-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_delta_E)){</span>
<span id="cb543-22"><a href="statistics.html#cb543-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_delta_A)){</span>
<span id="cb543-23"><a href="statistics.html#cb543-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ((<span class="fu">abs</span>(<span class="fu">sum</span>(ar_delta_E_m[<span class="dv">1</span><span class="sc">:</span>it_row])) <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">sum</span>(ar_delta_A_m[<span class="dv">1</span><span class="sc">:</span>it_col]))) <span class="sc">&gt;</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>) {</span>
<span id="cb543-24"><a href="statistics.html#cb543-24" aria-hidden="true" tabindex="-1"></a>        bl_count_warn <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb543-25"><a href="statistics.html#cb543-25" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb543-26"><a href="statistics.html#cb543-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ((<span class="fu">abs</span>(ar_delta_E_m[it_row]) <span class="sc">+</span> <span class="fu">abs</span>(ar_delta_A_m[it_col])) <span class="sc">&gt;</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>) {</span>
<span id="cb543-27"><a href="statistics.html#cb543-27" aria-hidden="true" tabindex="-1"></a>        bl_count_warn <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb543-28"><a href="statistics.html#cb543-28" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb543-29"><a href="statistics.html#cb543-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb543-30"><a href="statistics.html#cb543-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb543-31"><a href="statistics.html#cb543-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_count_warn) {</span>
<span id="cb543-32"><a href="statistics.html#cb543-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if (max(abs(diff(ar_E_marginal))) + max(abs(diff(ar_A_marginal))) &gt; 2/3){</span></span>
<span id="cb543-33"><a href="statistics.html#cb543-33" aria-hidden="true" tabindex="-1"></a>    it_warning <span class="ot">=</span> it_warning <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb543-34"><a href="statistics.html#cb543-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb543-35"><a href="statistics.html#cb543-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># warning(&#39;Outside of Diamond, Rectilinear Restriction Leads to Negative Values in Some Cells\n&#39;)</span></span>
<span id="cb543-36"><a href="statistics.html#cb543-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb543-37"><a href="statistics.html#cb543-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># What is P(A1,E1), implemetning the formula above</span></span>
<span id="cb543-38"><a href="statistics.html#cb543-38" aria-hidden="true" tabindex="-1"></a>  fl_P_A1_E1 <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">rbind</span>(ar_delta_E, ar_delta_A) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>, <span class="dv">3</span>))))<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb543-39"><a href="statistics.html#cb543-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Getting the Entire P_A_E matrix</span></span>
<span id="cb543-40"><a href="statistics.html#cb543-40" aria-hidden="true" tabindex="-1"></a>  mt_P_A_E <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb543-41"><a href="statistics.html#cb543-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_E_marginal)){</span>
<span id="cb543-42"><a href="statistics.html#cb543-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_A_marginal)){</span>
<span id="cb543-43"><a href="statistics.html#cb543-43" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_P_A1_E1</span>
<span id="cb543-44"><a href="statistics.html#cb543-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb543-45"><a href="statistics.html#cb543-45" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_E[<span class="dv">1</span><span class="sc">:</span>(it_row<span class="dv">-1</span>)])</span>
<span id="cb543-46"><a href="statistics.html#cb543-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb543-47"><a href="statistics.html#cb543-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb543-48"><a href="statistics.html#cb543-48" aria-hidden="true" tabindex="-1"></a>        fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_A[<span class="dv">1</span><span class="sc">:</span>(it_col<span class="dv">-1</span>)])</span>
<span id="cb543-49"><a href="statistics.html#cb543-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb543-50"><a href="statistics.html#cb543-50" aria-hidden="true" tabindex="-1"></a>      mt_P_A_E[it_row, it_col] <span class="ot">=</span> fl_p_value</span>
<span id="cb543-51"><a href="statistics.html#cb543-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb543-52"><a href="statistics.html#cb543-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb543-53"><a href="statistics.html#cb543-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(mt_P_A_E)</span></span>
<span id="cb543-54"><a href="statistics.html#cb543-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(mt_P_A_E)</span>
<span id="cb543-55"><a href="statistics.html#cb543-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(mt_P_A_E)</span>
<span id="cb543-56"><a href="statistics.html#cb543-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(mt_P_A_E)</span>
<span id="cb543-57"><a href="statistics.html#cb543-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(mt_P_A_E[mt_P_A_E<span class="sc">&lt;</span><span class="dv">0</span>])<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb543-58"><a href="statistics.html#cb543-58" aria-hidden="true" tabindex="-1"></a>      it_neg <span class="ot">=</span> it_neg <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb543-59"><a href="statistics.html#cb543-59" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (bl_count_warn) {</span>
<span id="cb543-60"><a href="statistics.html#cb543-60" aria-hidden="true" tabindex="-1"></a>        it_concur <span class="ot">=</span> it_concur <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb543-61"><a href="statistics.html#cb543-61" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb543-62"><a href="statistics.html#cb543-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb543-63"><a href="statistics.html#cb543-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb543-64"><a href="statistics.html#cb543-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_warning:&#39;</span>,it_warning))</span></code></pre></div>
<pre><code>## [1] &quot;it_warning:797&quot;</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="statistics.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_neg:&#39;</span>,it_neg))</span></code></pre></div>
<pre><code>## [1] &quot;it_neg:592&quot;</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="statistics.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_concur:&#39;</span>,it_concur))</span></code></pre></div>
<pre><code>## [1] &quot;it_concur:592&quot;</code></pre>
</div>
<div id="restricted-joint-5-by-5-distribution" class="section level4" number="9.2.1.5">
<h4><span class="header-section-number">9.2.1.5</span> Restricted Joint 5 by 5 Distribution</h4>
<p>For a Five by Five Problem, we have:</p>
<p>In Matrix form:</p>
<p><span class="math display">\[
\begin{aligned}
P(A_1, E_1) =
\frac{1}{5\cdot 5}
\left(
1 -
\begin{aligned}
\begin{bmatrix}
1 &amp; 1 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\Delta^{E}_{12} &amp; \Delta^{E}_{23} &amp; \Delta^{E}_{34} &amp; \Delta^{E}_{45} \\
\Delta^{A}_{45} &amp; \Delta^{A}_{45} &amp; \Delta^{A}_{45} &amp; \Delta^{A}_{45} \\
\end{bmatrix}
\cdot
\begin{bmatrix}
5\cdot4 \\
5\cdot3 \\
5\cdot2 \\
5\cdot1 \\
\end{bmatrix}
\end{aligned}
\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="statistics.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pi_j=[0.22;0.175;0.16;0.165;0.22]; % Probability of unemployment in 2020 by age groups from Cajner et al. (2020, NBER)</span></span>
<span id="cb549-2"><a href="statistics.html#cb549-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pi_w=[0.360;0.22;0.17;0.14;0.09]; % Probability of unemployment in 2020 by wage quintiles from Cajner et al. (2020, NBER)</span></span>
<span id="cb549-3"><a href="statistics.html#cb549-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate two marginal MASS</span></span>
<span id="cb549-4"><a href="statistics.html#cb549-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb549-5"><a href="statistics.html#cb549-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(333)</span></span>
<span id="cb549-6"><a href="statistics.html#cb549-6" aria-hidden="true" tabindex="-1"></a>ar_E_marginal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.22</span>, <span class="fl">0.175</span>, <span class="fl">0.16</span>, <span class="fl">0.165</span>, <span class="fl">0.22</span>)</span>
<span id="cb549-7"><a href="statistics.html#cb549-7" aria-hidden="true" tabindex="-1"></a>ar_E_marginal <span class="ot">&lt;-</span> ar_E_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_E_marginal)</span>
<span id="cb549-8"><a href="statistics.html#cb549-8" aria-hidden="true" tabindex="-1"></a>ar_A_marginal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.360</span>, <span class="fl">0.22</span>, <span class="fl">0.17</span>, <span class="fl">0.14</span>, <span class="fl">0.09</span>)</span>
<span id="cb549-9"><a href="statistics.html#cb549-9" aria-hidden="true" tabindex="-1"></a>ar_A_marginal <span class="ot">&lt;-</span> ar_A_marginal<span class="sc">/</span><span class="fu">sum</span>(ar_A_marginal)</span>
<span id="cb549-10"><a href="statistics.html#cb549-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ar_E_marginal)</span></code></pre></div>
<pre><code>## [1] 0.2340426 0.1861702 0.1702128 0.1755319 0.2340426</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="statistics.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ar_A_marginal)</span></code></pre></div>
<pre><code>## [1] 0.36734694 0.22448980 0.17346939 0.14285714 0.09183673</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="statistics.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Differences in Marginal Points</span></span>
<span id="cb553-2"><a href="statistics.html#cb553-2" aria-hidden="true" tabindex="-1"></a>ar_delta_E <span class="ot">=</span> <span class="fu">diff</span>(ar_E_marginal)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb553-3"><a href="statistics.html#cb553-3" aria-hidden="true" tabindex="-1"></a>ar_delta_A <span class="ot">=</span> <span class="fu">diff</span>(ar_A_marginal)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb553-4"><a href="statistics.html#cb553-4" aria-hidden="true" tabindex="-1"></a><span class="co"># What is P(A1,E1), implemetning the formula above</span></span>
<span id="cb553-5"><a href="statistics.html#cb553-5" aria-hidden="true" tabindex="-1"></a>fl_P_A1_E1 <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">rbind</span>(ar_delta_E, ar_delta_A) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">15</span>,<span class="dv">10</span>,<span class="dv">5</span>))))<span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">5</span>)</span>
<span id="cb553-6"><a href="statistics.html#cb553-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the Entire P_A_E matrix</span></span>
<span id="cb553-7"><a href="statistics.html#cb553-7" aria-hidden="true" tabindex="-1"></a>mt_P_A_E <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">5</span>)</span>
<span id="cb553-8"><a href="statistics.html#cb553-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_E_marginal)){</span>
<span id="cb553-9"><a href="statistics.html#cb553-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ar_A_marginal)){</span>
<span id="cb553-10"><a href="statistics.html#cb553-10" aria-hidden="true" tabindex="-1"></a>    fl_p_value <span class="ot">=</span> fl_P_A1_E1</span>
<span id="cb553-11"><a href="statistics.html#cb553-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (it_row <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb553-12"><a href="statistics.html#cb553-12" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_E[<span class="dv">1</span><span class="sc">:</span>(it_row<span class="dv">-1</span>)])</span>
<span id="cb553-13"><a href="statistics.html#cb553-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb553-14"><a href="statistics.html#cb553-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (it_col <span class="sc">&gt;=</span> <span class="dv">2</span>){</span>
<span id="cb553-15"><a href="statistics.html#cb553-15" aria-hidden="true" tabindex="-1"></a>      fl_p_value <span class="ot">=</span> fl_p_value <span class="sc">+</span> <span class="fu">sum</span>(ar_delta_A[<span class="dv">1</span><span class="sc">:</span>(it_col<span class="dv">-1</span>)])</span>
<span id="cb553-16"><a href="statistics.html#cb553-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb553-17"><a href="statistics.html#cb553-17" aria-hidden="true" tabindex="-1"></a>    mt_P_A_E[it_row, it_col] <span class="ot">=</span> fl_p_value</span>
<span id="cb553-18"><a href="statistics.html#cb553-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb553-19"><a href="statistics.html#cb553-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb553-20"><a href="statistics.html#cb553-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] 0.08027790 0.05170647 0.04150239 0.03537994 0.02517586
## [2,] 0.07070343 0.04213200 0.03192792 0.02580547 0.01560139
## [3,] 0.06751194 0.03894051 0.02873643 0.02261398 0.01240990
## [4,] 0.06857577 0.04000434 0.02980026 0.02367781 0.01347373
## [5,] 0.08027790 0.05170647 0.04150239 0.03537994 0.02517586</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="statistics.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="statistics.html#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>## [1] 0.2340426 0.1861702 0.1702128 0.1755319 0.2340426</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="statistics.html#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(mt_P_A_E)</span></code></pre></div>
<pre><code>## [1] 0.36734694 0.22448980 0.17346939 0.14285714 0.09183673</code></pre>

</div>
</div>
<div id="obtaining-joint-distribution-from-conditional-with-rectilinear-restrictions" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Obtaining Joint Distribution from Conditional with Rectilinear Restrictions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="by-2-joint-from-marginal-probability-mass-functions" class="section level4" number="9.2.2.1">
<h4><span class="header-section-number">9.2.2.1</span> 2 by 2 Joint from Marginal Probability Mass Functions</h4>
<p>We know the <span class="math inline">\(P(U|E)\)</span>, the probability of unemployment by educational types. I also know <span class="math inline">\(P(U|A)\)</span>, the probability of unemployment by age groups. Additionally, I also know the <span class="math inline">\(P(E,A)\)</span>, the mass of individuals at discrete <span class="math inline">\((E,A)\)</span> combinations. What is the <span class="math inline">\(P(U|E,A)\)</span>, the probability of unemployment by age and education groups?</p>
<div id="generate-data-structure" class="section level5" number="9.2.2.1.1">
<h5><span class="header-section-number">9.2.2.1.1</span> Generate Data Structure</h5>
<p>Generate the data structure. First, a function that generates random joint probabilities of mass at different points. This data-structure will work for 2 by 2, 3 by 3, or 4 by 4 problems.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="statistics.html#cb561-1" aria-hidden="true" tabindex="-1"></a>ffi_gen_rand_joint_mass <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">it_seed =</span> <span class="dv">123</span>,</span>
<span id="cb561-2"><a href="statistics.html#cb561-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>,</span>
<span id="cb561-3"><a href="statistics.html#cb561-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb561-4"><a href="statistics.html#cb561-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-5"><a href="statistics.html#cb561-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set random seed</span></span>
<span id="cb561-6"><a href="statistics.html#cb561-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_seed)</span>
<span id="cb561-7"><a href="statistics.html#cb561-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-8"><a href="statistics.html#cb561-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate prob list</span></span>
<span id="cb561-9"><a href="statistics.html#cb561-9" aria-hidden="true" tabindex="-1"></a>  ls_2d <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> it_Q<span class="sc">*</span>it_M)</span>
<span id="cb561-10"><a href="statistics.html#cb561-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(ls_2d) <span class="ot">&lt;-</span> <span class="fu">c</span>(it_Q, it_M)</span>
<span id="cb561-11"><a href="statistics.html#cb561-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-12"><a href="statistics.html#cb561-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Random joint mass</span></span>
<span id="cb561-13"><a href="statistics.html#cb561-13" aria-hidden="true" tabindex="-1"></a>  ar_rand <span class="ot">&lt;-</span> <span class="fu">runif</span>(it_Q<span class="sc">*</span>it_M)</span>
<span id="cb561-14"><a href="statistics.html#cb561-14" aria-hidden="true" tabindex="-1"></a>  ar_rand <span class="ot">&lt;-</span> ar_rand<span class="sc">/</span><span class="fu">sum</span>(ar_rand)</span>
<span id="cb561-15"><a href="statistics.html#cb561-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-16"><a href="statistics.html#cb561-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill with values</span></span>
<span id="cb561-17"><a href="statistics.html#cb561-17" aria-hidden="true" tabindex="-1"></a>  it_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb561-18"><a href="statistics.html#cb561-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_Q_ctr <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,it_Q)) {</span>
<span id="cb561-19"><a href="statistics.html#cb561-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_M_ctr <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,it_M)) {</span>
<span id="cb561-20"><a href="statistics.html#cb561-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># linear index</span></span>
<span id="cb561-21"><a href="statistics.html#cb561-21" aria-hidden="true" tabindex="-1"></a>      ls_2d[[it_M_ctr, it_Q_ctr]] <span class="ot">&lt;-</span> ar_rand[(it_Q_ctr<span class="dv">-1</span>)<span class="sc">*</span>it_M<span class="sc">+</span>it_M_ctr]</span>
<span id="cb561-22"><a href="statistics.html#cb561-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb561-23"><a href="statistics.html#cb561-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb561-24"><a href="statistics.html#cb561-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-25"><a href="statistics.html#cb561-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace row names, note rownames does not work</span></span>
<span id="cb561-26"><a href="statistics.html#cb561-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dimnames</span>(ls_2d)[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;E&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span>,it_M))</span>
<span id="cb561-27"><a href="statistics.html#cb561-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dimnames</span>(ls_2d)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;A&#39;</span>,<span class="fu">seq</span>(<span class="dv">1</span>,it_Q))</span>
<span id="cb561-28"><a href="statistics.html#cb561-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-29"><a href="statistics.html#cb561-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename</span></span>
<span id="cb561-30"><a href="statistics.html#cb561-30" aria-hidden="true" tabindex="-1"></a>  ls_prob_joint_E_A <span class="ot">&lt;-</span> ls_2d</span>
<span id="cb561-31"><a href="statistics.html#cb561-31" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(ls_prob_joint_E_A), <span class="at">ncol=</span>it_M, <span class="at">byrow=</span>F)</span>
<span id="cb561-32"><a href="statistics.html#cb561-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-33"><a href="statistics.html#cb561-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb561-34"><a href="statistics.html#cb561-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;ls_prob_joint_E_A&#39;</span>)</span>
<span id="cb561-35"><a href="statistics.html#cb561-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ls_prob_joint_E_A)</span>
<span id="cb561-36"><a href="statistics.html#cb561-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(mt_prob_joint_E_A)</span>
<span id="cb561-37"><a href="statistics.html#cb561-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb561-38"><a href="statistics.html#cb561-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-39"><a href="statistics.html#cb561-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb561-40"><a href="statistics.html#cb561-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mt_prob_joint_E_A=</span>mt_prob_joint_E_A,</span>
<span id="cb561-41"><a href="statistics.html#cb561-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">ls_prob_joint_E_A=</span>ls_prob_joint_E_A))</span>
<span id="cb561-42"><a href="statistics.html#cb561-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Second, given joint mass at different points, generate conditional unemployment probabilities along each discrete variableâ€™s values that works for 2 by 2 case. We have two unique levels for E and for A separately, so these are four points where there is mass. Generate random mass at these points. Then generate given these four additional mass points: <span class="math inline">\(F=P(A_1|E_1)\)</span>, <span class="math inline">\(B=P(A_1|E_2)\)</span>, <span class="math inline">\(C=P(E_1|A_1)\)</span>, <span class="math inline">\(D=P(E_1|A_2)\)</span>. Use code from <a href="https://fanwangecon.github.io/R4Econ/amto/list/htmlpdfr/fs_lst_basics.html#16_Define_Two_Dimensional_Named_LIst">fs_lst_basics</a>.</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="statistics.html#cb562-1" aria-hidden="true" tabindex="-1"></a>ffi_gen_condi_unemploy_prob_2by2 <span class="ot">&lt;-</span> <span class="cf">function</span>(mt_prob_joint_E_A,</span>
<span id="cb562-2"><a href="statistics.html#cb562-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fl_alpha =</span> <span class="fl">0.25</span>, <span class="at">fl_beta =</span> <span class="fl">0.05</span>,</span>
<span id="cb562-3"><a href="statistics.html#cb562-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fl_gamma =</span> <span class="fl">0.31</span>, <span class="at">fl_delta =</span> <span class="fl">0.50</span>,</span>
<span id="cb562-4"><a href="statistics.html#cb562-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb562-5"><a href="statistics.html#cb562-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-6"><a href="statistics.html#cb562-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># From joint probability, generate conditional probabilities</span></span>
<span id="cb562-7"><a href="statistics.html#cb562-7" aria-hidden="true" tabindex="-1"></a>  fl_F <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb562-8"><a href="statistics.html#cb562-8" aria-hidden="true" tabindex="-1"></a>  fl_B <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb562-9"><a href="statistics.html#cb562-9" aria-hidden="true" tabindex="-1"></a>  fl_C <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb562-10"><a href="statistics.html#cb562-10" aria-hidden="true" tabindex="-1"></a>  fl_D <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb562-11"><a href="statistics.html#cb562-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb562-12"><a href="statistics.html#cb562-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_F=&#39;</span>, fl_F, <span class="st">&#39;,fl_B=&#39;</span>,fl_B,<span class="st">&#39;,fl_C=&#39;</span>,fl_C,<span class="st">&#39;,fl_D=&#39;</span>,fl_D))</span>
<span id="cb562-13"><a href="statistics.html#cb562-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb562-14"><a href="statistics.html#cb562-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-15"><a href="statistics.html#cb562-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Also generate random W X Y Z</span></span>
<span id="cb562-16"><a href="statistics.html#cb562-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_b &lt;- runif(4)</span></span>
<span id="cb562-17"><a href="statistics.html#cb562-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-18"><a href="statistics.html#cb562-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_Delta_A_true &lt;- 0.05</span></span>
<span id="cb562-19"><a href="statistics.html#cb562-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_Delta_E_true &lt;- 0.11</span></span>
<span id="cb562-20"><a href="statistics.html#cb562-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-21"><a href="statistics.html#cb562-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_alpha_true &lt;- 0.25</span></span>
<span id="cb562-22"><a href="statistics.html#cb562-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_beta_true &lt;- fl_alpha_true + fl_Delta_A_true</span></span>
<span id="cb562-23"><a href="statistics.html#cb562-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_gamma_true &lt;- fl_alpha_true + fl_Delta_E_true</span></span>
<span id="cb562-24"><a href="statistics.html#cb562-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_delta_true &lt;- fl_alpha_true + fl_Delta_E_true + fl_Delta_A_true</span></span>
<span id="cb562-25"><a href="statistics.html#cb562-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-26"><a href="statistics.html#cb562-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_beta_true &lt;- 0.31</span></span>
<span id="cb562-27"><a href="statistics.html#cb562-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_gamma_true &lt;- 0.50</span></span>
<span id="cb562-28"><a href="statistics.html#cb562-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_delta_true &lt;- 0.16</span></span>
<span id="cb562-29"><a href="statistics.html#cb562-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-30"><a href="statistics.html#cb562-30" aria-hidden="true" tabindex="-1"></a>  fl_W <span class="ot">&lt;-</span> fl_alpha<span class="sc">*</span>fl_F <span class="sc">+</span> fl_beta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_F)</span>
<span id="cb562-31"><a href="statistics.html#cb562-31" aria-hidden="true" tabindex="-1"></a>  fl_X <span class="ot">&lt;-</span> fl_gamma<span class="sc">*</span>fl_B <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_B)</span>
<span id="cb562-32"><a href="statistics.html#cb562-32" aria-hidden="true" tabindex="-1"></a>  fl_Y <span class="ot">&lt;-</span> fl_alpha<span class="sc">*</span>fl_C <span class="sc">+</span> fl_gamma<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_C)</span>
<span id="cb562-33"><a href="statistics.html#cb562-33" aria-hidden="true" tabindex="-1"></a>  fl_Z <span class="ot">&lt;-</span> fl_beta<span class="sc">*</span>fl_D <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_D)</span>
<span id="cb562-34"><a href="statistics.html#cb562-34" aria-hidden="true" tabindex="-1"></a>  fl_V <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_alpha_true <span class="sc">+</span></span>
<span id="cb562-35"><a href="statistics.html#cb562-35" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_beta_true <span class="sc">+</span></span>
<span id="cb562-36"><a href="statistics.html#cb562-36" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_gamma_true <span class="sc">+</span></span>
<span id="cb562-37"><a href="statistics.html#cb562-37" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_delta_true</span>
<span id="cb562-38"><a href="statistics.html#cb562-38" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">c</span>(fl_W, fl_X, fl_Y, fl_Z)</span>
<span id="cb562-39"><a href="statistics.html#cb562-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-40"><a href="statistics.html#cb562-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb562-41"><a href="statistics.html#cb562-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;ar_b=&#39;</span>,ar_b))</span>
<span id="cb562-42"><a href="statistics.html#cb562-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_V=&#39;</span>,fl_V))</span>
<span id="cb562-43"><a href="statistics.html#cb562-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb562-44"><a href="statistics.html#cb562-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-45"><a href="statistics.html#cb562-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb562-46"><a href="statistics.html#cb562-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">F=</span>fl_F, <span class="at">B=</span>fl_B, <span class="at">C=</span>fl_C, <span class="at">D=</span>fl_D,</span>
<span id="cb562-47"><a href="statistics.html#cb562-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">W=</span>fl_W, <span class="at">X=</span>fl_X, <span class="at">Y=</span>fl_Y, <span class="at">Z=</span>fl_Z, <span class="at">V=</span>fl_V))</span>
<span id="cb562-48"><a href="statistics.html#cb562-48" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="unrestricted-joint-2-by-2-distribution-1" class="section level5" number="9.2.2.1.2">
<h5><span class="header-section-number">9.2.2.1.2</span> Unrestricted Joint 2 by 2 Distribution</h5>
<p>Suppose there are two unique states for <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span>. For example, suppose we know the unemployment probability for better or worse educated, and also for low and high age groups. We also know the proportion of people who are in each one of the four cells (regardless of unemployment or not). We also know the aggregate proportion of people in the population that is unemployed.</p>
<p>We want to know the joint probability of unemployment for the four types: both better educated and lower age, better educated and higher age, worse educated and lower age, and worse educated and higher age. Then:</p>
<p><span class="math display">\[
\begin{aligned}
P(U|E_1) &amp;= P(U|A_1, E_1) \cdot P(A_1|E_1) + P(U|A_2, E_1) \cdot P(A_2|E_1)\\
P(U|E_2) &amp;= P(U|A_1, E_2) \cdot P(A_1|E_2) + P(U|A_2, E_2) \cdot P(A_2|E_2)\\
P(U|A_1) &amp;= P(U|A_1, E_1) \cdot P(E_1|A_1) + P(U|A_1, E_2) \cdot P(E_2|A_1)\\
P(U|A_2) &amp;= P(U|A_2, E_1) \cdot P(E_1|A_2) + P(U|A_2, E_2) \cdot P(E_2|A_2)\\
\end{aligned}
\]</span></p>
<p>And, we also have the extra equation:</p>
<p><span class="math display">\[
P(U) = P(U|A_1, E_1) \cdot P(E_1, A_1) + P(U|A_2, E_1) \cdot P(E_2, A_1) + P(U|A_1, E_2) \cdot P(E_1, A_2) + P(U|A_2, E_2) \cdot P(E_2, A_2)
\]</span></p>
<p>We know <span class="math inline">\(P(A|E)\)</span>, and we know <span class="math inline">\(P(U|E)\)</span> as well as <span class="math inline">\(P(U|A)\)</span>. Let Roman letter represent what we know, and greek letters represent what we do not know, then we have four equations and four unknowns in a linear system. We use the letter F because A and E are taken.</p>
<p><span class="math display">\[
\begin{aligned}
W = \alpha F + \beta (1-F)\\
X = \gamma B + \delta (1-B)\\
Y = \alpha C + \gamma (1-C)\\
Z = \beta D + \delta (1-D)\\
\end{aligned}
\]</span></p>
<p>And we have also:</p>
<p><span class="math display">\[
V = \alpha P(E_1, A_1) + \beta P(E_2, A_1) + \gamma P(E_1, A_2) + \delta P(E_2, A_2)
\]</span></p>
<p>There are no unique solutions for the linear system. When we write the linear system above in matrix form as shown below, the <span class="math inline">\(\Omega\)</span> coefficient matrix is not full rank.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
F &amp; (1-F) &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; B &amp; (1-B) \\
C &amp; 0 &amp; (1-C) &amp; 0 \\
0 &amp; D &amp; 0 &amp; (1-D) \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\beta \\
\gamma \\
\delta
\end{bmatrix}
&amp; =
\begin{bmatrix}
W \\
X \\
Y \\
Z \\
\end{bmatrix}\\
\Omega \cdot \mathbb{X} &amp; =  b
\end{aligned}
\]</span></p>
<p>Get data from the data generation functions created prior:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="statistics.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="co"># JOint mass of population at all cells</span></span>
<span id="cb563-2"><a href="statistics.html#cb563-2" aria-hidden="true" tabindex="-1"></a>ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(<span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>, <span class="at">bl_verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ls_prob_joint_E_A&quot;
##    A1        A2       
## E1 0.1214495 0.1727188
## E2 0.3329164 0.3729152
##           [,1]      [,2]
## [1,] 0.1214495 0.1727188
## [2,] 0.3329164 0.3729152</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="statistics.html#cb565-1" aria-hidden="true" tabindex="-1"></a>mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb565-2"><a href="statistics.html#cb565-2" aria-hidden="true" tabindex="-1"></a><span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb565-3"><a href="statistics.html#cb565-3" aria-hidden="true" tabindex="-1"></a>fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb565-4"><a href="statistics.html#cb565-4" aria-hidden="true" tabindex="-1"></a>fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb565-5"><a href="statistics.html#cb565-5" aria-hidden="true" tabindex="-1"></a>fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb565-6"><a href="statistics.html#cb565-6" aria-hidden="true" tabindex="-1"></a>fl_beta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb565-7"><a href="statistics.html#cb565-7" aria-hidden="true" tabindex="-1"></a>fl_gamma_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true</span>
<span id="cb565-8"><a href="statistics.html#cb565-8" aria-hidden="true" tabindex="-1"></a>fl_delta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb565-9"><a href="statistics.html#cb565-9" aria-hidden="true" tabindex="-1"></a>ls_FBCDWXYZV <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_2by2</span>(mt_prob_joint_E_A,</span>
<span id="cb565-10"><a href="statistics.html#cb565-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fl_alpha =</span> fl_alpha_true, <span class="at">fl_beta =</span> fl_beta_true,</span>
<span id="cb565-11"><a href="statistics.html#cb565-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">fl_gamma =</span> fl_gamma_true, <span class="at">fl_delta =</span> fl_delta_true, <span class="at">bl_verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;fl_F=0.412857205138471,fl_B=0.471665472604598,fl_C=0.267294503388642,fl_D=0.316546995323062&quot;
## [1] &quot;ar_b=0.279357139743076&quot; &quot;ar_b=0.38641672636977&quot;  &quot;ar_b=0.330597604627249&quot; &quot;ar_b=0.375179830514463&quot;
## [1] &quot;fl_V=0.354923185445584&quot;</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="statistics.html#cb567-1" aria-hidden="true" tabindex="-1"></a>fl_F <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>F</span>
<span id="cb567-2"><a href="statistics.html#cb567-2" aria-hidden="true" tabindex="-1"></a>fl_B <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>B</span>
<span id="cb567-3"><a href="statistics.html#cb567-3" aria-hidden="true" tabindex="-1"></a>fl_C <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>C</span>
<span id="cb567-4"><a href="statistics.html#cb567-4" aria-hidden="true" tabindex="-1"></a>fl_D <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>D</span>
<span id="cb567-5"><a href="statistics.html#cb567-5" aria-hidden="true" tabindex="-1"></a>fl_W <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>W</span>
<span id="cb567-6"><a href="statistics.html#cb567-6" aria-hidden="true" tabindex="-1"></a>fl_X <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>X</span>
<span id="cb567-7"><a href="statistics.html#cb567-7" aria-hidden="true" tabindex="-1"></a>fl_Y <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Y</span>
<span id="cb567-8"><a href="statistics.html#cb567-8" aria-hidden="true" tabindex="-1"></a>fl_Z <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Z</span>
<span id="cb567-9"><a href="statistics.html#cb567-9" aria-hidden="true" tabindex="-1"></a>fl_V <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>V</span></code></pre></div>
<p>We can see the rank of a matrix with the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/qr.html">qr</a> function (QR decomposition), regardless of the random seed chosen above, the <span class="math inline">\(\Omega\)</span> matrix is not full ranked.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="statistics.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="co"># does not matter if joint sum is used or the alternative</span></span>
<span id="cb568-2"><a href="statistics.html#cb568-2" aria-hidden="true" tabindex="-1"></a>bl_use_joint_sum <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb568-3"><a href="statistics.html#cb568-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (bl_use_joint_sum) {</span>
<span id="cb568-4"><a href="statistics.html#cb568-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb568-5"><a href="statistics.html#cb568-5" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA <span class="ot">=</span> <span class="fu">t</span>(</span>
<span id="cb568-6"><a href="statistics.html#cb568-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(fl_F, <span class="dv">1</span><span class="sc">-</span>fl_F, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb568-7"><a href="statistics.html#cb568-7" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">0</span>, <span class="dv">0</span>, fl_B, <span class="dv">1</span><span class="sc">-</span>fl_B,</span>
<span id="cb568-8"><a href="statistics.html#cb568-8" aria-hidden="true" tabindex="-1"></a>                  fl_C, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_C, <span class="dv">0</span>,</span>
<span id="cb568-9"><a href="statistics.html#cb568-9" aria-hidden="true" tabindex="-1"></a>                  mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>],  mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb568-10"><a href="statistics.html#cb568-10" aria-hidden="true" tabindex="-1"></a>                  mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>],  mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]), <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb568-11"><a href="statistics.html#cb568-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb568-12"><a href="statistics.html#cb568-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb568-13"><a href="statistics.html#cb568-13" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">c</span>(fl_F, <span class="dv">1</span><span class="sc">-</span>fl_F, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb568-14"><a href="statistics.html#cb568-14" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">0</span>, <span class="dv">0</span>, fl_B, <span class="dv">1</span><span class="sc">-</span>fl_B,</span>
<span id="cb568-15"><a href="statistics.html#cb568-15" aria-hidden="true" tabindex="-1"></a>                             fl_C, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_C, <span class="dv">0</span>,</span>
<span id="cb568-16"><a href="statistics.html#cb568-16" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">0</span>, fl_D, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_D), <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb568-17"><a href="statistics.html#cb568-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-18"><a href="statistics.html#cb568-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb568-19"><a href="statistics.html#cb568-19" aria-hidden="true" tabindex="-1"></a><span class="co"># rank Check with the qr function:</span></span>
<span id="cb568-20"><a href="statistics.html#cb568-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">qr</span>(mt_OMEGA))</span></code></pre></div>
<pre><code>## $qr
##            [,1]       [,2]       [,3]          [,4]
## [1,] -0.4918307 -0.4928650 -0.3982024  0.000000e+00
## [2,]  0.0000000 -0.4494694  0.4366482 -4.813342e-01
## [3,]  0.5434685 -0.7099340 -0.6403896 -7.173303e-01
## [4,]  0.0000000  0.7042682 -0.0385102 -2.081668e-17
## 
## $rank
## [1] 3
## 
## $qraux
## [1] 1.839430e+00 1.000000e+00 1.999258e+00 2.081668e-17
## 
## $pivot
## [1] 1 2 3 4
## 
## attr(,&quot;class&quot;)
## [1] &quot;qr&quot;</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="statistics.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rank Check with the qr function:</span></span></code></pre></div>
<p>We cannot solve the linear equations using <em>solve</em> because this is NOT full rank.</p>
</div>
<div id="rectilinear-restriction-on-joint-2-by-2-distribution-1" class="section level5" number="9.2.2.1.3">
<h5><span class="header-section-number">9.2.2.1.3</span> Rectilinear Restriction on Joint 2 by 2 Distribution</h5>
<p>So in the section above, it is demonstrated that it is not possible to uniquely identify the joint probability mass function from marginal probability mass functions.</p>
<p>However, sometimes, we need to find some reasonable joint distribution, when we only observe marginal distributions. This joint distribution might be an input transition matrix in a model we simulate. If we just use one of the infinitely possible joint mass that match up with the marginals, then the model would have infinitely many simulation results depending on our arbitrary choice of joint mass.</p>
<p>Ideally, one should try to obtain data to estimate the underlying joint distribution, when this is not possible, we can impose additional non-parametric restrictions on the structures of the joint probability mass that would lead to unique joint mass from marginals.</p>
<p>Specifically, we will assume the incremental changes across rows and across columns of the joint mass matrix are row or column specific, is this sufficient? (In Some Cases it Will Not be):</p>
<p><span class="math display">\[
\begin{aligned}
\Delta^{E}_{12} = P(A_1,E_2) - P(A_1,E_1) = \gamma - \alpha = P(A_2,E_2) - P(A_2,E_1) = \delta - \beta \\
\Delta^{A}_{12} = P(A_2,E_1) - P(A_1,E_1) = \beta -  \alpha = P(A_2,E_2) - P(A_1,E_2) = \delta - \gamma \\
\end{aligned}
\]</span>
The assumption is non-parametric. This is effectively an rectilinear assumption on the joint Cumulative Probability Mass Function. The assumption means that if we know <span class="math inline">\(\Delta^E_{12}\)</span> and <span class="math inline">\(\Delta^{A}_{12}\)</span> and say <span class="math inline">\(\alpha\)</span>, we have:</p>
<p><span class="math display">\[
\beta = \alpha + \Delta^A_{12}\\
\gamma = \alpha + \Delta^E_{12}\\
\delta = \gamma\left(\alpha, \Delta^E_{12}\right) + \Delta^A_{12}\\
\]</span>
Alernatively, we can also say that if we know <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>, then we know <span class="math inline">\(\delta\)</span>:</p>
<p><span class="math display">\[
\Delta^A_{12} = \beta - \alpha\\
\delta = \gamma + \Delta^A_{12} = \gamma + \beta - \alpha\\
\]</span></p>
</div>
<div id="by-2-problem-with-rectlinear-restrictions" class="section level5" number="9.2.2.1.4">
<h5><span class="header-section-number">9.2.2.1.4</span> 2 by 2 Problem with Rectlinear Restrictions</h5>
<p>We have these three equations, where <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\Delta^A\)</span> and <span class="math inline">\(\Delta^E\)</span> are not known:</p>
<p><span class="math display">\[
\begin{aligned}
W &amp;= \alpha F + \alpha(1-F) + \Delta^{A} (1-F)\\
X &amp;= \alpha B + \Delta^{E} B + \alpha (1-B) + \Delta^{A} (1-B) + \Delta^{E} (1-B)\\
Y &amp;= \alpha C + \alpha(1-C)+\Delta^{E}(1-C)
\end{aligned}
\]</span>
Rewriting a little bit, we have the following linear system:</p>
<p><span class="math display">\[
\begin{aligned}
W &amp;= \alpha + \Delta^{A} (1-F)\\
X &amp;= \alpha + \Delta^{A} (1-B) + \Delta^{E}\\
Y &amp;= \alpha + \Delta^{E}(1-C)\\
V &amp;=
\alpha
+
\Delta^A \left(
P(E_2, A_1) + P(E_2, A_2)
\right)
+
\Delta^E \left(
P(E_1, A_2) + P(E_2, A_2)
\right)
\end{aligned}
\]</span>
Using the First three equations, we have:
<span class="math display">\[
\begin{aligned}
\begin{bmatrix}
1 &amp; (1-F) &amp; 0 \\
1 &amp; (1-B) &amp; 1 \\
1 &amp; 0 &amp; (1-C) \\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\Delta^{A} \\
\Delta^{E}
\end{bmatrix}
&amp; =
\begin{bmatrix}
W \\
X \\
Y \\
\end{bmatrix}\\
\end{aligned}
\]</span>
<span class="math display">\[
\widehat{\Omega} \cdot \widehat{\mathbb{X}} = \widehat{b}
\]</span></p>
</div>
<div id="solution-program-for-2-by-2-problem-with-rectlinear-restrictions" class="section level5" number="9.2.2.1.5">
<h5><span class="header-section-number">9.2.2.1.5</span> Solution Program for 2 by 2 Problem with Rectlinear Restrictions</h5>
<p>Using the same <span class="math inline">\(F\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> values obtained from prior, we have now a full ranked 3 by 3 matrix:</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="statistics.html#cb571-1" aria-hidden="true" tabindex="-1"></a>ffi_solve_2by2_rectilinear <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_F, fl_B, fl_C,</span>
<span id="cb571-2"><a href="statistics.html#cb571-2" aria-hidden="true" tabindex="-1"></a>                                       fl_W, fl_X, fl_Y,</span>
<span id="cb571-3"><a href="statistics.html#cb571-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">bl_verbose=</span><span class="cn">FALSE</span>) {</span>
<span id="cb571-4"><a href="statistics.html#cb571-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-5"><a href="statistics.html#cb571-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb571-6"><a href="statistics.html#cb571-6" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA_hat <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(</span>
<span id="cb571-7"><a href="statistics.html#cb571-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">-</span>fl_F, <span class="dv">0</span>,</span>
<span id="cb571-8"><a href="statistics.html#cb571-8" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">1</span><span class="sc">-</span>fl_B, <span class="dv">1</span>,</span>
<span id="cb571-9"><a href="statistics.html#cb571-9" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>fl_C), <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb571-10"><a href="statistics.html#cb571-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-11"><a href="statistics.html#cb571-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rank Check with the qr function:</span></span>
<span id="cb571-12"><a href="statistics.html#cb571-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb571-13"><a href="statistics.html#cb571-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">qr</span>(mt_OMEGA_hat))</span>
<span id="cb571-14"><a href="statistics.html#cb571-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb571-15"><a href="statistics.html#cb571-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-16"><a href="statistics.html#cb571-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bhat</span></span>
<span id="cb571-17"><a href="statistics.html#cb571-17" aria-hidden="true" tabindex="-1"></a>  ar_b_hat <span class="ot">&lt;-</span> <span class="fu">c</span>(fl_W, fl_X, fl_Y)</span>
<span id="cb571-18"><a href="statistics.html#cb571-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-19"><a href="statistics.html#cb571-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve</span></span>
<span id="cb571-20"><a href="statistics.html#cb571-20" aria-hidden="true" tabindex="-1"></a>  ar_solution <span class="ot">&lt;-</span> <span class="fu">solve</span>(mt_OMEGA_hat, ar_b_hat)</span>
<span id="cb571-21"><a href="statistics.html#cb571-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-22"><a href="statistics.html#cb571-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get alpha and Delta from solution</span></span>
<span id="cb571-23"><a href="statistics.html#cb571-23" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ar_solution[<span class="dv">1</span>]</span>
<span id="cb571-24"><a href="statistics.html#cb571-24" aria-hidden="true" tabindex="-1"></a>  fl_Delta_A <span class="ot">&lt;-</span> ar_solution[<span class="dv">2</span>]</span>
<span id="cb571-25"><a href="statistics.html#cb571-25" aria-hidden="true" tabindex="-1"></a>  fl_Delta_E <span class="ot">&lt;-</span> ar_solution[<span class="dv">3</span>]</span>
<span id="cb571-26"><a href="statistics.html#cb571-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb571-27"><a href="statistics.html#cb571-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_A=&#39;</span>,fl_Delta_A))</span>
<span id="cb571-28"><a href="statistics.html#cb571-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_E=&#39;</span>,fl_Delta_E))</span>
<span id="cb571-29"><a href="statistics.html#cb571-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb571-30"><a href="statistics.html#cb571-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-31"><a href="statistics.html#cb571-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get beta gamma , delta</span></span>
<span id="cb571-32"><a href="statistics.html#cb571-32" aria-hidden="true" tabindex="-1"></a>  fl_beta <span class="ot">&lt;-</span> fl_alpha <span class="sc">+</span> fl_Delta_A</span>
<span id="cb571-33"><a href="statistics.html#cb571-33" aria-hidden="true" tabindex="-1"></a>  fl_gamma <span class="ot">&lt;-</span> fl_alpha <span class="sc">+</span> fl_Delta_E</span>
<span id="cb571-34"><a href="statistics.html#cb571-34" aria-hidden="true" tabindex="-1"></a>  fl_delta <span class="ot">&lt;-</span> fl_gamma <span class="sc">+</span> fl_Delta_A</span>
<span id="cb571-35"><a href="statistics.html#cb571-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb571-36"><a href="statistics.html#cb571-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_alpha=&#39;</span>,fl_alpha))</span>
<span id="cb571-37"><a href="statistics.html#cb571-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_beta=&#39;</span>,fl_beta))</span>
<span id="cb571-38"><a href="statistics.html#cb571-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gamma=&#39;</span>,fl_gamma))</span>
<span id="cb571-39"><a href="statistics.html#cb571-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_delta=&#39;</span>,fl_delta))</span>
<span id="cb571-40"><a href="statistics.html#cb571-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">1</span>] <span class="sc">-</span> (fl_alpha<span class="sc">*</span>fl_F <span class="sc">+</span> fl_beta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_F))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb571-41"><a href="statistics.html#cb571-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;W matched&#39;</span>)</span>
<span id="cb571-42"><a href="statistics.html#cb571-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb571-43"><a href="statistics.html#cb571-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">2</span>] <span class="sc">-</span> (fl_gamma<span class="sc">*</span>fl_B <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_B))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb571-44"><a href="statistics.html#cb571-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;X matched&#39;</span>)</span>
<span id="cb571-45"><a href="statistics.html#cb571-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb571-46"><a href="statistics.html#cb571-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">3</span>] <span class="sc">-</span> (fl_alpha<span class="sc">*</span>fl_C <span class="sc">+</span> fl_gamma<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_C))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb571-47"><a href="statistics.html#cb571-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;Y matched&#39;</span>)</span>
<span id="cb571-48"><a href="statistics.html#cb571-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb571-49"><a href="statistics.html#cb571-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(ar_b[<span class="dv">4</span>] <span class="sc">-</span> (fl_beta<span class="sc">*</span>fl_D <span class="sc">+</span> fl_delta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_D))) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb571-50"><a href="statistics.html#cb571-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;Z matched&#39;</span>)</span>
<span id="cb571-51"><a href="statistics.html#cb571-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb571-52"><a href="statistics.html#cb571-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(fl_V <span class="sc">-</span> (mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_alpha <span class="sc">+</span></span>
<span id="cb571-53"><a href="statistics.html#cb571-53" aria-hidden="true" tabindex="-1"></a>                    mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_beta <span class="sc">+</span></span>
<span id="cb571-54"><a href="statistics.html#cb571-54" aria-hidden="true" tabindex="-1"></a>                    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_gamma <span class="sc">+</span></span>
<span id="cb571-55"><a href="statistics.html#cb571-55" aria-hidden="true" tabindex="-1"></a>                    mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_delta)) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb571-56"><a href="statistics.html#cb571-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&#39;V matched&#39;</span>)</span>
<span id="cb571-57"><a href="statistics.html#cb571-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb571-58"><a href="statistics.html#cb571-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb571-59"><a href="statistics.html#cb571-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-60"><a href="statistics.html#cb571-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Delta_A=</span>fl_Delta_A, <span class="at">Delta_E=</span>fl_Delta_E,</span>
<span id="cb571-61"><a href="statistics.html#cb571-61" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha=</span>fl_alpha, <span class="at">beta=</span>fl_beta,</span>
<span id="cb571-62"><a href="statistics.html#cb571-62" aria-hidden="true" tabindex="-1"></a>              <span class="at">gamma=</span>fl_gamma, <span class="at">delta=</span>fl_delta))</span>
<span id="cb571-63"><a href="statistics.html#cb571-63" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now solve for <span class="math inline">\(\widehat{\mathbb{X}}\)</span> using <em>solve</em> given <span class="math inline">\(\widehat{\Omega}\)</span> and <span class="math inline">\(\widehat{b}\)</span>. Solving different assumptions on underlying joint probabilities.</p>
</div>
<div id="testing-program-for-2-by-2-problem-with-rectlinear-restrictions" class="section level5" number="9.2.2.1.6">
<h5><span class="header-section-number">9.2.2.1.6</span> Testing Program for 2 by 2 Problem with Rectlinear Restrictions</h5>
<p>Solving first when rectilinear assumption is valid:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="statistics.html#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb572-2"><a href="statistics.html#cb572-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-3"><a href="statistics.html#cb572-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb572-4"><a href="statistics.html#cb572-4" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb572-5"><a href="statistics.html#cb572-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb572-6"><a href="statistics.html#cb572-6" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb572-7"><a href="statistics.html#cb572-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-8"><a href="statistics.html#cb572-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb572-9"><a href="statistics.html#cb572-9" aria-hidden="true" tabindex="-1"></a>  fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb572-10"><a href="statistics.html#cb572-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb572-11"><a href="statistics.html#cb572-11" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb572-12"><a href="statistics.html#cb572-12" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb572-13"><a href="statistics.html#cb572-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb572-14"><a href="statistics.html#cb572-14" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.21</span></span>
<span id="cb572-15"><a href="statistics.html#cb572-15" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb572-16"><a href="statistics.html#cb572-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb572-17"><a href="statistics.html#cb572-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb572-18"><a href="statistics.html#cb572-18" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.11</span></span>
<span id="cb572-19"><a href="statistics.html#cb572-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb572-20"><a href="statistics.html#cb572-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-21"><a href="statistics.html#cb572-21" aria-hidden="true" tabindex="-1"></a>  fl_beta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb572-22"><a href="statistics.html#cb572-22" aria-hidden="true" tabindex="-1"></a>  fl_gamma_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true</span>
<span id="cb572-23"><a href="statistics.html#cb572-23" aria-hidden="true" tabindex="-1"></a>  fl_delta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb572-24"><a href="statistics.html#cb572-24" aria-hidden="true" tabindex="-1"></a>  ls_FBCDWXYZV <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_2by2</span>(</span>
<span id="cb572-25"><a href="statistics.html#cb572-25" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A,</span>
<span id="cb572-26"><a href="statistics.html#cb572-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_alpha =</span> fl_alpha_true, <span class="at">fl_beta =</span> fl_beta_true,</span>
<span id="cb572-27"><a href="statistics.html#cb572-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_gamma =</span> fl_gamma_true, <span class="at">fl_delta =</span> fl_delta_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb572-28"><a href="statistics.html#cb572-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-29"><a href="statistics.html#cb572-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb572-30"><a href="statistics.html#cb572-30" aria-hidden="true" tabindex="-1"></a>  fl_F <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>F</span>
<span id="cb572-31"><a href="statistics.html#cb572-31" aria-hidden="true" tabindex="-1"></a>  fl_B <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>B</span>
<span id="cb572-32"><a href="statistics.html#cb572-32" aria-hidden="true" tabindex="-1"></a>  fl_C <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>C</span>
<span id="cb572-33"><a href="statistics.html#cb572-33" aria-hidden="true" tabindex="-1"></a>  fl_D <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>D</span>
<span id="cb572-34"><a href="statistics.html#cb572-34" aria-hidden="true" tabindex="-1"></a>  fl_W <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>W</span>
<span id="cb572-35"><a href="statistics.html#cb572-35" aria-hidden="true" tabindex="-1"></a>  fl_X <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>X</span>
<span id="cb572-36"><a href="statistics.html#cb572-36" aria-hidden="true" tabindex="-1"></a>  fl_Y <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Y</span>
<span id="cb572-37"><a href="statistics.html#cb572-37" aria-hidden="true" tabindex="-1"></a>  fl_Z <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Z</span>
<span id="cb572-38"><a href="statistics.html#cb572-38" aria-hidden="true" tabindex="-1"></a>  fl_V <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>V</span>
<span id="cb572-39"><a href="statistics.html#cb572-39" aria-hidden="true" tabindex="-1"></a>  ls_solution <span class="ot">&lt;-</span> <span class="fu">ffi_solve_2by2_rectilinear</span>(</span>
<span id="cb572-40"><a href="statistics.html#cb572-40" aria-hidden="true" tabindex="-1"></a>    fl_F, fl_B, fl_C,</span>
<span id="cb572-41"><a href="statistics.html#cb572-41" aria-hidden="true" tabindex="-1"></a>    fl_W, fl_X, fl_Y)</span>
<span id="cb572-42"><a href="statistics.html#cb572-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-43"><a href="statistics.html#cb572-43" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>alpha</span>
<span id="cb572-44"><a href="statistics.html#cb572-44" aria-hidden="true" tabindex="-1"></a>  fl_beta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>beta</span>
<span id="cb572-45"><a href="statistics.html#cb572-45" aria-hidden="true" tabindex="-1"></a>  fl_gamma <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>gamma</span>
<span id="cb572-46"><a href="statistics.html#cb572-46" aria-hidden="true" tabindex="-1"></a>  fl_delta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>delta</span>
<span id="cb572-47"><a href="statistics.html#cb572-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-48"><a href="statistics.html#cb572-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb572-49"><a href="statistics.html#cb572-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb572-50"><a href="statistics.html#cb572-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_alpha=&#39;</span>, fl_alpha, <span class="st">&#39;, fl_alpha_true=&#39;</span>, fl_alpha_true))</span>
<span id="cb572-51"><a href="statistics.html#cb572-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_beta=&#39;</span>, fl_beta, <span class="st">&#39;, fl_beta_true=&#39;</span>, fl_beta_true))</span>
<span id="cb572-52"><a href="statistics.html#cb572-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gamma=&#39;</span>, fl_gamma, <span class="st">&#39;, fl_gamma_true=&#39;</span>, fl_gamma_true))</span>
<span id="cb572-53"><a href="statistics.html#cb572-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_delta=&#39;</span>, fl_delta, <span class="st">&#39;, fl_delta_true=&#39;</span>, fl_delta_true))</span>
<span id="cb572-54"><a href="statistics.html#cb572-54" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;fl_alpha=0.25, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.3, fl_beta_true=0.3&quot;
## [1] &quot;fl_gamma=0.36, fl_gamma_true=0.36&quot;
## [1] &quot;fl_delta=0.41, fl_delta_true=0.41&quot;
## [1] &quot;it_i=2&quot;
## [1] &quot;fl_alpha=0.25, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.46, fl_beta_true=0.46&quot;
## [1] &quot;fl_gamma=0.28, fl_gamma_true=0.28&quot;
## [1] &quot;fl_delta=0.49, fl_delta_true=0.49&quot;
## [1] &quot;it_i=3&quot;
## [1] &quot;fl_alpha=0.25, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.2, fl_beta_true=0.2&quot;
## [1] &quot;fl_gamma=0.14, fl_gamma_true=0.14&quot;
## [1] &quot;fl_delta=0.0900000000000001, fl_delta_true=0.09&quot;</code></pre>
<p>Solving when rectilinear assumption is NOT valid, results can be approximately correct. However, note that we do not have positive mass in all cases. See case three below, the alpha backed out is negative.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="statistics.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb574-2"><a href="statistics.html#cb574-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-3"><a href="statistics.html#cb574-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb574-4"><a href="statistics.html#cb574-4" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb574-5"><a href="statistics.html#cb574-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">2</span>, <span class="at">it_M =</span> <span class="dv">2</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb574-6"><a href="statistics.html#cb574-6" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb574-7"><a href="statistics.html#cb574-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-8"><a href="statistics.html#cb574-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb574-9"><a href="statistics.html#cb574-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb574-10"><a href="statistics.html#cb574-10" aria-hidden="true" tabindex="-1"></a>    fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb574-11"><a href="statistics.html#cb574-11" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb574-12"><a href="statistics.html#cb574-12" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb574-13"><a href="statistics.html#cb574-13" aria-hidden="true" tabindex="-1"></a>    fl_Delta_AE_true <span class="ot">&lt;-</span> <span class="fl">0.10</span></span>
<span id="cb574-14"><a href="statistics.html#cb574-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb574-15"><a href="statistics.html#cb574-15" aria-hidden="true" tabindex="-1"></a>    fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.55</span></span>
<span id="cb574-16"><a href="statistics.html#cb574-16" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="fl">0.21</span></span>
<span id="cb574-17"><a href="statistics.html#cb574-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb574-18"><a href="statistics.html#cb574-18" aria-hidden="true" tabindex="-1"></a>    fl_Delta_AE_true <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb574-19"><a href="statistics.html#cb574-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb574-20"><a href="statistics.html#cb574-20" aria-hidden="true" tabindex="-1"></a>    fl_alpha_true <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb574-21"><a href="statistics.html#cb574-21" aria-hidden="true" tabindex="-1"></a>    fl_Delta_A_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb574-22"><a href="statistics.html#cb574-22" aria-hidden="true" tabindex="-1"></a>    fl_Delta_E_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.11</span></span>
<span id="cb574-23"><a href="statistics.html#cb574-23" aria-hidden="true" tabindex="-1"></a>    fl_Delta_AE_true <span class="ot">&lt;-</span> <span class="fl">0.30</span></span>
<span id="cb574-24"><a href="statistics.html#cb574-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb574-25"><a href="statistics.html#cb574-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-26"><a href="statistics.html#cb574-26" aria-hidden="true" tabindex="-1"></a>  fl_beta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_A_true</span>
<span id="cb574-27"><a href="statistics.html#cb574-27" aria-hidden="true" tabindex="-1"></a>  fl_gamma_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_E_true</span>
<span id="cb574-28"><a href="statistics.html#cb574-28" aria-hidden="true" tabindex="-1"></a>  fl_delta_true <span class="ot">&lt;-</span> fl_alpha_true <span class="sc">+</span> fl_Delta_AE_true</span>
<span id="cb574-29"><a href="statistics.html#cb574-29" aria-hidden="true" tabindex="-1"></a>  ls_FBCDWXYZV <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_2by2</span>(</span>
<span id="cb574-30"><a href="statistics.html#cb574-30" aria-hidden="true" tabindex="-1"></a>    mt_prob_joint_E_A,</span>
<span id="cb574-31"><a href="statistics.html#cb574-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_alpha =</span> fl_alpha_true, <span class="at">fl_beta =</span> fl_beta_true,</span>
<span id="cb574-32"><a href="statistics.html#cb574-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fl_gamma =</span> fl_gamma_true, <span class="at">fl_delta =</span> fl_delta_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb574-33"><a href="statistics.html#cb574-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-34"><a href="statistics.html#cb574-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb574-35"><a href="statistics.html#cb574-35" aria-hidden="true" tabindex="-1"></a>  fl_F <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>F</span>
<span id="cb574-36"><a href="statistics.html#cb574-36" aria-hidden="true" tabindex="-1"></a>  fl_B <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>B</span>
<span id="cb574-37"><a href="statistics.html#cb574-37" aria-hidden="true" tabindex="-1"></a>  fl_C <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>C</span>
<span id="cb574-38"><a href="statistics.html#cb574-38" aria-hidden="true" tabindex="-1"></a>  fl_D <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>D</span>
<span id="cb574-39"><a href="statistics.html#cb574-39" aria-hidden="true" tabindex="-1"></a>  fl_W <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>W</span>
<span id="cb574-40"><a href="statistics.html#cb574-40" aria-hidden="true" tabindex="-1"></a>  fl_X <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>X</span>
<span id="cb574-41"><a href="statistics.html#cb574-41" aria-hidden="true" tabindex="-1"></a>  fl_Y <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Y</span>
<span id="cb574-42"><a href="statistics.html#cb574-42" aria-hidden="true" tabindex="-1"></a>  fl_Z <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>Z</span>
<span id="cb574-43"><a href="statistics.html#cb574-43" aria-hidden="true" tabindex="-1"></a>  fl_V <span class="ot">&lt;-</span> ls_FBCDWXYZV<span class="sc">$</span>V</span>
<span id="cb574-44"><a href="statistics.html#cb574-44" aria-hidden="true" tabindex="-1"></a>  ls_solution <span class="ot">&lt;-</span> <span class="fu">ffi_solve_2by2_rectilinear</span>(</span>
<span id="cb574-45"><a href="statistics.html#cb574-45" aria-hidden="true" tabindex="-1"></a>    fl_F, fl_B, fl_C,</span>
<span id="cb574-46"><a href="statistics.html#cb574-46" aria-hidden="true" tabindex="-1"></a>    fl_W, fl_X, fl_Y)</span>
<span id="cb574-47"><a href="statistics.html#cb574-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-48"><a href="statistics.html#cb574-48" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>alpha</span>
<span id="cb574-49"><a href="statistics.html#cb574-49" aria-hidden="true" tabindex="-1"></a>  fl_beta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>beta</span>
<span id="cb574-50"><a href="statistics.html#cb574-50" aria-hidden="true" tabindex="-1"></a>  fl_gamma <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>gamma</span>
<span id="cb574-51"><a href="statistics.html#cb574-51" aria-hidden="true" tabindex="-1"></a>  fl_delta <span class="ot">&lt;-</span> ls_solution<span class="sc">$</span>delta</span>
<span id="cb574-52"><a href="statistics.html#cb574-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-53"><a href="statistics.html#cb574-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb574-54"><a href="statistics.html#cb574-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb574-55"><a href="statistics.html#cb574-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_alpha=&#39;</span>, fl_alpha, <span class="st">&#39;, fl_alpha_true=&#39;</span>, fl_alpha_true))</span>
<span id="cb574-56"><a href="statistics.html#cb574-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_beta=&#39;</span>, fl_beta, <span class="st">&#39;, fl_beta_true=&#39;</span>, fl_beta_true))</span>
<span id="cb574-57"><a href="statistics.html#cb574-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gamma=&#39;</span>, fl_gamma, <span class="st">&#39;, fl_gamma_true=&#39;</span>, fl_gamma_true))</span>
<span id="cb574-58"><a href="statistics.html#cb574-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_delta=&#39;</span>, fl_delta, <span class="st">&#39;, fl_delta_true=&#39;</span>, fl_delta_true))</span>
<span id="cb574-59"><a href="statistics.html#cb574-59" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;fl_alpha=0.275066384524696, fl_alpha_true=0.25&quot;
## [1] &quot;fl_beta=0.282374240902959, fl_beta_true=0.3&quot;
## [1] &quot;fl_gamma=0.350855661880163, fl_gamma_true=0.36&quot;
## [1] &quot;fl_delta=0.358163518258426, fl_delta_true=0.35&quot;
## [1] &quot;it_i=2&quot;
## [1] &quot;fl_alpha=0.587599576787045, fl_alpha_true=0.55&quot;
## [1] &quot;fl_beta=0.733561361354439, fl_beta_true=0.76&quot;
## [1] &quot;fl_gamma=0.566283492820244, fl_gamma_true=0.58&quot;
## [1] &quot;fl_delta=0.712245277387639, fl_delta_true=0.7&quot;
## [1] &quot;it_i=3&quot;
## [1] &quot;fl_alpha=-0.0421756146893388, fl_alpha_true=0.15&quot;
## [1] &quot;fl_beta=0.235130819743977, fl_beta_true=0.1&quot;
## [1] &quot;fl_gamma=0.110106592252085, fl_gamma_true=0.04&quot;
## [1] &quot;fl_delta=0.387413026685401, fl_delta_true=0.45&quot;</code></pre>
</div>
</div>
<div id="by-3-joint-from-marginal-probability-mass-functions-with-rectilinear-assumptions" class="section level4" number="9.2.2.2">
<h4><span class="header-section-number">9.2.2.2</span> 3 by 3 Joint from Marginal Probability Mass Functions with Rectilinear Assumptions</h4>
<div id="the-3-by-3-problem" class="section level5" number="9.2.2.2.1">
<h5><span class="header-section-number">9.2.2.2.1</span> The 3 by 3 Problem</h5>
<p>We append the 2 by 2 problem to a 3 by 3 problem.</p>
<p><span class="math display">\[
\begin{aligned}
P(U|E_1) =
P(U|A_1, E_1) \cdot P(A_1|E_1) +
P(U|A_2, E_1) \cdot P(A_2|E_1) +
P(U|A_3, E_1) \cdot P(A_3|E_1)
\\
P(U|E_2) =
P(U|A_1, E_2) \cdot P(A_1|E_2) +
P(U|A_2, E_2) \cdot P(A_2|E_2) +
P(U|A_3, E_2) \cdot P(A_3|E_2)
\\
P(U|E_3) =
P(U|A_1, E_3) \cdot P(A_1|E_3) +
P(U|A_2, E_3) \cdot P(A_2|E_3) +
P(U|A_3, E_3) \cdot P(A_3|E_3)
\\
P(U|A_1) =
P(U|A_1, E_1) \cdot P(E_1|A_1) +
P(U|A_1, E_2) \cdot P(E_2|A_1) +
P(U|A_1, E_3) \cdot P(E_3|A_1)
\\
P(U|A_2) =
P(U|A_2, E_1) \cdot P(E_1|A_2) +
P(U|A_2, E_2) \cdot P(E_2|A_2) +
P(U|A_2, E_3) \cdot P(E_3|A_2)
\\
P(U|A_3) =
P(U|A_3, E_1) \cdot P(E_1|A_3) +
P(U|A_3, E_2) \cdot P(E_2|A_3) +
P(U|A_3, E_3) \cdot P(E_3|A_3)
\\
\end{aligned}
\]</span>
Similar to before, let Roman letter represent what we know, and greek letters represent what we do not know. There are nine potential unknown conditional unemployment probabilities <span class="math inline">\(\alpha_{ij}\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
V_1 &amp;= \alpha_{11} B_{11} + \alpha_{21} B_{21} + \alpha_{31} B_{31}
\\
V_2 &amp;= \alpha_{12} B_{12} + \alpha_{22} B_{22} + \alpha_{32} B_{32}
\\
V_3 &amp;= \alpha_{13} B_{13} + \alpha_{23} B_{23} + \alpha_{33} B_{33}
\\
W_1 &amp;= \alpha_{11} C_{11} + \alpha_{12} C_{21} + \alpha_{13} C_{31}
\\
W_2 &amp;= \alpha_{21} C_{12} + \alpha_{22} C_{22} + \alpha_{23} C_{32}
\\
W_3 &amp;= \alpha_{31} C_{13} + \alpha_{32} C_{23} + \alpha_{33} C_{33}
\end{aligned}
\]</span></p>
</div>
<div id="by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.2.2.2.2">
<h5><span class="header-section-number">9.2.2.2.2</span> 3 by 3 Problem with Rectlinear Restrictions</h5>
<p>With rectilinear assumptions, we have now rather than nine parameters, five parameters.</p>
<p><span class="math display">\[
\begin{aligned}
V_1 &amp;= \alpha B_{11} + (\alpha + \delta^{21}) B_{21} + (\alpha + \delta^{21} + \delta^{31}) B_{31}
\\
V_2 &amp;= (\alpha + \delta^{12}) B_{12} + (\alpha + \delta^{12} + \delta^{21}) B_{22} + (\alpha + \delta^{12} + \delta^{21} + \delta^{31}) B_{32}
\\
V_3 &amp;= (\alpha + \delta^{12} + \delta^{13}) B_{13} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21}) B_{23} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21} + \delta^{31}) B_{33}
\\
W_1 &amp;= \alpha C_{11} + (\alpha + \delta^{12}) C_{21} + (\alpha + \delta^{12} + \delta^{13}) C_{31}
\\
W_2 &amp;= (\alpha + \delta^{21}) C_{12} + (\alpha + \delta^{12} + \delta^{21}) C_{22} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21}) C_{32}
\\
W_3 &amp;= (\alpha + \delta^{21} + \delta^{31}) C_{13} + (\alpha + \delta^{12} + \delta^{21} + \delta^{31}) C_{23} + (\alpha + \delta^{12} + \delta^{13} + \delta^{21} + \delta^{31}) C_{33}
\end{aligned}
\]</span>
Write these in matrix form:</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
(B_{11} + B_{21} + B_{31}) &amp; (B_{21} + B_{31}) &amp; (B_{31}) &amp; 0 &amp; 0 \\
(B_{12} + B_{22} + B_{32}) &amp; (B_{22} + B_{32}) &amp; (B_{32}) &amp; (B_{12} + B_{22} + B_{32}) &amp; 0 \\
(B_{13} + B_{23} + B_{33}) &amp; (B_{23} + B_{33}) &amp; (B_{33}) &amp; (B_{13} + B_{23} + B_{33}) &amp; (B_{13} + B_{23} + B_{33}) \\
(C_{11} + C_{21} + C_{31}) &amp; 0 &amp; 0 &amp; (C_{21} + C_{31}) &amp; (C_{31}) \\
(C_{12} + C_{22} + C_{33}) &amp; (C_{12} + C_{22} + C_{32}) &amp; 0 &amp; (C_{22} + C_{32}) &amp; (C_{32})\\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\delta^{21} \\
\delta^{31} \\
\delta^{12} \\
\delta^{13}
\end{bmatrix}
&amp; =
\begin{bmatrix}
V_1 \\
V_2 \\
V_3 \\
W_1 \\
W_2 \\
\end{bmatrix}\\
\end{aligned}
\]</span>
<span class="math display">\[
\widehat{\Omega} \cdot \widehat{\mathbb{X}} = \widehat{b}
\]</span></p>
<p>Simplify slightly for where the probabilities sum to 1, which arrives at a matrix form that is similar to the matrix form arrived at for the 2 by 2 problem.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
1 &amp; (B_{21} + B_{31}) &amp; (B_{31}) &amp; 0 &amp; 0 \\
1 &amp; (B_{22} + B_{32}) &amp; (B_{32}) &amp; 1 &amp; 0 \\
1 &amp; (B_{23} + B_{33}) &amp; (B_{33}) &amp; 1 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; (C_{21} + C_{31}) &amp; (C_{31}) \\
1 &amp; 1 &amp; 0 &amp; (C_{22} + C_{32}) &amp; (C_{32})\\
\end{bmatrix}
\cdot
\begin{bmatrix}
\alpha \\
\delta^{21} \\
\delta^{31} \\
\delta^{12} \\
\delta^{13}
\end{bmatrix}
&amp; =
\begin{bmatrix}
V_1 \\
V_2 \\
V_3 \\
W_1 \\
W_2 \\
\end{bmatrix}\\\end{aligned}
\]</span>
<span class="math display">\[
\widehat{\Omega} \cdot \widehat{\mathbb{X}} = \widehat{b}
\]</span></p>
</div>
<div id="data-program-for-3-by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.2.2.2.3">
<h5><span class="header-section-number">9.2.2.2.3</span> Data Program for 3 by 3 Problem with Rectlinear Restrictions</h5>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="statistics.html#cb576-1" aria-hidden="true" tabindex="-1"></a>ffi_gen_condi_unemploy_prob_3by3 <span class="ot">&lt;-</span> <span class="cf">function</span>(mt_prob_joint_E_A, mt_alpha, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb576-2"><a href="statistics.html#cb576-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-3"><a href="statistics.html#cb576-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># From joint probability, generate conditional probabilities</span></span>
<span id="cb576-4"><a href="statistics.html#cb576-4" aria-hidden="true" tabindex="-1"></a>  fl_B21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb576-5"><a href="statistics.html#cb576-5" aria-hidden="true" tabindex="-1"></a>  fl_B31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb576-6"><a href="statistics.html#cb576-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-7"><a href="statistics.html#cb576-7" aria-hidden="true" tabindex="-1"></a>  fl_B22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb576-8"><a href="statistics.html#cb576-8" aria-hidden="true" tabindex="-1"></a>  fl_B32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb576-9"><a href="statistics.html#cb576-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-10"><a href="statistics.html#cb576-10" aria-hidden="true" tabindex="-1"></a>  fl_B23 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb576-11"><a href="statistics.html#cb576-11" aria-hidden="true" tabindex="-1"></a>  fl_B33 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb576-12"><a href="statistics.html#cb576-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-13"><a href="statistics.html#cb576-13" aria-hidden="true" tabindex="-1"></a>  fl_C21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb576-14"><a href="statistics.html#cb576-14" aria-hidden="true" tabindex="-1"></a>  fl_C31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb576-15"><a href="statistics.html#cb576-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-16"><a href="statistics.html#cb576-16" aria-hidden="true" tabindex="-1"></a>  fl_C22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb576-17"><a href="statistics.html#cb576-17" aria-hidden="true" tabindex="-1"></a>  fl_C32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb576-18"><a href="statistics.html#cb576-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-19"><a href="statistics.html#cb576-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb576-20"><a href="statistics.html#cb576-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_B21=&#39;</span>, fl_B21, <span class="st">&#39;,fl_B31=&#39;</span>,fl_B31))</span>
<span id="cb576-21"><a href="statistics.html#cb576-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_B22=&#39;</span>, fl_B22, <span class="st">&#39;,fl_B22=&#39;</span>,fl_B22))</span>
<span id="cb576-22"><a href="statistics.html#cb576-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_B23=&#39;</span>, fl_B23, <span class="st">&#39;,fl_B33=&#39;</span>,fl_B33))</span>
<span id="cb576-23"><a href="statistics.html#cb576-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_C21=&#39;</span>, fl_C21, <span class="st">&#39;,fl_C31=&#39;</span>,fl_C31))</span>
<span id="cb576-24"><a href="statistics.html#cb576-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_C22=&#39;</span>, fl_C22, <span class="st">&#39;,fl_C32=&#39;</span>,fl_C32))</span>
<span id="cb576-25"><a href="statistics.html#cb576-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb576-26"><a href="statistics.html#cb576-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-27"><a href="statistics.html#cb576-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random W X Y</span></span>
<span id="cb576-28"><a href="statistics.html#cb576-28" aria-hidden="true" tabindex="-1"></a>  fl_V1 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_B21 <span class="sc">-</span> fl_B31) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_B21 <span class="sc">+</span> mt_alpha[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">*</span>fl_B31</span>
<span id="cb576-29"><a href="statistics.html#cb576-29" aria-hidden="true" tabindex="-1"></a>  fl_V2 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_B22 <span class="sc">-</span> fl_B32) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_B22 <span class="sc">+</span> mt_alpha[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_B32</span>
<span id="cb576-30"><a href="statistics.html#cb576-30" aria-hidden="true" tabindex="-1"></a>  fl_V3 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_B23 <span class="sc">-</span> fl_B33) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_B23 <span class="sc">+</span> mt_alpha[<span class="dv">3</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_B33</span>
<span id="cb576-31"><a href="statistics.html#cb576-31" aria-hidden="true" tabindex="-1"></a>  fl_W1 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_C21 <span class="sc">-</span> fl_C31) <span class="sc">+</span> mt_alpha[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_C21 <span class="sc">+</span> mt_alpha[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_C31</span>
<span id="cb576-32"><a href="statistics.html#cb576-32" aria-hidden="true" tabindex="-1"></a>  fl_W2 <span class="ot">&lt;-</span> mt_alpha[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> fl_C22 <span class="sc">-</span> fl_C32) <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>fl_C22 <span class="sc">+</span> mt_alpha[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>fl_C32</span>
<span id="cb576-33"><a href="statistics.html#cb576-33" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">c</span>(fl_V1, fl_V2, fl_V3, fl_W1, fl_W2)</span>
<span id="cb576-34"><a href="statistics.html#cb576-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-35"><a href="statistics.html#cb576-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb576-36"><a href="statistics.html#cb576-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;ar_b=&#39;</span>,ar_b))</span>
<span id="cb576-37"><a href="statistics.html#cb576-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb576-38"><a href="statistics.html#cb576-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-39"><a href="statistics.html#cb576-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb576-40"><a href="statistics.html#cb576-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ar_b)</span>
<span id="cb576-41"><a href="statistics.html#cb576-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="solution-program-for-3-by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.2.2.2.4">
<h5><span class="header-section-number">9.2.2.2.4</span> Solution Program for 3 by 3 Problem with Rectlinear Restrictions</h5>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="statistics.html#cb577-1" aria-hidden="true" tabindex="-1"></a>ffi_solve_3by3_rectilinear <span class="ot">&lt;-</span> <span class="cf">function</span>(mt_prob_joint_E_A, ar_b, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>) {</span>
<span id="cb577-2"><a href="statistics.html#cb577-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-3"><a href="statistics.html#cb577-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># From joint probability, generate conditional probabilities</span></span>
<span id="cb577-4"><a href="statistics.html#cb577-4" aria-hidden="true" tabindex="-1"></a>  fl_B21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb577-5"><a href="statistics.html#cb577-5" aria-hidden="true" tabindex="-1"></a>  fl_B31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">1</span>,])</span>
<span id="cb577-6"><a href="statistics.html#cb577-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-7"><a href="statistics.html#cb577-7" aria-hidden="true" tabindex="-1"></a>  fl_B22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb577-8"><a href="statistics.html#cb577-8" aria-hidden="true" tabindex="-1"></a>  fl_B32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">2</span>,])</span>
<span id="cb577-9"><a href="statistics.html#cb577-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-10"><a href="statistics.html#cb577-10" aria-hidden="true" tabindex="-1"></a>  fl_B23 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb577-11"><a href="statistics.html#cb577-11" aria-hidden="true" tabindex="-1"></a>  fl_B33 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">3</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[<span class="dv">3</span>,])</span>
<span id="cb577-12"><a href="statistics.html#cb577-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-13"><a href="statistics.html#cb577-13" aria-hidden="true" tabindex="-1"></a>  fl_C21 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb577-14"><a href="statistics.html#cb577-14" aria-hidden="true" tabindex="-1"></a>  fl_C31 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">1</span>])</span>
<span id="cb577-15"><a href="statistics.html#cb577-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-16"><a href="statistics.html#cb577-16" aria-hidden="true" tabindex="-1"></a>  fl_C22 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb577-17"><a href="statistics.html#cb577-17" aria-hidden="true" tabindex="-1"></a>  fl_C32 <span class="ot">&lt;-</span> mt_prob_joint_E_A[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(mt_prob_joint_E_A[,<span class="dv">2</span>])</span>
<span id="cb577-18"><a href="statistics.html#cb577-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-19"><a href="statistics.html#cb577-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct The coefficent Matrix</span></span>
<span id="cb577-20"><a href="statistics.html#cb577-20" aria-hidden="true" tabindex="-1"></a>  mt_OMEGA <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(</span>
<span id="cb577-21"><a href="statistics.html#cb577-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span><span class="fu">c</span>(<span class="dv">1</span>, fl_B21<span class="sc">+</span>fl_B31, fl_B31, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb577-22"><a href="statistics.html#cb577-22" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, fl_B22<span class="sc">+</span>fl_B32, fl_B32, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb577-23"><a href="statistics.html#cb577-23" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, fl_B23<span class="sc">+</span>fl_B33, fl_B33, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb577-24"><a href="statistics.html#cb577-24" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, fl_C21<span class="sc">+</span>fl_C31, fl_C31,</span>
<span id="cb577-25"><a href="statistics.html#cb577-25" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, fl_C22<span class="sc">+</span>fl_C32, fl_C32), <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">5</span>))</span>
<span id="cb577-26"><a href="statistics.html#cb577-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-27"><a href="statistics.html#cb577-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rank Check with the qr function:</span></span>
<span id="cb577-28"><a href="statistics.html#cb577-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb577-29"><a href="statistics.html#cb577-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">qr</span>(mt_OMEGA_hat))</span>
<span id="cb577-30"><a href="statistics.html#cb577-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb577-31"><a href="statistics.html#cb577-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-32"><a href="statistics.html#cb577-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># solve</span></span>
<span id="cb577-33"><a href="statistics.html#cb577-33" aria-hidden="true" tabindex="-1"></a>  ar_solution <span class="ot">&lt;-</span> <span class="fu">solve</span>(mt_OMEGA, ar_b)</span>
<span id="cb577-34"><a href="statistics.html#cb577-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-35"><a href="statistics.html#cb577-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get alpha and Delta from solution</span></span>
<span id="cb577-36"><a href="statistics.html#cb577-36" aria-hidden="true" tabindex="-1"></a>  fl_alpha <span class="ot">&lt;-</span> ar_solution[<span class="dv">1</span>]</span>
<span id="cb577-37"><a href="statistics.html#cb577-37" aria-hidden="true" tabindex="-1"></a>  fl_Delta_21 <span class="ot">&lt;-</span> ar_solution[<span class="dv">2</span>]</span>
<span id="cb577-38"><a href="statistics.html#cb577-38" aria-hidden="true" tabindex="-1"></a>  fl_Delta_31 <span class="ot">&lt;-</span> ar_solution[<span class="dv">3</span>]</span>
<span id="cb577-39"><a href="statistics.html#cb577-39" aria-hidden="true" tabindex="-1"></a>  fl_Delta_12 <span class="ot">&lt;-</span> ar_solution[<span class="dv">4</span>]</span>
<span id="cb577-40"><a href="statistics.html#cb577-40" aria-hidden="true" tabindex="-1"></a>  fl_Delta_13 <span class="ot">&lt;-</span> ar_solution[<span class="dv">5</span>]</span>
<span id="cb577-41"><a href="statistics.html#cb577-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (bl_verbose) {</span>
<span id="cb577-42"><a href="statistics.html#cb577-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_21=&#39;</span>,fl_Delta_21))</span>
<span id="cb577-43"><a href="statistics.html#cb577-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_31=&#39;</span>,fl_Delta_31))</span>
<span id="cb577-44"><a href="statistics.html#cb577-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_12=&#39;</span>,fl_Delta_12))</span>
<span id="cb577-45"><a href="statistics.html#cb577-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_Delta_13=&#39;</span>,fl_Delta_13))</span>
<span id="cb577-46"><a href="statistics.html#cb577-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb577-47"><a href="statistics.html#cb577-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-48"><a href="statistics.html#cb577-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get beta gamma , delta</span></span>
<span id="cb577-49"><a href="statistics.html#cb577-49" aria-hidden="true" tabindex="-1"></a>  mt_alpha <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb577-50"><a href="statistics.html#cb577-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb577-51"><a href="statistics.html#cb577-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb577-52"><a href="statistics.html#cb577-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-53"><a href="statistics.html#cb577-53" aria-hidden="true" tabindex="-1"></a>      fl_current_val <span class="ot">&lt;-</span> fl_alpha</span>
<span id="cb577-54"><a href="statistics.html#cb577-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-55"><a href="statistics.html#cb577-55" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb577-56"><a href="statistics.html#cb577-56" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21</span>
<span id="cb577-57"><a href="statistics.html#cb577-57" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb577-58"><a href="statistics.html#cb577-58" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb577-59"><a href="statistics.html#cb577-59" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> fl_Delta_31</span>
<span id="cb577-60"><a href="statistics.html#cb577-60" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb577-61"><a href="statistics.html#cb577-61" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb577-62"><a href="statistics.html#cb577-62" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12</span>
<span id="cb577-63"><a href="statistics.html#cb577-63" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb577-64"><a href="statistics.html#cb577-64" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb577-65"><a href="statistics.html#cb577-65" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> fl_Delta_13</span>
<span id="cb577-66"><a href="statistics.html#cb577-66" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb577-67"><a href="statistics.html#cb577-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-68"><a href="statistics.html#cb577-68" aria-hidden="true" tabindex="-1"></a>      mt_alpha[it_row, it_col] <span class="ot">&lt;-</span> fl_current_val</span>
<span id="cb577-69"><a href="statistics.html#cb577-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb577-70"><a href="statistics.html#cb577-70" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb577-71"><a href="statistics.html#cb577-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-72"><a href="statistics.html#cb577-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-73"><a href="statistics.html#cb577-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mt_alpha)</span>
<span id="cb577-74"><a href="statistics.html#cb577-74" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="testing-program-for-3-by-3-problem-with-rectlinear-restrictions" class="section level5" number="9.2.2.2.5">
<h5><span class="header-section-number">9.2.2.2.5</span> Testing Program for 3 by 3 Problem with Rectlinear Restrictions</h5>
<p>Solving first when rectilinear assumption is valid:</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="statistics.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb578-2"><a href="statistics.html#cb578-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-3"><a href="statistics.html#cb578-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb578-4"><a href="statistics.html#cb578-4" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb578-5"><a href="statistics.html#cb578-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">3</span>, <span class="at">it_M =</span> <span class="dv">3</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb578-6"><a href="statistics.html#cb578-6" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb578-7"><a href="statistics.html#cb578-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-8"><a href="statistics.html#cb578-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb578-9"><a href="statistics.html#cb578-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb578-10"><a href="statistics.html#cb578-10" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb578-11"><a href="statistics.html#cb578-11" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb578-12"><a href="statistics.html#cb578-12" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="fl">0.07</span></span>
<span id="cb578-13"><a href="statistics.html#cb578-13" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb578-14"><a href="statistics.html#cb578-14" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb578-15"><a href="statistics.html#cb578-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb578-16"><a href="statistics.html#cb578-16" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb578-17"><a href="statistics.html#cb578-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb578-18"><a href="statistics.html#cb578-18" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.07</span></span>
<span id="cb578-19"><a href="statistics.html#cb578-19" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb578-20"><a href="statistics.html#cb578-20" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.03</span></span>
<span id="cb578-21"><a href="statistics.html#cb578-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb578-22"><a href="statistics.html#cb578-22" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb578-23"><a href="statistics.html#cb578-23" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb578-24"><a href="statistics.html#cb578-24" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb578-25"><a href="statistics.html#cb578-25" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb578-26"><a href="statistics.html#cb578-26" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.1</span></span>
<span id="cb578-27"><a href="statistics.html#cb578-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb578-28"><a href="statistics.html#cb578-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-29"><a href="statistics.html#cb578-29" aria-hidden="true" tabindex="-1"></a>  mt_alpha_true <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb578-30"><a href="statistics.html#cb578-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb578-31"><a href="statistics.html#cb578-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb578-32"><a href="statistics.html#cb578-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-33"><a href="statistics.html#cb578-33" aria-hidden="true" tabindex="-1"></a>      fl_current_val <span class="ot">&lt;-</span> fl_alpha</span>
<span id="cb578-34"><a href="statistics.html#cb578-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-35"><a href="statistics.html#cb578-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb578-36"><a href="statistics.html#cb578-36" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21</span>
<span id="cb578-37"><a href="statistics.html#cb578-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb578-38"><a href="statistics.html#cb578-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb578-39"><a href="statistics.html#cb578-39" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> fl_Delta_31</span>
<span id="cb578-40"><a href="statistics.html#cb578-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb578-41"><a href="statistics.html#cb578-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb578-42"><a href="statistics.html#cb578-42" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12</span>
<span id="cb578-43"><a href="statistics.html#cb578-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb578-44"><a href="statistics.html#cb578-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb578-45"><a href="statistics.html#cb578-45" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> fl_Delta_13</span>
<span id="cb578-46"><a href="statistics.html#cb578-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb578-47"><a href="statistics.html#cb578-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-48"><a href="statistics.html#cb578-48" aria-hidden="true" tabindex="-1"></a>      mt_alpha_true[it_row, it_col] <span class="ot">&lt;-</span> fl_current_val</span>
<span id="cb578-49"><a href="statistics.html#cb578-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb578-50"><a href="statistics.html#cb578-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb578-51"><a href="statistics.html#cb578-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-52"><a href="statistics.html#cb578-52" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_3by3</span>(mt_prob_joint_E_A, mt_alpha_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb578-53"><a href="statistics.html#cb578-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-54"><a href="statistics.html#cb578-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb578-55"><a href="statistics.html#cb578-55" aria-hidden="true" tabindex="-1"></a>  mt_alpha_solu <span class="ot">&lt;-</span> <span class="fu">ffi_solve_3by3_rectilinear</span>(mt_prob_joint_E_A, ar_b)</span>
<span id="cb578-56"><a href="statistics.html#cb578-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-57"><a href="statistics.html#cb578-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb578-58"><a href="statistics.html#cb578-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb578-59"><a href="statistics.html#cb578-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_true&#39;</span>)</span>
<span id="cb578-60"><a href="statistics.html#cb578-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_true)</span>
<span id="cb578-61"><a href="statistics.html#cb578-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_solu&#39;</span>)</span>
<span id="cb578-62"><a href="statistics.html#cb578-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_solu)</span>
<span id="cb578-63"><a href="statistics.html#cb578-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-64"><a href="statistics.html#cb578-64" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;mt_alpha_true&quot;
##      [,1] [,2] [,3]
## [1,] 0.10 0.19 0.22
## [2,] 0.15 0.24 0.27
## [3,] 0.22 0.31 0.34
## [1] &quot;mt_alpha_solu&quot;
##      [,1] [,2] [,3]
## [1,] 0.10 0.19 0.22
## [2,] 0.15 0.24 0.27
## [3,] 0.22 0.31 0.34
## [1] &quot;it_i=2&quot;
## [1] &quot;mt_alpha_true&quot;
##      [,1] [,2] [,3]
## [1,] 0.20 0.29 0.26
## [2,] 0.15 0.24 0.21
## [3,] 0.22 0.31 0.28
## [1] &quot;mt_alpha_solu&quot;
##      [,1] [,2] [,3]
## [1,] 0.20 0.29 0.26
## [2,] 0.15 0.24 0.21
## [3,] 0.22 0.31 0.28
## [1] &quot;it_i=3&quot;
## [1] &quot;mt_alpha_true&quot;
##      [,1] [,2] [,3]
## [1,] 0.15 0.15 0.25
## [2,] 0.26 0.26 0.36
## [3,] 0.25 0.25 0.35
## [1] &quot;mt_alpha_solu&quot;
##      [,1] [,2] [,3]
## [1,] 0.15 0.15 0.25
## [2,] 0.26 0.26 0.36
## [3,] 0.25 0.25 0.35</code></pre>
<p>Solving first when rectilinear assumption is NOT VALID, same as above, except add randomness at each point. Note that the solution is approximately the same as the actual in the examples here.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="statistics.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb580-2"><a href="statistics.html#cb580-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb580-3"><a href="statistics.html#cb580-3" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over alternatives</span></span>
<span id="cb580-4"><a href="statistics.html#cb580-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb580-5"><a href="statistics.html#cb580-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-6"><a href="statistics.html#cb580-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># JOint mass of population at all cells</span></span>
<span id="cb580-7"><a href="statistics.html#cb580-7" aria-hidden="true" tabindex="-1"></a>  ls_ffi_rand_joint_mass <span class="ot">&lt;-</span> <span class="fu">ffi_gen_rand_joint_mass</span>(</span>
<span id="cb580-8"><a href="statistics.html#cb580-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">it_seed =</span> <span class="dv">123</span>, <span class="at">it_Q =</span> <span class="dv">3</span>, <span class="at">it_M =</span> <span class="dv">3</span>, <span class="at">bl_verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb580-9"><a href="statistics.html#cb580-9" aria-hidden="true" tabindex="-1"></a>  mt_prob_joint_E_A <span class="ot">&lt;-</span> ls_ffi_rand_joint_mass<span class="sc">$</span>mt_prob_joint_E_A</span>
<span id="cb580-10"><a href="statistics.html#cb580-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-11"><a href="statistics.html#cb580-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retlinear restrictions for conditional unemployment probabilities</span></span>
<span id="cb580-12"><a href="statistics.html#cb580-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb580-13"><a href="statistics.html#cb580-13" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb580-14"><a href="statistics.html#cb580-14" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb580-15"><a href="statistics.html#cb580-15" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="fl">0.07</span></span>
<span id="cb580-16"><a href="statistics.html#cb580-16" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb580-17"><a href="statistics.html#cb580-17" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb580-18"><a href="statistics.html#cb580-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb580-19"><a href="statistics.html#cb580-19" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb580-20"><a href="statistics.html#cb580-20" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb580-21"><a href="statistics.html#cb580-21" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.07</span></span>
<span id="cb580-22"><a href="statistics.html#cb580-22" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="fl">0.09</span></span>
<span id="cb580-23"><a href="statistics.html#cb580-23" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.03</span></span>
<span id="cb580-24"><a href="statistics.html#cb580-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb580-25"><a href="statistics.html#cb580-25" aria-hidden="true" tabindex="-1"></a>    fl_alpha <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb580-26"><a href="statistics.html#cb580-26" aria-hidden="true" tabindex="-1"></a>    fl_Delta_21 <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb580-27"><a href="statistics.html#cb580-27" aria-hidden="true" tabindex="-1"></a>    fl_Delta_31 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb580-28"><a href="statistics.html#cb580-28" aria-hidden="true" tabindex="-1"></a>    fl_Delta_12 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb580-29"><a href="statistics.html#cb580-29" aria-hidden="true" tabindex="-1"></a>    fl_Delta_13 <span class="ot">&lt;-</span> <span class="sc">+</span><span class="fl">0.1</span></span>
<span id="cb580-30"><a href="statistics.html#cb580-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb580-31"><a href="statistics.html#cb580-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-32"><a href="statistics.html#cb580-32" aria-hidden="true" tabindex="-1"></a>  mt_alpha_true <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb580-33"><a href="statistics.html#cb580-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (it_row <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb580-34"><a href="statistics.html#cb580-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_col <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb580-35"><a href="statistics.html#cb580-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-36"><a href="statistics.html#cb580-36" aria-hidden="true" tabindex="-1"></a>      fl_current_val <span class="ot">&lt;-</span> fl_alpha</span>
<span id="cb580-37"><a href="statistics.html#cb580-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-38"><a href="statistics.html#cb580-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb580-39"><a href="statistics.html#cb580-39" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb580-40"><a href="statistics.html#cb580-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb580-41"><a href="statistics.html#cb580-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_row <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb580-42"><a href="statistics.html#cb580-42" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_21 <span class="sc">+</span> fl_Delta_31 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb580-43"><a href="statistics.html#cb580-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb580-44"><a href="statistics.html#cb580-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb580-45"><a href="statistics.html#cb580-45" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb580-46"><a href="statistics.html#cb580-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb580-47"><a href="statistics.html#cb580-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (it_col <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb580-48"><a href="statistics.html#cb580-48" aria-hidden="true" tabindex="-1"></a>        fl_current_val <span class="ot">&lt;-</span> fl_current_val <span class="sc">+</span> fl_Delta_12 <span class="sc">+</span> fl_Delta_13 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb580-49"><a href="statistics.html#cb580-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb580-50"><a href="statistics.html#cb580-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-51"><a href="statistics.html#cb580-51" aria-hidden="true" tabindex="-1"></a>      mt_alpha_true[it_row, it_col] <span class="ot">&lt;-</span> fl_current_val</span>
<span id="cb580-52"><a href="statistics.html#cb580-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb580-53"><a href="statistics.html#cb580-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb580-54"><a href="statistics.html#cb580-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-55"><a href="statistics.html#cb580-55" aria-hidden="true" tabindex="-1"></a>  ar_b <span class="ot">&lt;-</span> <span class="fu">ffi_gen_condi_unemploy_prob_3by3</span>(mt_prob_joint_E_A, mt_alpha_true, <span class="at">bl_verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb580-56"><a href="statistics.html#cb580-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-57"><a href="statistics.html#cb580-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># call solution function</span></span>
<span id="cb580-58"><a href="statistics.html#cb580-58" aria-hidden="true" tabindex="-1"></a>  mt_alpha_solu <span class="ot">&lt;-</span> <span class="fu">ffi_solve_3by3_rectilinear</span>(mt_prob_joint_E_A, ar_b)</span>
<span id="cb580-59"><a href="statistics.html#cb580-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-60"><a href="statistics.html#cb580-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check</span></span>
<span id="cb580-61"><a href="statistics.html#cb580-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_i=&#39;</span>, it_i))</span>
<span id="cb580-62"><a href="statistics.html#cb580-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_true&#39;</span>)</span>
<span id="cb580-63"><a href="statistics.html#cb580-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_true)</span>
<span id="cb580-64"><a href="statistics.html#cb580-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;mt_alpha_solu&#39;</span>)</span>
<span id="cb580-65"><a href="statistics.html#cb580-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(mt_alpha_solu)</span>
<span id="cb580-66"><a href="statistics.html#cb580-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-67"><a href="statistics.html#cb580-67" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_i=1&quot;
## [1] &quot;mt_alpha_true&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1000000 0.2813229 0.4113667
## [2,] 0.2406668 0.4900408 0.4705499
## [3,] 0.2692175 0.3839961 0.7088086
## [1] &quot;mt_alpha_solu&quot;
##            [,1]      [,2]      [,3]
## [1,] 0.06922205 0.2610615 0.4720626
## [2,] 0.26540144 0.4572409 0.6682420
## [3,] 0.24462011 0.4364596 0.6474607
## [1] &quot;it_i=2&quot;
## [1] &quot;mt_alpha_true&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.2000000 0.3813229 0.4513667
## [2,] 0.2406668 0.4900408 0.4105499
## [3,] 0.2692175 0.3839961 0.6488086
## [1] &quot;mt_alpha_solu&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1692221 0.3610615 0.5120626
## [2,] 0.2654014 0.4572409 0.6082420
## [3,] 0.2446201 0.4364596 0.5874607
## [1] &quot;it_i=3&quot;
## [1] &quot;mt_alpha_true&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1500000 0.2413229 0.4413667
## [2,] 0.3506668 0.5100408 0.5605499
## [3,] 0.2992175 0.3239961 0.7188086
## [1] &quot;mt_alpha_solu&quot;
##           [,1]      [,2]      [,3]
## [1,] 0.1192221 0.2210615 0.5020626
## [2,] 0.3754014 0.4772409 0.7582420
## [3,] 0.2746201 0.3764596 0.6574607</code></pre>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mathematics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tables-and-graphs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
