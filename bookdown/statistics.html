<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Statistics | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="Running parallel code in R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Statistics | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Running parallel code in R" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Statistics | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="Running parallel code in R" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mathematics.html"/>
<link rel="next" href="tables-and-graphs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#regular-expression-date-etc."><i class="fa fa-check"></i><b>1.4</b> Regular Expression, Date, etc.</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-regular-expression"><i class="fa fa-check"></i><b>1.4.1</b> String Regular Expression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html"><i class="fa fa-check"></i><b>2</b> Manipulate and Summarize Dataframes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#variables-in-dataframes"><i class="fa fa-check"></i><b>2.1</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-dataframe"><i class="fa fa-check"></i><b>2.1.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="2.1.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-categorical-variables"><i class="fa fa-check"></i><b>2.1.2</b> Generate Categorical Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#drawly-random-rows"><i class="fa fa-check"></i><b>2.1.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="2.1.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>2.1.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="2.1.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#string-dataframes"><i class="fa fa-check"></i><b>2.1.5</b> String Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-observation"><i class="fa fa-check"></i><b>2.2</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-and-tabulations"><i class="fa fa-check"></i><b>2.2.1</b> Counting and Tabulations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.3</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-1"><i class="fa fa-check"></i><b>2.3.1</b> Sorting</a></li>
<li class="chapter" data-level="2.3.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.3.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#advanced-group-aggregation"><i class="fa fa-check"></i><b>2.4</b> Advanced Group Aggregation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.4.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.4.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#groups-statistics"><i class="fa fa-check"></i><b>2.4.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.4.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.4.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.4.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.4.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#distributional-statistics"><i class="fa fa-check"></i><b>2.5</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#histogram"><i class="fa fa-check"></i><b>2.5.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.6</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#apply-function-over-multiple-columns-and-rows"><i class="fa fa-check"></i><b>2.6.1</b> Apply Function Over Multiple Columns and Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-table-to-wide-table"><i class="fa fa-check"></i><b>4.2.1</b> Long Table to Wide Table</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-comparisons-and-statistics"><i class="fa fa-check"></i><b>4.3</b> Within Panel Comparisons and Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
<li class="chapter" data-level="4.3.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-cross-time-and-cross-group-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Within Panel Cross-time and Cross-group Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-merge-files-together-by-keys"><i class="fa fa-check"></i><b>4.4</b> Join and Merge Files Together by Keys</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#mesh-join"><i class="fa fa-check"></i><b>4.4.1</b> Mesh Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#linear-and-polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Linear and Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#fit-curves-through-points"><i class="fa fa-check"></i><b>5.1.1</b> Fit Curves Through Points</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#grid-based-optimization"><i class="fa fa-check"></i><b>7.1</b> Grid Based Optimization</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#find-maximum-by-iterating-over-grids"><i class="fa fa-check"></i><b>7.1.1</b> Find Maximum By Iterating Over Grids</a></li>
<li class="chapter" data-level="7.1.2" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1.2</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#polynomial-formulas-for-points"><i class="fa fa-check"></i><b>8.1.1</b> Polynomial Formulas for Points</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.3</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.4</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.5" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.5</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-functions"><i class="fa fa-check"></i><b>8.2</b> Production Functions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#latent-dynamic-health-production-function"><i class="fa fa-check"></i><b>8.2.2</b> Latent Dynamic Health Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot-basics"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot Basics</a></li>
<li class="chapter" data-level="10.2.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-advanced"><i class="fa fa-check"></i><b>10.2.2</b> ggplot Line Advanced</a></li>
<li class="chapter" data-level="10.2.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#time-series-plots-with-shaded-areas"><i class="fa fa-check"></i><b>10.2.3</b> Time-series Plots with Shaded Areas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="coding-and-development.html"><a href="coding-and-development.html"><i class="fa fa-check"></i><b>12</b> Coding and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="coding-and-development.html"><a href="coding-and-development.html#installation-and-packages"><i class="fa fa-check"></i><b>12.1</b> Installation and Packages</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="coding-and-development.html"><a href="coding-and-development.html#r-installation-and-set-up"><i class="fa fa-check"></i><b>12.1.1</b> R Installation and Set-Up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="coding-and-development.html"><a href="coding-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.2</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="coding-and-development.html"><a href="coding-and-development.html#file-path"><i class="fa fa-check"></i><b>12.2.1</b> File Path</a></li>
<li class="chapter" data-level="12.2.2" data-path="coding-and-development.html"><a href="coding-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.2.2</b> Text to File</a></li>
<li class="chapter" data-level="12.2.3" data-path="coding-and-development.html"><a href="coding-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.2.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="coding-and-development.html"><a href="coding-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.3</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="coding-and-development.html"><a href="coding-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.3.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="coding-and-development.html"><a href="coding-and-development.html#command-line"><i class="fa fa-check"></i><b>12.4</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="coding-and-development.html"><a href="coding-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.4.1</b> Shell and System Commands</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="coding-and-development.html"><a href="coding-and-development.html#run-code-in-parallel-in-r"><i class="fa fa-check"></i><b>12.5</b> Run Code in Parallel in R</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="coding-and-development.html"><a href="coding-and-development.html#parallel-loop-in-r"><i class="fa fa-check"></i><b>12.5.1</b> Parallel Loop in R</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> Section 1.1 List links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> Section 1.2 Array links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> Section 1.3 Matrix links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-regular-expression-date-etc.regular-expression-date-etc.-links"><i class="fa fa-check"></i><b>A.1.4</b> Section 1.4 Regular Expression, Date, etc. links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#manipulate-and-summarize-dataframes-links"><i class="fa fa-check"></i><b>A.2</b> Manipulate and Summarize Dataframes links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.2.1</b> Section 2.1 Variables in Dataframes links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.2</b> Section 2.2 Counting Observation links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.3</b> Section 2.3 Sorting, Indexing, Slicing links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-advanced-group-aggregationadvanced-group-aggregation-links"><i class="fa fa-check"></i><b>A.2.4</b> Section 2.4 Advanced Group Aggregation links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.5</b> Section 2.5 Distributional Statistics links</a></li>
<li class="chapter" data-level="A.2.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.6-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.6</b> Section 2.6 Summarize Multiple Variables links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> Section 3.1 Dataframe Mutate links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> Section 3.2 Dataframe Do Anything links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> Section 3.3 Apply and pmap links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> Section 4.1 Generate, Gather, Bind and Join links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> Section 4.2 Wide and Long links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-within-panel-comparisons-and-statisticswithin-panel-comparisons-and-statistics-links"><i class="fa fa-check"></i><b>A.4.3</b> Section 4.3 Within Panel Comparisons and Statistics links</a></li>
<li class="chapter" data-level="A.4.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.4-join-and-merge-files-together-by-keysjoin-and-merge-files-together-by-keys-links"><i class="fa fa-check"></i><b>A.4.4</b> Section 4.4 Join and Merge Files Together by Keys links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-linear-and-polynomial-fittinglinear-and-polynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> Section 5.1 Linear and Polynomial Fitting links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> Section 5.2 OLS and IV links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> Section 5.3 Decomposition links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> Section 6.1 Logit Regression links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> Section 6.2 Quantile Regression links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-grid-based-optimizationgrid-based-optimization-links"><i class="fa fa-check"></i><b>A.7.1</b> Section 7.1 Grid Based Optimization links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> Section 8.1 Basics links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionsproduction-functions-links"><i class="fa fa-check"></i><b>A.8.2</b> Section 8.2 Production Functions links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> Section 8.3 Inequality Models links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> Section 9.1 Random Draws links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> Section 9.2 Distributions links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> Section 9.3 Discrete Random Variable links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> Section 10.1 R Base Plots links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> Section 10.2 ggplot Line Related Plots links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> Section 10.3 ggplot Scatter Related Plots links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> Section 10.4 Write and Read Plots links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> Section 11.1 Environmental Data links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#coding-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Coding and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-installation-and-packagesinstallation-and-packages-links"><i class="fa fa-check"></i><b>A.12.1</b> Section 12.1 Installation and Packages links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.2</b> Section 12.2 Files In and Out links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.3</b> Section 12.3 Python with R links</a></li>
<li class="chapter" data-level="A.12.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.4-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.4</b> Section 12.4 Command Line links</a></li>
<li class="chapter" data-level="A.12.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.5-run-code-in-parallel-in-rrun-code-in-parallel-in-r-links"><i class="fa fa-check"></i><b>A.12.5</b> Section 12.5 Run Code in Parallel in R links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Statistics<a href="statistics.html#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="random-draws" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Random Draws<a href="statistics.html#random-draws" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="randomly-perturbing-a-parameter" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Randomly Perturbing a Parameter<a href="statistics.html#randomly-perturbing-a-parameter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="perturbation-normally-with-log-normal-magnitude-scaling-value" class="section level4 hasAnchor" number="9.1.1.1">
<h4><span class="header-section-number">9.1.1.1</span> Perturbation Normally with Log-Normal Magnitude Scaling Value<a href="statistics.html#perturbation-normally-with-log-normal-magnitude-scaling-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>During estimation, we have some starting estimation parameter value. We want to do multi-start estimation by perturbing initial starting points. The perturbing process follows the rules specified below, implemented in the function below.</p>
<ol style="list-style-type: decimal">
<li>Select from 0 to 1, 0 closest to the existing parameter value, 1 very far from it.</li>
<li>Log normal distribution with 1st quartile = 0.185, and mu of normal = 0. The value from (1) correspond to a cumulative mass point of this log normal distribution.</li>
<li>Draw a value randomly from standard normal</li>
<li>Transform the randomly drawn value to current parameter scale with inverse z-score, the resulting value is the parameter of interest.</li>
</ol>
<p>Test and implement the ideas above.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="statistics.html#cb772-1" tabindex="-1"></a><span class="co"># Step 0</span></span>
<span id="cb772-2"><a href="statistics.html#cb772-2" tabindex="-1"></a>ar_fl_original_param <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb772-3"><a href="statistics.html#cb772-3" tabindex="-1"></a>ar_fl_original_param <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb772-4"><a href="statistics.html#cb772-4" tabindex="-1"></a><span class="co"># Step 1</span></span>
<span id="cb772-5"><a href="statistics.html#cb772-5" tabindex="-1"></a>ar_zero_to_one_select <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-3</span>, <span class="dv">1</span> <span class="sc">-</span> <span class="fl">1e-3</span>, <span class="at">length.out =</span> <span class="dv">11</span>)</span>
<span id="cb772-6"><a href="statistics.html#cb772-6" tabindex="-1"></a><span class="co"># Step 2</span></span>
<span id="cb772-7"><a href="statistics.html#cb772-7" tabindex="-1"></a><span class="co"># Assume mean of normal = 0, with sdlog = 2, 25th percentile is 0.185</span></span>
<span id="cb772-8"><a href="statistics.html#cb772-8" tabindex="-1"></a>fl_sdlog <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb772-9"><a href="statistics.html#cb772-9" tabindex="-1"></a>fl_p25_logn <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="fl">0.25</span>, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb772-10"><a href="statistics.html#cb772-10" tabindex="-1"></a><span class="co"># Step 3</span></span>
<span id="cb772-11"><a href="statistics.html#cb772-11" tabindex="-1"></a><span class="co"># random draw, for now fix at positive number, which means to &quot;randomly&quot; expand</span></span>
<span id="cb772-12"><a href="statistics.html#cb772-12" tabindex="-1"></a>fl_draw_znorm <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb772-13"><a href="statistics.html#cb772-13" tabindex="-1"></a><span class="co"># Step 4</span></span>
<span id="cb772-14"><a href="statistics.html#cb772-14" tabindex="-1"></a>mt_collect <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb772-15"><a href="statistics.html#cb772-15" tabindex="-1"></a>  <span class="at">data =</span> <span class="cn">NA</span>,</span>
<span id="cb772-16"><a href="statistics.html#cb772-16" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">length</span>(ar_zero_to_one_select),</span>
<span id="cb772-17"><a href="statistics.html#cb772-17" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="fu">length</span>(ar_fl_original_param)</span>
<span id="cb772-18"><a href="statistics.html#cb772-18" tabindex="-1"></a>)</span>
<span id="cb772-19"><a href="statistics.html#cb772-19" tabindex="-1"></a>it_col_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb772-20"><a href="statistics.html#cb772-20" tabindex="-1"></a><span class="cf">for</span> (fl_original_param <span class="cf">in</span> ar_fl_original_param) {</span>
<span id="cb772-21"><a href="statistics.html#cb772-21" tabindex="-1"></a>  it_col_ctr <span class="ot">&lt;-</span> it_col_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb772-22"><a href="statistics.html#cb772-22" tabindex="-1"></a>  <span class="co"># inverse z-score</span></span>
<span id="cb772-23"><a href="statistics.html#cb772-23" tabindex="-1"></a>  ar_logn_coef_of_var <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="dv">1</span><span class="sc">-</span>ar_zero_to_one_select, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb772-24"><a href="statistics.html#cb772-24" tabindex="-1"></a>  ar_logn_sd <span class="ot">&lt;-</span> fl_original_param<span class="sc">/</span>ar_logn_coef_of_var</span>
<span id="cb772-25"><a href="statistics.html#cb772-25" tabindex="-1"></a>  ar_param_perturbed <span class="ot">&lt;-</span> fl_draw_znorm <span class="sc">*</span> ar_logn_sd <span class="sc">+</span> fl_original_param</span>
<span id="cb772-26"><a href="statistics.html#cb772-26" tabindex="-1"></a>  <span class="co"># fill matrix</span></span>
<span id="cb772-27"><a href="statistics.html#cb772-27" tabindex="-1"></a>  mt_collect[, it_col_ctr] <span class="ot">&lt;-</span> (ar_param_perturbed)</span>
<span id="cb772-28"><a href="statistics.html#cb772-28" tabindex="-1"></a>}</span>
<span id="cb772-29"><a href="statistics.html#cb772-29" tabindex="-1"></a><span class="co"># Out to table</span></span>
<span id="cb772-30"><a href="statistics.html#cb772-30" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;zero_one_scalar&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;ori_val=&quot;</span>, ar_fl_original_param))</span>
<span id="cb772-31"><a href="statistics.html#cb772-31" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb772-32"><a href="statistics.html#cb772-32" tabindex="-1"></a>tb_collect <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_zero_to_one_select, mt_collect)) <span class="sc">%&gt;%</span></span>
<span id="cb772-33"><a href="statistics.html#cb772-33" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb772-34"><a href="statistics.html#cb772-34" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb772-35"><a href="statistics.html#cb772-35" tabindex="-1"></a><span class="fu">kable</span>(tb_collect) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
zero_one_scalar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=-10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=-0.1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=0.1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ori_val=10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
-10.00441
</td>
<td style="text-align:right;">
-0.1000441
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1000441
</td>
<td style="text-align:right;">
10.00441
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1008
</td>
<td style="text-align:right;">
-10.41068
</td>
<td style="text-align:right;">
-0.1041068
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1041068
</td>
<td style="text-align:right;">
10.41068
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2006
</td>
<td style="text-align:right;">
-11.22616
</td>
<td style="text-align:right;">
-0.1122616
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1122616
</td>
<td style="text-align:right;">
11.22616
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3004
</td>
<td style="text-align:right;">
-12.70326
</td>
<td style="text-align:right;">
-0.1270326
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1270326
</td>
<td style="text-align:right;">
12.70326
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4002
</td>
<td style="text-align:right;">
-15.31489
</td>
<td style="text-align:right;">
-0.1531489
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1531489
</td>
<td style="text-align:right;">
15.31489
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5000
</td>
<td style="text-align:right;">
-20.00000
</td>
<td style="text-align:right;">
-0.2000000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
20.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5998
</td>
<td style="text-align:right;">
-28.81508
</td>
<td style="text-align:right;">
-0.2881508
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2881508
</td>
<td style="text-align:right;">
28.81508
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6996
</td>
<td style="text-align:right;">
-46.99235
</td>
<td style="text-align:right;">
-0.4699235
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4699235
</td>
<td style="text-align:right;">
46.99235
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7994
</td>
<td style="text-align:right;">
-91.55561
</td>
<td style="text-align:right;">
-0.9155561
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.9155561
</td>
<td style="text-align:right;">
91.55561
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8992
</td>
<td style="text-align:right;">
-253.49612
</td>
<td style="text-align:right;">
-2.5349612
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.5349612
</td>
<td style="text-align:right;">
253.49612
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9990
</td>
<td style="text-align:right;">
-22665.67969
</td>
<td style="text-align:right;">
-226.6567969
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
226.6567969
</td>
<td style="text-align:right;">
22665.67969
</td>
</tr>
</tbody>
</table>
<p>Implement the above idea with a function.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="statistics.html#cb773-1" tabindex="-1"></a>ffi_param_logn_perturber <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb773-2"><a href="statistics.html#cb773-2" tabindex="-1"></a>  <span class="at">param_original=</span><span class="dv">5</span>, <span class="at">scaler_0t1=</span><span class="fl">0.5</span>, </span>
<span id="cb773-3"><a href="statistics.html#cb773-3" tabindex="-1"></a>  <span class="at">it_rand_seed=</span><span class="dv">1</span>, <span class="at">fl_sdlog=</span><span class="fl">2.5</span>, <span class="at">fl_min_quantile=</span><span class="fl">1e-3</span>) {</span>
<span id="cb773-4"><a href="statistics.html#cb773-4" tabindex="-1"></a>  <span class="co">#&#39; @param float original current parameter value to be perturbed</span></span>
<span id="cb773-5"><a href="statistics.html#cb773-5" tabindex="-1"></a>  <span class="co">#&#39; @param scaler_0t1 float, must be between 0 to 1, 0 means don&#39;t scale much, 1 mean a lot</span></span>
<span id="cb773-6"><a href="statistics.html#cb773-6" tabindex="-1"></a>  <span class="co">#&#39; @param it_rand_seed integer randomly sperturbing seed</span></span>
<span id="cb773-7"><a href="statistics.html#cb773-7" tabindex="-1"></a>  <span class="co">#&#39; @param fl_sdlog float the sdlog parameter</span></span>
<span id="cb773-8"><a href="statistics.html#cb773-8" tabindex="-1"></a>  <span class="co">#&#39; @param fl_min_quantile float minimum quantile point (and 1 - max) to allow for selecting 0 and 1 for scalar_0t1</span></span>
<span id="cb773-9"><a href="statistics.html#cb773-9" tabindex="-1"></a>  </span>
<span id="cb773-10"><a href="statistics.html#cb773-10" tabindex="-1"></a>  <span class="co"># Draw randomly</span></span>
<span id="cb773-11"><a href="statistics.html#cb773-11" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_rand_seed)</span>
<span id="cb773-12"><a href="statistics.html#cb773-12" tabindex="-1"></a>  fl_draw_znorm <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb773-13"><a href="statistics.html#cb773-13" tabindex="-1"></a>  <span class="co"># logn value at quantile</span></span>
<span id="cb773-14"><a href="statistics.html#cb773-14" tabindex="-1"></a>  scaler_0t1 <span class="ot">&lt;-</span> scaler_0t1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_min_quantile<span class="sc">*</span><span class="dv">2</span>) <span class="sc">+</span> fl_min_quantile</span>
<span id="cb773-15"><a href="statistics.html#cb773-15" tabindex="-1"></a>  logn_coef_of_var <span class="ot">&lt;-</span> <span class="fu">qlnorm</span>(<span class="dv">1</span><span class="sc">-</span>scaler_0t1, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb773-16"><a href="statistics.html#cb773-16" tabindex="-1"></a>  <span class="co"># Coefficient of variation</span></span>
<span id="cb773-17"><a href="statistics.html#cb773-17" tabindex="-1"></a>  ar_logn_sd <span class="ot">&lt;-</span> param_original<span class="sc">/</span>logn_coef_of_var</span>
<span id="cb773-18"><a href="statistics.html#cb773-18" tabindex="-1"></a>  <span class="co"># Invert z-score</span></span>
<span id="cb773-19"><a href="statistics.html#cb773-19" tabindex="-1"></a>  param_perturbed <span class="ot">&lt;-</span> fl_draw_znorm <span class="sc">*</span> ar_logn_sd <span class="sc">+</span> param_original</span>
<span id="cb773-20"><a href="statistics.html#cb773-20" tabindex="-1"></a></span>
<span id="cb773-21"><a href="statistics.html#cb773-21" tabindex="-1"></a>  <span class="fu">return</span>(param_perturbed)</span>
<span id="cb773-22"><a href="statistics.html#cb773-22" tabindex="-1"></a>}</span></code></pre></div>
<p>Test the function with differently randomly drawn parameters, and visualize.</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="statistics.html#cb774-1" tabindex="-1"></a><span class="co"># Start image</span></span>
<span id="cb774-2"><a href="statistics.html#cb774-2" tabindex="-1"></a><span class="co"># Loop over different scalars</span></span>
<span id="cb774-3"><a href="statistics.html#cb774-3" tabindex="-1"></a>param_original <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb774-4"><a href="statistics.html#cb774-4" tabindex="-1"></a>ar_scaler_0t1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>)</span>
<span id="cb774-5"><a href="statistics.html#cb774-5" tabindex="-1"></a>ar_color_strs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb774-6"><a href="statistics.html#cb774-6" tabindex="-1"></a>it_scalar_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb774-7"><a href="statistics.html#cb774-7" tabindex="-1"></a><span class="cf">for</span> (scaler_0t1 <span class="cf">in</span> ar_scaler_0t1) {</span>
<span id="cb774-8"><a href="statistics.html#cb774-8" tabindex="-1"></a>  it_scalar_ctr <span class="ot">&lt;-</span> it_scalar_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb774-9"><a href="statistics.html#cb774-9" tabindex="-1"></a></span>
<span id="cb774-10"><a href="statistics.html#cb774-10" tabindex="-1"></a>  <span class="co"># Generate differently perturbed parameters</span></span>
<span id="cb774-11"><a href="statistics.html#cb774-11" tabindex="-1"></a>  ar_param_perturbed <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb774-12"><a href="statistics.html#cb774-12" tabindex="-1"></a>  <span class="cf">for</span> (it_rand_seed <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)) {</span>
<span id="cb774-13"><a href="statistics.html#cb774-13" tabindex="-1"></a>    param_perturbed <span class="ot">&lt;-</span> <span class="fu">ffi_param_logn_perturber</span>(</span>
<span id="cb774-14"><a href="statistics.html#cb774-14" tabindex="-1"></a>      param_original, scaler_0t1, <span class="at">it_rand_seed=</span>it_rand_seed)</span>
<span id="cb774-15"><a href="statistics.html#cb774-15" tabindex="-1"></a>    ar_param_perturbed <span class="ot">&lt;-</span> <span class="fu">c</span>(ar_param_perturbed, param_perturbed)</span>
<span id="cb774-16"><a href="statistics.html#cb774-16" tabindex="-1"></a>  }</span>
<span id="cb774-17"><a href="statistics.html#cb774-17" tabindex="-1"></a></span>
<span id="cb774-18"><a href="statistics.html#cb774-18" tabindex="-1"></a>  <span class="co"># Line through origin</span></span>
<span id="cb774-19"><a href="statistics.html#cb774-19" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb774-20"><a href="statistics.html#cb774-20" tabindex="-1"></a>  <span class="fu">hist</span>(ar_param_perturbed, <span class="at">col =</span> ar_color_strs[it_scalar_ctr], </span>
<span id="cb774-21"><a href="statistics.html#cb774-21" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb774-22"><a href="statistics.html#cb774-22" tabindex="-1"></a>  <span class="co"># Original parameter line</span></span>
<span id="cb774-23"><a href="statistics.html#cb774-23" tabindex="-1"></a>  <span class="fu">abline</span>(</span>
<span id="cb774-24"><a href="statistics.html#cb774-24" tabindex="-1"></a>    <span class="at">v =</span> param_original,</span>
<span id="cb774-25"><a href="statistics.html#cb774-25" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span></span>
<span id="cb774-26"><a href="statistics.html#cb774-26" tabindex="-1"></a>  )</span>
<span id="cb774-27"><a href="statistics.html#cb774-27" tabindex="-1"></a>  <span class="co"># Titles</span></span>
<span id="cb774-28"><a href="statistics.html#cb774-28" tabindex="-1"></a>  <span class="fu">title</span>(</span>
<span id="cb774-29"><a href="statistics.html#cb774-29" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb774-30"><a href="statistics.html#cb774-30" tabindex="-1"></a>      <span class="st">&quot;Randomly perturbing some parameter, original value red line</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb774-31"><a href="statistics.html#cb774-31" tabindex="-1"></a>      <span class="st">&quot;Log normal scalar ratio 0 to 1 = &quot;</span>, scaler_0t1</span>
<span id="cb774-32"><a href="statistics.html#cb774-32" tabindex="-1"></a>    ),</span>
<span id="cb774-33"><a href="statistics.html#cb774-33" tabindex="-1"></a>    <span class="at">sub =</span> <span class="fu">paste0</span>(</span>
<span id="cb774-34"><a href="statistics.html#cb774-34" tabindex="-1"></a>      <span class="st">&quot;Based on 1000 random draws&quot;</span></span>
<span id="cb774-35"><a href="statistics.html#cb774-35" tabindex="-1"></a>    ),</span>
<span id="cb774-36"><a href="statistics.html#cb774-36" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Perturbed values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb774-37"><a href="statistics.html#cb774-37" tabindex="-1"></a>  )</span>
<span id="cb774-38"><a href="statistics.html#cb774-38" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-391-1.png" width="672" style="display: block; margin: auto;" /><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-391-2.png" width="672" style="display: block; margin: auto;" /><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-391-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="distributions" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Distributions<a href="statistics.html#distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="integrate-over-normal-guassian-process-shock" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Integrate Over Normal Guassian Process Shock<a href="statistics.html#integrate-over-normal-guassian-process-shock" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>Some Common parameters</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="statistics.html#cb775-1" tabindex="-1"></a>fl_eps_mean <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb775-2"><a href="statistics.html#cb775-2" tabindex="-1"></a>fl_eps_sd <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb775-3"><a href="statistics.html#cb775-3" tabindex="-1"></a>fl_cdf_min <span class="ot">=</span> <span class="fl">0.000001</span></span>
<span id="cb775-4"><a href="statistics.html#cb775-4" tabindex="-1"></a>fl_cdf_max <span class="ot">=</span> <span class="fl">0.999999</span></span>
<span id="cb775-5"><a href="statistics.html#cb775-5" tabindex="-1"></a>ar_it_draws <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span></code></pre></div>
<div id="randomly-sample-and-integrate-monte-carlo-integration" class="section level4 hasAnchor" number="9.2.1.1">
<h4><span class="header-section-number">9.2.1.1</span> Randomly Sample and Integrate (Monte Carlo Integration)<a href="statistics.html#randomly-sample-and-integrate-monte-carlo-integration" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Compare randomly drawn normal shock mean and known mean. How does simulated mean change with draws. Actual integral equals to <span class="math inline">\(10\)</span>, as sample size increases, the sample mean approaches the integration results, but this is expensive, even with ten thousand draws, not very exact.</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="statistics.html#cb776-1" tabindex="-1"></a><span class="co"># Simulate Draws</span></span>
<span id="cb776-2"><a href="statistics.html#cb776-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb776-3"><a href="statistics.html#cb776-3" tabindex="-1"></a>ar_fl_means <span class="ot">&lt;-</span></span>
<span id="cb776-4"><a href="statistics.html#cb776-4" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb776-5"><a href="statistics.html#cb776-5" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">rnorm</span>(x[<span class="dv">1</span>], <span class="at">mean=</span>fl_eps_mean, <span class="at">sd=</span>fl_eps_sd))))</span>
<span id="cb776-6"><a href="statistics.html#cb776-6" tabindex="-1"></a>ar_fl_sd <span class="ot">&lt;-</span></span>
<span id="cb776-7"><a href="statistics.html#cb776-7" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x)</span>
<span id="cb776-8"><a href="statistics.html#cb776-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sd</span>(<span class="fu">rnorm</span>(x[<span class="dv">1</span>], <span class="at">mean=</span>fl_eps_mean, <span class="at">sd=</span>fl_eps_sd))))</span>
<span id="cb776-9"><a href="statistics.html#cb776-9" tabindex="-1"></a></span>
<span id="cb776-10"><a href="statistics.html#cb776-10" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, ar_fl_means, ar_fl_sd)</span>
<span id="cb776-11"><a href="statistics.html#cb776-11" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb776-12"><a href="statistics.html#cb776-12" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb776-13"><a href="statistics.html#cb776-13" tabindex="-1"></a></span>
<span id="cb776-14"><a href="statistics.html#cb776-14" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb776-15"><a href="statistics.html#cb776-15" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb776-16"><a href="statistics.html#cb776-16" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb776-17"><a href="statistics.html#cb776-17" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb776-18"><a href="statistics.html#cb776-18" tabindex="-1"></a></span>
<span id="cb776-19"><a href="statistics.html#cb776-19" tabindex="-1"></a><span class="co"># Shared Subtitle</span></span>
<span id="cb776-20"><a href="statistics.html#cb776-20" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb776-21"><a href="statistics.html#cb776-21" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/integration/htmlpdfr/fs_integrate_normal.html&#39;</span>)</span>
<span id="cb776-22"><a href="statistics.html#cb776-22" tabindex="-1"></a></span>
<span id="cb776-23"><a href="statistics.html#cb776-23" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb776-24"><a href="statistics.html#cb776-24" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Sample Size Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb776-25"><a href="statistics.html#cb776-25" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb776-26"><a href="statistics.html#cb776-26" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Size&#39;</span>)</span>
<span id="cb776-27"><a href="statistics.html#cb776-27" tabindex="-1"></a></span>
<span id="cb776-28"><a href="statistics.html#cb776-28" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb776-29"><a href="statistics.html#cb776-29" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb776-30"><a href="statistics.html#cb776-30" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb776-31"><a href="statistics.html#cb776-31" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb776-32"><a href="statistics.html#cb776-32" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Mean &#39;</span>, slb_title_shr),</span>
<span id="cb776-33"><a href="statistics.html#cb776-33" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb776-34"><a href="statistics.html#cb776-34" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb776-35"><a href="statistics.html#cb776-35" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sample Mean&#39;</span>,</span>
<span id="cb776-36"><a href="statistics.html#cb776-36" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Mean of Sample Integrates to True Mean&#39;</span>) <span class="sc">+</span></span>
<span id="cb776-37"><a href="statistics.html#cb776-37" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb776-38"><a href="statistics.html#cb776-38" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb776-39"><a href="statistics.html#cb776-39" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-394-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="statistics.html#cb777-1" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb777-2"><a href="statistics.html#cb777-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb777-3"><a href="statistics.html#cb777-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb777-4"><a href="statistics.html#cb777-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Sample Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb777-5"><a href="statistics.html#cb777-5" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb777-6"><a href="statistics.html#cb777-6" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb777-7"><a href="statistics.html#cb777-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sample Standard Deviation&#39;</span>,</span>
<span id="cb777-8"><a href="statistics.html#cb777-8" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Standard Deviation of Sample Integrates to True SD&#39;</span>) <span class="sc">+</span></span>
<span id="cb777-9"><a href="statistics.html#cb777-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb777-10"><a href="statistics.html#cb777-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb777-11"><a href="statistics.html#cb777-11" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-394-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-symmetric-uneven-rectangle" class="section level4 hasAnchor" number="9.2.1.2">
<h4><span class="header-section-number">9.2.1.2</span> Integration By Symmetric Uneven Rectangle<a href="statistics.html#integration-by-symmetric-uneven-rectangle" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Draw on even grid from close to 0 to close to 1. Get the corresponding x points to these quantile levels. Distance between x points are not equi-distance but increasing and symmetric away from the mean. Under this approach, each rectangle aims to approximate the same area.</p>
<p>Resulting integration is rectangle based, but rectangle width differ. The rectangles have wider width as they move away from the mean, and thinner width close to the mean. This is much more stable than the random draw method, but note that it converges somewhat slowly to true values as well.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="statistics.html#cb778-1" tabindex="-1"></a>mt_fl_means <span class="ot">&lt;-</span></span>
<span id="cb778-2"><a href="statistics.html#cb778-2" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb778-3"><a href="statistics.html#cb778-3" tabindex="-1"></a></span>
<span id="cb778-4"><a href="statistics.html#cb778-4" tabindex="-1"></a>    fl_prob_break <span class="ot">=</span> (fl_cdf_max <span class="sc">-</span> fl_cdf_min)<span class="sc">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb778-5"><a href="statistics.html#cb778-5" tabindex="-1"></a>    ar_eps_bounds <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">seq</span>(fl_cdf_min, fl_cdf_max,</span>
<span id="cb778-6"><a href="statistics.html#cb778-6" tabindex="-1"></a>                               <span class="at">by=</span>(fl_cdf_max <span class="sc">-</span> fl_cdf_min)<span class="sc">/</span>(x[<span class="dv">1</span>])),</span>
<span id="cb778-7"><a href="statistics.html#cb778-7" tabindex="-1"></a>                           <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb778-8"><a href="statistics.html#cb778-8" tabindex="-1"></a>    ar_eps_val <span class="ot">&lt;-</span> (<span class="fu">tail</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">head</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb778-9"><a href="statistics.html#cb778-9" tabindex="-1"></a>    ar_eps_prb <span class="ot">&lt;-</span> <span class="fu">rep</span>(fl_prob_break<span class="sc">/</span>(fl_cdf_max <span class="sc">-</span> fl_cdf_min), x[<span class="dv">1</span>])</span>
<span id="cb778-10"><a href="statistics.html#cb778-10" tabindex="-1"></a>    ar_eps_fev <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(ar_eps_val,</span>
<span id="cb778-11"><a href="statistics.html#cb778-11" tabindex="-1"></a>                        <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb778-12"><a href="statistics.html#cb778-12" tabindex="-1"></a></span>
<span id="cb778-13"><a href="statistics.html#cb778-13" tabindex="-1"></a>    fl_cdf_total_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds))</span>
<span id="cb778-14"><a href="statistics.html#cb778-14" tabindex="-1"></a>    fl_mean_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_val<span class="sc">*</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds)))</span>
<span id="cb778-15"><a href="statistics.html#cb778-15" tabindex="-1"></a>    fl_sd_approx <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((ar_eps_val<span class="sc">-</span>fl_mean_approx)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(ar_eps_fev<span class="sc">*</span><span class="fu">diff</span>(ar_eps_bounds))))</span>
<span id="cb778-16"><a href="statistics.html#cb778-16" tabindex="-1"></a></span>
<span id="cb778-17"><a href="statistics.html#cb778-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">cdf=</span>fl_cdf_total_approx, <span class="at">mean=</span>fl_mean_approx, <span class="at">sd=</span>fl_sd_approx))</span>
<span id="cb778-18"><a href="statistics.html#cb778-18" tabindex="-1"></a>  })</span>
<span id="cb778-19"><a href="statistics.html#cb778-19" tabindex="-1"></a></span>
<span id="cb778-20"><a href="statistics.html#cb778-20" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, <span class="fu">as_tibble</span>(<span class="fu">t</span>(mt_fl_means)) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>())</span>
<span id="cb778-21"><a href="statistics.html#cb778-21" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb778-22"><a href="statistics.html#cb778-22" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb778-23"><a href="statistics.html#cb778-23" tabindex="-1"></a></span>
<span id="cb778-24"><a href="statistics.html#cb778-24" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb778-25"><a href="statistics.html#cb778-25" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb778-26"><a href="statistics.html#cb778-26" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb778-27"><a href="statistics.html#cb778-27" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb778-28"><a href="statistics.html#cb778-28" tabindex="-1"></a></span>
<span id="cb778-29"><a href="statistics.html#cb778-29" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb778-30"><a href="statistics.html#cb778-30" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Uneven Rectangle Count Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb778-31"><a href="statistics.html#cb778-31" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb778-32"><a href="statistics.html#cb778-32" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Number of Quantile Bins for Uneven Rectangles Approximation&#39;</span>)</span>
<span id="cb778-33"><a href="statistics.html#cb778-33" tabindex="-1"></a></span>
<span id="cb778-34"><a href="statistics.html#cb778-34" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb778-35"><a href="statistics.html#cb778-35" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb778-36"><a href="statistics.html#cb778-36" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb778-37"><a href="statistics.html#cb778-37" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb778-38"><a href="statistics.html#cb778-38" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb778-39"><a href="statistics.html#cb778-39" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb778-40"><a href="statistics.html#cb778-40" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb778-41"><a href="statistics.html#cb778-41" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Approximated Mean&#39;</span>,</span>
<span id="cb778-42"><a href="statistics.html#cb778-42" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb778-43"><a href="statistics.html#cb778-43" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb778-44"><a href="statistics.html#cb778-44" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb778-45"><a href="statistics.html#cb778-45" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-395-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="statistics.html#cb779-1" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb779-2"><a href="statistics.html#cb779-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb779-3"><a href="statistics.html#cb779-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb779-4"><a href="statistics.html#cb779-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb779-5"><a href="statistics.html#cb779-5" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb779-6"><a href="statistics.html#cb779-6" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb779-7"><a href="statistics.html#cb779-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Approximated Standard Deviation&#39;</span>,</span>
<span id="cb779-8"><a href="statistics.html#cb779-8" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb779-9"><a href="statistics.html#cb779-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb779-10"><a href="statistics.html#cb779-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb779-11"><a href="statistics.html#cb779-11" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-395-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="statistics.html#cb780-1" tabindex="-1"></a>plt_cdf <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb780-2"><a href="statistics.html#cb780-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>cdf)) <span class="sc">+</span></span>
<span id="cb780-3"><a href="statistics.html#cb780-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb780-4"><a href="statistics.html#cb780-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb780-5"><a href="statistics.html#cb780-5" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb780-6"><a href="statistics.html#cb780-6" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb780-7"><a href="statistics.html#cb780-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sum of Uneven Rectangles&#39;</span>,</span>
<span id="cb780-8"><a href="statistics.html#cb780-8" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Uneven Rectangle Count Increases&#39;</span>) <span class="sc">+</span></span>
<span id="cb780-9"><a href="statistics.html#cb780-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb780-10"><a href="statistics.html#cb780-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb780-11"><a href="statistics.html#cb780-11" tabindex="-1"></a><span class="fu">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-395-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="integration-by-constant-width-rectangle-trapezoidal-rule" class="section level4 hasAnchor" number="9.2.1.3">
<h4><span class="header-section-number">9.2.1.3</span> Integration By Constant Width Rectangle (Trapezoidal rule)<a href="statistics.html#integration-by-constant-width-rectangle-trapezoidal-rule" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is implementing even width recentagle, even along x-axix. Rectangle width are the same, height is <span class="math inline">\(f(x)\)</span>. This is even width, but uneven area. Note that this method approximates the true answer much better and more quickly than the prior methods.</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="statistics.html#cb781-1" tabindex="-1"></a>mt_fl_means <span class="ot">&lt;-</span></span>
<span id="cb781-2"><a href="statistics.html#cb781-2" tabindex="-1"></a>  <span class="fu">sapply</span>(ar_it_draws, <span class="cf">function</span>(x) {</span>
<span id="cb781-3"><a href="statistics.html#cb781-3" tabindex="-1"></a></span>
<span id="cb781-4"><a href="statistics.html#cb781-4" tabindex="-1"></a>    fl_eps_min <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(fl_cdf_min, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb781-5"><a href="statistics.html#cb781-5" tabindex="-1"></a>    fl_eps_max <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(fl_cdf_max, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)</span>
<span id="cb781-6"><a href="statistics.html#cb781-6" tabindex="-1"></a>    fl_gap <span class="ot">&lt;-</span> (fl_eps_max<span class="sc">-</span>fl_eps_min)<span class="sc">/</span>(x[<span class="dv">1</span>])</span>
<span id="cb781-7"><a href="statistics.html#cb781-7" tabindex="-1"></a>    ar_eps_bounds <span class="ot">&lt;-</span> <span class="fu">seq</span>(fl_eps_min, fl_eps_max, <span class="at">by=</span>fl_gap)</span>
<span id="cb781-8"><a href="statistics.html#cb781-8" tabindex="-1"></a>    ar_eps_val <span class="ot">&lt;-</span> (<span class="fu">tail</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">head</span>(ar_eps_bounds, <span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb781-9"><a href="statistics.html#cb781-9" tabindex="-1"></a>    ar_eps_prb <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(ar_eps_val, <span class="at">mean =</span> fl_eps_mean, <span class="at">sd =</span> fl_eps_sd)<span class="sc">*</span>fl_gap</span>
<span id="cb781-10"><a href="statistics.html#cb781-10" tabindex="-1"></a></span>
<span id="cb781-11"><a href="statistics.html#cb781-11" tabindex="-1"></a>    fl_cdf_total_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_prb)</span>
<span id="cb781-12"><a href="statistics.html#cb781-12" tabindex="-1"></a>    fl_mean_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_eps_val<span class="sc">*</span>ar_eps_prb)</span>
<span id="cb781-13"><a href="statistics.html#cb781-13" tabindex="-1"></a>    fl_sd_approx <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((ar_eps_val<span class="sc">-</span>fl_mean_approx)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>ar_eps_prb))</span>
<span id="cb781-14"><a href="statistics.html#cb781-14" tabindex="-1"></a></span>
<span id="cb781-15"><a href="statistics.html#cb781-15" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">cdf=</span>fl_cdf_total_approx, <span class="at">mean=</span>fl_mean_approx, <span class="at">sd=</span>fl_sd_approx))</span>
<span id="cb781-16"><a href="statistics.html#cb781-16" tabindex="-1"></a>  })</span>
<span id="cb781-17"><a href="statistics.html#cb781-17" tabindex="-1"></a></span>
<span id="cb781-18"><a href="statistics.html#cb781-18" tabindex="-1"></a>mt_sample_means <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_it_draws, <span class="fu">as_tibble</span>(<span class="fu">t</span>(mt_fl_means)) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>())</span>
<span id="cb781-19"><a href="statistics.html#cb781-19" tabindex="-1"></a><span class="fu">colnames</span>(mt_sample_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;draw_count&#39;</span>, <span class="st">&#39;cdf&#39;</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>)</span>
<span id="cb781-20"><a href="statistics.html#cb781-20" tabindex="-1"></a>tb_sample_means <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_sample_means)</span>
<span id="cb781-21"><a href="statistics.html#cb781-21" tabindex="-1"></a></span>
<span id="cb781-22"><a href="statistics.html#cb781-22" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb781-23"><a href="statistics.html#cb781-23" tabindex="-1"></a><span class="co"># x-labels</span></span>
<span id="cb781-24"><a href="statistics.html#cb781-24" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;n=1&#39;</span>, <span class="st">&#39;n=10&#39;</span>, <span class="st">&#39;n=100&#39;</span>, <span class="st">&#39;n=1000&#39;</span>)</span>
<span id="cb781-25"><a href="statistics.html#cb781-25" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb781-26"><a href="statistics.html#cb781-26" tabindex="-1"></a></span>
<span id="cb781-27"><a href="statistics.html#cb781-27" tabindex="-1"></a><span class="co"># Shared Labels</span></span>
<span id="cb781-28"><a href="statistics.html#cb781-28" tabindex="-1"></a>slb_title_shr <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;as Even Rectangle Count Increases</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb781-29"><a href="statistics.html#cb781-29" tabindex="-1"></a>                       <span class="st">&#39;True Mean=&#39;</span>, fl_eps_mean,<span class="st">&#39;, sd=&#39;</span>,fl_eps_sd)</span>
<span id="cb781-30"><a href="statistics.html#cb781-30" tabindex="-1"></a>slb_xtitle <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Number Equi-distance Rectangles Bins&#39;</span>)</span>
<span id="cb781-31"><a href="statistics.html#cb781-31" tabindex="-1"></a></span>
<span id="cb781-32"><a href="statistics.html#cb781-32" tabindex="-1"></a><span class="co"># Graph Results--Draw</span></span>
<span id="cb781-33"><a href="statistics.html#cb781-33" tabindex="-1"></a>plt_mean <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb781-34"><a href="statistics.html#cb781-34" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb781-35"><a href="statistics.html#cb781-35" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb781-36"><a href="statistics.html#cb781-36" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Average &#39;</span>, slb_title_shr),</span>
<span id="cb781-37"><a href="statistics.html#cb781-37" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb781-38"><a href="statistics.html#cb781-38" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb781-39"><a href="statistics.html#cb781-39" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Integrated Mean&#39;</span>,</span>
<span id="cb781-40"><a href="statistics.html#cb781-40" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb781-41"><a href="statistics.html#cb781-41" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb781-42"><a href="statistics.html#cb781-42" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb781-43"><a href="statistics.html#cb781-43" tabindex="-1"></a><span class="fu">print</span>(plt_mean)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-396-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="statistics.html#cb782-1" tabindex="-1"></a>plt_sd <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb782-2"><a href="statistics.html#cb782-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb782-3"><a href="statistics.html#cb782-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb782-4"><a href="statistics.html#cb782-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Standard Deviation &#39;</span>, slb_title_shr),</span>
<span id="cb782-5"><a href="statistics.html#cb782-5" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb782-6"><a href="statistics.html#cb782-6" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb782-7"><a href="statistics.html#cb782-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Standard Deviation&#39;</span>,</span>
<span id="cb782-8"><a href="statistics.html#cb782-8" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Integral Approximation as Even Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb782-9"><a href="statistics.html#cb782-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb782-10"><a href="statistics.html#cb782-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb782-11"><a href="statistics.html#cb782-11" tabindex="-1"></a><span class="fu">print</span>(plt_sd)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-396-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="statistics.html#cb783-1" tabindex="-1"></a>plt_cdf <span class="ot">&lt;-</span> tb_sample_means <span class="sc">%&gt;%</span></span>
<span id="cb783-2"><a href="statistics.html#cb783-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draw_count, <span class="at">y=</span>cdf)) <span class="sc">+</span></span>
<span id="cb783-3"><a href="statistics.html#cb783-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb783-4"><a href="statistics.html#cb783-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&#39;Aggregate Probability &#39;</span>, slb_title_shr),</span>
<span id="cb783-5"><a href="statistics.html#cb783-5" tabindex="-1"></a>       <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb783-6"><a href="statistics.html#cb783-6" tabindex="-1"></a>       <span class="at">x =</span> slb_xtitle,</span>
<span id="cb783-7"><a href="statistics.html#cb783-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Sum of Equi-Dist Rectangles&#39;</span>,</span>
<span id="cb783-8"><a href="statistics.html#cb783-8" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Sum of Approx. Probability as Equi-Dist Rectangle width decreases&#39;</span>) <span class="sc">+</span></span>
<span id="cb783-9"><a href="statistics.html#cb783-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>, <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks) <span class="sc">+</span></span>
<span id="cb783-10"><a href="statistics.html#cb783-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb783-11"><a href="statistics.html#cb783-11" tabindex="-1"></a><span class="fu">print</span>(plt_cdf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-396-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="discrete-random-variable" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Discrete Random Variable<a href="statistics.html#discrete-random-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="discrete-approximation-of-continuous-random-variables" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Discrete Approximation of Continuous Random Variables<a href="statistics.html#discrete-approximation-of-continuous-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="use-binomial-discrete-random-variable-to-approximate-continuous-normal" class="section level4 hasAnchor" number="9.3.1.1">
<h4><span class="header-section-number">9.3.1.1</span> Use Binomial Discrete Random Variable to Approximate Continuous Normal<a href="statistics.html#use-binomial-discrete-random-variable-to-approximate-continuous-normal" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, draw from a Continuous Random Variable. Sample <span class="math inline">\(N\)</span> draws from a normal random variable.</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="statistics.html#cb784-1" tabindex="-1"></a><span class="co"># Random normal Data Vector (not equal outcomes)</span></span>
<span id="cb784-2"><a href="statistics.html#cb784-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb784-3"><a href="statistics.html#cb784-3" tabindex="-1"></a>it_sample_N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb784-4"><a href="statistics.html#cb784-4" tabindex="-1"></a>fl_rnorm_mean <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb784-5"><a href="statistics.html#cb784-5" tabindex="-1"></a>fl_rnorm_sd <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb784-6"><a href="statistics.html#cb784-6" tabindex="-1"></a>ar_data_rnorm <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(it_sample_N, <span class="at">mean =</span> fl_rnorm_mean, <span class="at">sd =</span> fl_rnorm_sd)</span>
<span id="cb784-7"><a href="statistics.html#cb784-7" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb784-8"><a href="statistics.html#cb784-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb784-9"><a href="statistics.html#cb784-9" tabindex="-1"></a><span class="fu">hist</span>(ar_data_rnorm, <span class="at">xlab =</span> <span class="st">&quot;x Values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Frequencies&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb784-10"><a href="statistics.html#cb784-10" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;Continuous Normal Random Variable Draws&quot;</span>)</span>
<span id="cb784-11"><a href="statistics.html#cb784-11" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-398-1.png" width="672" style="display: block; margin: auto;" />
We use the <a href="https://en.wikipedia.org/wiki/Binomial_distribution">binomial to approximate the normal distribution</a>. Let <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> be the mean and standard deviations of the normal random variable, and <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> be the number of “trials” and the “probability-of-success” for the binomial distribution. We know that these relationships are approximately true, :</p>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;= n\cdot p\\
n &amp;= \frac{\mu}{p}\\
\sigma^2 &amp;= n\cdot p\cdot(1-p) = \mu\cdot(1-p)\\
\end{aligned}
\]</span></p>
<p>Given these, we have can translate between the normal random variable’s parameters and the binomial discrete random variable’s parameters:</p>
<p><span class="math display">\[
\begin{aligned}
p &amp;= 1 - \frac{\sigma^2}{\mu}\\
n &amp;= \frac{\mu}{1 - \frac{\sigma^2}{\mu}} = \frac{\mu}{\frac{\mu - \sigma^2}{\mu}} = \frac{\mu^2}{\mu - \sigma^2}
\end{aligned}
\]</span></p>
<p>There are two important aspects to note here:</p>
<ol style="list-style-type: decimal">
<li>Since <span class="math inline">\(p\)</span> must be positive, this means <span class="math inline">\(\frac{\sigma^2}{\mu}&lt;1\)</span> and <span class="math inline">\(\sigma^2&lt;\mu\)</span>, which is the condition for the above transformation to work.</li>
<li>The binomial discrete random variable will have non-zero mass for very small probability events at the left-tail. These very low outcome events are highly unlikely to be observed or drawn from sampling the continuous random variable. The presence of these left-tail values might impact the computation of certain statistics, for example the <a href="https://fanwangecon.github.io/R4Econ/math/func_ineq/htmlpdfr/fs_atkinson_ces.html">Atkinson Index for highly inequality averse planners</a>.</li>
</ol>
<p>Create a function for converting between normal and binomial parameters:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="statistics.html#cb785-1" tabindex="-1"></a>ffi_binom_approx_nomr <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_rnorm_mean, fl_rnorm_sd) {</span>
<span id="cb785-2"><a href="statistics.html#cb785-2" tabindex="-1"></a>  <span class="co">#&#39; @param fl_rnorm_mean float normal mean</span></span>
<span id="cb785-3"><a href="statistics.html#cb785-3" tabindex="-1"></a>  <span class="co">#&#39; @param fl_rnorm_sd float normal standard deviation</span></span>
<span id="cb785-4"><a href="statistics.html#cb785-4" tabindex="-1"></a>  <span class="cf">if</span> (fl_rnorm_mean <span class="sc">&lt;=</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span>) {</span>
<span id="cb785-5"><a href="statistics.html#cb785-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Normal mean must be larger than the variance for conversion&quot;</span>)</span>
<span id="cb785-6"><a href="statistics.html#cb785-6" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb785-7"><a href="statistics.html#cb785-7" tabindex="-1"></a>    <span class="co"># Use binomial to approximate normal</span></span>
<span id="cb785-8"><a href="statistics.html#cb785-8" tabindex="-1"></a>    fl_p_binom <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> fl_rnorm_mean</span>
<span id="cb785-9"><a href="statistics.html#cb785-9" tabindex="-1"></a>    fl_n_binom <span class="ot">&lt;-</span> <span class="fu">round</span>(fl_rnorm_mean<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (fl_rnorm_mean <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb785-10"><a href="statistics.html#cb785-10" tabindex="-1"></a>    fl_binom_mean <span class="ot">&lt;-</span> fl_n_binom <span class="sc">*</span> fl_p_binom</span>
<span id="cb785-11"><a href="statistics.html#cb785-11" tabindex="-1"></a>    fl_binom_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(fl_n_binom <span class="sc">*</span> fl_p_binom <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fl_p_binom))</span>
<span id="cb785-12"><a href="statistics.html#cb785-12" tabindex="-1"></a>    <span class="co"># return</span></span>
<span id="cb785-13"><a href="statistics.html#cb785-13" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb785-14"><a href="statistics.html#cb785-14" tabindex="-1"></a>      <span class="at">fl_p_binom =</span> fl_p_binom, <span class="at">fl_n_binom =</span> fl_n_binom,</span>
<span id="cb785-15"><a href="statistics.html#cb785-15" tabindex="-1"></a>      <span class="at">fl_binom_mean =</span> fl_binom_mean, <span class="at">fl_binom_sd =</span> fl_binom_sd</span>
<span id="cb785-16"><a href="statistics.html#cb785-16" tabindex="-1"></a>    ))</span>
<span id="cb785-17"><a href="statistics.html#cb785-17" tabindex="-1"></a>  }</span>
<span id="cb785-18"><a href="statistics.html#cb785-18" tabindex="-1"></a>}</span></code></pre></div>
<p>Call the function to generate binomial parameters and generate the resulting binomial discrete random variable:</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="statistics.html#cb786-1" tabindex="-1"></a><span class="co"># with these parameters, does not work</span></span>
<span id="cb786-2"><a href="statistics.html#cb786-2" tabindex="-1"></a><span class="co"># ls_binom_params &lt;- ffi_binom_approx_nomr(fl_rnorm_mean = 10, fl_rnorm_sd = 3)</span></span>
<span id="cb786-3"><a href="statistics.html#cb786-3" tabindex="-1"></a><span class="co"># Call function with parameters, defined earlier</span></span>
<span id="cb786-4"><a href="statistics.html#cb786-4" tabindex="-1"></a>ls_binom_params <span class="ot">&lt;-</span> <span class="fu">ffi_binom_approx_nomr</span>(fl_rnorm_mean, fl_rnorm_sd)</span>
<span id="cb786-5"><a href="statistics.html#cb786-5" tabindex="-1"></a>fl_binom_mean <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_binom_mean</span>
<span id="cb786-6"><a href="statistics.html#cb786-6" tabindex="-1"></a>fl_binom_sd <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_binom_sd</span>
<span id="cb786-7"><a href="statistics.html#cb786-7" tabindex="-1"></a>fl_n_binom <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_n_binom</span>
<span id="cb786-8"><a href="statistics.html#cb786-8" tabindex="-1"></a>fl_p_binom <span class="ot">&lt;-</span> ls_binom_params<span class="sc">$</span>fl_p_binom</span>
<span id="cb786-9"><a href="statistics.html#cb786-9" tabindex="-1"></a><span class="co"># Mean and sd, note that these are the same as values defined earlier</span></span>
<span id="cb786-10"><a href="statistics.html#cb786-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;BINOMI mean=&quot;</span>, </span>
<span id="cb786-11"><a href="statistics.html#cb786-11" tabindex="-1"></a>             ls_binom_params<span class="sc">$</span>fl_binom_mean,</span>
<span id="cb786-12"><a href="statistics.html#cb786-12" tabindex="-1"></a>             <span class="st">&quot;, fl_rnorm_mean=&quot;</span>, </span>
<span id="cb786-13"><a href="statistics.html#cb786-13" tabindex="-1"></a>             fl_rnorm_mean))</span></code></pre></div>
<pre><code>## [1] &quot;BINOMI mean=99.84, fl_rnorm_mean=100&quot;</code></pre>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="statistics.html#cb788-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;BINOMI sd=&quot;</span>, ls_binom_params<span class="sc">$</span>fl_binom_sd,</span>
<span id="cb788-2"><a href="statistics.html#cb788-2" tabindex="-1"></a>             <span class="st">&quot;, fl_binom_sd=&quot;</span>, fl_binom_sd))</span></code></pre></div>
<pre><code>## [1] &quot;BINOMI sd=5.99519807846246, fl_binom_sd=5.99519807846246&quot;</code></pre>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="statistics.html#cb790-1" tabindex="-1"></a><span class="co"># drv = discrete random variable</span></span>
<span id="cb790-2"><a href="statistics.html#cb790-2" tabindex="-1"></a>ar_drv_rbinom_xval <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, fl_n_binom)</span>
<span id="cb790-3"><a href="statistics.html#cb790-3" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_drv_rbinom_xval,</span>
<span id="cb790-4"><a href="statistics.html#cb790-4" tabindex="-1"></a>  <span class="at">size =</span> fl_n_binom, <span class="at">prob =</span> fl_p_binom</span>
<span id="cb790-5"><a href="statistics.html#cb790-5" tabindex="-1"></a>)</span>
<span id="cb790-6"><a href="statistics.html#cb790-6" tabindex="-1"></a><span class="co"># ignore weight at x=0</span></span>
<span id="cb790-7"><a href="statistics.html#cb790-7" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> ar_drv_rbinom_prob <span class="sc">/</span> <span class="fu">sum</span>(ar_drv_rbinom_prob)</span></code></pre></div>
<p>Visualize the binomial discrete random variable:</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="statistics.html#cb791-1" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb791-2"><a href="statistics.html#cb791-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb791-3"><a href="statistics.html#cb791-3" tabindex="-1"></a>ar_ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb791-4"><a href="statistics.html#cb791-4" tabindex="-1"></a><span class="fu">plot</span>(ar_drv_rbinom_xval, ar_drv_rbinom_prob,</span>
<span id="cb791-5"><a href="statistics.html#cb791-5" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Binomial x Values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Discrete Probabilitys, P(x)&quot;</span></span>
<span id="cb791-6"><a href="statistics.html#cb791-6" tabindex="-1"></a>)</span>
<span id="cb791-7"><a href="statistics.html#cb791-7" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb791-8"><a href="statistics.html#cb791-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Binomial Approximate of Normal Random Variable&quot;</span>),</span>
<span id="cb791-9"><a href="statistics.html#cb791-9" tabindex="-1"></a>  <span class="at">sub =</span> <span class="fu">paste0</span>(</span>
<span id="cb791-10"><a href="statistics.html#cb791-10" tabindex="-1"></a>    <span class="st">&quot;binop=&quot;</span>, <span class="fu">round</span>(fl_p_binom, <span class="dv">2</span>),</span>
<span id="cb791-11"><a href="statistics.html#cb791-11" tabindex="-1"></a>    <span class="st">&quot;;binon=&quot;</span>, <span class="fu">round</span>(fl_n_binom, <span class="dv">2</span>),</span>
<span id="cb791-12"><a href="statistics.html#cb791-12" tabindex="-1"></a>    <span class="st">&quot;;binomean=&quot;</span>, <span class="fu">round</span>(fl_binom_mean, <span class="dv">2</span>),</span>
<span id="cb791-13"><a href="statistics.html#cb791-13" tabindex="-1"></a>    <span class="st">&quot;;binomsd=&quot;</span>, <span class="fu">round</span>(fl_binom_sd, <span class="dv">2</span>),</span>
<span id="cb791-14"><a href="statistics.html#cb791-14" tabindex="-1"></a>    <span class="st">&quot;;normmean=&quot;</span>, <span class="fu">round</span>(fl_rnorm_mean, <span class="dv">2</span>), <span class="st">&quot;;normsd=&quot;</span>, <span class="fu">round</span>(fl_rnorm_sd, <span class="dv">2</span>)</span>
<span id="cb791-15"><a href="statistics.html#cb791-15" tabindex="-1"></a>  )</span>
<span id="cb791-16"><a href="statistics.html#cb791-16" tabindex="-1"></a>)</span>
<span id="cb791-17"><a href="statistics.html#cb791-17" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-401-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mathematics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tables-and-graphs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
