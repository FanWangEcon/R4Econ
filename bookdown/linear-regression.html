<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Linear Regression | Panel Data and Optimization with R</title>
  <meta name="description" content="<p>Find all files in a folder with a particula suffix, with exclusion.
Convert R Markdow File to R, PDF and HTML.
Modify markdown pounds hierarchy.</p>" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Linear Regression | Panel Data and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>Find all files in a folder with a particula suffix, with exclusion.
Convert R Markdow File to R, PDF and HTML.
Modify markdown pounds hierarchy.</p>" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Linear Regression | Panel Data and Optimization with R" />
  
  <meta name="twitter:description" content="<p>Find all files in a folder with a particula suffix, with exclusion.
Convert R Markdow File to R, PDF and HTML.
Modify markdown pounds hierarchy.</p>" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2020-05-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="panel.html"/>
<link rel="next" href="nonlinear-regression.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Panel Data and Optimization with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#multiple-dimensional-list"><i class="fa fa-check"></i><b>1.1.1</b> Multiple Dimensional List</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-values"><i class="fa fa-check"></i><b>1.4.5</b> String Values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.1</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.2</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.3</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>4</b> Panel</a>
<ul>
<li class="chapter" data-level="4.1" data-path="panel.html"><a href="panel.html#generate-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="panel.html"><a href="panel.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="panel.html"><a href="panel.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="panel.html"><a href="panel.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="panel.html"><a href="panel.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="panel.html"><a href="panel.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.1</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.1.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.1.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.2</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.2.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>6</b> Nonlinear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html"><i class="fa fa-check"></i><b>8</b> Mathmatics and Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#distributions"><i class="fa fa-check"></i><b>8.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>8.1.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#analytical-solutions"><i class="fa fa-check"></i><b>8.2</b> Analytical Solutions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.2.1</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> Gini Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathmatics-and-statistics.html"><a href="mathmatics-and-statistics.html#atkinson-family-utility"><i class="fa fa-check"></i><b>8.3.2</b> Atkinson Family Utility</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>9</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>9.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>9.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>9.2</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>9.2.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>10</b> Programming</a>
<ul>
<li class="chapter" data-level="10.1" data-path="programming.html"><a href="programming.html#file-in-and-out"><i class="fa fa-check"></i><b>10.1</b> File in and Out</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="programming.html"><a href="programming.html#text-to-file"><i class="fa fa-check"></i><b>10.1.1</b> Text to File</a></li>
<li class="chapter" data-level="10.1.2" data-path="programming.html"><a href="programming.html#rmd-to-html"><i class="fa fa-check"></i><b>10.1.2</b> Rmd to HTML</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#panel-links"><i class="fa fa-check"></i><b>A.4</b> Panel links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-and-joingenerate-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-regression-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear Regression links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathmatics-and-statistics-links"><i class="fa fa-check"></i><b>A.8</b> Mathmatics and Statistics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Distributions</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-analytical-solutionsanalytical-solutions-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Analytical Solutions</span> links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> <span>Section 8.3 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.9</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.9.2</b> <span>Section 9.2 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#programming-links"><i class="fa fa-check"></i><b>A.10</b> Programming links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-file-in-and-outfile-in-and-out-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 File in and Out</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Panel Data and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Linear Regression</h1>

<div id="ols-and-iv" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> OLS and IV</h2>

<p>Back to <strong><a href="https://fanwangecon.github.io/">Fan</a></strong>’s R4Econ Homepage <strong><a href="https://fanwangecon.github.io/R4Econ/">Table of Content</a></strong></p>
<div id="ols-and-iv-regression" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> OLS and IV Regression</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>IV regression using AER package. Option to store all results in dataframe row for combining results from other estimations together. Produce Row Statistics.</p>
<div id="construct-program" class="section level4" number="5.1.1.1">
<h4><span class="header-section-number">5.1.1.1</span> Construct Program</h4>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="linear-regression.html#cb273-1"></a><span class="co"># IV regression function</span></span>
<span id="cb273-2"><a href="linear-regression.html#cb273-2"></a><span class="co"># The code below uses the AER library&#39;s regresison function</span></span>
<span id="cb273-3"><a href="linear-regression.html#cb273-3"></a><span class="co"># All results are stored in a single row as data_frame</span></span>
<span id="cb273-4"><a href="linear-regression.html#cb273-4"></a><span class="co"># This functoin could work with dplyr do</span></span>
<span id="cb273-5"><a href="linear-regression.html#cb273-5"></a><span class="co"># var.y is single outcome, vars.x, vars.c and vars.z are vectors of endogenous variables, controls and instruments.</span></span>
<span id="cb273-6"><a href="linear-regression.html#cb273-6"></a>regf.iv &lt;-<span class="st"> </span><span class="cf">function</span>(var.y, vars.x, </span>
<span id="cb273-7"><a href="linear-regression.html#cb273-7"></a>                    vars.c, vars.z, df, <span class="dt">transpose=</span><span class="ot">TRUE</span>) {</span>
<span id="cb273-8"><a href="linear-regression.html#cb273-8"></a>  </span>
<span id="cb273-9"><a href="linear-regression.html#cb273-9"></a>  <span class="co"># A. Set-Up Equation</span></span>
<span id="cb273-10"><a href="linear-regression.html#cb273-10"></a>  str.vars.x &lt;-<span class="st"> </span><span class="kw">paste</span>(vars.x, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb273-11"><a href="linear-regression.html#cb273-11"></a>  str.vars.c &lt;-<span class="st"> </span><span class="kw">paste</span>(vars.c, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb273-12"><a href="linear-regression.html#cb273-12"></a>  </span>
<span id="cb273-13"><a href="linear-regression.html#cb273-13"></a>  df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb273-14"><a href="linear-regression.html#cb273-14"></a><span class="st">    </span><span class="kw">select</span>(<span class="kw">one_of</span>(var.y, vars.x, vars.c, vars.z)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb273-15"><a href="linear-regression.html#cb273-15"></a><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter_all</span>(<span class="kw">all_vars</span>(<span class="op">!</span><span class="kw">is.infinite</span>(.)))</span>
<span id="cb273-16"><a href="linear-regression.html#cb273-16"></a>  </span>
<span id="cb273-17"><a href="linear-regression.html#cb273-17"></a>  <span class="cf">if</span> (<span class="kw">length</span>(vars.z) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb273-18"><a href="linear-regression.html#cb273-18"></a>    <span class="co">#     library(AER)</span></span>
<span id="cb273-19"><a href="linear-regression.html#cb273-19"></a>    str.vars.z &lt;-<span class="st"> </span><span class="kw">paste</span>(vars.z, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb273-20"><a href="linear-regression.html#cb273-20"></a>    equa.iv &lt;-<span class="st"> </span><span class="kw">paste</span>(var.y,</span>
<span id="cb273-21"><a href="linear-regression.html#cb273-21"></a>                     <span class="kw">paste</span>(<span class="kw">paste</span>(str.vars.x, str.vars.c, <span class="dt">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb273-22"><a href="linear-regression.html#cb273-22"></a>                           <span class="kw">paste</span>(str.vars.z, str.vars.c, <span class="dt">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb273-23"><a href="linear-regression.html#cb273-23"></a>                           <span class="dt">sep=</span><span class="st">&#39;|&#39;</span>),</span>
<span id="cb273-24"><a href="linear-regression.html#cb273-24"></a>                     <span class="dt">sep=</span><span class="st">&#39;~&#39;</span>)</span>
<span id="cb273-25"><a href="linear-regression.html#cb273-25"></a>    <span class="co">#     print(equa.iv)</span></span>
<span id="cb273-26"><a href="linear-regression.html#cb273-26"></a>    </span>
<span id="cb273-27"><a href="linear-regression.html#cb273-27"></a>    <span class="co"># B. IV Regression</span></span>
<span id="cb273-28"><a href="linear-regression.html#cb273-28"></a>    ivreg.summ &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">ivreg</span>(<span class="kw">as.formula</span>(equa.iv), <span class="dt">data=</span>df),</span>
<span id="cb273-29"><a href="linear-regression.html#cb273-29"></a>                          <span class="dt">vcov =</span> sandwich, <span class="dt">df =</span> <span class="ot">Inf</span>, <span class="dt">diagnostics =</span> <span class="ot">TRUE</span>)</span>
<span id="cb273-30"><a href="linear-regression.html#cb273-30"></a>    </span>
<span id="cb273-31"><a href="linear-regression.html#cb273-31"></a>    <span class="co"># C. Statistics from IV Regression</span></span>
<span id="cb273-32"><a href="linear-regression.html#cb273-32"></a>    <span class="co">#     ivreg.summ$coef</span></span>
<span id="cb273-33"><a href="linear-regression.html#cb273-33"></a>    <span class="co">#     ivreg.summ$diagnostics</span></span>
<span id="cb273-34"><a href="linear-regression.html#cb273-34"></a>    </span>
<span id="cb273-35"><a href="linear-regression.html#cb273-35"></a>    <span class="co"># D. Combine Regression Results into a Matrix</span></span>
<span id="cb273-36"><a href="linear-regression.html#cb273-36"></a>    df.results &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb273-37"><a href="linear-regression.html#cb273-37"></a>      <span class="kw">as_tibble</span>(ivreg.summ<span class="op">$</span>coef, <span class="dt">rownames=</span><span class="st">&#39;rownames&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb273-38"><a href="linear-regression.html#cb273-38"></a><span class="st">        </span><span class="kw">full_join</span>(<span class="kw">as_tibble</span>(ivreg.summ<span class="op">$</span>diagnostics, <span class="dt">rownames=</span><span class="st">&#39;rownames&#39;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb273-39"><a href="linear-regression.html#cb273-39"></a><span class="st">        </span><span class="kw">full_join</span>(<span class="kw">tibble</span>(<span class="dt">rownames=</span><span class="kw">c</span>(<span class="st">&#39;vars&#39;</span>),</span>
<span id="cb273-40"><a href="linear-regression.html#cb273-40"></a>                         <span class="dt">var.y=</span>var.y,</span>
<span id="cb273-41"><a href="linear-regression.html#cb273-41"></a>                         <span class="dt">vars.x=</span>str.vars.x,</span>
<span id="cb273-42"><a href="linear-regression.html#cb273-42"></a>                         <span class="dt">vars.z=</span>str.vars.z,</span>
<span id="cb273-43"><a href="linear-regression.html#cb273-43"></a>                         <span class="dt">vars.c=</span>str.vars.c))))</span>
<span id="cb273-44"><a href="linear-regression.html#cb273-44"></a>  } <span class="cf">else</span> {</span>
<span id="cb273-45"><a href="linear-regression.html#cb273-45"></a>    </span>
<span id="cb273-46"><a href="linear-regression.html#cb273-46"></a>    <span class="co"># OLS regression</span></span>
<span id="cb273-47"><a href="linear-regression.html#cb273-47"></a>    equa.ols &lt;-<span class="st"> </span><span class="kw">paste</span>(var.y,</span>
<span id="cb273-48"><a href="linear-regression.html#cb273-48"></a>                      <span class="kw">paste</span>(<span class="kw">paste</span>(vars.x, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb273-49"><a href="linear-regression.html#cb273-49"></a>                            <span class="kw">paste</span>(vars.c, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>), <span class="dt">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb273-50"><a href="linear-regression.html#cb273-50"></a>                      <span class="dt">sep=</span><span class="st">&#39;~&#39;</span>)</span>
<span id="cb273-51"><a href="linear-regression.html#cb273-51"></a>    </span>
<span id="cb273-52"><a href="linear-regression.html#cb273-52"></a>    lmreg.summ &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">as.formula</span>(equa.ols), <span class="dt">data=</span>df))</span>
<span id="cb273-53"><a href="linear-regression.html#cb273-53"></a>    </span>
<span id="cb273-54"><a href="linear-regression.html#cb273-54"></a>    lm.diagnostics &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(</span>
<span id="cb273-55"><a href="linear-regression.html#cb273-55"></a>      <span class="kw">list</span>(<span class="dt">df1=</span>lmreg.summ<span class="op">$</span>df[[<span class="dv">1</span>]],</span>
<span id="cb273-56"><a href="linear-regression.html#cb273-56"></a>           <span class="dt">df2=</span>lmreg.summ<span class="op">$</span>df[[<span class="dv">2</span>]],</span>
<span id="cb273-57"><a href="linear-regression.html#cb273-57"></a>           <span class="dt">df3=</span>lmreg.summ<span class="op">$</span>df[[<span class="dv">3</span>]],</span>
<span id="cb273-58"><a href="linear-regression.html#cb273-58"></a>           <span class="dt">sigma=</span>lmreg.summ<span class="op">$</span>sigma,</span>
<span id="cb273-59"><a href="linear-regression.html#cb273-59"></a>           <span class="dt">r.squared=</span>lmreg.summ<span class="op">$</span>r.squared,</span>
<span id="cb273-60"><a href="linear-regression.html#cb273-60"></a>           <span class="dt">adj.r.squared=</span>lmreg.summ<span class="op">$</span>adj.r.squared)) <span class="op">%&gt;%</span></span>
<span id="cb273-61"><a href="linear-regression.html#cb273-61"></a><span class="st">      </span><span class="kw">gather</span>(variable, value) <span class="op">%&gt;%</span></span>
<span id="cb273-62"><a href="linear-regression.html#cb273-62"></a><span class="st">      </span><span class="kw">rename</span>(<span class="dt">rownames =</span> variable) <span class="op">%&gt;%</span></span>
<span id="cb273-63"><a href="linear-regression.html#cb273-63"></a><span class="st">      </span><span class="kw">rename</span>(<span class="dt">v =</span> value)</span>
<span id="cb273-64"><a href="linear-regression.html#cb273-64"></a>    </span>
<span id="cb273-65"><a href="linear-regression.html#cb273-65"></a>    df.results &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb273-66"><a href="linear-regression.html#cb273-66"></a>      <span class="kw">as_tibble</span>(lmreg.summ<span class="op">$</span>coef, <span class="dt">rownames=</span><span class="st">&#39;rownames&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb273-67"><a href="linear-regression.html#cb273-67"></a><span class="st">        </span><span class="kw">full_join</span>(lm.diagnostics) <span class="op">%&gt;%</span></span>
<span id="cb273-68"><a href="linear-regression.html#cb273-68"></a><span class="st">        </span><span class="kw">full_join</span>(<span class="kw">tibble</span>(<span class="dt">rownames=</span><span class="kw">c</span>(<span class="st">&#39;vars&#39;</span>),</span>
<span id="cb273-69"><a href="linear-regression.html#cb273-69"></a>                         <span class="dt">var.y=</span>var.y,</span>
<span id="cb273-70"><a href="linear-regression.html#cb273-70"></a>                         <span class="dt">vars.x=</span>str.vars.x,</span>
<span id="cb273-71"><a href="linear-regression.html#cb273-71"></a>                         <span class="dt">vars.c=</span>str.vars.c))))</span>
<span id="cb273-72"><a href="linear-regression.html#cb273-72"></a>  }</span>
<span id="cb273-73"><a href="linear-regression.html#cb273-73"></a>  </span>
<span id="cb273-74"><a href="linear-regression.html#cb273-74"></a>  <span class="co"># E. Flatten Matrix, All IV results as a single tibble </span></span>
<span id="cb273-75"><a href="linear-regression.html#cb273-75"></a>  <span class="co"># row to be combined with other IV results</span></span>
<span id="cb273-76"><a href="linear-regression.html#cb273-76"></a>  df.row.results &lt;-<span class="st"> </span>df.results <span class="op">%&gt;%</span></span>
<span id="cb273-77"><a href="linear-regression.html#cb273-77"></a><span class="st">    </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>rownames) <span class="op">%&gt;%</span></span>
<span id="cb273-78"><a href="linear-regression.html#cb273-78"></a><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span></span>
<span id="cb273-79"><a href="linear-regression.html#cb273-79"></a><span class="st">    </span><span class="kw">unite</span>(esti.val, rownames, variable) <span class="op">%&gt;%</span></span>
<span id="cb273-80"><a href="linear-regression.html#cb273-80"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">esti.val =</span> <span class="kw">gsub</span>(<span class="st">&#39; &#39;</span>, <span class="st">&#39;&#39;</span>, esti.val))</span>
<span id="cb273-81"><a href="linear-regression.html#cb273-81"></a>  </span>
<span id="cb273-82"><a href="linear-regression.html#cb273-82"></a>  <span class="cf">if</span> (transpose) {</span>
<span id="cb273-83"><a href="linear-regression.html#cb273-83"></a>    df.row.results &lt;-<span class="st"> </span>df.row.results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(esti.val, value)</span>
<span id="cb273-84"><a href="linear-regression.html#cb273-84"></a>  }</span>
<span id="cb273-85"><a href="linear-regression.html#cb273-85"></a>  </span>
<span id="cb273-86"><a href="linear-regression.html#cb273-86"></a>  <span class="co"># F. Return</span></span>
<span id="cb273-87"><a href="linear-regression.html#cb273-87"></a>  <span class="kw">return</span>(<span class="kw">data.frame</span>(df.row.results))</span>
<span id="cb273-88"><a href="linear-regression.html#cb273-88"></a>}</span></code></pre></div>
</div>
<div id="program-testing" class="section level4" number="5.1.1.2">
<h4><span class="header-section-number">5.1.1.2</span> Program Testing</h4>
<p>Load Data</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="linear-regression.html#cb274-1"></a><span class="co"># Library</span></span>
<span id="cb274-2"><a href="linear-regression.html#cb274-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb274-3"><a href="linear-regression.html#cb274-3"></a><span class="kw">library</span>(AER)</span>
<span id="cb274-4"><a href="linear-regression.html#cb274-4"></a></span>
<span id="cb274-5"><a href="linear-regression.html#cb274-5"></a><span class="co"># Load Sample Data</span></span>
<span id="cb274-6"><a href="linear-regression.html#cb274-6"></a><span class="kw">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb274-7"><a href="linear-regression.html#cb274-7"></a>df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span></code></pre></div>
<div id="example-no-instrument-ols" class="section level5" number="5.1.1.2.1">
<h5><span class="header-section-number">5.1.1.2.1</span> Example No Instrument, OLS</h5>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="linear-regression.html#cb275-1"></a><span class="co"># One Instrucments</span></span>
<span id="cb275-2"><a href="linear-regression.html#cb275-2"></a>var.y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb275-3"><a href="linear-regression.html#cb275-3"></a>vars.x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb275-4"><a href="linear-regression.html#cb275-4"></a>vars.z &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb275-5"><a href="linear-regression.html#cb275-5"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb275-6"><a href="linear-regression.html#cb275-6"></a><span class="co"># Regression</span></span>
<span id="cb275-7"><a href="linear-regression.html#cb275-7"></a><span class="kw">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="dt">transpose=</span><span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb275-8"><a href="linear-regression.html#cb275-8"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb275-9"><a href="linear-regression.html#cb275-9"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
52.1186286658651
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.374472386357917
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.611043720578292
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.148513781160842
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.00150560230505631
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
1.57770483608693
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.00418121191133815
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.118396259120659
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0393807494783186
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.000187123663624397
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_tvalue
</td>
<td style="text-align:left;">
33.0344608660332
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_tvalue
</td>
<td style="text-align:left;">
89.5607288744356
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_tvalue
</td>
<td style="text-align:left;">
5.16100529794248
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_tvalue
</td>
<td style="text-align:left;">
3.77122790013449
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_tvalue
</td>
<td style="text-align:left;">
8.04602836377991
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
9.92126150975783e-233
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
2.48105505495642e-07
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
0.000162939618371183
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
9.05257561534111e-16
</td>
</tr>
<tr>
<td style="text-align:left;">
df1_v
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
df2_v
</td>
<td style="text-align:left;">
18958
</td>
</tr>
<tr>
<td style="text-align:left;">
df3_v
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_v
</td>
<td style="text-align:left;">
8.06197784622979
</td>
</tr>
<tr>
<td style="text-align:left;">
r.squared_v
</td>
<td style="text-align:left;">
0.319078711001325
</td>
</tr>
<tr>
<td style="text-align:left;">
adj.r.squared_v
</td>
<td style="text-align:left;">
0.318935041565942
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-1-insturment" class="section level5" number="5.1.1.2.2">
<h5><span class="header-section-number">5.1.1.2.2</span> Example 1 Insturment</h5>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="linear-regression.html#cb276-1"></a><span class="co"># One Instrucments</span></span>
<span id="cb276-2"><a href="linear-regression.html#cb276-2"></a>var.y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb276-3"><a href="linear-regression.html#cb276-3"></a>vars.x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb276-4"><a href="linear-regression.html#cb276-4"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;momEdu&#39;</span>)</span>
<span id="cb276-5"><a href="linear-regression.html#cb276-5"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb276-6"><a href="linear-regression.html#cb276-6"></a><span class="co"># Regression</span></span>
<span id="cb276-7"><a href="linear-regression.html#cb276-7"></a><span class="kw">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="dt">transpose=</span><span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb276-8"><a href="linear-regression.html#cb276-8"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb276-9"><a href="linear-regression.html#cb276-9"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
43.4301969117558
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.130833343849446
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.868121847262411
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.412093881817148
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.000858630042617921
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
1.82489550971182
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.0192036220809189
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.13373016700542
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0459431912927002
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.00022691057702563
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_zvalue
</td>
<td style="text-align:left;">
23.798730766023
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
6.81295139521853
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
6.49159323361366
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
8.96963990141069
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
3.7840018472164
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
3.4423766196876e-125
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
9.56164541643828e-12
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
8.49333228172763e-11
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
2.97485394526792e-19
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.000154326676608523
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df2
</td>
<td style="text-align:left;">
16394
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df2
</td>
<td style="text-align:left;">
16393
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_statistic
</td>
<td style="text-align:left;">
935.817456612075
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_statistic
</td>
<td style="text-align:left;">
123.595856606729
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_p-value
</td>
<td style="text-align:left;">
6.39714929178024e-200
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_p-value
</td>
<td style="text-align:left;">
1.30703637796748e-28
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
momEdu
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-multiple-instrucments" class="section level5" number="5.1.1.2.3">
<h5><span class="header-section-number">5.1.1.2.3</span> Example Multiple Instrucments</h5>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="linear-regression.html#cb277-1"></a><span class="co"># Multiple Instrucments</span></span>
<span id="cb277-2"><a href="linear-regression.html#cb277-2"></a>var.y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb277-3"><a href="linear-regression.html#cb277-3"></a>vars.x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb277-4"><a href="linear-regression.html#cb277-4"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;momEdu&#39;</span>, <span class="st">&#39;wealthIdx&#39;</span>, <span class="st">&#39;p.A.prot&#39;</span>, <span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb277-5"><a href="linear-regression.html#cb277-5"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb277-6"><a href="linear-regression.html#cb277-6"></a><span class="co"># Regression</span></span>
<span id="cb277-7"><a href="linear-regression.html#cb277-7"></a><span class="kw">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="dt">transpose=</span><span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb277-8"><a href="linear-regression.html#cb277-8"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb277-9"><a href="linear-regression.html#cb277-9"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
42.2437613555242
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.26699945194704
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.695548488812932
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.424954881263031
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.000486951420329484
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
1.85356686789642
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.0154939347964083
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.133157977814374
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0463195803786233
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.000224867994873235
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_zvalue
</td>
<td style="text-align:left;">
22.7905246296649
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
17.2325142357597
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
5.22348341593581
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
9.17441129192849
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
2.16549901022595
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
5.69294074735747e-115
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.51424021931607e-66
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.75588197502565e-07
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
4.54048595587756e-20
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.030349491114332
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df1
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df2
</td>
<td style="text-align:left;">
14916
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_statistic
</td>
<td style="text-align:left;">
274.147084958343
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_statistic
</td>
<td style="text-align:left;">
17.7562545747101
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_statistic
</td>
<td style="text-align:left;">
463.729664547249
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_p-value
</td>
<td style="text-align:left;">
8.61731956233366e-228
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_p-value
</td>
<td style="text-align:left;">
2.52567249124181e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_p-value
</td>
<td style="text-align:left;">
3.45452874915475e-100
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
momEdu+wealthIdx+p.A.prot+p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-multiple-endogenous-variables" class="section level5" number="5.1.1.2.4">
<h5><span class="header-section-number">5.1.1.2.4</span> Example Multiple Endogenous Variables</h5>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="linear-regression.html#cb278-1"></a><span class="co"># Multiple Instrucments</span></span>
<span id="cb278-2"><a href="linear-regression.html#cb278-2"></a>var.y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb278-3"><a href="linear-regression.html#cb278-3"></a>vars.x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;prot&#39;</span>, <span class="st">&#39;cal&#39;</span>)</span>
<span id="cb278-4"><a href="linear-regression.html#cb278-4"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;momEdu&#39;</span>, <span class="st">&#39;wealthIdx&#39;</span>, <span class="st">&#39;p.A.prot&#39;</span>, <span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb278-5"><a href="linear-regression.html#cb278-5"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb278-6"><a href="linear-regression.html#cb278-6"></a><span class="co"># Regression</span></span>
<span id="cb278-7"><a href="linear-regression.html#cb278-7"></a><span class="kw">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="dt">transpose=</span><span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb278-8"><a href="linear-regression.html#cb278-8"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb278-9"><a href="linear-regression.html#cb278-9"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
44.0243196254297
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
-1.4025623247106
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Estimate
</td>
<td style="text-align:left;">
0.065104895750151
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.120832787571818
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.286525437984517
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.000850481389651033
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
2.75354847244082
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.198640060273635
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Std.Error
</td>
<td style="text-align:left;">
0.00758881298880996
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.209984580636303
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0707828182888255
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.00033711210444429
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_zvalue
</td>
<td style="text-align:left;">
15.9882130516502
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
-7.06082309267581
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_zvalue
</td>
<td style="text-align:left;">
8.57906181719737
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
0.575436478267434
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
4.04795181812859
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
2.52284441418383
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.54396598126854e-57
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.65519210848649e-12
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
9.56500648203187e-18
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.564996139463599
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
5.16677787108928e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.0116409892837831
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_df1
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_df1
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_statistic
</td>
<td style="text-align:left;">
274.147084958343
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_statistic
</td>
<td style="text-align:left;">
315.036848606231
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_statistic
</td>
<td style="text-align:left;">
94.7020085425169
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_statistic
</td>
<td style="text-align:left;">
122.081979628898
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_p-value
</td>
<td style="text-align:left;">
8.61731956233366e-228
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_p-value
</td>
<td style="text-align:left;">
1.18918641220866e-260
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_p-value
</td>
<td style="text-align:left;">
1.35024050408262e-41
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_p-value
</td>
<td style="text-align:left;">
3.09196773720398e-27
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot+cal
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
momEdu+wealthIdx+p.A.prot+p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="examples-line-by-line" class="section level5" number="5.1.1.2.5">
<h5><span class="header-section-number">5.1.1.2.5</span> Examples Line by Line</h5>
<p>The examples are just to test the code with different types of variables.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="linear-regression.html#cb279-1"></a><span class="co"># Selecting Variables</span></span>
<span id="cb279-2"><a href="linear-regression.html#cb279-2"></a>var.y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb279-3"><a href="linear-regression.html#cb279-3"></a>vars.x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;prot&#39;</span>, <span class="st">&#39;cal&#39;</span>)</span>
<span id="cb279-4"><a href="linear-regression.html#cb279-4"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;momEdu&#39;</span>, <span class="st">&#39;wealthIdx&#39;</span>, <span class="st">&#39;p.A.prot&#39;</span>, <span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb279-5"><a href="linear-regression.html#cb279-5"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="linear-regression.html#cb280-1"></a><span class="co"># A. create Equation</span></span>
<span id="cb280-2"><a href="linear-regression.html#cb280-2"></a>str.vars.x &lt;-<span class="st"> </span><span class="kw">paste</span>(vars.x, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb280-3"><a href="linear-regression.html#cb280-3"></a>str.vars.c &lt;-<span class="st"> </span><span class="kw">paste</span>(vars.c, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb280-4"><a href="linear-regression.html#cb280-4"></a>str.vars.z &lt;-<span class="st"> </span><span class="kw">paste</span>(vars.z, <span class="dt">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb280-5"><a href="linear-regression.html#cb280-5"></a><span class="kw">print</span>(str.vars.x)</span></code></pre></div>
<pre><code>## [1] &quot;prot+cal&quot;</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="linear-regression.html#cb282-1"></a><span class="kw">print</span>(str.vars.c)</span></code></pre></div>
<pre><code>## [1] &quot;sex+hgt0+wgt0&quot;</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="linear-regression.html#cb284-1"></a><span class="kw">print</span>(str.vars.z)</span></code></pre></div>
<pre><code>## [1] &quot;momEdu+wealthIdx+p.A.prot+p.A.nProt&quot;</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="linear-regression.html#cb286-1"></a>equa.iv &lt;-<span class="st"> </span><span class="kw">paste</span>(var.y,</span>
<span id="cb286-2"><a href="linear-regression.html#cb286-2"></a>                 <span class="kw">paste</span>(<span class="kw">paste</span>(str.vars.x, str.vars.c, <span class="dt">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb286-3"><a href="linear-regression.html#cb286-3"></a>                       <span class="kw">paste</span>(str.vars.z, str.vars.c, <span class="dt">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb286-4"><a href="linear-regression.html#cb286-4"></a>                       <span class="dt">sep=</span><span class="st">&#39;|&#39;</span>),</span>
<span id="cb286-5"><a href="linear-regression.html#cb286-5"></a>                 <span class="dt">sep=</span><span class="st">&#39;~&#39;</span>)</span>
<span id="cb286-6"><a href="linear-regression.html#cb286-6"></a><span class="kw">print</span>(equa.iv)</span></code></pre></div>
<pre><code>## [1] &quot;hgt~prot+cal+sex+hgt0+wgt0|momEdu+wealthIdx+p.A.prot+p.A.nProt+sex+hgt0+wgt0&quot;</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="linear-regression.html#cb288-1"></a><span class="co"># B. regression</span></span>
<span id="cb288-2"><a href="linear-regression.html#cb288-2"></a>res.ivreg &lt;-<span class="st"> </span><span class="kw">ivreg</span>(<span class="kw">as.formula</span>(equa.iv), <span class="dt">data=</span>df)</span>
<span id="cb288-3"><a href="linear-regression.html#cb288-3"></a><span class="kw">coef</span>(res.ivreg)</span></code></pre></div>
<pre><code>##   (Intercept)          prot           cal       sexMale          hgt0          wgt0 
## 44.0243196254 -1.4025623247  0.0651048958  0.1208327876  0.2865254380  0.0008504814</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="linear-regression.html#cb290-1"></a><span class="co"># C. Regression Summary</span></span>
<span id="cb290-2"><a href="linear-regression.html#cb290-2"></a>ivreg.summ &lt;-<span class="st"> </span><span class="kw">summary</span>(res.ivreg, <span class="dt">vcov =</span> sandwich, <span class="dt">df =</span> <span class="ot">Inf</span>, <span class="dt">diagnostics =</span> <span class="ot">TRUE</span>)</span>
<span id="cb290-3"><a href="linear-regression.html#cb290-3"></a></span>
<span id="cb290-4"><a href="linear-regression.html#cb290-4"></a>ivreg.summ<span class="op">$</span>coef</span></code></pre></div>
<pre><code>##                  Estimate   Std. Error    z value     Pr(&gt;|z|)
## (Intercept) 44.0243196254 2.7535484724 15.9882131 1.543966e-57
## prot        -1.4025623247 0.1986400603 -7.0608231 1.655192e-12
## cal          0.0651048958 0.0075888130  8.5790618 9.565006e-18
## sexMale      0.1208327876 0.2099845806  0.5754365 5.649961e-01
## hgt0         0.2865254380 0.0707828183  4.0479518 5.166778e-05
## wgt0         0.0008504814 0.0003371121  2.5228444 1.164099e-02
## attr(,&quot;df&quot;)
## [1] 0</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="linear-regression.html#cb292-1"></a>ivreg.summ<span class="op">$</span>diagnostics</span></code></pre></div>
<pre><code>##                         df1   df2 statistic       p-value
## Weak instruments (prot)   4 14914 274.14708 8.617320e-228
## Weak instruments (cal)    4 14914 315.03685 1.189186e-260
## Wu-Hausman                2 14914  94.70201  1.350241e-41
## Sargan                    2    NA 122.08198  3.091968e-27</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="linear-regression.html#cb294-1"></a><span class="co"># D. Combine Regression Results into a Matrix</span></span>
<span id="cb294-2"><a href="linear-regression.html#cb294-2"></a>df.results &lt;-<span class="st"> </span><span class="kw">suppressMessages</span>(<span class="kw">as_tibble</span>(ivreg.summ<span class="op">$</span>coef, <span class="dt">rownames=</span><span class="st">&#39;rownames&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb294-3"><a href="linear-regression.html#cb294-3"></a><span class="st">    </span><span class="kw">full_join</span>(<span class="kw">as_tibble</span>(ivreg.summ<span class="op">$</span>diagnostics, <span class="dt">rownames=</span><span class="st">&#39;rownames&#39;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb294-4"><a href="linear-regression.html#cb294-4"></a><span class="st">    </span><span class="kw">full_join</span>(<span class="kw">tibble</span>(<span class="dt">rownames=</span><span class="kw">c</span>(<span class="st">&#39;vars&#39;</span>),</span>
<span id="cb294-5"><a href="linear-regression.html#cb294-5"></a>                     <span class="dt">var.y=</span>var.y,</span>
<span id="cb294-6"><a href="linear-regression.html#cb294-6"></a>                     <span class="dt">vars.x=</span>str.vars.x,</span>
<span id="cb294-7"><a href="linear-regression.html#cb294-7"></a>                     <span class="dt">vars.z=</span>str.vars.z,</span>
<span id="cb294-8"><a href="linear-regression.html#cb294-8"></a>                     <span class="dt">vars.c=</span>str.vars.c)))</span>
<span id="cb294-9"><a href="linear-regression.html#cb294-9"></a><span class="co"># E. Flatten Matrix, All IV results as a single tibble row to be combined with other IV results</span></span>
<span id="cb294-10"><a href="linear-regression.html#cb294-10"></a>df.row.results &lt;-<span class="st"> </span>df.results <span class="op">%&gt;%</span></span>
<span id="cb294-11"><a href="linear-regression.html#cb294-11"></a><span class="st">    </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>rownames) <span class="op">%&gt;%</span></span>
<span id="cb294-12"><a href="linear-regression.html#cb294-12"></a><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span></span>
<span id="cb294-13"><a href="linear-regression.html#cb294-13"></a><span class="st">    </span><span class="kw">unite</span>(esti.val, rownames, variable) <span class="op">%&gt;%</span></span>
<span id="cb294-14"><a href="linear-regression.html#cb294-14"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">esti.val =</span> <span class="kw">gsub</span>(<span class="st">&#39; &#39;</span>, <span class="st">&#39;&#39;</span>, esti.val))</span></code></pre></div>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="linear-regression.html#cb295-1"></a><span class="co"># F. Results as Single Colum</span></span>
<span id="cb295-2"><a href="linear-regression.html#cb295-2"></a><span class="co"># df.row.results</span></span></code></pre></div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="linear-regression.html#cb296-1"></a><span class="co"># G. Results as Single Row</span></span>
<span id="cb296-2"><a href="linear-regression.html#cb296-2"></a><span class="co"># df.row.results</span></span></code></pre></div>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="linear-regression.html#cb297-1"></a><span class="co"># t(df.row.results %&gt;% spread(esti.val, value)) %&gt;%</span></span>
<span id="cb297-2"><a href="linear-regression.html#cb297-2"></a><span class="co">#   kable() %&gt;%</span></span>
<span id="cb297-3"><a href="linear-regression.html#cb297-3"></a><span class="co">#   kable_styling_fc_wide()</span></span></code></pre></div>

</div>
</div>
</div>
<div id="iv-loop-over-rhs" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> IV Loop over RHS</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>Regression with a Variety of Outcome Variables and Right Hand Side Variables. There are M outcome variables, and there are N alternative right hand side variables. Regress each M outcome variable and each N alternative right hand side variable, with some common sets of controls and perhaps shared instruments. The output file is a M by N matrix of coefficients, with proper variable names and row names. The matrix stores coefficients for this key endogenous variable.</p>
<ul>
<li>Dependency: <em>R4Econ/linreg/ivreg/ivregdfrow.R</em></li>
</ul>
<div id="construct-program-1" class="section level4" number="5.1.2.1">
<h4><span class="header-section-number">5.1.2.1</span> Construct Program</h4>
<p>The program relies on double lapply. lapply is used for convenience, not speed.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="linear-regression.html#cb298-1"></a>ff_reg_mbyn &lt;-<span class="st"> </span><span class="cf">function</span>(list.vars.y, list.vars.x,</span>
<span id="cb298-2"><a href="linear-regression.html#cb298-2"></a>                        vars.c, vars.z, df,</span>
<span id="cb298-3"><a href="linear-regression.html#cb298-3"></a>                        <span class="dt">return_all =</span> <span class="ot">FALSE</span>,</span>
<span id="cb298-4"><a href="linear-regression.html#cb298-4"></a>                        <span class="dt">stats_ends =</span> <span class="st">&#39;value&#39;</span>, <span class="dt">time =</span> <span class="ot">FALSE</span>) {</span>
<span id="cb298-5"><a href="linear-regression.html#cb298-5"></a></span>
<span id="cb298-6"><a href="linear-regression.html#cb298-6"></a>  <span class="co"># regf.iv() function is from C:\Users\fan\R4Econ\linreg\ivreg\ivregdfrow.R</span></span>
<span id="cb298-7"><a href="linear-regression.html#cb298-7"></a>  <span class="cf">if</span> (time) {</span>
<span id="cb298-8"><a href="linear-regression.html#cb298-8"></a>    start_time &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb298-9"><a href="linear-regression.html#cb298-9"></a>  }</span>
<span id="cb298-10"><a href="linear-regression.html#cb298-10"></a></span>
<span id="cb298-11"><a href="linear-regression.html#cb298-11"></a>  <span class="cf">if</span> (return_all) {</span>
<span id="cb298-12"><a href="linear-regression.html#cb298-12"></a>    df.reg.out.all &lt;-</span>
<span id="cb298-13"><a href="linear-regression.html#cb298-13"></a><span class="st">      </span><span class="kw">bind_rows</span>(<span class="kw">lapply</span>(list.vars.x,</span>
<span id="cb298-14"><a href="linear-regression.html#cb298-14"></a>                       <span class="cf">function</span>(x) (</span>
<span id="cb298-15"><a href="linear-regression.html#cb298-15"></a>                         <span class="kw">bind_rows</span>(</span>
<span id="cb298-16"><a href="linear-regression.html#cb298-16"></a>                           <span class="kw">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb298-17"><a href="linear-regression.html#cb298-17"></a>                                  <span class="dt">vars.x=</span>x, <span class="dt">vars.c=</span>vars.c, <span class="dt">vars.z=</span>vars.z, <span class="dt">df=</span>df))</span>
<span id="cb298-18"><a href="linear-regression.html#cb298-18"></a>                       )))</span>
<span id="cb298-19"><a href="linear-regression.html#cb298-19"></a></span>
<span id="cb298-20"><a href="linear-regression.html#cb298-20"></a>  } <span class="cf">else</span> {</span>
<span id="cb298-21"><a href="linear-regression.html#cb298-21"></a>    df.reg.out.all &lt;-</span>
<span id="cb298-22"><a href="linear-regression.html#cb298-22"></a><span class="st">      </span>(<span class="kw">lapply</span>(list.vars.x,</span>
<span id="cb298-23"><a href="linear-regression.html#cb298-23"></a>              <span class="cf">function</span>(x) (</span>
<span id="cb298-24"><a href="linear-regression.html#cb298-24"></a>                <span class="kw">bind_rows</span>(</span>
<span id="cb298-25"><a href="linear-regression.html#cb298-25"></a>                  <span class="kw">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb298-26"><a href="linear-regression.html#cb298-26"></a>                         <span class="dt">vars.x=</span>x, <span class="dt">vars.c=</span>vars.c, <span class="dt">vars.z=</span>vars.z, <span class="dt">df=</span>df)) <span class="op">%&gt;%</span></span>
<span id="cb298-27"><a href="linear-regression.html#cb298-27"></a><span class="st">                  </span><span class="kw">select</span>(vars_var.y, <span class="kw">starts_with</span>(x)) <span class="op">%&gt;%</span></span>
<span id="cb298-28"><a href="linear-regression.html#cb298-28"></a><span class="st">                  </span><span class="kw">select</span>(vars_var.y, <span class="kw">ends_with</span>(stats_ends))</span>
<span id="cb298-29"><a href="linear-regression.html#cb298-29"></a>              ))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">reduce</span>(full_join)</span>
<span id="cb298-30"><a href="linear-regression.html#cb298-30"></a>  }</span>
<span id="cb298-31"><a href="linear-regression.html#cb298-31"></a></span>
<span id="cb298-32"><a href="linear-regression.html#cb298-32"></a>  <span class="cf">if</span> (time) {</span>
<span id="cb298-33"><a href="linear-regression.html#cb298-33"></a>    end_time &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</span>
<span id="cb298-34"><a href="linear-regression.html#cb298-34"></a>    <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&#39;Estimation for all ys and xs took (seconds):&#39;</span>,</span>
<span id="cb298-35"><a href="linear-regression.html#cb298-35"></a>                 end_time <span class="op">-</span><span class="st"> </span>start_time))</span>
<span id="cb298-36"><a href="linear-regression.html#cb298-36"></a>  }</span>
<span id="cb298-37"><a href="linear-regression.html#cb298-37"></a></span>
<span id="cb298-38"><a href="linear-regression.html#cb298-38"></a>  <span class="kw">return</span>(df.reg.out.all)</span>
<span id="cb298-39"><a href="linear-regression.html#cb298-39"></a>}</span></code></pre></div>
</div>
<div id="prepare-data" class="section level4" number="5.1.2.2">
<h4><span class="header-section-number">5.1.2.2</span> Prepare Data</h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="linear-regression.html#cb299-1"></a><span class="co"># Library</span></span>
<span id="cb299-2"><a href="linear-regression.html#cb299-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb299-3"><a href="linear-regression.html#cb299-3"></a><span class="kw">library</span>(AER)</span>
<span id="cb299-4"><a href="linear-regression.html#cb299-4"></a></span>
<span id="cb299-5"><a href="linear-regression.html#cb299-5"></a><span class="co"># Load Sample Data</span></span>
<span id="cb299-6"><a href="linear-regression.html#cb299-6"></a><span class="kw">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb299-7"><a href="linear-regression.html#cb299-7"></a>df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span>
<span id="cb299-8"><a href="linear-regression.html#cb299-8"></a></span>
<span id="cb299-9"><a href="linear-regression.html#cb299-9"></a><span class="co"># Source Dependency</span></span>
<span id="cb299-10"><a href="linear-regression.html#cb299-10"></a><span class="kw">source</span>(<span class="st">&#39;C:/Users/fan/R4Econ/linreg/ivreg/ivregdfrow.R&#39;</span>)</span>
<span id="cb299-11"><a href="linear-regression.html#cb299-11"></a></span>
<span id="cb299-12"><a href="linear-regression.html#cb299-12"></a><span class="co"># Setting</span></span>
<span id="cb299-13"><a href="linear-regression.html#cb299-13"></a><span class="kw">options</span>(<span class="dt">repr.matrix.max.rows=</span><span class="dv">50</span>, <span class="dt">repr.matrix.max.cols=</span><span class="dv">50</span>)</span></code></pre></div>
<p>Parameters.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="linear-regression.html#cb300-1"></a>var.y1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb300-2"><a href="linear-regression.html#cb300-2"></a>var.y2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;wgt&#39;</span>)</span>
<span id="cb300-3"><a href="linear-regression.html#cb300-3"></a>var.y3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;vil.id&#39;</span>)</span>
<span id="cb300-4"><a href="linear-regression.html#cb300-4"></a>list.vars.y &lt;-<span class="st"> </span><span class="kw">c</span>(var.y1, var.y2, var.y3)</span>
<span id="cb300-5"><a href="linear-regression.html#cb300-5"></a></span>
<span id="cb300-6"><a href="linear-regression.html#cb300-6"></a>var.x1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb300-7"><a href="linear-regression.html#cb300-7"></a>var.x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;cal&#39;</span>)</span>
<span id="cb300-8"><a href="linear-regression.html#cb300-8"></a>var.x3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;wealthIdx&#39;</span>)</span>
<span id="cb300-9"><a href="linear-regression.html#cb300-9"></a>var.x4 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;p.A.prot&#39;</span>)</span>
<span id="cb300-10"><a href="linear-regression.html#cb300-10"></a>var.x5 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb300-11"><a href="linear-regression.html#cb300-11"></a>list.vars.x &lt;-<span class="st"> </span><span class="kw">c</span>(var.x1, var.x2, var.x3, var.x4, var.x5)</span>
<span id="cb300-12"><a href="linear-regression.html#cb300-12"></a></span>
<span id="cb300-13"><a href="linear-regression.html#cb300-13"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb300-14"><a href="linear-regression.html#cb300-14"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;wgt0&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span></code></pre></div>
</div>
<div id="program-testing-1" class="section level4" number="5.1.2.3">
<h4><span class="header-section-number">5.1.2.3</span> Program Testing</h4>
<div id="test-program-ols-z-stat" class="section level5" number="5.1.2.3.1">
<h5><span class="header-section-number">5.1.2.3.1</span> Test Program OLS Z-Stat</h5>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="linear-regression.html#cb301-1"></a>vars.z &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb301-2"><a href="linear-regression.html#cb301-2"></a><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb301-3"><a href="linear-regression.html#cb301-3"></a>  <span class="kw">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb301-4"><a href="linear-regression.html#cb301-4"></a>              vars.c, vars.z, df,</span>
<span id="cb301-5"><a href="linear-regression.html#cb301-5"></a>              <span class="dt">return_all =</span> <span class="ot">FALSE</span>,</span>
<span id="cb301-6"><a href="linear-regression.html#cb301-6"></a>              <span class="dt">stats_ends =</span> <span class="st">&#39;value&#39;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb301-7"><a href="linear-regression.html#cb301-7"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb301-8"><a href="linear-regression.html#cb301-8"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_tvalue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
18.8756010031786
</td>
<td style="text-align:left;">
23.4421863484661
</td>
<td style="text-align:left;">
13.508899618216
</td>
<td style="text-align:left;">
3.83682180045518
</td>
<td style="text-align:left;">
32.5448257554855
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
16.3591125056062
</td>
<td style="text-align:left;">
17.3686031309332
</td>
<td style="text-align:left;">
14.1390521528113
</td>
<td style="text-align:left;">
1.36958319982295
</td>
<td style="text-align:left;">
12.0961557911467
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-14.9385580468907
</td>
<td style="text-align:left;">
-19.6150110809452
</td>
<td style="text-align:left;">
34.0972558327347
</td>
<td style="text-align:left;">
8.45943342783186
</td>
<td style="text-align:left;">
17.7801422421419
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-iv-t-stat" class="section level5" number="5.1.2.3.2">
<h5><span class="header-section-number">5.1.2.3.2</span> Test Program IV T-stat</h5>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="linear-regression.html#cb302-1"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb302-2"><a href="linear-regression.html#cb302-2"></a><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb302-3"><a href="linear-regression.html#cb302-3"></a>  <span class="kw">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb302-4"><a href="linear-regression.html#cb302-4"></a>              vars.c, vars.z, df,</span>
<span id="cb302-5"><a href="linear-regression.html#cb302-5"></a>              <span class="dt">return_all =</span> <span class="ot">FALSE</span>,</span>
<span id="cb302-6"><a href="linear-regression.html#cb302-6"></a>              <span class="dt">stats_ends =</span> <span class="st">&#39;value&#39;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb302-7"><a href="linear-regression.html#cb302-7"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb302-8"><a href="linear-regression.html#cb302-8"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_zvalue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
8.87674929300964
</td>
<td style="text-align:left;">
12.0739764947235
</td>
<td style="text-align:left;">
4.62589553677969
</td>
<td style="text-align:left;">
26.6373587567312
</td>
<td style="text-align:left;">
32.1162192385744
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
5.60385871756365
</td>
<td style="text-align:left;">
6.1225187008946
</td>
<td style="text-align:left;">
5.17869536991717
</td>
<td style="text-align:left;">
11.9295584469998
</td>
<td style="text-align:left;">
12.3509307017263
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-9.22106223347162
</td>
<td style="text-align:left;">
-13.0586007975839
</td>
<td style="text-align:left;">
-51.5866689219593
</td>
<td style="text-align:left;">
-29.9627476577329
</td>
<td style="text-align:left;">
-38.3528894620707
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-ols-coefficient" class="section level5" number="5.1.2.3.3">
<h5><span class="header-section-number">5.1.2.3.3</span> Test Program OLS Coefficient</h5>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="linear-regression.html#cb303-1"></a>vars.z &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb303-2"><a href="linear-regression.html#cb303-2"></a><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb303-3"><a href="linear-regression.html#cb303-3"></a>  <span class="kw">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb303-4"><a href="linear-regression.html#cb303-4"></a>              vars.c, vars.z, df,</span>
<span id="cb303-5"><a href="linear-regression.html#cb303-5"></a>              <span class="dt">return_all =</span> <span class="ot">FALSE</span>,</span>
<span id="cb303-6"><a href="linear-regression.html#cb303-6"></a>              <span class="dt">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb303-7"><a href="linear-regression.html#cb303-7"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb303-8"><a href="linear-regression.html#cb303-8"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_Estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
0.049431093806755
</td>
<td style="text-align:left;">
0.00243408846205622
</td>
<td style="text-align:left;">
0.21045655488185
</td>
<td style="text-align:left;">
3.86952250259526e-05
</td>
<td style="text-align:left;">
0.00542428867316449
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
16.5557424523585
</td>
<td style="text-align:left;">
0.699072500364623
</td>
<td style="text-align:left;">
106.678721085969
</td>
<td style="text-align:left;">
0.00521731297924587
</td>
<td style="text-align:left;">
0.779514232050632
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-0.0758835879205584
</td>
<td style="text-align:left;">
-0.00395676177098486
</td>
<td style="text-align:left;">
0.451733304543324
</td>
<td style="text-align:left;">
0.000149388430455142
</td>
<td style="text-align:left;">
0.00526237555581024
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-iv-coefficient" class="section level5" number="5.1.2.3.4">
<h5><span class="header-section-number">5.1.2.3.4</span> Test Program IV coefficient</h5>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="linear-regression.html#cb304-1"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb304-2"><a href="linear-regression.html#cb304-2"></a><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb304-3"><a href="linear-regression.html#cb304-3"></a>  <span class="kw">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb304-4"><a href="linear-regression.html#cb304-4"></a>              vars.c, vars.z, df,</span>
<span id="cb304-5"><a href="linear-regression.html#cb304-5"></a>              <span class="dt">return_all =</span> <span class="ot">FALSE</span>,</span>
<span id="cb304-6"><a href="linear-regression.html#cb304-6"></a>              <span class="dt">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb304-7"><a href="linear-regression.html#cb304-7"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb304-8"><a href="linear-regression.html#cb304-8"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_Estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
0.859205733632614
</td>
<td style="text-align:left;">
0.0238724384575419
</td>
<td style="text-align:left;">
0.144503490136948
</td>
<td style="text-align:left;">
0.00148073028434642
</td>
<td style="text-align:left;">
0.0141317656200726
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
98.9428234201406
</td>
<td style="text-align:left;">
2.71948246216953
</td>
<td style="text-align:left;">
69.1816142883022
</td>
<td style="text-align:left;">
0.221916473012486
</td>
<td style="text-align:left;">
2.11856940494335
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-6.02451379136132
</td>
<td style="text-align:left;">
-0.168054407187466
</td>
<td style="text-align:left;">
-1.91414470908345
</td>
<td style="text-align:left;">
-0.00520794333267238
</td>
<td style="text-align:left;">
-0.0494468877742109
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-ols-return-all" class="section level5" number="5.1.2.3.5">
<h5><span class="header-section-number">5.1.2.3.5</span> Test Program OLS Return All</h5>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="linear-regression.html#cb305-1"></a>vars.z &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb305-2"><a href="linear-regression.html#cb305-2"></a><span class="kw">t</span>(<span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb305-3"><a href="linear-regression.html#cb305-3"></a>  <span class="kw">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb305-4"><a href="linear-regression.html#cb305-4"></a>            vars.c, vars.z, df,</span>
<span id="cb305-5"><a href="linear-regression.html#cb305-5"></a>            <span class="dt">return_all =</span> <span class="ot">TRUE</span>,</span>
<span id="cb305-6"><a href="linear-regression.html#cb305-6"></a>            <span class="dt">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>)))) <span class="op">%&gt;%</span></span>
<span id="cb305-7"><a href="linear-regression.html#cb305-7"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb305-8"><a href="linear-regression.html#cb305-8"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
X.Intercept._Estimate
</td>
<td style="text-align:left;">
27.3528514188608
</td>
<td style="text-align:left;">
99.873884728925
</td>
<td style="text-align:left;">
31.4646660224049
</td>
<td style="text-align:left;">
27.9038445914729
</td>
<td style="text-align:left;">
219.626705179399
</td>
<td style="text-align:left;">
30.5103987898551
</td>
<td style="text-align:left;">
35.7840188807906
</td>
<td style="text-align:left;">
-2662.74787734003
</td>
<td style="text-align:left;">
29.2381039651127
</td>
<td style="text-align:left;">
23.9948407749744
</td>
<td style="text-align:left;">
-547.959546430028
</td>
<td style="text-align:left;">
22.3367814226238
</td>
<td style="text-align:left;">
24.4904444950827
</td>
<td style="text-align:left;">
-476.703973630552
</td>
<td style="text-align:left;">
22.7781908464511
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Pr…t..
</td>
<td style="text-align:left;">
5.68247182214952e-231
</td>
<td style="text-align:left;">
0.75529705553815
</td>
<td style="text-align:left;">
6.78164655340399e-84
</td>
<td style="text-align:left;">
8.24252673989353e-242
</td>
<td style="text-align:left;">
0.493216914827181
</td>
<td style="text-align:left;">
1.62608789535248e-79
</td>
<td style="text-align:left;">
2.26726906489443e-145
</td>
<td style="text-align:left;">
7.13318862990131e-05
</td>
<td style="text-align:left;">
1.53578035267873e-124
</td>
<td style="text-align:left;">
2.11912344053336e-165
</td>
<td style="text-align:left;">
0.0941551350855875
</td>
<td style="text-align:left;">
3.04337266226599e-49
</td>
<td style="text-align:left;">
2.34941965806705e-181
</td>
<td style="text-align:left;">
0.143844033032183
</td>
<td style="text-align:left;">
9.58029450711211e-52
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Std.Error
</td>
<td style="text-align:left;">
0.831272666092284
</td>
<td style="text-align:left;">
320.450650378664
</td>
<td style="text-align:left;">
1.61328519718754
</td>
<td style="text-align:left;">
0.828072565159449
</td>
<td style="text-align:left;">
320.522532223672
</td>
<td style="text-align:left;">
1.60831193651104
</td>
<td style="text-align:left;">
1.38461348429899
</td>
<td style="text-align:left;">
670.301542938561
</td>
<td style="text-align:left;">
1.22602177264147
</td>
<td style="text-align:left;">
0.86658104216672
</td>
<td style="text-align:left;">
327.343126852912
</td>
<td style="text-align:left;">
1.5098937308759
</td>
<td style="text-align:left;">
0.843371070670838
</td>
<td style="text-align:left;">
326.132837036936
</td>
<td style="text-align:left;">
1.5004526558957
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._tvalue
</td>
<td style="text-align:left;">
32.9047886867776
</td>
<td style="text-align:left;">
0.31166697465244
</td>
<td style="text-align:left;">
19.503474077155
</td>
<td style="text-align:left;">
33.6973421962119
</td>
<td style="text-align:left;">
0.685214557790078
</td>
<td style="text-align:left;">
18.9704485163756
</td>
<td style="text-align:left;">
25.8440491058106
</td>
<td style="text-align:left;">
-3.97246270039407
</td>
<td style="text-align:left;">
23.8479483950102
</td>
<td style="text-align:left;">
27.6890903532576
</td>
<td style="text-align:left;">
-1.6739607509042
</td>
<td style="text-align:left;">
14.7936116071335
</td>
<td style="text-align:left;">
29.0387533397398
</td>
<td style="text-align:left;">
-1.46168652614567
</td>
<td style="text-align:left;">
15.1808794212527
</td>
</tr>
<tr>
<td style="text-align:left;">
adj.r.squared_v
</td>
<td style="text-align:left;">
0.814249026159781
</td>
<td style="text-align:left;">
0.60716936506893
</td>
<td style="text-align:left;">
0.0373247512680971
</td>
<td style="text-align:left;">
0.81608922805658
</td>
<td style="text-align:left;">
0.607863678511207
</td>
<td style="text-align:left;">
0.0453498711076042
</td>
<td style="text-align:left;">
0.935014931990565
</td>
<td style="text-align:left;">
0.92193683733695
</td>
<td style="text-align:left;">
0.059543122812776
</td>
<td style="text-align:left;">
0.814690803458616
</td>
<td style="text-align:left;">
0.617300597776144
</td>
<td style="text-align:left;">
0.0261131074199838
</td>
<td style="text-align:left;">
0.824542352656376
</td>
<td style="text-align:left;">
0.620250730454724
</td>
<td style="text-align:left;">
0.0385437355117917
</td>
</tr>
<tr>
<td style="text-align:left;">
df1_v
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
df2_v
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
25092
</td>
<td style="text-align:left;">
25102
</td>
<td style="text-align:left;">
30013
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
</tr>
<tr>
<td style="text-align:left;">
df3_v
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.60391817340617
</td>
<td style="text-align:left;">
56.3852027199184
</td>
<td style="text-align:left;">
-0.296844389234445
</td>
<td style="text-align:left;">
0.589847843438394
</td>
<td style="text-align:left;">
52.9707041800704
</td>
<td style="text-align:left;">
-0.273219210757899
</td>
<td style="text-align:left;">
0.439374451256039
</td>
<td style="text-align:left;">
47.176969664749
</td>
<td style="text-align:left;">
-0.35908163982046
</td>
<td style="text-align:left;">
0.687269209411865
</td>
<td style="text-align:left;">
72.105560623359
</td>
<td style="text-align:left;">
-0.108789161111504
</td>
<td style="text-align:left;">
0.622395388389206
</td>
<td style="text-align:left;">
62.7336220289257
</td>
<td style="text-align:left;">
-0.157811627494693
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr…t..
</td>
<td style="text-align:left;">
1.14533314566771e-183
</td>
<td style="text-align:left;">
1.52417506966835e-12
</td>
<td style="text-align:left;">
1.40290395213743e-13
</td>
<td style="text-align:left;">
7.79174951119325e-177
</td>
<td style="text-align:left;">
3.05720143843395e-11
</td>
<td style="text-align:left;">
8.49149153665126e-12
</td>
<td style="text-align:left;">
2.71000479249152e-36
</td>
<td style="text-align:left;">
0.00520266507060071
</td>
<td style="text-align:left;">
2.41020063623865e-31
</td>
<td style="text-align:left;">
1.31914432912869e-220
</td>
<td style="text-align:left;">
4.78613024244006e-19
</td>
<td style="text-align:left;">
0.0034801146146182
</td>
<td style="text-align:left;">
1.11511327164938e-190
</td>
<td style="text-align:left;">
8.38546282719268e-15
</td>
<td style="text-align:left;">
2.13723119924676e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0206657538633713
</td>
<td style="text-align:left;">
7.96735224000553
</td>
<td style="text-align:left;">
0.0401060913799595
</td>
<td style="text-align:left;">
0.0205836398278421
</td>
<td style="text-align:left;">
7.96822145797115
</td>
<td style="text-align:left;">
0.0399777363511633
</td>
<td style="text-align:left;">
0.0348701896610764
</td>
<td style="text-align:left;">
16.8823489375743
</td>
<td style="text-align:left;">
0.0307984635553859
</td>
<td style="text-align:left;">
0.0213841849324282
</td>
<td style="text-align:left;">
8.07744906400683
</td>
<td style="text-align:left;">
0.0372288594891345
</td>
<td style="text-align:left;">
0.0208846437570215
</td>
<td style="text-align:left;">
8.07589192978212
</td>
<td style="text-align:left;">
0.0371223237183417
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_tvalue
</td>
<td style="text-align:left;">
29.2231378249683
</td>
<td style="text-align:left;">
7.0770314931977
</td>
<td style="text-align:left;">
-7.40147890309685
</td>
<td style="text-align:left;">
28.6561486875877
</td>
<td style="text-align:left;">
6.64774497790599
</td>
<td style="text-align:left;">
-6.83428417151858
</td>
<td style="text-align:left;">
12.6002885423502
</td>
<td style="text-align:left;">
2.79445531182864
</td>
<td style="text-align:left;">
-11.659076407325
</td>
<td style="text-align:left;">
32.1391351404584
</td>
<td style="text-align:left;">
8.92677379355593
</td>
<td style="text-align:left;">
-2.92217281443323
</td>
<td style="text-align:left;">
29.8015803204665
</td>
<td style="text-align:left;">
7.76801157994423
</td>
<td style="text-align:left;">
-4.25112470577158
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.049431093806755
</td>
<td style="text-align:left;">
16.5557424523585
</td>
<td style="text-align:left;">
-0.0758835879205584
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr…t..
</td>
<td style="text-align:left;">
9.54769322304645e-79
</td>
<td style="text-align:left;">
9.61203373222183e-60
</td>
<td style="text-align:left;">
3.56396093562335e-50
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.00261878251179557
</td>
<td style="text-align:left;">
1.01201959743751
</td>
<td style="text-align:left;">
0.00507971302734622
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_tvalue
</td>
<td style="text-align:left;">
18.8756010031786
</td>
<td style="text-align:left;">
16.3591125056062
</td>
<td style="text-align:left;">
-14.9385580468907
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
r.squared_v
</td>
<td style="text-align:left;">
0.814298005954592
</td>
<td style="text-align:left;">
0.607272921412825
</td>
<td style="text-align:left;">
0.0375780335372857
</td>
<td style="text-align:left;">
0.816137722617266
</td>
<td style="text-align:left;">
0.60796705182314
</td>
<td style="text-align:left;">
0.0456010419476623
</td>
<td style="text-align:left;">
0.93502787877066
</td>
<td style="text-align:left;">
0.921952383432195
</td>
<td style="text-align:left;">
0.0596997716363463
</td>
<td style="text-align:left;">
0.814740639193486
</td>
<td style="text-align:left;">
0.617403496088206
</td>
<td style="text-align:left;">
0.0263714328556815
</td>
<td style="text-align:left;">
0.824589538985803
</td>
<td style="text-align:left;">
0.620352835549783
</td>
<td style="text-align:left;">
0.0387987636986586
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.935177182449406
</td>
<td style="text-align:left;">
415.163616765357
</td>
<td style="text-align:left;">
-0.254089999175318
</td>
<td style="text-align:left;">
0.893484662055608
</td>
<td style="text-align:left;">
405.534891838028
</td>
<td style="text-align:left;">
-0.181389489610951
</td>
<td style="text-align:left;">
1.80682463132073
</td>
<td style="text-align:left;">
999.926876716707
</td>
<td style="text-align:left;">
-0.33436777751525
</td>
<td style="text-align:left;">
0.932686930233136
</td>
<td style="text-align:left;">
397.141948675354
</td>
<td style="text-align:left;">
-0.445232370681998
</td>
<td style="text-align:left;">
0.96466980500711
</td>
<td style="text-align:left;">
401.59056368102
</td>
<td style="text-align:left;">
-0.423829627017582
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr…t..
</td>
<td style="text-align:left;">
2.36432111724607e-51
</td>
<td style="text-align:left;">
2.48252880290814e-67
</td>
<td style="text-align:left;">
0.0343768259467621
</td>
<td style="text-align:left;">
2.08765935335877e-47
</td>
<td style="text-align:left;">
2.51355675686752e-64
</td>
<td style="text-align:left;">
0.129768754080748
</td>
<td style="text-align:left;">
1.26527362032354e-66
</td>
<td style="text-align:left;">
2.64630894140004e-86
</td>
<td style="text-align:left;">
0.000311174554787706
</td>
<td style="text-align:left;">
7.90489020586094e-47
</td>
<td style="text-align:left;">
6.19449742677662e-59
</td>
<td style="text-align:left;">
7.93666802281971e-05
</td>
<td style="text-align:left;">
1.24556615236597e-52
</td>
<td style="text-align:left;">
1.18469030741261e-60
</td>
<td style="text-align:left;">
0.00015644693636154
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.0618482294097262
</td>
<td style="text-align:left;">
23.8518341439675
</td>
<td style="text-align:left;">
0.120093045309631
</td>
<td style="text-align:left;">
0.0616078355613525
</td>
<td style="text-align:left;">
23.8567507583516
</td>
<td style="text-align:left;">
0.11972270545355
</td>
<td style="text-align:left;">
0.104475287357902
</td>
<td style="text-align:left;">
50.5879876531386
</td>
<td style="text-align:left;">
0.0927193334338799
</td>
<td style="text-align:left;">
0.0647209948973267
</td>
<td style="text-align:left;">
24.4473730956481
</td>
<td style="text-align:left;">
0.112797805327952
</td>
<td style="text-align:left;">
0.0629827627260302
</td>
<td style="text-align:left;">
24.3549086073387
</td>
<td style="text-align:left;">
0.112083516545945
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_tvalue
</td>
<td style="text-align:left;">
15.1205166481668
</td>
<td style="text-align:left;">
17.4059409544552
</td>
<td style="text-align:left;">
-2.11577613441484
</td>
<td style="text-align:left;">
14.5027763743757
</td>
<td style="text-align:left;">
16.9987478993157
</td>
<td style="text-align:left;">
-1.51508010885476
</td>
<td style="text-align:left;">
17.2942776901016
</td>
<td style="text-align:left;">
19.7660931597596
</td>
<td style="text-align:left;">
-3.60623577771614
</td>
<td style="text-align:left;">
14.4108867873979
</td>
<td style="text-align:left;">
16.2447698213453
</td>
<td style="text-align:left;">
-3.94717228218682
</td>
<td style="text-align:left;">
15.316409812052
</td>
<td style="text-align:left;">
16.4891016491029
</td>
<td style="text-align:left;">
-3.78137339083082
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_v
</td>
<td style="text-align:left;">
4.21029844914315
</td>
<td style="text-align:left;">
1623.77111076428
</td>
<td style="text-align:left;">
8.18491760066961
</td>
<td style="text-align:left;">
4.18939119979502
</td>
<td style="text-align:left;">
1622.33549880859
</td>
<td style="text-align:left;">
8.15073036560541
</td>
<td style="text-align:left;">
8.18607049768594
</td>
<td style="text-align:left;">
3964.45339913597
</td>
<td style="text-align:left;">
7.93450742809862
</td>
<td style="text-align:left;">
4.35662621773428
</td>
<td style="text-align:left;">
1645.77655955938
</td>
<td style="text-align:left;">
7.6435668370875
</td>
<td style="text-align:left;">
4.23923961592693
</td>
<td style="text-align:left;">
1639.42085007515
</td>
<td style="text-align:left;">
7.59462918474114
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Estimate
</td>
<td style="text-align:left;">
0.87166589100565
</td>
<td style="text-align:left;">
189.04290688382
</td>
<td style="text-align:left;">
-0.0154759587993917
</td>
<td style="text-align:left;">
0.851989049736817
</td>
<td style="text-align:left;">
185.318286001897
</td>
<td style="text-align:left;">
0.0201471237605442
</td>
<td style="text-align:left;">
0.432815253441723
</td>
<td style="text-align:left;">
189.877994795061
</td>
<td style="text-align:left;">
0.00215144302579706
</td>
<td style="text-align:left;">
0.91961467696139
</td>
<td style="text-align:left;">
205.597385664745
</td>
<td style="text-align:left;">
-0.0509574460702806
</td>
<td style="text-align:left;">
0.921894094780682
</td>
<td style="text-align:left;">
205.945143306004
</td>
<td style="text-align:left;">
-0.0557204455206461
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Pr…t..
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.0397984032097113
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.0117151185126433
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.000447277200167272
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.37139389802397e-18
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
7.79141497751766e-23
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Std.Error
</td>
<td style="text-align:left;">
0.00387681209575621
</td>
<td style="text-align:left;">
1.4955473831309
</td>
<td style="text-align:left;">
0.00752730297891317
</td>
<td style="text-align:left;">
0.00411253488213795
</td>
<td style="text-align:left;">
1.59266949679221
</td>
<td style="text-align:left;">
0.00799217807522278
</td>
<td style="text-align:left;">
0.000728323735328998
</td>
<td style="text-align:left;">
0.352701518968252
</td>
<td style="text-align:left;">
0.000612792699568233
</td>
<td style="text-align:left;">
0.00331108017589107
</td>
<td style="text-align:left;">
1.25083486490652
</td>
<td style="text-align:left;">
0.00578476859618168
</td>
<td style="text-align:left;">
0.00317113547025635
</td>
<td style="text-align:left;">
1.22639878616071
</td>
<td style="text-align:left;">
0.00565696328562864
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_tvalue
</td>
<td style="text-align:left;">
224.840892330022
</td>
<td style="text-align:left;">
126.403823119306
</td>
<td style="text-align:left;">
-2.05597660181154
</td>
<td style="text-align:left;">
207.168832400006
</td>
<td style="text-align:left;">
116.357025971267
</td>
<td style="text-align:left;">
2.52085521254888
</td>
<td style="text-align:left;">
594.262183761197
</td>
<td style="text-align:left;">
538.353209678558
</td>
<td style="text-align:left;">
3.51088227277012
</td>
<td style="text-align:left;">
277.738571133786
</td>
<td style="text-align:left;">
164.368128386085
</td>
<td style="text-align:left;">
-8.80889965139067
</td>
<td style="text-align:left;">
290.714194782148
</td>
<td style="text-align:left;">
167.926734460268
</td>
<td style="text-align:left;">
-9.84988636256528
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
-0.000146104685986986
</td>
<td style="text-align:left;">
0.637023553461055
</td>
<td style="text-align:left;">
-0.000903390591533867
</td>
<td style="text-align:left;">
-0.000116898230009949
</td>
<td style="text-align:left;">
0.649394003614758
</td>
<td style="text-align:left;">
-0.000941137072743919
</td>
<td style="text-align:left;">
0.00122231975126219
</td>
<td style="text-align:left;">
1.32870822160235
</td>
<td style="text-align:left;">
-0.000845938526704796
</td>
<td style="text-align:left;">
-0.000489534836079617
</td>
<td style="text-align:left;">
0.580023505722658
</td>
<td style="text-align:left;">
-0.00156196911156061
</td>
<td style="text-align:left;">
3.23596154259101e-05
</td>
<td style="text-align:left;">
0.65551206304675
</td>
<td style="text-align:left;">
-0.00115432723977403
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr…t..
</td>
<td style="text-align:left;">
0.136011583497549
</td>
<td style="text-align:left;">
2.96480083692757e-63
</td>
<td style="text-align:left;">
2.05763549729273e-06
</td>
<td style="text-align:left;">
0.230228828649018
</td>
<td style="text-align:left;">
7.43034302413852e-66
</td>
<td style="text-align:left;">
6.66901196231733e-07
</td>
<td style="text-align:left;">
1.22269348058816e-13
</td>
<td style="text-align:left;">
6.75367630221077e-62
</td>
<td style="text-align:left;">
4.32675510884621e-09
</td>
<td style="text-align:left;">
7.77000489086602e-07
</td>
<td style="text-align:left;">
7.42419220783427e-54
</td>
<td style="text-align:left;">
1.40362012201826e-19
</td>
<td style="text-align:left;">
0.740027016459552
</td>
<td style="text-align:left;">
4.09082062947785e-67
</td>
<td style="text-align:left;">
2.75472781728448e-11
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
9.79994437486573e-05
</td>
<td style="text-align:left;">
0.0378027371614794
</td>
<td style="text-align:left;">
0.000190221503167431
</td>
<td style="text-align:left;">
9.74307633896921e-05
</td>
<td style="text-align:left;">
0.037739875283113
</td>
<td style="text-align:left;">
0.000189270503626621
</td>
<td style="text-align:left;">
0.000164767846917989
</td>
<td style="text-align:left;">
0.0798131859486402
</td>
<td style="text-align:left;">
0.000144040382619518
</td>
<td style="text-align:left;">
9.90410500454311e-05
</td>
<td style="text-align:left;">
0.0374185042114355
</td>
<td style="text-align:left;">
0.000172365145002826
</td>
<td style="text-align:left;">
9.75208524392668e-05
</td>
<td style="text-align:left;">
0.0377202854835204
</td>
<td style="text-align:left;">
0.000173241059789276
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_tvalue
</td>
<td style="text-align:left;">
-1.49087260496811
</td>
<td style="text-align:left;">
16.8512547316329
</td>
<td style="text-align:left;">
-4.74915073475531
</td>
<td style="text-align:left;">
-1.19980821193398
</td>
<td style="text-align:left;">
17.2071051836606
</td>
<td style="text-align:left;">
-4.97244448929308
</td>
<td style="text-align:left;">
7.41843614592224
</td>
<td style="text-align:left;">
16.6477281392748
</td>
<td style="text-align:left;">
-5.872926128913
</td>
<td style="text-align:left;">
-4.94274682926991
</td>
<td style="text-align:left;">
15.5009805428138
</td>
<td style="text-align:left;">
-9.0619777654873
</td>
<td style="text-align:left;">
0.331822524275644
</td>
<td style="text-align:left;">
17.3782370584956
</td>
<td style="text-align:left;">
-6.66312732777158
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00243408846205622
</td>
<td style="text-align:left;">
0.699072500364623
</td>
<td style="text-align:left;">
-0.00395676177098486
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Pr…t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
8.01672708877986e-120
</td>
<td style="text-align:left;">
4.71331900885298e-67
</td>
<td style="text-align:left;">
7.94646124029527e-85
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000103833679413418
</td>
<td style="text-align:left;">
0.0402492068645167
</td>
<td style="text-align:left;">
0.000201721108117477
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
23.4421863484661
</td>
<td style="text-align:left;">
17.3686031309332
</td>
<td style="text-align:left;">
-19.6150110809452
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.21045655488185
</td>
<td style="text-align:left;">
106.678721085969
</td>
<td style="text-align:left;">
0.451733304543324
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Pr…t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.93494257274268e-41
</td>
<td style="text-align:left;">
3.2548345535026e-45
</td>
<td style="text-align:left;">
4.82890644822007e-250
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0155791042075745
</td>
<td style="text-align:left;">
7.54496977117083
</td>
<td style="text-align:left;">
0.0132483771350785
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
13.508899618216
</td>
<td style="text-align:left;">
14.1390521528113
</td>
<td style="text-align:left;">
34.0972558327347
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
3.86952250259526e-05
</td>
<td style="text-align:left;">
0.00521731297924587
</td>
<td style="text-align:left;">
0.000149388430455142
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Pr…t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000125048896903791
</td>
<td style="text-align:left;">
0.170833589209346
</td>
<td style="text-align:left;">
2.88060045451681e-17
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.00852286184785e-05
</td>
<td style="text-align:left;">
0.00380941660201464
</td>
<td style="text-align:left;">
1.76593895713687e-05
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
3.83682180045518
</td>
<td style="text-align:left;">
1.36958319982295
</td>
<td style="text-align:left;">
8.45943342783186
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00542428867316449
</td>
<td style="text-align:left;">
0.779514232050632
</td>
<td style="text-align:left;">
0.00526237555581024
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Pr…t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
5.25341325077391e-226
</td>
<td style="text-align:left;">
1.47950939943836e-33
</td>
<td style="text-align:left;">
3.7685780281174e-70
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000166671307872964
</td>
<td style="text-align:left;">
0.06444313759758
</td>
<td style="text-align:left;">
0.000295969260771016
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
32.5448257554855
</td>
<td style="text-align:left;">
12.0961557911467
</td>
<td style="text-align:left;">
17.7801422421419
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-iv-return-all" class="section level5" number="5.1.2.3.6">
<h5><span class="header-section-number">5.1.2.3.6</span> Test Program IV Return All</h5>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="linear-regression.html#cb306-1"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb306-2"><a href="linear-regression.html#cb306-2"></a><span class="kw">t</span>(<span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(</span>
<span id="cb306-3"><a href="linear-regression.html#cb306-3"></a>  <span class="kw">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb306-4"><a href="linear-regression.html#cb306-4"></a>            vars.c, vars.z, df,</span>
<span id="cb306-5"><a href="linear-regression.html#cb306-5"></a>            <span class="dt">return_all =</span> <span class="ot">TRUE</span>,</span>
<span id="cb306-6"><a href="linear-regression.html#cb306-6"></a>            <span class="dt">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>)))) <span class="op">%&gt;%</span></span>
<span id="cb306-7"><a href="linear-regression.html#cb306-7"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb306-8"><a href="linear-regression.html#cb306-8"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
X.Intercept._Estimate
</td>
<td style="text-align:left;">
40.2173991882938
</td>
<td style="text-align:left;">
1408.1626637032
</td>
<td style="text-align:left;">
-64.490636067872
</td>
<td style="text-align:left;">
39.6732302990235
</td>
<td style="text-align:left;">
1325.54736576331
</td>
<td style="text-align:left;">
-59.8304089440729
</td>
<td style="text-align:left;">
35.5561817357046
</td>
<td style="text-align:left;">
-2791.221534909
</td>
<td style="text-align:left;">
21.8005242861645
</td>
<td style="text-align:left;">
24.3009261707644
</td>
<td style="text-align:left;">
-499.067024090554
</td>
<td style="text-align:left;">
21.4632286881661
</td>
<td style="text-align:left;">
25.299209739617
</td>
<td style="text-align:left;">
-352.278518334717
</td>
<td style="text-align:left;">
17.9359211844992
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Pr…z..
</td>
<td style="text-align:left;">
3.69748206920405e-59
</td>
<td style="text-align:left;">
0.00217397545504963
</td>
<td style="text-align:left;">
0.000109756271656929
</td>
<td style="text-align:left;">
1.30030240177373e-103
</td>
<td style="text-align:left;">
0.00138952700443324
</td>
<td style="text-align:left;">
3.75547414421179e-07
</td>
<td style="text-align:left;">
2.01357089467444e-142
</td>
<td style="text-align:left;">
1.95034793045284e-05
</td>
<td style="text-align:left;">
1.17899313785408e-34
</td>
<td style="text-align:left;">
1.97968607369592e-84
</td>
<td style="text-align:left;">
0.155922992163314
</td>
<td style="text-align:left;">
1.84405333738942e-09
</td>
<td style="text-align:left;">
1.29388565624566e-157
</td>
<td style="text-align:left;">
0.287184942021997
</td>
<td style="text-align:left;">
1.13855583530306e-12
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Std.Error
</td>
<td style="text-align:left;">
2.47963650430699
</td>
<td style="text-align:left;">
459.377029874119
</td>
<td style="text-align:left;">
16.673099250727
</td>
<td style="text-align:left;">
1.83545587849039
</td>
<td style="text-align:left;">
414.645900526211
</td>
<td style="text-align:left;">
11.7754321198995
</td>
<td style="text-align:left;">
1.39936229104453
</td>
<td style="text-align:left;">
653.605248808641
</td>
<td style="text-align:left;">
1.77547715237629
</td>
<td style="text-align:left;">
1.2481331128579
</td>
<td style="text-align:left;">
351.723712333143
</td>
<td style="text-align:left;">
3.57067054655531
</td>
<td style="text-align:left;">
0.945826571474308
</td>
<td style="text-align:left;">
330.990098562619
</td>
<td style="text-align:left;">
2.52170174723203
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._zvalue
</td>
<td style="text-align:left;">
16.2190704639323
</td>
<td style="text-align:left;">
3.06537456626657
</td>
<td style="text-align:left;">
-3.86794531107106
</td>
<td style="text-align:left;">
21.6149190857443
</td>
<td style="text-align:left;">
3.19681772828602
</td>
<td style="text-align:left;">
-5.08095230263053
</td>
<td style="text-align:left;">
25.4088465605032
</td>
<td style="text-align:left;">
-4.27050048939585
</td>
<td style="text-align:left;">
12.2786847788984
</td>
<td style="text-align:left;">
19.4698193008609
</td>
<td style="text-align:left;">
-1.41891776582254
</td>
<td style="text-align:left;">
6.01097984491234
</td>
<td style="text-align:left;">
26.748254386829
</td>
<td style="text-align:left;">
-1.0643173915611
</td>
<td style="text-align:left;">
7.11262590993832
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.403139725681418
</td>
<td style="text-align:left;">
35.5765914326678
</td>
<td style="text-align:left;">
1.20995060148712
</td>
<td style="text-align:left;">
0.357976348180876
</td>
<td style="text-align:left;">
31.0172706497394
</td>
<td style="text-align:left;">
1.5037447089682
</td>
<td style="text-align:left;">
0.460434521499963
</td>
<td style="text-align:left;">
59.1545587745268
</td>
<td style="text-align:left;">
0.412512139031067
</td>
<td style="text-align:left;">
0.515794899569023
</td>
<td style="text-align:left;">
46.2591615803265
</td>
<td style="text-align:left;">
0.520812513246773
</td>
<td style="text-align:left;">
0.510868687340428
</td>
<td style="text-align:left;">
45.5654716961559
</td>
<td style="text-align:left;">
0.534362107844268
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr…z..
</td>
<td style="text-align:left;">
1.25009876641748e-13
</td>
<td style="text-align:left;">
0.000445802636381424
</td>
<td style="text-align:left;">
0.00097112649404847
</td>
<td style="text-align:left;">
2.82141265004339e-17
</td>
<td style="text-align:left;">
0.0013100303315764
</td>
<td style="text-align:left;">
3.70002169470828e-08
</td>
<td style="text-align:left;">
2.98739737280869e-37
</td>
<td style="text-align:left;">
0.000542570320022534
</td>
<td style="text-align:left;">
3.02226357947691e-20
</td>
<td style="text-align:left;">
8.57492956381676e-59
</td>
<td style="text-align:left;">
2.8561488738123e-07
</td>
<td style="text-align:left;">
1.10039023747789e-08
</td>
<td style="text-align:left;">
3.24936430168307e-102
</td>
<td style="text-align:left;">
6.3454545304127e-08
</td>
<td style="text-align:left;">
3.42500501176006e-17
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0543948312973965
</td>
<td style="text-align:left;">
10.1318250572006
</td>
<td style="text-align:left;">
0.366789440587685
</td>
<td style="text-align:left;">
0.0423453726223874
</td>
<td style="text-align:left;">
9.65135595900306
</td>
<td style="text-align:left;">
0.273179527952317
</td>
<td style="text-align:left;">
0.0361031059207763
</td>
<td style="text-align:left;">
17.1025823111635
</td>
<td style="text-align:left;">
0.0447499166716409
</td>
<td style="text-align:left;">
0.0319035514861838
</td>
<td style="text-align:left;">
9.01263684093548
</td>
<td style="text-align:left;">
0.0911390672920558
</td>
<td style="text-align:left;">
0.0237991645877977
</td>
<td style="text-align:left;">
8.42434865398195
</td>
<td style="text-align:left;">
0.063380058773461
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
7.41136089709158
</td>
<td style="text-align:left;">
3.51137048180512
</td>
<td style="text-align:left;">
3.29876072644971
</td>
<td style="text-align:left;">
8.45373003027063
</td>
<td style="text-align:left;">
3.21377335801252
</td>
<td style="text-align:left;">
5.50460248701607
</td>
<td style="text-align:left;">
12.7533216258548
</td>
<td style="text-align:left;">
3.45880859967647
</td>
<td style="text-align:left;">
9.21816552325528
</td>
<td style="text-align:left;">
16.1673191711084
</td>
<td style="text-align:left;">
5.13270005180026
</td>
<td style="text-align:left;">
5.71448149208973
</td>
<td style="text-align:left;">
21.4658243761363
</td>
<td style="text-align:left;">
5.40878275196011
</td>
<td style="text-align:left;">
8.4310762436216
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.859205733632614
</td>
<td style="text-align:left;">
98.9428234201406
</td>
<td style="text-align:left;">
-6.02451379136132
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr…z..
</td>
<td style="text-align:left;">
6.88427338202428e-19
</td>
<td style="text-align:left;">
2.09631602352917e-08
</td>
<td style="text-align:left;">
2.94171378745816e-20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.0967928354481331
</td>
<td style="text-align:left;">
17.6561952052848
</td>
<td style="text-align:left;">
0.653342710289155
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
8.87674929300964
</td>
<td style="text-align:left;">
5.60385871756365
</td>
<td style="text-align:left;">
-9.22106223347162
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.154043421788007
</td>
<td style="text-align:left;">
333.799680049259
</td>
<td style="text-align:left;">
5.41175429817609
</td>
<td style="text-align:left;">
0.106307556057668
</td>
<td style="text-align:left;">
330.452608866758
</td>
<td style="text-align:left;">
5.83118942788808
</td>
<td style="text-align:left;">
1.80283907885782
</td>
<td style="text-align:left;">
997.747599807148
</td>
<td style="text-align:left;">
-0.452827875182598
</td>
<td style="text-align:left;">
1.02741625216018
</td>
<td style="text-align:left;">
411.365911332896
</td>
<td style="text-align:left;">
-0.789122421167432
</td>
<td style="text-align:left;">
1.02009164592608
</td>
<td style="text-align:left;">
409.820707458838
</td>
<td style="text-align:left;">
-0.746032636368145
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr…z..
</td>
<td style="text-align:left;">
0.38807812932888
</td>
<td style="text-align:left;">
5.06413216642981e-24
</td>
<td style="text-align:left;">
5.80077629932476e-06
</td>
<td style="text-align:left;">
0.423490075745117
</td>
<td style="text-align:left;">
2.52735690930834e-27
</td>
<td style="text-align:left;">
6.12283824664132e-12
</td>
<td style="text-align:left;">
1.1689328480129e-65
</td>
<td style="text-align:left;">
2.02347084785411e-89
</td>
<td style="text-align:left;">
0.000647195788038449
</td>
<td style="text-align:left;">
1.69796551008584e-27
</td>
<td style="text-align:left;">
2.05327249429949e-54
</td>
<td style="text-align:left;">
0.00428270841484855
</td>
<td style="text-align:left;">
1.70848440093529e-51
</td>
<td style="text-align:left;">
2.36314216739034e-62
</td>
<td style="text-align:left;">
6.57521045473888e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.178475271469781
</td>
<td style="text-align:left;">
33.0216035385405
</td>
<td style="text-align:left;">
1.19371921154418
</td>
<td style="text-align:left;">
0.132821186086547
</td>
<td style="text-align:left;">
30.5174257711927
</td>
<td style="text-align:left;">
0.847955715223327
</td>
<td style="text-align:left;">
0.105343525210948
</td>
<td style="text-align:left;">
49.7632792630648
</td>
<td style="text-align:left;">
0.132754263303719
</td>
<td style="text-align:left;">
0.0945646985181925
</td>
<td style="text-align:left;">
26.4822313532216
</td>
<td style="text-align:left;">
0.276250047248363
</td>
<td style="text-align:left;">
0.0675715533063635
</td>
<td style="text-align:left;">
24.5920104216267
</td>
<td style="text-align:left;">
0.18692145837209
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
0.86310792817082
</td>
<td style="text-align:left;">
10.1085242471545
</td>
<td style="text-align:left;">
4.53352366774387
</td>
<td style="text-align:left;">
0.800381017440976
</td>
<td style="text-align:left;">
10.8283251459136
</td>
<td style="text-align:left;">
6.87676174970095
</td>
<td style="text-align:left;">
17.113904962338
</td>
<td style="text-align:left;">
20.0498764266063
</td>
<td style="text-align:left;">
-3.41102322376347
</td>
<td style="text-align:left;">
10.8646912458831
</td>
<td style="text-align:left;">
15.5336574870174
</td>
<td style="text-align:left;">
-2.85655126226267
</td>
<td style="text-align:left;">
15.0964658352764
</td>
<td style="text-align:left;">
16.6647907361992
</td>
<td style="text-align:left;">
-3.99115565898846
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Estimate
</td>
<td style="text-align:left;">
0.20990165085783
</td>
<td style="text-align:left;">
121.78985943172
</td>
<td style="text-align:left;">
4.84745570027424
</td>
<td style="text-align:left;">
0.322893837128574
</td>
<td style="text-align:left;">
135.494858749214
</td>
<td style="text-align:left;">
4.07024693316581
</td>
<td style="text-align:left;">
0.433164820953121
</td>
<td style="text-align:left;">
190.07735139541
</td>
<td style="text-align:left;">
0.0137438264666969
</td>
<td style="text-align:left;">
1.00582859923509
</td>
<td style="text-align:left;">
218.549980922774
</td>
<td style="text-align:left;">
-0.369567838754916
</td>
<td style="text-align:left;">
0.929266902426869
</td>
<td style="text-align:left;">
207.078222946319
</td>
<td style="text-align:left;">
-0.0985678389223824
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Pr…z..
</td>
<td style="text-align:left;">
0.00846239710392287
</td>
<td style="text-align:left;">
5.96047652813855e-17
</td>
<td style="text-align:left;">
2.07373887977152e-19
</td>
<td style="text-align:left;">
9.66146445882893e-11
</td>
<td style="text-align:left;">
4.48931446042076e-34
</td>
<td style="text-align:left;">
5.64723572160763e-36
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.57416908709431e-66
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2.42696379701225e-102
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.84569897952709e-27
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Std.Error
</td>
<td style="text-align:left;">
0.0797183179471441
</td>
<td style="text-align:left;">
14.5577085129475
</td>
<td style="text-align:left;">
0.538050140685815
</td>
<td style="text-align:left;">
0.0498896912188091
</td>
<td style="text-align:left;">
11.133488331472
</td>
<td style="text-align:left;">
0.325043349284718
</td>
<td style="text-align:left;">
0.00120472816008751
</td>
<td style="text-align:left;">
0.739269879490032
</td>
<td style="text-align:left;">
0.000797655931686456
</td>
<td style="text-align:left;">
0.00746867714609297
</td>
<td style="text-align:left;">
1.9315711781906
</td>
<td style="text-align:left;">
0.0172056989832505
</td>
<td style="text-align:left;">
0.00539330635998817
</td>
<td style="text-align:left;">
1.46167854745858
</td>
<td style="text-align:left;">
0.00907867488118012
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_zvalue
</td>
<td style="text-align:left;">
2.63304164291327
</td>
<td style="text-align:left;">
8.36600480930094
</td>
<td style="text-align:left;">
9.00930105527994
</td>
<td style="text-align:left;">
6.47215545416802
</td>
<td style="text-align:left;">
12.1700274626596
</td>
<td style="text-align:left;">
12.5221664806331
</td>
<td style="text-align:left;">
359.553993426746
</td>
<td style="text-align:left;">
257.11496798237
</td>
<td style="text-align:left;">
17.2302692435808
</td>
<td style="text-align:left;">
134.672925279848
</td>
<td style="text-align:left;">
113.146221785884
</td>
<td style="text-align:left;">
-21.4793853545086
</td>
<td style="text-align:left;">
172.300040161061
</td>
<td style="text-align:left;">
141.671520941705
</td>
<td style="text-align:left;">
-10.8570733297996
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df2
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
25092
</td>
<td style="text-align:left;">
25102
</td>
<td style="text-align:left;">
30013
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_p.value
</td>
<td style="text-align:left;">
1.42153759923994e-19
</td>
<td style="text-align:left;">
4.45734829676713e-19
</td>
<td style="text-align:left;">
5.72345606957941e-20
</td>
<td style="text-align:left;">
1.77770827184424e-37
</td>
<td style="text-align:left;">
4.03760292920738e-37
</td>
<td style="text-align:left;">
5.47447735093002e-38
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_statistic
</td>
<td style="text-align:left;">
82.0931934821266
</td>
<td style="text-align:left;">
79.8251182827386
</td>
<td style="text-align:left;">
83.8989817367586
</td>
<td style="text-align:left;">
164.392129625299
</td>
<td style="text-align:left;">
162.747072038429
</td>
<td style="text-align:left;">
166.75260665498
</td>
<td style="text-align:left;">
7029.47383089383
</td>
<td style="text-align:left;">
7038.38467113128
</td>
<td style="text-align:left;">
12942.6315513372
</td>
<td style="text-align:left;">
1710.98122418591
</td>
<td style="text-align:left;">
1715.15052113399
</td>
<td style="text-align:left;">
1725.71954882902
</td>
<td style="text-align:left;">
5097.88462603711
</td>
<td style="text-align:left;">
5110.7741807338
</td>
<td style="text-align:left;">
5136.55662964887
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
-0.00163274724538111
</td>
<td style="text-align:left;">
0.492582112313709
</td>
<td style="text-align:left;">
0.00999798623641602
</td>
<td style="text-align:left;">
-0.000658938519302931
</td>
<td style="text-align:left;">
0.601258436431587
</td>
<td style="text-align:left;">
0.00326074237566435
</td>
<td style="text-align:left;">
0.00112485055604169
</td>
<td style="text-align:left;">
1.27282038539707
</td>
<td style="text-align:left;">
-0.00512158791392237
</td>
<td style="text-align:left;">
0.000716628918444932
</td>
<td style="text-align:left;">
0.761704518610475
</td>
<td style="text-align:left;">
-0.00601345031606092
</td>
<td style="text-align:left;">
0.000922100117259348
</td>
<td style="text-align:left;">
0.792700893714085
</td>
<td style="text-align:left;">
-0.00668277875606482
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr…z..
</td>
<td style="text-align:left;">
4.88365163639597e-08
</td>
<td style="text-align:left;">
2.33136555228405e-20
</td>
<td style="text-align:left;">
7.95432753711715e-07
</td>
<td style="text-align:left;">
0.00032843149807424
</td>
<td style="text-align:left;">
2.0921134733036e-48
</td>
<td style="text-align:left;">
0.00667886646012294
</td>
<td style="text-align:left;">
2.26123807446765e-11
</td>
<td style="text-align:left;">
6.67525280062144e-56
</td>
<td style="text-align:left;">
6.51923753120087e-127
</td>
<td style="text-align:left;">
2.43477572076212e-06
</td>
<td style="text-align:left;">
8.2201479288098e-69
</td>
<td style="text-align:left;">
5.19751747217521e-44
</td>
<td style="text-align:left;">
1.68237436753105e-15
</td>
<td style="text-align:left;">
4.81415543564975e-82
</td>
<td style="text-align:left;">
2.54848840100353e-105
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.00029928487659495
</td>
<td style="text-align:left;">
0.0532753838702833
</td>
<td style="text-align:left;">
0.00202532507408065
</td>
<td style="text-align:left;">
0.000183457551985601
</td>
<td style="text-align:left;">
0.0411255751282477
</td>
<td style="text-align:left;">
0.00120214094164169
</td>
<td style="text-align:left;">
0.000168187467853553
</td>
<td style="text-align:left;">
0.08080475140115
</td>
<td style="text-align:left;">
0.000213715312589078
</td>
<td style="text-align:left;">
0.000152036990658929
</td>
<td style="text-align:left;">
0.0434474820359048
</td>
<td style="text-align:left;">
0.00043218241369976
</td>
<td style="text-align:left;">
0.00011580150512068
</td>
<td style="text-align:left;">
0.0413159097814445
</td>
<td style="text-align:left;">
0.000306609919182859
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
-5.45549532591606
</td>
<td style="text-align:left;">
9.24596082710666
</td>
<td style="text-align:left;">
4.93648469787221
</td>
<td style="text-align:left;">
-3.59177647456371
</td>
<td style="text-align:left;">
14.6200614716414
</td>
<td style="text-align:left;">
2.71244598924594
</td>
<td style="text-align:left;">
6.68807593334564
</td>
<td style="text-align:left;">
15.7518012657231
</td>
<td style="text-align:left;">
-23.9645341827701
</td>
<td style="text-align:left;">
4.71351685756907
</td>
<td style="text-align:left;">
17.531614789115
</td>
<td style="text-align:left;">
-13.9141485757875
</td>
<td style="text-align:left;">
7.96276452796019
</td>
<td style="text-align:left;">
19.1863351892132
</td>
<td style="text-align:left;">
-21.7957030675165
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_df1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_df2
</td>
<td style="text-align:left;">
18956
</td>
<td style="text-align:left;">
18961
</td>
<td style="text-align:left;">
18998
</td>
<td style="text-align:left;">
18956
</td>
<td style="text-align:left;">
18961
</td>
<td style="text-align:left;">
18998
</td>
<td style="text-align:left;">
25091
</td>
<td style="text-align:left;">
25101
</td>
<td style="text-align:left;">
30012
</td>
<td style="text-align:left;">
18586
</td>
<td style="text-align:left;">
18590
</td>
<td style="text-align:left;">
18844
</td>
<td style="text-align:left;">
18586
</td>
<td style="text-align:left;">
18590
</td>
<td style="text-align:left;">
18844
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_p.value
</td>
<td style="text-align:left;">
1.53929570343279e-118
</td>
<td style="text-align:left;">
3.13415891402799e-08
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2.88592507054107e-108
</td>
<td style="text-align:left;">
7.6495944085204e-07
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.0221987672063003
</td>
<td style="text-align:left;">
0.0099360023036833
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.80909125272768e-238
</td>
<td style="text-align:left;">
2.14946499922491e-35
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
3.15182965429765e-108
</td>
<td style="text-align:left;">
1.7681125741529e-17
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_statistic
</td>
<td style="text-align:left;">
543.467268879953
</td>
<td style="text-align:left;">
30.6481856102772
</td>
<td style="text-align:left;">
5652.51924792859
</td>
<td style="text-align:left;">
494.955883488045
</td>
<td style="text-align:left;">
24.4605456760994
</td>
<td style="text-align:left;">
5583.56513052781
</td>
<td style="text-align:left;">
5.23078768861684
</td>
<td style="text-align:left;">
6.6473469952822
</td>
<td style="text-align:left;">
25949.7118056025
</td>
<td style="text-align:left;">
1119.87022468742
</td>
<td style="text-align:left;">
154.793296861581
</td>
<td style="text-align:left;">
4826.92242730041
</td>
<td style="text-align:left;">
494.903094649183
</td>
<td style="text-align:left;">
72.530787010352
</td>
<td style="text-align:left;">
7607.83405438193
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238724384575419
</td>
<td style="text-align:left;">
2.71948246216953
</td>
<td style="text-align:left;">
-0.168054407187466
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Pr…z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.44956616452661e-33
</td>
<td style="text-align:left;">
9.21076021290446e-10
</td>
<td style="text-align:left;">
5.67614501764414e-39
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00197718112735887
</td>
<td style="text-align:left;">
0.444177077282291
</td>
<td style="text-align:left;">
0.0128692506794877
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
12.0739764947235
</td>
<td style="text-align:left;">
6.1225187008946
</td>
<td style="text-align:left;">
-13.0586007975839
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.144503490136948
</td>
<td style="text-align:left;">
69.1816142883022
</td>
<td style="text-align:left;">
-1.91414470908345
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Pr…z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
3.72983264926432e-06
</td>
<td style="text-align:left;">
2.23442991281176e-07
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0312379492766376
</td>
<td style="text-align:left;">
13.358888551386
</td>
<td style="text-align:left;">
0.0371054140359243
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
4.62589553677969
</td>
<td style="text-align:left;">
5.17869536991717
</td>
<td style="text-align:left;">
-51.5866689219593
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00148073028434642
</td>
<td style="text-align:left;">
0.221916473012486
</td>
<td style="text-align:left;">
-0.00520794333267238
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Pr…z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2.50759287066563e-156
</td>
<td style="text-align:left;">
8.30126393398654e-33
</td>
<td style="text-align:left;">
3.00201194005694e-197
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
5.55884799941827e-05
</td>
<td style="text-align:left;">
0.0186022369560791
</td>
<td style="text-align:left;">
0.000173813943639721
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
26.6373587567312
</td>
<td style="text-align:left;">
11.9295584469998
</td>
<td style="text-align:left;">
-29.9627476577329
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0141317656200726
</td>
<td style="text-align:left;">
2.11856940494335
</td>
<td style="text-align:left;">
-0.0494468877742109
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Pr…z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2.61782083774363e-226
</td>
<td style="text-align:left;">
4.81511329043196e-35
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000440019589949091
</td>
<td style="text-align:left;">
0.17153115470458
</td>
<td style="text-align:left;">
0.00128926108222202
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
32.1162192385744
</td>
<td style="text-align:left;">
12.3509307017263
</td>
<td style="text-align:left;">
-38.3528894620707
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="program-line-by-line" class="section level4" number="5.1.2.4">
<h4><span class="header-section-number">5.1.2.4</span> Program Line by Line</h4>
<p>Set Up Parameters</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="linear-regression.html#cb307-1"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb307-2"><a href="linear-regression.html#cb307-2"></a>vars.z &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb307-3"><a href="linear-regression.html#cb307-3"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;wgt0&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span></code></pre></div>
<div id="lapply" class="section level5" number="5.1.2.4.1">
<h5><span class="header-section-number">5.1.2.4.1</span> Lapply</h5>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="linear-regression.html#cb308-1"></a>df.reg.out &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(</span>
<span id="cb308-2"><a href="linear-regression.html#cb308-2"></a>  <span class="kw">bind_rows</span>(<span class="kw">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb308-3"><a href="linear-regression.html#cb308-3"></a>                   <span class="dt">vars.x=</span>var.x1, <span class="dt">vars.c=</span>vars.c, <span class="dt">vars.z=</span>vars.z, <span class="dt">df=</span>df)))</span></code></pre></div>
</div>
<div id="nested-lapply-test" class="section level5" number="5.1.2.4.2">
<h5><span class="header-section-number">5.1.2.4.2</span> Nested Lapply Test</h5>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="linear-regression.html#cb309-1"></a><span class="kw">lapply</span>(list.vars.y, <span class="cf">function</span>(y) (<span class="kw">mean</span>(df[[var.x1]], <span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb309-2"><a href="linear-regression.html#cb309-2"></a><span class="st">                                   </span><span class="kw">mean</span>(df[[y]], <span class="dt">na.rm=</span><span class="ot">TRUE</span>)))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 98.3272
## 
## [[2]]
## [1] 13626.51
## 
## [[3]]
## [1] 26.11226</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="linear-regression.html#cb311-1"></a>lapplytwice &lt;-<span class="st"> </span><span class="kw">lapply</span>(</span>
<span id="cb311-2"><a href="linear-regression.html#cb311-2"></a>  list.vars.x, <span class="cf">function</span>(x) (</span>
<span id="cb311-3"><a href="linear-regression.html#cb311-3"></a>    <span class="kw">lapply</span>(list.vars.y, <span class="cf">function</span>(y) (<span class="kw">mean</span>(df[[x]], <span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb311-4"><a href="linear-regression.html#cb311-4"></a><span class="st">                                       </span><span class="kw">mean</span>(df[[y]], <span class="dt">na.rm=</span><span class="ot">TRUE</span>)))))</span>
<span id="cb311-5"><a href="linear-regression.html#cb311-5"></a><span class="co"># lapplytwice</span></span></code></pre></div>
</div>
<div id="nested-lapply-all" class="section level5" number="5.1.2.4.3">
<h5><span class="header-section-number">5.1.2.4.3</span> Nested Lapply All</h5>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="linear-regression.html#cb312-1"></a>df.reg.out.all &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(</span>
<span id="cb312-2"><a href="linear-regression.html#cb312-2"></a>  <span class="kw">lapply</span>(list.vars.x,</span>
<span id="cb312-3"><a href="linear-regression.html#cb312-3"></a>         <span class="cf">function</span>(x) (</span>
<span id="cb312-4"><a href="linear-regression.html#cb312-4"></a>           <span class="kw">bind_rows</span>(</span>
<span id="cb312-5"><a href="linear-regression.html#cb312-5"></a>             <span class="kw">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb312-6"><a href="linear-regression.html#cb312-6"></a>                    <span class="dt">vars.x=</span>x, <span class="dt">vars.c=</span>vars.c, <span class="dt">vars.z=</span>vars.z, <span class="dt">df=</span>df))</span>
<span id="cb312-7"><a href="linear-regression.html#cb312-7"></a>         )))</span></code></pre></div>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="linear-regression.html#cb313-1"></a><span class="co"># df.reg.out.all %&gt;%</span></span>
<span id="cb313-2"><a href="linear-regression.html#cb313-2"></a><span class="co">#   kable() %&gt;%</span></span>
<span id="cb313-3"><a href="linear-regression.html#cb313-3"></a><span class="co">#   kable_styling_fc_wide()</span></span></code></pre></div>
</div>
<div id="nested-lapply-select" class="section level5" number="5.1.2.4.4">
<h5><span class="header-section-number">5.1.2.4.4</span> Nested Lapply Select</h5>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="linear-regression.html#cb314-1"></a>df.reg.out.all &lt;-</span>
<span id="cb314-2"><a href="linear-regression.html#cb314-2"></a><span class="st">  </span>(<span class="kw">lapply</span>(list.vars.x,</span>
<span id="cb314-3"><a href="linear-regression.html#cb314-3"></a>          <span class="cf">function</span>(x) (</span>
<span id="cb314-4"><a href="linear-regression.html#cb314-4"></a>            <span class="kw">bind_rows</span>(<span class="kw">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb314-5"><a href="linear-regression.html#cb314-5"></a>                             <span class="dt">vars.x=</span>x, <span class="dt">vars.c=</span>vars.c, <span class="dt">vars.z=</span>vars.z, <span class="dt">df=</span>df)) <span class="op">%&gt;%</span></span>
<span id="cb314-6"><a href="linear-regression.html#cb314-6"></a><span class="st">              </span><span class="kw">select</span>(vars_var.y, <span class="kw">starts_with</span>(x)) <span class="op">%&gt;%</span></span>
<span id="cb314-7"><a href="linear-regression.html#cb314-7"></a><span class="st">              </span><span class="kw">select</span>(vars_var.y, <span class="kw">ends_with</span>(<span class="st">&#39;value&#39;</span>))</span>
<span id="cb314-8"><a href="linear-regression.html#cb314-8"></a>          ))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">reduce</span>(full_join)</span></code></pre></div>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="linear-regression.html#cb315-1"></a>df.reg.out.all <span class="op">%&gt;%</span></span>
<span id="cb315-2"><a href="linear-regression.html#cb315-2"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb315-3"><a href="linear-regression.html#cb315-3"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_tvalue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
18.8756010031786
</td>
<td style="text-align:left;">
23.4421863484661
</td>
<td style="text-align:left;">
13.508899618216
</td>
<td style="text-align:left;">
3.83682180045518
</td>
<td style="text-align:left;">
32.5448257554855
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
16.3591125056062
</td>
<td style="text-align:left;">
17.3686031309332
</td>
<td style="text-align:left;">
14.1390521528113
</td>
<td style="text-align:left;">
1.36958319982295
</td>
<td style="text-align:left;">
12.0961557911467
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-14.9385580468907
</td>
<td style="text-align:left;">
-19.6150110809452
</td>
<td style="text-align:left;">
34.0972558327347
</td>
<td style="text-align:left;">
8.45943342783186
</td>
<td style="text-align:left;">
17.7801422421419
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</div>
</div>
<div id="decomposition" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Decomposition</h2>

<div id="decompose-rhs" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Decompose RHS</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>One runs a number of regressions. With different outcomes, and various right hand side variables.</p>
<p>What is the remaining variation in the left hand side variable if right hand side variable one by one is set to the average of the observed values.</p>
<ul>
<li>Dependency: <em>R4Econ/linreg/ivreg/ivregdfrow.R</em></li>
</ul>
<p>The code below does not work with categorical variables (except for dummies). Dummy variable inputs need to be converted to zero/one first. The examples are just to test the code with different types of variables.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="linear-regression.html#cb316-1"></a><span class="co"># Library</span></span>
<span id="cb316-2"><a href="linear-regression.html#cb316-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb316-3"><a href="linear-regression.html#cb316-3"></a><span class="kw">library</span>(AER)</span>
<span id="cb316-4"><a href="linear-regression.html#cb316-4"></a></span>
<span id="cb316-5"><a href="linear-regression.html#cb316-5"></a><span class="co"># Load Sample Data</span></span>
<span id="cb316-6"><a href="linear-regression.html#cb316-6"></a><span class="kw">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb316-7"><a href="linear-regression.html#cb316-7"></a>df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span>
<span id="cb316-8"><a href="linear-regression.html#cb316-8"></a></span>
<span id="cb316-9"><a href="linear-regression.html#cb316-9"></a><span class="co"># Source Dependency</span></span>
<span id="cb316-10"><a href="linear-regression.html#cb316-10"></a><span class="kw">source</span>(<span class="st">&#39;C:/Users/fan/R4Econ/linreg/ivreg/ivregdfrow.R&#39;</span>)</span></code></pre></div>
<p>Data Cleaning.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="linear-regression.html#cb317-1"></a><span class="co"># Convert Variable for Sex which is categorical to Numeric</span></span>
<span id="cb317-2"><a href="linear-regression.html#cb317-2"></a>df &lt;-<span class="st"> </span>df</span>
<span id="cb317-3"><a href="linear-regression.html#cb317-3"></a>df<span class="op">$</span>male &lt;-<span class="st"> </span>(<span class="kw">as.numeric</span>(<span class="kw">factor</span>(df<span class="op">$</span>sex)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb317-4"><a href="linear-regression.html#cb317-4"></a><span class="kw">summary</span>(<span class="kw">factor</span>(df<span class="op">$</span>sex))</span></code></pre></div>
<pre><code>## Female   Male 
##  16446  18619</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="linear-regression.html#cb319-1"></a><span class="kw">summary</span>(df<span class="op">$</span>male)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   1.000   0.531   1.000   1.000</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="linear-regression.html#cb321-1"></a>df.use &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(S.country <span class="op">==</span><span class="st"> &#39;Guatemala&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb321-2"><a href="linear-regression.html#cb321-2"></a><span class="st">  </span><span class="kw">filter</span>(svymthRound <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">24</span>))</span>
<span id="cb321-3"><a href="linear-regression.html#cb321-3"></a><span class="kw">dim</span>(df.use)</span></code></pre></div>
<pre><code>## [1] 2022   16</code></pre>
<p>Setting Up Parameters.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="linear-regression.html#cb323-1"></a><span class="co"># Define Left Hand Side Variab les</span></span>
<span id="cb323-2"><a href="linear-regression.html#cb323-2"></a>var.y1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb323-3"><a href="linear-regression.html#cb323-3"></a>var.y2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;wgt&#39;</span>)</span>
<span id="cb323-4"><a href="linear-regression.html#cb323-4"></a>vars.y &lt;-<span class="st"> </span><span class="kw">c</span>(var.y1, var.y2)</span>
<span id="cb323-5"><a href="linear-regression.html#cb323-5"></a><span class="co"># Define Right Hand Side Variables</span></span>
<span id="cb323-6"><a href="linear-regression.html#cb323-6"></a>vars.x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb323-7"><a href="linear-regression.html#cb323-7"></a>vars.c &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;male&#39;</span>, <span class="st">&#39;wgt0&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span>
<span id="cb323-8"><a href="linear-regression.html#cb323-8"></a><span class="co"># vars.z &lt;- c(&#39;p.A.prot&#39;)</span></span>
<span id="cb323-9"><a href="linear-regression.html#cb323-9"></a>vars.z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;vil.id&#39;</span>)</span>
<span id="cb323-10"><a href="linear-regression.html#cb323-10"></a><span class="co"># vars.z &lt;- NULL</span></span>
<span id="cb323-11"><a href="linear-regression.html#cb323-11"></a>vars.xc &lt;-<span class="st"> </span><span class="kw">c</span>(vars.x, vars.c)</span>
<span id="cb323-12"><a href="linear-regression.html#cb323-12"></a></span>
<span id="cb323-13"><a href="linear-regression.html#cb323-13"></a><span class="co"># Other variables to keep</span></span>
<span id="cb323-14"><a href="linear-regression.html#cb323-14"></a>vars.other.keep &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;S.country&#39;</span>, <span class="st">&#39;vil.id&#39;</span>, <span class="st">&#39;indi.id&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span>
<span id="cb323-15"><a href="linear-regression.html#cb323-15"></a></span>
<span id="cb323-16"><a href="linear-regression.html#cb323-16"></a><span class="co"># Decompose sequence</span></span>
<span id="cb323-17"><a href="linear-regression.html#cb323-17"></a>vars.tomean.first &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;male&#39;</span>, <span class="st">&#39;hgt0&#39;</span>)</span>
<span id="cb323-18"><a href="linear-regression.html#cb323-18"></a>var.tomean.first.name.suffix &lt;-<span class="st"> &#39;_mh02m&#39;</span></span>
<span id="cb323-19"><a href="linear-regression.html#cb323-19"></a>vars.tomean.second &lt;-<span class="st"> </span><span class="kw">c</span>(vars.tomean.first, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb323-20"><a href="linear-regression.html#cb323-20"></a>var.tomean.second.name.suffix &lt;-<span class="st"> &#39;_mh0me2m&#39;</span></span>
<span id="cb323-21"><a href="linear-regression.html#cb323-21"></a>vars.tomean.third &lt;-<span class="st"> </span><span class="kw">c</span>(vars.tomean.second, <span class="st">&#39;prot&#39;</span>)</span>
<span id="cb323-22"><a href="linear-regression.html#cb323-22"></a>var.tomean.third.name.suffix &lt;-<span class="st"> &#39;_mh0mep2m&#39;</span></span>
<span id="cb323-23"><a href="linear-regression.html#cb323-23"></a>vars.tomean.fourth &lt;-<span class="st"> </span><span class="kw">c</span>(vars.tomean.third, <span class="st">&#39;svymthRound&#39;</span>)</span>
<span id="cb323-24"><a href="linear-regression.html#cb323-24"></a>var.tomean.fourth.name.suffix &lt;-<span class="st"> &#39;_mh0mepm2m&#39;</span></span>
<span id="cb323-25"><a href="linear-regression.html#cb323-25"></a>list.vars.tomean =<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb323-26"><a href="linear-regression.html#cb323-26"></a><span class="co">#                         vars.tomean.first,</span></span>
<span id="cb323-27"><a href="linear-regression.html#cb323-27"></a>                        vars.tomean.second,</span>
<span id="cb323-28"><a href="linear-regression.html#cb323-28"></a>                        vars.tomean.third,</span>
<span id="cb323-29"><a href="linear-regression.html#cb323-29"></a>                        vars.tomean.fourth</span>
<span id="cb323-30"><a href="linear-regression.html#cb323-30"></a>                        )</span>
<span id="cb323-31"><a href="linear-regression.html#cb323-31"></a>list.vars.tomean.name.suffix &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb323-32"><a href="linear-regression.html#cb323-32"></a><span class="co">#                                     var.tomean.first.name.suffix,</span></span>
<span id="cb323-33"><a href="linear-regression.html#cb323-33"></a>                                     var.tomean.second.name.suffix,</span>
<span id="cb323-34"><a href="linear-regression.html#cb323-34"></a>                                     var.tomean.third.name.suffix,</span>
<span id="cb323-35"><a href="linear-regression.html#cb323-35"></a>                                     var.tomean.fourth.name.suffix</span>
<span id="cb323-36"><a href="linear-regression.html#cb323-36"></a>                                    )</span></code></pre></div>
<div id="obtain-regression-coefficients-from-somewhere" class="section level4" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Obtain Regression Coefficients from somewhere</h4>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="linear-regression.html#cb324-1"></a><span class="co"># Regressions</span></span>
<span id="cb324-2"><a href="linear-regression.html#cb324-2"></a><span class="co"># regf.iv from C:\Users\fan\R4Econ\linreg\ivreg\ivregdfrow.R</span></span>
<span id="cb324-3"><a href="linear-regression.html#cb324-3"></a>df.reg.out &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(</span>
<span id="cb324-4"><a href="linear-regression.html#cb324-4"></a>  <span class="kw">bind_rows</span>(<span class="kw">lapply</span>(vars.y, regf.iv,</span>
<span id="cb324-5"><a href="linear-regression.html#cb324-5"></a>                   <span class="dt">vars.x=</span>vars.x, <span class="dt">vars.c=</span>vars.c, <span class="dt">vars.z=</span>vars.z, <span class="dt">df=</span>df)))</span>
<span id="cb324-6"><a href="linear-regression.html#cb324-6"></a><span class="co"># Regressions</span></span>
<span id="cb324-7"><a href="linear-regression.html#cb324-7"></a><span class="co"># reg1 &lt;- regf.iv(var.y = var.y1, vars.x, vars.c, vars.z, df.use)</span></span>
<span id="cb324-8"><a href="linear-regression.html#cb324-8"></a><span class="co"># reg2 &lt;- regf.iv(var.y = var.y2, vars.x, vars.c, vars.z, df.use)</span></span>
<span id="cb324-9"><a href="linear-regression.html#cb324-9"></a><span class="co"># df.reg.out &lt;- as_tibble(bind_rows(reg1, reg2))</span></span></code></pre></div>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="linear-regression.html#cb325-1"></a><span class="co"># df.reg.out</span></span></code></pre></div>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="linear-regression.html#cb326-1"></a><span class="co"># Select Variables</span></span>
<span id="cb326-2"><a href="linear-regression.html#cb326-2"></a>str.esti.suffix &lt;-<span class="st"> &#39;_Estimate&#39;</span></span>
<span id="cb326-3"><a href="linear-regression.html#cb326-3"></a>arr.esti.name &lt;-<span class="st"> </span><span class="kw">paste0</span>(vars.xc, str.esti.suffix)</span>
<span id="cb326-4"><a href="linear-regression.html#cb326-4"></a>str.outcome.name &lt;-<span class="st"> &#39;vars_var.y&#39;</span></span>
<span id="cb326-5"><a href="linear-regression.html#cb326-5"></a>arr.columns2select &lt;-<span class="st"> </span><span class="kw">c</span>(arr.esti.name, str.outcome.name)</span>
<span id="cb326-6"><a href="linear-regression.html#cb326-6"></a>arr.columns2select</span></code></pre></div>
<pre><code>## [1] &quot;prot_Estimate&quot;        &quot;male_Estimate&quot;        &quot;wgt0_Estimate&quot;        &quot;hgt0_Estimate&quot;        &quot;svymthRound_Estimate&quot;
## [6] &quot;vars_var.y&quot;</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="linear-regression.html#cb328-1"></a><span class="co"># Generate dataframe for coefficients</span></span>
<span id="cb328-2"><a href="linear-regression.html#cb328-2"></a>df.coef &lt;-<span class="st"> </span>df.reg.out[,<span class="kw">c</span>(arr.columns2select)] <span class="op">%&gt;%</span></span>
<span id="cb328-3"><a href="linear-regression.html#cb328-3"></a><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(arr.esti.name), as.numeric) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">column_to_rownames</span>(str.outcome.name)</span>
<span id="cb328-4"><a href="linear-regression.html#cb328-4"></a>df.coef <span class="op">%&gt;%</span></span>
<span id="cb328-5"><a href="linear-regression.html#cb328-5"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb328-6"><a href="linear-regression.html#cb328-6"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound_Estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
-0.2714772
</td>
<td style="text-align:right;">
1.244735
</td>
<td style="text-align:right;">
0.0004430
</td>
<td style="text-align:right;">
0.6834853
</td>
<td style="text-align:right;">
1.133919
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:right;">
-59.0727542
</td>
<td style="text-align:right;">
489.852902
</td>
<td style="text-align:right;">
0.7696158
</td>
<td style="text-align:right;">
75.4867897
</td>
<td style="text-align:right;">
250.778883
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="linear-regression.html#cb329-1"></a><span class="kw">str</span>(df.coef)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2 obs. of  5 variables:
##  $ prot_Estimate       : num  -0.271 -59.073
##  $ male_Estimate       : num  1.24 489.85
##  $ wgt0_Estimate       : num  0.000443 0.769616
##  $ hgt0_Estimate       : num  0.683 75.487
##  $ svymthRound_Estimate: num  1.13 250.78</code></pre>
</div>
<div id="decomposition-step-1" class="section level4" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Decomposition Step 1</h4>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="linear-regression.html#cb331-1"></a><span class="co"># Decomposition Step 1: gather</span></span>
<span id="cb331-2"><a href="linear-regression.html#cb331-2"></a>df.decompose_step1 &lt;-<span class="st"> </span>df.use <span class="op">%&gt;%</span></span>
<span id="cb331-3"><a href="linear-regression.html#cb331-3"></a><span class="st">                        </span><span class="kw">filter</span>(svymthRound <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">24</span>)) <span class="op">%&gt;%</span></span>
<span id="cb331-4"><a href="linear-regression.html#cb331-4"></a><span class="st">                        </span><span class="kw">select</span>(<span class="kw">one_of</span>(<span class="kw">c</span>(vars.other.keep, vars.xc, vars.y))) <span class="op">%&gt;%</span></span>
<span id="cb331-5"><a href="linear-regression.html#cb331-5"></a><span class="st">                        </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span></span>
<span id="cb331-6"><a href="linear-regression.html#cb331-6"></a><span class="st">                        </span><span class="kw">gather</span>(variable, value, <span class="op">-</span><span class="kw">one_of</span>(<span class="kw">c</span>(vars.other.keep, vars.xc)))</span>
<span id="cb331-7"><a href="linear-regression.html#cb331-7"></a><span class="kw">options</span>(<span class="dt">repr.matrix.max.rows=</span><span class="dv">20</span>, <span class="dt">repr.matrix.max.cols=</span><span class="dv">20</span>)</span>
<span id="cb331-8"><a href="linear-regression.html#cb331-8"></a><span class="kw">dim</span>(df.decompose_step1)</span></code></pre></div>
<pre><code>## [1] 1382   10</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="linear-regression.html#cb333-1"></a><span class="kw">head</span>(df.decompose_step1, <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb333-2"><a href="linear-regression.html#cb333-2"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb333-3"><a href="linear-regression.html#cb333-3"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
46.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
9.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
30.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
</tr>
</tbody>
</table>
</div>
<div id="decomposition-step-2" class="section level4" number="5.2.1.3">
<h4><span class="header-section-number">5.2.1.3</span> Decomposition Step 2</h4>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="linear-regression.html#cb334-1"></a><span class="co"># Decomposition Step 2: mutate_at(vars, funs(mean = mean(.)))</span></span>
<span id="cb334-2"><a href="linear-regression.html#cb334-2"></a><span class="co"># the xc averaging could have taken place earlier, no difference in mean across variables</span></span>
<span id="cb334-3"><a href="linear-regression.html#cb334-3"></a>df.decompose_step2 &lt;-<span class="st"> </span>df.decompose_step1 <span class="op">%&gt;%</span></span>
<span id="cb334-4"><a href="linear-regression.html#cb334-4"></a><span class="st">                        </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span></span>
<span id="cb334-5"><a href="linear-regression.html#cb334-5"></a><span class="st">                        </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="kw">c</span>(vars.xc, <span class="st">&#39;value&#39;</span>)), <span class="kw">funs</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb334-6"><a href="linear-regression.html#cb334-6"></a><span class="st">                        </span><span class="kw">ungroup</span>()</span>
<span id="cb334-7"><a href="linear-regression.html#cb334-7"></a></span>
<span id="cb334-8"><a href="linear-regression.html#cb334-8"></a><span class="kw">options</span>(<span class="dt">repr.matrix.max.rows=</span><span class="dv">20</span>, <span class="dt">repr.matrix.max.cols=</span><span class="dv">20</span>)</span>
<span id="cb334-9"><a href="linear-regression.html#cb334-9"></a><span class="kw">dim</span>(df.decompose_step2)</span></code></pre></div>
<pre><code>## [1] 1382   16</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="linear-regression.html#cb336-1"></a><span class="kw">head</span>(df.decompose_step2,<span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb336-2"><a href="linear-regression.html#cb336-2"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb336-3"><a href="linear-regression.html#cb336-3"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
46.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
9.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
30.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="decomposition-step-3-non-loop" class="section level4" number="5.2.1.4">
<h4><span class="header-section-number">5.2.1.4</span> Decomposition Step 3 Non-Loop</h4>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="linear-regression.html#cb337-1"></a>ff_lr_decompose_valadj &lt;-<span class="st"> </span><span class="cf">function</span>(df, df.coef, vars.tomean, str.esti.suffix) {</span>
<span id="cb337-2"><a href="linear-regression.html#cb337-2"></a>  new_value &lt;-<span class="st"> </span>(df<span class="op">$</span>value <span class="op">+</span></span>
<span id="cb337-3"><a href="linear-regression.html#cb337-3"></a><span class="st">                  </span><span class="kw">rowSums</span>((df[<span class="kw">paste0</span>(vars.tomean, <span class="st">&#39;_mean&#39;</span>)] <span class="op">-</span><span class="st"> </span>df[vars.tomean])</span>
<span id="cb337-4"><a href="linear-regression.html#cb337-4"></a>                          <span class="op">*</span>df.coef[df<span class="op">$</span>variable, <span class="kw">paste0</span>(vars.tomean, str.esti.suffix)]))</span>
<span id="cb337-5"><a href="linear-regression.html#cb337-5"></a>  <span class="kw">return</span>(new_value)</span>
<span id="cb337-6"><a href="linear-regression.html#cb337-6"></a>}</span></code></pre></div>
</div>
<div id="decomposition-step-3-with-loop" class="section level4" number="5.2.1.5">
<h4><span class="header-section-number">5.2.1.5</span> Decomposition Step 3 With Loop</h4>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="linear-regression.html#cb338-1"></a>df.decompose_step3 &lt;-<span class="st"> </span>df.decompose_step2</span>
<span id="cb338-2"><a href="linear-regression.html#cb338-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(list.vars.tomean)) {</span>
<span id="cb338-3"><a href="linear-regression.html#cb338-3"></a>    var.decomp.cur &lt;-<span class="st"> </span>(<span class="kw">paste0</span>(<span class="st">&#39;value&#39;</span>, list.vars.tomean.name.suffix[[i]]))</span>
<span id="cb338-4"><a href="linear-regression.html#cb338-4"></a>    vars.tomean &lt;-<span class="st"> </span>list.vars.tomean[[i]]</span>
<span id="cb338-5"><a href="linear-regression.html#cb338-5"></a>    var.decomp.cur</span>
<span id="cb338-6"><a href="linear-regression.html#cb338-6"></a>    df.decompose_step3 &lt;-<span class="st"> </span>df.decompose_step3 <span class="op">%&gt;%</span></span>
<span id="cb338-7"><a href="linear-regression.html#cb338-7"></a><span class="st">      </span><span class="kw">mutate</span>((<span class="op">!!</span>var.decomp.cur) <span class="op">:</span><span class="er">=</span></span>
<span id="cb338-8"><a href="linear-regression.html#cb338-8"></a><span class="st">               </span><span class="kw">ff_lr_decompose_valadj</span>(., df.coef, vars.tomean, str.esti.suffix))</span>
<span id="cb338-9"><a href="linear-regression.html#cb338-9"></a></span>
<span id="cb338-10"><a href="linear-regression.html#cb338-10"></a>}</span>
<span id="cb338-11"><a href="linear-regression.html#cb338-11"></a></span>
<span id="cb338-12"><a href="linear-regression.html#cb338-12"></a><span class="kw">dim</span>(df.decompose_step3)</span></code></pre></div>
<pre><code>## [1] 1382   19</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="linear-regression.html#cb340-1"></a><span class="kw">head</span>(df.decompose_step3, <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb340-2"><a href="linear-regression.html#cb340-2"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb340-3"><a href="linear-regression.html#cb340-3"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.19390
</td>
<td style="text-align:right;">
71.19903
</td>
<td style="text-align:right;">
71.68148
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
46.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
78.79390
</td>
<td style="text-align:right;">
85.75778
</td>
<td style="text-align:right;">
79.43671
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
63.61689
</td>
<td style="text-align:right;">
58.28285
</td>
<td style="text-align:right;">
65.56882
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
9.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
66.51689
</td>
<td style="text-align:right;">
63.57185
</td>
<td style="text-align:right;">
64.05430
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
72.61689
</td>
<td style="text-align:right;">
71.19213
</td>
<td style="text-align:right;">
64.87106
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
64.33707
</td>
<td style="text-align:right;">
61.06626
</td>
<td style="text-align:right;">
68.35222
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
70.33707
</td>
<td style="text-align:right;">
69.56385
</td>
<td style="text-align:right;">
70.04630
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
30.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.33707
</td>
<td style="text-align:right;">
76.01161
</td>
<td style="text-align:right;">
69.69055
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
66.83353
</td>
<td style="text-align:right;">
61.49949
</td>
<td style="text-align:right;">
68.78545
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.13353
</td>
<td style="text-align:right;">
70.97578
</td>
<td style="text-align:right;">
71.45823
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="decomposition-step-4-variance" class="section level4" number="5.2.1.6">
<h4><span class="header-section-number">5.2.1.6</span> Decomposition Step 4 Variance</h4>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="linear-regression.html#cb341-1"></a>df.decompose_step3 <span class="op">%&gt;%</span></span>
<span id="cb341-2"><a href="linear-regression.html#cb341-2"></a><span class="st">        </span><span class="kw">select</span>(variable, <span class="kw">contains</span>(<span class="st">&#39;value&#39;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb341-3"><a href="linear-regression.html#cb341-3"></a><span class="st">        </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span></span>
<span id="cb341-4"><a href="linear-regression.html#cb341-4"></a><span class="st">        </span><span class="kw">summarize_all</span>(<span class="kw">funs</span>(<span class="dt">mean =</span> mean, <span class="dt">var =</span> var)) <span class="op">%&gt;%</span></span>
<span id="cb341-5"><a href="linear-regression.html#cb341-5"></a><span class="st">        </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="st">&#39;value&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;_var&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb341-6"><a href="linear-regression.html#cb341-6"></a><span class="st">        </span><span class="kw">mutate_if</span>(is.numeric, <span class="kw">funs</span>( <span class="dt">frac =</span> (.<span class="op">/</span>value_var))) <span class="op">%&gt;%</span></span>
<span id="cb341-7"><a href="linear-regression.html#cb341-7"></a><span class="st">        </span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dv">3</span>) <span class="op">%&gt;%</span></span>
<span id="cb341-8"><a href="linear-regression.html#cb341-8"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb341-9"><a href="linear-regression.html#cb341-9"></a><span class="st">  </span><span class="kw">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m_var_frac
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
21.864
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
25.35
</td>
<td style="text-align:right;">
49.047
</td>
<td style="text-align:right;">
23.06
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1.159
</td>
<td style="text-align:right;">
2.243
</td>
<td style="text-align:right;">
1.055
</td>
</tr>
<tr>
<td style="text-align:right;">
2965693.245
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2949187.64
</td>
<td style="text-align:right;">
4192769.518
</td>
<td style="text-align:right;">
3147506.60
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.994
</td>
<td style="text-align:right;">
1.414
</td>
<td style="text-align:right;">
1.061
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="graphical-results" class="section level4" number="5.2.1.7">
<h4><span class="header-section-number">5.2.1.7</span> Graphical Results</h4>
<p>Graphically, difficult to pick up exact differences in variance, a 50 percent reduction in variance visually does not look like 50 percent. Intuitively, we are kind of seeing standard deviation, not variance on the graph if we think abou the x-scale.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="linear-regression.html#cb342-1"></a><span class="kw">head</span>(df.decompose_step3 <span class="op">%&gt;%</span></span>
<span id="cb342-2"><a href="linear-regression.html#cb342-2"></a><span class="st">    </span><span class="kw">select</span>(variable, <span class="kw">contains</span>(<span class="st">&#39;value&#39;</span>), <span class="op">-</span>value_mean), <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb342-3"><a href="linear-regression.html#cb342-3"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb342-4"><a href="linear-regression.html#cb342-4"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
<td style="text-align:right;">
73.19390
</td>
<td style="text-align:right;">
71.19903
</td>
<td style="text-align:right;">
71.68148
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
<td style="text-align:right;">
78.79390
</td>
<td style="text-align:right;">
85.75778
</td>
<td style="text-align:right;">
79.43671
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
<td style="text-align:right;">
63.61689
</td>
<td style="text-align:right;">
58.28285
</td>
<td style="text-align:right;">
65.56882
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
<td style="text-align:right;">
66.51689
</td>
<td style="text-align:right;">
63.57185
</td>
<td style="text-align:right;">
64.05430
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
72.61689
</td>
<td style="text-align:right;">
71.19213
</td>
<td style="text-align:right;">
64.87106
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
<td style="text-align:right;">
64.33707
</td>
<td style="text-align:right;">
61.06626
</td>
<td style="text-align:right;">
68.35222
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
<td style="text-align:right;">
70.33707
</td>
<td style="text-align:right;">
69.56385
</td>
<td style="text-align:right;">
70.04630
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
<td style="text-align:right;">
73.33707
</td>
<td style="text-align:right;">
76.01161
</td>
<td style="text-align:right;">
69.69055
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
<td style="text-align:right;">
66.83353
</td>
<td style="text-align:right;">
61.49949
</td>
<td style="text-align:right;">
68.78545
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
<td style="text-align:right;">
73.13353
</td>
<td style="text-align:right;">
70.97578
</td>
<td style="text-align:right;">
71.45823
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="linear-regression.html#cb343-1"></a>df.decompose_step3 <span class="op">%&gt;%</span></span>
<span id="cb343-2"><a href="linear-regression.html#cb343-2"></a><span class="st">    </span><span class="kw">select</span>(variable, <span class="kw">contains</span>(<span class="st">&#39;value&#39;</span>), <span class="op">-</span>value_mean) <span class="op">%&gt;%</span></span>
<span id="cb343-3"><a href="linear-regression.html#cb343-3"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">outcome =</span> variable) <span class="op">%&gt;%</span></span>
<span id="cb343-4"><a href="linear-regression.html#cb343-4"></a><span class="st">    </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>outcome) <span class="op">%&gt;%</span></span>
<span id="cb343-5"><a href="linear-regression.html#cb343-5"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>value, <span class="dt">color =</span> variable, <span class="dt">fill =</span> variable)) <span class="op">+</span></span>
<span id="cb343-6"><a href="linear-regression.html#cb343-6"></a><span class="st">        </span><span class="kw">geom_line</span>(<span class="dt">stat =</span> <span class="st">&quot;density&quot;</span>) <span class="op">+</span></span>
<span id="cb343-7"><a href="linear-regression.html#cb343-7"></a><span class="st">        </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>outcome, <span class="dt">scales=</span><span class="st">&#39;free&#39;</span>, <span class="dt">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-164-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="additional-decomposition-testings" class="section level4" number="5.2.1.8">
<h4><span class="header-section-number">5.2.1.8</span> Additional Decomposition Testings</h4>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="linear-regression.html#cb344-1"></a><span class="kw">head</span>(df.decompose_step2[vars.tomean.first],<span class="dv">3</span>)</span>
<span id="cb344-2"><a href="linear-regression.html#cb344-2"></a><span class="kw">head</span>(df.decompose_step2[<span class="kw">paste0</span>(vars.tomean.first, <span class="st">&#39;_mean&#39;</span>)], <span class="dv">3</span>)</span>
<span id="cb344-3"><a href="linear-regression.html#cb344-3"></a><span class="kw">head</span>(df.coef[df.decompose_step2<span class="op">$</span>variable,</span>
<span id="cb344-4"><a href="linear-regression.html#cb344-4"></a>             <span class="kw">paste0</span>(vars.tomean.first, str.esti.suffix)], <span class="dv">3</span>)</span>
<span id="cb344-5"><a href="linear-regression.html#cb344-5"></a>df.decompose.tomean.first &lt;-<span class="st"> </span>df.decompose_step2 <span class="op">%&gt;%</span></span>
<span id="cb344-6"><a href="linear-regression.html#cb344-6"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">pred_new =</span> df.decompose_step2<span class="op">$</span>value <span class="op">+</span></span>
<span id="cb344-7"><a href="linear-regression.html#cb344-7"></a><span class="st">        </span><span class="kw">rowSums</span>((df.decompose_step2[<span class="kw">paste0</span>(vars.tomean.first, <span class="st">&#39;_mean&#39;</span>)]</span>
<span id="cb344-8"><a href="linear-regression.html#cb344-8"></a>                 <span class="op">-</span><span class="st"> </span>df.decompose_step2[vars.tomean.first])</span>
<span id="cb344-9"><a href="linear-regression.html#cb344-9"></a>            <span class="op">*</span>df.coef[df.decompose_step2<span class="op">$</span>variable,</span>
<span id="cb344-10"><a href="linear-regression.html#cb344-10"></a>                     <span class="kw">paste0</span>(vars.tomean.first, str.esti.suffix)])) <span class="op">%&gt;%</span></span>
<span id="cb344-11"><a href="linear-regression.html#cb344-11"></a><span class="st">        </span><span class="kw">select</span>(variable, value, pred_new)</span>
<span id="cb344-12"><a href="linear-regression.html#cb344-12"></a><span class="kw">head</span>(df.decompose.tomean.first, <span class="dv">10</span>)</span>
<span id="cb344-13"><a href="linear-regression.html#cb344-13"></a>df.decompose.tomean.first <span class="op">%&gt;%</span></span>
<span id="cb344-14"><a href="linear-regression.html#cb344-14"></a><span class="st">        </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span></span>
<span id="cb344-15"><a href="linear-regression.html#cb344-15"></a><span class="st">        </span><span class="kw">summarize_all</span>(<span class="kw">funs</span>(<span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd))  <span class="op">%&gt;%</span></span>
<span id="cb344-16"><a href="linear-regression.html#cb344-16"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb344-17"><a href="linear-regression.html#cb344-17"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
4.675867
</td>
<td style="text-align:right;">
4.534947
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
1722.118824
</td>
<td style="text-align:right;">
1695.221845
</td>
</tr>
</tbody>
</table>
<p>Note the r-square from regression above matches up with the 1 - ratio below. This is the proper decomposition method that is equivalent to r2.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="linear-regression.html#cb345-1"></a>df.decompose_step2 <span class="op">%&gt;%</span></span>
<span id="cb345-2"><a href="linear-regression.html#cb345-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">pred_new =</span> df.decompose_step2<span class="op">$</span>value <span class="op">+</span></span>
<span id="cb345-3"><a href="linear-regression.html#cb345-3"></a><span class="st">        </span><span class="kw">rowSums</span>((df.decompose_step2[<span class="kw">paste0</span>(vars.tomean.second, <span class="st">&#39;_mean&#39;</span>)]</span>
<span id="cb345-4"><a href="linear-regression.html#cb345-4"></a>                 <span class="op">-</span><span class="st"> </span>df.decompose_step2[vars.tomean.second])</span>
<span id="cb345-5"><a href="linear-regression.html#cb345-5"></a>            <span class="op">*</span>df.coef[df.decompose_step2<span class="op">$</span>variable,</span>
<span id="cb345-6"><a href="linear-regression.html#cb345-6"></a>                     <span class="kw">paste0</span>(vars.tomean.second, str.esti.suffix)])) <span class="op">%&gt;%</span></span>
<span id="cb345-7"><a href="linear-regression.html#cb345-7"></a><span class="st">        </span><span class="kw">select</span>(variable, value, pred_new) <span class="op">%&gt;%</span></span>
<span id="cb345-8"><a href="linear-regression.html#cb345-8"></a><span class="st">        </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span></span>
<span id="cb345-9"><a href="linear-regression.html#cb345-9"></a><span class="st">        </span><span class="kw">summarize_all</span>(<span class="kw">funs</span>(<span class="dt">mean =</span> mean, <span class="dt">var =</span> var)) <span class="op">%&gt;%</span></span>
<span id="cb345-10"><a href="linear-regression.html#cb345-10"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">ratio =</span> (pred_new_var<span class="op">/</span>value_var))  <span class="op">%&gt;%</span></span>
<span id="cb345-11"><a href="linear-regression.html#cb345-11"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb345-12"><a href="linear-regression.html#cb345-12"></a><span class="st">  </span><span class="kw">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ratio
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
2.186374e+01
</td>
<td style="text-align:right;">
25.3504
</td>
<td style="text-align:right;">
1.1594724
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
2.965693e+06
</td>
<td style="text-align:right;">
2949187.6357
</td>
<td style="text-align:right;">
0.9944345
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="panel.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nonlinear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
