<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Linear Regression | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="Running parallel code in R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Linear Regression | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Running parallel code in R" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Linear Regression | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="Running parallel code in R" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multi-dimensional-data-structures.html"/>
<link rel="next" href="nonlinear-and-other-regressions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#regular-expression-date-etc."><i class="fa fa-check"></i><b>1.4</b> Regular Expression, Date, etc.</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-regular-expression"><i class="fa fa-check"></i><b>1.4.1</b> String Regular Expression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html"><i class="fa fa-check"></i><b>2</b> Manipulate and Summarize Dataframes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#variables-in-dataframes"><i class="fa fa-check"></i><b>2.1</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-dataframe"><i class="fa fa-check"></i><b>2.1.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="2.1.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-categorical-variables"><i class="fa fa-check"></i><b>2.1.2</b> Generate Categorical Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#drawly-random-rows"><i class="fa fa-check"></i><b>2.1.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="2.1.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>2.1.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="2.1.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#string-dataframes"><i class="fa fa-check"></i><b>2.1.5</b> String Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-observation"><i class="fa fa-check"></i><b>2.2</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-and-tabulations"><i class="fa fa-check"></i><b>2.2.1</b> Counting and Tabulations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.3</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-1"><i class="fa fa-check"></i><b>2.3.1</b> Sorting</a></li>
<li class="chapter" data-level="2.3.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.3.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#advanced-group-aggregation"><i class="fa fa-check"></i><b>2.4</b> Advanced Group Aggregation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.4.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.4.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#groups-statistics"><i class="fa fa-check"></i><b>2.4.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.4.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.4.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.4.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.4.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#distributional-statistics"><i class="fa fa-check"></i><b>2.5</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#histogram"><i class="fa fa-check"></i><b>2.5.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.6</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#apply-function-over-multiple-columns-and-rows"><i class="fa fa-check"></i><b>2.6.1</b> Apply Function Over Multiple Columns and Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-table-to-wide-table"><i class="fa fa-check"></i><b>4.2.1</b> Long Table to Wide Table</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-comparisons-and-statistics"><i class="fa fa-check"></i><b>4.3</b> Within Panel Comparisons and Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
<li class="chapter" data-level="4.3.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-cross-time-and-cross-group-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Within Panel Cross-time and Cross-group Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-merge-files-together-by-keys"><i class="fa fa-check"></i><b>4.4</b> Join and Merge Files Together by Keys</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#mesh-join"><i class="fa fa-check"></i><b>4.4.1</b> Mesh Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#linear-and-polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Linear and Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#fit-curves-through-points"><i class="fa fa-check"></i><b>5.1.1</b> Fit Curves Through Points</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#grid-based-optimization"><i class="fa fa-check"></i><b>7.1</b> Grid Based Optimization</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#find-maximum-by-iterating-over-grids"><i class="fa fa-check"></i><b>7.1.1</b> Find Maximum By Iterating Over Grids</a></li>
<li class="chapter" data-level="7.1.2" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1.2</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#polynomial-formulas-for-points"><i class="fa fa-check"></i><b>8.1.1</b> Polynomial Formulas for Points</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.3</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.4</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.5" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.5</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-functions"><i class="fa fa-check"></i><b>8.2</b> Production Functions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#latent-dynamic-health-production-function"><i class="fa fa-check"></i><b>8.2.2</b> Latent Dynamic Health Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot-basics"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot Basics</a></li>
<li class="chapter" data-level="10.2.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-advanced"><i class="fa fa-check"></i><b>10.2.2</b> ggplot Line Advanced</a></li>
<li class="chapter" data-level="10.2.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#time-series-plots-with-shaded-areas"><i class="fa fa-check"></i><b>10.2.3</b> Time-series Plots with Shaded Areas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="coding-and-development.html"><a href="coding-and-development.html"><i class="fa fa-check"></i><b>12</b> Coding and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="coding-and-development.html"><a href="coding-and-development.html#installation-and-packages"><i class="fa fa-check"></i><b>12.1</b> Installation and Packages</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="coding-and-development.html"><a href="coding-and-development.html#r-installation-and-set-up"><i class="fa fa-check"></i><b>12.1.1</b> R Installation and Set-Up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="coding-and-development.html"><a href="coding-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.2</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="coding-and-development.html"><a href="coding-and-development.html#file-path"><i class="fa fa-check"></i><b>12.2.1</b> File Path</a></li>
<li class="chapter" data-level="12.2.2" data-path="coding-and-development.html"><a href="coding-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.2.2</b> Text to File</a></li>
<li class="chapter" data-level="12.2.3" data-path="coding-and-development.html"><a href="coding-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.2.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="coding-and-development.html"><a href="coding-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.3</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="coding-and-development.html"><a href="coding-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.3.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="coding-and-development.html"><a href="coding-and-development.html#command-line"><i class="fa fa-check"></i><b>12.4</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="coding-and-development.html"><a href="coding-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.4.1</b> Shell and System Commands</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="coding-and-development.html"><a href="coding-and-development.html#run-code-in-parallel-in-r"><i class="fa fa-check"></i><b>12.5</b> Run Code in Parallel in R</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="coding-and-development.html"><a href="coding-and-development.html#parallel-loop-in-r"><i class="fa fa-check"></i><b>12.5.1</b> Parallel Loop in R</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> Section 1.1 List links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> Section 1.2 Array links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> Section 1.3 Matrix links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-regular-expression-date-etc.regular-expression-date-etc.-links"><i class="fa fa-check"></i><b>A.1.4</b> Section 1.4 Regular Expression, Date, etc. links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#manipulate-and-summarize-dataframes-links"><i class="fa fa-check"></i><b>A.2</b> Manipulate and Summarize Dataframes links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.2.1</b> Section 2.1 Variables in Dataframes links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.2</b> Section 2.2 Counting Observation links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.3</b> Section 2.3 Sorting, Indexing, Slicing links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-advanced-group-aggregationadvanced-group-aggregation-links"><i class="fa fa-check"></i><b>A.2.4</b> Section 2.4 Advanced Group Aggregation links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.5</b> Section 2.5 Distributional Statistics links</a></li>
<li class="chapter" data-level="A.2.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.6-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.6</b> Section 2.6 Summarize Multiple Variables links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> Section 3.1 Dataframe Mutate links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> Section 3.2 Dataframe Do Anything links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> Section 3.3 Apply and pmap links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> Section 4.1 Generate, Gather, Bind and Join links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> Section 4.2 Wide and Long links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-within-panel-comparisons-and-statisticswithin-panel-comparisons-and-statistics-links"><i class="fa fa-check"></i><b>A.4.3</b> Section 4.3 Within Panel Comparisons and Statistics links</a></li>
<li class="chapter" data-level="A.4.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.4-join-and-merge-files-together-by-keysjoin-and-merge-files-together-by-keys-links"><i class="fa fa-check"></i><b>A.4.4</b> Section 4.4 Join and Merge Files Together by Keys links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-linear-and-polynomial-fittinglinear-and-polynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> Section 5.1 Linear and Polynomial Fitting links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> Section 5.2 OLS and IV links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> Section 5.3 Decomposition links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> Section 6.1 Logit Regression links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> Section 6.2 Quantile Regression links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-grid-based-optimizationgrid-based-optimization-links"><i class="fa fa-check"></i><b>A.7.1</b> Section 7.1 Grid Based Optimization links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> Section 8.1 Basics links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionsproduction-functions-links"><i class="fa fa-check"></i><b>A.8.2</b> Section 8.2 Production Functions links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> Section 8.3 Inequality Models links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> Section 9.1 Random Draws links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> Section 9.2 Distributions links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> Section 9.3 Discrete Random Variable links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> Section 10.1 R Base Plots links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> Section 10.2 ggplot Line Related Plots links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> Section 10.3 ggplot Scatter Related Plots links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> Section 10.4 Write and Read Plots links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> Section 11.1 Environmental Data links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#coding-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Coding and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-installation-and-packagesinstallation-and-packages-links"><i class="fa fa-check"></i><b>A.12.1</b> Section 12.1 Installation and Packages links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.2</b> Section 12.2 Files In and Out links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.3</b> Section 12.3 Python with R links</a></li>
<li class="chapter" data-level="A.12.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.4-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.4</b> Section 12.4 Command Line links</a></li>
<li class="chapter" data-level="A.12.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.5-run-code-in-parallel-in-rrun-code-in-parallel-in-r-links"><i class="fa fa-check"></i><b>A.12.5</b> Section 12.5 Run Code in Parallel in R links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Linear Regression<a href="linear-regression.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="linear-and-polynomial-fitting" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Linear and Polynomial Fitting<a href="linear-regression.html#linear-and-polynomial-fitting" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="fit-curves-through-points" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Fit Curves Through Points<a href="linear-regression.html#fit-curves-through-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="polynomial-fit-with-n-sets-of-points" class="section level4 hasAnchor" number="5.1.1.1">
<h4><span class="header-section-number">5.1.1.1</span> Polynomial Fit with N Sets of Points<a href="linear-regression.html#polynomial-fit-with-n-sets-of-points" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are three points defined by their x and y coordinates. We draw these points randomly, and we find a curve that fits through them. The fit is exact. If there are more than three sets of points, we will not be able to fit exactly. In the illustration before, first, we draw 3 sets of x and y points, then we draw 4 and 5 sets, and we compare the prediction results.</p>
<p>Note that we are not generating data from a particular set of quadratic (polynomial) parameters, we are just drawing random values. When we draw exactly three pairs of random x and y values, we can find some polynomial that provides an exact fit through the three points in 2d space.</p>
<p>We define the function here.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="linear-regression.html#cb455-1" tabindex="-1"></a><span class="co">#&#39; Test polynomial fit to random draw x and y points</span></span>
<span id="cb455-2"><a href="linear-regression.html#cb455-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb455-3"><a href="linear-regression.html#cb455-3" tabindex="-1"></a><span class="co">#&#39; @description Draw random sets of x and y points, fit a polynomial curve through</span></span>
<span id="cb455-4"><a href="linear-regression.html#cb455-4" tabindex="-1"></a><span class="co">#&#39; and compare predictions of y and actual y values.</span></span>
<span id="cb455-5"><a href="linear-regression.html#cb455-5" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb455-6"><a href="linear-regression.html#cb455-6" tabindex="-1"></a><span class="co">#&#39; @param it_xy_pairs The number of x and y pair points</span></span>
<span id="cb455-7"><a href="linear-regression.html#cb455-7" tabindex="-1"></a><span class="co">#&#39; @param it_seed The random seed for drawing values</span></span>
<span id="cb455-8"><a href="linear-regression.html#cb455-8" tabindex="-1"></a><span class="co">#&#39; @param it_poly_fit An integer value of the order of polynomial</span></span>
<span id="cb455-9"><a href="linear-regression.html#cb455-9" tabindex="-1"></a><span class="co">#&#39; @param fl_mean The mean of the the random normal draw</span></span>
<span id="cb455-10"><a href="linear-regression.html#cb455-10" tabindex="-1"></a><span class="co">#&#39; @param fl_sd The standard deviation of the random normal draw</span></span>
<span id="cb455-11"><a href="linear-regression.html#cb455-11" tabindex="-1"></a><span class="co">#&#39; @returns</span></span>
<span id="cb455-12"><a href="linear-regression.html#cb455-12" tabindex="-1"></a><span class="co">#&#39; \itemize{</span></span>
<span id="cb455-13"><a href="linear-regression.html#cb455-13" tabindex="-1"></a><span class="co">#&#39;   \item rs_lm_poly - polynomial fit estimation results</span></span>
<span id="cb455-14"><a href="linear-regression.html#cb455-14" tabindex="-1"></a><span class="co">#&#39;   \item df_data_predict - N by 3 where N = \code{it_xy_pairs} and</span></span>
<span id="cb455-15"><a href="linear-regression.html#cb455-15" tabindex="-1"></a><span class="co">#&#39; columns are x, y, y-predict, and residual</span></span>
<span id="cb455-16"><a href="linear-regression.html#cb455-16" tabindex="-1"></a><span class="co">#&#39;   \item td_table_return - Display version of df_data_predict with title</span></span>
<span id="cb455-17"><a href="linear-regression.html#cb455-17" tabindex="-1"></a><span class="co">#&#39; }</span></span>
<span id="cb455-18"><a href="linear-regression.html#cb455-18" tabindex="-1"></a><span class="co">#&#39; @import stats, tibble, dplyr</span></span>
<span id="cb455-19"><a href="linear-regression.html#cb455-19" tabindex="-1"></a><span class="co">#&#39; @author Fan Wang, \url{http://fanwangecon.github.io}</span></span>
<span id="cb455-20"><a href="linear-regression.html#cb455-20" tabindex="-1"></a>ffi_lm_quad_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">it_xy_pairs =</span> <span class="dv">3</span>, <span class="at">it_seed =</span> <span class="dv">123</span>,</span>
<span id="cb455-21"><a href="linear-regression.html#cb455-21" tabindex="-1"></a>                            <span class="at">it_poly_fit =</span> <span class="dv">2</span>, <span class="at">fl_mean =</span> <span class="dv">1</span>, <span class="at">fl_sd =</span> <span class="dv">1</span>,</span>
<span id="cb455-22"><a href="linear-regression.html#cb455-22" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb455-23"><a href="linear-regression.html#cb455-23" tabindex="-1"></a></span>
<span id="cb455-24"><a href="linear-regression.html#cb455-24" tabindex="-1"></a>  <span class="co"># 1. Generate three pairs of random numbers</span></span>
<span id="cb455-25"><a href="linear-regression.html#cb455-25" tabindex="-1"></a>  <span class="fu">set.seed</span>(it_seed)</span>
<span id="cb455-26"><a href="linear-regression.html#cb455-26" tabindex="-1"></a>  mt_rnorm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb455-27"><a href="linear-regression.html#cb455-27" tabindex="-1"></a>    <span class="fu">rnorm</span>(it_xy_pairs <span class="sc">*</span> <span class="dv">2</span>, <span class="at">mean =</span> fl_mean, <span class="at">sd =</span> fl_sd),</span>
<span id="cb455-28"><a href="linear-regression.html#cb455-28" tabindex="-1"></a>    <span class="at">nrow =</span> it_xy_pairs, <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb455-29"><a href="linear-regression.html#cb455-29" tabindex="-1"></a>  )</span>
<span id="cb455-30"><a href="linear-regression.html#cb455-30" tabindex="-1"></a>  <span class="fu">colnames</span>(mt_rnorm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb455-31"><a href="linear-regression.html#cb455-31" tabindex="-1"></a>  <span class="fu">rownames</span>(mt_rnorm) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;p&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>, it_xy_pairs))</span>
<span id="cb455-32"><a href="linear-regression.html#cb455-32" tabindex="-1"></a>  df_rnorm <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_rnorm)</span>
<span id="cb455-33"><a href="linear-regression.html#cb455-33" tabindex="-1"></a></span>
<span id="cb455-34"><a href="linear-regression.html#cb455-34" tabindex="-1"></a>  <span class="co"># 2. Quadratic fit using ORTHOGONAL POLYNOMIAL</span></span>
<span id="cb455-35"><a href="linear-regression.html#cb455-35" tabindex="-1"></a>  <span class="co"># For predictions, lm(y ~ x + I(x^2)) and lm(y ~ poly(x, 2)) are the same,</span></span>
<span id="cb455-36"><a href="linear-regression.html#cb455-36" tabindex="-1"></a>  <span class="co"># but they have different parameters because x is transformed by poly().</span></span>
<span id="cb455-37"><a href="linear-regression.html#cb455-37" tabindex="-1"></a>  rs_lm_quad <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, it_poly_fit), <span class="at">data =</span> df_rnorm)</span>
<span id="cb455-38"><a href="linear-regression.html#cb455-38" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">summary.lm</span>(rs_lm_quad))</span>
<span id="cb455-39"><a href="linear-regression.html#cb455-39" tabindex="-1"></a></span>
<span id="cb455-40"><a href="linear-regression.html#cb455-40" tabindex="-1"></a>  <span class="co"># 3. Fit prediction</span></span>
<span id="cb455-41"><a href="linear-regression.html#cb455-41" tabindex="-1"></a>  ar_y_predict <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict</span>(rs_lm_quad)</span>
<span id="cb455-42"><a href="linear-regression.html#cb455-42" tabindex="-1"></a>  df_data_predict <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df_rnorm, ar_y_predict) <span class="sc">%&gt;%</span></span>
<span id="cb455-43"><a href="linear-regression.html#cb455-43" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res =</span> ar_y_predict <span class="sc">-</span> y)</span>
<span id="cb455-44"><a href="linear-regression.html#cb455-44" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">print</span>(df_data_predict)</span>
<span id="cb455-45"><a href="linear-regression.html#cb455-45" tabindex="-1"></a></span>
<span id="cb455-46"><a href="linear-regression.html#cb455-46" tabindex="-1"></a>  <span class="co"># 4. show values</span></span>
<span id="cb455-47"><a href="linear-regression.html#cb455-47" tabindex="-1"></a>  st_poly_order <span class="ot">&lt;-</span> <span class="st">&quot;Quadratic&quot;</span></span>
<span id="cb455-48"><a href="linear-regression.html#cb455-48" tabindex="-1"></a>  <span class="cf">if</span> (it_poly_fit <span class="sc">!=</span> <span class="dv">2</span>) {</span>
<span id="cb455-49"><a href="linear-regression.html#cb455-49" tabindex="-1"></a>    st_poly_order <span class="ot">&lt;-</span> <span class="fu">paste0</span>(it_poly_fit, <span class="st">&quot;th order&quot;</span>)</span>
<span id="cb455-50"><a href="linear-regression.html#cb455-50" tabindex="-1"></a>  }</span>
<span id="cb455-51"><a href="linear-regression.html#cb455-51" tabindex="-1"></a>  td_table_return <span class="ot">&lt;-</span> <span class="fu">kable</span>(df_data_predict,</span>
<span id="cb455-52"><a href="linear-regression.html#cb455-52" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb455-53"><a href="linear-regression.html#cb455-53" tabindex="-1"></a>      st_poly_order, <span class="st">&quot; Fit of &quot;</span>, it_xy_pairs, <span class="st">&quot; Sets of Random (X,Y) Points&quot;</span></span>
<span id="cb455-54"><a href="linear-regression.html#cb455-54" tabindex="-1"></a>    )</span>
<span id="cb455-55"><a href="linear-regression.html#cb455-55" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb455-56"><a href="linear-regression.html#cb455-56" tabindex="-1"></a>    <span class="fu">kable_styling_fc</span>()</span>
<span id="cb455-57"><a href="linear-regression.html#cb455-57" tabindex="-1"></a></span>
<span id="cb455-58"><a href="linear-regression.html#cb455-58" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb455-59"><a href="linear-regression.html#cb455-59" tabindex="-1"></a>    <span class="at">rs_lm_quad =</span> rs_lm_quad,</span>
<span id="cb455-60"><a href="linear-regression.html#cb455-60" tabindex="-1"></a>    <span class="at">df_data_predict =</span> df_data_predict,</span>
<span id="cb455-61"><a href="linear-regression.html#cb455-61" tabindex="-1"></a>    <span class="at">td_table_return =</span> td_table_return</span>
<span id="cb455-62"><a href="linear-regression.html#cb455-62" tabindex="-1"></a>  ))</span>
<span id="cb455-63"><a href="linear-regression.html#cb455-63" tabindex="-1"></a>}</span></code></pre></div>
<p>In the first example below, we simulate 3 set of points and estimate quadratic exact fit.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="linear-regression.html#cb456-1" tabindex="-1"></a>ls_ffi_lm_quad_fit <span class="ot">&lt;-</span></span>
<span id="cb456-2"><a href="linear-regression.html#cb456-2" tabindex="-1"></a>  <span class="fu">ffi_lm_quad_fit</span>(</span>
<span id="cb456-3"><a href="linear-regression.html#cb456-3" tabindex="-1"></a>    <span class="at">it_xy_pairs =</span> <span class="dv">3</span>, <span class="at">it_seed =</span> <span class="dv">123</span>,</span>
<span id="cb456-4"><a href="linear-regression.html#cb456-4" tabindex="-1"></a>    <span class="at">it_poly_fit =</span> <span class="dv">2</span>, <span class="at">fl_mean =</span> <span class="dv">1</span>, <span class="at">fl_sd =</span> <span class="dv">1</span></span>
<span id="cb456-5"><a href="linear-regression.html#cb456-5" tabindex="-1"></a>  )</span>
<span id="cb456-6"><a href="linear-regression.html#cb456-6" tabindex="-1"></a>ls_ffi_lm_quad_fit<span class="sc">$</span>td_table_return</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-234">Table 5.1: </span>Quadratic Fit of 3 Sets of Random (X,Y) Points
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_y_predict
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4395244
</td>
<td style="text-align:right;">
1.070508
</td>
<td style="text-align:right;">
1.070508
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7698225
</td>
<td style="text-align:right;">
1.129288
</td>
<td style="text-align:right;">
1.129288
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.5587083
</td>
<td style="text-align:right;">
2.715065
</td>
<td style="text-align:right;">
2.715065
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>In the second example below, we simulate 4 set of points and estimate a quadratic non-exact fit.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="linear-regression.html#cb457-1" tabindex="-1"></a>ls_ffi_lm_quad_fit <span class="ot">&lt;-</span></span>
<span id="cb457-2"><a href="linear-regression.html#cb457-2" tabindex="-1"></a>  <span class="fu">ffi_lm_quad_fit</span>(</span>
<span id="cb457-3"><a href="linear-regression.html#cb457-3" tabindex="-1"></a>    <span class="at">it_xy_pairs =</span> <span class="dv">4</span>, <span class="at">it_seed =</span> <span class="dv">345</span>,</span>
<span id="cb457-4"><a href="linear-regression.html#cb457-4" tabindex="-1"></a>    <span class="at">it_poly_fit =</span> <span class="dv">2</span>, <span class="at">fl_mean =</span> <span class="dv">1</span>, <span class="at">fl_sd =</span> <span class="dv">1</span></span>
<span id="cb457-5"><a href="linear-regression.html#cb457-5" tabindex="-1"></a>  )</span>
<span id="cb457-6"><a href="linear-regression.html#cb457-6" tabindex="-1"></a>ls_ffi_lm_quad_fit<span class="sc">$</span>td_table_return</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-235">Table 5.2: </span>Quadratic Fit of 4 Sets of Random (X,Y) Points
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_y_predict
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2150918
</td>
<td style="text-align:right;">
0.9324684
</td>
<td style="text-align:right;">
0.9373687
</td>
<td style="text-align:right;">
0.0049003
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7204856
</td>
<td style="text-align:right;">
0.3664796
</td>
<td style="text-align:right;">
1.5207575
</td>
<td style="text-align:right;">
1.1542779
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8385421
</td>
<td style="text-align:right;">
0.0722760
</td>
<td style="text-align:right;">
-0.0080226
</td>
<td style="text-align:right;">
-0.0802987
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7094034
</td>
<td style="text-align:right;">
2.7107710
</td>
<td style="text-align:right;">
1.6318915
</td>
<td style="text-align:right;">
-1.0788795
</td>
</tr>
</tbody>
</table>
<p>In the third example below, we simulate the same 4 sets of points as in the prior example, but now use a cubic polynomial to fit the data exactly.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="linear-regression.html#cb458-1" tabindex="-1"></a>ls_ffi_lm_cubic_fit <span class="ot">&lt;-</span></span>
<span id="cb458-2"><a href="linear-regression.html#cb458-2" tabindex="-1"></a>  <span class="fu">ffi_lm_quad_fit</span>(</span>
<span id="cb458-3"><a href="linear-regression.html#cb458-3" tabindex="-1"></a>    <span class="at">it_xy_pairs =</span> <span class="dv">4</span>, <span class="at">it_seed =</span> <span class="dv">345</span>,</span>
<span id="cb458-4"><a href="linear-regression.html#cb458-4" tabindex="-1"></a>    <span class="at">it_poly_fit =</span> <span class="dv">3</span>, <span class="at">fl_mean =</span> <span class="dv">1</span>, <span class="at">fl_sd =</span> <span class="dv">1</span></span>
<span id="cb458-5"><a href="linear-regression.html#cb458-5" tabindex="-1"></a>  )</span>
<span id="cb458-6"><a href="linear-regression.html#cb458-6" tabindex="-1"></a>ls_ffi_lm_cubic_fit<span class="sc">$</span>td_table_return</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-236">Table 5.3: </span>3th order Fit of 4 Sets of Random (X,Y) Points
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_y_predict
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2150918
</td>
<td style="text-align:right;">
0.9324684
</td>
<td style="text-align:right;">
0.9324684
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7204856
</td>
<td style="text-align:right;">
0.3664796
</td>
<td style="text-align:right;">
0.3664796
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8385421
</td>
<td style="text-align:right;">
0.0722760
</td>
<td style="text-align:right;">
0.0722760
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7094034
</td>
<td style="text-align:right;">
2.7107710
</td>
<td style="text-align:right;">
2.7107710
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>

</div>
</div>
<div id="polynomial-time-series" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Polynomial Time Series<a href="linear-regression.html#polynomial-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="analytical-solution-for-time-series-polynomial-coefficients" class="section level4 hasAnchor" number="5.1.2.1">
<h4><span class="header-section-number">5.1.2.1</span> Analytical Solution for Time-Series Polynomial Coefficients<a href="linear-regression.html#analytical-solution-for-time-series-polynomial-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This file is developed in support of <a href="https://fanwangecon.github.io/assets/BhalotraFernandezWangMexicoFLFP.pdf">Bhalotra, Fernandez, and Wang (2021)</a>, where we use polynomials to model share parameter changes over time in the context of a nested-CES problem.</p>
<div id="mth-order-polynomial-and-its-derivative" class="section level5 hasAnchor" number="5.1.2.1.1">
<h5><span class="header-section-number">5.1.2.1.1</span> Mth Order Polynomial and its Derivative<a href="linear-regression.html#mth-order-polynomial-and-its-derivative" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We have a polynomial of Mth order:</p>
<p><span class="math display">\[
y\left(t\right) = a_0 + a_1 \cdot t + a_2 \cdot t^2 + ... + a_M \cdot t^M
\]</span></p>
<p>Taking derivative of of <span class="math inline">\(y\)</span> with respect to <span class="math inline">\(t\)</span>, we have:</p>
<p><span class="math display">\[
\begin{aligned}
  \frac{d^{M-0}y}{dt^{M-0}} &amp;=
  a_{M-0} \cdot \frac{\left(M-0\right)!}{0!} \cdot t^{-0+0}
  \\
  \frac{d^{M-1}y}{dt^{M-1}} &amp;=
  a_{M-0} \cdot \frac{\left(M-0\right)!}{1!} \cdot t^{-0+1}
  +
  a_{M-1} \cdot \frac{\left(M-1\right)!}{0!} \cdot t^{-1+1}
  \\
  \frac{d^{M-2}y}{dt^{M-2}} &amp;=
  a_{M-0} \cdot \frac{\left(M-0\right)!}{2!} \cdot t^{-0+2}
  +
  a_{M-1} \cdot \frac{\left(M-1\right)!}{1!} \cdot t^{-1+2}
  +
  a_{M-2} \cdot \frac{\left(M-2\right)!}{0!} \cdot t^{-2+2}
  \\
  \frac{d^{M-3}y}{dt^{M-3}} &amp;=
  a_{M-0} \cdot \frac{\left(M-0\right)!}{3!} \cdot t^{-0+3}
  +
  a_{M-1} \cdot \frac{\left(M-1\right)!}{2!} \cdot t^{-1+3}
  +
  a_{M-2} \cdot \frac{\left(M-2\right)!}{1!} \cdot t^{-2+3}
  +
  a_{M-3} \cdot \frac{\left(M-3\right)!}{0!} \cdot t^{-3+3}
\end{aligned}
\]</span></p>
<p>Given the structure above, we have the following formulation for polynomial derivative, where we have a polynomial of <span class="math inline">\(M^{th}\)</span> order and we are interested in the <span class="math inline">\(N^{th}\)</span> derivative:</p>
<p><span class="math display">\[
\begin{aligned}
  \frac{d^{N}y(M)}{dt^{N}} &amp;=
  \sum_{i=0}^{M-N}
  \left(
    a_{M-i} \cdot
    \frac{\left(M-i\right)!}{\left(M-N-i\right)!} \cdot
    t^{M-N-i}
  \right)
\end{aligned}
\]</span></p>
<p>Note that the <span class="math inline">\(M^{th}\)</span> derivative of a <span class="math inline">\(M^{th}\)</span> order polynomial is equal to <span class="math inline">\(\left(a_M \cdot M!\right)\)</span></p>
</div>
<div id="repeatedly-taking-differences-of-differences" class="section level5 hasAnchor" number="5.1.2.1.2">
<h5><span class="header-section-number">5.1.2.1.2</span> Repeatedly Taking Differences of Differences<a href="linear-regression.html#repeatedly-taking-differences-of-differences" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Suppose the data generating process is a <span class="math inline">\(M^{th}\)</span> order polynomial, then differencing of time-series observables can be used to identify polynomial coefficients.</p>
<p>In the simplest case of a 1st order polynomial with <span class="math inline">\(Y_t = a_0 + a_1 \cdot t\)</span>, given 2 periods of data, <span class="math inline">\(t=0,t=1\)</span>, we have <span class="math inline">\(a_1 = Y_2 - Y_1\)</span>, and <span class="math inline">\(a_0 = Y_0\)</span>. The rate of change in <span class="math inline">\(Y\)</span> over <span class="math inline">\(t\)</span> captures coefficient <span class="math inline">\(a_1\)</span>.</p>
<p>For a second order polynomial, while the first derivative is time-varying, the second derivative, acceleration, is invariant over <span class="math inline">\(t\)</span>. Similarly, for any <span class="math inline">\(M^{th}\)</span> order polynomial, the <span class="math inline">\(M^{th}\)</span> derivative is time-invariant.</p>
<p>Because of this time-invariance of the <span class="math inline">\(M^{th}\)</span> derivative, the differencing idea can be used to identify <span class="math inline">\(a_M\)</span>, the coefficient for the highest polynomial term for the <span class="math inline">\(M^{th}\)</span> order polynomial.</p>
<p>Now we difference observable <span class="math inline">\(y_t\)</span> overtime. We difference the differences, difference the differences of the differences, and difference the differences of the differences of the differences, etc. It turns out that the difference is a summation over all observations <span class="math inline">\(\left\{y_t\right\}_{t=1}^{T}\)</span>, with the number of times each <span class="math inline">\(y_t\)</span> term appearing following <a href="https://en.wikipedia.org/wiki/Pascal%27s_triangle">Pascalâ€™s Triangle</a>.</p>
<p>Specifically:</p>
<ul>
<li>1st difference is <span class="math inline">\(y_1 - y_0\)</span></li>
<li>2nd difference is <span class="math inline">\((y_2-y_1) - (y_1-y_0) = y_2 - 2y_1 + y_0\)</span></li>
<li>3rd difference is <span class="math inline">\(((y_3-y_2) - (y_2-y_1)) - ((y_2-y_1) - (y_1-y_0)) = y_3 - 3y_2 + 3y_1 - y_0\)</span></li>
<li>4th difference is <span class="math inline">\((((y_4 - y_3) - (y_3 - y_2)) - ((y_3-y_2) - (y_2-y_1))) - (((y_3-y_2) - (y_2-y_1)) - ((y_2-y_1) - (y_1-y_0))) = y_4 - 4y_3 + 6y_2 - 4y_1 + y_0\)</span></li>
<li>5th difference is <span class="math inline">\(((((y_5-y_4) - (y_4-y_3)) - ((y_4-y_3) - (y_3-y_2))) - (((y_4-y_3) - (y_3-y_2)) - ((y_3-y_2) - (y_2-y_1)))) - ((((y_4-y_3) - (y_3-y_2)) - ((y_3-y_2) - (y_2-y_1))) - (((y_3-y_2) - (y_2-y_1)) - ((y_2-y_1) - (y_1-y_0)))) = y_5 - 5y_4 + 10y_3 - 10y_2 + 5y_1 - y_0\)</span></li>
</ul>
<p>Note that the pattern has alternating signs, and the coefficients are binomial. We have the following formula:</p>
<p><span class="math display">\[
\begin{aligned}
  \Delta^M &amp;=
  \sum_{i=0}^{M}
  \left(\left(-1\right)^i\cdot\frac{M!}{\left(M-i\right)!i!}\right)
  \cdot y_{\left(M-i\right)}
  \\
\end{aligned}
\]</span></p>
<p>When there are <span class="math inline">\(T\)</span> periods of data, and we are interested in the <span class="math inline">\(T-1\)</span> difference, the differencing formula is unique. However, for less than <span class="math inline">\(T-1\)</span> difference, we can use alternative consecutive data segments. Specifically, given <span class="math inline">\(T\)</span> periods of data from <span class="math inline">\(t=1\)</span> to <span class="math inline">\(t=T\)</span>, we have the notation <span class="math inline">\(\Delta^M_{\tau}\)</span> where <span class="math inline">\(\tau\)</span> is the starting time. We have, for <span class="math inline">\(M \le T-1\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
  \Delta^M_{\tau}\left(\left\{y_t\right\}_{t=1}^{T}\right) &amp;=
  \sum_{i=0}^{M}
  \left(\left(-1\right)^i\cdot\frac{M!}{\left(M-i\right)!i!}\right)
  \cdot y_{\left(\tau + \left(M-i\right)\right)}
  \thinspace\thinspace\text{for}\thinspace\thinspace
  1 \le \tau \le T-M
  \\
\end{aligned}
\]</span></p>
</div>
<div id="solutions-for-polynomial-coefficients-with-differences-of-differences" class="section level5 hasAnchor" number="5.1.2.1.3">
<h5><span class="header-section-number">5.1.2.1.3</span> Solutions for Polynomial Coefficients with Differences of Differences<a href="linear-regression.html#solutions-for-polynomial-coefficients-with-differences-of-differences" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Intuitively, for a <span class="math inline">\(M^{th}\)</span> order polynomial, the coefficient on the highest polynomial term is a function of the <span class="math inline">\((M-1)^{th}\)</span> difference. Coefficients of lower polynomial terms, <span class="math inline">\(m&lt;M\)</span>, are function of the <span class="math inline">\((m-1)^{th}\)</span> difference along with higher order polynomial coefficients already computed.</p>
<p>Formally, we have, for a <span class="math inline">\(M^{th}\)</span> order polynomial, a vector of <span class="math inline">\(\left\{a_m\right\}_{m=0}^{M}\)</span> <span class="math inline">\(M+1\)</span> polynomial coefficients. For formula for the coefficient for the largest polynomial is:</p>
<p><span class="math display">\[
\begin{aligned}
  a_M &amp;=
  \sum_{i=0}^{M}
  \left(
    \left(-1\right)^i
    \left(
      \left(M-i\right)!
      i!
      \right)^{-1}
  \right)
  % \cdot
  y_{\left(M-i\right)}
\end{aligned}
\]</span></p>
<p>Given this, we have also, given <span class="math inline">\(T\)</span> periods of data from <span class="math inline">\(t=1\)</span> to <span class="math inline">\(t=T\)</span>:
<span class="math display">\[
\begin{aligned}
  a_{M-1} &amp;=
  \sum_{i=0}^{M-1}
  \left(
    \left(-1\right)^i
    \left(
      \left(M-1-i\right)!
      i!
      \right)^{-1}
  \right)
  \cdot
  \left(
    y_{\left(\tau + \left(M-1-i\right)\right)}
    - a_M \cdot t^M
  \right)
  \thinspace\thinspace
  \text{for}
  \thinspace\thinspace
  1 \le \tau \le T-M-1
\end{aligned}
\]</span></p>
<p>Using one formula, given <span class="math inline">\(a_{m+1}\)</span>, we have:</p>
<p><span class="math display">\[
\begin{aligned}
  a_{m} &amp;=
  \sum_{i=0}^{m}
  \left(
    \left(-1\right)^i
    \left(
      \left(m-i\right)!
      i!
      \right)^{-1}
  \right)
  \cdot
  \left(
    y_{\left(\tau + \left(m-i\right)\right)}
    -
    \sum_{j=0}^{M-m-1}
    a_{M-j} \cdot t^{M-j}
  \right)
  \thinspace\thinspace
  \text{for}
  \thinspace\thinspace
  1 \le \tau \le T-m
\end{aligned}
\]</span></p>
</div>
<div id="identifying-polynomial-coefficients-with-differences-for-third-order-polynomial" class="section level5 hasAnchor" number="5.1.2.1.4">
<h5><span class="header-section-number">5.1.2.1.4</span> Identifying Polynomial Coefficients with Differences for Third Order Polynomial<a href="linear-regression.html#identifying-polynomial-coefficients-with-differences-for-third-order-polynomial" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To illustrate, we test the formulas with a 3rd order polynomial, and derive some 3rd-order specific formulas.</p>
<p>For data from a 3rd order polynomial data generating process, we can use the 3rd difference to identify the coefficient in front of <span class="math inline">\(x^3\)</span>. With this, we can iteratively to lower polynomials and identify all relevant coefficients.</p>
<p>Specifically, using equations from the two sections above, we have:</p>
<p><span class="math display">\[
\begin{aligned}
  \frac{d^{3}y(3)}{dt^{3}} &amp;=  y_3 - 3y_2 + 3y_1 - y_0
  \\
  \frac{d^{3}y(3)}{dt^{3}} &amp;= 3! \cdot a_3
\end{aligned}
\]</span></p>
<p>Combining the two equations we have, that <span class="math inline">\(a_3\)</span> is the 3rd difference divided by <span class="math inline">\(6\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
  3! \cdot a_3 &amp;= y_3 - 3y_2 + 3y_1 - y_0\\
   a_3 &amp;= \frac{y_3 - 3y_2 + 3y_1 - y_0 }{3\cdot2}
\end{aligned}
\]</span></p>
<p>For the linear and cubic terms, we have:</p>
<p><span class="math display">\[
\begin{aligned}
  \frac{d^{2}y(M=3)}{dt^{2}} &amp;= 3 \cdot a_2 + 6 \cdot a_3 \cdot t
  \\
  \frac{d^{1}y(M=3)}{dt^{1}} &amp;= a_1 + 2 \cdot a_2 + 3 \cdot a_3 \cdot t^2
\end{aligned}
\]</span></p>
<p>Note that the 3rd derivative of a 3rd order polynomial is a constant, but the 2nd derivative of a 3rd order polynomial is not. This means that to use the second difference to identify <span class="math inline">\(a_2\)</span> parameter, we first have to difference out from <span class="math inline">\(y_t\)</span> the impact of the 3rd polynomial term, which we can because we know <span class="math inline">\(a_3\)</span> now.</p>
<p>Differencing out the 3rd term, we have now the 2nd derivative of a 2nd order polynomial:
<span class="math display">\[
\begin{aligned}
  \frac{d^{2}\left(y(M=3) - a_3\cdot t^3\right)}{dt^{2}} &amp;=
  \frac{d^{2}\left(\widehat{y}(M=2)\right)}{dt^{2}}
  \thinspace\thinspace,
  \\
\end{aligned}
\]</span>
where <span class="math inline">\(\widehat{y}\left(M,2\right)=y\left(M\right)-a_3\cdot t^3\)</span>.</p>
<p>So this means we have:</p>
<p><span class="math display">\[
\begin{aligned}
  \frac{d^{2}\widehat{y}(3,2)}{dt^{2}} &amp;=
  \left(1 \cdot y_2 - 2 \cdot y_1 + 1 \cdot y_0\right) -
  a_3\cdot\left(1\cdot 2^3 - 2 \cdot 1^3 + 1 \cdot 0^3 \right)
  \\
  &amp;=
  \left(1 \cdot y_2 - 2 \cdot y_1 + 1 \cdot y_0\right) -
  a_3\cdot \left(2^3 - 2\right)
  \\
  \frac{d^{2}\widehat{y}(3,2)}{dt^{2}} &amp;= 2! \cdot a_2
\end{aligned}
\]</span></p>
<p>Given the value for <span class="math inline">\(a_3\)</span>, we have:</p>
<p><span class="math display">\[
\begin{aligned}
  2! \cdot a_2 &amp;=
  \left(1 \cdot y_2 - 2 \cdot y_1 + 1 \cdot y_0\right) -
  a_3\cdot 6
  \\
  2! \cdot a_2 &amp;=
  \left(1 \cdot y_2 - 2 \cdot y_1 + 1 \cdot y_0\right) -
  \frac{y_3 - 3y_2 + 3y_1 - y_0 }{3\cdot2} \cdot \left(2^3 - 2\right)
  \\
  2! \cdot a_2 &amp;=
  \left(y_2 - 2y_1 + y_0\right) -
  \left(y_3 - 3y_2 + 3y_1 - y_0\right)
  \\
  2! \cdot a_2 &amp;
  = - y_3 + 4y_2 - 5y_1 + 2y_0
  \\
  a_2 &amp;
  = \frac{- y_3 + 4y_2 - 5y_1 + 2y_0}{2}
\end{aligned}
\]</span></p>
<p>Following the same strategy, we can also find <span class="math inline">\(a_1\)</span>. Let <span class="math inline">\(\widehat{y}\left(M,1\right)=y\left(M\right)-a_3\cdot t^3-a_2\cdot t^2\)</span></p>
<p><span class="math display">\[
\begin{aligned}
  \frac{d^{2}\widehat{y}(3,1)}{dt^{2}} &amp;=
  \left(y_1 - y_0\right) -
  a_3\cdot\left(1^3 - 0^3 \right) -
  a_2\cdot\left(1^2 - 0^2 \right)
  \\
  &amp;=
  \left(y_1 - y_0\right) - a_3 - a_2
  \\
  \frac{d^{2}\widehat{y}(3,1)}{dt^{2}} &amp;= 1! \cdot a_1
\end{aligned}
\]</span></p>
<p>Hence:</p>
<p><span class="math display">\[
\begin{aligned}
  a_1 &amp;=
  \left(y_1 - y_0\right) -
  a_3\cdot\left(1^3 - 0^3 \right) -
  a_2\cdot\left(1^2 - 0^2 \right)
  \\
  &amp;=
  \left(y_1 - y_0\right) - a_3 - a_2
  \\
  &amp;=
  \left(y_1 - y_0\right) -
  \frac{y_3 - 3y_2 + 3y_1 - y_0 }{3\cdot2} -
  \frac{- y_3 + 4y_2 - 5y_1 + 2y_0}{2}
  \\
  &amp;=
  \frac{6y_1 - 6y_0}{6} -
  \frac{y_3 - 3y_2 + 3y_1 - y_0 }{6} -
  \frac{-3y_3 + 12y_2 - 15y_1 + 6y_0}{6}
  \\
  &amp;=
  \frac{6y_1 - 6y_0 -y_3 + 3y_2 - 3y_1 + y_0 +3y_3 - 12y_2 + 15y_1 - 6y_0}{6}
  \\
  &amp;=
  \frac{2y_3 - 9y_2 + 18y_1 - 11y_0}{6}
\end{aligned}
\]</span></p>
<p>Finally, we know that <span class="math inline">\(a_0 = y_0\)</span>. We have now analytical expressions for each of the 4 polynomial coefficients for a 3rd order polynomial. Given data from the data-generating process, these would back out the underlying parameters of the data generating process using data from four periods at <span class="math inline">\(t=0,1,2,3\)</span>.</p>
</div>
<div id="third-order-polynomial-simulation-and-solving-for-parameters" class="section level5 hasAnchor" number="5.1.2.1.5">
<h5><span class="header-section-number">5.1.2.1.5</span> Third Order Polynomial Simulation and Solving for Parameters<a href="linear-regression.html#third-order-polynomial-simulation-and-solving-for-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Now we generated a time-series of values and solve back for the underlying polynomial coefficients.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="linear-regression.html#cb459-1" tabindex="-1"></a><span class="co"># polynomial coefficients</span></span>
<span id="cb459-2"><a href="linear-regression.html#cb459-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb459-3"><a href="linear-regression.html#cb459-3" tabindex="-1"></a>ar_coef_poly <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">4</span>)</span>
<span id="cb459-4"><a href="linear-regression.html#cb459-4" tabindex="-1"></a><span class="co"># time right hand side matrix</span></span>
<span id="cb459-5"><a href="linear-regression.html#cb459-5" tabindex="-1"></a>ar_t <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb459-6"><a href="linear-regression.html#cb459-6" tabindex="-1"></a>ar_power <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb459-7"><a href="linear-regression.html#cb459-7" tabindex="-1"></a>mt_t_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(ar_power, <span class="cf">function</span>(power) {</span>
<span id="cb459-8"><a href="linear-regression.html#cb459-8" tabindex="-1"></a>  ar_t<span class="sc">^</span>power</span>
<span id="cb459-9"><a href="linear-regression.html#cb459-9" tabindex="-1"></a>}))</span>
<span id="cb459-10"><a href="linear-regression.html#cb459-10" tabindex="-1"></a><span class="co"># Final matrix, each row is an observation, or time.</span></span>
<span id="cb459-11"><a href="linear-regression.html#cb459-11" tabindex="-1"></a>mt_t_data <span class="ot">&lt;-</span> <span class="fu">t</span>(mt_t_data)</span>
<span id="cb459-12"><a href="linear-regression.html#cb459-12" tabindex="-1"></a><span class="co"># General model prediction</span></span>
<span id="cb459-13"><a href="linear-regression.html#cb459-13" tabindex="-1"></a>ar_y <span class="ot">&lt;-</span> mt_t_data <span class="sc">%*%</span> <span class="fu">matrix</span>(ar_coef_poly, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb459-14"><a href="linear-regression.html#cb459-14" tabindex="-1"></a><span class="co"># Prediction and Input time matrix</span></span>
<span id="cb459-15"><a href="linear-regression.html#cb459-15" tabindex="-1"></a>mt_all_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_y, mt_t_data)</span>
<span id="cb459-16"><a href="linear-regression.html#cb459-16" tabindex="-1"></a>st_cap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb459-17"><a href="linear-regression.html#cb459-17" tabindex="-1"></a>  <span class="st">&quot;C1=Y, each row is time, t=0, incremental by 1, &quot;</span>,</span>
<span id="cb459-18"><a href="linear-regression.html#cb459-18" tabindex="-1"></a>  <span class="st">&quot;each column a polynomial term from 0th to higher.&quot;</span></span>
<span id="cb459-19"><a href="linear-regression.html#cb459-19" tabindex="-1"></a>)</span>
<span id="cb459-20"><a href="linear-regression.html#cb459-20" tabindex="-1"></a><span class="fu">kable</span>(mt_all_data, <span class="at">caption =</span> st_cap) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-238">Table 5.4: </span>C1=Y, each row is time, t=0, incremental by 1, each column a polynomial term from 0th to higher.
</caption>
<tbody>
<tr>
<td style="text-align:right;">
-0.5604756
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8385636
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
5.7780698
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
14.6810933
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
27
</td>
</tr>
</tbody>
</table>
<p>Backing out coefficients using the formulas for 3rd order polynomial derived above, we have:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="linear-regression.html#cb460-1" tabindex="-1"></a><span class="co"># The constant term</span></span>
<span id="cb460-2"><a href="linear-regression.html#cb460-2" tabindex="-1"></a>alpha_0 <span class="ot">&lt;-</span> ar_y[<span class="dv">1</span>]</span>
<span id="cb460-3"><a href="linear-regression.html#cb460-3" tabindex="-1"></a><span class="co"># The cubic term</span></span>
<span id="cb460-4"><a href="linear-regression.html#cb460-4" tabindex="-1"></a>alpha_3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>((<span class="fu">t</span>(ar_y) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>))</span>
<span id="cb460-5"><a href="linear-regression.html#cb460-5" tabindex="-1"></a><span class="co"># The quadratic term, difference cubic out, alpha_2_1t3 = alpha_2_2t4</span></span>
<span id="cb460-6"><a href="linear-regression.html#cb460-6" tabindex="-1"></a>ar_y_hat <span class="ot">&lt;-</span> ar_y <span class="sc">-</span> alpha_3<span class="sc">*</span>ar_t<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb460-7"><a href="linear-regression.html#cb460-7" tabindex="-1"></a>alpha_2_1t3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>((<span class="fu">t</span>(ar_y_hat[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">2</span>))</span>
<span id="cb460-8"><a href="linear-regression.html#cb460-8" tabindex="-1"></a>alpha_2_2t4 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>((<span class="fu">t</span>(ar_y_hat[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">2</span>))</span>
<span id="cb460-9"><a href="linear-regression.html#cb460-9" tabindex="-1"></a>alpha_2 <span class="ot">&lt;-</span> alpha_2_1t3</span>
<span id="cb460-10"><a href="linear-regression.html#cb460-10" tabindex="-1"></a><span class="co"># The linear term, difference cubic out and quadratic</span></span>
<span id="cb460-11"><a href="linear-regression.html#cb460-11" tabindex="-1"></a>ar_y_hat <span class="ot">&lt;-</span> ar_y <span class="sc">-</span> alpha_3<span class="sc">*</span>ar_t<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> alpha_2<span class="sc">*</span>ar_t<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb460-12"><a href="linear-regression.html#cb460-12" tabindex="-1"></a>alpha_1_1t2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>((<span class="fu">t</span>(ar_y_hat[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span>))</span>
<span id="cb460-13"><a href="linear-regression.html#cb460-13" tabindex="-1"></a>alpha_1_2t3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>((<span class="fu">t</span>(ar_y_hat[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span>))</span>
<span id="cb460-14"><a href="linear-regression.html#cb460-14" tabindex="-1"></a>alpha_1_3t4 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>((<span class="fu">t</span>(ar_y_hat[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">%*%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span>))</span>
<span id="cb460-15"><a href="linear-regression.html#cb460-15" tabindex="-1"></a>alpha_1 <span class="ot">&lt;-</span> alpha_1_1t2</span>
<span id="cb460-16"><a href="linear-regression.html#cb460-16" tabindex="-1"></a><span class="co"># Collect results</span></span>
<span id="cb460-17"><a href="linear-regression.html#cb460-17" tabindex="-1"></a>ar_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Constant&quot;</span>, <span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;Cubic&quot;</span>)</span>
<span id="cb460-18"><a href="linear-regression.html#cb460-18" tabindex="-1"></a>ar_alpha_solved <span class="ot">&lt;-</span> <span class="fu">c</span>(alpha_0, alpha_1, alpha_2, alpha_3)</span>
<span id="cb460-19"><a href="linear-regression.html#cb460-19" tabindex="-1"></a>mt_alpha <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ar_names, ar_alpha_solved, ar_coef_poly)</span>
<span id="cb460-20"><a href="linear-regression.html#cb460-20" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb460-21"><a href="linear-regression.html#cb460-21" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Coefficient Counter&#39;</span>, <span class="st">&#39;Polynomial Terms&#39;</span>, <span class="st">&#39;Solved Coefficient Given Y&#39;</span>, <span class="st">&#39;Actual DGP Coefficient&#39;</span>)</span>
<span id="cb460-22"><a href="linear-regression.html#cb460-22" tabindex="-1"></a>tb_alpha <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_alpha) <span class="sc">%&gt;%</span></span>
<span id="cb460-23"><a href="linear-regression.html#cb460-23" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;polynomial_term_coef&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb460-24"><a href="linear-regression.html#cb460-24" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb460-25"><a href="linear-regression.html#cb460-25" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb460-26"><a href="linear-regression.html#cb460-26" tabindex="-1"></a>st_cap <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;Solving for polynomial coefficients.&#39;</span>)</span>
<span id="cb460-27"><a href="linear-regression.html#cb460-27" tabindex="-1"></a><span class="fu">kable</span>(tb_alpha, <span class="at">caption =</span> st_cap) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-239">Table 5.5: </span>Solving for polynomial coefficients.
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Coefficient Counter
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Polynomial Terms
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Solved Coefficient Given Y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Actual DGP Coefficient
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Constant
</td>
<td style="text-align:left;">
-0.560475646552213
</td>
<td style="text-align:left;">
-0.560475646552213
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Linear
</td>
<td style="text-align:left;">
-0.230177489483281
</td>
<td style="text-align:left;">
-0.23017748948328
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Quadratic
</td>
<td style="text-align:left;">
1.55870831414913
</td>
<td style="text-align:left;">
1.55870831414912
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Cubic
</td>
<td style="text-align:left;">
0.0705083914245757
</td>
<td style="text-align:left;">
0.070508391424576
</td>
</tr>
</tbody>
</table>
<p>Note that given that the data is exact output from DGP, and we have the same number of data and parameters, parameters are exactly identified. However, this is only really true for the <span class="math inline">\(a_3\)</span> parameter, which requires all four periods of data.
- For <span class="math inline">\(a_2\)</span>, it is over-identified, we can arrived at it, given <span class="math inline">\(a_3\)</span>, either with difference of differences using data from <span class="math inline">\(t=1,2,3\)</span> or using data from <span class="math inline">\(t=2,3,4\)</span>.
- For <span class="math inline">\(a_1\)</span>, it is also over-identified, given <span class="math inline">\(a_3\)</span> and <span class="math inline">\(a_2\)</span>. The difference of <span class="math inline">\(t=1,2\)</span>, <span class="math inline">\(t=2,3\)</span> or <span class="math inline">\(t=3,4\)</span> can all identify <span class="math inline">\(a_1\)</span>.</p>
<p>Note also that the solution above can be found by running a linear regression as well. The point of doing the exercise here and showing analytically how layers of differences of differences identify each polynomial coefficient is to show what in the underlying variation of the data is identifying each of the polynomial term.</p>
<p>In effect, all identification is based on the fact that the <span class="math inline">\(M^{th}\)</span> order polynomialâ€™s <span class="math inline">\(M^{th}\)</span> derivative is a constant, it is invariant over <span class="math inline">\(t\)</span>. This is the core assumption, or restriction of the otherwise highly flexible polynomial functional form. With this core invariance at the max degree derivative condition, all other parameters are obtained through the simple act of differencing.</p>

</div>
</div>
</div>
</div>
<div id="ols-and-iv" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> OLS and IV<a href="linear-regression.html#ols-and-iv" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<p>Back to <strong><a href="https://fanwangecon.github.io/">Fan</a></strong>â€™s R4Econ Homepage <strong><a href="https://fanwangecon.github.io/R4Econ/">Table of Content</a></strong></p>
<div id="ols-and-iv-regression" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> OLS and IV Regression<a href="linear-regression.html#ols-and-iv-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>IV regression using AER package. Option to store all results in dataframe row for combining results from other estimations together. Produce Row Statistics.</p>
<div id="construct-program" class="section level4 hasAnchor" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Construct Program<a href="linear-regression.html#construct-program" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="linear-regression.html#cb461-1" tabindex="-1"></a><span class="co"># IV regression function</span></span>
<span id="cb461-2"><a href="linear-regression.html#cb461-2" tabindex="-1"></a><span class="co"># The code below uses the AER library&#39;s regresison function</span></span>
<span id="cb461-3"><a href="linear-regression.html#cb461-3" tabindex="-1"></a><span class="co"># All results are stored in a single row as data_frame</span></span>
<span id="cb461-4"><a href="linear-regression.html#cb461-4" tabindex="-1"></a><span class="co"># This functoin could work with dplyr do</span></span>
<span id="cb461-5"><a href="linear-regression.html#cb461-5" tabindex="-1"></a><span class="co"># var.y is single outcome, vars.x, vars.c and vars.z are vectors of endogenous variables, controls and instruments.</span></span>
<span id="cb461-6"><a href="linear-regression.html#cb461-6" tabindex="-1"></a>regf.iv <span class="ot">&lt;-</span> <span class="cf">function</span>(var.y, vars.x, </span>
<span id="cb461-7"><a href="linear-regression.html#cb461-7" tabindex="-1"></a>                    vars.c, vars.z, df, <span class="at">transpose=</span><span class="cn">TRUE</span>) {</span>
<span id="cb461-8"><a href="linear-regression.html#cb461-8" tabindex="-1"></a>  </span>
<span id="cb461-9"><a href="linear-regression.html#cb461-9" tabindex="-1"></a>  <span class="co"># A. Set-Up Equation</span></span>
<span id="cb461-10"><a href="linear-regression.html#cb461-10" tabindex="-1"></a>  str.vars.x <span class="ot">&lt;-</span> <span class="fu">paste</span>(vars.x, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb461-11"><a href="linear-regression.html#cb461-11" tabindex="-1"></a>  str.vars.c <span class="ot">&lt;-</span> <span class="fu">paste</span>(vars.c, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb461-12"><a href="linear-regression.html#cb461-12" tabindex="-1"></a>  </span>
<span id="cb461-13"><a href="linear-regression.html#cb461-13" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb461-14"><a href="linear-regression.html#cb461-14" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">one_of</span>(var.y, vars.x, vars.c, vars.z)) <span class="sc">%&gt;%</span> </span>
<span id="cb461-15"><a href="linear-regression.html#cb461-15" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">filter_all</span>(<span class="fu">all_vars</span>(<span class="sc">!</span><span class="fu">is.infinite</span>(.)))</span>
<span id="cb461-16"><a href="linear-regression.html#cb461-16" tabindex="-1"></a>  </span>
<span id="cb461-17"><a href="linear-regression.html#cb461-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(vars.z) <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb461-18"><a href="linear-regression.html#cb461-18" tabindex="-1"></a>    <span class="co">#     library(AER)</span></span>
<span id="cb461-19"><a href="linear-regression.html#cb461-19" tabindex="-1"></a>    str.vars.z <span class="ot">&lt;-</span> <span class="fu">paste</span>(vars.z, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb461-20"><a href="linear-regression.html#cb461-20" tabindex="-1"></a>    equa.iv <span class="ot">&lt;-</span> <span class="fu">paste</span>(var.y,</span>
<span id="cb461-21"><a href="linear-regression.html#cb461-21" tabindex="-1"></a>                     <span class="fu">paste</span>(<span class="fu">paste</span>(str.vars.x, str.vars.c, <span class="at">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb461-22"><a href="linear-regression.html#cb461-22" tabindex="-1"></a>                           <span class="fu">paste</span>(str.vars.z, str.vars.c, <span class="at">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb461-23"><a href="linear-regression.html#cb461-23" tabindex="-1"></a>                           <span class="at">sep=</span><span class="st">&#39;|&#39;</span>),</span>
<span id="cb461-24"><a href="linear-regression.html#cb461-24" tabindex="-1"></a>                     <span class="at">sep=</span><span class="st">&#39;~&#39;</span>)</span>
<span id="cb461-25"><a href="linear-regression.html#cb461-25" tabindex="-1"></a>    <span class="co">#     print(equa.iv)</span></span>
<span id="cb461-26"><a href="linear-regression.html#cb461-26" tabindex="-1"></a>    </span>
<span id="cb461-27"><a href="linear-regression.html#cb461-27" tabindex="-1"></a>    <span class="co"># B. IV Regression</span></span>
<span id="cb461-28"><a href="linear-regression.html#cb461-28" tabindex="-1"></a>    ivreg.summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">ivreg</span>(<span class="fu">as.formula</span>(equa.iv), <span class="at">data=</span>df),</span>
<span id="cb461-29"><a href="linear-regression.html#cb461-29" tabindex="-1"></a>                          <span class="at">vcov =</span> sandwich, <span class="at">df =</span> <span class="cn">Inf</span>, <span class="at">diagnostics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb461-30"><a href="linear-regression.html#cb461-30" tabindex="-1"></a>    </span>
<span id="cb461-31"><a href="linear-regression.html#cb461-31" tabindex="-1"></a>    <span class="co"># C. Statistics from IV Regression</span></span>
<span id="cb461-32"><a href="linear-regression.html#cb461-32" tabindex="-1"></a>    <span class="co">#     ivreg.summ$coef</span></span>
<span id="cb461-33"><a href="linear-regression.html#cb461-33" tabindex="-1"></a>    <span class="co">#     ivreg.summ$diagnostics</span></span>
<span id="cb461-34"><a href="linear-regression.html#cb461-34" tabindex="-1"></a>    </span>
<span id="cb461-35"><a href="linear-regression.html#cb461-35" tabindex="-1"></a>    <span class="co"># D. Combine Regression Results into a Matrix</span></span>
<span id="cb461-36"><a href="linear-regression.html#cb461-36" tabindex="-1"></a>    df.results <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb461-37"><a href="linear-regression.html#cb461-37" tabindex="-1"></a>      <span class="fu">as_tibble</span>(ivreg.summ<span class="sc">$</span>coef, <span class="at">rownames=</span><span class="st">&#39;rownames&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb461-38"><a href="linear-regression.html#cb461-38" tabindex="-1"></a>        <span class="fu">full_join</span>(<span class="fu">as_tibble</span>(ivreg.summ<span class="sc">$</span>diagnostics, <span class="at">rownames=</span><span class="st">&#39;rownames&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb461-39"><a href="linear-regression.html#cb461-39" tabindex="-1"></a>        <span class="fu">full_join</span>(<span class="fu">tibble</span>(<span class="at">rownames=</span><span class="fu">c</span>(<span class="st">&#39;vars&#39;</span>),</span>
<span id="cb461-40"><a href="linear-regression.html#cb461-40" tabindex="-1"></a>                         <span class="at">var.y=</span>var.y,</span>
<span id="cb461-41"><a href="linear-regression.html#cb461-41" tabindex="-1"></a>                         <span class="at">vars.x=</span>str.vars.x,</span>
<span id="cb461-42"><a href="linear-regression.html#cb461-42" tabindex="-1"></a>                         <span class="at">vars.z=</span>str.vars.z,</span>
<span id="cb461-43"><a href="linear-regression.html#cb461-43" tabindex="-1"></a>                         <span class="at">vars.c=</span>str.vars.c))))</span>
<span id="cb461-44"><a href="linear-regression.html#cb461-44" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb461-45"><a href="linear-regression.html#cb461-45" tabindex="-1"></a>    </span>
<span id="cb461-46"><a href="linear-regression.html#cb461-46" tabindex="-1"></a>    <span class="co"># OLS regression</span></span>
<span id="cb461-47"><a href="linear-regression.html#cb461-47" tabindex="-1"></a>    equa.ols <span class="ot">&lt;-</span> <span class="fu">paste</span>(var.y,</span>
<span id="cb461-48"><a href="linear-regression.html#cb461-48" tabindex="-1"></a>                      <span class="fu">paste</span>(<span class="fu">paste</span>(vars.x, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb461-49"><a href="linear-regression.html#cb461-49" tabindex="-1"></a>                            <span class="fu">paste</span>(vars.c, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>), <span class="at">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb461-50"><a href="linear-regression.html#cb461-50" tabindex="-1"></a>                      <span class="at">sep=</span><span class="st">&#39;~&#39;</span>)</span>
<span id="cb461-51"><a href="linear-regression.html#cb461-51" tabindex="-1"></a>    </span>
<span id="cb461-52"><a href="linear-regression.html#cb461-52" tabindex="-1"></a>    lmreg.summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="fu">as.formula</span>(equa.ols), <span class="at">data=</span>df))</span>
<span id="cb461-53"><a href="linear-regression.html#cb461-53" tabindex="-1"></a>    </span>
<span id="cb461-54"><a href="linear-regression.html#cb461-54" tabindex="-1"></a>    lm.diagnostics <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(</span>
<span id="cb461-55"><a href="linear-regression.html#cb461-55" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">df1=</span>lmreg.summ<span class="sc">$</span>df[[<span class="dv">1</span>]],</span>
<span id="cb461-56"><a href="linear-regression.html#cb461-56" tabindex="-1"></a>           <span class="at">df2=</span>lmreg.summ<span class="sc">$</span>df[[<span class="dv">2</span>]],</span>
<span id="cb461-57"><a href="linear-regression.html#cb461-57" tabindex="-1"></a>           <span class="at">df3=</span>lmreg.summ<span class="sc">$</span>df[[<span class="dv">3</span>]],</span>
<span id="cb461-58"><a href="linear-regression.html#cb461-58" tabindex="-1"></a>           <span class="at">sigma=</span>lmreg.summ<span class="sc">$</span>sigma,</span>
<span id="cb461-59"><a href="linear-regression.html#cb461-59" tabindex="-1"></a>           <span class="at">r.squared=</span>lmreg.summ<span class="sc">$</span>r.squared,</span>
<span id="cb461-60"><a href="linear-regression.html#cb461-60" tabindex="-1"></a>           <span class="at">adj.r.squared=</span>lmreg.summ<span class="sc">$</span>adj.r.squared)) <span class="sc">%&gt;%</span></span>
<span id="cb461-61"><a href="linear-regression.html#cb461-61" tabindex="-1"></a>      <span class="fu">gather</span>(variable, value) <span class="sc">%&gt;%</span></span>
<span id="cb461-62"><a href="linear-regression.html#cb461-62" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">rownames =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb461-63"><a href="linear-regression.html#cb461-63" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">v =</span> value)</span>
<span id="cb461-64"><a href="linear-regression.html#cb461-64" tabindex="-1"></a>    </span>
<span id="cb461-65"><a href="linear-regression.html#cb461-65" tabindex="-1"></a>    df.results <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb461-66"><a href="linear-regression.html#cb461-66" tabindex="-1"></a>      <span class="fu">as_tibble</span>(lmreg.summ<span class="sc">$</span>coef, <span class="at">rownames=</span><span class="st">&#39;rownames&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb461-67"><a href="linear-regression.html#cb461-67" tabindex="-1"></a>        <span class="fu">full_join</span>(lm.diagnostics) <span class="sc">%&gt;%</span></span>
<span id="cb461-68"><a href="linear-regression.html#cb461-68" tabindex="-1"></a>        <span class="fu">full_join</span>(<span class="fu">tibble</span>(<span class="at">rownames=</span><span class="fu">c</span>(<span class="st">&#39;vars&#39;</span>),</span>
<span id="cb461-69"><a href="linear-regression.html#cb461-69" tabindex="-1"></a>                         <span class="at">var.y=</span>var.y,</span>
<span id="cb461-70"><a href="linear-regression.html#cb461-70" tabindex="-1"></a>                         <span class="at">vars.x=</span>str.vars.x,</span>
<span id="cb461-71"><a href="linear-regression.html#cb461-71" tabindex="-1"></a>                         <span class="at">vars.c=</span>str.vars.c))))</span>
<span id="cb461-72"><a href="linear-regression.html#cb461-72" tabindex="-1"></a>  }</span>
<span id="cb461-73"><a href="linear-regression.html#cb461-73" tabindex="-1"></a>  </span>
<span id="cb461-74"><a href="linear-regression.html#cb461-74" tabindex="-1"></a>  <span class="co"># E. Flatten Matrix, All IV results as a single tibble </span></span>
<span id="cb461-75"><a href="linear-regression.html#cb461-75" tabindex="-1"></a>  <span class="co"># row to be combined with other IV results</span></span>
<span id="cb461-76"><a href="linear-regression.html#cb461-76" tabindex="-1"></a>  df.row.results <span class="ot">&lt;-</span> df.results <span class="sc">%&gt;%</span></span>
<span id="cb461-77"><a href="linear-regression.html#cb461-77" tabindex="-1"></a>    <span class="fu">gather</span>(variable, value, <span class="sc">-</span>rownames) <span class="sc">%&gt;%</span></span>
<span id="cb461-78"><a href="linear-regression.html#cb461-78" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb461-79"><a href="linear-regression.html#cb461-79" tabindex="-1"></a>    <span class="fu">unite</span>(esti.val, rownames, variable) <span class="sc">%&gt;%</span></span>
<span id="cb461-80"><a href="linear-regression.html#cb461-80" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">esti.val =</span> <span class="fu">gsub</span>(<span class="st">&#39; &#39;</span>, <span class="st">&#39;&#39;</span>, esti.val))</span>
<span id="cb461-81"><a href="linear-regression.html#cb461-81" tabindex="-1"></a>  </span>
<span id="cb461-82"><a href="linear-regression.html#cb461-82" tabindex="-1"></a>  <span class="cf">if</span> (transpose) {</span>
<span id="cb461-83"><a href="linear-regression.html#cb461-83" tabindex="-1"></a>    df.row.results <span class="ot">&lt;-</span> df.row.results <span class="sc">%&gt;%</span> <span class="fu">spread</span>(esti.val, value)</span>
<span id="cb461-84"><a href="linear-regression.html#cb461-84" tabindex="-1"></a>  }</span>
<span id="cb461-85"><a href="linear-regression.html#cb461-85" tabindex="-1"></a>  </span>
<span id="cb461-86"><a href="linear-regression.html#cb461-86" tabindex="-1"></a>  <span class="co"># F. Return</span></span>
<span id="cb461-87"><a href="linear-regression.html#cb461-87" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(df.row.results))</span>
<span id="cb461-88"><a href="linear-regression.html#cb461-88" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="program-testing" class="section level4 hasAnchor" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Program Testing<a href="linear-regression.html#program-testing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Load Data</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="linear-regression.html#cb462-1" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb462-2"><a href="linear-regression.html#cb462-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb462-3"><a href="linear-regression.html#cb462-3" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb462-4"><a href="linear-regression.html#cb462-4" tabindex="-1"></a></span>
<span id="cb462-5"><a href="linear-regression.html#cb462-5" tabindex="-1"></a><span class="co"># Load Sample Data</span></span>
<span id="cb462-6"><a href="linear-regression.html#cb462-6" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb462-7"><a href="linear-regression.html#cb462-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span></code></pre></div>
<div id="example-no-instrument-ols" class="section level5 hasAnchor" number="5.2.1.2.1">
<h5><span class="header-section-number">5.2.1.2.1</span> Example No Instrument, OLS<a href="linear-regression.html#example-no-instrument-ols" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="linear-regression.html#cb463-1" tabindex="-1"></a><span class="co"># One Instrucments</span></span>
<span id="cb463-2"><a href="linear-regression.html#cb463-2" tabindex="-1"></a>var.y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb463-3"><a href="linear-regression.html#cb463-3" tabindex="-1"></a>vars.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb463-4"><a href="linear-regression.html#cb463-4" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb463-5"><a href="linear-regression.html#cb463-5" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb463-6"><a href="linear-regression.html#cb463-6" tabindex="-1"></a><span class="co"># Regression</span></span>
<span id="cb463-7"><a href="linear-regression.html#cb463-7" tabindex="-1"></a><span class="fu">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="at">transpose=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb463-8"><a href="linear-regression.html#cb463-8" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb463-9"><a href="linear-regression.html#cb463-9" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
52.1186286658655
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.37447238635789
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.611043720578337
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.148513781160842
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.00150560230505629
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
1.57770483608693
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.004181211911338
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.118396259120663
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0393807494783184
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.000187123663624396
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_tvalue
</td>
<td style="text-align:left;">
33.0344608660336
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_tvalue
</td>
<td style="text-align:left;">
89.5607288744324
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_tvalue
</td>
<td style="text-align:left;">
5.16100529794268
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_tvalue
</td>
<td style="text-align:left;">
3.77122790013451
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_tvalue
</td>
<td style="text-align:left;">
8.04602836377986
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
9.92126150965951e-233
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
2.48105505495376e-07
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
0.000162939618371172
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|t|)
</td>
<td style="text-align:left;">
9.05257561534482e-16
</td>
</tr>
<tr>
<td style="text-align:left;">
df1_v
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
df2_v
</td>
<td style="text-align:left;">
18958
</td>
</tr>
<tr>
<td style="text-align:left;">
df3_v
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_v
</td>
<td style="text-align:left;">
8.06197784622979
</td>
</tr>
<tr>
<td style="text-align:left;">
r.squared_v
</td>
<td style="text-align:left;">
0.319078711001326
</td>
</tr>
<tr>
<td style="text-align:left;">
adj.r.squared_v
</td>
<td style="text-align:left;">
0.318935041565942
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-1-insturment" class="section level5 hasAnchor" number="5.2.1.2.2">
<h5><span class="header-section-number">5.2.1.2.2</span> Example 1 Insturment<a href="linear-regression.html#example-1-insturment" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="linear-regression.html#cb464-1" tabindex="-1"></a><span class="co"># One Instrucments</span></span>
<span id="cb464-2"><a href="linear-regression.html#cb464-2" tabindex="-1"></a>var.y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb464-3"><a href="linear-regression.html#cb464-3" tabindex="-1"></a>vars.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb464-4"><a href="linear-regression.html#cb464-4" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;momEdu&#39;</span>)</span>
<span id="cb464-5"><a href="linear-regression.html#cb464-5" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb464-6"><a href="linear-regression.html#cb464-6" tabindex="-1"></a><span class="co"># Regression</span></span>
<span id="cb464-7"><a href="linear-regression.html#cb464-7" tabindex="-1"></a><span class="fu">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="at">transpose=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb464-8"><a href="linear-regression.html#cb464-8" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb464-9"><a href="linear-regression.html#cb464-9" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
43.4301969117894
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.130833343849431
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.868121847262594
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.412093881816612
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.000858630042618959
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
1.82489550970971
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.0192036220809207
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.133730167005418
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0459431912925973
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.000226910577025037
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_zvalue
</td>
<td style="text-align:left;">
23.7987307660689
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
6.81295139521715
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
6.49159323361512
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
8.96963990141912
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
3.78400184723085
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
3.44237661591474e-125
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
9.56164541652958e-12
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
8.49333228164569e-11
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
2.97485394504032e-19
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.000154326676599558
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df2
</td>
<td style="text-align:left;">
16394
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df2
</td>
<td style="text-align:left;">
16393
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_statistic
</td>
<td style="text-align:left;">
935.817456612075
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_statistic
</td>
<td style="text-align:left;">
123.595856606734
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_p-value
</td>
<td style="text-align:left;">
6.3971492917806e-200
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_p-value
</td>
<td style="text-align:left;">
1.30703637796418e-28
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
momEdu
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-multiple-instrucments" class="section level5 hasAnchor" number="5.2.1.2.3">
<h5><span class="header-section-number">5.2.1.2.3</span> Example Multiple Instrucments<a href="linear-regression.html#example-multiple-instrucments" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="linear-regression.html#cb465-1" tabindex="-1"></a><span class="co"># Multiple Instrucments</span></span>
<span id="cb465-2"><a href="linear-regression.html#cb465-2" tabindex="-1"></a>var.y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb465-3"><a href="linear-regression.html#cb465-3" tabindex="-1"></a>vars.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb465-4"><a href="linear-regression.html#cb465-4" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;momEdu&#39;</span>, <span class="st">&#39;wealthIdx&#39;</span>, <span class="st">&#39;p.A.prot&#39;</span>, <span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb465-5"><a href="linear-regression.html#cb465-5" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb465-6"><a href="linear-regression.html#cb465-6" tabindex="-1"></a><span class="co"># Regression</span></span>
<span id="cb465-7"><a href="linear-regression.html#cb465-7" tabindex="-1"></a><span class="fu">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="at">transpose=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb465-8"><a href="linear-regression.html#cb465-8" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb465-9"><a href="linear-regression.html#cb465-9" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
42.243761355532
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.266999451947032
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.695548488813011
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.424954881262903
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.00048695142032974
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
1.8535668678938
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.0154939347964086
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.133157977814372
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0463195803786077
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.000224867994873511
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_zvalue
</td>
<td style="text-align:left;">
22.7905246297013
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
17.2325142357589
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
5.22348341593647
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
9.17441129192881
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
2.16549901022443
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
5.6929407426237e-115
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.51424021933765e-66
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.75588197501936e-07
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
4.54048595586446e-20
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.0303494911144483
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df1
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df2
</td>
<td style="text-align:left;">
14916
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_statistic
</td>
<td style="text-align:left;">
274.147084958342
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_statistic
</td>
<td style="text-align:left;">
17.7562545747099
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_statistic
</td>
<td style="text-align:left;">
463.729664547247
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_p-value
</td>
<td style="text-align:left;">
8.6173195623464e-228
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_p-value
</td>
<td style="text-align:left;">
2.52567249124201e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_p-value
</td>
<td style="text-align:left;">
3.45452874915773e-100
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
momEdu+wealthIdx+p.A.prot+p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-multiple-endogenous-variables" class="section level5 hasAnchor" number="5.2.1.2.4">
<h5><span class="header-section-number">5.2.1.2.4</span> Example Multiple Endogenous Variables<a href="linear-regression.html#example-multiple-endogenous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="linear-regression.html#cb466-1" tabindex="-1"></a><span class="co"># Multiple Instrucments</span></span>
<span id="cb466-2"><a href="linear-regression.html#cb466-2" tabindex="-1"></a>var.y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb466-3"><a href="linear-regression.html#cb466-3" tabindex="-1"></a>vars.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>, <span class="st">&#39;cal&#39;</span>)</span>
<span id="cb466-4"><a href="linear-regression.html#cb466-4" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;momEdu&#39;</span>, <span class="st">&#39;wealthIdx&#39;</span>, <span class="st">&#39;p.A.prot&#39;</span>, <span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb466-5"><a href="linear-regression.html#cb466-5" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb466-6"><a href="linear-regression.html#cb466-6" tabindex="-1"></a><span class="co"># Regression</span></span>
<span id="cb466-7"><a href="linear-regression.html#cb466-7" tabindex="-1"></a><span class="fu">regf.iv</span>(var.y, vars.x, vars.c, vars.z, df, <span class="at">transpose=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb466-8"><a href="linear-regression.html#cb466-8" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb466-9"><a href="linear-regression.html#cb466-9" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
esti.val
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)_Estimate
</td>
<td style="text-align:left;">
44.0243196254372
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
-1.40256232471058
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Estimate
</td>
<td style="text-align:left;">
0.0651048957501503
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.120832787571903
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.286525437984394
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
0.000850481389651284
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Std.Error
</td>
<td style="text-align:left;">
2.75354847245259
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.198640060272442
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Std.Error
</td>
<td style="text-align:left;">
0.00758881298876464
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.209984580636194
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0707828182891216
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.000337112104445047
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_zvalue
</td>
<td style="text-align:left;">
15.9882130515846
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
-7.06082309271814
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_zvalue
</td>
<td style="text-align:left;">
8.57906181724851
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
0.575436478268133
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
4.04795181810993
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
2.52284441417891
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.54396598289425e-57
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
1.65519210798224e-12
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
9.56500647777971e-18
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.564996139463126
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
5.16677787150118e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Pr(&gt;|z|)
</td>
<td style="text-align:left;">
0.011640989283946
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_df1
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_df1
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_df2
</td>
<td style="text-align:left;">
14914
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_statistic
</td>
<td style="text-align:left;">
274.147084958342
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_statistic
</td>
<td style="text-align:left;">
315.036848606229
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_statistic
</td>
<td style="text-align:left;">
94.7020085425631
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_statistic
</td>
<td style="text-align:left;">
122.0819796289
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(prot)_p-value
</td>
<td style="text-align:left;">
8.6173195623464e-228
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments(cal)_p-value
</td>
<td style="text-align:left;">
1.18918641221312e-260
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu-Hausman_p-value
</td>
<td style="text-align:left;">
1.35024050402095e-41
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_p-value
</td>
<td style="text-align:left;">
3.09196773720141e-27
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot+cal
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
momEdu+wealthIdx+p.A.prot+p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+hgt0+wgt0
</td>
</tr>
</tbody>
</table>
</div>
<div id="examples-line-by-line" class="section level5 hasAnchor" number="5.2.1.2.5">
<h5><span class="header-section-number">5.2.1.2.5</span> Examples Line by Line<a href="linear-regression.html#examples-line-by-line" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The examples are just to test the code with different types of variables.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="linear-regression.html#cb467-1" tabindex="-1"></a><span class="co"># Selecting Variables</span></span>
<span id="cb467-2"><a href="linear-regression.html#cb467-2" tabindex="-1"></a>var.y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb467-3"><a href="linear-regression.html#cb467-3" tabindex="-1"></a>vars.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>, <span class="st">&#39;cal&#39;</span>)</span>
<span id="cb467-4"><a href="linear-regression.html#cb467-4" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;momEdu&#39;</span>, <span class="st">&#39;wealthIdx&#39;</span>, <span class="st">&#39;p.A.prot&#39;</span>, <span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb467-5"><a href="linear-regression.html#cb467-5" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="linear-regression.html#cb468-1" tabindex="-1"></a><span class="co"># A. create Equation</span></span>
<span id="cb468-2"><a href="linear-regression.html#cb468-2" tabindex="-1"></a>str.vars.x <span class="ot">&lt;-</span> <span class="fu">paste</span>(vars.x, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb468-3"><a href="linear-regression.html#cb468-3" tabindex="-1"></a>str.vars.c <span class="ot">&lt;-</span> <span class="fu">paste</span>(vars.c, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb468-4"><a href="linear-regression.html#cb468-4" tabindex="-1"></a>str.vars.z <span class="ot">&lt;-</span> <span class="fu">paste</span>(vars.z, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb468-5"><a href="linear-regression.html#cb468-5" tabindex="-1"></a><span class="fu">print</span>(str.vars.x)</span></code></pre></div>
<pre><code>## [1] &quot;prot+cal&quot;</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="linear-regression.html#cb470-1" tabindex="-1"></a><span class="fu">print</span>(str.vars.c)</span></code></pre></div>
<pre><code>## [1] &quot;sex+hgt0+wgt0&quot;</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="linear-regression.html#cb472-1" tabindex="-1"></a><span class="fu">print</span>(str.vars.z)</span></code></pre></div>
<pre><code>## [1] &quot;momEdu+wealthIdx+p.A.prot+p.A.nProt&quot;</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="linear-regression.html#cb474-1" tabindex="-1"></a>equa.iv <span class="ot">&lt;-</span> <span class="fu">paste</span>(var.y,</span>
<span id="cb474-2"><a href="linear-regression.html#cb474-2" tabindex="-1"></a>                 <span class="fu">paste</span>(<span class="fu">paste</span>(str.vars.x, str.vars.c, <span class="at">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb474-3"><a href="linear-regression.html#cb474-3" tabindex="-1"></a>                       <span class="fu">paste</span>(str.vars.z, str.vars.c, <span class="at">sep=</span><span class="st">&#39;+&#39;</span>),</span>
<span id="cb474-4"><a href="linear-regression.html#cb474-4" tabindex="-1"></a>                       <span class="at">sep=</span><span class="st">&#39;|&#39;</span>),</span>
<span id="cb474-5"><a href="linear-regression.html#cb474-5" tabindex="-1"></a>                 <span class="at">sep=</span><span class="st">&#39;~&#39;</span>)</span>
<span id="cb474-6"><a href="linear-regression.html#cb474-6" tabindex="-1"></a><span class="fu">print</span>(equa.iv)</span></code></pre></div>
<pre><code>## [1] &quot;hgt~prot+cal+sex+hgt0+wgt0|momEdu+wealthIdx+p.A.prot+p.A.nProt+sex+hgt0+wgt0&quot;</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="linear-regression.html#cb476-1" tabindex="-1"></a><span class="co"># B. regression</span></span>
<span id="cb476-2"><a href="linear-regression.html#cb476-2" tabindex="-1"></a>res.ivreg <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">as.formula</span>(equa.iv), <span class="at">data=</span>df)</span>
<span id="cb476-3"><a href="linear-regression.html#cb476-3" tabindex="-1"></a><span class="fu">coef</span>(res.ivreg)</span></code></pre></div>
<pre><code>##   (Intercept)          prot           cal       sexMale          hgt0          wgt0 
## 44.0243196254 -1.4025623247  0.0651048958  0.1208327876  0.2865254380  0.0008504814</code></pre>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="linear-regression.html#cb478-1" tabindex="-1"></a><span class="co"># C. Regression Summary</span></span>
<span id="cb478-2"><a href="linear-regression.html#cb478-2" tabindex="-1"></a>ivreg.summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(res.ivreg, <span class="at">vcov =</span> sandwich, <span class="at">df =</span> <span class="cn">Inf</span>, <span class="at">diagnostics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb478-3"><a href="linear-regression.html#cb478-3" tabindex="-1"></a></span>
<span id="cb478-4"><a href="linear-regression.html#cb478-4" tabindex="-1"></a>ivreg.summ<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##                  Estimate   Std. Error    z value     Pr(&gt;|z|)
## (Intercept) 44.0243196254 2.7535484725 15.9882131 1.543966e-57
## prot        -1.4025623247 0.1986400603 -7.0608231 1.655192e-12
## cal          0.0651048958 0.0075888130  8.5790618 9.565006e-18
## sexMale      0.1208327876 0.2099845806  0.5754365 5.649961e-01
## hgt0         0.2865254380 0.0707828183  4.0479518 5.166778e-05
## wgt0         0.0008504814 0.0003371121  2.5228444 1.164099e-02
## attr(,&quot;df&quot;)
## [1] 0
## attr(,&quot;nobs&quot;)
## [1] 14922</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="linear-regression.html#cb480-1" tabindex="-1"></a>ivreg.summ<span class="sc">$</span>diagnostics</span></code></pre></div>
<pre><code>##                         df1   df2 statistic       p-value
## Weak instruments (prot)   4 14914 274.14708 8.617320e-228
## Weak instruments (cal)    4 14914 315.03685 1.189186e-260
## Wu-Hausman                2 14914  94.70201  1.350241e-41
## Sargan                    2    NA 122.08198  3.091968e-27</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="linear-regression.html#cb482-1" tabindex="-1"></a><span class="co"># D. Combine Regression Results into a Matrix</span></span>
<span id="cb482-2"><a href="linear-regression.html#cb482-2" tabindex="-1"></a>df.results <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">as_tibble</span>(ivreg.summ<span class="sc">$</span>coef, <span class="at">rownames=</span><span class="st">&#39;rownames&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb482-3"><a href="linear-regression.html#cb482-3" tabindex="-1"></a>    <span class="fu">full_join</span>(<span class="fu">as_tibble</span>(ivreg.summ<span class="sc">$</span>diagnostics, <span class="at">rownames=</span><span class="st">&#39;rownames&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb482-4"><a href="linear-regression.html#cb482-4" tabindex="-1"></a>    <span class="fu">full_join</span>(<span class="fu">tibble</span>(<span class="at">rownames=</span><span class="fu">c</span>(<span class="st">&#39;vars&#39;</span>),</span>
<span id="cb482-5"><a href="linear-regression.html#cb482-5" tabindex="-1"></a>                     <span class="at">var.y=</span>var.y,</span>
<span id="cb482-6"><a href="linear-regression.html#cb482-6" tabindex="-1"></a>                     <span class="at">vars.x=</span>str.vars.x,</span>
<span id="cb482-7"><a href="linear-regression.html#cb482-7" tabindex="-1"></a>                     <span class="at">vars.z=</span>str.vars.z,</span>
<span id="cb482-8"><a href="linear-regression.html#cb482-8" tabindex="-1"></a>                     <span class="at">vars.c=</span>str.vars.c)))</span>
<span id="cb482-9"><a href="linear-regression.html#cb482-9" tabindex="-1"></a><span class="co"># E. Flatten Matrix, All IV results as a single tibble row to be combined with other IV results</span></span>
<span id="cb482-10"><a href="linear-regression.html#cb482-10" tabindex="-1"></a>df.row.results <span class="ot">&lt;-</span> df.results <span class="sc">%&gt;%</span></span>
<span id="cb482-11"><a href="linear-regression.html#cb482-11" tabindex="-1"></a>    <span class="fu">gather</span>(variable, value, <span class="sc">-</span>rownames) <span class="sc">%&gt;%</span></span>
<span id="cb482-12"><a href="linear-regression.html#cb482-12" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb482-13"><a href="linear-regression.html#cb482-13" tabindex="-1"></a>    <span class="fu">unite</span>(esti.val, rownames, variable) <span class="sc">%&gt;%</span></span>
<span id="cb482-14"><a href="linear-regression.html#cb482-14" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">esti.val =</span> <span class="fu">gsub</span>(<span class="st">&#39; &#39;</span>, <span class="st">&#39;&#39;</span>, esti.val))</span></code></pre></div>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="linear-regression.html#cb483-1" tabindex="-1"></a><span class="co"># F. Results as Single Colum</span></span>
<span id="cb483-2"><a href="linear-regression.html#cb483-2" tabindex="-1"></a><span class="co"># df.row.results</span></span></code></pre></div>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="linear-regression.html#cb484-1" tabindex="-1"></a><span class="co"># G. Results as Single Row</span></span>
<span id="cb484-2"><a href="linear-regression.html#cb484-2" tabindex="-1"></a><span class="co"># df.row.results</span></span></code></pre></div>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="linear-regression.html#cb485-1" tabindex="-1"></a><span class="co"># t(df.row.results %&gt;% spread(esti.val, value)) %&gt;%</span></span>
<span id="cb485-2"><a href="linear-regression.html#cb485-2" tabindex="-1"></a><span class="co">#   kable() %&gt;%</span></span>
<span id="cb485-3"><a href="linear-regression.html#cb485-3" tabindex="-1"></a><span class="co">#   kable_styling_fc_wide()</span></span></code></pre></div>

</div>
</div>
</div>
<div id="iv-loop-over-rhs" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> IV Loop over RHS<a href="linear-regression.html#iv-loop-over-rhs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>Regression with a Variety of Outcome Variables and Right Hand Side Variables. There are M outcome variables, and there are N alternative right hand side variables. Regress each M outcome variable and each N alternative right hand side variable, with some common sets of controls and perhaps shared instruments. The output file is a M by N matrix of coefficients, with proper variable names and row names. The matrix stores coefficients for this key endogenous variable.</p>
<ul>
<li>Dependency: <em>R4Econ/linreg/ivreg/ivregdfrow.R</em></li>
</ul>
<div id="construct-program-1" class="section level4 hasAnchor" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Construct Program<a href="linear-regression.html#construct-program-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The program relies on double lapply. lapply is used for convenience, not speed.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="linear-regression.html#cb486-1" tabindex="-1"></a>ff_reg_mbyn <span class="ot">&lt;-</span> <span class="cf">function</span>(list.vars.y, list.vars.x,</span>
<span id="cb486-2"><a href="linear-regression.html#cb486-2" tabindex="-1"></a>                        vars.c, vars.z, df,</span>
<span id="cb486-3"><a href="linear-regression.html#cb486-3" tabindex="-1"></a>                        <span class="at">return_all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb486-4"><a href="linear-regression.html#cb486-4" tabindex="-1"></a>                        <span class="at">stats_ends =</span> <span class="st">&#39;value&#39;</span>, <span class="at">time =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb486-5"><a href="linear-regression.html#cb486-5" tabindex="-1"></a></span>
<span id="cb486-6"><a href="linear-regression.html#cb486-6" tabindex="-1"></a>  <span class="co"># regf.iv() function is from C:\Users\fan\R4Econ\linreg\ivreg\ivregdfrow.R</span></span>
<span id="cb486-7"><a href="linear-regression.html#cb486-7" tabindex="-1"></a>  <span class="cf">if</span> (time) {</span>
<span id="cb486-8"><a href="linear-regression.html#cb486-8" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb486-9"><a href="linear-regression.html#cb486-9" tabindex="-1"></a>  }</span>
<span id="cb486-10"><a href="linear-regression.html#cb486-10" tabindex="-1"></a></span>
<span id="cb486-11"><a href="linear-regression.html#cb486-11" tabindex="-1"></a>  <span class="cf">if</span> (return_all) {</span>
<span id="cb486-12"><a href="linear-regression.html#cb486-12" tabindex="-1"></a>    df.reg.out.all <span class="ot">&lt;-</span></span>
<span id="cb486-13"><a href="linear-regression.html#cb486-13" tabindex="-1"></a>      <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(list.vars.x,</span>
<span id="cb486-14"><a href="linear-regression.html#cb486-14" tabindex="-1"></a>                       <span class="cf">function</span>(x) (</span>
<span id="cb486-15"><a href="linear-regression.html#cb486-15" tabindex="-1"></a>                         <span class="fu">bind_rows</span>(</span>
<span id="cb486-16"><a href="linear-regression.html#cb486-16" tabindex="-1"></a>                           <span class="fu">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb486-17"><a href="linear-regression.html#cb486-17" tabindex="-1"></a>                                  <span class="at">vars.x=</span>x, <span class="at">vars.c=</span>vars.c, <span class="at">vars.z=</span>vars.z, <span class="at">df=</span>df))</span>
<span id="cb486-18"><a href="linear-regression.html#cb486-18" tabindex="-1"></a>                       )))</span>
<span id="cb486-19"><a href="linear-regression.html#cb486-19" tabindex="-1"></a></span>
<span id="cb486-20"><a href="linear-regression.html#cb486-20" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb486-21"><a href="linear-regression.html#cb486-21" tabindex="-1"></a>    df.reg.out.all <span class="ot">&lt;-</span></span>
<span id="cb486-22"><a href="linear-regression.html#cb486-22" tabindex="-1"></a>      (<span class="fu">lapply</span>(list.vars.x,</span>
<span id="cb486-23"><a href="linear-regression.html#cb486-23" tabindex="-1"></a>              <span class="cf">function</span>(x) (</span>
<span id="cb486-24"><a href="linear-regression.html#cb486-24" tabindex="-1"></a>                <span class="fu">bind_rows</span>(</span>
<span id="cb486-25"><a href="linear-regression.html#cb486-25" tabindex="-1"></a>                  <span class="fu">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb486-26"><a href="linear-regression.html#cb486-26" tabindex="-1"></a>                         <span class="at">vars.x=</span>x, <span class="at">vars.c=</span>vars.c, <span class="at">vars.z=</span>vars.z, <span class="at">df=</span>df)) <span class="sc">%&gt;%</span></span>
<span id="cb486-27"><a href="linear-regression.html#cb486-27" tabindex="-1"></a>                  <span class="fu">select</span>(vars_var.y, <span class="fu">starts_with</span>(x)) <span class="sc">%&gt;%</span></span>
<span id="cb486-28"><a href="linear-regression.html#cb486-28" tabindex="-1"></a>                  <span class="fu">select</span>(vars_var.y, <span class="fu">ends_with</span>(stats_ends))</span>
<span id="cb486-29"><a href="linear-regression.html#cb486-29" tabindex="-1"></a>              ))) <span class="sc">%&gt;%</span> <span class="fu">reduce</span>(full_join)</span>
<span id="cb486-30"><a href="linear-regression.html#cb486-30" tabindex="-1"></a>  }</span>
<span id="cb486-31"><a href="linear-regression.html#cb486-31" tabindex="-1"></a></span>
<span id="cb486-32"><a href="linear-regression.html#cb486-32" tabindex="-1"></a>  <span class="cf">if</span> (time) {</span>
<span id="cb486-33"><a href="linear-regression.html#cb486-33" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb486-34"><a href="linear-regression.html#cb486-34" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Estimation for all ys and xs took (seconds):&#39;</span>,</span>
<span id="cb486-35"><a href="linear-regression.html#cb486-35" tabindex="-1"></a>                 end_time <span class="sc">-</span> start_time))</span>
<span id="cb486-36"><a href="linear-regression.html#cb486-36" tabindex="-1"></a>  }</span>
<span id="cb486-37"><a href="linear-regression.html#cb486-37" tabindex="-1"></a></span>
<span id="cb486-38"><a href="linear-regression.html#cb486-38" tabindex="-1"></a>  <span class="fu">return</span>(df.reg.out.all)</span>
<span id="cb486-39"><a href="linear-regression.html#cb486-39" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="prepare-data" class="section level4 hasAnchor" number="5.2.2.2">
<h4><span class="header-section-number">5.2.2.2</span> Prepare Data<a href="linear-regression.html#prepare-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="linear-regression.html#cb487-1" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb487-2"><a href="linear-regression.html#cb487-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb487-3"><a href="linear-regression.html#cb487-3" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb487-4"><a href="linear-regression.html#cb487-4" tabindex="-1"></a></span>
<span id="cb487-5"><a href="linear-regression.html#cb487-5" tabindex="-1"></a><span class="co"># Load Sample Data</span></span>
<span id="cb487-6"><a href="linear-regression.html#cb487-6" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb487-7"><a href="linear-regression.html#cb487-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span>
<span id="cb487-8"><a href="linear-regression.html#cb487-8" tabindex="-1"></a></span>
<span id="cb487-9"><a href="linear-regression.html#cb487-9" tabindex="-1"></a><span class="co"># Source Dependency</span></span>
<span id="cb487-10"><a href="linear-regression.html#cb487-10" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;C:/Users/fan/R4Econ/linreg/ivreg/ivregdfrow.R&#39;</span>)</span>
<span id="cb487-11"><a href="linear-regression.html#cb487-11" tabindex="-1"></a></span>
<span id="cb487-12"><a href="linear-regression.html#cb487-12" tabindex="-1"></a><span class="co"># Setting</span></span>
<span id="cb487-13"><a href="linear-regression.html#cb487-13" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.matrix.max.rows=</span><span class="dv">50</span>, <span class="at">repr.matrix.max.cols=</span><span class="dv">50</span>)</span></code></pre></div>
<p>Parameters.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="linear-regression.html#cb488-1" tabindex="-1"></a>var.y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb488-2"><a href="linear-regression.html#cb488-2" tabindex="-1"></a>var.y2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;wgt&#39;</span>)</span>
<span id="cb488-3"><a href="linear-regression.html#cb488-3" tabindex="-1"></a>var.y3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;vil.id&#39;</span>)</span>
<span id="cb488-4"><a href="linear-regression.html#cb488-4" tabindex="-1"></a>list.vars.y <span class="ot">&lt;-</span> <span class="fu">c</span>(var.y1, var.y2, var.y3)</span>
<span id="cb488-5"><a href="linear-regression.html#cb488-5" tabindex="-1"></a></span>
<span id="cb488-6"><a href="linear-regression.html#cb488-6" tabindex="-1"></a>var.x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb488-7"><a href="linear-regression.html#cb488-7" tabindex="-1"></a>var.x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;cal&#39;</span>)</span>
<span id="cb488-8"><a href="linear-regression.html#cb488-8" tabindex="-1"></a>var.x3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;wealthIdx&#39;</span>)</span>
<span id="cb488-9"><a href="linear-regression.html#cb488-9" tabindex="-1"></a>var.x4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;p.A.prot&#39;</span>)</span>
<span id="cb488-10"><a href="linear-regression.html#cb488-10" tabindex="-1"></a>var.x5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;p.A.nProt&#39;</span>)</span>
<span id="cb488-11"><a href="linear-regression.html#cb488-11" tabindex="-1"></a>list.vars.x <span class="ot">&lt;-</span> <span class="fu">c</span>(var.x1, var.x2, var.x3, var.x4, var.x5)</span>
<span id="cb488-12"><a href="linear-regression.html#cb488-12" tabindex="-1"></a></span>
<span id="cb488-13"><a href="linear-regression.html#cb488-13" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb488-14"><a href="linear-regression.html#cb488-14" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;wgt0&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span></code></pre></div>
</div>
<div id="program-testing-1" class="section level4 hasAnchor" number="5.2.2.3">
<h4><span class="header-section-number">5.2.2.3</span> Program Testing<a href="linear-regression.html#program-testing-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="test-program-ols-z-stat" class="section level5 hasAnchor" number="5.2.2.3.1">
<h5><span class="header-section-number">5.2.2.3.1</span> Test Program OLS Z-Stat<a href="linear-regression.html#test-program-ols-z-stat" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="linear-regression.html#cb489-1" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb489-2"><a href="linear-regression.html#cb489-2" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb489-3"><a href="linear-regression.html#cb489-3" tabindex="-1"></a>  <span class="fu">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb489-4"><a href="linear-regression.html#cb489-4" tabindex="-1"></a>              vars.c, vars.z, df,</span>
<span id="cb489-5"><a href="linear-regression.html#cb489-5" tabindex="-1"></a>              <span class="at">return_all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb489-6"><a href="linear-regression.html#cb489-6" tabindex="-1"></a>              <span class="at">stats_ends =</span> <span class="st">&#39;value&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb489-7"><a href="linear-regression.html#cb489-7" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb489-8"><a href="linear-regression.html#cb489-8" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_tvalue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
18.8756010031766
</td>
<td style="text-align:left;">
23.4421863484656
</td>
<td style="text-align:left;">
13.5088996182178
</td>
<td style="text-align:left;">
3.83682180045522
</td>
<td style="text-align:left;">
32.5448257554849
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
16.359112505607
</td>
<td style="text-align:left;">
17.368603130933
</td>
<td style="text-align:left;">
14.1390521528125
</td>
<td style="text-align:left;">
1.36958319982295
</td>
<td style="text-align:left;">
12.0961557911473
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-14.9385580468905
</td>
<td style="text-align:left;">
-19.6150110809449
</td>
<td style="text-align:left;">
34.0972558327354
</td>
<td style="text-align:left;">
8.45943342783161
</td>
<td style="text-align:left;">
17.7801422421398
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-iv-t-stat" class="section level5 hasAnchor" number="5.2.2.3.2">
<h5><span class="header-section-number">5.2.2.3.2</span> Test Program IV T-stat<a href="linear-regression.html#test-program-iv-t-stat" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="linear-regression.html#cb490-1" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb490-2"><a href="linear-regression.html#cb490-2" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb490-3"><a href="linear-regression.html#cb490-3" tabindex="-1"></a>  <span class="fu">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb490-4"><a href="linear-regression.html#cb490-4" tabindex="-1"></a>              vars.c, vars.z, df,</span>
<span id="cb490-5"><a href="linear-regression.html#cb490-5" tabindex="-1"></a>              <span class="at">return_all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb490-6"><a href="linear-regression.html#cb490-6" tabindex="-1"></a>              <span class="at">stats_ends =</span> <span class="st">&#39;value&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb490-7"><a href="linear-regression.html#cb490-7" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb490-8"><a href="linear-regression.html#cb490-8" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_zvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_zvalue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
8.87674929306359
</td>
<td style="text-align:left;">
12.0739764946734
</td>
<td style="text-align:left;">
4.62589553677888
</td>
<td style="text-align:left;">
26.6373587567245
</td>
<td style="text-align:left;">
32.1162192385715
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
5.60385871757577
</td>
<td style="text-align:left;">
6.12251870088371
</td>
<td style="text-align:left;">
5.17869536991513
</td>
<td style="text-align:left;">
11.9295584469951
</td>
<td style="text-align:left;">
12.3509307017258
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-9.22106223346427
</td>
<td style="text-align:left;">
-13.0586007975956
</td>
<td style="text-align:left;">
-51.5866689219473
</td>
<td style="text-align:left;">
-29.9627476577358
</td>
<td style="text-align:left;">
-38.3528894620791
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-ols-coefficient" class="section level5 hasAnchor" number="5.2.2.3.3">
<h5><span class="header-section-number">5.2.2.3.3</span> Test Program OLS Coefficient<a href="linear-regression.html#test-program-ols-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="linear-regression.html#cb491-1" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb491-2"><a href="linear-regression.html#cb491-2" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb491-3"><a href="linear-regression.html#cb491-3" tabindex="-1"></a>  <span class="fu">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb491-4"><a href="linear-regression.html#cb491-4" tabindex="-1"></a>              vars.c, vars.z, df,</span>
<span id="cb491-5"><a href="linear-regression.html#cb491-5" tabindex="-1"></a>              <span class="at">return_all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb491-6"><a href="linear-regression.html#cb491-6" tabindex="-1"></a>              <span class="at">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb491-7"><a href="linear-regression.html#cb491-7" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb491-8"><a href="linear-regression.html#cb491-8" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_Estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
0.0494310938067476
</td>
<td style="text-align:left;">
0.00243408846205617
</td>
<td style="text-align:left;">
0.210456554881893
</td>
<td style="text-align:left;">
3.86952250259533e-05
</td>
<td style="text-align:left;">
0.00542428867316432
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
16.5557424523601
</td>
<td style="text-align:left;">
0.69907250036464
</td>
<td style="text-align:left;">
106.678721085982
</td>
<td style="text-align:left;">
0.00521731297924599
</td>
<td style="text-align:left;">
0.77951423205071
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-0.0758835879205561
</td>
<td style="text-align:left;">
-0.00395676177098467
</td>
<td style="text-align:left;">
0.451733304543376
</td>
<td style="text-align:left;">
0.000149388430455129
</td>
<td style="text-align:left;">
0.00526237555580908
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-iv-coefficient" class="section level5 hasAnchor" number="5.2.2.3.4">
<h5><span class="header-section-number">5.2.2.3.4</span> Test Program IV coefficient<a href="linear-regression.html#test-program-iv-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="linear-regression.html#cb492-1" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb492-2"><a href="linear-regression.html#cb492-2" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb492-3"><a href="linear-regression.html#cb492-3" tabindex="-1"></a>  <span class="fu">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb492-4"><a href="linear-regression.html#cb492-4" tabindex="-1"></a>              vars.c, vars.z, df,</span>
<span id="cb492-5"><a href="linear-regression.html#cb492-5" tabindex="-1"></a>              <span class="at">return_all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb492-6"><a href="linear-regression.html#cb492-6" tabindex="-1"></a>              <span class="at">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb492-7"><a href="linear-regression.html#cb492-7" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb492-8"><a href="linear-regression.html#cb492-8" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_Estimate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_Estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
0.859205733631884
</td>
<td style="text-align:left;">
0.0238724384575233
</td>
<td style="text-align:left;">
0.144503490136916
</td>
<td style="text-align:left;">
0.00148073028434634
</td>
<td style="text-align:left;">
0.0141317656200728
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
98.9428234201429
</td>
<td style="text-align:left;">
2.71948246216963
</td>
<td style="text-align:left;">
69.1816142882735
</td>
<td style="text-align:left;">
0.221916473012471
</td>
<td style="text-align:left;">
2.1185694049434
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-6.0245137913613
</td>
<td style="text-align:left;">
-0.168054407187466
</td>
<td style="text-align:left;">
-1.91414470908346
</td>
<td style="text-align:left;">
-0.00520794333267228
</td>
<td style="text-align:left;">
-0.0494468877742103
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-ols-return-all" class="section level5 hasAnchor" number="5.2.2.3.5">
<h5><span class="header-section-number">5.2.2.3.5</span> Test Program OLS Return All<a href="linear-regression.html#test-program-ols-return-all" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="linear-regression.html#cb493-1" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb493-2"><a href="linear-regression.html#cb493-2" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb493-3"><a href="linear-regression.html#cb493-3" tabindex="-1"></a>  <span class="fu">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb493-4"><a href="linear-regression.html#cb493-4" tabindex="-1"></a>            vars.c, vars.z, df,</span>
<span id="cb493-5"><a href="linear-regression.html#cb493-5" tabindex="-1"></a>            <span class="at">return_all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb493-6"><a href="linear-regression.html#cb493-6" tabindex="-1"></a>            <span class="at">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb493-7"><a href="linear-regression.html#cb493-7" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb493-8"><a href="linear-regression.html#cb493-8" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
X.Intercept._Estimate
</td>
<td style="text-align:left;">
27.3528514188611
</td>
<td style="text-align:left;">
99.8738847289486
</td>
<td style="text-align:left;">
31.4646660224049
</td>
<td style="text-align:left;">
27.9038445914726
</td>
<td style="text-align:left;">
219.626705179383
</td>
<td style="text-align:left;">
30.510398789855
</td>
<td style="text-align:left;">
35.7840188807902
</td>
<td style="text-align:left;">
-2662.74787734015
</td>
<td style="text-align:left;">
29.2381039651118
</td>
<td style="text-align:left;">
23.9948407749741
</td>
<td style="text-align:left;">
-547.959546430028
</td>
<td style="text-align:left;">
22.3367814226239
</td>
<td style="text-align:left;">
24.4904444950826
</td>
<td style="text-align:left;">
-476.703973630535
</td>
<td style="text-align:left;">
22.7781908464511
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Prâ€¦t..
</td>
<td style="text-align:left;">
5.68247182207379e-231
</td>
<td style="text-align:left;">
0.755297055538094
</td>
<td style="text-align:left;">
6.78164655341251e-84
</td>
<td style="text-align:left;">
8.24252674004467e-242
</td>
<td style="text-align:left;">
0.493216914827213
</td>
<td style="text-align:left;">
1.62608789535448e-79
</td>
<td style="text-align:left;">
2.26726906490865e-145
</td>
<td style="text-align:left;">
7.13318862989451e-05
</td>
<td style="text-align:left;">
1.53578035270423e-124
</td>
<td style="text-align:left;">
2.11912344055752e-165
</td>
<td style="text-align:left;">
0.0941551350855863
</td>
<td style="text-align:left;">
3.04337266226398e-49
</td>
<td style="text-align:left;">
2.34941965808017e-181
</td>
<td style="text-align:left;">
0.143844033032196
</td>
<td style="text-align:left;">
9.58029450711073e-52
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Std.Error
</td>
<td style="text-align:left;">
0.831272666092281
</td>
<td style="text-align:left;">
320.450650378664
</td>
<td style="text-align:left;">
1.61328519718754
</td>
<td style="text-align:left;">
0.828072565159453
</td>
<td style="text-align:left;">
320.522532223671
</td>
<td style="text-align:left;">
1.60831193651105
</td>
<td style="text-align:left;">
1.38461348429899
</td>
<td style="text-align:left;">
670.301542938553
</td>
<td style="text-align:left;">
1.22602177264147
</td>
<td style="text-align:left;">
0.866581042166723
</td>
<td style="text-align:left;">
327.343126852911
</td>
<td style="text-align:left;">
1.5098937308759
</td>
<td style="text-align:left;">
0.843371070670839
</td>
<td style="text-align:left;">
326.132837036935
</td>
<td style="text-align:left;">
1.50045265589571
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._tvalue
</td>
<td style="text-align:left;">
32.904788686778
</td>
<td style="text-align:left;">
0.311666974652514
</td>
<td style="text-align:left;">
19.5034740771549
</td>
<td style="text-align:left;">
33.6973421962113
</td>
<td style="text-align:left;">
0.685214557790027
</td>
<td style="text-align:left;">
18.9704485163755
</td>
<td style="text-align:left;">
25.8440491058103
</td>
<td style="text-align:left;">
-3.9724627003943
</td>
<td style="text-align:left;">
23.8479483950095
</td>
<td style="text-align:left;">
27.6890903532572
</td>
<td style="text-align:left;">
-1.6739607509042
</td>
<td style="text-align:left;">
14.7936116071336
</td>
<td style="text-align:left;">
29.0387533397396
</td>
<td style="text-align:left;">
-1.46168652614562
</td>
<td style="text-align:left;">
15.1808794212527
</td>
</tr>
<tr>
<td style="text-align:left;">
adj.r.squared_v
</td>
<td style="text-align:left;">
0.814249026159781
</td>
<td style="text-align:left;">
0.60716936506893
</td>
<td style="text-align:left;">
0.037324751268097
</td>
<td style="text-align:left;">
0.81608922805658
</td>
<td style="text-align:left;">
0.607863678511207
</td>
<td style="text-align:left;">
0.045349871107604
</td>
<td style="text-align:left;">
0.935014931990565
</td>
<td style="text-align:left;">
0.92193683733695
</td>
<td style="text-align:left;">
0.0595431228127756
</td>
<td style="text-align:left;">
0.814690803458616
</td>
<td style="text-align:left;">
0.617300597776144
</td>
<td style="text-align:left;">
0.026113107419984
</td>
<td style="text-align:left;">
0.824542352656376
</td>
<td style="text-align:left;">
0.620250730454724
</td>
<td style="text-align:left;">
0.0385437355117912
</td>
</tr>
<tr>
<td style="text-align:left;">
df1_v
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
df2_v
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
25092
</td>
<td style="text-align:left;">
25102
</td>
<td style="text-align:left;">
30013
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
</tr>
<tr>
<td style="text-align:left;">
df3_v
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.603918173406165
</td>
<td style="text-align:left;">
56.3852027199177
</td>
<td style="text-align:left;">
-0.296844389234445
</td>
<td style="text-align:left;">
0.589847843438402
</td>
<td style="text-align:left;">
52.9707041800702
</td>
<td style="text-align:left;">
-0.273219210757899
</td>
<td style="text-align:left;">
0.439374451256045
</td>
<td style="text-align:left;">
47.1769696647486
</td>
<td style="text-align:left;">
-0.359081639820446
</td>
<td style="text-align:left;">
0.687269209411872
</td>
<td style="text-align:left;">
72.1055606233589
</td>
<td style="text-align:left;">
-0.108789161111504
</td>
<td style="text-align:left;">
0.622395388389211
</td>
<td style="text-align:left;">
62.7336220289252
</td>
<td style="text-align:left;">
-0.157811627494689
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Prâ€¦t..
</td>
<td style="text-align:left;">
1.14533314567228e-183
</td>
<td style="text-align:left;">
1.52417506966924e-12
</td>
<td style="text-align:left;">
1.40290395213742e-13
</td>
<td style="text-align:left;">
7.79174951113908e-177
</td>
<td style="text-align:left;">
3.05720143843438e-11
</td>
<td style="text-align:left;">
8.49149153665201e-12
</td>
<td style="text-align:left;">
2.71000479248473e-36
</td>
<td style="text-align:left;">
0.00520266507060087
</td>
<td style="text-align:left;">
2.41020063625353e-31
</td>
<td style="text-align:left;">
1.31914432912238e-220
</td>
<td style="text-align:left;">
4.78613024243947e-19
</td>
<td style="text-align:left;">
0.0034801146146179
</td>
<td style="text-align:left;">
1.11511327164595e-190
</td>
<td style="text-align:left;">
8.38546282719406e-15
</td>
<td style="text-align:left;">
2.13723119924767e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.0206657538633712
</td>
<td style="text-align:left;">
7.96735224000553
</td>
<td style="text-align:left;">
0.0401060913799595
</td>
<td style="text-align:left;">
0.0205836398278422
</td>
<td style="text-align:left;">
7.96822145797113
</td>
<td style="text-align:left;">
0.0399777363511634
</td>
<td style="text-align:left;">
0.0348701896610764
</td>
<td style="text-align:left;">
16.8823489375742
</td>
<td style="text-align:left;">
0.0307984635553862
</td>
<td style="text-align:left;">
0.0213841849324283
</td>
<td style="text-align:left;">
8.0774490640068
</td>
<td style="text-align:left;">
0.0372288594891345
</td>
<td style="text-align:left;">
0.0208846437570216
</td>
<td style="text-align:left;">
8.07589192978209
</td>
<td style="text-align:left;">
0.0371223237183417
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_tvalue
</td>
<td style="text-align:left;">
29.2231378249682
</td>
<td style="text-align:left;">
7.07703149319762
</td>
<td style="text-align:left;">
-7.40147890309685
</td>
<td style="text-align:left;">
28.6561486875879
</td>
<td style="text-align:left;">
6.64774497790597
</td>
<td style="text-align:left;">
-6.83428417151857
</td>
<td style="text-align:left;">
12.6002885423504
</td>
<td style="text-align:left;">
2.79445531182863
</td>
<td style="text-align:left;">
-11.6590764073245
</td>
<td style="text-align:left;">
32.1391351404586
</td>
<td style="text-align:left;">
8.92677379355594
</td>
<td style="text-align:left;">
-2.92217281443326
</td>
<td style="text-align:left;">
29.8015803204667
</td>
<td style="text-align:left;">
7.76801157994421
</td>
<td style="text-align:left;">
-4.25112470577148
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.0494310938067476
</td>
<td style="text-align:left;">
16.5557424523601
</td>
<td style="text-align:left;">
-0.0758835879205561
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Prâ€¦t..
</td>
<td style="text-align:left;">
9.54769322340913e-79
</td>
<td style="text-align:left;">
9.61203373208916e-60
</td>
<td style="text-align:left;">
3.56396093563316e-50
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.00261878251179546
</td>
<td style="text-align:left;">
1.01201959743756
</td>
<td style="text-align:left;">
0.00507971302734612
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_tvalue
</td>
<td style="text-align:left;">
18.8756010031766
</td>
<td style="text-align:left;">
16.359112505607
</td>
<td style="text-align:left;">
-14.9385580468905
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
r.squared_v
</td>
<td style="text-align:left;">
0.814298005954592
</td>
<td style="text-align:left;">
0.607272921412825
</td>
<td style="text-align:left;">
0.0375780335372857
</td>
<td style="text-align:left;">
0.816137722617266
</td>
<td style="text-align:left;">
0.60796705182314
</td>
<td style="text-align:left;">
0.0456010419476621
</td>
<td style="text-align:left;">
0.93502787877066
</td>
<td style="text-align:left;">
0.921952383432195
</td>
<td style="text-align:left;">
0.0596997716363459
</td>
<td style="text-align:left;">
0.814740639193486
</td>
<td style="text-align:left;">
0.617403496088207
</td>
<td style="text-align:left;">
0.0263714328556816
</td>
<td style="text-align:left;">
0.824589538985803
</td>
<td style="text-align:left;">
0.620352835549783
</td>
<td style="text-align:left;">
0.0387987636986582
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.935177182449465
</td>
<td style="text-align:left;">
415.163616765342
</td>
<td style="text-align:left;">
-0.254089999175327
</td>
<td style="text-align:left;">
0.893484662055601
</td>
<td style="text-align:left;">
405.534891838043
</td>
<td style="text-align:left;">
-0.18138948961095
</td>
<td style="text-align:left;">
1.80682463132053
</td>
<td style="text-align:left;">
999.926876716704
</td>
<td style="text-align:left;">
-0.334367777515325
</td>
<td style="text-align:left;">
0.932686930233099
</td>
<td style="text-align:left;">
397.14194867534
</td>
<td style="text-align:left;">
-0.445232370682025
</td>
<td style="text-align:left;">
0.964669805007069
</td>
<td style="text-align:left;">
401.590563681033
</td>
<td style="text-align:left;">
-0.423829627017541
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Prâ€¦t..
</td>
<td style="text-align:left;">
2.36432111723075e-51
</td>
<td style="text-align:left;">
2.48252880292341e-67
</td>
<td style="text-align:left;">
0.0343768259467531
</td>
<td style="text-align:left;">
2.0876593533594e-47
</td>
<td style="text-align:left;">
2.51355675685191e-64
</td>
<td style="text-align:left;">
0.129768754080749
</td>
<td style="text-align:left;">
1.26527362034417e-66
</td>
<td style="text-align:left;">
2.64630894140163e-86
</td>
<td style="text-align:left;">
0.000311174554786564
</td>
<td style="text-align:left;">
7.9048902058919e-47
</td>
<td style="text-align:left;">
6.1944974268004e-59
</td>
<td style="text-align:left;">
7.93666802281656e-05
</td>
<td style="text-align:left;">
1.24556615237397e-52
</td>
<td style="text-align:left;">
1.18469030740813e-60
</td>
<td style="text-align:left;">
0.000156446936361652
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.0618482294097284
</td>
<td style="text-align:left;">
23.8518341439671
</td>
<td style="text-align:left;">
0.120093045309629
</td>
<td style="text-align:left;">
0.0616078355613521
</td>
<td style="text-align:left;">
23.856750758352
</td>
<td style="text-align:left;">
0.11972270545355
</td>
<td style="text-align:left;">
0.104475287357897
</td>
<td style="text-align:left;">
50.5879876531385
</td>
<td style="text-align:left;">
0.0927193334338761
</td>
<td style="text-align:left;">
0.0647209948973254
</td>
<td style="text-align:left;">
24.4473730956476
</td>
<td style="text-align:left;">
0.112797805327956
</td>
<td style="text-align:left;">
0.0629827627260292
</td>
<td style="text-align:left;">
24.3549086073391
</td>
<td style="text-align:left;">
0.112083516545939
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_tvalue
</td>
<td style="text-align:left;">
15.1205166481672
</td>
<td style="text-align:left;">
17.4059409544549
</td>
<td style="text-align:left;">
-2.11577613441495
</td>
<td style="text-align:left;">
14.5027763743757
</td>
<td style="text-align:left;">
16.9987478993161
</td>
<td style="text-align:left;">
-1.51508010885476
</td>
<td style="text-align:left;">
17.2942776901007
</td>
<td style="text-align:left;">
19.7660931597596
</td>
<td style="text-align:left;">
-3.60623577771709
</td>
<td style="text-align:left;">
14.4108867873977
</td>
<td style="text-align:left;">
16.2447698213451
</td>
<td style="text-align:left;">
-3.94717228218692
</td>
<td style="text-align:left;">
15.3164098120516
</td>
<td style="text-align:left;">
16.4891016491032
</td>
<td style="text-align:left;">
-3.78137339083065
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_v
</td>
<td style="text-align:left;">
4.21029844914315
</td>
<td style="text-align:left;">
1623.77111076428
</td>
<td style="text-align:left;">
8.18491760066961
</td>
<td style="text-align:left;">
4.18939119979502
</td>
<td style="text-align:left;">
1622.33549880859
</td>
<td style="text-align:left;">
8.15073036560541
</td>
<td style="text-align:left;">
8.18607049768594
</td>
<td style="text-align:left;">
3964.45339913597
</td>
<td style="text-align:left;">
7.93450742809862
</td>
<td style="text-align:left;">
4.35662621773428
</td>
<td style="text-align:left;">
1645.77655955938
</td>
<td style="text-align:left;">
7.6435668370875
</td>
<td style="text-align:left;">
4.23923961592693
</td>
<td style="text-align:left;">
1639.42085007515
</td>
<td style="text-align:left;">
7.59462918474114
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Estimate
</td>
<td style="text-align:left;">
0.871665891005652
</td>
<td style="text-align:left;">
189.042906883819
</td>
<td style="text-align:left;">
-0.015475958799392
</td>
<td style="text-align:left;">
0.851989049736821
</td>
<td style="text-align:left;">
185.318286001897
</td>
<td style="text-align:left;">
0.0201471237605437
</td>
<td style="text-align:left;">
0.432815253441721
</td>
<td style="text-align:left;">
189.87799479506
</td>
<td style="text-align:left;">
0.00215144302579708
</td>
<td style="text-align:left;">
0.919614676961391
</td>
<td style="text-align:left;">
205.597385664746
</td>
<td style="text-align:left;">
-0.0509574460702801
</td>
<td style="text-align:left;">
0.921894094780682
</td>
<td style="text-align:left;">
205.945143306004
</td>
<td style="text-align:left;">
-0.0557204455206458
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Prâ€¦t..
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.0397984032097092
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.0117151185126457
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.000447277200167213
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.3713938980249e-18
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
7.79141497752014e-23
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Std.Error
</td>
<td style="text-align:left;">
0.00387681209575622
</td>
<td style="text-align:left;">
1.4955473831309
</td>
<td style="text-align:left;">
0.00752730297891319
</td>
<td style="text-align:left;">
0.00411253488213796
</td>
<td style="text-align:left;">
1.59266949679222
</td>
<td style="text-align:left;">
0.00799217807522279
</td>
<td style="text-align:left;">
0.000728323735328996
</td>
<td style="text-align:left;">
0.352701518968251
</td>
<td style="text-align:left;">
0.000612792699568233
</td>
<td style="text-align:left;">
0.00331108017589108
</td>
<td style="text-align:left;">
1.25083486490652
</td>
<td style="text-align:left;">
0.00578476859618168
</td>
<td style="text-align:left;">
0.00317113547025635
</td>
<td style="text-align:left;">
1.22639878616071
</td>
<td style="text-align:left;">
0.00565696328562864
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_tvalue
</td>
<td style="text-align:left;">
224.840892330022
</td>
<td style="text-align:left;">
126.403823119306
</td>
<td style="text-align:left;">
-2.05597660181156
</td>
<td style="text-align:left;">
207.168832400007
</td>
<td style="text-align:left;">
116.357025971267
</td>
<td style="text-align:left;">
2.52085521254881
</td>
<td style="text-align:left;">
594.262183761196
</td>
<td style="text-align:left;">
538.353209678557
</td>
<td style="text-align:left;">
3.51088227277016
</td>
<td style="text-align:left;">
277.738571133786
</td>
<td style="text-align:left;">
164.368128386085
</td>
<td style="text-align:left;">
-8.8088996513906
</td>
<td style="text-align:left;">
290.714194782148
</td>
<td style="text-align:left;">
167.926734460268
</td>
<td style="text-align:left;">
-9.84988636256525
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
-0.000146104685986974
</td>
<td style="text-align:left;">
0.637023553461056
</td>
<td style="text-align:left;">
-0.00090339059153386
</td>
<td style="text-align:left;">
-0.000116898230009977
</td>
<td style="text-align:left;">
0.64939400361476
</td>
<td style="text-align:left;">
-0.000941137072743922
</td>
<td style="text-align:left;">
0.00122231975126217
</td>
<td style="text-align:left;">
1.32870822160237
</td>
<td style="text-align:left;">
-0.000845938526704835
</td>
<td style="text-align:left;">
-0.000489534836079631
</td>
<td style="text-align:left;">
0.580023505722661
</td>
<td style="text-align:left;">
-0.0015619691115606
</td>
<td style="text-align:left;">
3.23596154259002e-05
</td>
<td style="text-align:left;">
0.655512063046742
</td>
<td style="text-align:left;">
-0.00115432723977404
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Prâ€¦t..
</td>
<td style="text-align:left;">
0.13601158349758
</td>
<td style="text-align:left;">
2.96480083692537e-63
</td>
<td style="text-align:left;">
2.05763549729284e-06
</td>
<td style="text-align:left;">
0.230228828648909
</td>
<td style="text-align:left;">
7.43034302413299e-66
</td>
<td style="text-align:left;">
6.66901196231758e-07
</td>
<td style="text-align:left;">
1.22269348058886e-13
</td>
<td style="text-align:left;">
6.75367630220942e-62
</td>
<td style="text-align:left;">
4.32675510884396e-09
</td>
<td style="text-align:left;">
7.77000489086255e-07
</td>
<td style="text-align:left;">
7.42419220782874e-54
</td>
<td style="text-align:left;">
1.40362012201848e-19
</td>
<td style="text-align:left;">
0.740027016459631
</td>
<td style="text-align:left;">
4.09082062948253e-67
</td>
<td style="text-align:left;">
2.7547278172825e-11
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
9.79994437486569e-05
</td>
<td style="text-align:left;">
0.0378027371614794
</td>
<td style="text-align:left;">
0.00019022150316743
</td>
<td style="text-align:left;">
9.74307633896925e-05
</td>
<td style="text-align:left;">
0.037739875283113
</td>
<td style="text-align:left;">
0.000189270503626622
</td>
<td style="text-align:left;">
0.000164767846917987
</td>
<td style="text-align:left;">
0.0798131859486413
</td>
<td style="text-align:left;">
0.000144040382619523
</td>
<td style="text-align:left;">
9.90410500454322e-05
</td>
<td style="text-align:left;">
0.0374185042114355
</td>
<td style="text-align:left;">
0.000172365145002826
</td>
<td style="text-align:left;">
9.75208524392676e-05
</td>
<td style="text-align:left;">
0.0377202854835201
</td>
<td style="text-align:left;">
0.000173241059789274
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_tvalue
</td>
<td style="text-align:left;">
-1.49087260496799
</td>
<td style="text-align:left;">
16.851254731633
</td>
<td style="text-align:left;">
-4.7491507347553
</td>
<td style="text-align:left;">
-1.19980821193426
</td>
<td style="text-align:left;">
17.2071051836606
</td>
<td style="text-align:left;">
-4.97244448929307
</td>
<td style="text-align:left;">
7.41843614592217
</td>
<td style="text-align:left;">
16.6477281392748
</td>
<td style="text-align:left;">
-5.87292612891309
</td>
<td style="text-align:left;">
-4.94274682926999
</td>
<td style="text-align:left;">
15.5009805428139
</td>
<td style="text-align:left;">
-9.06197776548728
</td>
<td style="text-align:left;">
0.33182252427554
</td>
<td style="text-align:left;">
17.3782370584956
</td>
<td style="text-align:left;">
-6.66312732777168
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00243408846205617
</td>
<td style="text-align:left;">
0.69907250036464
</td>
<td style="text-align:left;">
-0.00395676177098467
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Prâ€¦t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
8.01672708887592e-120
</td>
<td style="text-align:left;">
4.71331900886782e-67
</td>
<td style="text-align:left;">
7.94646124034726e-85
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000103833679413418
</td>
<td style="text-align:left;">
0.0402492068645181
</td>
<td style="text-align:left;">
0.000201721108117471
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
23.4421863484656
</td>
<td style="text-align:left;">
17.368603130933
</td>
<td style="text-align:left;">
-19.6150110809449
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.210456554881893
</td>
<td style="text-align:left;">
106.678721085982
</td>
<td style="text-align:left;">
0.451733304543376
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Prâ€¦t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.93494257269637e-41
</td>
<td style="text-align:left;">
3.25483455344948e-45
</td>
<td style="text-align:left;">
4.82890644809744e-250
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0155791042075756
</td>
<td style="text-align:left;">
7.54496977117115
</td>
<td style="text-align:left;">
0.0132483771350797
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
13.5088996182178
</td>
<td style="text-align:left;">
14.1390521528125
</td>
<td style="text-align:left;">
34.0972558327354
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
3.86952250259533e-05
</td>
<td style="text-align:left;">
0.00521731297924599
</td>
<td style="text-align:left;">
0.000149388430455129
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Prâ€¦t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000125048896903774
</td>
<td style="text-align:left;">
0.170833589209346
</td>
<td style="text-align:left;">
2.88060045452304e-17
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.00852286184785e-05
</td>
<td style="text-align:left;">
0.00380941660201473
</td>
<td style="text-align:left;">
1.76593895713677e-05
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
3.83682180045522
</td>
<td style="text-align:left;">
1.36958319982295
</td>
<td style="text-align:left;">
8.45943342783161
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00542428867316432
</td>
<td style="text-align:left;">
0.77951423205071
</td>
<td style="text-align:left;">
0.00526237555580908
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Prâ€¦t..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
5.25341325087684e-226
</td>
<td style="text-align:left;">
1.4795093994274e-33
</td>
<td style="text-align:left;">
3.76857802825063e-70
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000166671307872962
</td>
<td style="text-align:left;">
0.0644431375975831
</td>
<td style="text-align:left;">
0.000295969260770984
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_tvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
32.5448257554849
</td>
<td style="text-align:left;">
12.0961557911473
</td>
<td style="text-align:left;">
17.7801422421398
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="test-program-iv-return-all" class="section level5 hasAnchor" number="5.2.2.3.6">
<h5><span class="header-section-number">5.2.2.3.6</span> Test Program IV Return All<a href="linear-regression.html#test-program-iv-return-all" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="linear-regression.html#cb494-1" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb494-2"><a href="linear-regression.html#cb494-2" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb494-3"><a href="linear-regression.html#cb494-3" tabindex="-1"></a>  <span class="fu">ff_reg_mbyn</span>(list.vars.y, list.vars.x,</span>
<span id="cb494-4"><a href="linear-regression.html#cb494-4" tabindex="-1"></a>            vars.c, vars.z, df,</span>
<span id="cb494-5"><a href="linear-regression.html#cb494-5" tabindex="-1"></a>            <span class="at">return_all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb494-6"><a href="linear-regression.html#cb494-6" tabindex="-1"></a>            <span class="at">stats_ends =</span> <span class="st">&#39;Estimate&#39;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb494-7"><a href="linear-regression.html#cb494-7" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb494-8"><a href="linear-regression.html#cb494-8" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
X.Intercept._Estimate
</td>
<td style="text-align:left;">
40.2173991882485
</td>
<td style="text-align:left;">
1408.16266370338
</td>
<td style="text-align:left;">
-64.4906360678745
</td>
<td style="text-align:left;">
39.6732302989797
</td>
<td style="text-align:left;">
1325.54736576349
</td>
<td style="text-align:left;">
-59.8304089440739
</td>
<td style="text-align:left;">
35.5561817357076
</td>
<td style="text-align:left;">
-2791.22153490887
</td>
<td style="text-align:left;">
21.8005242861703
</td>
<td style="text-align:left;">
24.300926170769
</td>
<td style="text-align:left;">
-499.067024090765
</td>
<td style="text-align:left;">
21.4632286881799
</td>
<td style="text-align:left;">
25.2992097396208
</td>
<td style="text-align:left;">
-352.278518335053
</td>
<td style="text-align:left;">
17.9359211845123
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Prâ€¦z..
</td>
<td style="text-align:left;">
3.69748205151063e-59
</td>
<td style="text-align:left;">
0.00217397545492022
</td>
<td style="text-align:left;">
0.000109756271652438
</td>
<td style="text-align:left;">
1.300302408639e-103
</td>
<td style="text-align:left;">
0.00138952700446946
</td>
<td style="text-align:left;">
3.75547414435365e-07
</td>
<td style="text-align:left;">
2.01357089607565e-142
</td>
<td style="text-align:left;">
1.95034793045609e-05
</td>
<td style="text-align:left;">
1.17899313915906e-34
</td>
<td style="text-align:left;">
1.979686075101e-84
</td>
<td style="text-align:left;">
0.155922992161587
</td>
<td style="text-align:left;">
1.84405333725821e-09
</td>
<td style="text-align:left;">
1.2938856648278e-157
</td>
<td style="text-align:left;">
0.287184942020645
</td>
<td style="text-align:left;">
1.13855583545194e-12
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._Std.Error
</td>
<td style="text-align:left;">
2.47963650425926
</td>
<td style="text-align:left;">
459.377029871511
</td>
<td style="text-align:left;">
16.6730992506847
</td>
<td style="text-align:left;">
1.83545587850906
</td>
<td style="text-align:left;">
414.64590052724
</td>
<td style="text-align:left;">
11.7754321199163
</td>
<td style="text-align:left;">
1.39936229104615
</td>
<td style="text-align:left;">
653.605248808668
</td>
<td style="text-align:left;">
1.77547715238971
</td>
<td style="text-align:left;">
1.24813311286047
</td>
<td style="text-align:left;">
351.723712331823
</td>
<td style="text-align:left;">
3.57067054655076
</td>
<td style="text-align:left;">
0.945826571483205
</td>
<td style="text-align:left;">
330.990098562007
</td>
<td style="text-align:left;">
2.52170174724026
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Intercept._zvalue
</td>
<td style="text-align:left;">
16.2190704642262
</td>
<td style="text-align:left;">
3.06537456628437
</td>
<td style="text-align:left;">
-3.86794531108104
</td>
<td style="text-align:left;">
21.6149190855006
</td>
<td style="text-align:left;">
3.1968177282785
</td>
<td style="text-align:left;">
-5.08095230262336
</td>
<td style="text-align:left;">
25.4088465604759
</td>
<td style="text-align:left;">
-4.27050048939548
</td>
<td style="text-align:left;">
12.2786847788088
</td>
<td style="text-align:left;">
19.4698193008246
</td>
<td style="text-align:left;">
-1.41891776582847
</td>
<td style="text-align:left;">
6.01097984492387
</td>
<td style="text-align:left;">
26.7482543865813
</td>
<td style="text-align:left;">
-1.06431739156408
</td>
<td style="text-align:left;">
7.11262590992028
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Estimate
</td>
<td style="text-align:left;">
0.403139725682047
</td>
<td style="text-align:left;">
35.5765914326644
</td>
<td style="text-align:left;">
1.20995060148709
</td>
<td style="text-align:left;">
0.357976348181521
</td>
<td style="text-align:left;">
31.017270649736
</td>
<td style="text-align:left;">
1.50374470896815
</td>
<td style="text-align:left;">
0.460434521499931
</td>
<td style="text-align:left;">
59.1545587745054
</td>
<td style="text-align:left;">
0.412512139030997
</td>
<td style="text-align:left;">
0.515794899568958
</td>
<td style="text-align:left;">
46.2591615803456
</td>
<td style="text-align:left;">
0.520812513246497
</td>
<td style="text-align:left;">
0.510868687340372
</td>
<td style="text-align:left;">
45.5654716961748
</td>
<td style="text-align:left;">
0.534362107843996
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Prâ€¦z..
</td>
<td style="text-align:left;">
1.25009876505916e-13
</td>
<td style="text-align:left;">
0.00044580263634977
</td>
<td style="text-align:left;">
0.000971126494011876
</td>
<td style="text-align:left;">
2.8214126518022e-17
</td>
<td style="text-align:left;">
0.00131003033160538
</td>
<td style="text-align:left;">
3.70002169493517e-08
</td>
<td style="text-align:left;">
2.98739737306075e-37
</td>
<td style="text-align:left;">
0.000542570320025762
</td>
<td style="text-align:left;">
3.02226358149701e-20
</td>
<td style="text-align:left;">
8.57492957072496e-59
</td>
<td style="text-align:left;">
2.85614887356539e-07
</td>
<td style="text-align:left;">
1.10039023739786e-08
</td>
<td style="text-align:left;">
3.24936431571418e-102
</td>
<td style="text-align:left;">
6.34545453001148e-08
</td>
<td style="text-align:left;">
3.42500501257647e-17
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_Std.Error
</td>
<td style="text-align:left;">
0.054394831296424
</td>
<td style="text-align:left;">
10.1318250571452
</td>
<td style="text-align:left;">
0.366789440586502
</td>
<td style="text-align:left;">
0.0423453726228281
</td>
<td style="text-align:left;">
9.65135595902108
</td>
<td style="text-align:left;">
0.273179527952845
</td>
<td style="text-align:left;">
0.0361031059207924
</td>
<td style="text-align:left;">
17.1025823111652
</td>
<td style="text-align:left;">
0.0447499166719814
</td>
<td style="text-align:left;">
0.0319035514862777
</td>
<td style="text-align:left;">
9.01263684091064
</td>
<td style="text-align:left;">
0.0911390672918101
</td>
<td style="text-align:left;">
0.0237991645880177
</td>
<td style="text-align:left;">
8.4243486539678
</td>
<td style="text-align:left;">
0.0633800587736384
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt0_zvalue
</td>
<td style="text-align:left;">
7.41136089723565
</td>
<td style="text-align:left;">
3.51137048182399
</td>
<td style="text-align:left;">
3.29876072646029
</td>
<td style="text-align:left;">
8.45373003019788
</td>
<td style="text-align:left;">
3.21377335800617
</td>
<td style="text-align:left;">
5.50460248700526
</td>
<td style="text-align:left;">
12.7533216258482
</td>
<td style="text-align:left;">
3.45880859967487
</td>
<td style="text-align:left;">
9.2181655231836
</td>
<td style="text-align:left;">
16.1673191710588
</td>
<td style="text-align:left;">
5.13270005181653
</td>
<td style="text-align:left;">
5.7144814921021
</td>
<td style="text-align:left;">
21.4658243759356
</td>
<td style="text-align:left;">
5.40878275197143
</td>
<td style="text-align:left;">
8.43107624359371
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Estimate
</td>
<td style="text-align:left;">
0.859205733631884
</td>
<td style="text-align:left;">
98.9428234201429
</td>
<td style="text-align:left;">
-6.0245137913613
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Prâ€¦z..
</td>
<td style="text-align:left;">
6.88427337868624e-19
</td>
<td style="text-align:left;">
2.09631602338248e-08
</td>
<td style="text-align:left;">
2.94171378765984e-20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_Std.Error
</td>
<td style="text-align:left;">
0.0967928354474626
</td>
<td style="text-align:left;">
17.656195205247
</td>
<td style="text-align:left;">
0.653342710289674
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
prot_zvalue
</td>
<td style="text-align:left;">
8.87674929306359
</td>
<td style="text-align:left;">
5.60385871757577
</td>
<td style="text-align:left;">
-9.22106223346427
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargan_df1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Estimate
</td>
<td style="text-align:left;">
0.154043421788434
</td>
<td style="text-align:left;">
333.799680049256
</td>
<td style="text-align:left;">
5.41175429817601
</td>
<td style="text-align:left;">
0.106307556058088
</td>
<td style="text-align:left;">
330.452608866756
</td>
<td style="text-align:left;">
5.831189427888
</td>
<td style="text-align:left;">
1.80283907885784
</td>
<td style="text-align:left;">
997.747599807137
</td>
<td style="text-align:left;">
-0.452827875182574
</td>
<td style="text-align:left;">
1.02741625216021
</td>
<td style="text-align:left;">
411.365911332902
</td>
<td style="text-align:left;">
-0.789122421167278
</td>
<td style="text-align:left;">
1.02009164592613
</td>
<td style="text-align:left;">
409.820707458849
</td>
<td style="text-align:left;">
-0.746032636368026
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Prâ€¦z..
</td>
<td style="text-align:left;">
0.388078129326844
</td>
<td style="text-align:left;">
5.06413216619956e-24
</td>
<td style="text-align:left;">
5.80077629935398e-06
</td>
<td style="text-align:left;">
0.423490075743443
</td>
<td style="text-align:left;">
2.52735690942035e-27
</td>
<td style="text-align:left;">
6.12283824653399e-12
</td>
<td style="text-align:left;">
1.16893284800756e-65
</td>
<td style="text-align:left;">
2.02347084790526e-89
</td>
<td style="text-align:left;">
0.000647195788039458
</td>
<td style="text-align:left;">
1.69796551008425e-27
</td>
<td style="text-align:left;">
2.05327249428077e-54
</td>
<td style="text-align:left;">
0.00428270841485319
</td>
<td style="text-align:left;">
1.70848440094532e-51
</td>
<td style="text-align:left;">
2.36314216739175e-62
</td>
<td style="text-align:left;">
6.57521045475854e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_Std.Error
</td>
<td style="text-align:left;">
0.178475271469509
</td>
<td style="text-align:left;">
33.0216035385256
</td>
<td style="text-align:left;">
1.19371921154444
</td>
<td style="text-align:left;">
0.132821186086593
</td>
<td style="text-align:left;">
30.5174257712039
</td>
<td style="text-align:left;">
0.847955715223007
</td>
<td style="text-align:left;">
0.105343525210948
</td>
<td style="text-align:left;">
49.7632792630674
</td>
<td style="text-align:left;">
0.132754263303729
</td>
<td style="text-align:left;">
0.0945646985181949
</td>
<td style="text-align:left;">
26.482231353221
</td>
<td style="text-align:left;">
0.276250047248342
</td>
<td style="text-align:left;">
0.0675715533063684
</td>
<td style="text-align:left;">
24.5920104216274
</td>
<td style="text-align:left;">
0.186921458372094
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale_zvalue
</td>
<td style="text-align:left;">
0.863107928174524
</td>
<td style="text-align:left;">
10.1085242471589
</td>
<td style="text-align:left;">
4.5335236677428
</td>
<td style="text-align:left;">
0.800381017443866
</td>
<td style="text-align:left;">
10.8283251459096
</td>
<td style="text-align:left;">
6.87676174970345
</td>
<td style="text-align:left;">
17.1139049623383
</td>
<td style="text-align:left;">
20.049876426605
</td>
<td style="text-align:left;">
-3.41102322376305
</td>
<td style="text-align:left;">
10.8646912458832
</td>
<td style="text-align:left;">
15.5336574870179
</td>
<td style="text-align:left;">
-2.85655126226232
</td>
<td style="text-align:left;">
15.0964658352761
</td>
<td style="text-align:left;">
16.6647907361991
</td>
<td style="text-align:left;">
-3.99115565898775
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Estimate
</td>
<td style="text-align:left;">
0.209901650858444
</td>
<td style="text-align:left;">
121.789859431719
</td>
<td style="text-align:left;">
4.84745570027421
</td>
<td style="text-align:left;">
0.32289383712906
</td>
<td style="text-align:left;">
135.494858749213
</td>
<td style="text-align:left;">
4.07024693316579
</td>
<td style="text-align:left;">
0.433164820953122
</td>
<td style="text-align:left;">
190.077351395411
</td>
<td style="text-align:left;">
0.013743826466697
</td>
<td style="text-align:left;">
1.00582859923507
</td>
<td style="text-align:left;">
218.549980922773
</td>
<td style="text-align:left;">
-0.369567838754919
</td>
<td style="text-align:left;">
0.929266902426876
</td>
<td style="text-align:left;">
207.078222946319
</td>
<td style="text-align:left;">
-0.0985678389223871
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Prâ€¦z..
</td>
<td style="text-align:left;">
0.00846239710330183
</td>
<td style="text-align:left;">
5.96047652726604e-17
</td>
<td style="text-align:left;">
2.07373887990734e-19
</td>
<td style="text-align:left;">
9.66146445970411e-11
</td>
<td style="text-align:left;">
4.48931446156578e-34
</td>
<td style="text-align:left;">
5.64723572075311e-36
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.57416908709045e-66
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2.42696379710431e-102
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.8456989795407e-27
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_Std.Error
</td>
<td style="text-align:left;">
0.0797183179466224
</td>
<td style="text-align:left;">
14.5577085129173
</td>
<td style="text-align:left;">
0.538050140686242
</td>
<td style="text-align:left;">
0.0498896912189897
</td>
<td style="text-align:left;">
11.133488331491
</td>
<td style="text-align:left;">
0.325043349284404
</td>
<td style="text-align:left;">
0.00120472816008757
</td>
<td style="text-align:left;">
0.739269879490012
</td>
<td style="text-align:left;">
0.000797655931686455
</td>
<td style="text-align:left;">
0.00746867714609322
</td>
<td style="text-align:left;">
1.93157117819081
</td>
<td style="text-align:left;">
0.0172056989832521
</td>
<td style="text-align:left;">
0.00539330635998891
</td>
<td style="text-align:left;">
1.46167854745869
</td>
<td style="text-align:left;">
0.00907867488118111
</td>
</tr>
<tr>
<td style="text-align:left;">
svymthRound_zvalue
</td>
<td style="text-align:left;">
2.63304164293819
</td>
<td style="text-align:left;">
8.3660048093182
</td>
<td style="text-align:left;">
9.00930105527276
</td>
<td style="text-align:left;">
6.47215545415433
</td>
<td style="text-align:left;">
12.1700274626388
</td>
<td style="text-align:left;">
12.5221664806451
</td>
<td style="text-align:left;">
359.553993426731
</td>
<td style="text-align:left;">
257.114967982378
</td>
<td style="text-align:left;">
17.2302692435809
</td>
<td style="text-align:left;">
134.672925279842
</td>
<td style="text-align:left;">
113.146221785871
</td>
<td style="text-align:left;">
-21.4793853545069
</td>
<td style="text-align:left;">
172.300040161039
</td>
<td style="text-align:left;">
141.671520941694
</td>
<td style="text-align:left;">
-10.857073329799
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_var.y
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
vil.id
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.c
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
<td style="text-align:left;">
sex+wgt0+hgt0+svymthRound
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.x
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
prot
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
cal
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
wealthIdx
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.prot
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
<td style="text-align:left;">
p.A.nProt
</td>
</tr>
<tr>
<td style="text-align:left;">
vars_vars.z
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
<td style="text-align:left;">
indi.id
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_df2
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
18957
</td>
<td style="text-align:left;">
18962
</td>
<td style="text-align:left;">
18999
</td>
<td style="text-align:left;">
25092
</td>
<td style="text-align:left;">
25102
</td>
<td style="text-align:left;">
30013
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
<td style="text-align:left;">
18587
</td>
<td style="text-align:left;">
18591
</td>
<td style="text-align:left;">
18845
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_p.value
</td>
<td style="text-align:left;">
1.42153759924051e-19
</td>
<td style="text-align:left;">
4.45734829676535e-19
</td>
<td style="text-align:left;">
5.72345606958224e-20
</td>
<td style="text-align:left;">
1.77770827184557e-37
</td>
<td style="text-align:left;">
4.03760292921249e-37
</td>
<td style="text-align:left;">
5.4744773509349e-38
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Weakinstruments_statistic
</td>
<td style="text-align:left;">
82.0931934821259
</td>
<td style="text-align:left;">
79.8251182827394
</td>
<td style="text-align:left;">
83.8989817367576
</td>
<td style="text-align:left;">
164.392129625297
</td>
<td style="text-align:left;">
162.747072038427
</td>
<td style="text-align:left;">
166.752606654978
</td>
<td style="text-align:left;">
7029.47383089423
</td>
<td style="text-align:left;">
7038.38467113138
</td>
<td style="text-align:left;">
12942.6315513376
</td>
<td style="text-align:left;">
1710.98122418593
</td>
<td style="text-align:left;">
1715.15052113401
</td>
<td style="text-align:left;">
1725.71954882909
</td>
<td style="text-align:left;">
5097.88462603714
</td>
<td style="text-align:left;">
5110.7741807339
</td>
<td style="text-align:left;">
5136.55662964893
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Estimate
</td>
<td style="text-align:left;">
-0.00163274724538053
</td>
<td style="text-align:left;">
0.492582112313714
</td>
<td style="text-align:left;">
0.00999798623641609
</td>
<td style="text-align:left;">
-0.000658938519303158
</td>
<td style="text-align:left;">
0.601258436431589
</td>
<td style="text-align:left;">
0.00326074237566447
</td>
<td style="text-align:left;">
0.00112485055604174
</td>
<td style="text-align:left;">
1.27282038539716
</td>
<td style="text-align:left;">
-0.00512158791392231
</td>
<td style="text-align:left;">
0.000716628918445026
</td>
<td style="text-align:left;">
0.761704518610409
</td>
<td style="text-align:left;">
-0.00601345031606022
</td>
<td style="text-align:left;">
0.00092210011725941
</td>
<td style="text-align:left;">
0.792700893714032
</td>
<td style="text-align:left;">
-0.00668277875606412
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Prâ€¦z..
</td>
<td style="text-align:left;">
4.88365163658792e-08
</td>
<td style="text-align:left;">
2.3313655523177e-20
</td>
<td style="text-align:left;">
7.95432753715951e-07
</td>
<td style="text-align:left;">
0.000328431498069385
</td>
<td style="text-align:left;">
2.09211347307227e-48
</td>
<td style="text-align:left;">
0.00667886646010296
</td>
<td style="text-align:left;">
2.26123807436414e-11
</td>
<td style="text-align:left;">
6.67525280115101e-56
</td>
<td style="text-align:left;">
6.51923754467955e-127
</td>
<td style="text-align:left;">
2.43477572087317e-06
</td>
<td style="text-align:left;">
8.22014792868139e-69
</td>
<td style="text-align:left;">
5.19751747054247e-44
</td>
<td style="text-align:left;">
1.68237436783295e-15
</td>
<td style="text-align:left;">
4.81415543482617e-82
</td>
<td style="text-align:left;">
2.5484884022112e-105
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_Std.Error
</td>
<td style="text-align:left;">
0.000299284876595226
</td>
<td style="text-align:left;">
0.0532753838702927
</td>
<td style="text-align:left;">
0.00202532507408109
</td>
<td style="text-align:left;">
0.000183457551985467
</td>
<td style="text-align:left;">
0.0411255751282266
</td>
<td style="text-align:left;">
0.0012021409416413
</td>
<td style="text-align:left;">
0.000168187467853392
</td>
<td style="text-align:left;">
0.0808047514011814
</td>
<td style="text-align:left;">
0.000213715312589844
</td>
<td style="text-align:left;">
0.000152036990659248
</td>
<td style="text-align:left;">
0.0434474820358988
</td>
<td style="text-align:left;">
0.000432182413699013
</td>
<td style="text-align:left;">
0.00011580150512101
</td>
<td style="text-align:left;">
0.0413159097814226
</td>
<td style="text-align:left;">
0.000306609919183132
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt0_zvalue
</td>
<td style="text-align:left;">
-5.45549532590907
</td>
<td style="text-align:left;">
9.24596082710511
</td>
<td style="text-align:left;">
4.93648469787117
</td>
<td style="text-align:left;">
-3.59177647456756
</td>
<td style="text-align:left;">
14.6200614716489
</td>
<td style="text-align:left;">
2.71244598924693
</td>
<td style="text-align:left;">
6.68807593335234
</td>
<td style="text-align:left;">
15.7518012657181
</td>
<td style="text-align:left;">
-23.964534182684
</td>
<td style="text-align:left;">
4.71351685755978
</td>
<td style="text-align:left;">
17.5316147891159
</td>
<td style="text-align:left;">
-13.9141485758099
</td>
<td style="text-align:left;">
7.96276452793799
</td>
<td style="text-align:left;">
19.186335189222
</td>
<td style="text-align:left;">
-21.7957030674948
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_df1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_df2
</td>
<td style="text-align:left;">
18956
</td>
<td style="text-align:left;">
18961
</td>
<td style="text-align:left;">
18998
</td>
<td style="text-align:left;">
18956
</td>
<td style="text-align:left;">
18961
</td>
<td style="text-align:left;">
18998
</td>
<td style="text-align:left;">
25091
</td>
<td style="text-align:left;">
25101
</td>
<td style="text-align:left;">
30012
</td>
<td style="text-align:left;">
18586
</td>
<td style="text-align:left;">
18590
</td>
<td style="text-align:left;">
18844
</td>
<td style="text-align:left;">
18586
</td>
<td style="text-align:left;">
18590
</td>
<td style="text-align:left;">
18844
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_p.value
</td>
<td style="text-align:left;">
1.53929570350174e-118
</td>
<td style="text-align:left;">
3.1341589140336e-08
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2.88592506947287e-108
</td>
<td style="text-align:left;">
7.64959440843259e-07
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.0221987672063031
</td>
<td style="text-align:left;">
0.00993600230368616
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1.80909125272665e-238
</td>
<td style="text-align:left;">
2.14946499922086e-35
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
3.15182965429387e-108
</td>
<td style="text-align:left;">
1.76811257415626e-17
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Wu.Hausman_statistic
</td>
<td style="text-align:left;">
543.467268879861
</td>
<td style="text-align:left;">
30.6481856102737
</td>
<td style="text-align:left;">
5652.51924793073
</td>
<td style="text-align:left;">
494.955883488803
</td>
<td style="text-align:left;">
24.4605456761215
</td>
<td style="text-align:left;">
5583.56513052695
</td>
<td style="text-align:left;">
5.23078768861662
</td>
<td style="text-align:left;">
6.64734699528169
</td>
<td style="text-align:left;">
25949.7118056005
</td>
<td style="text-align:left;">
1119.87022468742
</td>
<td style="text-align:left;">
154.793296861585
</td>
<td style="text-align:left;">
4826.92242730011
</td>
<td style="text-align:left;">
494.903094649185
</td>
<td style="text-align:left;">
72.5307870103482
</td>
<td style="text-align:left;">
7607.83405438101
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0238724384575233
</td>
<td style="text-align:left;">
2.71948246216963
</td>
<td style="text-align:left;">
-0.168054407187466
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Prâ€¦z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1.4495661654094e-33
</td>
<td style="text-align:left;">
9.21076021353428e-10
</td>
<td style="text-align:left;">
5.6761450167746e-39
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00197718112736554
</td>
<td style="text-align:left;">
0.444177077283097
</td>
<td style="text-align:left;">
0.0128692506794762
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
cal_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
12.0739764946734
</td>
<td style="text-align:left;">
6.12251870088371
</td>
<td style="text-align:left;">
-13.0586007975956
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.144503490136916
</td>
<td style="text-align:left;">
69.1816142882735
</td>
<td style="text-align:left;">
-1.91414470908346
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Prâ€¦z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
3.72983264927879e-06
</td>
<td style="text-align:left;">
2.23442991283626e-07
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0312379492766362
</td>
<td style="text-align:left;">
13.3588885513857
</td>
<td style="text-align:left;">
0.0371054140359332
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
wealthIdx_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
4.62589553677888
</td>
<td style="text-align:left;">
5.17869536991513
</td>
<td style="text-align:left;">
-51.5866689219473
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.00148073028434634
</td>
<td style="text-align:left;">
0.221916473012471
</td>
<td style="text-align:left;">
-0.00520794333267228
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Prâ€¦z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2.50759287111904e-156
</td>
<td style="text-align:left;">
8.30126393445594e-33
</td>
<td style="text-align:left;">
3.00201193980421e-197
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
5.55884799941939e-05
</td>
<td style="text-align:left;">
0.0186022369560852
</td>
<td style="text-align:left;">
0.000173813943639702
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.prot_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
26.6373587567245
</td>
<td style="text-align:left;">
11.9295584469951
</td>
<td style="text-align:left;">
-29.9627476577358
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Estimate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.0141317656200728
</td>
<td style="text-align:left;">
2.1185694049434
</td>
<td style="text-align:left;">
-0.0494468877742103
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Prâ€¦z..
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2.61782083799059e-226
</td>
<td style="text-align:left;">
4.81511329045864e-35
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_Std.Error
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0.000440019589949139
</td>
<td style="text-align:left;">
0.17153115470459
</td>
<td style="text-align:left;">
0.00128926108222172
</td>
</tr>
<tr>
<td style="text-align:left;">
p.A.nProt_zvalue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
32.1162192385715
</td>
<td style="text-align:left;">
12.3509307017258
</td>
<td style="text-align:left;">
-38.3528894620791
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="program-line-by-line" class="section level4 hasAnchor" number="5.2.2.4">
<h4><span class="header-section-number">5.2.2.4</span> Program Line by Line<a href="linear-regression.html#program-line-by-line" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Set Up Parameters</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="linear-regression.html#cb495-1" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indi.id&#39;</span>)</span>
<span id="cb495-2"><a href="linear-regression.html#cb495-2" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb495-3"><a href="linear-regression.html#cb495-3" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;wgt0&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span></code></pre></div>
<div id="lapply" class="section level5 hasAnchor" number="5.2.2.4.1">
<h5><span class="header-section-number">5.2.2.4.1</span> Lapply<a href="linear-regression.html#lapply" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="linear-regression.html#cb496-1" tabindex="-1"></a>df.reg.out <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(</span>
<span id="cb496-2"><a href="linear-regression.html#cb496-2" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb496-3"><a href="linear-regression.html#cb496-3" tabindex="-1"></a>                   <span class="at">vars.x=</span>var.x1, <span class="at">vars.c=</span>vars.c, <span class="at">vars.z=</span>vars.z, <span class="at">df=</span>df)))</span></code></pre></div>
</div>
<div id="nested-lapply-test" class="section level5 hasAnchor" number="5.2.2.4.2">
<h5><span class="header-section-number">5.2.2.4.2</span> Nested Lapply Test<a href="linear-regression.html#nested-lapply-test" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="linear-regression.html#cb497-1" tabindex="-1"></a><span class="fu">lapply</span>(list.vars.y, <span class="cf">function</span>(y) (<span class="fu">mean</span>(df[[var.x1]], <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb497-2"><a href="linear-regression.html#cb497-2" tabindex="-1"></a>                                   <span class="fu">mean</span>(df[[y]], <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 98.3272
## 
## [[2]]
## [1] 13626.51
## 
## [[3]]
## [1] 26.11226</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="linear-regression.html#cb499-1" tabindex="-1"></a>lapplytwice <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb499-2"><a href="linear-regression.html#cb499-2" tabindex="-1"></a>  list.vars.x, <span class="cf">function</span>(x) (</span>
<span id="cb499-3"><a href="linear-regression.html#cb499-3" tabindex="-1"></a>    <span class="fu">lapply</span>(list.vars.y, <span class="cf">function</span>(y) (<span class="fu">mean</span>(df[[x]], <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb499-4"><a href="linear-regression.html#cb499-4" tabindex="-1"></a>                                       <span class="fu">mean</span>(df[[y]], <span class="at">na.rm=</span><span class="cn">TRUE</span>)))))</span>
<span id="cb499-5"><a href="linear-regression.html#cb499-5" tabindex="-1"></a><span class="co"># lapplytwice</span></span></code></pre></div>
</div>
<div id="nested-lapply-all" class="section level5 hasAnchor" number="5.2.2.4.3">
<h5><span class="header-section-number">5.2.2.4.3</span> Nested Lapply All<a href="linear-regression.html#nested-lapply-all" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="linear-regression.html#cb500-1" tabindex="-1"></a>df.reg.out.all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb500-2"><a href="linear-regression.html#cb500-2" tabindex="-1"></a>  <span class="fu">lapply</span>(list.vars.x,</span>
<span id="cb500-3"><a href="linear-regression.html#cb500-3" tabindex="-1"></a>         <span class="cf">function</span>(x) (</span>
<span id="cb500-4"><a href="linear-regression.html#cb500-4" tabindex="-1"></a>           <span class="fu">bind_rows</span>(</span>
<span id="cb500-5"><a href="linear-regression.html#cb500-5" tabindex="-1"></a>             <span class="fu">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb500-6"><a href="linear-regression.html#cb500-6" tabindex="-1"></a>                    <span class="at">vars.x=</span>x, <span class="at">vars.c=</span>vars.c, <span class="at">vars.z=</span>vars.z, <span class="at">df=</span>df))</span>
<span id="cb500-7"><a href="linear-regression.html#cb500-7" tabindex="-1"></a>         )))</span></code></pre></div>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="linear-regression.html#cb501-1" tabindex="-1"></a><span class="co"># df.reg.out.all %&gt;%</span></span>
<span id="cb501-2"><a href="linear-regression.html#cb501-2" tabindex="-1"></a><span class="co">#   kable() %&gt;%</span></span>
<span id="cb501-3"><a href="linear-regression.html#cb501-3" tabindex="-1"></a><span class="co">#   kable_styling_fc_wide()</span></span></code></pre></div>
</div>
<div id="nested-lapply-select" class="section level5 hasAnchor" number="5.2.2.4.4">
<h5><span class="header-section-number">5.2.2.4.4</span> Nested Lapply Select<a href="linear-regression.html#nested-lapply-select" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="linear-regression.html#cb502-1" tabindex="-1"></a>df.reg.out.all <span class="ot">&lt;-</span></span>
<span id="cb502-2"><a href="linear-regression.html#cb502-2" tabindex="-1"></a>  (<span class="fu">lapply</span>(list.vars.x,</span>
<span id="cb502-3"><a href="linear-regression.html#cb502-3" tabindex="-1"></a>          <span class="cf">function</span>(x) (</span>
<span id="cb502-4"><a href="linear-regression.html#cb502-4" tabindex="-1"></a>            <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(list.vars.y, regf.iv,</span>
<span id="cb502-5"><a href="linear-regression.html#cb502-5" tabindex="-1"></a>                             <span class="at">vars.x=</span>x, <span class="at">vars.c=</span>vars.c, <span class="at">vars.z=</span>vars.z, <span class="at">df=</span>df)) <span class="sc">%&gt;%</span></span>
<span id="cb502-6"><a href="linear-regression.html#cb502-6" tabindex="-1"></a>              <span class="fu">select</span>(vars_var.y, <span class="fu">starts_with</span>(x)) <span class="sc">%&gt;%</span></span>
<span id="cb502-7"><a href="linear-regression.html#cb502-7" tabindex="-1"></a>              <span class="fu">select</span>(vars_var.y, <span class="fu">ends_with</span>(<span class="st">&#39;value&#39;</span>))</span>
<span id="cb502-8"><a href="linear-regression.html#cb502-8" tabindex="-1"></a>          ))) <span class="sc">%&gt;%</span> <span class="fu">reduce</span>(full_join)</span></code></pre></div>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="linear-regression.html#cb503-1" tabindex="-1"></a>df.reg.out.all <span class="sc">%&gt;%</span></span>
<span id="cb503-2"><a href="linear-regression.html#cb503-2" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb503-3"><a href="linear-regression.html#cb503-3" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
vars_var.y
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
cal_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
wealthIdx_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.prot_tvalue
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
p.A.nProt_tvalue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:left;">
18.8756010031766
</td>
<td style="text-align:left;">
23.4421863484656
</td>
<td style="text-align:left;">
13.5088996182178
</td>
<td style="text-align:left;">
3.83682180045522
</td>
<td style="text-align:left;">
32.5448257554849
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:left;">
16.359112505607
</td>
<td style="text-align:left;">
17.368603130933
</td>
<td style="text-align:left;">
14.1390521528125
</td>
<td style="text-align:left;">
1.36958319982295
</td>
<td style="text-align:left;">
12.0961557911473
</td>
</tr>
<tr>
<td style="text-align:left;">
vil.id
</td>
<td style="text-align:left;">
-14.9385580468905
</td>
<td style="text-align:left;">
-19.6150110809449
</td>
<td style="text-align:left;">
34.0972558327354
</td>
<td style="text-align:left;">
8.45943342783161
</td>
<td style="text-align:left;">
17.7801422421398
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</div>
</div>
<div id="decomposition" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Decomposition<a href="linear-regression.html#decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="decompose-rhs" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Decompose RHS<a href="linear-regression.html#decompose-rhs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>â€™s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>One runs a number of regressions. With different outcomes, and various right hand side variables.</p>
<p>What is the remaining variation in the left hand side variable if right hand side variable one by one is set to the average of the observed values.</p>
<ul>
<li>Dependency: <em>R4Econ/linreg/ivreg/ivregdfrow.R</em></li>
</ul>
<p>The code below does not work with categorical variables (except for dummies). Dummy variable inputs need to be converted to zero/one first. The examples are just to test the code with different types of variables.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="linear-regression.html#cb504-1" tabindex="-1"></a><span class="co"># Library</span></span>
<span id="cb504-2"><a href="linear-regression.html#cb504-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb504-3"><a href="linear-regression.html#cb504-3" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb504-4"><a href="linear-regression.html#cb504-4" tabindex="-1"></a></span>
<span id="cb504-5"><a href="linear-regression.html#cb504-5" tabindex="-1"></a><span class="co"># Load Sample Data</span></span>
<span id="cb504-6"><a href="linear-regression.html#cb504-6" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&#39;C:/Users/fan/R4Econ/_data/&#39;</span>)</span>
<span id="cb504-7"><a href="linear-regression.html#cb504-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;height_weight.csv&#39;</span>)</span>
<span id="cb504-8"><a href="linear-regression.html#cb504-8" tabindex="-1"></a></span>
<span id="cb504-9"><a href="linear-regression.html#cb504-9" tabindex="-1"></a><span class="co"># Source Dependency</span></span>
<span id="cb504-10"><a href="linear-regression.html#cb504-10" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;C:/Users/fan/R4Econ/linreg/ivreg/ivregdfrow.R&#39;</span>)</span></code></pre></div>
<p>Data Cleaning.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="linear-regression.html#cb505-1" tabindex="-1"></a><span class="co"># Convert Variable for Sex which is categorical to Numeric</span></span>
<span id="cb505-2"><a href="linear-regression.html#cb505-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> df</span>
<span id="cb505-3"><a href="linear-regression.html#cb505-3" tabindex="-1"></a>df<span class="sc">$</span>male <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(<span class="fu">factor</span>(df<span class="sc">$</span>sex)) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb505-4"><a href="linear-regression.html#cb505-4" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">factor</span>(df<span class="sc">$</span>sex))</span></code></pre></div>
<pre><code>## Female   Male 
##  16446  18619</code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="linear-regression.html#cb507-1" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>male)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   1.000   0.531   1.000   1.000</code></pre>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="linear-regression.html#cb509-1" tabindex="-1"></a>df.use <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(S.country <span class="sc">==</span> <span class="st">&#39;Guatemala&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb509-2"><a href="linear-regression.html#cb509-2" tabindex="-1"></a>  <span class="fu">filter</span>(svymthRound <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">24</span>))</span>
<span id="cb509-3"><a href="linear-regression.html#cb509-3" tabindex="-1"></a><span class="fu">dim</span>(df.use)</span></code></pre></div>
<pre><code>## [1] 2022   16</code></pre>
<p>Setting Up Parameters.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="linear-regression.html#cb511-1" tabindex="-1"></a><span class="co"># Define Left Hand Side Variab les</span></span>
<span id="cb511-2"><a href="linear-regression.html#cb511-2" tabindex="-1"></a>var.y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;hgt&#39;</span>)</span>
<span id="cb511-3"><a href="linear-regression.html#cb511-3" tabindex="-1"></a>var.y2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;wgt&#39;</span>)</span>
<span id="cb511-4"><a href="linear-regression.html#cb511-4" tabindex="-1"></a>vars.y <span class="ot">&lt;-</span> <span class="fu">c</span>(var.y1, var.y2)</span>
<span id="cb511-5"><a href="linear-regression.html#cb511-5" tabindex="-1"></a><span class="co"># Define Right Hand Side Variables</span></span>
<span id="cb511-6"><a href="linear-regression.html#cb511-6" tabindex="-1"></a>vars.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prot&#39;</span>)</span>
<span id="cb511-7"><a href="linear-regression.html#cb511-7" tabindex="-1"></a>vars.c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;male&#39;</span>, <span class="st">&#39;wgt0&#39;</span>, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span>
<span id="cb511-8"><a href="linear-regression.html#cb511-8" tabindex="-1"></a><span class="co"># vars.z &lt;- c(&#39;p.A.prot&#39;)</span></span>
<span id="cb511-9"><a href="linear-regression.html#cb511-9" tabindex="-1"></a>vars.z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;vil.id&#39;</span>)</span>
<span id="cb511-10"><a href="linear-regression.html#cb511-10" tabindex="-1"></a><span class="co"># vars.z &lt;- NULL</span></span>
<span id="cb511-11"><a href="linear-regression.html#cb511-11" tabindex="-1"></a>vars.xc <span class="ot">&lt;-</span> <span class="fu">c</span>(vars.x, vars.c)</span>
<span id="cb511-12"><a href="linear-regression.html#cb511-12" tabindex="-1"></a></span>
<span id="cb511-13"><a href="linear-regression.html#cb511-13" tabindex="-1"></a><span class="co"># Other variables to keep</span></span>
<span id="cb511-14"><a href="linear-regression.html#cb511-14" tabindex="-1"></a>vars.other.keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;S.country&#39;</span>, <span class="st">&#39;vil.id&#39;</span>, <span class="st">&#39;indi.id&#39;</span>, <span class="st">&#39;svymthRound&#39;</span>)</span>
<span id="cb511-15"><a href="linear-regression.html#cb511-15" tabindex="-1"></a></span>
<span id="cb511-16"><a href="linear-regression.html#cb511-16" tabindex="-1"></a><span class="co"># Decompose sequence</span></span>
<span id="cb511-17"><a href="linear-regression.html#cb511-17" tabindex="-1"></a>vars.tomean.first <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;male&#39;</span>, <span class="st">&#39;hgt0&#39;</span>)</span>
<span id="cb511-18"><a href="linear-regression.html#cb511-18" tabindex="-1"></a>var.tomean.first.name.suffix <span class="ot">&lt;-</span> <span class="st">&#39;_mh02m&#39;</span></span>
<span id="cb511-19"><a href="linear-regression.html#cb511-19" tabindex="-1"></a>vars.tomean.second <span class="ot">&lt;-</span> <span class="fu">c</span>(vars.tomean.first, <span class="st">&#39;hgt0&#39;</span>, <span class="st">&#39;wgt0&#39;</span>)</span>
<span id="cb511-20"><a href="linear-regression.html#cb511-20" tabindex="-1"></a>var.tomean.second.name.suffix <span class="ot">&lt;-</span> <span class="st">&#39;_mh0me2m&#39;</span></span>
<span id="cb511-21"><a href="linear-regression.html#cb511-21" tabindex="-1"></a>vars.tomean.third <span class="ot">&lt;-</span> <span class="fu">c</span>(vars.tomean.second, <span class="st">&#39;prot&#39;</span>)</span>
<span id="cb511-22"><a href="linear-regression.html#cb511-22" tabindex="-1"></a>var.tomean.third.name.suffix <span class="ot">&lt;-</span> <span class="st">&#39;_mh0mep2m&#39;</span></span>
<span id="cb511-23"><a href="linear-regression.html#cb511-23" tabindex="-1"></a>vars.tomean.fourth <span class="ot">&lt;-</span> <span class="fu">c</span>(vars.tomean.third, <span class="st">&#39;svymthRound&#39;</span>)</span>
<span id="cb511-24"><a href="linear-regression.html#cb511-24" tabindex="-1"></a>var.tomean.fourth.name.suffix <span class="ot">&lt;-</span> <span class="st">&#39;_mh0mepm2m&#39;</span></span>
<span id="cb511-25"><a href="linear-regression.html#cb511-25" tabindex="-1"></a>list.vars.tomean <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb511-26"><a href="linear-regression.html#cb511-26" tabindex="-1"></a><span class="co">#                         vars.tomean.first,</span></span>
<span id="cb511-27"><a href="linear-regression.html#cb511-27" tabindex="-1"></a>                        vars.tomean.second,</span>
<span id="cb511-28"><a href="linear-regression.html#cb511-28" tabindex="-1"></a>                        vars.tomean.third,</span>
<span id="cb511-29"><a href="linear-regression.html#cb511-29" tabindex="-1"></a>                        vars.tomean.fourth</span>
<span id="cb511-30"><a href="linear-regression.html#cb511-30" tabindex="-1"></a>                        )</span>
<span id="cb511-31"><a href="linear-regression.html#cb511-31" tabindex="-1"></a>list.vars.tomean.name.suffix <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb511-32"><a href="linear-regression.html#cb511-32" tabindex="-1"></a><span class="co">#                                     var.tomean.first.name.suffix,</span></span>
<span id="cb511-33"><a href="linear-regression.html#cb511-33" tabindex="-1"></a>                                     var.tomean.second.name.suffix,</span>
<span id="cb511-34"><a href="linear-regression.html#cb511-34" tabindex="-1"></a>                                     var.tomean.third.name.suffix,</span>
<span id="cb511-35"><a href="linear-regression.html#cb511-35" tabindex="-1"></a>                                     var.tomean.fourth.name.suffix</span>
<span id="cb511-36"><a href="linear-regression.html#cb511-36" tabindex="-1"></a>                                    )</span></code></pre></div>
<div id="obtain-regression-coefficients-from-somewhere" class="section level4 hasAnchor" number="5.3.1.1">
<h4><span class="header-section-number">5.3.1.1</span> Obtain Regression Coefficients from somewhere<a href="linear-regression.html#obtain-regression-coefficients-from-somewhere" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="linear-regression.html#cb512-1" tabindex="-1"></a><span class="co"># Regressions</span></span>
<span id="cb512-2"><a href="linear-regression.html#cb512-2" tabindex="-1"></a><span class="co"># regf.iv from C:\Users\fan\R4Econ\linreg\ivreg\ivregdfrow.R</span></span>
<span id="cb512-3"><a href="linear-regression.html#cb512-3" tabindex="-1"></a>df.reg.out <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(</span>
<span id="cb512-4"><a href="linear-regression.html#cb512-4" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(vars.y, regf.iv,</span>
<span id="cb512-5"><a href="linear-regression.html#cb512-5" tabindex="-1"></a>                   <span class="at">vars.x=</span>vars.x, <span class="at">vars.c=</span>vars.c, <span class="at">vars.z=</span>vars.z, <span class="at">df=</span>df)))</span>
<span id="cb512-6"><a href="linear-regression.html#cb512-6" tabindex="-1"></a><span class="co"># Regressions</span></span>
<span id="cb512-7"><a href="linear-regression.html#cb512-7" tabindex="-1"></a><span class="co"># reg1 &lt;- regf.iv(var.y = var.y1, vars.x, vars.c, vars.z, df.use)</span></span>
<span id="cb512-8"><a href="linear-regression.html#cb512-8" tabindex="-1"></a><span class="co"># reg2 &lt;- regf.iv(var.y = var.y2, vars.x, vars.c, vars.z, df.use)</span></span>
<span id="cb512-9"><a href="linear-regression.html#cb512-9" tabindex="-1"></a><span class="co"># df.reg.out &lt;- as_tibble(bind_rows(reg1, reg2))</span></span></code></pre></div>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="linear-regression.html#cb513-1" tabindex="-1"></a><span class="co"># df.reg.out</span></span></code></pre></div>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="linear-regression.html#cb514-1" tabindex="-1"></a><span class="co"># Select Variables</span></span>
<span id="cb514-2"><a href="linear-regression.html#cb514-2" tabindex="-1"></a>str.esti.suffix <span class="ot">&lt;-</span> <span class="st">&#39;_Estimate&#39;</span></span>
<span id="cb514-3"><a href="linear-regression.html#cb514-3" tabindex="-1"></a>arr.esti.name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(vars.xc, str.esti.suffix)</span>
<span id="cb514-4"><a href="linear-regression.html#cb514-4" tabindex="-1"></a>str.outcome.name <span class="ot">&lt;-</span> <span class="st">&#39;vars_var.y&#39;</span></span>
<span id="cb514-5"><a href="linear-regression.html#cb514-5" tabindex="-1"></a>arr.columns2select <span class="ot">&lt;-</span> <span class="fu">c</span>(arr.esti.name, str.outcome.name)</span>
<span id="cb514-6"><a href="linear-regression.html#cb514-6" tabindex="-1"></a>arr.columns2select</span></code></pre></div>
<pre><code>## [1] &quot;prot_Estimate&quot;        &quot;male_Estimate&quot;        &quot;wgt0_Estimate&quot;       
## [4] &quot;hgt0_Estimate&quot;        &quot;svymthRound_Estimate&quot; &quot;vars_var.y&quot;</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="linear-regression.html#cb516-1" tabindex="-1"></a><span class="co"># Generate dataframe for coefficients</span></span>
<span id="cb516-2"><a href="linear-regression.html#cb516-2" tabindex="-1"></a>df.coef <span class="ot">&lt;-</span> df.reg.out[,<span class="fu">c</span>(arr.columns2select)] <span class="sc">%&gt;%</span></span>
<span id="cb516-3"><a href="linear-regression.html#cb516-3" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(arr.esti.name), as.numeric) <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(str.outcome.name)</span>
<span id="cb516-4"><a href="linear-regression.html#cb516-4" tabindex="-1"></a>df.coef <span class="sc">%&gt;%</span></span>
<span id="cb516-5"><a href="linear-regression.html#cb516-5" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb516-6"><a href="linear-regression.html#cb516-6" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0_Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound_Estimate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
-0.2714772
</td>
<td style="text-align:right;">
1.244735
</td>
<td style="text-align:right;">
0.0004430
</td>
<td style="text-align:right;">
0.6834853
</td>
<td style="text-align:right;">
1.133919
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:right;">
-59.0727542
</td>
<td style="text-align:right;">
489.852902
</td>
<td style="text-align:right;">
0.7696158
</td>
<td style="text-align:right;">
75.4867897
</td>
<td style="text-align:right;">
250.778883
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="linear-regression.html#cb517-1" tabindex="-1"></a><span class="fu">str</span>(df.coef)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2 obs. of  5 variables:
##  $ prot_Estimate       : num  -0.271 -59.073
##  $ male_Estimate       : num  1.24 489.85
##  $ wgt0_Estimate       : num  0.000443 0.769616
##  $ hgt0_Estimate       : num  0.683 75.487
##  $ svymthRound_Estimate: num  1.13 250.78</code></pre>
</div>
<div id="decomposition-step-1" class="section level4 hasAnchor" number="5.3.1.2">
<h4><span class="header-section-number">5.3.1.2</span> Decomposition Step 1<a href="linear-regression.html#decomposition-step-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="linear-regression.html#cb519-1" tabindex="-1"></a><span class="co"># Decomposition Step 1: gather</span></span>
<span id="cb519-2"><a href="linear-regression.html#cb519-2" tabindex="-1"></a>df.decompose_step1 <span class="ot">&lt;-</span> df.use <span class="sc">%&gt;%</span></span>
<span id="cb519-3"><a href="linear-regression.html#cb519-3" tabindex="-1"></a>                        <span class="fu">filter</span>(svymthRound <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">24</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb519-4"><a href="linear-regression.html#cb519-4" tabindex="-1"></a>                        <span class="fu">select</span>(<span class="fu">one_of</span>(<span class="fu">c</span>(vars.other.keep, vars.xc, vars.y))) <span class="sc">%&gt;%</span></span>
<span id="cb519-5"><a href="linear-regression.html#cb519-5" tabindex="-1"></a>                        <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb519-6"><a href="linear-regression.html#cb519-6" tabindex="-1"></a>                        <span class="fu">gather</span>(variable, value, <span class="sc">-</span><span class="fu">one_of</span>(<span class="fu">c</span>(vars.other.keep, vars.xc)))</span>
<span id="cb519-7"><a href="linear-regression.html#cb519-7" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.matrix.max.rows=</span><span class="dv">20</span>, <span class="at">repr.matrix.max.cols=</span><span class="dv">20</span>)</span>
<span id="cb519-8"><a href="linear-regression.html#cb519-8" tabindex="-1"></a><span class="fu">dim</span>(df.decompose_step1)</span></code></pre></div>
<pre><code>## [1] 1382   10</code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="linear-regression.html#cb521-1" tabindex="-1"></a><span class="fu">head</span>(df.decompose_step1, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb521-2"><a href="linear-regression.html#cb521-2" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb521-3"><a href="linear-regression.html#cb521-3" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
46.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
9.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
30.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
</tr>
</tbody>
</table>
</div>
<div id="decomposition-step-2" class="section level4 hasAnchor" number="5.3.1.3">
<h4><span class="header-section-number">5.3.1.3</span> Decomposition Step 2<a href="linear-regression.html#decomposition-step-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="linear-regression.html#cb522-1" tabindex="-1"></a><span class="co"># Decomposition Step 2: mutate_at(vars, funs(mean = mean(.)))</span></span>
<span id="cb522-2"><a href="linear-regression.html#cb522-2" tabindex="-1"></a><span class="co"># the xc averaging could have taken place earlier, no difference in mean across variables</span></span>
<span id="cb522-3"><a href="linear-regression.html#cb522-3" tabindex="-1"></a>df.decompose_step2 <span class="ot">&lt;-</span> df.decompose_step1 <span class="sc">%&gt;%</span></span>
<span id="cb522-4"><a href="linear-regression.html#cb522-4" tabindex="-1"></a>                        <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb522-5"><a href="linear-regression.html#cb522-5" tabindex="-1"></a>                        <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(vars.xc, <span class="st">&#39;value&#39;</span>)), <span class="fu">funs</span>(<span class="at">mean =</span> <span class="fu">mean</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb522-6"><a href="linear-regression.html#cb522-6" tabindex="-1"></a>                        <span class="fu">ungroup</span>()</span>
<span id="cb522-7"><a href="linear-regression.html#cb522-7" tabindex="-1"></a></span>
<span id="cb522-8"><a href="linear-regression.html#cb522-8" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.matrix.max.rows=</span><span class="dv">20</span>, <span class="at">repr.matrix.max.cols=</span><span class="dv">20</span>)</span>
<span id="cb522-9"><a href="linear-regression.html#cb522-9" tabindex="-1"></a><span class="fu">dim</span>(df.decompose_step2)</span></code></pre></div>
<pre><code>## [1] 1382   16</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="linear-regression.html#cb524-1" tabindex="-1"></a><span class="fu">head</span>(df.decompose_step2,<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb524-2"><a href="linear-regression.html#cb524-2" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb524-3"><a href="linear-regression.html#cb524-3" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
46.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
9.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
30.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="decomposition-step-3-non-loop" class="section level4 hasAnchor" number="5.3.1.4">
<h4><span class="header-section-number">5.3.1.4</span> Decomposition Step 3 Non-Loop<a href="linear-regression.html#decomposition-step-3-non-loop" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="linear-regression.html#cb525-1" tabindex="-1"></a>ff_lr_decompose_valadj <span class="ot">&lt;-</span> <span class="cf">function</span>(df, df.coef, vars.tomean, str.esti.suffix) {</span>
<span id="cb525-2"><a href="linear-regression.html#cb525-2" tabindex="-1"></a>  new_value <span class="ot">&lt;-</span> (df<span class="sc">$</span>value <span class="sc">+</span></span>
<span id="cb525-3"><a href="linear-regression.html#cb525-3" tabindex="-1"></a>                  <span class="fu">rowSums</span>((df[<span class="fu">paste0</span>(vars.tomean, <span class="st">&#39;_mean&#39;</span>)] <span class="sc">-</span> df[vars.tomean])</span>
<span id="cb525-4"><a href="linear-regression.html#cb525-4" tabindex="-1"></a>                          <span class="sc">*</span>df.coef[df<span class="sc">$</span>variable, <span class="fu">paste0</span>(vars.tomean, str.esti.suffix)]))</span>
<span id="cb525-5"><a href="linear-regression.html#cb525-5" tabindex="-1"></a>  <span class="fu">return</span>(new_value)</span>
<span id="cb525-6"><a href="linear-regression.html#cb525-6" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="decomposition-step-3-with-loop" class="section level4 hasAnchor" number="5.3.1.5">
<h4><span class="header-section-number">5.3.1.5</span> Decomposition Step 3 With Loop<a href="linear-regression.html#decomposition-step-3-with-loop" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="linear-regression.html#cb526-1" tabindex="-1"></a>df.decompose_step3 <span class="ot">&lt;-</span> df.decompose_step2</span>
<span id="cb526-2"><a href="linear-regression.html#cb526-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(list.vars.tomean)) {</span>
<span id="cb526-3"><a href="linear-regression.html#cb526-3" tabindex="-1"></a>    var.decomp.cur <span class="ot">&lt;-</span> (<span class="fu">paste0</span>(<span class="st">&#39;value&#39;</span>, list.vars.tomean.name.suffix[[i]]))</span>
<span id="cb526-4"><a href="linear-regression.html#cb526-4" tabindex="-1"></a>    vars.tomean <span class="ot">&lt;-</span> list.vars.tomean[[i]]</span>
<span id="cb526-5"><a href="linear-regression.html#cb526-5" tabindex="-1"></a>    var.decomp.cur</span>
<span id="cb526-6"><a href="linear-regression.html#cb526-6" tabindex="-1"></a>    df.decompose_step3 <span class="ot">&lt;-</span> df.decompose_step3 <span class="sc">%&gt;%</span></span>
<span id="cb526-7"><a href="linear-regression.html#cb526-7" tabindex="-1"></a>      <span class="fu">mutate</span>((<span class="sc">!!</span>var.decomp.cur) <span class="sc">:=</span></span>
<span id="cb526-8"><a href="linear-regression.html#cb526-8" tabindex="-1"></a>               <span class="fu">ff_lr_decompose_valadj</span>(., df.coef, vars.tomean, str.esti.suffix))</span>
<span id="cb526-9"><a href="linear-regression.html#cb526-9" tabindex="-1"></a></span>
<span id="cb526-10"><a href="linear-regression.html#cb526-10" tabindex="-1"></a>}</span>
<span id="cb526-11"><a href="linear-regression.html#cb526-11" tabindex="-1"></a></span>
<span id="cb526-12"><a href="linear-regression.html#cb526-12" tabindex="-1"></a><span class="fu">dim</span>(df.decompose_step3)</span></code></pre></div>
<pre><code>## [1] 1382   19</code></pre>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="linear-regression.html#cb528-1" tabindex="-1"></a><span class="fu">head</span>(df.decompose_step3, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb528-2"><a href="linear-regression.html#cb528-2" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb528-3"><a href="linear-regression.html#cb528-3" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
S.country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vil.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
indi.id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prot_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
male_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
wgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hgt0_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
svymthRound_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.19390
</td>
<td style="text-align:right;">
71.19903
</td>
<td style="text-align:right;">
71.68148
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
46.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2545.2
</td>
<td style="text-align:right;">
47.4
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
78.79390
</td>
<td style="text-align:right;">
85.75778
</td>
<td style="text-align:right;">
79.43671
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
63.61689
</td>
<td style="text-align:right;">
58.28285
</td>
<td style="text-align:right;">
65.56882
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
9.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
66.51689
</td>
<td style="text-align:right;">
63.57185
</td>
<td style="text-align:right;">
64.05430
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1354
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3634.3
</td>
<td style="text-align:right;">
51.2
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
72.61689
</td>
<td style="text-align:right;">
71.19213
</td>
<td style="text-align:right;">
64.87106
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
64.33707
</td>
<td style="text-align:right;">
61.06626
</td>
<td style="text-align:right;">
68.35222
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
70.33707
</td>
<td style="text-align:right;">
69.56385
</td>
<td style="text-align:right;">
70.04630
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1356
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
30.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3911.8
</td>
<td style="text-align:right;">
51.9
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.33707
</td>
<td style="text-align:right;">
76.01161
</td>
<td style="text-align:right;">
69.69055
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
66.83353
</td>
<td style="text-align:right;">
61.49949
</td>
<td style="text-align:right;">
68.78545
</td>
</tr>
<tr>
<td style="text-align:left;">
Guatemala
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1357
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3791.4
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
<td style="text-align:right;">
20.64819
</td>
<td style="text-align:right;">
0.5499276
</td>
<td style="text-align:right;">
3312.297
</td>
<td style="text-align:right;">
49.75137
</td>
<td style="text-align:right;">
18.42547
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.13353
</td>
<td style="text-align:right;">
70.97578
</td>
<td style="text-align:right;">
71.45823
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="decomposition-step-4-variance" class="section level4 hasAnchor" number="5.3.1.6">
<h4><span class="header-section-number">5.3.1.6</span> Decomposition Step 4 Variance<a href="linear-regression.html#decomposition-step-4-variance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="linear-regression.html#cb529-1" tabindex="-1"></a>df.decompose_step3 <span class="sc">%&gt;%</span></span>
<span id="cb529-2"><a href="linear-regression.html#cb529-2" tabindex="-1"></a>        <span class="fu">select</span>(variable, <span class="fu">contains</span>(<span class="st">&#39;value&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb529-3"><a href="linear-regression.html#cb529-3" tabindex="-1"></a>        <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb529-4"><a href="linear-regression.html#cb529-4" tabindex="-1"></a>        <span class="fu">summarize_all</span>(<span class="fu">funs</span>(<span class="at">mean =</span> mean, <span class="at">var =</span> var)) <span class="sc">%&gt;%</span></span>
<span id="cb529-5"><a href="linear-regression.html#cb529-5" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">&#39;value&#39;</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;_var&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb529-6"><a href="linear-regression.html#cb529-6" tabindex="-1"></a>        <span class="fu">mutate_if</span>(is.numeric, <span class="fu">funs</span>( <span class="at">frac =</span> (.<span class="sc">/</span>value_var))) <span class="sc">%&gt;%</span></span>
<span id="cb529-7"><a href="linear-regression.html#cb529-7" tabindex="-1"></a>        <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb529-8"><a href="linear-regression.html#cb529-8" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb529-9"><a href="linear-regression.html#cb529-9" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m_var_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m_var_frac
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
21.864
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
25.35
</td>
<td style="text-align:right;">
49.047
</td>
<td style="text-align:right;">
23.06
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1.159
</td>
<td style="text-align:right;">
2.243
</td>
<td style="text-align:right;">
1.055
</td>
</tr>
<tr>
<td style="text-align:right;">
2965693.245
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2949187.64
</td>
<td style="text-align:right;">
4192769.518
</td>
<td style="text-align:right;">
3147506.60
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.994
</td>
<td style="text-align:right;">
1.414
</td>
<td style="text-align:right;">
1.061
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="graphical-results" class="section level4 hasAnchor" number="5.3.1.7">
<h4><span class="header-section-number">5.3.1.7</span> Graphical Results<a href="linear-regression.html#graphical-results" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Graphically, difficult to pick up exact differences in variance, a 50 percent reduction in variance visually does not look like 50 percent. Intuitively, we are kind of seeing standard deviation, not variance on the graph if we think abou the x-scale.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="linear-regression.html#cb530-1" tabindex="-1"></a><span class="fu">head</span>(df.decompose_step3 <span class="sc">%&gt;%</span></span>
<span id="cb530-2"><a href="linear-regression.html#cb530-2" tabindex="-1"></a>    <span class="fu">select</span>(variable, <span class="fu">contains</span>(<span class="st">&#39;value&#39;</span>), <span class="sc">-</span>value_mean), <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb530-3"><a href="linear-regression.html#cb530-3" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb530-4"><a href="linear-regression.html#cb530-4" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0me2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mep2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mh0mepm2m
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
70.2
</td>
<td style="text-align:right;">
73.19390
</td>
<td style="text-align:right;">
71.19903
</td>
<td style="text-align:right;">
71.68148
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.8
</td>
<td style="text-align:right;">
78.79390
</td>
<td style="text-align:right;">
85.75778
</td>
<td style="text-align:right;">
79.43671
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
66.3
</td>
<td style="text-align:right;">
63.61689
</td>
<td style="text-align:right;">
58.28285
</td>
<td style="text-align:right;">
65.56882
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
69.2
</td>
<td style="text-align:right;">
66.51689
</td>
<td style="text-align:right;">
63.57185
</td>
<td style="text-align:right;">
64.05430
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
72.61689
</td>
<td style="text-align:right;">
71.19213
</td>
<td style="text-align:right;">
64.87106
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
68.1
</td>
<td style="text-align:right;">
64.33707
</td>
<td style="text-align:right;">
61.06626
</td>
<td style="text-align:right;">
68.35222
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
74.1
</td>
<td style="text-align:right;">
70.33707
</td>
<td style="text-align:right;">
69.56385
</td>
<td style="text-align:right;">
70.04630
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.1
</td>
<td style="text-align:right;">
73.33707
</td>
<td style="text-align:right;">
76.01161
</td>
<td style="text-align:right;">
69.69055
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
71.5
</td>
<td style="text-align:right;">
66.83353
</td>
<td style="text-align:right;">
61.49949
</td>
<td style="text-align:right;">
68.78545
</td>
</tr>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
77.8
</td>
<td style="text-align:right;">
73.13353
</td>
<td style="text-align:right;">
70.97578
</td>
<td style="text-align:right;">
71.45823
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="linear-regression.html#cb531-1" tabindex="-1"></a>df.decompose_step3 <span class="sc">%&gt;%</span></span>
<span id="cb531-2"><a href="linear-regression.html#cb531-2" tabindex="-1"></a>    <span class="fu">select</span>(variable, <span class="fu">contains</span>(<span class="st">&#39;value&#39;</span>), <span class="sc">-</span>value_mean) <span class="sc">%&gt;%</span></span>
<span id="cb531-3"><a href="linear-regression.html#cb531-3" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">outcome =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb531-4"><a href="linear-regression.html#cb531-4" tabindex="-1"></a>    <span class="fu">gather</span>(variable, value, <span class="sc">-</span>outcome) <span class="sc">%&gt;%</span></span>
<span id="cb531-5"><a href="linear-regression.html#cb531-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">color =</span> variable, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb531-6"><a href="linear-regression.html#cb531-6" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb531-7"><a href="linear-regression.html#cb531-7" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span> outcome, <span class="at">scales=</span><span class="st">&#39;free&#39;</span>, <span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-285-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="additional-decomposition-testings" class="section level4 hasAnchor" number="5.3.1.8">
<h4><span class="header-section-number">5.3.1.8</span> Additional Decomposition Testings<a href="linear-regression.html#additional-decomposition-testings" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="linear-regression.html#cb532-1" tabindex="-1"></a><span class="fu">head</span>(df.decompose_step2[vars.tomean.first],<span class="dv">3</span>)</span>
<span id="cb532-2"><a href="linear-regression.html#cb532-2" tabindex="-1"></a><span class="fu">head</span>(df.decompose_step2[<span class="fu">paste0</span>(vars.tomean.first, <span class="st">&#39;_mean&#39;</span>)], <span class="dv">3</span>)</span>
<span id="cb532-3"><a href="linear-regression.html#cb532-3" tabindex="-1"></a><span class="fu">head</span>(df.coef[df.decompose_step2<span class="sc">$</span>variable,</span>
<span id="cb532-4"><a href="linear-regression.html#cb532-4" tabindex="-1"></a>             <span class="fu">paste0</span>(vars.tomean.first, str.esti.suffix)], <span class="dv">3</span>)</span>
<span id="cb532-5"><a href="linear-regression.html#cb532-5" tabindex="-1"></a>df.decompose.tomean.first <span class="ot">&lt;-</span> df.decompose_step2 <span class="sc">%&gt;%</span></span>
<span id="cb532-6"><a href="linear-regression.html#cb532-6" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pred_new =</span> df.decompose_step2<span class="sc">$</span>value <span class="sc">+</span></span>
<span id="cb532-7"><a href="linear-regression.html#cb532-7" tabindex="-1"></a>        <span class="fu">rowSums</span>((df.decompose_step2[<span class="fu">paste0</span>(vars.tomean.first, <span class="st">&#39;_mean&#39;</span>)]</span>
<span id="cb532-8"><a href="linear-regression.html#cb532-8" tabindex="-1"></a>                 <span class="sc">-</span> df.decompose_step2[vars.tomean.first])</span>
<span id="cb532-9"><a href="linear-regression.html#cb532-9" tabindex="-1"></a>            <span class="sc">*</span>df.coef[df.decompose_step2<span class="sc">$</span>variable,</span>
<span id="cb532-10"><a href="linear-regression.html#cb532-10" tabindex="-1"></a>                     <span class="fu">paste0</span>(vars.tomean.first, str.esti.suffix)])) <span class="sc">%&gt;%</span></span>
<span id="cb532-11"><a href="linear-regression.html#cb532-11" tabindex="-1"></a>        <span class="fu">select</span>(variable, value, pred_new)</span>
<span id="cb532-12"><a href="linear-regression.html#cb532-12" tabindex="-1"></a><span class="fu">head</span>(df.decompose.tomean.first, <span class="dv">10</span>)</span>
<span id="cb532-13"><a href="linear-regression.html#cb532-13" tabindex="-1"></a>df.decompose.tomean.first <span class="sc">%&gt;%</span></span>
<span id="cb532-14"><a href="linear-regression.html#cb532-14" tabindex="-1"></a>        <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb532-15"><a href="linear-regression.html#cb532-15" tabindex="-1"></a>        <span class="fu">summarize_all</span>(<span class="fu">funs</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd))  <span class="sc">%&gt;%</span></span>
<span id="cb532-16"><a href="linear-regression.html#cb532-16" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb532-17"><a href="linear-regression.html#cb532-17" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
4.675867
</td>
<td style="text-align:right;">
4.534947
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
1722.118824
</td>
<td style="text-align:right;">
1695.221845
</td>
</tr>
</tbody>
</table>
<p>Note the r-square from regression above matches up with the 1 - ratio below. This is the proper decomposition method that is equivalent to r2.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="linear-regression.html#cb533-1" tabindex="-1"></a>df.decompose_step2 <span class="sc">%&gt;%</span></span>
<span id="cb533-2"><a href="linear-regression.html#cb533-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pred_new =</span> df.decompose_step2<span class="sc">$</span>value <span class="sc">+</span></span>
<span id="cb533-3"><a href="linear-regression.html#cb533-3" tabindex="-1"></a>        <span class="fu">rowSums</span>((df.decompose_step2[<span class="fu">paste0</span>(vars.tomean.second, <span class="st">&#39;_mean&#39;</span>)]</span>
<span id="cb533-4"><a href="linear-regression.html#cb533-4" tabindex="-1"></a>                 <span class="sc">-</span> df.decompose_step2[vars.tomean.second])</span>
<span id="cb533-5"><a href="linear-regression.html#cb533-5" tabindex="-1"></a>            <span class="sc">*</span>df.coef[df.decompose_step2<span class="sc">$</span>variable,</span>
<span id="cb533-6"><a href="linear-regression.html#cb533-6" tabindex="-1"></a>                     <span class="fu">paste0</span>(vars.tomean.second, str.esti.suffix)])) <span class="sc">%&gt;%</span></span>
<span id="cb533-7"><a href="linear-regression.html#cb533-7" tabindex="-1"></a>        <span class="fu">select</span>(variable, value, pred_new) <span class="sc">%&gt;%</span></span>
<span id="cb533-8"><a href="linear-regression.html#cb533-8" tabindex="-1"></a>        <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb533-9"><a href="linear-regression.html#cb533-9" tabindex="-1"></a>        <span class="fu">summarize_all</span>(<span class="fu">funs</span>(<span class="at">mean =</span> mean, <span class="at">var =</span> var)) <span class="sc">%&gt;%</span></span>
<span id="cb533-10"><a href="linear-regression.html#cb533-10" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">ratio =</span> (pred_new_var<span class="sc">/</span>value_var))  <span class="sc">%&gt;%</span></span>
<span id="cb533-11"><a href="linear-regression.html#cb533-11" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb533-12"><a href="linear-regression.html#cb533-12" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred_new_var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ratio
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hgt
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
73.41216
</td>
<td style="text-align:right;">
2.186374e+01
</td>
<td style="text-align:right;">
25.3504
</td>
<td style="text-align:right;">
1.1594724
</td>
</tr>
<tr>
<td style="text-align:left;">
wgt
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
8807.87656
</td>
<td style="text-align:right;">
2.965693e+06
</td>
<td style="text-align:right;">
2949187.6357
</td>
<td style="text-align:right;">
0.9944345
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multi-dimensional-data-structures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nonlinear-and-other-regressions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
