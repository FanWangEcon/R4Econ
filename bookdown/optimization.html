<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Optimization | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Optimization | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Optimization | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2021-05-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nonlinear-and-other-regressions.html"/>
<link rel="next" href="mathematics.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-dataframes"><i class="fa fa-check"></i><b>1.4.5</b> String Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarize-data.html"><a href="summarize-data.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.2.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.3.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.4" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-compare"><i class="fa fa-check"></i><b>4.3</b> Join and Compare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.1</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.1.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.1.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.2</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.2.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.1</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#positive-and-negative-exponents"><i class="fa fa-check"></i><b>8.1.2</b> Positive and Negative Exponents</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.3</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.2</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.2.1</b> Gini Discrete Sample</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.2.2</b> Gini Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.2.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.2.3</b> Atkinson Inequality Index</a></li>
<li class="chapter" data-level="8.2.4" data-path="mathematics.html"><a href="mathematics.html#location-population-and-pollution"><i class="fa fa-check"></i><b>8.2.4</b> Location, Population, and Pollution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.1.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.2</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-marginal-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.2.1</b> Obtaining Joint Distribution from Marginal with Rectilinear Restrictions</a></li>
<li class="chapter" data-level="9.2.2" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-conditional-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.2.2</b> Obtaining Joint Distribution from Conditional with Rectilinear Restrictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-and-development.html"><a href="code-and-development.html"><i class="fa fa-check"></i><b>12</b> Code and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="code-and-development.html"><a href="code-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.1</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="code-and-development.html"><a href="code-and-development.html#file-path"><i class="fa fa-check"></i><b>12.1.1</b> File Path</a></li>
<li class="chapter" data-level="12.1.2" data-path="code-and-development.html"><a href="code-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.1.2</b> Text to File</a></li>
<li class="chapter" data-level="12.1.3" data-path="code-and-development.html"><a href="code-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.1.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="code-and-development.html"><a href="code-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.2</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="code-and-development.html"><a href="code-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.2.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="code-and-development.html"><a href="code-and-development.html#command-line"><i class="fa fa-check"></i><b>12.3</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="code-and-development.html"><a href="code-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.3.1</b> Shell and System Commands</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate, Gather, Bind and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-join-and-comparejoin-and-compare-links"><i class="fa fa-check"></i><b>A.4.3</b> <span>Section 4.3 Join and Compare</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Quantile Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Basics</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 Distributions</span> links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.2</b> <span>Section 9.2 Discrete Random Variable</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> <span>Section 10.2 ggplot Line Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> <span>Section 10.3 ggplot Scatter Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> <span>Section 10.4 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> <span>Section 11.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#code-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Code and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.1</b> <span>Section 12.1 Files In and Out</span> links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.2</b> <span>Section 12.2 Python with R</span> links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.3</b> <span>Section 12.3 Command Line</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="optimization" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Optimization</h1>

<div id="bisection" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Bisection</h2>

<div id="bisection-1" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Bisection</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>See the <a href="https://fanwangecon.github.io/REconTools/reference/ff_opti_bisect_pmap_multi.html">ff_opti_bisect_pmap_multi</a> function from <a href="https://fanwangecon.github.io/">Fan</a>’s <em><a href="https://fanwangecon.github.io/REconTools/">REconTools</a></em> Package, which provides a resuable function based on the algorithm worked out here.</p>
<p>The bisection specific code does not need to do much.</p>
<ul>
<li>list variables in file for grouping, each group is an individual for whom we want to calculate optimal choice for using bisection.</li>
<li>string variable name of input where functions are evaluated, these are already contained in the dataframe, existing variable names, row specific, rowwise computation over these, each rowwise calculation using different rows.</li>
<li>scalar and array values that are applied to every rowwise calculation, all rowwise calculations using the same scalars and arrays.</li>
<li>string output variable name</li>
</ul>
<p>This is how I implement the bisection algorithm, when we know the bounding minimum and maximum to be below and above zero already.</p>
<ol style="list-style-type: decimal">
<li>Evaluate <span class="math inline">\(f^0_a = f(a^0)\)</span> and <span class="math inline">\(f^0_b = f(b^0)\)</span>, min and max points.</li>
<li>Evaluate at <span class="math inline">\(f^0_p = f(p^0)\)</span>, where <span class="math inline">\(p_0 = \frac{a^0+b^0}{2}\)</span>.</li>
<li>if <span class="math inline">\(f^i_a \cdot f^i_p &lt; 0\)</span>, then <span class="math inline">\(b_{i+1} = p_i\)</span>, else, <span class="math inline">\(a_{i+1} = p_i\)</span> and <span class="math inline">\(f^{i+1}_a = p_i\)</span>.</li>
<li>iteratre until convergence.</li>
</ol>
<p>Generate New columns of a and b as we iteratre, do not need to store p, p is temporary. Evaluate the function below which we have already tested, but now, in the dataframe before generating all permutations, <em>tb_states_choices</em>, now the <em>fl_N</em> element will be changing with each iteration, it will be row specific. <em>fl_N</em> are first min and max, then each subsequent ps.</p>
<div id="initialize-matrix" class="section level4" number="7.1.1.1">
<h4><span class="header-section-number">7.1.1.1</span> Initialize Matrix</h4>
<p>Prepare Input Data:</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="optimization.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb437-2"><a href="optimization.html#cb437-2" aria-hidden="true" tabindex="-1"></a>fl_rho <span class="ot">=</span> <span class="fl">0.20</span></span>
<span id="cb437-3"><a href="optimization.html#cb437-3" aria-hidden="true" tabindex="-1"></a>svr_id_var <span class="ot">=</span> <span class="st">&#39;INDI_ID&#39;</span></span>
<span id="cb437-4"><a href="optimization.html#cb437-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-5"><a href="optimization.html#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="co"># P fixed parameters, nN is N dimensional, nP is P dimensional</span></span>
<span id="cb437-6"><a href="optimization.html#cb437-6" aria-hidden="true" tabindex="-1"></a>ar_nN_A <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">4</span>)</span>
<span id="cb437-7"><a href="optimization.html#cb437-7" aria-hidden="true" tabindex="-1"></a>ar_nN_alpha <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">length.out =</span> <span class="dv">4</span>)</span>
<span id="cb437-8"><a href="optimization.html#cb437-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-9"><a href="optimization.html#cb437-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Choice Grid for nutritional feasible choices for each</span></span>
<span id="cb437-10"><a href="optimization.html#cb437-10" aria-hidden="true" tabindex="-1"></a>fl_N_agg <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb437-11"><a href="optimization.html#cb437-11" aria-hidden="true" tabindex="-1"></a>fl_N_min <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb437-12"><a href="optimization.html#cb437-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-13"><a href="optimization.html#cb437-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesh Expand</span></span>
<span id="cb437-14"><a href="optimization.html#cb437-14" aria-hidden="true" tabindex="-1"></a>tb_states_choices <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_nN_A, ar_nN_alpha)) <span class="sc">%&gt;%</span> </span>
<span id="cb437-15"><a href="optimization.html#cb437-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var=</span>svr_id_var)</span>
<span id="cb437-16"><a href="optimization.html#cb437-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-17"><a href="optimization.html#cb437-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Matrix to Tibble</span></span>
<span id="cb437-18"><a href="optimization.html#cb437-18" aria-hidden="true" tabindex="-1"></a>ar_st_col_names <span class="ot">=</span> <span class="fu">c</span>(svr_id_var,<span class="st">&#39;fl_A&#39;</span>, <span class="st">&#39;fl_alpha&#39;</span>)</span>
<span id="cb437-19"><a href="optimization.html#cb437-19" aria-hidden="true" tabindex="-1"></a>tb_states_choices <span class="ot">&lt;-</span> tb_states_choices <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_col_names))</span></code></pre></div>
<p>Prepare Function:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="optimization.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Implicit Function</span></span>
<span id="cb438-2"><a href="optimization.html#cb438-2" aria-hidden="true" tabindex="-1"></a>ffi_nonlin_dplyrdo <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_A, fl_alpha, fl_N, ar_A, ar_alpha, fl_N_agg, fl_rho){</span>
<span id="cb438-3"><a href="optimization.html#cb438-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-4"><a href="optimization.html#cb438-4" aria-hidden="true" tabindex="-1"></a>  ar_p1_s1 <span class="ot">=</span> <span class="fu">exp</span>((fl_A <span class="sc">-</span> ar_A)<span class="sc">*</span>fl_rho)</span>
<span id="cb438-5"><a href="optimization.html#cb438-5" aria-hidden="true" tabindex="-1"></a>  ar_p1_s2 <span class="ot">=</span> (fl_alpha<span class="sc">/</span>ar_alpha)</span>
<span id="cb438-6"><a href="optimization.html#cb438-6" aria-hidden="true" tabindex="-1"></a>  ar_p1_s3 <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span>(ar_alpha<span class="sc">*</span>fl_rho <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb438-7"><a href="optimization.html#cb438-7" aria-hidden="true" tabindex="-1"></a>  ar_p1 <span class="ot">=</span> (ar_p1_s1<span class="sc">*</span>ar_p1_s2)<span class="sc">^</span>ar_p1_s3</span>
<span id="cb438-8"><a href="optimization.html#cb438-8" aria-hidden="true" tabindex="-1"></a>  ar_p2 <span class="ot">=</span> fl_N<span class="sc">^</span>((fl_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>)<span class="sc">/</span>(ar_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>))</span>
<span id="cb438-9"><a href="optimization.html#cb438-9" aria-hidden="true" tabindex="-1"></a>  ar_overall <span class="ot">=</span> ar_p1<span class="sc">*</span>ar_p2</span>
<span id="cb438-10"><a href="optimization.html#cb438-10" aria-hidden="true" tabindex="-1"></a>  fl_overall <span class="ot">=</span> fl_N_agg <span class="sc">-</span> <span class="fu">sum</span>(ar_overall)</span>
<span id="cb438-11"><a href="optimization.html#cb438-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-12"><a href="optimization.html#cb438-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_overall)</span>
<span id="cb438-13"><a href="optimization.html#cb438-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Initialize the matrix with <span class="math inline">\(a_0\)</span> and <span class="math inline">\(b_0\)</span>, the initial min and max points:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="optimization.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># common prefix to make reshaping easier</span></span>
<span id="cb439-2"><a href="optimization.html#cb439-2" aria-hidden="true" tabindex="-1"></a>st_bisec_prefix <span class="ot">&lt;-</span> <span class="st">&#39;bisec_&#39;</span></span>
<span id="cb439-3"><a href="optimization.html#cb439-3" aria-hidden="true" tabindex="-1"></a>svr_a_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;a_0&#39;</span>)</span>
<span id="cb439-4"><a href="optimization.html#cb439-4" aria-hidden="true" tabindex="-1"></a>svr_b_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;b_0&#39;</span>)</span>
<span id="cb439-5"><a href="optimization.html#cb439-5" aria-hidden="true" tabindex="-1"></a>svr_fa_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fa_0&#39;</span>)</span>
<span id="cb439-6"><a href="optimization.html#cb439-6" aria-hidden="true" tabindex="-1"></a>svr_fb_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fb_0&#39;</span>)</span>
<span id="cb439-7"><a href="optimization.html#cb439-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-8"><a href="optimization.html#cb439-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add initial a and b</span></span>
<span id="cb439-9"><a href="optimization.html#cb439-9" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices <span class="sc">%&gt;%</span></span>
<span id="cb439-10"><a href="optimization.html#cb439-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst) <span class="sc">:</span><span class="er">=</span> fl_N_min, <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst) <span class="sc">:</span><span class="er">=</span> fl_N_agg)</span>
<span id="cb439-11"><a href="optimization.html#cb439-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-12"><a href="optimization.html#cb439-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate function f(a_0) and f(b_0)</span></span>
<span id="cb439-13"><a href="optimization.html#cb439-13" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb439-14"><a href="optimization.html#cb439-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb439-15"><a href="optimization.html#cb439-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fa_lst) <span class="sc">:</span><span class="er">=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(fl_A, fl_alpha, <span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst),</span>
<span id="cb439-16"><a href="optimization.html#cb439-16" aria-hidden="true" tabindex="-1"></a>                                                ar_nN_A, ar_nN_alpha,</span>
<span id="cb439-17"><a href="optimization.html#cb439-17" aria-hidden="true" tabindex="-1"></a>                                                fl_N_agg, fl_rho),</span>
<span id="cb439-18"><a href="optimization.html#cb439-18" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!!</span><span class="fu">sym</span>(svr_fb_lst) <span class="sc">:</span><span class="er">=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(fl_A, fl_alpha, <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst),</span>
<span id="cb439-19"><a href="optimization.html#cb439-19" aria-hidden="true" tabindex="-1"></a>                                                ar_nN_A, ar_nN_alpha,</span>
<span id="cb439-20"><a href="optimization.html#cb439-20" aria-hidden="true" tabindex="-1"></a>                                                fl_N_agg, fl_rho))</span>
<span id="cb439-21"><a href="optimization.html#cb439-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize</span></span>
<span id="cb439-22"><a href="optimization.html#cb439-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tb_states_choices_bisec)</span></code></pre></div>
<pre><code>## [1] 4 7</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="optimization.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tb_states_choices_bisec)</span></span></code></pre></div>
</div>
<div id="iterate-and-solve-for-fp-update-fa-and-fb" class="section level4" number="7.1.1.2">
<h4><span class="header-section-number">7.1.1.2</span> Iterate and Solve for f(p), update f(a) and f(b)</h4>
<p>Implement the DPLYR based Concurrent bisection algorithm.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="optimization.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fl_tol = float tolerance criteria</span></span>
<span id="cb442-2"><a href="optimization.html#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="co"># it_tol = number of interations to allow at most</span></span>
<span id="cb442-3"><a href="optimization.html#cb442-3" aria-hidden="true" tabindex="-1"></a>fl_tol <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span></span>
<span id="cb442-4"><a href="optimization.html#cb442-4" aria-hidden="true" tabindex="-1"></a>it_tol <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb442-5"><a href="optimization.html#cb442-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-6"><a href="optimization.html#cb442-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fl_p_dist2zr = distance to zero to initalize</span></span>
<span id="cb442-7"><a href="optimization.html#cb442-7" aria-hidden="true" tabindex="-1"></a>fl_p_dist2zr <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb442-8"><a href="optimization.html#cb442-8" aria-hidden="true" tabindex="-1"></a>it_cur <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb442-9"><a href="optimization.html#cb442-9" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (it_cur <span class="sc">&lt;=</span> it_tol <span class="sc">&amp;&amp;</span> fl_p_dist2zr <span class="sc">&gt;=</span> fl_tol ) {</span>
<span id="cb442-10"><a href="optimization.html#cb442-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-11"><a href="optimization.html#cb442-11" aria-hidden="true" tabindex="-1"></a>  it_cur <span class="ot">&lt;-</span> it_cur <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb442-12"><a href="optimization.html#cb442-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-13"><a href="optimization.html#cb442-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># New Variables</span></span>
<span id="cb442-14"><a href="optimization.html#cb442-14" aria-hidden="true" tabindex="-1"></a>  svr_a_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;a_&#39;</span>, it_cur)</span>
<span id="cb442-15"><a href="optimization.html#cb442-15" aria-hidden="true" tabindex="-1"></a>  svr_b_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;b_&#39;</span>, it_cur)</span>
<span id="cb442-16"><a href="optimization.html#cb442-16" aria-hidden="true" tabindex="-1"></a>  svr_fa_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fa_&#39;</span>, it_cur)</span>
<span id="cb442-17"><a href="optimization.html#cb442-17" aria-hidden="true" tabindex="-1"></a>  svr_fb_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fb_&#39;</span>, it_cur)</span>
<span id="cb442-18"><a href="optimization.html#cb442-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-19"><a href="optimization.html#cb442-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Evaluate function f(a_0) and f(b_0)</span></span>
<span id="cb442-20"><a href="optimization.html#cb442-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. generate p</span></span>
<span id="cb442-21"><a href="optimization.html#cb442-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. generate f_p</span></span>
<span id="cb442-22"><a href="optimization.html#cb442-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. generate f_p*f_a</span></span>
<span id="cb442-23"><a href="optimization.html#cb442-23" aria-hidden="true" tabindex="-1"></a>  tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb442-24"><a href="optimization.html#cb442-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb442-25"><a href="optimization.html#cb442-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> ((<span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst) <span class="sc">+</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst))<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb442-26"><a href="optimization.html#cb442-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f_p =</span> <span class="fu">ffi_nonlin_dplyrdo</span>(fl_A, fl_alpha, p,</span>
<span id="cb442-27"><a href="optimization.html#cb442-27" aria-hidden="true" tabindex="-1"></a>                                    ar_nN_A, ar_nN_alpha,</span>
<span id="cb442-28"><a href="optimization.html#cb442-28" aria-hidden="true" tabindex="-1"></a>                                    fl_N_agg, fl_rho)) <span class="sc">%&gt;%</span></span>
<span id="cb442-29"><a href="optimization.html#cb442-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f_p_t_f_a =</span> f_p<span class="sc">*!!</span><span class="fu">sym</span>(svr_fa_lst))</span>
<span id="cb442-30"><a href="optimization.html#cb442-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_p_dist2zr = sum(abs(p))</span></span>
<span id="cb442-31"><a href="optimization.html#cb442-31" aria-hidden="true" tabindex="-1"></a>  fl_p_dist2zr <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(tb_states_choices_bisec <span class="sc">%&gt;%</span> <span class="fu">pull</span>(f_p)))</span>
<span id="cb442-32"><a href="optimization.html#cb442-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-33"><a href="optimization.html#cb442-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update a and b</span></span>
<span id="cb442-34"><a href="optimization.html#cb442-34" aria-hidden="true" tabindex="-1"></a>  tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb442-35"><a href="optimization.html#cb442-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_a_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb442-36"><a href="optimization.html#cb442-36" aria-hidden="true" tabindex="-1"></a>             <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst),</span>
<span id="cb442-37"><a href="optimization.html#cb442-37" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">TRUE</span> <span class="sc">~</span> p)) <span class="sc">%&gt;%</span></span>
<span id="cb442-38"><a href="optimization.html#cb442-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_b_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb442-39"><a href="optimization.html#cb442-39" aria-hidden="true" tabindex="-1"></a>             <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> p,</span>
<span id="cb442-40"><a href="optimization.html#cb442-40" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst)))</span>
<span id="cb442-41"><a href="optimization.html#cb442-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update f(a) and f(b)</span></span>
<span id="cb442-42"><a href="optimization.html#cb442-42" aria-hidden="true" tabindex="-1"></a>  tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb442-43"><a href="optimization.html#cb442-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fa_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb442-44"><a href="optimization.html#cb442-44" aria-hidden="true" tabindex="-1"></a>             <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fa_lst),</span>
<span id="cb442-45"><a href="optimization.html#cb442-45" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">TRUE</span> <span class="sc">~</span> f_p)) <span class="sc">%&gt;%</span></span>
<span id="cb442-46"><a href="optimization.html#cb442-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fb_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb442-47"><a href="optimization.html#cb442-47" aria-hidden="true" tabindex="-1"></a>             <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> f_p,</span>
<span id="cb442-48"><a href="optimization.html#cb442-48" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fb_lst)))</span>
<span id="cb442-49"><a href="optimization.html#cb442-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save from last</span></span>
<span id="cb442-50"><a href="optimization.html#cb442-50" aria-hidden="true" tabindex="-1"></a>  svr_a_lst <span class="ot">&lt;-</span> svr_a_cur</span>
<span id="cb442-51"><a href="optimization.html#cb442-51" aria-hidden="true" tabindex="-1"></a>  svr_b_lst <span class="ot">&lt;-</span> svr_b_cur</span>
<span id="cb442-52"><a href="optimization.html#cb442-52" aria-hidden="true" tabindex="-1"></a>  svr_fa_lst <span class="ot">&lt;-</span> svr_fa_cur</span>
<span id="cb442-53"><a href="optimization.html#cb442-53" aria-hidden="true" tabindex="-1"></a>  svr_fb_lst <span class="ot">&lt;-</span> svr_fb_cur</span>
<span id="cb442-54"><a href="optimization.html#cb442-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-55"><a href="optimization.html#cb442-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summar current round</span></span>
<span id="cb442-56"><a href="optimization.html#cb442-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_cur:&#39;</span>, it_cur, <span class="st">&#39;, fl_p_dist2zr:&#39;</span>, fl_p_dist2zr))</span>
<span id="cb442-57"><a href="optimization.html#cb442-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb442-58"><a href="optimization.html#cb442-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="fu">one_of</span>(svr_a_cur, svr_b_cur, svr_fa_cur, svr_fb_cur)))</span>
<span id="cb442-59"><a href="optimization.html#cb442-59" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;it_cur:1, fl_p_dist2zr:1597.93916362849&quot;
## [1] &quot;it_cur:2, fl_p_dist2zr:676.06602535902&quot;
## [1] &quot;it_cur:3, fl_p_dist2zr:286.850590132782&quot;
## [1] &quot;it_cur:4, fl_p_dist2zr:117.225493866655&quot;
## [1] &quot;it_cur:5, fl_p_dist2zr:37.570593471664&quot;
## [1] &quot;it_cur:6, fl_p_dist2zr:4.60826664896022&quot;
## [1] &quot;it_cur:7, fl_p_dist2zr:14.4217689135683&quot;
## [1] &quot;it_cur:8, fl_p_dist2zr:8.38950830086659&quot;
## [1] &quot;it_cur:9, fl_p_dist2zr:3.93347761455868&quot;
## [1] &quot;it_cur:10, fl_p_dist2zr:1.88261338941038&quot;
## [1] &quot;it_cur:11, fl_p_dist2zr:0.744478952222305&quot;
## [1] &quot;it_cur:12, fl_p_dist2zr:0.187061801237917&quot;
## [1] &quot;it_cur:13, fl_p_dist2zr:0.117844913432613&quot;
## [1] &quot;it_cur:14, fl_p_dist2zr:0.0275365951418891&quot;
## [1] &quot;it_cur:15, fl_p_dist2zr:0.0515488156908255&quot;
## [1] &quot;it_cur:16, fl_p_dist2zr:0.0191152349149135&quot;
## [1] &quot;it_cur:17, fl_p_dist2zr:0.00385372194545752&quot;</code></pre>
</div>
<div id="reshape-wide-to-long-to-wide" class="section level4" number="7.1.1.3">
<h4><span class="header-section-number">7.1.1.3</span> Reshape Wide to long to Wide</h4>
<p>To view results easily, how iterations improved to help us find the roots, convert table from wide to long. Pivot twice. This allows us to easily graph out how bisection is working out iterationby iteration.</p>
<p>Here, we will first show what the raw table looks like, the wide only table, and then show the long version, and finally the version that is medium wide.</p>
<div id="table-onevery-wide" class="section level5" number="7.1.1.3.1">
<h5><span class="header-section-number">7.1.1.3.1</span> Table One–Very Wide</h5>
<p>Show what the <em>tb_states_choices_bisec</em> looks like.</p>
<p>Variables are formatted like: <em>bisec_xx_yy</em>, where yy is the iteration indicator, and xx is either a, b, fa, or fb.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="optimization.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(<span class="fu">t</span>(tb_states_choices_bisec), <span class="dv">25</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb444-2"><a href="optimization.html#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
INDI_ID
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
2.0000000
</td>
<td style="text-align:right;">
3.0000000
</td>
<td style="text-align:right;">
4.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
fl_A
</td>
<td style="text-align:right;">
-2.000000e+00
</td>
<td style="text-align:right;">
-0.6666667
</td>
<td style="text-align:right;">
0.6666667
</td>
<td style="text-align:right;">
2.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
fl_alpha
</td>
<td style="text-align:right;">
1.000000e-01
</td>
<td style="text-align:right;">
0.3666667
</td>
<td style="text-align:right;">
0.6333333
</td>
<td style="text-align:right;">
0.9000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_a_0
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_b_0
</td>
<td style="text-align:right;">
1.000000e+02
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
100.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fa_0
</td>
<td style="text-align:right;">
1.000000e+02
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
100.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fb_0
</td>
<td style="text-align:right;">
-1.288028e+04
</td>
<td style="text-align:right;">
-1394.7069782
</td>
<td style="text-align:right;">
-323.9421599
</td>
<td style="text-align:right;">
-51.9716069
</td>
</tr>
<tr>
<td style="text-align:left;">
p
</td>
<td style="text-align:right;">
1.544952e+00
</td>
<td style="text-align:right;">
8.5838318
</td>
<td style="text-align:right;">
24.8359680
</td>
<td style="text-align:right;">
65.0367737
</td>
</tr>
<tr>
<td style="text-align:left;">
f_p
</td>
<td style="text-align:right;">
-7.637200e-03
</td>
<td style="text-align:right;">
-0.0052211
</td>
<td style="text-align:right;">
-0.0016162
</td>
<td style="text-align:right;">
-0.0009405
</td>
</tr>
<tr>
<td style="text-align:left;">
f_p_t_f_a
</td>
<td style="text-align:right;">
-3.800000e-04
</td>
<td style="text-align:right;">
-0.0000237
</td>
<td style="text-align:right;">
-0.0000025
</td>
<td style="text-align:right;">
-0.0000002
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_a_1
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
50.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_b_1
</td>
<td style="text-align:right;">
5.000000e+01
</td>
<td style="text-align:right;">
50.0000000
</td>
<td style="text-align:right;">
50.0000000
</td>
<td style="text-align:right;">
100.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fa_1
</td>
<td style="text-align:right;">
1.000000e+02
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
22.5557704
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fb_1
</td>
<td style="text-align:right;">
-5.666956e+03
</td>
<td style="text-align:right;">
-595.7345364
</td>
<td style="text-align:right;">
-106.5105843
</td>
<td style="text-align:right;">
-51.9716069
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_a_2
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
50.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_b_2
</td>
<td style="text-align:right;">
2.500000e+01
</td>
<td style="text-align:right;">
25.0000000
</td>
<td style="text-align:right;">
25.0000000
</td>
<td style="text-align:right;">
75.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fa_2
</td>
<td style="text-align:right;">
1.000000e+02
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
22.5557704
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fb_2
</td>
<td style="text-align:right;">
-2.464562e+03
</td>
<td style="text-align:right;">
-224.1460032
</td>
<td style="text-align:right;">
-0.6857375
</td>
<td style="text-align:right;">
-14.8701831
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_a_3
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
12.5000000
</td>
<td style="text-align:right;">
62.5000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_b_3
</td>
<td style="text-align:right;">
1.250000e+01
</td>
<td style="text-align:right;">
12.5000000
</td>
<td style="text-align:right;">
25.0000000
</td>
<td style="text-align:right;">
75.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fa_3
</td>
<td style="text-align:right;">
1.000000e+02
</td>
<td style="text-align:right;">
100.0000000
</td>
<td style="text-align:right;">
50.8640414
</td>
<td style="text-align:right;">
3.7940196
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fb_3
</td>
<td style="text-align:right;">
-1.041574e+03
</td>
<td style="text-align:right;">
-51.1700464
</td>
<td style="text-align:right;">
-0.6857375
</td>
<td style="text-align:right;">
-14.8701831
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_a_4
</td>
<td style="text-align:right;">
0.000000e+00
</td>
<td style="text-align:right;">
6.2500000
</td>
<td style="text-align:right;">
18.7500000
</td>
<td style="text-align:right;">
62.5000000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_b_4
</td>
<td style="text-align:right;">
6.250000e+00
</td>
<td style="text-align:right;">
12.5000000
</td>
<td style="text-align:right;">
25.0000000
</td>
<td style="text-align:right;">
68.7500000
</td>
</tr>
<tr>
<td style="text-align:left;">
bisec_fa_4
</td>
<td style="text-align:right;">
1.000000e+02
</td>
<td style="text-align:right;">
29.4271641
</td>
<td style="text-align:right;">
25.2510409
</td>
<td style="text-align:right;">
3.7940196
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="optimization.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(tb_states_choices_bisec)</span></span></code></pre></div>
</div>
<div id="table-twovery-wide-to-very-long" class="section level5" number="7.1.1.3.2">
<h5><span class="header-section-number">7.1.1.3.2</span> Table Two–Very Wide to Very Long</h5>
<p>We want to treat the iteration count information that is the suffix of variable names as a variable by itself. Additionally, we want to treat the a,b,fa,fb as a variable. Structuring the data very long like this allows for easy graphing and other types of analysis. Rather than dealing with many many variables, we have only 3 core variables that store bisection iteration information.</p>
<p>Here we use the very nice <em>pivot_longer</em> function. Note that to achieve this, we put a common prefix in front of the variables we wanted to convert to long. THis is helpful, because we can easily identify which variables need to be reshaped.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="optimization.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New variables</span></span>
<span id="cb446-2"><a href="optimization.html#cb446-2" aria-hidden="true" tabindex="-1"></a>svr_bisect_iter <span class="ot">&lt;-</span> <span class="st">&#39;biseciter&#39;</span></span>
<span id="cb446-3"><a href="optimization.html#cb446-3" aria-hidden="true" tabindex="-1"></a>svr_abfafb_long_name <span class="ot">&lt;-</span> <span class="st">&#39;varname&#39;</span></span>
<span id="cb446-4"><a href="optimization.html#cb446-4" aria-hidden="true" tabindex="-1"></a>svr_number_col <span class="ot">&lt;-</span> <span class="st">&#39;value&#39;</span></span>
<span id="cb446-5"><a href="optimization.html#cb446-5" aria-hidden="true" tabindex="-1"></a>svr_id_bisect_iter <span class="ot">&lt;-</span> <span class="fu">paste0</span>(svr_id_var, <span class="st">&#39;_bisect_ier&#39;</span>)</span>
<span id="cb446-6"><a href="optimization.html#cb446-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-7"><a href="optimization.html#cb446-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot wide to very long</span></span>
<span id="cb446-8"><a href="optimization.html#cb446-8" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec_long <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb446-9"><a href="optimization.html#cb446-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb446-10"><a href="optimization.html#cb446-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(st_bisec_prefix),</span>
<span id="cb446-11"><a href="optimization.html#cb446-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(svr_abfafb_long_name, svr_bisect_iter),</span>
<span id="cb446-12"><a href="optimization.html#cb446-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&quot;(.*)_(.*)&quot;</span>),</span>
<span id="cb446-13"><a href="optimization.html#cb446-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> svr_number_col</span>
<span id="cb446-14"><a href="optimization.html#cb446-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb446-15"><a href="optimization.html#cb446-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-16"><a href="optimization.html#cb446-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb446-17"><a href="optimization.html#cb446-17" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tb_states_choices_bisec_long)</span></span>
<span id="cb446-18"><a href="optimization.html#cb446-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(tb_states_choices_bisec_long <span class="sc">%&gt;%</span> </span>
<span id="cb446-19"><a href="optimization.html#cb446-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">15</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb446-20"><a href="optimization.html#cb446-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
INDI_ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_A
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_alpha
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
varname
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
biseciter
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
100.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
100.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
fb
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
-12880.284
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
50.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
100.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
fb
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
-5666.956
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
25.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
100.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
fb
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
-2464.562
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
12.500
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
100.000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="optimization.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(tb_states_choices_bisec_long <span class="sc">%&gt;%</span> </span>
<span id="cb447-2"><a href="optimization.html#cb447-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">15</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb447-3"><a href="optimization.html#cb447-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
INDI_ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_A
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_alpha
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
varname
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
biseciter
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
65.0390625
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
0.0047633
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fb
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
-0.0043628
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
65.0360107
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
65.0390625
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
0.0002003
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fb
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
-0.0043628
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
65.0360107
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
65.0375366
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
0.0002003
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fb
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
-0.0020812
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
65.0360107
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
65.0367737
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fa
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
0.0002003
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
fb
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
-0.0009405
</td>
</tr>
</tbody>
</table>
</div>
<div id="table-twovery-very-long-to-wider-again" class="section level5" number="7.1.1.3.3">
<h5><span class="header-section-number">7.1.1.3.3</span> Table Two–Very Very Long to Wider Again</h5>
<p>But the previous results are too long, with the a, b, fa, and fb all in one column as different categories, they are really not different categories, they are in fact different types of variables. So we want to spread those four categories of this variable into four columns, each one representing the a, b, fa, and fb values. The rows would then be uniquly identified by the iteration counter and individual ID.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="optimization.html#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot wide to very long to a little wide</span></span>
<span id="cb448-2"><a href="optimization.html#cb448-2" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec_wider <span class="ot">&lt;-</span> tb_states_choices_bisec_long <span class="sc">%&gt;%</span></span>
<span id="cb448-3"><a href="optimization.html#cb448-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb448-4"><a href="optimization.html#cb448-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name),</span>
<span id="cb448-5"><a href="optimization.html#cb448-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> svr_number_col</span>
<span id="cb448-6"><a href="optimization.html#cb448-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb448-7"><a href="optimization.html#cb448-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-8"><a href="optimization.html#cb448-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb448-9"><a href="optimization.html#cb448-9" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(tb_states_choices_bisec_wider)</span></span>
<span id="cb448-10"><a href="optimization.html#cb448-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(tb_states_choices_bisec_wider <span class="sc">%&gt;%</span> </span>
<span id="cb448-11"><a href="optimization.html#cb448-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb448-12"><a href="optimization.html#cb448-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
INDI_ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_A
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_alpha
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
biseciter
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
a
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fa
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
100.0000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-12880.283918
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
50.0000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-5666.955763
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
25.0000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-2464.562178
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
12.5000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-1041.574253
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
6.2500
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-408.674764
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
3.1250
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-126.904283
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.781250
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
54.69612
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
1.171875
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
27.46061
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
1.367188
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
13.23495
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="optimization.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(tb_states_choices_bisec_wider <span class="sc">%&gt;%</span> </span>
<span id="cb449-2"><a href="optimization.html#cb449-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb449-3"><a href="optimization.html#cb449-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
INDI_ID
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_A
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fl_alpha
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
biseciter
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
a
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fa
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
100.0000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-12880.283918
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
50.0000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-5666.955763
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
25.0000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-2464.562178
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
12.5000
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-1041.574253
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
6.2500
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-408.674764
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
3.1250
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-126.904283
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.781250
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
54.69612
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
1.171875
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
27.46061
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
1.367188
</td>
<td style="text-align:right;">
1.5625
</td>
<td style="text-align:right;">
13.23495
</td>
<td style="text-align:right;">
-1.328965
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="graph-bisection-iteration-results" class="section level4" number="7.1.1.4">
<h4><span class="header-section-number">7.1.1.4</span> Graph Bisection Iteration Results</h4>
<p>Actually we want to graph based on the long results, not the wider. Wider easier to view in table.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="optimization.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph results</span></span>
<span id="cb450-2"><a href="optimization.html#cb450-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> tb_states_choices_bisec_long <span class="sc">%&gt;%</span></span>
<span id="cb450-3"><a href="optimization.html#cb450-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_bisect_iter) <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_bisect_iter))) <span class="sc">%&gt;%</span></span>
<span id="cb450-4"><a href="optimization.html#cb450-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb450-5"><a href="optimization.html#cb450-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_bisect_iter), <span class="at">y=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_number_col),</span>
<span id="cb450-6"><a href="optimization.html#cb450-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name),</span>
<span id="cb450-7"><a href="optimization.html#cb450-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name),</span>
<span id="cb450-8"><a href="optimization.html#cb450-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name))) <span class="sc">+</span></span>
<span id="cb450-9"><a href="optimization.html#cb450-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>( <span class="sc">~</span> INDI_ID) <span class="sc">+</span></span>
<span id="cb450-10"><a href="optimization.html#cb450-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb450-11"><a href="optimization.html#cb450-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb450-12"><a href="optimization.html#cb450-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Bisection Iteration over individuals Until Convergence&#39;</span>,</span>
<span id="cb450-13"><a href="optimization.html#cb450-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Bisection Iteration&#39;</span>,</span>
<span id="cb450-14"><a href="optimization.html#cb450-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;a (left side point) and b (right side point) values&#39;</span>,</span>
<span id="cb450-15"><a href="optimization.html#cb450-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;DPLYR concurrent bisection nonlinear multple individuals&#39;</span>) <span class="sc">+</span></span>
<span id="cb450-16"><a href="optimization.html#cb450-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb450-17"><a href="optimization.html#cb450-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lineplot)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/reshape%20solution%20for%20graphing-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nonlinear-and-other-regressions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mathematics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
