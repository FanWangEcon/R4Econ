<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Coding and Development | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="Running parallel code in R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Coding and Development | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Running parallel code in R" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Coding and Development | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="Running parallel code in R" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="get-data.html"/>
<link rel="next" href="index-and-code-links.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#regular-expression-date-etc."><i class="fa fa-check"></i><b>1.4</b> Regular Expression, Date, etc.</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-regular-expression"><i class="fa fa-check"></i><b>1.4.1</b> String Regular Expression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html"><i class="fa fa-check"></i><b>2</b> Manipulate and Summarize Dataframes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#variables-in-dataframes"><i class="fa fa-check"></i><b>2.1</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-dataframe"><i class="fa fa-check"></i><b>2.1.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="2.1.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-categorical-variables"><i class="fa fa-check"></i><b>2.1.2</b> Generate Categorical Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#drawly-random-rows"><i class="fa fa-check"></i><b>2.1.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="2.1.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>2.1.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="2.1.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#string-dataframes"><i class="fa fa-check"></i><b>2.1.5</b> String Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-observation"><i class="fa fa-check"></i><b>2.2</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-and-tabulations"><i class="fa fa-check"></i><b>2.2.1</b> Counting and Tabulations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.3</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-1"><i class="fa fa-check"></i><b>2.3.1</b> Sorting</a></li>
<li class="chapter" data-level="2.3.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.3.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#advanced-group-aggregation"><i class="fa fa-check"></i><b>2.4</b> Advanced Group Aggregation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.4.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.4.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#groups-statistics"><i class="fa fa-check"></i><b>2.4.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.4.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.4.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.4.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.4.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#distributional-statistics"><i class="fa fa-check"></i><b>2.5</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#histogram"><i class="fa fa-check"></i><b>2.5.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.6</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#apply-function-over-multiple-columns-and-rows"><i class="fa fa-check"></i><b>2.6.1</b> Apply Function Over Multiple Columns and Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-table-to-wide-table"><i class="fa fa-check"></i><b>4.2.1</b> Long Table to Wide Table</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-comparisons-and-statistics"><i class="fa fa-check"></i><b>4.3</b> Within Panel Comparisons and Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
<li class="chapter" data-level="4.3.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-cross-time-and-cross-group-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Within Panel Cross-time and Cross-group Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-merge-files-together-by-keys"><i class="fa fa-check"></i><b>4.4</b> Join and Merge Files Together by Keys</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#mesh-join"><i class="fa fa-check"></i><b>4.4.1</b> Mesh Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#linear-and-polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Linear and Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#fit-curves-through-points"><i class="fa fa-check"></i><b>5.1.1</b> Fit Curves Through Points</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#grid-based-optimization"><i class="fa fa-check"></i><b>7.1</b> Grid Based Optimization</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#find-maximum-by-iterating-over-grids"><i class="fa fa-check"></i><b>7.1.1</b> Find Maximum By Iterating Over Grids</a></li>
<li class="chapter" data-level="7.1.2" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1.2</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#polynomial-formulas-for-points"><i class="fa fa-check"></i><b>8.1.1</b> Polynomial Formulas for Points</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.3</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.4</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.5" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.5</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-functions"><i class="fa fa-check"></i><b>8.2</b> Production Functions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#latent-dynamic-health-production-function"><i class="fa fa-check"></i><b>8.2.2</b> Latent Dynamic Health Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot-basics"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot Basics</a></li>
<li class="chapter" data-level="10.2.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-advanced"><i class="fa fa-check"></i><b>10.2.2</b> ggplot Line Advanced</a></li>
<li class="chapter" data-level="10.2.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#time-series-plots-with-shaded-areas"><i class="fa fa-check"></i><b>10.2.3</b> Time-series Plots with Shaded Areas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="coding-and-development.html"><a href="coding-and-development.html"><i class="fa fa-check"></i><b>12</b> Coding and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="coding-and-development.html"><a href="coding-and-development.html#installation-and-packages"><i class="fa fa-check"></i><b>12.1</b> Installation and Packages</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="coding-and-development.html"><a href="coding-and-development.html#r-installation-and-set-up"><i class="fa fa-check"></i><b>12.1.1</b> R Installation and Set-Up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="coding-and-development.html"><a href="coding-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.2</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="coding-and-development.html"><a href="coding-and-development.html#file-path"><i class="fa fa-check"></i><b>12.2.1</b> File Path</a></li>
<li class="chapter" data-level="12.2.2" data-path="coding-and-development.html"><a href="coding-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.2.2</b> Text to File</a></li>
<li class="chapter" data-level="12.2.3" data-path="coding-and-development.html"><a href="coding-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.2.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="coding-and-development.html"><a href="coding-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.3</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="coding-and-development.html"><a href="coding-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.3.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="coding-and-development.html"><a href="coding-and-development.html#command-line"><i class="fa fa-check"></i><b>12.4</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="coding-and-development.html"><a href="coding-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.4.1</b> Shell and System Commands</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="coding-and-development.html"><a href="coding-and-development.html#run-code-in-parallel-in-r"><i class="fa fa-check"></i><b>12.5</b> Run Code in Parallel in R</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="coding-and-development.html"><a href="coding-and-development.html#parallel-loop-in-r"><i class="fa fa-check"></i><b>12.5.1</b> Parallel Loop in R</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> Section 1.1 List links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> Section 1.2 Array links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> Section 1.3 Matrix links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-regular-expression-date-etc.regular-expression-date-etc.-links"><i class="fa fa-check"></i><b>A.1.4</b> Section 1.4 Regular Expression, Date, etc. links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#manipulate-and-summarize-dataframes-links"><i class="fa fa-check"></i><b>A.2</b> Manipulate and Summarize Dataframes links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.2.1</b> Section 2.1 Variables in Dataframes links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.2</b> Section 2.2 Counting Observation links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.3</b> Section 2.3 Sorting, Indexing, Slicing links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-advanced-group-aggregationadvanced-group-aggregation-links"><i class="fa fa-check"></i><b>A.2.4</b> Section 2.4 Advanced Group Aggregation links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.5</b> Section 2.5 Distributional Statistics links</a></li>
<li class="chapter" data-level="A.2.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.6-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.6</b> Section 2.6 Summarize Multiple Variables links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> Section 3.1 Dataframe Mutate links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> Section 3.2 Dataframe Do Anything links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> Section 3.3 Apply and pmap links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> Section 4.1 Generate, Gather, Bind and Join links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> Section 4.2 Wide and Long links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-within-panel-comparisons-and-statisticswithin-panel-comparisons-and-statistics-links"><i class="fa fa-check"></i><b>A.4.3</b> Section 4.3 Within Panel Comparisons and Statistics links</a></li>
<li class="chapter" data-level="A.4.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.4-join-and-merge-files-together-by-keysjoin-and-merge-files-together-by-keys-links"><i class="fa fa-check"></i><b>A.4.4</b> Section 4.4 Join and Merge Files Together by Keys links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-linear-and-polynomial-fittinglinear-and-polynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> Section 5.1 Linear and Polynomial Fitting links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> Section 5.2 OLS and IV links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> Section 5.3 Decomposition links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> Section 6.1 Logit Regression links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> Section 6.2 Quantile Regression links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-grid-based-optimizationgrid-based-optimization-links"><i class="fa fa-check"></i><b>A.7.1</b> Section 7.1 Grid Based Optimization links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> Section 8.1 Basics links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionsproduction-functions-links"><i class="fa fa-check"></i><b>A.8.2</b> Section 8.2 Production Functions links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> Section 8.3 Inequality Models links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> Section 9.1 Random Draws links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> Section 9.2 Distributions links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> Section 9.3 Discrete Random Variable links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> Section 10.1 R Base Plots links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> Section 10.2 ggplot Line Related Plots links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> Section 10.3 ggplot Scatter Related Plots links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> Section 10.4 Write and Read Plots links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> Section 11.1 Environmental Data links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#coding-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Coding and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-installation-and-packagesinstallation-and-packages-links"><i class="fa fa-check"></i><b>A.12.1</b> Section 12.1 Installation and Packages links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.2</b> Section 12.2 Files In and Out links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.3</b> Section 12.3 Python with R links</a></li>
<li class="chapter" data-level="A.12.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.4-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.4</b> Section 12.4 Command Line links</a></li>
<li class="chapter" data-level="A.12.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.5-run-code-in-parallel-in-rrun-code-in-parallel-in-r-links"><i class="fa fa-check"></i><b>A.12.5</b> Section 12.5 Run Code in Parallel in R links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="coding-and-development" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Coding and Development<a href="coding-and-development.html#coding-and-development" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="installation-and-packages" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Installation and Packages<a href="coding-and-development.html#installation-and-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="r-installation-and-set-up" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> R Installation and Set-Up<a href="coding-and-development.html#r-installation-and-set-up" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Install R new, or update an existing R installation.</p>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="uninstall-r" class="section level4 hasAnchor" number="12.1.1.1">
<h4><span class="header-section-number">12.1.1.1</span> Uninstall r<a href="coding-and-development.html#uninstall-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Uninstall R, RStudio and RTools from Windows “Programs and Features” menu. After uninstaller finishes, check in the libPath folders to see if there are still stuff there, delete all, delete the folders.</p>
<p>If R was installed in a virtual environment, delete the environment. Otherwise, use system’s uninstaller. To check on this, from terminal/command-prompt for each virtual environment, type <em>R</em>, and <em>.libPaths()</em> to find paths. Do so inside conda main, outside of conda main, inside different environments, find all paths.</p>
<p>Inside R:</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="coding-and-development.html#cb852-1" tabindex="-1"></a>ls_spn_paths <span class="ot">&lt;-</span> <span class="fu">.libPaths</span>()</span>
<span id="cb852-2"><a href="coding-and-development.html#cb852-2" tabindex="-1"></a><span class="fu">print</span>(ls_spn_paths)</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/fan/AppData/Local/R/win-library/4.3&quot;
## [2] &quot;C:/Program Files/R/R-4.3.1/library&quot;</code></pre>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="coding-and-development.html#cb854-1" tabindex="-1"></a><span class="co"># C:/Users/fan/Documents/R/win-library/3.6</span></span>
<span id="cb854-2"><a href="coding-and-development.html#cb854-2" tabindex="-1"></a><span class="co"># C:/Program Files/R/R-3.6.1/library</span></span></code></pre></div>
<p>Check which conda env is installed, if there is an env installed for R.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb855-1"><a href="coding-and-development.html#cb855-1" tabindex="-1"></a><span class="co"># Show All installed environments</span></span>
<span id="cb855-2"><a href="coding-and-development.html#cb855-2" tabindex="-1"></a><span class="ex">conda</span> info <span class="at">--envs</span></span></code></pre></div>
<p>For Linux and for unsintalling inside conda:</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb856-1"><a href="coding-and-development.html#cb856-1" tabindex="-1"></a><span class="co"># Exit Conda</span></span>
<span id="cb856-2"><a href="coding-and-development.html#cb856-2" tabindex="-1"></a><span class="ex">conda</span> deactivate</span>
<span id="cb856-3"><a href="coding-and-development.html#cb856-3" tabindex="-1"></a><span class="co"># where is R installed outside of Conda</span></span>
<span id="cb856-4"><a href="coding-and-development.html#cb856-4" tabindex="-1"></a><span class="fu">which</span> R</span>
<span id="cb856-5"><a href="coding-and-development.html#cb856-5" tabindex="-1"></a><span class="co"># /usr/bin/R</span></span>
<span id="cb856-6"><a href="coding-and-development.html#cb856-6" tabindex="-1"></a><span class="co"># To remove all</span></span>
<span id="cb856-7"><a href="coding-and-development.html#cb856-7" tabindex="-1"></a><span class="fu">sudo</span> apt-get remove r-base</span>
<span id="cb856-8"><a href="coding-and-development.html#cb856-8" tabindex="-1"></a><span class="fu">sudo</span> apt-get remove r-base-core</span>
<span id="cb856-9"><a href="coding-and-development.html#cb856-9" tabindex="-1"></a></span>
<span id="cb856-10"><a href="coding-and-development.html#cb856-10" tabindex="-1"></a><span class="co"># Inside Conda base</span></span>
<span id="cb856-11"><a href="coding-and-development.html#cb856-11" tabindex="-1"></a><span class="ex">conda</span> activate</span>
<span id="cb856-12"><a href="coding-and-development.html#cb856-12" tabindex="-1"></a><span class="co"># Conda r_env</span></span>
<span id="cb856-13"><a href="coding-and-development.html#cb856-13" tabindex="-1"></a><span class="ex">conda</span> activate r_envr</span>
<span id="cb856-14"><a href="coding-and-development.html#cb856-14" tabindex="-1"></a><span class="co"># Where is it installed?</span></span>
<span id="cb856-15"><a href="coding-and-development.html#cb856-15" tabindex="-1"></a><span class="fu">which</span> R</span>
<span id="cb856-16"><a href="coding-and-development.html#cb856-16" tabindex="-1"></a><span class="co"># /home/wangfanbsg75/anaconda3/bin/R</span></span>
<span id="cb856-17"><a href="coding-and-development.html#cb856-17" tabindex="-1"></a><span class="ex">conda</span> uninstall r-base</span></code></pre></div>
</div>
<div id="install-r" class="section level4 hasAnchor" number="12.1.1.2">
<h4><span class="header-section-number">12.1.1.2</span> Install R<a href="coding-and-development.html#install-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="install-r-for-the-first-time" class="section level5 hasAnchor" number="12.1.1.2.1">
<h5><span class="header-section-number">12.1.1.2.1</span> Install R for the First Time<a href="coding-and-development.html#install-r-for-the-first-time" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ol style="list-style-type: decimal">
<li><a href="https://cloud.r-project.org/">download R</a>
<ul>
<li>for debian: <a href="https://cran.r-project.org/bin/linux/debian/">Johannes Ranke</a>. For Linux/Debian installation, crucial to update the <em>source.list</em> to include sources that have more recent versions of R. If not, will get very old R versions that is not compatible with many packages.</li>
<li>add R to path for Windows. In Windows Path, add for example: <em>C:/Program Files/R/R-3.6.2/bin/x64/</em> and <em>C:/Rtools/bin</em></li>
</ul></li>
<li><a href="https://cran.r-project.org/bin/windows/Rtools/">Install Rtools</a> for building R packages.</li>
<li><a href="https://rstudio.com/products/rstudio/download/">download R-studio</a></li>
<li>Open R-studio and auto-detect R</li>
<li>Install additional packages</li>
</ol>
</div>
<div id="linux-r-install" class="section level5 hasAnchor" number="12.1.1.2.2">
<h5><span class="header-section-number">12.1.1.2.2</span> Linux R Install<a href="coding-and-development.html#linux-r-install" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>For linux/Debian, to Install latest R:</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb857-1"><a href="coding-and-development.html#cb857-1" tabindex="-1"></a><span class="co"># Go to get latesdebian latest r sources.list</span></span>
<span id="cb857-2"><a href="coding-and-development.html#cb857-2" tabindex="-1"></a><span class="fu">cat</span> /etc/apt/sources.list</span>
<span id="cb857-3"><a href="coding-and-development.html#cb857-3" tabindex="-1"></a><span class="co"># Install this First (should already be installed)</span></span>
<span id="cb857-4"><a href="coding-and-development.html#cb857-4" tabindex="-1"></a><span class="fu">sudo</span> apt install dirmngr</span>
<span id="cb857-5"><a href="coding-and-development.html#cb857-5" tabindex="-1"></a></span>
<span id="cb857-6"><a href="coding-and-development.html#cb857-6" tabindex="-1"></a><span class="co"># Debian R is maintained by Johannes Ranke, copied from https://cran.r-project.org/bin/linux/debian/:</span></span>
<span id="cb857-7"><a href="coding-and-development.html#cb857-7" tabindex="-1"></a><span class="ex">apt-key</span> adv <span class="at">--keyserver</span> keys.gnupg.net <span class="at">--recv-key</span> <span class="st">&#39;E19F5F87128899B192B1A2C2AD5F960A256A04AF&#39;</span></span>
<span id="cb857-8"><a href="coding-and-development.html#cb857-8" tabindex="-1"></a><span class="co"># Add to source.list, for debian stretch (9)</span></span>
<span id="cb857-9"><a href="coding-and-development.html#cb857-9" tabindex="-1"></a><span class="co"># sudo su added for security issue as super-user</span></span>
<span id="cb857-10"><a href="coding-and-development.html#cb857-10" tabindex="-1"></a><span class="fu">sudo</span> su <span class="at">-c</span> <span class="st">&quot;sudo echo &#39;deb http://cloud.r-project.org/bin/linux/debian stretch-cran35/&#39; &gt;&gt; /etc/apt/sources.list&quot;</span></span>
<span id="cb857-11"><a href="coding-and-development.html#cb857-11" tabindex="-1"></a><span class="co"># if added wrong lines, delete 3rd line</span></span>
<span id="cb857-12"><a href="coding-and-development.html#cb857-12" tabindex="-1"></a><span class="fu">sudo</span> sed <span class="st">&#39;3d&#39;</span> /etc/apt/sources.list</span>
<span id="cb857-13"><a href="coding-and-development.html#cb857-13" tabindex="-1"></a></span>
<span id="cb857-14"><a href="coding-and-development.html#cb857-14" tabindex="-1"></a><span class="co"># Update and Install R, should say updated from cloud.r</span></span>
<span id="cb857-15"><a href="coding-and-development.html#cb857-15" tabindex="-1"></a><span class="fu">sudo</span> apt-get update</span>
<span id="cb857-16"><a href="coding-and-development.html#cb857-16" tabindex="-1"></a><span class="fu">sudo</span> apt-get install r-base r-base-dev</span>
<span id="cb857-17"><a href="coding-and-development.html#cb857-17" tabindex="-1"></a></span>
<span id="cb857-18"><a href="coding-and-development.html#cb857-18" tabindex="-1"></a><span class="co"># Also install these, otherwise r-packages do not install</span></span>
<span id="cb857-19"><a href="coding-and-development.html#cb857-19" tabindex="-1"></a><span class="co"># libxml2 seems need for tidymodels</span></span>
<span id="cb857-20"><a href="coding-and-development.html#cb857-20" tabindex="-1"></a><span class="fu">sudo</span> apt-get install libcurl4-openssl-dev</span>
<span id="cb857-21"><a href="coding-and-development.html#cb857-21" tabindex="-1"></a><span class="fu">sudo</span> apt-get install libssl-dev</span>
<span id="cb857-22"><a href="coding-and-development.html#cb857-22" tabindex="-1"></a><span class="fu">sudo</span> apt-get install libxml2-dev</span></code></pre></div>
</div>
<div id="update-r-on-windows" class="section level5 hasAnchor" number="12.1.1.2.3">
<h5><span class="header-section-number">12.1.1.2.3</span> Update R on Windows<a href="coding-and-development.html#update-r-on-windows" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>First, use the <em>updateR()</em> function from the <em>installr</em> package.</p>
<ol style="list-style-type: decimal">
<li>On windows, install the <em>installr</em> package, and use <em>updateR()</em></li>
<li>At the end, will ask if want to move all old packages to new R directory</li>
</ol>
<p>New R will have new package directory, could keep all in old, should copy all to new, and not keep old. Can choose to copy all old packages to new folder, but still keep old packages in prior folder as they were</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="coding-and-development.html#cb858-1" tabindex="-1"></a><span class="co"># https://www.r-project.org/nosvn/pandoc/installr.html</span></span>
<span id="cb858-2"><a href="coding-and-development.html#cb858-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;installr&#39;</span>)</span>
<span id="cb858-3"><a href="coding-and-development.html#cb858-3" tabindex="-1"></a><span class="co"># update R from inside R (not Rstudio)</span></span>
<span id="cb858-4"><a href="coding-and-development.html#cb858-4" tabindex="-1"></a><span class="fu">require</span>(installr)</span>
<span id="cb858-5"><a href="coding-and-development.html#cb858-5" tabindex="-1"></a><span class="co"># this will open dialog boxes to take you through the steps.</span></span>
<span id="cb858-6"><a href="coding-and-development.html#cb858-6" tabindex="-1"></a><span class="fu">updateR</span>()</span>
<span id="cb858-7"><a href="coding-and-development.html#cb858-7" tabindex="-1"></a><span class="co"># Set Rstudio to the Latest R</span></span></code></pre></div>
<p>Second, after updating, might go into “Apps and Features” on Windows to unstaill the previous R version.</p>
<p>Third, update <a href="https://cran.r-project.org/bin/windows/Rtools/">RTools</a>. Uninstall RTools. Installation can be very large.</p>
<p>Fourth, update RStudio. Upon opening RStudio, if prior installations of R have been uninstalled, RStudio will auto-detect as ask if the latest version of R should be used. Choose yes. Upon entering RStudio, if there are updates, might prompt to RStudio website to download and update.</p>
<p>Fifth, follow the package installation directions below to update that.</p>
</div>
<div id="r-add-to-path" class="section level5 hasAnchor" number="12.1.1.2.4">
<h5><span class="header-section-number">12.1.1.2.4</span> R Add to Path<a href="coding-and-development.html#r-add-to-path" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To be able to use R via command line, make sure Windows knows where the path to R.exe is.</p>
<p>First, find where the installed R.exe path is. Open up the R installation, and then check path as below.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="coding-and-development.html#cb859-1" tabindex="-1"></a>ls_spn_paths <span class="ot">&lt;-</span> <span class="fu">.libPaths</span>()</span>
<span id="cb859-2"><a href="coding-and-development.html#cb859-2" tabindex="-1"></a><span class="fu">print</span>(ls_spn_paths)</span>
<span id="cb859-3"><a href="coding-and-development.html#cb859-3" tabindex="-1"></a><span class="co"># &quot;C:/Users/fan/AppData/Local/R/win-library/4.2&quot;</span></span>
<span id="cb859-4"><a href="coding-and-development.html#cb859-4" tabindex="-1"></a><span class="co"># &quot;C:/Program Files/R/R-4.2.1/library&quot;</span></span></code></pre></div>
<p>Second, given the path found, the R.exe is at “C:/Program Files/R/R-4.2.1/bin”. So now, in windows, System Properties -&gt; Advanced -&gt; Environment Variables -&gt; System Variables -&gt; Path -&gt; Edit -&gt; New -&gt; Paste “C:/Program Files/R/R-4.2.1/bin”</p>
<p>Third, now open up command-prompt/terminal/git-bash, enter R, this will take us into the R console via command-line.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="coding-and-development.html#cb860-1" tabindex="-1"></a><span class="co"># To exit command line:</span></span>
<span id="cb860-2"><a href="coding-and-development.html#cb860-2" tabindex="-1"></a><span class="fu">q</span>()</span></code></pre></div>
</div>
</div>
<div id="r-package-installations" class="section level4 hasAnchor" number="12.1.1.3">
<h4><span class="header-section-number">12.1.1.3</span> R Package Installations<a href="coding-and-development.html#r-package-installations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="update-r-install-directory" class="section level5 hasAnchor" number="12.1.1.3.1">
<h5><span class="header-section-number">12.1.1.3.1</span> Update R Install Directory<a href="coding-and-development.html#update-r-install-directory" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>After installing R, change the path sequence so that packages install for all users.</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="coding-and-development.html#cb861-1" tabindex="-1"></a>ls_spn_paths <span class="ot">&lt;-</span> <span class="fu">.libPaths</span>()</span>
<span id="cb861-2"><a href="coding-and-development.html#cb861-2" tabindex="-1"></a><span class="fu">print</span>(ls_spn_paths)</span>
<span id="cb861-3"><a href="coding-and-development.html#cb861-3" tabindex="-1"></a><span class="co"># [1] &quot;C:/Users/fan/AppData/Local/R/win-library/4.2&quot; &quot;C:/Program Files/R/R-4.2.1/library&quot;</span></span>
<span id="cb861-4"><a href="coding-and-development.html#cb861-4" tabindex="-1"></a>ls_spn_paths <span class="ot">&lt;-</span> <span class="fu">c</span>(ls_spn_paths[<span class="dv">2</span>], ls_spn_paths[<span class="dv">1</span>])</span>
<span id="cb861-5"><a href="coding-and-development.html#cb861-5" tabindex="-1"></a><span class="fu">.libPaths</span>(ls_spn_paths)</span>
<span id="cb861-6"><a href="coding-and-development.html#cb861-6" tabindex="-1"></a>ls_spn_paths <span class="ot">&lt;-</span> <span class="fu">.libPaths</span>()</span>
<span id="cb861-7"><a href="coding-and-development.html#cb861-7" tabindex="-1"></a><span class="fu">print</span>(ls_spn_paths)</span>
<span id="cb861-8"><a href="coding-and-development.html#cb861-8" tabindex="-1"></a><span class="co"># [1] &quot;C:/Program Files/R/R-4.2.1/library&quot;           &quot;C:/Users/fan/AppData/Local/R/win-library/4.2&quot;</span></span></code></pre></div>
</div>
<div id="install-vearious-directory" class="section level5 hasAnchor" number="12.1.1.3.2">
<h5><span class="header-section-number">12.1.1.3.2</span> Install vearious directory<a href="coding-and-development.html#install-vearious-directory" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>After updating R, sometimes, old packages are not copied over to new directory, so need to reinstall all packages.</p>
<p>Having set the directories earlier so that packages do not install in user’s personal folder, but the library folder where the R version is installed, we can find all installed packages in the <em>C:/Program Files/R/R-4.2.1/library</em> folder.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="coding-and-development.html#cb862-1" tabindex="-1"></a><span class="co"># Install RTools First!</span></span>
<span id="cb862-2"><a href="coding-and-development.html#cb862-2" tabindex="-1"></a><span class="co"># https://cran.r-project.org/bin/windows/Rtools/</span></span>
<span id="cb862-3"><a href="coding-and-development.html#cb862-3" tabindex="-1"></a></span>
<span id="cb862-4"><a href="coding-and-development.html#cb862-4" tabindex="-1"></a><span class="co"># Install system tools</span></span>
<span id="cb862-5"><a href="coding-and-development.html#cb862-5" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;backports&quot;</span>))</span>
<span id="cb862-6"><a href="coding-and-development.html#cb862-6" tabindex="-1"></a></span>
<span id="cb862-7"><a href="coding-and-development.html#cb862-7" tabindex="-1"></a><span class="co"># Install tidyverse</span></span>
<span id="cb862-8"><a href="coding-and-development.html#cb862-8" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;tidymodels&quot;</span>, <span class="st">&quot;vroom&quot;</span>))</span>
<span id="cb862-9"><a href="coding-and-development.html#cb862-9" tabindex="-1"></a></span>
<span id="cb862-10"><a href="coding-and-development.html#cb862-10" tabindex="-1"></a><span class="co"># Install Packaging tools</span></span>
<span id="cb862-11"><a href="coding-and-development.html#cb862-11" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;devtools&quot;</span>, <span class="st">&quot;pkgdown&quot;</span>, <span class="st">&quot;roxygen2&quot;</span>, <span class="st">&quot;bookdown&quot;</span>, <span class="st">&quot;knitr&quot;</span>, <span class="st">&quot;kableExtra&quot;</span>, <span class="st">&quot;formatR&quot;</span>, <span class="st">&quot;revealjs&quot;</span>))</span>
<span id="cb862-12"><a href="coding-and-development.html#cb862-12" tabindex="-1"></a></span>
<span id="cb862-13"><a href="coding-and-development.html#cb862-13" tabindex="-1"></a><span class="co"># Install Statistics models</span></span>
<span id="cb862-14"><a href="coding-and-development.html#cb862-14" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;AER&quot;</span>, <span class="st">&quot;minpack.lm&quot;</span>))</span>
<span id="cb862-15"><a href="coding-and-development.html#cb862-15" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;quantreg&quot;</span>))</span>
<span id="cb862-16"><a href="coding-and-development.html#cb862-16" tabindex="-1"></a></span>
<span id="cb862-17"><a href="coding-and-development.html#cb862-17" tabindex="-1"></a><span class="co"># Install Tools to Work with Other Packages</span></span>
<span id="cb862-18"><a href="coding-and-development.html#cb862-18" tabindex="-1"></a><span class="co"># matconv: converts matlab programs to R</span></span>
<span id="cb862-19"><a href="coding-and-development.html#cb862-19" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;reticulate&quot;</span>, <span class="st">&quot;JuliaCall&quot;</span>, <span class="st">&quot;matconv&quot;</span>))</span>
<span id="cb862-20"><a href="coding-and-development.html#cb862-20" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;matconv&quot;</span>))</span>
<span id="cb862-21"><a href="coding-and-development.html#cb862-21" tabindex="-1"></a><span class="co"># for reticulate errors, install directly from: devtools::install_github(&quot;rstudio/reticulate&quot;)</span></span>
<span id="cb862-22"><a href="coding-and-development.html#cb862-22" tabindex="-1"></a></span>
<span id="cb862-23"><a href="coding-and-development.html#cb862-23" tabindex="-1"></a><span class="co"># Install Paralell Tools</span></span>
<span id="cb862-24"><a href="coding-and-development.html#cb862-24" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;parallel&quot;</span>, <span class="st">&quot;doParallel&quot;</span>, <span class="st">&quot;foreach&quot;</span>))</span>
<span id="cb862-25"><a href="coding-and-development.html#cb862-25" tabindex="-1"></a></span>
<span id="cb862-26"><a href="coding-and-development.html#cb862-26" tabindex="-1"></a><span class="co"># Install personal Packages</span></span>
<span id="cb862-27"><a href="coding-and-development.html#cb862-27" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;fanwangecon/REconTools&quot;</span>)</span>
<span id="cb862-28"><a href="coding-and-development.html#cb862-28" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;fanwangecon/PrjOptiAlloc&quot;</span>)</span>
<span id="cb862-29"><a href="coding-and-development.html#cb862-29" tabindex="-1"></a></span>
<span id="cb862-30"><a href="coding-and-development.html#cb862-30" tabindex="-1"></a><span class="co"># Stata in Rmd</span></span>
<span id="cb862-31"><a href="coding-and-development.html#cb862-31" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;Hemken/Statamarkdown&quot;)</span></span>
<span id="cb862-32"><a href="coding-and-development.html#cb862-32" tabindex="-1"></a></span>
<span id="cb862-33"><a href="coding-and-development.html#cb862-33" tabindex="-1"></a><span class="co"># VScode integration and also sublime r-ide</span></span>
<span id="cb862-34"><a href="coding-and-development.html#cb862-34" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;languageserver&quot;</span>)</span></code></pre></div>
<p>Temp Installs:</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="coding-and-development.html#cb863-1" tabindex="-1"></a><span class="co"># 2020-10-19</span></span>
<span id="cb863-2"><a href="coding-and-development.html#cb863-2" tabindex="-1"></a><span class="co"># Temp install development version due to but</span></span>
<span id="cb863-3"><a href="coding-and-development.html#cb863-3" tabindex="-1"></a><span class="co"># https://github.com/rstudio/reticulate/issues/831</span></span>
<span id="cb863-4"><a href="coding-and-development.html#cb863-4" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;rstudio/reticulate&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="r-tests" class="section level4 hasAnchor" number="12.1.1.4">
<h4><span class="header-section-number">12.1.1.4</span> R Tests<a href="coding-and-development.html#r-tests" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Test the following file to see if we can execute a R file. Do it inside <em>r_env</em> and inside a <em>r</em> session.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="coding-and-development.html#cb864-1" tabindex="-1"></a><span class="co"># # A simple file with summary statistics using tidyverse</span></span>
<span id="cb864-2"><a href="coding-and-development.html#cb864-2" tabindex="-1"></a><span class="co"># source(&#39;C:/Users/fan/R4Econ/summarize/dist/htmlpdfr/fst_hist_onevar.R&#39;)</span></span>
<span id="cb864-3"><a href="coding-and-development.html#cb864-3" tabindex="-1"></a><span class="co"># source(&#39;G:/repos/R4Econ/summarize/dist/htmlpdfr/fst_hist_onevar.R&#39;)</span></span>
<span id="cb864-4"><a href="coding-and-development.html#cb864-4" tabindex="-1"></a><span class="co"># # Another simple file with summary statistics using tidyverse</span></span>
<span id="cb864-5"><a href="coding-and-development.html#cb864-5" tabindex="-1"></a><span class="co"># source(&#39;C:/Users/fan/R4Econ/support/tibble/htmlpdfr/fs_tib_basics.R&#39;)</span></span>
<span id="cb864-6"><a href="coding-and-development.html#cb864-6" tabindex="-1"></a><span class="co"># source(&#39;G:/repos/R4Econ/support/tibble/htmlpdfr/fs_tib_basics.R&#39;)</span></span>
<span id="cb864-7"><a href="coding-and-development.html#cb864-7" tabindex="-1"></a><span class="co"># # A file involving estimation</span></span>
<span id="cb864-8"><a href="coding-and-development.html#cb864-8" tabindex="-1"></a><span class="co"># source(&#39;C:/Users/fan/R4Econ/optimization/cesloglin/htmlpdfr/fst_ces_plan_linlog.R&#39;)</span></span>
<span id="cb864-9"><a href="coding-and-development.html#cb864-9" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb864-10"><a href="coding-and-development.html#cb864-10" tabindex="-1"></a><span class="co"># C:/Users/fan/R4Econ/summarize/dist/fst_hist_onevar.Rmd</span></span>
<span id="cb864-11"><a href="coding-and-development.html#cb864-11" tabindex="-1"></a><span class="co"># C:/Users/fan/R4Econ/support/tibble/fs_tib_basics.Rmd</span></span>
<span id="cb864-12"><a href="coding-and-development.html#cb864-12" tabindex="-1"></a><span class="co"># C:/Users/fan/R4Econ/optimization/cesloglin/fst_ces_plan_linlog.Rmd</span></span></code></pre></div>
</div>
<div id="r-with-radian" class="section level4 hasAnchor" number="12.1.1.5">
<h4><span class="header-section-number">12.1.1.5</span> R with Radian<a href="coding-and-development.html#r-with-radian" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>R with Radian:</p>
<ul>
<li><a href="https://www.r-bloggers.com/2021/01/setup-visual-studio-code-to-run-r-on-vscode-2021/">Setup Visual Studio Code to run R on VSCode 2021</a></li>
<li><a href="https://github.com/randy3k/radian">Radian</a></li>
</ul>
</div>
<div id="running-r-inside-vscode" class="section level4 hasAnchor" number="12.1.1.6">
<h4><span class="header-section-number">12.1.1.6</span> Running R Inside VSCode<a href="coding-and-development.html#running-r-inside-vscode" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Rstudio seems laggy sometimes, nice to be able to run R from VSCode, use VSCode as an alternative editor.</p>
<ul>
<li><a href="https://renkun.me/2019/12/11/writing-r-in-vscode-a-fresh-start/">Writing R in VSCode: A Fresh Start</a></li>
</ul>
<p>To Run .R scripts from inside VSCode. Here is the offical guide: <a href="https://code.visualstudio.com/docs/languages/r">R in Visual Studio Code</a>.</p>
<ol style="list-style-type: decimal">
<li>Install R following prior steps.</li>
<li>Make sure that the package languageserver is installed, check “require(languageserver)”.</li>
<li>Install <a href="https://marketplace.visualstudio.com/items?itemName=REditorSupport.r">R Extension for Visual Studio Code</a></li>
</ol>
<ul>
<li>change setting for “r.rterm.windows” to “C:/Program Files/R/R-4.2.1/bin/R.exe”</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Click File -&gt; Open Folder -&gt; Select the folder where the “.R” file to run is located at, this way, the Terminal will be directred to the folder that is currently open, rather than home default for example. <a href="https://stackoverflow.com/a/55668364">By default, the terminal will open at the folder that is opened in the Explorer</a></li>
<li>Run individual files in the folder just opened.</li>
</ol>
<div id="rmd-in-vscode" class="section level5 hasAnchor" number="12.1.1.6.1">
<h5><span class="header-section-number">12.1.1.6.1</span> RMD in VSCode<a href="coding-and-development.html#rmd-in-vscode" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Steps for RMD:</p>
<ol style="list-style-type: decimal">
<li>VSCode already has default markdown editor</li>
<li>Install Markdown Preview ehance, which generates a table of content bar on the side, and has math preview correclty</li>
<li>In file, F1, and type markdown preview and open up preview</li>
</ol>
</div>
<div id="rmd-and-markdown-file-associations" class="section level5 hasAnchor" number="12.1.1.6.2">
<h5><span class="header-section-number">12.1.1.6.2</span> RMD and MARKDOWN File Associations<a href="coding-and-development.html#rmd-and-markdown-file-associations" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><strong>Change File Extension Association</strong></p>
<ul>
<li>Working with RMD file, sometimes want to preview as MD file to view equations, sometimes want to view as RMD file to edit the R code. See <a href="https://stackoverflow.com/a/51228725/8280804">How to make VS Code to treat other file extensions as certain language?</a></li>
<li><a href="https://stackoverflow.com/a/51228725/8280804">change extension association</a> between md and Rmd for Rmd files for example: “Ctrl + shift + p” and “change language mode” from one file association to another.</li>
<li>Additionally, if there is a standard association we want for RMD, for it to be markdown for example, can add to JSON settings for <em>file.associations</em>.</li>
</ul>
<pre><code>&quot;files.associations&quot;: {
     &quot;*.Rmd&quot;: &quot;markdown&quot;
}</code></pre>

</div>
</div>
</div>
</div>
<div id="files-in-and-out" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Files In and Out<a href="coding-and-development.html#files-in-and-out" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="file-path" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> File Path<a href="coding-and-development.html#file-path" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="check-if-file-or-directory-exists-on-computer" class="section level4 hasAnchor" number="12.2.1.1">
<h4><span class="header-section-number">12.2.1.1</span> Check if File or Directory Exists on Computer<a href="coding-and-development.html#check-if-file-or-directory-exists-on-computer" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Take different string-based actions if some path exists on a computer.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="coding-and-development.html#cb866-1" tabindex="-1"></a><span class="co"># Check if either of the path exists on the computer</span></span>
<span id="cb866-2"><a href="coding-and-development.html#cb866-2" tabindex="-1"></a>spt_root_computer_a <span class="ot">&lt;-</span> <span class="st">&#39;G:/repos/R4Econ/&#39;</span></span>
<span id="cb866-3"><a href="coding-and-development.html#cb866-3" tabindex="-1"></a>spt_root_computer_b <span class="ot">&lt;-</span> <span class="st">&#39;C:/Users/fan/R4Econ/&#39;</span></span>
<span id="cb866-4"><a href="coding-and-development.html#cb866-4" tabindex="-1"></a></span>
<span id="cb866-5"><a href="coding-and-development.html#cb866-5" tabindex="-1"></a><span class="co"># Checking if directory exists</span></span>
<span id="cb866-6"><a href="coding-and-development.html#cb866-6" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">dir.exists</span>(spt_root_computer_a)) {</span>
<span id="cb866-7"><a href="coding-and-development.html#cb866-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(spt_root_computer_a, <span class="st">&#39;exists&#39;</span>))</span>
<span id="cb866-8"><a href="coding-and-development.html#cb866-8" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">dir.exists</span>(spt_root_computer_b)) {</span>
<span id="cb866-9"><a href="coding-and-development.html#cb866-9" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(spt_root_computer_b, <span class="st">&#39;exists&#39;</span>, spt_root_computer_a, <span class="st">&#39;does not exist&#39;</span>))</span>
<span id="cb866-10"><a href="coding-and-development.html#cb866-10" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb866-11"><a href="coding-and-development.html#cb866-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(spt_root_computer_b, spt_root_computer_a, <span class="st">&#39;both do does not exist&#39;</span>))</span>
<span id="cb866-12"><a href="coding-and-development.html#cb866-12" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/fan/R4Econ/ exists G:/repos/R4Econ/ does not exist&quot;</code></pre>
<p>Now, we check if a particular file exists.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="coding-and-development.html#cb868-1" tabindex="-1"></a><span class="co"># Check if either of the files exists on the computer</span></span>
<span id="cb868-2"><a href="coding-and-development.html#cb868-2" tabindex="-1"></a>spn_root_computer_a <span class="ot">&lt;-</span> <span class="st">&#39;G:/repos/R4Econ/index.Rmd&#39;</span></span>
<span id="cb868-3"><a href="coding-and-development.html#cb868-3" tabindex="-1"></a>spn_root_computer_b <span class="ot">&lt;-</span> <span class="st">&#39;C:/Users/fan/R4Econ/index.Rmd&#39;</span></span>
<span id="cb868-4"><a href="coding-and-development.html#cb868-4" tabindex="-1"></a></span>
<span id="cb868-5"><a href="coding-and-development.html#cb868-5" tabindex="-1"></a><span class="co"># Checking if file exists</span></span>
<span id="cb868-6"><a href="coding-and-development.html#cb868-6" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(spn_root_computer_a)) {</span>
<span id="cb868-7"><a href="coding-and-development.html#cb868-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(spn_root_computer_a, <span class="st">&#39;exists&#39;</span>))</span>
<span id="cb868-8"><a href="coding-and-development.html#cb868-8" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">file.exists</span>(spn_root_computer_b)) {</span>
<span id="cb868-9"><a href="coding-and-development.html#cb868-9" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(spn_root_computer_b, <span class="st">&#39;exists&#39;</span>, spn_root_computer_a, <span class="st">&#39;does not exist&#39;</span>))</span>
<span id="cb868-10"><a href="coding-and-development.html#cb868-10" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb868-11"><a href="coding-and-development.html#cb868-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(spn_root_computer_b, spn_root_computer_a, <span class="st">&#39;both do does not exist&#39;</span>))</span>
<span id="cb868-12"><a href="coding-and-development.html#cb868-12" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/fan/R4Econ/index.Rmd exists G:/repos/R4Econ/index.Rmd does not exist&quot;</code></pre>
</div>
<div id="compose-a-path" class="section level4 hasAnchor" number="12.2.1.2">
<h4><span class="header-section-number">12.2.1.2</span> Compose a Path<a href="coding-and-development.html#compose-a-path" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>File Path might contain information related to the file, decompose the file path, keep the final N folder names, to be possibled stored as a variable in the datafile stored inside.</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="coding-and-development.html#cb870-1" tabindex="-1"></a><span class="co"># Compose together a path</span></span>
<span id="cb870-2"><a href="coding-and-development.html#cb870-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;.Platform$file.sep=&#39;</span>, .Platform<span class="sc">$</span>file.sep))</span></code></pre></div>
<pre><code>## [1] &quot;.Platform$file.sep=/&quot;</code></pre>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="coding-and-development.html#cb872-1" tabindex="-1"></a>spn_file_path <span class="ot">=</span> <span class="fu">file.path</span>(<span class="st">&quot;C:&quot;</span>, <span class="st">&quot;Users&quot;</span>, <span class="st">&quot;fan&quot;</span>, <span class="st">&quot;R4Econ&quot;</span>, <span class="st">&quot;amto&quot;</span>, <span class="st">&quot;tibble&quot;</span>,</span>
<span id="cb872-2"><a href="coding-and-development.html#cb872-2" tabindex="-1"></a>                          <span class="st">&quot;fs_tib_basics.Rmd&quot;</span>,</span>
<span id="cb872-3"><a href="coding-and-development.html#cb872-3" tabindex="-1"></a>                          <span class="at">fsep =</span> .Platform<span class="sc">$</span>file.sep)</span>
<span id="cb872-4"><a href="coding-and-development.html#cb872-4" tabindex="-1"></a><span class="co"># print</span></span>
<span id="cb872-5"><a href="coding-and-development.html#cb872-5" tabindex="-1"></a><span class="fu">print</span>(spn_file_path)</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/fan/R4Econ/amto/tibble/fs_tib_basics.Rmd&quot;</code></pre>
</div>
<div id="substring-and-file-name" class="section level4 hasAnchor" number="12.2.1.3">
<h4><span class="header-section-number">12.2.1.3</span> Substring and File Name<a href="coding-and-development.html#substring-and-file-name" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>From path, get file name without suffix.</p>
<ul>
<li>r string split</li>
<li><a href="https://stackoverflow.com/a/83222/8280804">r list last element</a></li>
<li><a href="https://stackoverflow.com/a/29114007/8280804">r get file name from path</a></li>
<li><a href="https://stackoverflow.com/a/47189541/8280804">r get file path no name</a></li>
</ul>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="coding-and-development.html#cb874-1" tabindex="-1"></a>st_example <span class="ot">&lt;-</span> <span class="st">&#39;C:/Users/fan/R4Econ/amto/tibble/fs_tib_basics.Rmd&#39;</span></span>
<span id="cb874-2"><a href="coding-and-development.html#cb874-2" tabindex="-1"></a>st_file_wth_suffix_s <span class="ot">&lt;-</span> <span class="fu">tail</span>(<span class="fu">strsplit</span>(st_example, <span class="st">&quot;/&quot;</span>)[[<span class="dv">1</span>]],<span class="at">n=</span><span class="dv">1</span>)</span>
<span id="cb874-3"><a href="coding-and-development.html#cb874-3" tabindex="-1"></a>st_file_wno_suffix_s <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>(<span class="fu">basename</span>(st_example))</span>
<span id="cb874-4"><a href="coding-and-development.html#cb874-4" tabindex="-1"></a>st_fullpath_nosufx_s <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;</span><span class="sc">\\</span><span class="st">.Rmd$&#39;</span>, <span class="st">&#39;&#39;</span>, st_example)</span>
<span id="cb874-5"><a href="coding-and-development.html#cb874-5" tabindex="-1"></a>st_fullpath_noname_s <span class="ot">&lt;-</span> <span class="fu">dirname</span>(st_example)</span>
<span id="cb874-6"><a href="coding-and-development.html#cb874-6" tabindex="-1"></a></span>
<span id="cb874-7"><a href="coding-and-development.html#cb874-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;st_file_wth_suffix_s:&#39;</span>, st_file_wth_suffix_s))</span></code></pre></div>
<pre><code>## [1] &quot;st_file_wth_suffix_s:fs_tib_basics.Rmd&quot;</code></pre>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="coding-and-development.html#cb876-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;st_file_wno_suffix_s:&#39;</span>, st_file_wno_suffix_s))</span></code></pre></div>
<pre><code>## [1] &quot;st_file_wno_suffix_s:fs_tib_basics&quot;</code></pre>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="coding-and-development.html#cb878-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;st_fullpath_nosufx_s:&#39;</span>, st_fullpath_nosufx_s))</span></code></pre></div>
<pre><code>## [1] &quot;st_fullpath_nosufx_s:C:/Users/fan/R4Econ/amto/tibble/fs_tib_basics&quot;</code></pre>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="coding-and-development.html#cb880-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;st_fullpath_noname_s:&#39;</span>, st_fullpath_noname_s))</span></code></pre></div>
<pre><code>## [1] &quot;st_fullpath_noname_s:C:/Users/fan/R4Econ/amto/tibble&quot;</code></pre>
</div>
<div id="get-subset-of-path-folder-names" class="section level4 hasAnchor" number="12.2.1.4">
<h4><span class="header-section-number">12.2.1.4</span> Get Subset of Path Folder Names<a href="coding-and-development.html#get-subset-of-path-folder-names" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>File Path might contain information related to the file, decompose the file path, keep the final N folder names, to be possibled stored as a variable in the datafile stored inside.</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="coding-and-development.html#cb882-1" tabindex="-1"></a><span class="co"># Compose together a path</span></span>
<span id="cb882-2"><a href="coding-and-development.html#cb882-2" tabindex="-1"></a>spn_example <span class="ot">&lt;-</span> <span class="st">&#39;C:/Users/fan/R4Econ/amto/tibble/fs_tib_basics.Rmd&#39;</span></span>
<span id="cb882-3"><a href="coding-and-development.html#cb882-3" tabindex="-1"></a><span class="co"># Replace default system slash, assume spn was generated by system.</span></span>
<span id="cb882-4"><a href="coding-and-development.html#cb882-4" tabindex="-1"></a>ls_srt_folders_file <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(st_example, .Platform<span class="sc">$</span>file.sep)[[<span class="dv">1</span>]]</span>
<span id="cb882-5"><a href="coding-and-development.html#cb882-5" tabindex="-1"></a><span class="co"># Keep the last N layers</span></span>
<span id="cb882-6"><a href="coding-and-development.html#cb882-6" tabindex="-1"></a>it_folders_names_to_keep <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb882-7"><a href="coding-and-development.html#cb882-7" tabindex="-1"></a>snm_file_name <span class="ot">&lt;-</span> <span class="fu">tail</span>(<span class="fu">strsplit</span>(st_example, <span class="st">&quot;/&quot;</span>)[[<span class="dv">1</span>]],<span class="at">n=</span><span class="dv">1</span>)</span>
<span id="cb882-8"><a href="coding-and-development.html#cb882-8" tabindex="-1"></a>ls_srt_folders_keep <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">tail</span>(ls_srt_folders_file, it_folders_names_to_keep<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb882-9"><a href="coding-and-development.html#cb882-9" tabindex="-1"></a>                            it_folders_names_to_keep)</span>
<span id="cb882-10"><a href="coding-and-development.html#cb882-10" tabindex="-1"></a><span class="co"># Show folder names</span></span>
<span id="cb882-11"><a href="coding-and-development.html#cb882-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;snm_file_name:&#39;</span>, snm_file_name))</span></code></pre></div>
<pre><code>## [1] &quot;snm_file_name:fs_tib_basics.Rmd&quot;</code></pre>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="coding-and-development.html#cb884-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;last &#39;</span>, it_folders_names_to_keep, <span class="st">&#39; folders:&#39;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;last 2 folders:&quot;</code></pre>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="coding-and-development.html#cb886-1" tabindex="-1"></a><span class="fu">print</span>(ls_srt_folders_keep)</span></code></pre></div>
<pre><code>## [1] &quot;amto&quot;   &quot;tibble&quot;</code></pre>
<p>Shorter lines, to make copying easier.</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="coding-and-development.html#cb888-1" tabindex="-1"></a><span class="co"># inputs</span></span>
<span id="cb888-2"><a href="coding-and-development.html#cb888-2" tabindex="-1"></a>it_folders_names_to_keep <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb888-3"><a href="coding-and-development.html#cb888-3" tabindex="-1"></a>spn_example <span class="ot">&lt;-</span> <span class="st">&#39;C:/Users/fan/R4Econ/amto/tibble/fs_tib_basics.Rmd&#39;</span></span>
<span id="cb888-4"><a href="coding-and-development.html#cb888-4" tabindex="-1"></a><span class="co"># copy these</span></span>
<span id="cb888-5"><a href="coding-and-development.html#cb888-5" tabindex="-1"></a>ls_srt_folders_name_keep <span class="ot">&lt;-</span> <span class="fu">tail</span>(<span class="fu">strsplit</span>(st_example, <span class="st">&quot;/&quot;</span>)[[<span class="dv">1</span>]], <span class="at">n=</span>it_folders_names_to_keep<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb888-6"><a href="coding-and-development.html#cb888-6" tabindex="-1"></a>snm_file_name <span class="ot">&lt;-</span> <span class="fu">tail</span>(ls_srt_folders_name_keep, <span class="dv">1</span>)</span>
<span id="cb888-7"><a href="coding-and-development.html#cb888-7" tabindex="-1"></a>ls_srt_folders_keep <span class="ot">&lt;-</span> <span class="fu">head</span>(ls_srt_folders_name_keep, it_folders_names_to_keep)</span>
<span id="cb888-8"><a href="coding-and-development.html#cb888-8" tabindex="-1"></a><span class="co"># print</span></span>
<span id="cb888-9"><a href="coding-and-development.html#cb888-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;snm_file_name:&#39;</span>, snm_file_name))</span></code></pre></div>
<pre><code>## [1] &quot;snm_file_name:fs_tib_basics.Rmd&quot;</code></pre>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="coding-and-development.html#cb890-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;last &#39;</span>, it_folders_names_to_keep, <span class="st">&#39; folders:&#39;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;last 2 folders:&quot;</code></pre>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="coding-and-development.html#cb892-1" tabindex="-1"></a><span class="fu">print</span>(ls_srt_folders_keep)</span></code></pre></div>
<pre><code>## [1] &quot;amto&quot;   &quot;tibble&quot;</code></pre>

</div>
</div>
<div id="text-to-file" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Text to File<a href="coding-and-development.html#text-to-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="latex-table-to-file" class="section level4 hasAnchor" number="12.2.2.1">
<h4><span class="header-section-number">12.2.2.1</span> Latex Table to File<a href="coding-and-development.html#latex-table-to-file" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Tabular outputs, text outputs, etc are saved as variables, which could be printed in console. They can also be saved to file for future re-used. For example, latex outputs need to be saved to file.</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="coding-and-development.html#cb894-1" tabindex="-1"></a><span class="co"># Load Data</span></span>
<span id="cb894-2"><a href="coding-and-development.html#cb894-2" tabindex="-1"></a>dt <span class="ot">&lt;-</span> mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb894-3"><a href="coding-and-development.html#cb894-3" tabindex="-1"></a><span class="co"># Generate latex string variable</span></span>
<span id="cb894-4"><a href="coding-and-development.html#cb894-4" tabindex="-1"></a>st_out_tex <span class="ot">&lt;-</span> <span class="fu">kable</span>(dt, <span class="st">&quot;latex&quot;</span>)</span>
<span id="cb894-5"><a href="coding-and-development.html#cb894-5" tabindex="-1"></a><span class="fu">print</span>(st_out_tex)</span>
<span id="cb894-6"><a href="coding-and-development.html#cb894-6" tabindex="-1"></a><span class="co"># File out</span></span>
<span id="cb894-7"><a href="coding-and-development.html#cb894-7" tabindex="-1"></a><span class="co"># fileConn &lt;- file(&quot;./../../_file/tex/tex_sample_a_tab.tex&quot;)</span></span>
<span id="cb894-8"><a href="coding-and-development.html#cb894-8" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(<span class="st">&quot;_file/tex/tex_sample_a_tab.tex&quot;</span>)</span>
<span id="cb894-9"><a href="coding-and-development.html#cb894-9" tabindex="-1"></a><span class="fu">writeLines</span>(st_out_tex, fileConn)</span>
<span id="cb894-10"><a href="coding-and-development.html#cb894-10" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span></code></pre></div>
</div>
<div id="create-a-text-file-from-strings" class="section level4 hasAnchor" number="12.2.2.2">
<h4><span class="header-section-number">12.2.2.2</span> Create a Text File from Strings<a href="coding-and-development.html#create-a-text-file-from-strings" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="coding-and-development.html#cb895-1" tabindex="-1"></a>st_file <span class="ot">&lt;-</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">documentclass[12pt,english]{article}</span></span>
<span id="cb895-2"><a href="coding-and-development.html#cb895-2" tabindex="-1"></a><span class="sc">\\</span><span class="st">usepackage[bottom]{footmisc}</span></span>
<span id="cb895-3"><a href="coding-and-development.html#cb895-3" tabindex="-1"></a><span class="sc">\\</span><span class="st">usepackage[urlcolor=blue]{hyperref}</span></span>
<span id="cb895-4"><a href="coding-and-development.html#cb895-4" tabindex="-1"></a><span class="sc">\\</span><span class="st">begin{document}</span></span>
<span id="cb895-5"><a href="coding-and-development.html#cb895-5" tabindex="-1"></a><span class="sc">\\</span><span class="st">title{A Latex Testing File}</span></span>
<span id="cb895-6"><a href="coding-and-development.html#cb895-6" tabindex="-1"></a><span class="sc">\\</span><span class="st">author{</span><span class="sc">\\</span><span class="st">href{http://fanwangecon.github.io/}{Fan Wang} </span><span class="sc">\\</span><span class="st">thanks{See information </span><span class="sc">\\</span><span class="st">href{https://fanwangecon.github.io/Tex4Econ/}{Tex4Econ} for more.}}</span></span>
<span id="cb895-7"><a href="coding-and-development.html#cb895-7" tabindex="-1"></a><span class="sc">\\</span><span class="st">maketitle</span></span>
<span id="cb895-8"><a href="coding-and-development.html#cb895-8" tabindex="-1"></a><span class="st">Ipsum information dolor sit amet, consectetur adipiscing elit. Integer Latex placerat nunc orci.</span></span>
<span id="cb895-9"><a href="coding-and-development.html#cb895-9" tabindex="-1"></a><span class="sc">\\</span><span class="st">paragraph{</span><span class="sc">\\</span><span class="st">href{https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3140132}{Data}}</span></span>
<span id="cb895-10"><a href="coding-and-development.html#cb895-10" tabindex="-1"></a><span class="st">Village closure information is taken from a village head survey.</span><span class="sc">\\</span><span class="st">footnote{Generally students went to schools.}</span></span>
<span id="cb895-11"><a href="coding-and-development.html#cb895-11" tabindex="-1"></a><span class="st">output:</span></span>
<span id="cb895-12"><a href="coding-and-development.html#cb895-12" tabindex="-1"></a><span class="st">  pdf_document:</span></span>
<span id="cb895-13"><a href="coding-and-development.html#cb895-13" tabindex="-1"></a><span class="st">    pandoc_args: &#39;..//..//_output_kniti_pdf.yaml&#39;</span></span>
<span id="cb895-14"><a href="coding-and-development.html#cb895-14" tabindex="-1"></a><span class="st">    includes:</span></span>
<span id="cb895-15"><a href="coding-and-development.html#cb895-15" tabindex="-1"></a><span class="st">      in_header: &#39;..//..//preamble.tex&#39;</span></span>
<span id="cb895-16"><a href="coding-and-development.html#cb895-16" tabindex="-1"></a><span class="st">  html_document:</span></span>
<span id="cb895-17"><a href="coding-and-development.html#cb895-17" tabindex="-1"></a><span class="st">    pandoc_args: &#39;..//..//_output_kniti_html.yaml&#39;</span></span>
<span id="cb895-18"><a href="coding-and-development.html#cb895-18" tabindex="-1"></a><span class="st">    includes:</span></span>
<span id="cb895-19"><a href="coding-and-development.html#cb895-19" tabindex="-1"></a><span class="st">      in_header: &#39;..//..//hdga.html&#39;</span></span>
<span id="cb895-20"><a href="coding-and-development.html#cb895-20" tabindex="-1"></a><span class="sc">\\</span><span class="st">end{document}&quot;</span></span>
<span id="cb895-21"><a href="coding-and-development.html#cb895-21" tabindex="-1"></a></span>
<span id="cb895-22"><a href="coding-and-development.html#cb895-22" tabindex="-1"></a><span class="fu">print</span>(st_file)</span></code></pre></div>
<pre><code>## [1] &quot;\\documentclass[12pt,english]{article}\n\\usepackage[bottom]{footmisc}\n\\usepackage[urlcolor=blue]{hyperref}\n\\begin{document}\n\\title{A Latex Testing File}\n\\author{\\href{http://fanwangecon.github.io/}{Fan Wang} \\thanks{See information \\href{https://fanwangecon.github.io/Tex4Econ/}{Tex4Econ} for more.}}\n\\maketitle\nIpsum information dolor sit amet, consectetur adipiscing elit. Integer Latex placerat nunc orci.\n\\paragraph{\\href{https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3140132}{Data}}\nVillage closure information is taken from a village head survey.\\footnote{Generally students went to schools.}\noutput:\n  pdf_document:\n    pandoc_args: &#39;..//..//_output_kniti_pdf.yaml&#39;\n    includes:\n      in_header: &#39;..//..//preamble.tex&#39;\n  html_document:\n    pandoc_args: &#39;..//..//_output_kniti_html.yaml&#39;\n    includes:\n      in_header: &#39;..//..//hdga.html&#39;\n\\end{document}&quot;</code></pre>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="coding-and-development.html#cb897-1" tabindex="-1"></a>fl_test_tex <span class="ot">&lt;-</span> <span class="st">&quot;_file/tex/test_fan.tex&quot;</span></span>
<span id="cb897-2"><a href="coding-and-development.html#cb897-2" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(fl_test_tex)</span>
<span id="cb897-3"><a href="coding-and-development.html#cb897-3" tabindex="-1"></a><span class="fu">writeLines</span>(st_file, fileConn)</span>
<span id="cb897-4"><a href="coding-and-development.html#cb897-4" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span></code></pre></div>
</div>
<div id="open-a-file-and-read-lines" class="section level4 hasAnchor" number="12.2.2.3">
<h4><span class="header-section-number">12.2.2.3</span> Open A File and Read Lines<a href="coding-and-development.html#open-a-file-and-read-lines" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Open and Replace Text in File:</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="coding-and-development.html#cb898-1" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(fl_test_tex, <span class="st">&quot;r&quot;</span>)</span>
<span id="cb898-2"><a href="coding-and-development.html#cb898-2" tabindex="-1"></a>st_file_read <span class="ot">&lt;-</span> <span class="fu">readLines</span>(fileConn)</span>
<span id="cb898-3"><a href="coding-and-development.html#cb898-3" tabindex="-1"></a><span class="fu">print</span>(st_file_read)</span></code></pre></div>
<pre><code>##  [1] &quot;\\documentclass[12pt,english]{article}&quot;                                                                                                                 
##  [2] &quot;\\usepackage[bottom]{footmisc}&quot;                                                                                                                         
##  [3] &quot;\\usepackage[urlcolor=blue]{hyperref}&quot;                                                                                                                  
##  [4] &quot;\\begin{document}&quot;                                                                                                                                      
##  [5] &quot;\\title{A Latex Testing File}&quot;                                                                                                                          
##  [6] &quot;\\author{\\href{http://fanwangecon.github.io/}{Fan Wang} \\thanks{See information \\href{https://fanwangecon.github.io/Tex4Econ/}{Tex4Econ} for more.}}&quot;
##  [7] &quot;\\maketitle&quot;                                                                                                                                            
##  [8] &quot;Ipsum information dolor sit amet, consectetur adipiscing elit. Integer Latex placerat nunc orci.&quot;                                                       
##  [9] &quot;\\paragraph{\\href{https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3140132}{Data}}&quot;                                                                 
## [10] &quot;Village closure information is taken from a village head survey.\\footnote{Generally students went to schools.}&quot;                                        
## [11] &quot;output:&quot;                                                                                                                                                
## [12] &quot;  pdf_document:&quot;                                                                                                                                        
## [13] &quot;    pandoc_args: &#39;..//..//_output_kniti_pdf.yaml&#39;&quot;                                                                                                      
## [14] &quot;    includes:&quot;                                                                                                                                          
## [15] &quot;      in_header: &#39;..//..//preamble.tex&#39;&quot;                                                                                                                
## [16] &quot;  html_document:&quot;                                                                                                                                       
## [17] &quot;    pandoc_args: &#39;..//..//_output_kniti_html.yaml&#39;&quot;                                                                                                     
## [18] &quot;    includes:&quot;                                                                                                                                          
## [19] &quot;      in_header: &#39;..//..//hdga.html&#39;&quot;                                                                                                                   
## [20] &quot;\\end{document}&quot;</code></pre>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="coding-and-development.html#cb900-1" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span></code></pre></div>
</div>
<div id="open-a-file-and-replace-some-lines" class="section level4 hasAnchor" number="12.2.2.4">
<h4><span class="header-section-number">12.2.2.4</span> Open a File and Replace Some Lines<a href="coding-and-development.html#open-a-file-and-replace-some-lines" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Append additional strings into the file after <em>html_document</em> with proper spacings:</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="coding-and-development.html#cb901-1" tabindex="-1"></a><span class="co"># Read in Lines from existing file</span></span>
<span id="cb901-2"><a href="coding-and-development.html#cb901-2" tabindex="-1"></a>fileConn <span class="ot">&lt;-</span> <span class="fu">file</span>(fl_test_tex, <span class="st">&quot;r&quot;</span>)</span>
<span id="cb901-3"><a href="coding-and-development.html#cb901-3" tabindex="-1"></a>st_file_read <span class="ot">&lt;-</span> <span class="fu">readLines</span>(fileConn)</span>
<span id="cb901-4"><a href="coding-and-development.html#cb901-4" tabindex="-1"></a><span class="fu">close</span>(fileConn)</span>
<span id="cb901-5"><a href="coding-and-development.html#cb901-5" tabindex="-1"></a></span>
<span id="cb901-6"><a href="coding-and-development.html#cb901-6" tabindex="-1"></a><span class="co"># Search and Replace String</span></span>
<span id="cb901-7"><a href="coding-and-development.html#cb901-7" tabindex="-1"></a>st_search <span class="ot">&lt;-</span> <span class="st">&quot;html_document:&quot;</span></span>
<span id="cb901-8"><a href="coding-and-development.html#cb901-8" tabindex="-1"></a>st_replace <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;html_document:</span><span class="sc">\r\n</span><span class="st">&quot;</span>,</span>
<span id="cb901-9"><a href="coding-and-development.html#cb901-9" tabindex="-1"></a>                     <span class="st">&quot;    toc: true</span><span class="sc">\r\n</span><span class="st">&quot;</span>,</span>
<span id="cb901-10"><a href="coding-and-development.html#cb901-10" tabindex="-1"></a>                     <span class="st">&quot;    number_sections: true</span><span class="sc">\r\n</span><span class="st">&quot;</span>,</span>
<span id="cb901-11"><a href="coding-and-development.html#cb901-11" tabindex="-1"></a>                     <span class="st">&quot;    toc_float:</span><span class="sc">\r\n</span><span class="st">&quot;</span>,</span>
<span id="cb901-12"><a href="coding-and-development.html#cb901-12" tabindex="-1"></a>                     <span class="st">&quot;      collapsed: false</span><span class="sc">\r\n</span><span class="st">&quot;</span>,</span>
<span id="cb901-13"><a href="coding-and-development.html#cb901-13" tabindex="-1"></a>                     <span class="st">&quot;      smooth_scroll: false</span><span class="sc">\r\n</span><span class="st">&quot;</span>,</span>
<span id="cb901-14"><a href="coding-and-development.html#cb901-14" tabindex="-1"></a>                     <span class="st">&quot;      toc_depth: 3&quot;</span>)</span>
<span id="cb901-15"><a href="coding-and-development.html#cb901-15" tabindex="-1"></a></span>
<span id="cb901-16"><a href="coding-and-development.html#cb901-16" tabindex="-1"></a><span class="co"># Search and Replace</span></span>
<span id="cb901-17"><a href="coding-and-development.html#cb901-17" tabindex="-1"></a>st_file_updated <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> st_file_read,</span>
<span id="cb901-18"><a href="coding-and-development.html#cb901-18" tabindex="-1"></a>                        <span class="at">pattern =</span> st_search,</span>
<span id="cb901-19"><a href="coding-and-development.html#cb901-19" tabindex="-1"></a>                        <span class="at">replacement =</span> st_replace)</span>
<span id="cb901-20"><a href="coding-and-development.html#cb901-20" tabindex="-1"></a></span>
<span id="cb901-21"><a href="coding-and-development.html#cb901-21" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb901-22"><a href="coding-and-development.html#cb901-22" tabindex="-1"></a><span class="fu">print</span>(st_file_updated)</span></code></pre></div>
<pre><code>##  [1] &quot;\\documentclass[12pt,english]{article}&quot;                                                                                                                        
##  [2] &quot;\\usepackage[bottom]{footmisc}&quot;                                                                                                                                
##  [3] &quot;\\usepackage[urlcolor=blue]{hyperref}&quot;                                                                                                                         
##  [4] &quot;\\begin{document}&quot;                                                                                                                                             
##  [5] &quot;\\title{A Latex Testing File}&quot;                                                                                                                                 
##  [6] &quot;\\author{\\href{http://fanwangecon.github.io/}{Fan Wang} \\thanks{See information \\href{https://fanwangecon.github.io/Tex4Econ/}{Tex4Econ} for more.}}&quot;       
##  [7] &quot;\\maketitle&quot;                                                                                                                                                   
##  [8] &quot;Ipsum information dolor sit amet, consectetur adipiscing elit. Integer Latex placerat nunc orci.&quot;                                                              
##  [9] &quot;\\paragraph{\\href{https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3140132}{Data}}&quot;                                                                        
## [10] &quot;Village closure information is taken from a village head survey.\\footnote{Generally students went to schools.}&quot;                                               
## [11] &quot;output:&quot;                                                                                                                                                       
## [12] &quot;  pdf_document:&quot;                                                                                                                                               
## [13] &quot;    pandoc_args: &#39;..//..//_output_kniti_pdf.yaml&#39;&quot;                                                                                                             
## [14] &quot;    includes:&quot;                                                                                                                                                 
## [15] &quot;      in_header: &#39;..//..//preamble.tex&#39;&quot;                                                                                                                       
## [16] &quot;  html_document:\r\n    toc: true\r\n    number_sections: true\r\n    toc_float:\r\n      collapsed: false\r\n      smooth_scroll: false\r\n      toc_depth: 3&quot;
## [17] &quot;    pandoc_args: &#39;..//..//_output_kniti_html.yaml&#39;&quot;                                                                                                            
## [18] &quot;    includes:&quot;                                                                                                                                                 
## [19] &quot;      in_header: &#39;..//..//hdga.html&#39;&quot;                                                                                                                          
## [20] &quot;\\end{document}&quot;</code></pre>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="coding-and-development.html#cb903-1" tabindex="-1"></a><span class="co"># Save Updated File</span></span>
<span id="cb903-2"><a href="coding-and-development.html#cb903-2" tabindex="-1"></a>fl_srcrep_tex <span class="ot">&lt;-</span> <span class="st">&quot;_file/tex/test_fan_search_replace.tex&quot;</span></span>
<span id="cb903-3"><a href="coding-and-development.html#cb903-3" tabindex="-1"></a>fileConn_sr <span class="ot">&lt;-</span> <span class="fu">file</span>(fl_srcrep_tex)</span>
<span id="cb903-4"><a href="coding-and-development.html#cb903-4" tabindex="-1"></a><span class="fu">writeLines</span>(st_file_updated, fileConn_sr)</span>
<span id="cb903-5"><a href="coding-and-development.html#cb903-5" tabindex="-1"></a><span class="fu">close</span>(fileConn_sr)</span></code></pre></div>

</div>
</div>
<div id="rmd-to-html" class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> Rmd to HTML<a href="coding-and-development.html#rmd-to-html" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="search-and-find-all-files-in-repository" class="section level4 hasAnchor" number="12.2.3.1">
<h4><span class="header-section-number">12.2.3.1</span> Search and Find all Files in Repository<a href="coding-and-development.html#search-and-find-all-files-in-repository" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Search inside directories, for all files in a repository that have a particular suffix and that don’t contain skip pattern list string items.</p>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="coding-and-development.html#cb904-1" tabindex="-1"></a><span class="co"># Serch Folder and skip list</span></span>
<span id="cb904-2"><a href="coding-and-development.html#cb904-2" tabindex="-1"></a>spt_roots <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;C:/Users/fan/R4Econ/amto&#39;</span>, <span class="st">&#39;C:/Users/fan/R4Econ/summarize&#39;</span>)</span>
<span id="cb904-3"><a href="coding-and-development.html#cb904-3" tabindex="-1"></a>spn_skip <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;summarize&#39;</span>, <span class="st">&#39;panel&#39;</span>, <span class="st">&#39;support&#39;</span>)</span>
<span id="cb904-4"><a href="coding-and-development.html#cb904-4" tabindex="-1"></a></span>
<span id="cb904-5"><a href="coding-and-development.html#cb904-5" tabindex="-1"></a><span class="co"># Search and get all Path</span></span>
<span id="cb904-6"><a href="coding-and-development.html#cb904-6" tabindex="-1"></a>ls_sfls <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path=</span>spt_roots, <span class="at">recursive=</span>T, <span class="at">pattern=</span><span class="st">&quot;.Rmd&quot;</span>, <span class="at">full.names=</span>T)</span>
<span id="cb904-7"><a href="coding-and-development.html#cb904-7" tabindex="-1"></a></span>
<span id="cb904-8"><a href="coding-and-development.html#cb904-8" tabindex="-1"></a><span class="co"># Skip path if contains words in skip list</span></span>
<span id="cb904-9"><a href="coding-and-development.html#cb904-9" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">missing</span>(spn_skip)) {</span>
<span id="cb904-10"><a href="coding-and-development.html#cb904-10" tabindex="-1"></a>  ls_sfls <span class="ot">&lt;-</span> ls_sfls[<span class="sc">!</span><span class="fu">grepl</span>(<span class="fu">paste</span>(spn_skip, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>), ls_sfls)]</span>
<span id="cb904-11"><a href="coding-and-development.html#cb904-11" tabindex="-1"></a>}</span>
<span id="cb904-12"><a href="coding-and-development.html#cb904-12" tabindex="-1"></a></span>
<span id="cb904-13"><a href="coding-and-development.html#cb904-13" tabindex="-1"></a><span class="co"># Loop and print</span></span>
<span id="cb904-14"><a href="coding-and-development.html#cb904-14" tabindex="-1"></a><span class="cf">for</span> (spt_file <span class="cf">in</span> ls_sfls) {</span>
<span id="cb904-15"><a href="coding-and-development.html#cb904-15" tabindex="-1"></a>    st_fullpath_nosufx <span class="ot">&lt;-</span> <span class="fu">tail</span>(<span class="fu">strsplit</span>(spt_file, <span class="st">&quot;/&quot;</span>)[[<span class="dv">1</span>]],<span class="at">n=</span><span class="dv">1</span>)</span>
<span id="cb904-16"><a href="coding-and-development.html#cb904-16" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(spt_file, <span class="st">&#39;---&#39;</span>, st_fullpath_nosufx))</span>
<span id="cb904-17"><a href="coding-and-development.html#cb904-17" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/fan/R4Econ/amto/array/fs_ary_basics.Rmd---fs_ary_basics.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/array/fs_ary_generate.Rmd---fs_ary_generate.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/array/fs_ary_mesh.Rmd---fs_ary_mesh.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/array/fs_ary_string.Rmd---fs_ary_string.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/array/main.Rmd---main.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/list/fs_lst_basics.Rmd---fs_lst_basics.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/list/main.Rmd---main.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/main.Rmd---main.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/matrix/fs_mat_demo_trans.Rmd---fs_mat_demo_trans.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/matrix/fs_mat_generate.Rmd---fs_mat_generate.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/matrix/fs_mat_linear_algebra.Rmd---fs_mat_linear_algebra.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/matrix/main.Rmd---main.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/misc/fs_parse_regex.Rmd---fs_parse_regex.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/misc/main.Rmd---main.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/tibble/fs_tib_basics.Rmd---fs_tib_basics.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/tibble/fs_tib_factors.Rmd---fs_tib_factors.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/tibble/fs_tib_na.Rmd---fs_tib_na.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/tibble/fs_tib_random_draws.Rmd---fs_tib_random_draws.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/tibble/fs_tib_string.Rmd---fs_tib_string.Rmd&quot;
## [1] &quot;C:/Users/fan/R4Econ/amto/tibble/main.Rmd---main.Rmd&quot;</code></pre>
</div>
<div id="search-and-find-all-git-modified-or-new-rmd" class="section level4 hasAnchor" number="12.2.3.2">
<h4><span class="header-section-number">12.2.3.2</span> Search and Find all Git Modified or New Rmd<a href="coding-and-development.html#search-and-find-all-git-modified-or-new-rmd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Search inside directories, for all files in a git repo folder that are new or have been modified. Ignore possible subset of file based on string search.</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="coding-and-development.html#cb906-1" tabindex="-1"></a><span class="co"># Serch Folder and skip list</span></span>
<span id="cb906-2"><a href="coding-and-development.html#cb906-2" tabindex="-1"></a>spt_roots <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;C:/Users/fan/R4Econ/amto&#39;</span>, <span class="st">&#39;C:/Users/fan/R4Econ/development&#39;</span>)</span>
<span id="cb906-3"><a href="coding-and-development.html#cb906-3" tabindex="-1"></a>spn_skip <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;summarize&#39;</span>, <span class="st">&#39;panel&#39;</span>, <span class="st">&#39;support&#39;</span>)</span>
<span id="cb906-4"><a href="coding-and-development.html#cb906-4" tabindex="-1"></a>ls_sfls <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path=</span>spt_roots, <span class="at">recursive=</span>T, <span class="at">pattern=</span><span class="st">&quot;.Rmd&quot;</span>, <span class="at">full.names=</span>T)</span>
<span id="cb906-5"><a href="coding-and-development.html#cb906-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">missing</span>(spn_skip)) {</span>
<span id="cb906-6"><a href="coding-and-development.html#cb906-6" tabindex="-1"></a>  ls_sfls <span class="ot">&lt;-</span> ls_sfls[<span class="sc">!</span><span class="fu">grepl</span>(<span class="fu">paste</span>(spn_skip, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>), ls_sfls)]</span>
<span id="cb906-7"><a href="coding-and-development.html#cb906-7" tabindex="-1"></a>}</span>
<span id="cb906-8"><a href="coding-and-development.html#cb906-8" tabindex="-1"></a></span>
<span id="cb906-9"><a href="coding-and-development.html#cb906-9" tabindex="-1"></a><span class="co"># Loop and print</span></span>
<span id="cb906-10"><a href="coding-and-development.html#cb906-10" tabindex="-1"></a><span class="cf">for</span> (spt_file <span class="cf">in</span> ls_sfls) {</span>
<span id="cb906-11"><a href="coding-and-development.html#cb906-11" tabindex="-1"></a>  spg_check_git_status <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;git status -s &#39;</span>, spt_file)</span>
<span id="cb906-12"><a href="coding-and-development.html#cb906-12" tabindex="-1"></a>  st_git_status <span class="ot">&lt;-</span> <span class="fu">toString</span>(<span class="fu">system</span>(spg_check_git_status, <span class="at">intern=</span><span class="cn">TRUE</span>))</span>
<span id="cb906-13"><a href="coding-and-development.html#cb906-13" tabindex="-1"></a>  bl_modified <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">&#39; M &#39;</span>, st_git_status, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb906-14"><a href="coding-and-development.html#cb906-14" tabindex="-1"></a>  bl_anewfile <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">&#39;?? &#39;</span>, st_git_status, <span class="at">fixed=</span><span class="cn">TRUE</span>)</span>
<span id="cb906-15"><a href="coding-and-development.html#cb906-15" tabindex="-1"></a>  bl_nochange <span class="ot">&lt;-</span> (st_git_status <span class="sc">==</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb906-16"><a href="coding-and-development.html#cb906-16" tabindex="-1"></a></span>
<span id="cb906-17"><a href="coding-and-development.html#cb906-17" tabindex="-1"></a>  <span class="cf">if</span> (bl_modified <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb906-18"><a href="coding-and-development.html#cb906-18" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;MODIFIED: &#39;</span>, spt_file))</span>
<span id="cb906-19"><a href="coding-and-development.html#cb906-19" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (bl_anewfile <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb906-20"><a href="coding-and-development.html#cb906-20" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;A NEW FL: &#39;</span>, spt_file))</span>
<span id="cb906-21"><a href="coding-and-development.html#cb906-21" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb906-22"><a href="coding-and-development.html#cb906-22" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;NO CHNGE: &#39;</span>, spt_file))</span>
<span id="cb906-23"><a href="coding-and-development.html#cb906-23" tabindex="-1"></a>  }</span>
<span id="cb906-24"><a href="coding-and-development.html#cb906-24" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/array/fs_ary_basics.Rmd&quot;
## [1] &quot;MODIFIED: C:/Users/fan/R4Econ/amto/array/fs_ary_generate.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/array/fs_ary_mesh.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/array/fs_ary_string.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/array/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/list/fs_lst_basics.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/list/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/matrix/fs_mat_demo_trans.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/matrix/fs_mat_generate.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/matrix/fs_mat_linear_algebra.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/matrix/main.Rmd&quot;
## [1] &quot;MODIFIED: C:/Users/fan/R4Econ/amto/misc/fs_parse_regex.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/misc/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/tibble/fs_tib_basics.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/tibble/fs_tib_factors.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/tibble/fs_tib_na.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/tibble/fs_tib_random_draws.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/tibble/fs_tib_string.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/amto/tibble/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/_file/rmd/fs_rmd_pdf_html_mod.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/_file/rmd/fs_rmd_pdf_html_mod_mod.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/_file/rmd/fs_text_save_mod.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/_file/rmd/main_mod.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/fs_path.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/fs_rmd_pdf_html.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/fs_text_save.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/inout/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/install/fs_install_R.Rmd&quot;
## [1] &quot;A NEW FL: C:/Users/fan/R4Econ/development/install/fs_packages_R.Rmd&quot;
## [1] &quot;MODIFIED: C:/Users/fan/R4Econ/development/install/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/main.Rmd&quot;
## [1] &quot;MODIFIED: C:/Users/fan/R4Econ/development/parallel/fs_parallel.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/parallel/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/python/fs_python_reticulate.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/python/main.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/system/fs_system_shell.Rmd&quot;
## [1] &quot;NO CHNGE: C:/Users/fan/R4Econ/development/system/main.Rmd&quot;</code></pre>
</div>
<div id="resave-an-existing-file-with-different-name-different-folder" class="section level4 hasAnchor" number="12.2.3.3">
<h4><span class="header-section-number">12.2.3.3</span> Resave an Existing File with Different Name Different Folder<a href="coding-and-development.html#resave-an-existing-file-with-different-name-different-folder" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given an existing Rmd File, Resave it with a different name (add to name suffix), and then save in a different folder:</p>
<ul>
<li>old file: <em>/R4Econ/development/fs_rmd_pdf_html.Rmd</em></li>
<li>new file: *R4Econ/development/inout/_file/rmd/fs_rmd_pdf_html_mod.Rmd*</li>
</ul>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="coding-and-development.html#cb908-1" tabindex="-1"></a><span class="co"># Serch Folder and skip list</span></span>
<span id="cb908-2"><a href="coding-and-development.html#cb908-2" tabindex="-1"></a>spt_roots <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;C:/Users/fan/R4Econ/development/inout/&#39;</span>)</span>
<span id="cb908-3"><a href="coding-and-development.html#cb908-3" tabindex="-1"></a>spn_skip <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;_main&#39;</span>, <span class="st">&#39;_file&#39;</span>)</span>
<span id="cb908-4"><a href="coding-and-development.html#cb908-4" tabindex="-1"></a>ls_sfls <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path=</span>spt_roots, <span class="at">recursive=</span>T, <span class="at">pattern=</span><span class="st">&quot;.Rmd&quot;</span>, <span class="at">full.names=</span>T)</span>
<span id="cb908-5"><a href="coding-and-development.html#cb908-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">missing</span>(spn_skip)) {</span>
<span id="cb908-6"><a href="coding-and-development.html#cb908-6" tabindex="-1"></a>  ls_sfls <span class="ot">&lt;-</span> ls_sfls[<span class="sc">!</span><span class="fu">grepl</span>(<span class="fu">paste</span>(spn_skip, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>), ls_sfls)]</span>
<span id="cb908-7"><a href="coding-and-development.html#cb908-7" tabindex="-1"></a>}</span>
<span id="cb908-8"><a href="coding-and-development.html#cb908-8" tabindex="-1"></a></span>
<span id="cb908-9"><a href="coding-and-development.html#cb908-9" tabindex="-1"></a><span class="co"># Loop and print</span></span>
<span id="cb908-10"><a href="coding-and-development.html#cb908-10" tabindex="-1"></a><span class="cf">for</span> (spt_file <span class="cf">in</span> ls_sfls) {</span>
<span id="cb908-11"><a href="coding-and-development.html#cb908-11" tabindex="-1"></a>  spt_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;_file/rmd/&#39;</span>)</span>
<span id="cb908-12"><a href="coding-and-development.html#cb908-12" tabindex="-1"></a>  spn_new <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_new, <span class="fu">sub</span>(<span class="st">&#39;</span><span class="sc">\\</span><span class="st">.Rmd$&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="fu">basename</span>(spt_file)), <span class="st">&#39;_mod.Rmd&#39;</span>)</span>
<span id="cb908-13"><a href="coding-and-development.html#cb908-13" tabindex="-1"></a>  <span class="fu">print</span>(spt_new)</span>
<span id="cb908-14"><a href="coding-and-development.html#cb908-14" tabindex="-1"></a>  <span class="fu">print</span>(spn_new)</span>
<span id="cb908-15"><a href="coding-and-development.html#cb908-15" tabindex="-1"></a></span>
<span id="cb908-16"><a href="coding-and-development.html#cb908-16" tabindex="-1"></a>  fileConn_rd <span class="ot">&lt;-</span> <span class="fu">file</span>(spt_file, <span class="st">&quot;r&quot;</span>)</span>
<span id="cb908-17"><a href="coding-and-development.html#cb908-17" tabindex="-1"></a>  st_file_read <span class="ot">&lt;-</span> <span class="fu">readLines</span>(fileConn_rd)</span>
<span id="cb908-18"><a href="coding-and-development.html#cb908-18" tabindex="-1"></a></span>
<span id="cb908-19"><a href="coding-and-development.html#cb908-19" tabindex="-1"></a>  fileConn_sr <span class="ot">&lt;-</span> <span class="fu">file</span>(spn_new)</span>
<span id="cb908-20"><a href="coding-and-development.html#cb908-20" tabindex="-1"></a>  <span class="fu">writeLines</span>(st_file_read, fileConn_sr)</span>
<span id="cb908-21"><a href="coding-and-development.html#cb908-21" tabindex="-1"></a></span>
<span id="cb908-22"><a href="coding-and-development.html#cb908-22" tabindex="-1"></a>  <span class="fu">close</span>(fileConn_rd)</span>
<span id="cb908-23"><a href="coding-and-development.html#cb908-23" tabindex="-1"></a>  <span class="fu">close</span>(fileConn_sr)</span>
<span id="cb908-24"><a href="coding-and-development.html#cb908-24" tabindex="-1"></a>}</span></code></pre></div>
<div id="replacment-function-change-markdown-hierarchy-and-add-to-yaml" class="section level5 hasAnchor" number="12.2.3.3.1">
<h5><span class="header-section-number">12.2.3.3.1</span> Replacment Function Change Markdown Hierarchy and Add to YAML<a href="coding-and-development.html#replacment-function-change-markdown-hierarchy-and-add-to-yaml" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Given an existing Rmd File, Resave it with a different name, and replace (add in) additional yaml contents.</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="coding-and-development.html#cb909-1" tabindex="-1"></a>spn_file <span class="ot">=</span> <span class="st">&#39;_file/rmd/fs_rmd_pdf_html_mod.Rmd&#39;</span></span>
<span id="cb909-2"><a href="coding-and-development.html#cb909-2" tabindex="-1"></a>fileConn_sr <span class="ot">&lt;-</span> <span class="fu">file</span>(spn_file)</span>
<span id="cb909-3"><a href="coding-and-development.html#cb909-3" tabindex="-1"></a>st_file <span class="ot">&lt;-</span> <span class="fu">readLines</span>(fileConn_sr)</span>
<span id="cb909-4"><a href="coding-and-development.html#cb909-4" tabindex="-1"></a><span class="co"># print(st_file)</span></span>
<span id="cb909-5"><a href="coding-and-development.html#cb909-5" tabindex="-1"></a></span>
<span id="cb909-6"><a href="coding-and-development.html#cb909-6" tabindex="-1"></a>st_search <span class="ot">&lt;-</span> <span class="st">&quot;html_document:</span></span>
<span id="cb909-7"><a href="coding-and-development.html#cb909-7" tabindex="-1"></a><span class="st">    toc: true</span></span>
<span id="cb909-8"><a href="coding-and-development.html#cb909-8" tabindex="-1"></a><span class="st">    number_sections: true</span></span>
<span id="cb909-9"><a href="coding-and-development.html#cb909-9" tabindex="-1"></a><span class="st">    toc_float:</span></span>
<span id="cb909-10"><a href="coding-and-development.html#cb909-10" tabindex="-1"></a><span class="st">      collapsed: false</span></span>
<span id="cb909-11"><a href="coding-and-development.html#cb909-11" tabindex="-1"></a><span class="st">      smooth_scroll: false</span></span>
<span id="cb909-12"><a href="coding-and-development.html#cb909-12" tabindex="-1"></a><span class="st">      toc_depth: 3&quot;</span></span>
<span id="cb909-13"><a href="coding-and-development.html#cb909-13" tabindex="-1"></a>st_replace <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;html_document:</span></span>
<span id="cb909-14"><a href="coding-and-development.html#cb909-14" tabindex="-1"></a><span class="st">    toc: true</span></span>
<span id="cb909-15"><a href="coding-and-development.html#cb909-15" tabindex="-1"></a><span class="st">    number_sections: true</span></span>
<span id="cb909-16"><a href="coding-and-development.html#cb909-16" tabindex="-1"></a><span class="st">    toc_float:</span></span>
<span id="cb909-17"><a href="coding-and-development.html#cb909-17" tabindex="-1"></a><span class="st">      collapsed: false</span></span>
<span id="cb909-18"><a href="coding-and-development.html#cb909-18" tabindex="-1"></a><span class="st">      smooth_scroll: false</span></span>
<span id="cb909-19"><a href="coding-and-development.html#cb909-19" tabindex="-1"></a><span class="st">      toc_depth: 3</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb909-20"><a href="coding-and-development.html#cb909-20" tabindex="-1"></a>                     <span class="st">&quot;    toc: true</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb909-21"><a href="coding-and-development.html#cb909-21" tabindex="-1"></a>                     <span class="st">&quot;    number_sections: true</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb909-22"><a href="coding-and-development.html#cb909-22" tabindex="-1"></a>                     <span class="st">&quot;    toc_float:</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb909-23"><a href="coding-and-development.html#cb909-23" tabindex="-1"></a>                     <span class="st">&quot;      collapsed: false</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb909-24"><a href="coding-and-development.html#cb909-24" tabindex="-1"></a>                     <span class="st">&quot;      smooth_scroll: false</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb909-25"><a href="coding-and-development.html#cb909-25" tabindex="-1"></a>                     <span class="st">&quot;      toc_depth: 3&quot;</span>)</span>
<span id="cb909-26"><a href="coding-and-development.html#cb909-26" tabindex="-1"></a>st_file_updated <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> st_file,</span>
<span id="cb909-27"><a href="coding-and-development.html#cb909-27" tabindex="-1"></a>                        <span class="at">pattern =</span> st_search,</span>
<span id="cb909-28"><a href="coding-and-development.html#cb909-28" tabindex="-1"></a>                        <span class="at">replacement =</span> st_replace)</span>
<span id="cb909-29"><a href="coding-and-development.html#cb909-29" tabindex="-1"></a></span>
<span id="cb909-30"><a href="coding-and-development.html#cb909-30" tabindex="-1"></a>st_search <span class="ot">&lt;-</span> <span class="st">&quot;../../&quot;</span></span>
<span id="cb909-31"><a href="coding-and-development.html#cb909-31" tabindex="-1"></a>st_replace <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;../../../../&quot;</span>)</span>
<span id="cb909-32"><a href="coding-and-development.html#cb909-32" tabindex="-1"></a>st_file_updated <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> st_file_updated,</span>
<span id="cb909-33"><a href="coding-and-development.html#cb909-33" tabindex="-1"></a>                        <span class="at">pattern =</span> st_search,</span>
<span id="cb909-34"><a href="coding-and-development.html#cb909-34" tabindex="-1"></a>                        <span class="at">replacement =</span> st_replace)</span>
<span id="cb909-35"><a href="coding-and-development.html#cb909-35" tabindex="-1"></a></span>
<span id="cb909-36"><a href="coding-and-development.html#cb909-36" tabindex="-1"></a>st_file_updated <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> st_file_updated, <span class="at">pattern =</span> <span class="st">&#39;# &#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;# &#39;</span>)</span>
<span id="cb909-37"><a href="coding-and-development.html#cb909-37" tabindex="-1"></a>st_file_updated <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> st_file_updated, <span class="at">pattern =</span> <span class="st">&#39;## &#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;## &#39;</span>)</span>
<span id="cb909-38"><a href="coding-and-development.html#cb909-38" tabindex="-1"></a>st_file_updated <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">x =</span> st_file_updated, <span class="at">pattern =</span> <span class="st">&#39;### &#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;# &#39;</span>)</span>
<span id="cb909-39"><a href="coding-and-development.html#cb909-39" tabindex="-1"></a></span>
<span id="cb909-40"><a href="coding-and-development.html#cb909-40" tabindex="-1"></a>spn_file <span class="ot">=</span> <span class="st">&#39;_file/rmd/fs_rmd_pdf_html_mod.Rmd&#39;</span></span>
<span id="cb909-41"><a href="coding-and-development.html#cb909-41" tabindex="-1"></a>fileConn_sr <span class="ot">&lt;-</span> <span class="fu">file</span>(spn_file)</span>
<span id="cb909-42"><a href="coding-and-development.html#cb909-42" tabindex="-1"></a>st_file <span class="ot">&lt;-</span> <span class="fu">writeLines</span>(st_file_updated, fileConn_sr)</span></code></pre></div>
</div>
</div>
<div id="search-and-render-rmd-file-and-save-html-pdf-or-r" class="section level4 hasAnchor" number="12.2.3.4">
<h4><span class="header-section-number">12.2.3.4</span> Search and Render Rmd File and Save HTML, PDF or R<a href="coding-and-development.html#search-and-render-rmd-file-and-save-html-pdf-or-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Search files satisfying conditions in a folder</li>
<li>knit files to HTML (and re-run the contents of the file)</li>
<li>Save output to a different folder</li>
</ol>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="coding-and-development.html#cb910-1" tabindex="-1"></a><span class="co"># Specify Parameters</span></span>
<span id="cb910-2"><a href="coding-and-development.html#cb910-2" tabindex="-1"></a>ar_spt_root <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;C:/Users/fan/R4Econ/amto/array/&#39;</span>, <span class="st">&#39;C:/Users/fan/R4Econ/math/integration&#39;</span>)</span>
<span id="cb910-3"><a href="coding-and-development.html#cb910-3" tabindex="-1"></a>bl_recursive <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb910-4"><a href="coding-and-development.html#cb910-4" tabindex="-1"></a>st_rmd_suffix_pattern <span class="ot">=</span> <span class="st">&quot;*.Rmd&quot;</span></span>
<span id="cb910-5"><a href="coding-and-development.html#cb910-5" tabindex="-1"></a>ar_spn_skip <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;basics&#39;</span>, <span class="st">&#39;integrate&#39;</span>, <span class="st">&#39;main&#39;</span>, <span class="st">&#39;mesh&#39;</span>)</span>
<span id="cb910-6"><a href="coding-and-development.html#cb910-6" tabindex="-1"></a>ls_bool_convert <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">bl_pdf=</span><span class="cn">TRUE</span>, <span class="at">bl_html=</span><span class="cn">TRUE</span>, <span class="at">bl_R=</span><span class="cn">TRUE</span>)</span>
<span id="cb910-7"><a href="coding-and-development.html#cb910-7" tabindex="-1"></a>spt_out_directory <span class="ot">&lt;-</span> <span class="st">&#39;C:/Users/fan/Downloads/_data&#39;</span></span>
<span id="cb910-8"><a href="coding-and-development.html#cb910-8" tabindex="-1"></a>bl_verbose <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb910-9"><a href="coding-and-development.html#cb910-9" tabindex="-1"></a></span>
<span id="cb910-10"><a href="coding-and-development.html#cb910-10" tabindex="-1"></a><span class="co"># Get Path</span></span>
<span id="cb910-11"><a href="coding-and-development.html#cb910-11" tabindex="-1"></a>ls_sfls  <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path=</span>ar_spt_root,</span>
<span id="cb910-12"><a href="coding-and-development.html#cb910-12" tabindex="-1"></a>                       <span class="at">recursive=</span>bl_recursive,</span>
<span id="cb910-13"><a href="coding-and-development.html#cb910-13" tabindex="-1"></a>                       <span class="at">pattern=</span>st_rmd_suffix_pattern,</span>
<span id="cb910-14"><a href="coding-and-development.html#cb910-14" tabindex="-1"></a>                       <span class="at">full.names=</span>T)</span>
<span id="cb910-15"><a href="coding-and-development.html#cb910-15" tabindex="-1"></a></span>
<span id="cb910-16"><a href="coding-and-development.html#cb910-16" tabindex="-1"></a><span class="co"># Exclude Some Files given ar_spn_skip</span></span>
<span id="cb910-17"><a href="coding-and-development.html#cb910-17" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">missing</span>(ar_spn_skip)) {</span>
<span id="cb910-18"><a href="coding-and-development.html#cb910-18" tabindex="-1"></a>  ls_sfls <span class="ot">&lt;-</span> ls_sfls[<span class="sc">!</span><span class="fu">grepl</span>(<span class="fu">paste</span>(ar_spn_skip, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>), ls_sfls)]</span>
<span id="cb910-19"><a href="coding-and-development.html#cb910-19" tabindex="-1"></a>}</span>
<span id="cb910-20"><a href="coding-and-development.html#cb910-20" tabindex="-1"></a></span>
<span id="cb910-21"><a href="coding-and-development.html#cb910-21" tabindex="-1"></a><span class="co"># Loop over files</span></span>
<span id="cb910-22"><a href="coding-and-development.html#cb910-22" tabindex="-1"></a><span class="cf">for</span> (spn_file <span class="cf">in</span> ls_sfls) {</span>
<span id="cb910-23"><a href="coding-and-development.html#cb910-23" tabindex="-1"></a></span>
<span id="cb910-24"><a href="coding-and-development.html#cb910-24" tabindex="-1"></a>  <span class="co"># Parse File Name</span></span>
<span id="cb910-25"><a href="coding-and-development.html#cb910-25" tabindex="-1"></a>  spt_file <span class="ot">&lt;-</span> <span class="fu">dirname</span>(spn_file)</span>
<span id="cb910-26"><a href="coding-and-development.html#cb910-26" tabindex="-1"></a>  sna_file <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>(<span class="fu">basename</span>(spn_file))</span>
<span id="cb910-27"><a href="coding-and-development.html#cb910-27" tabindex="-1"></a></span>
<span id="cb910-28"><a href="coding-and-development.html#cb910-28" tabindex="-1"></a>  <span class="co"># Output FIles</span></span>
<span id="cb910-29"><a href="coding-and-development.html#cb910-29" tabindex="-1"></a>  spn_file_pdf <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_file, sna_file, <span class="st">&#39;.pdf&#39;</span>)</span>
<span id="cb910-30"><a href="coding-and-development.html#cb910-30" tabindex="-1"></a>  spn_file_html <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_file, sna_file, <span class="st">&#39;.html&#39;</span>)</span>
<span id="cb910-31"><a href="coding-and-development.html#cb910-31" tabindex="-1"></a>  spn_file_R <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_file, sna_file, <span class="st">&#39;.R&#39;</span>)</span>
<span id="cb910-32"><a href="coding-and-development.html#cb910-32" tabindex="-1"></a></span>
<span id="cb910-33"><a href="coding-and-development.html#cb910-33" tabindex="-1"></a>  <span class="co"># render to PDF</span></span>
<span id="cb910-34"><a href="coding-and-development.html#cb910-34" tabindex="-1"></a>  <span class="cf">if</span> (ls_bool_convert<span class="sc">$</span>bl_pdf) {</span>
<span id="cb910-35"><a href="coding-and-development.html#cb910-35" tabindex="-1"></a>    <span class="cf">if</span> (bl_verbose) <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&#39;spn_file_pdf:&#39;</span>,spn_file_pdf, <span class="st">&#39;, PDF started&#39;</span>))</span>
<span id="cb910-36"><a href="coding-and-development.html#cb910-36" tabindex="-1"></a>    rmarkdown<span class="sc">::</span><span class="fu">render</span>(spn_file, <span class="at">output_format=</span><span class="st">&#39;pdf_document&#39;</span>,</span>
<span id="cb910-37"><a href="coding-and-development.html#cb910-37" tabindex="-1"></a>                      <span class="at">output_dir =</span> spt_out_directory, <span class="at">output_file =</span> sna_file)</span>
<span id="cb910-38"><a href="coding-and-development.html#cb910-38" tabindex="-1"></a>    <span class="cf">if</span> (bl_verbose) <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&#39;spn_file_pdf:&#39;</span>,spn_file_pdf, <span class="st">&#39;, PDF finished&#39;</span>))</span>
<span id="cb910-39"><a href="coding-and-development.html#cb910-39" tabindex="-1"></a>    spn_pdf_generated <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_out_directory, <span class="st">&#39;/&#39;</span>, spn_file_pdf)</span>
<span id="cb910-40"><a href="coding-and-development.html#cb910-40" tabindex="-1"></a>  }</span>
<span id="cb910-41"><a href="coding-and-development.html#cb910-41" tabindex="-1"></a></span>
<span id="cb910-42"><a href="coding-and-development.html#cb910-42" tabindex="-1"></a>  <span class="co"># render to HTML</span></span>
<span id="cb910-43"><a href="coding-and-development.html#cb910-43" tabindex="-1"></a>  <span class="cf">if</span> (ls_bool_convert<span class="sc">$</span>bl_html) {</span>
<span id="cb910-44"><a href="coding-and-development.html#cb910-44" tabindex="-1"></a>    <span class="cf">if</span> (bl_verbose) <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&#39;spth_html:&#39;</span>,spn_file_html, <span class="st">&#39;, HTML started.&#39;</span>))</span>
<span id="cb910-45"><a href="coding-and-development.html#cb910-45" tabindex="-1"></a>    rmarkdown<span class="sc">::</span><span class="fu">render</span>(spn_file, <span class="at">output_format=</span><span class="st">&#39;html_document&#39;</span>,</span>
<span id="cb910-46"><a href="coding-and-development.html#cb910-46" tabindex="-1"></a>                      <span class="at">output_dir =</span> spt_out_directory, <span class="at">output_file =</span> sna_file)</span>
<span id="cb910-47"><a href="coding-and-development.html#cb910-47" tabindex="-1"></a>    <span class="cf">if</span> (bl_verbose) <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&#39;spth_html:&#39;</span>,spn_file_html, <span class="st">&#39;, HTML finished.&#39;</span>))</span>
<span id="cb910-48"><a href="coding-and-development.html#cb910-48" tabindex="-1"></a>    spn_html_generated <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_out_directory, <span class="st">&#39;/&#39;</span>, spn_file_html)</span>
<span id="cb910-49"><a href="coding-and-development.html#cb910-49" tabindex="-1"></a>  }</span>
<span id="cb910-50"><a href="coding-and-development.html#cb910-50" tabindex="-1"></a></span>
<span id="cb910-51"><a href="coding-and-development.html#cb910-51" tabindex="-1"></a>  <span class="co"># purl to R</span></span>
<span id="cb910-52"><a href="coding-and-development.html#cb910-52" tabindex="-1"></a>  <span class="cf">if</span> (ls_bool_convert<span class="sc">$</span>bl_R) {</span>
<span id="cb910-53"><a href="coding-and-development.html#cb910-53" tabindex="-1"></a>    <span class="cf">if</span> (bl_verbose) <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&#39;purl_to:&#39;</span>, <span class="fu">paste0</span>(spn_file_R, <span class="st">&quot;.R&quot;</span>)))</span>
<span id="cb910-54"><a href="coding-and-development.html#cb910-54" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">purl</span>(spn_file, <span class="at">output=</span><span class="fu">paste0</span>(spt_out_directory, <span class="st">&#39;/&#39;</span>, sna_file, <span class="st">&#39;.R&#39;</span>), <span class="at">documentation =</span> <span class="dv">1</span>)</span>
<span id="cb910-55"><a href="coding-and-development.html#cb910-55" tabindex="-1"></a>    spn_R_generated <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_out_directory, <span class="st">&#39;/&#39;</span>, sna_file, <span class="st">&#39;.R&#39;</span>)</span>
<span id="cb910-56"><a href="coding-and-development.html#cb910-56" tabindex="-1"></a>  }</span>
<span id="cb910-57"><a href="coding-and-development.html#cb910-57" tabindex="-1"></a></span>
<span id="cb910-58"><a href="coding-and-development.html#cb910-58" tabindex="-1"></a>  <span class="co"># return(list(ls_spt_pdf_generated=ls_spt_pdf_generated,</span></span>
<span id="cb910-59"><a href="coding-and-development.html#cb910-59" tabindex="-1"></a>  <span class="co">#             ls_spt_html_generated=ls_spt_html_generated,</span></span>
<span id="cb910-60"><a href="coding-and-development.html#cb910-60" tabindex="-1"></a>  <span class="co">#             ls_spt_R_generated=ls_spt_R_generated))</span></span>
<span id="cb910-61"><a href="coding-and-development.html#cb910-61" tabindex="-1"></a></span>
<span id="cb910-62"><a href="coding-and-development.html#cb910-62" tabindex="-1"></a></span>
<span id="cb910-63"><a href="coding-and-development.html#cb910-63" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
</div>
<div id="python-with-r" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Python with R<a href="coding-and-development.html#python-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="reticulate-basics" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Reticulate Basics<a href="coding-and-development.html#reticulate-basics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="basic-python-tests-with-rmd" class="section level4 hasAnchor" number="12.3.1.1">
<h4><span class="header-section-number">12.3.1.1</span> Basic Python Tests with RMD<a href="coding-and-development.html#basic-python-tests-with-rmd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Could specify: <em>python, engine.path = “C:/ProgramData/Anaconda3/envs/wk_pyfan/python.exe”</em>, this is already set inside Rprofile: <em>knitr::opts_chunk$set(engine.path = “C:/ProgramData/Anaconda3/envs/wk_pyfan/python.exe”)</em></p>
<div class="sourceCode" id="cb911"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb911-1"><a href="coding-and-development.html#cb911-1" tabindex="-1"></a><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## 2</code></pre>
</div>
<div id="install-and-python-path" class="section level4 hasAnchor" number="12.3.1.2">
<h4><span class="header-section-number">12.3.1.2</span> Install and Python Path<a href="coding-and-development.html#install-and-python-path" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Install reticulate from github directly to get latest version: <em>devtools::install_github(“rstudio/reticulate”)</em></p>
<p>Check python version on computer:</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="coding-and-development.html#cb913-1" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">&#39;python&#39;</span>)</span></code></pre></div>
<pre><code>##                                               python 
## &quot;C:\\PROGRA~3\\ANACON~1\\envs\\wk_pyfan\\python.exe&quot;</code></pre>
<p>After installing reticulate, load in the library: library(reticulate). With “py_config()”
to see python config. First time, might generate “No non-system installation of Python could be found.” and ask if want to install Miniconda. Answer NO.</p>
<p>Correct outputs upon checking py_config():</p>
<pre><code>python:         C:/ProgramData/Anaconda3/python.exe
libpython:      C:/ProgramData/Anaconda3/python37.dll
pythonhome:     C:/ProgramData/Anaconda3
version:        3.7.9 (default, Aug 31 2020, 17:10:11) [MSC v.1916 64 bit (AMD64)]
Architecture:   64bit
numpy:          C:/ProgramData/Anaconda3/Lib/site-packages/numpy
numpy_version:  1.19.1

python versions found:
 C:/ProgramData/Anaconda3/python.exe
 C:/ProgramData/Anaconda3/envs/wk_cgefi/python.exe
 C:/ProgramData/Anaconda3/envs/wk_jinja/python.exe
 C:/ProgramData/Anaconda3/envs/wk_pyfan/python.exe</code></pre>
<p>Set which python to use:</p>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="coding-and-development.html#cb916-1" tabindex="-1"></a><span class="co"># Sys.setenv(RETICULATE_PYTHON = &quot;C:/programdata/Anaconda3/python.exe&quot;)</span></span>
<span id="cb916-2"><a href="coding-and-development.html#cb916-2" tabindex="-1"></a><span class="co"># Sys.setenv(RETICULATE_PYTHON = &quot;C:/ProgramData/Anaconda3/envs/wk_pyfan/python.exe&quot;)</span></span>
<span id="cb916-3"><a href="coding-and-development.html#cb916-3" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb916-4"><a href="coding-and-development.html#cb916-4" tabindex="-1"></a><span class="co"># What is the python config</span></span>
<span id="cb916-5"><a href="coding-and-development.html#cb916-5" tabindex="-1"></a><span class="fu">py_config</span>()</span></code></pre></div>
<pre><code>## python:         C:/ProgramData/anaconda3/envs/wk_pyfan/python.exe
## libpython:      C:/ProgramData/anaconda3/envs/wk_pyfan/python311.dll
## pythonhome:     C:/ProgramData/anaconda3/envs/wk_pyfan
## version:        3.11.7 | packaged by conda-forge | (main, Dec 23 2023, 14:27:59) [MSC v.1937 64 bit (AMD64)]
## Architecture:   64bit
## numpy:          C:/ProgramData/anaconda3/envs/wk_pyfan/Lib/site-packages/numpy
## numpy_version:  1.26.2
## 
## NOTE: Python version was forced by RETICULATE_PYTHON</code></pre>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="coding-and-development.html#cb918-1" tabindex="-1"></a><span class="co"># set python</span></span>
<span id="cb918-2"><a href="coding-and-development.html#cb918-2" tabindex="-1"></a><span class="co"># use_python(&quot;C:/programdata/Anaconda3/python.exe&quot;)</span></span>
<span id="cb918-3"><a href="coding-and-development.html#cb918-3" tabindex="-1"></a><span class="co"># use_python(&quot;C:/ProgramData/Anaconda3/envs/wk_pyfan/python.exe&quot;)</span></span>
<span id="cb918-4"><a href="coding-and-development.html#cb918-4" tabindex="-1"></a><span class="fu">use_condaenv</span>(<span class="st">&#39;wk_pyfan&#39;</span>)</span>
<span id="cb918-5"><a href="coding-and-development.html#cb918-5" tabindex="-1"></a><span class="co"># Sys.which(&#39;python&#39;)</span></span>
<span id="cb918-6"><a href="coding-and-development.html#cb918-6" tabindex="-1"></a><span class="fu">py_run_string</span>(<span class="st">&#39;print(1+1)&#39;</span>)</span></code></pre></div>
<pre><code>## 2</code></pre>
</div>
<div id="error" class="section level4 hasAnchor" number="12.3.1.3">
<h4><span class="header-section-number">12.3.1.3</span> Error<a href="coding-and-development.html#error" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="py_call_impl-error" class="section level5 hasAnchor" number="12.3.1.3.1">
<h5><span class="header-section-number">12.3.1.3.1</span> py_call_impl error<a href="coding-and-development.html#py_call_impl-error" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The error appeared when calling any python operations, including “1+1”, resolved after installing reticulate from github: <em>devtools::install_github(“rstudio/reticulate”)</em></p>
<pre><code>Error in py_call_impl(callable, dots$args, dots$keywords) :
  TypeError: use() got an unexpected keyword argument &#39;warn&#39;</code></pre>

</div>
</div>
</div>
</div>
<div id="command-line" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Command Line<a href="coding-and-development.html#command-line" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="shell-and-system-commands" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Shell and System Commands<a href="coding-and-development.html#shell-and-system-commands" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="basic-shell-commands" class="section level4 hasAnchor" number="12.4.1.1">
<h4><span class="header-section-number">12.4.1.1</span> Basic Shell Commands<a href="coding-and-development.html#basic-shell-commands" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Run basic shell commands in windows:</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="coding-and-development.html#cb921-1" tabindex="-1"></a><span class="co"># detect current path</span></span>
<span id="cb921-2"><a href="coding-and-development.html#cb921-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">toString</span>(<span class="fu">shell</span>(<span class="fu">paste0</span>(<span class="st">&quot;echo %cd%&quot;</span>), <span class="at">intern=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;C:\\Users\\fan\\R4Econ&quot;</code></pre>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="coding-and-development.html#cb923-1" tabindex="-1"></a><span class="co"># Show directory</span></span>
<span id="cb923-2"><a href="coding-and-development.html#cb923-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">toString</span>(<span class="fu">shell</span>(<span class="fu">paste0</span>(<span class="st">&quot;dir&quot;</span>), <span class="at">intern=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<pre><code>## [1] &quot; Volume in drive C is OS,  Volume Serial Number is 123A-85A2, ,  Directory of C:\\Users\\fan\\R4Econ, , 01/01/2024  07:59 PM    &lt;DIR&gt;          ., 01/01/2024  12:02 AM    &lt;DIR&gt;          .., 10/16/2023  03:53 AM               203 .gitattributes, 10/16/2023  03:53 AM             1,460 .gitignore, 10/16/2023  03:53 AM                30 .Rbuildignore, 01/01/2024  07:54 PM            16,430 .Rhistory, 01/01/2024  04:30 PM             7,808 .Rprofile, 12/31/2023  10:37 PM    &lt;DIR&gt;          amto, 10/16/2023  03:53 AM               278 book.bib, 01/01/2024  07:52 PM    &lt;DIR&gt;          bookdown, 12/31/2023  10:37 PM    &lt;DIR&gt;          development, 10/16/2023  03:53 AM    &lt;DIR&gt;          dynamic, 10/16/2023  03:53 AM    &lt;DIR&gt;          factor, 10/16/2023  03:53 AM    &lt;DIR&gt;          function, 10/16/2023  03:53 AM    &lt;DIR&gt;          generate, 10/16/2023  03:53 AM    &lt;DIR&gt;          getdata, 10/16/2023  03:53 AM             2,951 gitsetup.md, 10/16/2023  03:53 AM               321 hdga.html, 10/16/2023  03:53 AM    &lt;DIR&gt;          htmlpdfr, 01/01/2024  07:54 PM             3,062 index.Rmd, 12/31/2023  10:58 PM             1,091 LICENSE, 10/16/2023  03:53 AM    &lt;DIR&gt;          linreg, 10/16/2023  03:53 AM    &lt;DIR&gt;          math, 10/16/2023  03:53 AM    &lt;DIR&gt;          optimization, 10/16/2023  03:53 AM            11,018 packages.bib, 12/31/2023  10:39 PM    &lt;DIR&gt;          panel, 01/01/2024  07:59 PM           667,911 Panel Data and Optimization with R.Rmd, 01/01/2024  07:52 PM            85,457 Panel-Data-and-Optimization-with-R.log, 01/01/2024  07:59 PM           667,911 Panel-Data-and-Optimization-with-R.Rmd, 01/01/2024  07:28 PM    &lt;DIR&gt;          Panel-Data-and-Optimization-with-R_files, 10/16/2023  03:53 AM               480 preamble.tex, 10/16/2023  03:53 AM               583 preamble_book.tex, 01/01/2024  07:54 PM               416 R4Econ.Rproj, 01/01/2024  07:59 PM            70,714 README.md, 01/01/2024  07:59 PM            68,252 README_appendix.md, 10/16/2023  03:53 AM               762 README_end.md, 10/16/2023  03:53 AM            30,249 README_OLD.md, 01/01/2024  07:53 PM             3,256 README_pre.md, 01/01/2024  07:59 PM            66,690 README_toc.md, 10/16/2023  03:53 AM    &lt;DIR&gt;          regnonlin, 10/16/2023  03:53 AM    &lt;DIR&gt;          statistics, 10/16/2023  03:53 AM               595 style.css, 10/16/2023  03:53 AM    &lt;DIR&gt;          summarize, 10/16/2023  03:53 AM    &lt;DIR&gt;          support, 10/16/2023  03:53 AM    &lt;DIR&gt;          tabgraph, 10/16/2023  03:53 AM               136 title.Rmd, 10/16/2023  03:53 AM             2,570 toc.css, 01/01/2024  07:58 PM             5,229 _bookdown.yml, 01/01/2024  07:59 PM    &lt;DIR&gt;          _bookdown_files, 10/16/2023  03:53 AM               151 _config.yml, 10/16/2023  03:53 AM    &lt;DIR&gt;          _data, 10/16/2023  03:53 AM    &lt;DIR&gt;          _file, 10/16/2023  03:53 AM    &lt;DIR&gt;          _img, 10/16/2023  03:53 AM    &lt;DIR&gt;          _log, 10/16/2023  03:53 AM             1,438 _output.yml, 10/16/2023  03:53 AM                97 _output_kniti_html.yaml, 10/16/2023  03:53 AM               166 _output_kniti_pdf.yaml,               31 File(s)      1,717,715 bytes,               26 Dir(s)  193,147,244,544 bytes free&quot;</code></pre>
</div>
<div id="run-python-inside-a-conda-environment" class="section level4 hasAnchor" number="12.4.1.2">
<h4><span class="header-section-number">12.4.1.2</span> Run Python Inside a Conda Environment<a href="coding-and-development.html#run-python-inside-a-conda-environment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Use shell rather than system to activate a conda environment, check python version:</p>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="coding-and-development.html#cb925-1" tabindex="-1"></a><span class="co"># activate conda env</span></span>
<span id="cb925-2"><a href="coding-and-development.html#cb925-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">toString</span>(<span class="fu">shell</span>(<span class="fu">paste0</span>(<span class="st">&quot;activate base &amp; python --version&quot;</span>), <span class="at">intern=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;, C:\\Users\\fan\\R4Econ&gt;conda.bat activate base , Python 3.11.5&quot;</code></pre>
<p>Activate conda env and run a line:</p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="coding-and-development.html#cb927-1" tabindex="-1"></a>spg_runpython <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;activate base &amp;&quot;</span>,</span>
<span id="cb927-2"><a href="coding-and-development.html#cb927-2" tabindex="-1"></a>                        <span class="st">&quot;python --version &amp;&quot;</span>,</span>
<span id="cb927-3"><a href="coding-and-development.html#cb927-3" tabindex="-1"></a>                        <span class="st">&quot;python -c &quot;</span>,</span>
<span id="cb927-4"><a href="coding-and-development.html#cb927-4" tabindex="-1"></a>                        <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">st_var=&#39;this is string var&#39;;&quot;</span>,</span>
<span id="cb927-5"><a href="coding-and-development.html#cb927-5" tabindex="-1"></a>                        <span class="st">&quot;print(f&#39;{st_var}&#39;);&quot;</span>,</span>
<span id="cb927-6"><a href="coding-and-development.html#cb927-6" tabindex="-1"></a>                        <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>)</span>
<span id="cb927-7"><a href="coding-and-development.html#cb927-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">toString</span>(<span class="fu">shell</span>(spg_runpython, <span class="at">intern=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;, C:\\Users\\fan\\R4Econ&gt;conda.bat activate base , Python 3.11.5, this is string var&quot;</code></pre>

</div>
</div>
</div>
<div id="run-code-in-parallel-in-r" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Run Code in Parallel in R<a href="coding-and-development.html#run-code-in-parallel-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="parallel-loop-in-r" class="section level3 hasAnchor" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Parallel Loop in R<a href="coding-and-development.html#parallel-loop-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="setting-up-and-first-run" class="section level4 hasAnchor" number="12.5.1.1">
<h4><span class="header-section-number">12.5.1.1</span> Setting Up and First Run<a href="coding-and-development.html#setting-up-and-first-run" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, install several packages.</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="coding-and-development.html#cb929-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;parallel&quot;</span>, <span class="st">&quot;doParallel&quot;</span>, <span class="st">&quot;foreach&quot;</span>))</span></code></pre></div>
<p>Second, we load the libraries, and check on the parallel processing capacities on the local machine.</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="coding-and-development.html#cb930-1" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb930-2"><a href="coding-and-development.html#cb930-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb930-3"><a href="coding-and-development.html#cb930-3" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb930-4"><a href="coding-and-development.html#cb930-4" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb930-5"><a href="coding-and-development.html#cb930-5" tabindex="-1"></a><span class="fu">library</span>(iterators)</span>
<span id="cb930-6"><a href="coding-and-development.html#cb930-6" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb930-7"><a href="coding-and-development.html#cb930-7" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb930-8"><a href="coding-and-development.html#cb930-8" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb930-9"><a href="coding-and-development.html#cb930-9" tabindex="-1"></a></span>
<span id="cb930-10"><a href="coding-and-development.html#cb930-10" tabindex="-1"></a><span class="co"># Check number of cores</span></span>
<span id="cb930-11"><a href="coding-and-development.html#cb930-11" tabindex="-1"></a>it_n_cores_computer <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb930-12"><a href="coding-and-development.html#cb930-12" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Number of cores on computers:{it_n_cores_computer}&quot;</span>)</span>
<span id="cb930-13"><a href="coding-and-development.html#cb930-13" tabindex="-1"></a></span>
<span id="cb930-14"><a href="coding-and-development.html#cb930-14" tabindex="-1"></a><span class="co"># OUTPUT</span></span>
<span id="cb930-15"><a href="coding-and-development.html#cb930-15" tabindex="-1"></a><span class="do">## Number of cores on computers:20</span></span></code></pre></div>
<p>Third, we might want to use less than the total number of cores available. Specifying the number of cores to be used, we can initiate a local cluster. “PSOCK” below copies everything to each worker.</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="coding-and-development.html#cb931-1" tabindex="-1"></a><span class="co"># Start cluster</span></span>
<span id="cb931-2"><a href="coding-and-development.html#cb931-2" tabindex="-1"></a>ob_cluster <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(</span>
<span id="cb931-3"><a href="coding-and-development.html#cb931-3" tabindex="-1"></a>  it_n_cores_computer <span class="sc">-</span> <span class="dv">2</span>, </span>
<span id="cb931-4"><a href="coding-and-development.html#cb931-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;PSOCK&quot;</span></span>
<span id="cb931-5"><a href="coding-and-development.html#cb931-5" tabindex="-1"></a>  )</span>
<span id="cb931-6"><a href="coding-and-development.html#cb931-6" tabindex="-1"></a><span class="co"># Register cluster</span></span>
<span id="cb931-7"><a href="coding-and-development.html#cb931-7" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(<span class="at">cl =</span> ob_cluster)</span></code></pre></div>
<p>Fourth, run first parallel task, concurrent base-10 exponentiation.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="coding-and-development.html#cb932-1" tabindex="-1"></a><span class="co"># c(a,b,c,d) outputs together with combine</span></span>
<span id="cb932-2"><a href="coding-and-development.html#cb932-2" tabindex="-1"></a>ar_test_parallel <span class="ot">&lt;-</span> <span class="fu">foreach</span>(</span>
<span id="cb932-3"><a href="coding-and-development.html#cb932-3" tabindex="-1"></a>  <span class="at">it_power =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">.combine =</span> <span class="st">&#39;c&#39;</span></span>
<span id="cb932-4"><a href="coding-and-development.html#cb932-4" tabindex="-1"></a>) <span class="sc">%dopar%</span> {</span>
<span id="cb932-5"><a href="coding-and-development.html#cb932-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">10</span><span class="sc">^</span>(it_power))</span>
<span id="cb932-6"><a href="coding-and-development.html#cb932-6" tabindex="-1"></a>}</span>
<span id="cb932-7"><a href="coding-and-development.html#cb932-7" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;dopar outputs: {ar_test_parallel}&quot;</span>)</span>
<span id="cb932-8"><a href="coding-and-development.html#cb932-8" tabindex="-1"></a></span>
<span id="cb932-9"><a href="coding-and-development.html#cb932-9" tabindex="-1"></a><span class="co"># Output</span></span>
<span id="cb932-10"><a href="coding-and-development.html#cb932-10" tabindex="-1"></a><span class="do">## dopar outputs: 10</span></span>
<span id="cb932-11"><a href="coding-and-development.html#cb932-11" tabindex="-1"></a><span class="do">## dopar outputs: 100</span></span>
<span id="cb932-12"><a href="coding-and-development.html#cb932-12" tabindex="-1"></a><span class="do">## dopar outputs: 1000</span></span>
<span id="cb932-13"><a href="coding-and-development.html#cb932-13" tabindex="-1"></a><span class="do">## dopar outputs: 10000</span></span>
<span id="cb932-14"><a href="coding-and-development.html#cb932-14" tabindex="-1"></a><span class="do">## dopar outputs: 1e+05</span></span>
<span id="cb932-15"><a href="coding-and-development.html#cb932-15" tabindex="-1"></a><span class="do">## dopar outputs: 1e+06</span></span>
<span id="cb932-16"><a href="coding-and-development.html#cb932-16" tabindex="-1"></a><span class="do">## dopar outputs: 1e+07</span></span>
<span id="cb932-17"><a href="coding-and-development.html#cb932-17" tabindex="-1"></a><span class="do">## dopar outputs: 1e+08</span></span>
<span id="cb932-18"><a href="coding-and-development.html#cb932-18" tabindex="-1"></a><span class="do">## dopar outputs: 1e+09</span></span>
<span id="cb932-19"><a href="coding-and-development.html#cb932-19" tabindex="-1"></a><span class="do">## dopar outputs: 1e+10</span></span></code></pre></div>
<p>Fifth, close cluster. When work is done, close the cluster.</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="coding-and-development.html#cb933-1" tabindex="-1"></a>parallel<span class="sc">::</span><span class="fu">stopCluster</span>(<span class="at">cl =</span> ob_cluster)</span></code></pre></div>
</div>
<div id="parallel-function-run-with-different-parameters-aggregate-output-files" class="section level4 hasAnchor" number="12.5.1.2">
<h4><span class="header-section-number">12.5.1.2</span> Parallel Function Run with Different Parameters, Aggregate Output Files<a href="coding-and-development.html#parallel-function-run-with-different-parameters-aggregate-output-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this example, we create a function, we run the function with different parameters, each time generating a data output file to be stored, and then review results after.</p>
<p>First, we create a function. In this function, we generate a random matrix, the <code>it_nrow</code> parameter controls the number of rows in this random matrix. We store this matrix as csv.</p>
<p>Note, for each function used, such as <code>as_tibble</code> below, we should write it as <code>tibble::as_tibble</code>, to declare package and function jointly.</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="coding-and-development.html#cb934-1" tabindex="-1"></a>ffi_rand2csv <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb934-2"><a href="coding-and-development.html#cb934-2" tabindex="-1"></a>    spt_path_out,</span>
<span id="cb934-3"><a href="coding-and-development.html#cb934-3" tabindex="-1"></a>    <span class="at">it_nrow =</span> <span class="dv">3</span>,</span>
<span id="cb934-4"><a href="coding-and-development.html#cb934-4" tabindex="-1"></a>    <span class="at">st_file_prefix =</span> <span class="st">&quot;prefix&quot;</span>) {</span>
<span id="cb934-5"><a href="coding-and-development.html#cb934-5" tabindex="-1"></a></span>
<span id="cb934-6"><a href="coding-and-development.html#cb934-6" tabindex="-1"></a>    <span class="co"># Generate a matrix and tibble</span></span>
<span id="cb934-7"><a href="coding-and-development.html#cb934-7" tabindex="-1"></a>    mt_rnorm_a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb934-8"><a href="coding-and-development.html#cb934-8" tabindex="-1"></a>      <span class="fu">rnorm</span>(it_nrow<span class="sc">*</span><span class="dv">3</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>), </span>
<span id="cb934-9"><a href="coding-and-development.html#cb934-9" tabindex="-1"></a>      <span class="at">nrow=</span>it_nrow, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb934-10"><a href="coding-and-development.html#cb934-10" tabindex="-1"></a>    tb_test <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">as_tibble</span>(mt_rnorm_a)</span>
<span id="cb934-11"><a href="coding-and-development.html#cb934-11" tabindex="-1"></a></span>
<span id="cb934-12"><a href="coding-and-development.html#cb934-12" tabindex="-1"></a>    <span class="co"># File output path</span></span>
<span id="cb934-13"><a href="coding-and-development.html#cb934-13" tabindex="-1"></a>    spn_output_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(</span>
<span id="cb934-14"><a href="coding-and-development.html#cb934-14" tabindex="-1"></a>      spt_path_out,</span>
<span id="cb934-15"><a href="coding-and-development.html#cb934-15" tabindex="-1"></a>      <span class="fu">paste0</span>(st_file_prefix, <span class="st">&#39;_nrow&#39;</span>, it_nrow, <span class="st">&#39;.csv&#39;</span>),</span>
<span id="cb934-16"><a href="coding-and-development.html#cb934-16" tabindex="-1"></a>      <span class="at">fsep =</span> .Platform<span class="sc">$</span>file.sep)</span>
<span id="cb934-17"><a href="coding-and-development.html#cb934-17" tabindex="-1"></a></span>
<span id="cb934-18"><a href="coding-and-development.html#cb934-18" tabindex="-1"></a>    <span class="co"># Write file out</span></span>
<span id="cb934-19"><a href="coding-and-development.html#cb934-19" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">write_csv</span>(tb_test, spn_output_file)</span>
<span id="cb934-20"><a href="coding-and-development.html#cb934-20" tabindex="-1"></a>    <span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb934-21"><a href="coding-and-development.html#cb934-21" tabindex="-1"></a>      <span class="st">&quot;File saved successfully: &quot;</span>, spn_output_file))</span>
<span id="cb934-22"><a href="coding-and-development.html#cb934-22" tabindex="-1"></a>  </span>
<span id="cb934-23"><a href="coding-and-development.html#cb934-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Second, we initialize the cluster.</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="coding-and-development.html#cb935-1" tabindex="-1"></a><span class="co"># Get the number of cores</span></span>
<span id="cb935-2"><a href="coding-and-development.html#cb935-2" tabindex="-1"></a>it_n_cores_computer <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb935-3"><a href="coding-and-development.html#cb935-3" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Number of cores on computers:{it_n_cores_computer}&quot;</span>)</span>
<span id="cb935-4"><a href="coding-and-development.html#cb935-4" tabindex="-1"></a><span class="co"># Start cluster</span></span>
<span id="cb935-5"><a href="coding-and-development.html#cb935-5" tabindex="-1"></a>ob_cluster <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(</span>
<span id="cb935-6"><a href="coding-and-development.html#cb935-6" tabindex="-1"></a>  it_n_cores_computer <span class="sc">-</span> <span class="dv">2</span>, </span>
<span id="cb935-7"><a href="coding-and-development.html#cb935-7" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;PSOCK&quot;</span></span>
<span id="cb935-8"><a href="coding-and-development.html#cb935-8" tabindex="-1"></a>  )</span>
<span id="cb935-9"><a href="coding-and-development.html#cb935-9" tabindex="-1"></a><span class="co"># Register cluster</span></span>
<span id="cb935-10"><a href="coding-and-development.html#cb935-10" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(<span class="at">cl =</span> ob_cluster)</span>
<span id="cb935-11"><a href="coding-and-development.html#cb935-11" tabindex="-1"></a></span>
<span id="cb935-12"><a href="coding-and-development.html#cb935-12" tabindex="-1"></a><span class="co"># OUTPUT</span></span>
<span id="cb935-13"><a href="coding-and-development.html#cb935-13" tabindex="-1"></a><span class="do">## Number of cores on computers:20</span></span></code></pre></div>
<p>Third, we run the function in parallel.</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="coding-and-development.html#cb936-1" tabindex="-1"></a><span class="co"># Define shared Path</span></span>
<span id="cb936-2"><a href="coding-and-development.html#cb936-2" tabindex="-1"></a></span>
<span id="cb936-3"><a href="coding-and-development.html#cb936-3" tabindex="-1"></a>spt_root <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/fan/&quot;</span>  </span>
<span id="cb936-4"><a href="coding-and-development.html#cb936-4" tabindex="-1"></a>spt_rmd <span class="ot">&lt;-</span> <span class="st">&quot;R4Econ/development/parallel/_file/&quot;</span>  </span>
<span id="cb936-5"><a href="coding-and-development.html#cb936-5" tabindex="-1"></a>spt_path_out <span class="ot">&lt;-</span> <span class="fu">file.path</span>(spt_root, spt_rmd, <span class="at">fsep =</span> .Platform<span class="sc">$</span>file.sep)</span>
<span id="cb936-6"><a href="coding-and-development.html#cb936-6" tabindex="-1"></a></span>
<span id="cb936-7"><a href="coding-and-development.html#cb936-7" tabindex="-1"></a><span class="co"># Parallel Run</span></span>
<span id="cb936-8"><a href="coding-and-development.html#cb936-8" tabindex="-1"></a><span class="fu">foreach</span>(</span>
<span id="cb936-9"><a href="coding-and-development.html#cb936-9" tabindex="-1"></a>  <span class="at">it_nrow =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb936-10"><a href="coding-and-development.html#cb936-10" tabindex="-1"></a>) <span class="sc">%dopar%</span> {</span>
<span id="cb936-11"><a href="coding-and-development.html#cb936-11" tabindex="-1"></a>  <span class="co"># Run function</span></span>
<span id="cb936-12"><a href="coding-and-development.html#cb936-12" tabindex="-1"></a>  <span class="fu">ffi_rand2csv</span>(</span>
<span id="cb936-13"><a href="coding-and-development.html#cb936-13" tabindex="-1"></a>    spt_path_out,</span>
<span id="cb936-14"><a href="coding-and-development.html#cb936-14" tabindex="-1"></a>    <span class="at">it_nrow =</span> it_nrow,</span>
<span id="cb936-15"><a href="coding-and-development.html#cb936-15" tabindex="-1"></a>    <span class="at">st_file_prefix =</span> <span class="st">&quot;ffi_para_test&quot;</span>)</span>
<span id="cb936-16"><a href="coding-and-development.html#cb936-16" tabindex="-1"></a>}</span>
<span id="cb936-17"><a href="coding-and-development.html#cb936-17" tabindex="-1"></a></span>
<span id="cb936-18"><a href="coding-and-development.html#cb936-18" tabindex="-1"></a><span class="co"># Output</span></span>
<span id="cb936-19"><a href="coding-and-development.html#cb936-19" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb936-20"><a href="coding-and-development.html#cb936-20" tabindex="-1"></a><span class="do">## File saved successfully: C:/Users/fan//R4Econ/development/parallel/_file/ffi_para_test_nrow2.csv</span></span>
<span id="cb936-21"><a href="coding-and-development.html#cb936-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb936-22"><a href="coding-and-development.html#cb936-22" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb936-23"><a href="coding-and-development.html#cb936-23" tabindex="-1"></a><span class="do">## File saved successfully: C:/Users/fan//R4Econ/development/parallel/_file/ffi_para_test_nrow3.csv</span></span>
<span id="cb936-24"><a href="coding-and-development.html#cb936-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb936-25"><a href="coding-and-development.html#cb936-25" tabindex="-1"></a><span class="do">## [[3]]</span></span>
<span id="cb936-26"><a href="coding-and-development.html#cb936-26" tabindex="-1"></a><span class="do">## File saved successfully: C:/Users/fan//R4Econ/development/parallel/_file/ffi_para_test_nrow4.csv</span></span></code></pre></div>
<p>Fourth, adapting the parallel loop to other functions. Note that:</p>
<ol style="list-style-type: decimal">
<li>In the <code>forach</code> loop ablow, we iterate over <code>seq(2,4)</code>, assigning in parallel <code>2</code>, <code>3</code>, and <code>4</code> to the parameter <code>it_nrow</code>.</li>
<li><code>it_nrow</code> is a parameter for the <code>ffi_rand2csv</code> function, so we will generate different outputs associated with <code>it_nrow=2</code>, <code>it_nrow=3</code>, and <code>it_nrow=4</code>.</li>
<li>The code above can be adapted to other functions that one wants to run in parallel by changing only one parameter of a function. For example, suppose we want to run <code>ffp_demo_loc_env_inequality(spt_path_data, fl_temp_bound=fl_temp_bound)</code>, where <code>spt_path_data</code> is common across parallel calls, but we want to update <code>fl_temp_bound</code> for each parallel call, then we need to iterate over <code>fl_temp_bound</code>. See example below:</li>
</ol>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="coding-and-development.html#cb937-1" tabindex="-1"></a><span class="co"># Some path</span></span>
<span id="cb937-2"><a href="coding-and-development.html#cb937-2" tabindex="-1"></a>spt_path_data <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/fan/&quot;</span>  </span>
<span id="cb937-3"><a href="coding-and-development.html#cb937-3" tabindex="-1"></a><span class="co"># Parallel Run</span></span>
<span id="cb937-4"><a href="coding-and-development.html#cb937-4" tabindex="-1"></a><span class="fu">foreach</span>(</span>
<span id="cb937-5"><a href="coding-and-development.html#cb937-5" tabindex="-1"></a>  <span class="at">fl_temp_bound =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb937-6"><a href="coding-and-development.html#cb937-6" tabindex="-1"></a>) <span class="sc">%dopar%</span> {</span>
<span id="cb937-7"><a href="coding-and-development.html#cb937-7" tabindex="-1"></a>  <span class="co"># Run function</span></span>
<span id="cb937-8"><a href="coding-and-development.html#cb937-8" tabindex="-1"></a>  <span class="fu">ffp_demo_loc_env_inequality</span>(</span>
<span id="cb937-9"><a href="coding-and-development.html#cb937-9" tabindex="-1"></a>    spt_path_data,</span>
<span id="cb937-10"><a href="coding-and-development.html#cb937-10" tabindex="-1"></a>    <span class="at">fl_temp_bound=</span>fl_temp_bound)</span>
<span id="cb937-11"><a href="coding-and-development.html#cb937-11" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="get-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="index-and-code-links.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
