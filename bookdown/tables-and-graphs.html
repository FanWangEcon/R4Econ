<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Tables and Graphs | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="Running parallel code in R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Tables and Graphs | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Running parallel code in R" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Tables and Graphs | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="Running parallel code in R" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistics.html"/>
<link rel="next" href="get-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#regular-expression-date-etc."><i class="fa fa-check"></i><b>1.4</b> Regular Expression, Date, etc.</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-regular-expression"><i class="fa fa-check"></i><b>1.4.1</b> String Regular Expression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html"><i class="fa fa-check"></i><b>2</b> Manipulate and Summarize Dataframes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#variables-in-dataframes"><i class="fa fa-check"></i><b>2.1</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-dataframe"><i class="fa fa-check"></i><b>2.1.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="2.1.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-categorical-variables"><i class="fa fa-check"></i><b>2.1.2</b> Generate Categorical Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#drawly-random-rows"><i class="fa fa-check"></i><b>2.1.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="2.1.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>2.1.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="2.1.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#string-dataframes"><i class="fa fa-check"></i><b>2.1.5</b> String Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-observation"><i class="fa fa-check"></i><b>2.2</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-and-tabulations"><i class="fa fa-check"></i><b>2.2.1</b> Counting and Tabulations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.3</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-1"><i class="fa fa-check"></i><b>2.3.1</b> Sorting</a></li>
<li class="chapter" data-level="2.3.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.3.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#advanced-group-aggregation"><i class="fa fa-check"></i><b>2.4</b> Advanced Group Aggregation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.4.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.4.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#groups-statistics"><i class="fa fa-check"></i><b>2.4.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.4.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.4.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.4.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.4.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#distributional-statistics"><i class="fa fa-check"></i><b>2.5</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#histogram"><i class="fa fa-check"></i><b>2.5.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.6</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#apply-function-over-multiple-columns-and-rows"><i class="fa fa-check"></i><b>2.6.1</b> Apply Function Over Multiple Columns and Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-table-to-wide-table"><i class="fa fa-check"></i><b>4.2.1</b> Long Table to Wide Table</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-comparisons-and-statistics"><i class="fa fa-check"></i><b>4.3</b> Within Panel Comparisons and Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
<li class="chapter" data-level="4.3.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-cross-time-and-cross-group-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Within Panel Cross-time and Cross-group Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-merge-files-together-by-keys"><i class="fa fa-check"></i><b>4.4</b> Join and Merge Files Together by Keys</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#mesh-join"><i class="fa fa-check"></i><b>4.4.1</b> Mesh Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#linear-and-polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Linear and Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#fit-curves-through-points"><i class="fa fa-check"></i><b>5.1.1</b> Fit Curves Through Points</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#grid-based-optimization"><i class="fa fa-check"></i><b>7.1</b> Grid Based Optimization</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#find-maximum-by-iterating-over-grids"><i class="fa fa-check"></i><b>7.1.1</b> Find Maximum By Iterating Over Grids</a></li>
<li class="chapter" data-level="7.1.2" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1.2</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#polynomial-formulas-for-points"><i class="fa fa-check"></i><b>8.1.1</b> Polynomial Formulas for Points</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.3</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.4</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.5" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.5</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-functions"><i class="fa fa-check"></i><b>8.2</b> Production Functions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#latent-dynamic-health-production-function"><i class="fa fa-check"></i><b>8.2.2</b> Latent Dynamic Health Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot-basics"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot Basics</a></li>
<li class="chapter" data-level="10.2.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-advanced"><i class="fa fa-check"></i><b>10.2.2</b> ggplot Line Advanced</a></li>
<li class="chapter" data-level="10.2.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#time-series-plots-with-shaded-areas"><i class="fa fa-check"></i><b>10.2.3</b> Time-series Plots with Shaded Areas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="coding-and-development.html"><a href="coding-and-development.html"><i class="fa fa-check"></i><b>12</b> Coding and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="coding-and-development.html"><a href="coding-and-development.html#installation-and-packages"><i class="fa fa-check"></i><b>12.1</b> Installation and Packages</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="coding-and-development.html"><a href="coding-and-development.html#r-installation-and-set-up"><i class="fa fa-check"></i><b>12.1.1</b> R Installation and Set-Up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="coding-and-development.html"><a href="coding-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.2</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="coding-and-development.html"><a href="coding-and-development.html#file-path"><i class="fa fa-check"></i><b>12.2.1</b> File Path</a></li>
<li class="chapter" data-level="12.2.2" data-path="coding-and-development.html"><a href="coding-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.2.2</b> Text to File</a></li>
<li class="chapter" data-level="12.2.3" data-path="coding-and-development.html"><a href="coding-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.2.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="coding-and-development.html"><a href="coding-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.3</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="coding-and-development.html"><a href="coding-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.3.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="coding-and-development.html"><a href="coding-and-development.html#command-line"><i class="fa fa-check"></i><b>12.4</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="coding-and-development.html"><a href="coding-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.4.1</b> Shell and System Commands</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="coding-and-development.html"><a href="coding-and-development.html#run-code-in-parallel-in-r"><i class="fa fa-check"></i><b>12.5</b> Run Code in Parallel in R</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="coding-and-development.html"><a href="coding-and-development.html#parallel-loop-in-r"><i class="fa fa-check"></i><b>12.5.1</b> Parallel Loop in R</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> Section 1.1 List links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> Section 1.2 Array links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> Section 1.3 Matrix links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-regular-expression-date-etc.regular-expression-date-etc.-links"><i class="fa fa-check"></i><b>A.1.4</b> Section 1.4 Regular Expression, Date, etc. links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#manipulate-and-summarize-dataframes-links"><i class="fa fa-check"></i><b>A.2</b> Manipulate and Summarize Dataframes links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.2.1</b> Section 2.1 Variables in Dataframes links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.2</b> Section 2.2 Counting Observation links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.3</b> Section 2.3 Sorting, Indexing, Slicing links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-advanced-group-aggregationadvanced-group-aggregation-links"><i class="fa fa-check"></i><b>A.2.4</b> Section 2.4 Advanced Group Aggregation links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.5</b> Section 2.5 Distributional Statistics links</a></li>
<li class="chapter" data-level="A.2.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.6-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.6</b> Section 2.6 Summarize Multiple Variables links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> Section 3.1 Dataframe Mutate links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> Section 3.2 Dataframe Do Anything links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> Section 3.3 Apply and pmap links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> Section 4.1 Generate, Gather, Bind and Join links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> Section 4.2 Wide and Long links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-within-panel-comparisons-and-statisticswithin-panel-comparisons-and-statistics-links"><i class="fa fa-check"></i><b>A.4.3</b> Section 4.3 Within Panel Comparisons and Statistics links</a></li>
<li class="chapter" data-level="A.4.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.4-join-and-merge-files-together-by-keysjoin-and-merge-files-together-by-keys-links"><i class="fa fa-check"></i><b>A.4.4</b> Section 4.4 Join and Merge Files Together by Keys links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-linear-and-polynomial-fittinglinear-and-polynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> Section 5.1 Linear and Polynomial Fitting links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> Section 5.2 OLS and IV links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> Section 5.3 Decomposition links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> Section 6.1 Logit Regression links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> Section 6.2 Quantile Regression links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-grid-based-optimizationgrid-based-optimization-links"><i class="fa fa-check"></i><b>A.7.1</b> Section 7.1 Grid Based Optimization links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> Section 8.1 Basics links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionsproduction-functions-links"><i class="fa fa-check"></i><b>A.8.2</b> Section 8.2 Production Functions links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> Section 8.3 Inequality Models links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> Section 9.1 Random Draws links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> Section 9.2 Distributions links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> Section 9.3 Discrete Random Variable links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> Section 10.1 R Base Plots links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> Section 10.2 ggplot Line Related Plots links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> Section 10.3 ggplot Scatter Related Plots links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> Section 10.4 Write and Read Plots links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> Section 11.1 Environmental Data links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#coding-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Coding and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-installation-and-packagesinstallation-and-packages-links"><i class="fa fa-check"></i><b>A.12.1</b> Section 12.1 Installation and Packages links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.2</b> Section 12.2 Files In and Out links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.3</b> Section 12.3 Python with R links</a></li>
<li class="chapter" data-level="A.12.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.4-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.4</b> Section 12.4 Command Line links</a></li>
<li class="chapter" data-level="A.12.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.5-run-code-in-parallel-in-rrun-code-in-parallel-in-r-links"><i class="fa fa-check"></i><b>A.12.5</b> Section 12.5 Run Code in Parallel in R links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tables-and-graphs" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Tables and Graphs<a href="tables-and-graphs.html#tables-and-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="r-base-plots" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> R Base Plots<a href="tables-and-graphs.html#r-base-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="plot-curve-line-and-points" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Plot Curve, Line and Points<a href="tables-and-graphs.html#plot-curve-line-and-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>Work with the R plot function.</p>
<div id="one-point-one-line-and-two-curves" class="section level4 hasAnchor" number="10.1.1.1">
<h4><span class="header-section-number">10.1.1.1</span> One Point, One Line and Two Curves<a href="tables-and-graphs.html#one-point-one-line-and-two-curves" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>r curve on top of plot</li>
<li>r plot specify pch lty both scatter and line</li>
<li>r legend outside</li>
</ul>
<p>Jointly plot:</p>
<ul>
<li>1 scatter plot</li>
<li>1 line plot</li>
<li>2 function curve plots</li>
</ul>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="tables-and-graphs.html#cb792-1" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-2"><a href="tables-and-graphs.html#cb792-2" tabindex="-1"></a><span class="co"># First, Some common Labels:</span></span>
<span id="cb792-3"><a href="tables-and-graphs.html#cb792-3" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-4"><a href="tables-and-graphs.html#cb792-4" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb792-5"><a href="tables-and-graphs.html#cb792-5" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Scatter, Line and Curve Joint Ploting Example Using Base R</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb792-6"><a href="tables-and-graphs.html#cb792-6" tabindex="-1"></a>                   <span class="st">&#39;plot() + curve(): x*sin(x), cos(x), sin(x)*cos(x), sin(x)+tan(x)+cos(x)&#39;</span>)</span>
<span id="cb792-7"><a href="tables-and-graphs.html#cb792-7" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb792-8"><a href="tables-and-graphs.html#cb792-8" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/tabgraph/inout/htmlpdfr/fs_base_curve.html&#39;</span>)</span>
<span id="cb792-9"><a href="tables-and-graphs.html#cb792-9" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;x&#39;</span></span>
<span id="cb792-10"><a href="tables-and-graphs.html#cb792-10" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;f(x)&#39;</span></span>
<span id="cb792-11"><a href="tables-and-graphs.html#cb792-11" tabindex="-1"></a></span>
<span id="cb792-12"><a href="tables-and-graphs.html#cb792-12" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-13"><a href="tables-and-graphs.html#cb792-13" tabindex="-1"></a><span class="co"># Second, Generate the Graphs Functions and data points:</span></span>
<span id="cb792-14"><a href="tables-and-graphs.html#cb792-14" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-15"><a href="tables-and-graphs.html#cb792-15" tabindex="-1"></a><span class="co"># x only used for Point 1 and Line 1</span></span>
<span id="cb792-16"><a href="tables-and-graphs.html#cb792-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>pi, <span class="dv">1</span><span class="sc">*</span>pi, <span class="at">length.out=</span><span class="dv">25</span>)</span>
<span id="cb792-17"><a href="tables-and-graphs.html#cb792-17" tabindex="-1"></a><span class="co"># Line (Point) 1: Generate X and Y</span></span>
<span id="cb792-18"><a href="tables-and-graphs.html#cb792-18" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="fu">sin</span>(x)</span>
<span id="cb792-19"><a href="tables-and-graphs.html#cb792-19" tabindex="-1"></a>st_point_1_y_legend <span class="ot">&lt;-</span> <span class="st">&#39;x*sin(x)&#39;</span></span>
<span id="cb792-20"><a href="tables-and-graphs.html#cb792-20" tabindex="-1"></a><span class="co"># Line 2: Line Plot</span></span>
<span id="cb792-21"><a href="tables-and-graphs.html#cb792-21" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">cos</span>(x)</span>
<span id="cb792-22"><a href="tables-and-graphs.html#cb792-22" tabindex="-1"></a>st_line_2_y_legend <span class="ot">&lt;-</span> <span class="st">&#39;cos(x)&#39;</span></span>
<span id="cb792-23"><a href="tables-and-graphs.html#cb792-23" tabindex="-1"></a><span class="co"># Line 3: Function</span></span>
<span id="cb792-24"><a href="tables-and-graphs.html#cb792-24" tabindex="-1"></a>fc_sin_cos_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sin</span>(x)<span class="sc">*</span><span class="fu">cos</span>(x)</span>
<span id="cb792-25"><a href="tables-and-graphs.html#cb792-25" tabindex="-1"></a>st_line_3_y_legend <span class="ot">&lt;-</span> <span class="st">&#39;sin(x)*cos(x)&#39;</span></span>
<span id="cb792-26"><a href="tables-and-graphs.html#cb792-26" tabindex="-1"></a><span class="co"># Line 4: Function</span></span>
<span id="cb792-27"><a href="tables-and-graphs.html#cb792-27" tabindex="-1"></a>fc_sin_cos_tan <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sin</span>(x) <span class="sc">+</span> <span class="fu">cos</span>(x) <span class="sc">+</span> <span class="fu">tan</span>(x)</span>
<span id="cb792-28"><a href="tables-and-graphs.html#cb792-28" tabindex="-1"></a>st_line_4_y_legend <span class="ot">&lt;-</span> <span class="st">&#39;sin(x) + tan(x) + cos(x)&#39;</span></span>
<span id="cb792-29"><a href="tables-and-graphs.html#cb792-29" tabindex="-1"></a></span>
<span id="cb792-30"><a href="tables-and-graphs.html#cb792-30" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-31"><a href="tables-and-graphs.html#cb792-31" tabindex="-1"></a><span class="co"># Third, set:</span></span>
<span id="cb792-32"><a href="tables-and-graphs.html#cb792-32" tabindex="-1"></a><span class="co"># - point shape and size: *pch* and *cex*</span></span>
<span id="cb792-33"><a href="tables-and-graphs.html#cb792-33" tabindex="-1"></a><span class="co"># - line type and width: *lty* and *lwd*</span></span>
<span id="cb792-34"><a href="tables-and-graphs.html#cb792-34" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-35"><a href="tables-and-graphs.html#cb792-35" tabindex="-1"></a><span class="co"># http://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r</span></span>
<span id="cb792-36"><a href="tables-and-graphs.html#cb792-36" tabindex="-1"></a><span class="co"># http://www.sthda.com/english/wiki/line-types-in-r-lty</span></span>
<span id="cb792-37"><a href="tables-and-graphs.html#cb792-37" tabindex="-1"></a><span class="co"># for colors, see: https://fanwangecon.github.io/M4Econ/graph/tools/fs_color.html</span></span>
<span id="cb792-38"><a href="tables-and-graphs.html#cb792-38" tabindex="-1"></a>st_point_1_blue <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">57</span><span class="sc">/</span><span class="dv">255</span>,<span class="dv">106</span><span class="sc">/</span><span class="dv">255</span>,<span class="dv">177</span><span class="sc">/</span><span class="dv">255</span>)</span>
<span id="cb792-39"><a href="tables-and-graphs.html#cb792-39" tabindex="-1"></a>st_line_2_red <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">204</span><span class="sc">/</span><span class="dv">255</span>, <span class="dv">37</span><span class="sc">/</span><span class="dv">255</span>, <span class="dv">41</span><span class="sc">/</span><span class="dv">255</span>,)</span>
<span id="cb792-40"><a href="tables-and-graphs.html#cb792-40" tabindex="-1"></a>st_line_3_black <span class="ot">&lt;-</span> <span class="st">&#39;black&#39;</span></span>
<span id="cb792-41"><a href="tables-and-graphs.html#cb792-41" tabindex="-1"></a>st_line_4_purple <span class="ot">&lt;-</span> <span class="st">&#39;orange&#39;</span></span>
<span id="cb792-42"><a href="tables-and-graphs.html#cb792-42" tabindex="-1"></a></span>
<span id="cb792-43"><a href="tables-and-graphs.html#cb792-43" tabindex="-1"></a><span class="co"># point type</span></span>
<span id="cb792-44"><a href="tables-and-graphs.html#cb792-44" tabindex="-1"></a>st_point_1_pch <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb792-45"><a href="tables-and-graphs.html#cb792-45" tabindex="-1"></a><span class="co"># point size</span></span>
<span id="cb792-46"><a href="tables-and-graphs.html#cb792-46" tabindex="-1"></a>st_point_1_cex <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb792-47"><a href="tables-and-graphs.html#cb792-47" tabindex="-1"></a></span>
<span id="cb792-48"><a href="tables-and-graphs.html#cb792-48" tabindex="-1"></a><span class="co"># line type</span></span>
<span id="cb792-49"><a href="tables-and-graphs.html#cb792-49" tabindex="-1"></a>st_line_2_lty <span class="ot">&lt;-</span> <span class="st">&#39;dashed&#39;</span></span>
<span id="cb792-50"><a href="tables-and-graphs.html#cb792-50" tabindex="-1"></a>st_line_3_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotted&#39;</span></span>
<span id="cb792-51"><a href="tables-and-graphs.html#cb792-51" tabindex="-1"></a>st_line_4_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotdash&#39;</span></span>
<span id="cb792-52"><a href="tables-and-graphs.html#cb792-52" tabindex="-1"></a><span class="co"># line width</span></span>
<span id="cb792-53"><a href="tables-and-graphs.html#cb792-53" tabindex="-1"></a>st_line_2_lwd <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb792-54"><a href="tables-and-graphs.html#cb792-54" tabindex="-1"></a>st_line_3_lwd <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb792-55"><a href="tables-and-graphs.html#cb792-55" tabindex="-1"></a>st_line_4_lwd <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb792-56"><a href="tables-and-graphs.html#cb792-56" tabindex="-1"></a></span>
<span id="cb792-57"><a href="tables-and-graphs.html#cb792-57" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-58"><a href="tables-and-graphs.html#cb792-58" tabindex="-1"></a><span class="co"># Fourth: Share xlim and ylim</span></span>
<span id="cb792-59"><a href="tables-and-graphs.html#cb792-59" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-60"><a href="tables-and-graphs.html#cb792-60" tabindex="-1"></a>ar_xlim <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x))</span>
<span id="cb792-61"><a href="tables-and-graphs.html#cb792-61" tabindex="-1"></a>ar_ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>)</span>
<span id="cb792-62"><a href="tables-and-graphs.html#cb792-62" tabindex="-1"></a></span>
<span id="cb792-63"><a href="tables-and-graphs.html#cb792-63" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-64"><a href="tables-and-graphs.html#cb792-64" tabindex="-1"></a><span class="co"># Fifth: the legend will be long, will place it to the right of figure,</span></span>
<span id="cb792-65"><a href="tables-and-graphs.html#cb792-65" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-66"><a href="tables-and-graphs.html#cb792-66" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb792-67"><a href="tables-and-graphs.html#cb792-67" tabindex="-1"></a></span>
<span id="cb792-68"><a href="tables-and-graphs.html#cb792-68" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-69"><a href="tables-and-graphs.html#cb792-69" tabindex="-1"></a><span class="co"># Sixth, the four objects and do not print yet:</span></span>
<span id="cb792-70"><a href="tables-and-graphs.html#cb792-70" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-71"><a href="tables-and-graphs.html#cb792-71" tabindex="-1"></a><span class="co"># pdf(NULL)</span></span>
<span id="cb792-72"><a href="tables-and-graphs.html#cb792-72" tabindex="-1"></a><span class="co"># Graph Scatter 1</span></span>
<span id="cb792-73"><a href="tables-and-graphs.html#cb792-73" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type=</span><span class="st">&quot;p&quot;</span>,</span>
<span id="cb792-74"><a href="tables-and-graphs.html#cb792-74" tabindex="-1"></a>     <span class="at">col =</span> st_point_1_blue,</span>
<span id="cb792-75"><a href="tables-and-graphs.html#cb792-75" tabindex="-1"></a>     <span class="at">pch =</span> st_point_1_pch, <span class="at">cex =</span> st_point_1_cex,</span>
<span id="cb792-76"><a href="tables-and-graphs.html#cb792-76" tabindex="-1"></a>     <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb792-77"><a href="tables-and-graphs.html#cb792-77" tabindex="-1"></a>     <span class="at">panel.first =</span> <span class="fu">grid</span>(),</span>
<span id="cb792-78"><a href="tables-and-graphs.html#cb792-78" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb792-79"><a href="tables-and-graphs.html#cb792-79" tabindex="-1"></a>pl_scatter_1 <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb792-80"><a href="tables-and-graphs.html#cb792-80" tabindex="-1"></a></span>
<span id="cb792-81"><a href="tables-and-graphs.html#cb792-81" tabindex="-1"></a><span class="co"># Graph Line 2</span></span>
<span id="cb792-82"><a href="tables-and-graphs.html#cb792-82" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb792-83"><a href="tables-and-graphs.html#cb792-83" tabindex="-1"></a><span class="fu">plot</span>(x, y2, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb792-84"><a href="tables-and-graphs.html#cb792-84" tabindex="-1"></a>     <span class="at">col =</span> st_line_2_red,</span>
<span id="cb792-85"><a href="tables-and-graphs.html#cb792-85" tabindex="-1"></a>     <span class="at">lwd =</span> st_line_2_lwd, <span class="at">lty =</span> st_line_2_lty,</span>
<span id="cb792-86"><a href="tables-and-graphs.html#cb792-86" tabindex="-1"></a>     <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb792-87"><a href="tables-and-graphs.html#cb792-87" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb792-88"><a href="tables-and-graphs.html#cb792-88" tabindex="-1"></a>pl_12 <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb792-89"><a href="tables-and-graphs.html#cb792-89" tabindex="-1"></a></span>
<span id="cb792-90"><a href="tables-and-graphs.html#cb792-90" tabindex="-1"></a><span class="co"># Graph Curve 3</span></span>
<span id="cb792-91"><a href="tables-and-graphs.html#cb792-91" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb792-92"><a href="tables-and-graphs.html#cb792-92" tabindex="-1"></a><span class="fu">curve</span>(fc_sin_cos_diff,</span>
<span id="cb792-93"><a href="tables-and-graphs.html#cb792-93" tabindex="-1"></a>      <span class="at">col =</span> st_line_3_black,</span>
<span id="cb792-94"><a href="tables-and-graphs.html#cb792-94" tabindex="-1"></a>      <span class="at">lwd =</span> st_line_3_lwd, <span class="at">lty =</span> st_line_3_lty,</span>
<span id="cb792-95"><a href="tables-and-graphs.html#cb792-95" tabindex="-1"></a>      <span class="at">from =</span> ar_xlim[<span class="dv">1</span>], <span class="at">to =</span> ar_xlim[<span class="dv">2</span>], <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb792-96"><a href="tables-and-graphs.html#cb792-96" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb792-97"><a href="tables-and-graphs.html#cb792-97" tabindex="-1"></a>pl_123 <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb792-98"><a href="tables-and-graphs.html#cb792-98" tabindex="-1"></a></span>
<span id="cb792-99"><a href="tables-and-graphs.html#cb792-99" tabindex="-1"></a><span class="co"># Graph Curve 4</span></span>
<span id="cb792-100"><a href="tables-and-graphs.html#cb792-100" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb792-101"><a href="tables-and-graphs.html#cb792-101" tabindex="-1"></a><span class="fu">curve</span>(fc_sin_cos_tan,</span>
<span id="cb792-102"><a href="tables-and-graphs.html#cb792-102" tabindex="-1"></a>      <span class="at">col =</span> st_line_4_purple,</span>
<span id="cb792-103"><a href="tables-and-graphs.html#cb792-103" tabindex="-1"></a>      <span class="at">lwd =</span> st_line_4_lwd, <span class="at">lty =</span> st_line_4_lty,</span>
<span id="cb792-104"><a href="tables-and-graphs.html#cb792-104" tabindex="-1"></a>      <span class="at">from =</span> ar_xlim[<span class="dv">1</span>], <span class="at">to =</span> ar_xlim[<span class="dv">2</span>], <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb792-105"><a href="tables-and-graphs.html#cb792-105" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb792-106"><a href="tables-and-graphs.html#cb792-106" tabindex="-1"></a>pl_1234 <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb792-107"><a href="tables-and-graphs.html#cb792-107" tabindex="-1"></a><span class="co"># invisible(dev.off())</span></span>
<span id="cb792-108"><a href="tables-and-graphs.html#cb792-108" tabindex="-1"></a></span>
<span id="cb792-109"><a href="tables-and-graphs.html#cb792-109" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-110"><a href="tables-and-graphs.html#cb792-110" tabindex="-1"></a><span class="co"># Seventh, Set Title and Legend and Plot Jointly</span></span>
<span id="cb792-111"><a href="tables-and-graphs.html#cb792-111" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb792-112"><a href="tables-and-graphs.html#cb792-112" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb792-113"><a href="tables-and-graphs.html#cb792-113" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb792-114"><a href="tables-and-graphs.html#cb792-114" tabindex="-1"></a>fl_ces_fig_small <span class="ot">=</span> <span class="fl">0.75</span></span>
<span id="cb792-115"><a href="tables-and-graphs.html#cb792-115" tabindex="-1"></a></span>
<span id="cb792-116"><a href="tables-and-graphs.html#cb792-116" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb792-117"><a href="tables-and-graphs.html#cb792-117" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb792-118"><a href="tables-and-graphs.html#cb792-118" tabindex="-1"></a>      <span class="at">cex.lab=</span>fl_ces_fig_reg,</span>
<span id="cb792-119"><a href="tables-and-graphs.html#cb792-119" tabindex="-1"></a>      <span class="at">cex.main=</span>fl_ces_fig_reg,</span>
<span id="cb792-120"><a href="tables-and-graphs.html#cb792-120" tabindex="-1"></a>      <span class="at">cex.sub=</span>fl_ces_fig_small)</span>
<span id="cb792-121"><a href="tables-and-graphs.html#cb792-121" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb792-122"><a href="tables-and-graphs.html#cb792-122" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb792-123"><a href="tables-and-graphs.html#cb792-123" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb792-124"><a href="tables-and-graphs.html#cb792-124" tabindex="-1"></a></span>
<span id="cb792-125"><a href="tables-and-graphs.html#cb792-125" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb792-126"><a href="tables-and-graphs.html#cb792-126" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb792-127"><a href="tables-and-graphs.html#cb792-127" tabindex="-1"></a>       <span class="at">inset=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="dv">0</span>),</span>
<span id="cb792-128"><a href="tables-and-graphs.html#cb792-128" tabindex="-1"></a>       <span class="at">xpd=</span><span class="cn">TRUE</span>,</span>
<span id="cb792-129"><a href="tables-and-graphs.html#cb792-129" tabindex="-1"></a>       <span class="fu">c</span>(st_point_1_y_legend, st_line_2_y_legend, st_line_3_y_legend, st_line_4_y_legend),</span>
<span id="cb792-130"><a href="tables-and-graphs.html#cb792-130" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(st_point_1_blue, st_line_2_red, st_line_3_black, st_line_4_purple),</span>
<span id="cb792-131"><a href="tables-and-graphs.html#cb792-131" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(st_point_1_pch, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb792-132"><a href="tables-and-graphs.html#cb792-132" tabindex="-1"></a>       <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb792-133"><a href="tables-and-graphs.html#cb792-133" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, st_line_2_lty, st_line_3_lty, st_line_4_lty),</span>
<span id="cb792-134"><a href="tables-and-graphs.html#cb792-134" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, st_line_2_lwd, st_line_3_lwd,st_line_4_lwd),</span>
<span id="cb792-135"><a href="tables-and-graphs.html#cb792-135" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Legends&#39;</span>,</span>
<span id="cb792-136"><a href="tables-and-graphs.html#cb792-136" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-403-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="tables-and-graphs.html#cb793-1" tabindex="-1"></a><span class="co"># record final plot</span></span>
<span id="cb793-2"><a href="tables-and-graphs.html#cb793-2" tabindex="-1"></a>pl_1234_final <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code></pre></div>
<p>We used recordplot() earlier. So now we can print just the first two constructed plots.</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="tables-and-graphs.html#cb794-1" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb794-2"><a href="tables-and-graphs.html#cb794-2" tabindex="-1"></a><span class="co"># Eighth, Plot just the first two saved lines</span></span>
<span id="cb794-3"><a href="tables-and-graphs.html#cb794-3" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb794-4"><a href="tables-and-graphs.html#cb794-4" tabindex="-1"></a><span class="co"># mar: margin, bottom, left, top, right</span></span>
<span id="cb794-5"><a href="tables-and-graphs.html#cb794-5" tabindex="-1"></a>pl_12</span>
<span id="cb794-6"><a href="tables-and-graphs.html#cb794-6" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb794-7"><a href="tables-and-graphs.html#cb794-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb794-8"><a href="tables-and-graphs.html#cb794-8" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb794-9"><a href="tables-and-graphs.html#cb794-9" tabindex="-1"></a>      <span class="at">cex.lab =</span> fl_ces_fig_reg,</span>
<span id="cb794-10"><a href="tables-and-graphs.html#cb794-10" tabindex="-1"></a>      <span class="at">cex.main =</span> fl_ces_fig_reg,</span>
<span id="cb794-11"><a href="tables-and-graphs.html#cb794-11" tabindex="-1"></a>      <span class="at">cex.sub =</span> fl_ces_fig_small)</span>
<span id="cb794-12"><a href="tables-and-graphs.html#cb794-12" tabindex="-1"></a></span>
<span id="cb794-13"><a href="tables-and-graphs.html#cb794-13" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb794-14"><a href="tables-and-graphs.html#cb794-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb794-15"><a href="tables-and-graphs.html#cb794-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb794-16"><a href="tables-and-graphs.html#cb794-16" tabindex="-1"></a>       <span class="at">inset=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="dv">0</span>),</span>
<span id="cb794-17"><a href="tables-and-graphs.html#cb794-17" tabindex="-1"></a>       <span class="at">xpd=</span><span class="cn">TRUE</span>,</span>
<span id="cb794-18"><a href="tables-and-graphs.html#cb794-18" tabindex="-1"></a>       <span class="fu">c</span>(st_point_1_y_legend, st_line_2_y_legend),</span>
<span id="cb794-19"><a href="tables-and-graphs.html#cb794-19" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(st_point_1_blue, st_line_2_red),</span>
<span id="cb794-20"><a href="tables-and-graphs.html#cb794-20" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(st_point_1_pch, <span class="cn">NA</span>),</span>
<span id="cb794-21"><a href="tables-and-graphs.html#cb794-21" tabindex="-1"></a>       <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb794-22"><a href="tables-and-graphs.html#cb794-22" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, st_line_2_lty),</span>
<span id="cb794-23"><a href="tables-and-graphs.html#cb794-23" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, st_line_2_lwd),</span>
<span id="cb794-24"><a href="tables-and-graphs.html#cb794-24" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Legends&#39;</span>,</span>
<span id="cb794-25"><a href="tables-and-graphs.html#cb794-25" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-404-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="ggplot-line-related-plots" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> ggplot Line Related Plots<a href="tables-and-graphs.html#ggplot-line-related-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="ggplot-line-plot-basics" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> ggplot Line Plot Basics<a href="tables-and-graphs.html#ggplot-line-plot-basics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="two-time-series" class="section level4 hasAnchor" number="10.2.1.1">
<h4><span class="header-section-number">10.2.1.1</span> Two Time Series<a href="tables-and-graphs.html#two-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given three time series, we plot them jointly.</p>
<p>First, we construct a dataframe.</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="tables-and-graphs.html#cb795-1" tabindex="-1"></a><span class="co"># Load data, and treat index as &quot;year&quot;</span></span>
<span id="cb795-2"><a href="tables-and-graphs.html#cb795-2" tabindex="-1"></a><span class="co"># pretend data to be country-data</span></span>
<span id="cb795-3"><a href="tables-and-graphs.html#cb795-3" tabindex="-1"></a>df_attitude <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(attitude) <span class="sc">%&gt;%</span></span>
<span id="cb795-4"><a href="tables-and-graphs.html#cb795-4" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;year&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb795-5"><a href="tables-and-graphs.html#cb795-5" tabindex="-1"></a>  <span class="fu">select</span>(year, rating, complaints, learning) <span class="sc">%&gt;%</span> </span>
<span id="cb795-6"><a href="tables-and-graphs.html#cb795-6" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">stats_usa =</span> rating, </span>
<span id="cb795-7"><a href="tables-and-graphs.html#cb795-7" tabindex="-1"></a>         <span class="at">stats_canada =</span> complaints, </span>
<span id="cb795-8"><a href="tables-and-graphs.html#cb795-8" tabindex="-1"></a>         <span class="at">stats_uk =</span> learning)</span>
<span id="cb795-9"><a href="tables-and-graphs.html#cb795-9" tabindex="-1"></a></span>
<span id="cb795-10"><a href="tables-and-graphs.html#cb795-10" tabindex="-1"></a><span class="co"># Wide to Long</span></span>
<span id="cb795-11"><a href="tables-and-graphs.html#cb795-11" tabindex="-1"></a>df_attitude <span class="ot">&lt;-</span> df_attitude <span class="sc">%&gt;%</span></span>
<span id="cb795-12"><a href="tables-and-graphs.html#cb795-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&#39;stats_&#39;</span>),</span>
<span id="cb795-13"><a href="tables-and-graphs.html#cb795-13" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;country&#39;</span>),</span>
<span id="cb795-14"><a href="tables-and-graphs.html#cb795-14" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="fu">paste0</span>(<span class="st">&quot;stats_(.*)&quot;</span>),</span>
<span id="cb795-15"><a href="tables-and-graphs.html#cb795-15" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;rating&quot;</span>)</span>
<span id="cb795-16"><a href="tables-and-graphs.html#cb795-16" tabindex="-1"></a></span>
<span id="cb795-17"><a href="tables-and-graphs.html#cb795-17" tabindex="-1"></a><span class="co"># Print </span></span>
<span id="cb795-18"><a href="tables-and-graphs.html#cb795-18" tabindex="-1"></a><span class="fu">kable</span>(df_attitude[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
year
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
rating
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
canada
</td>
<td style="text-align:right;">
51
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
39
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
63
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
canada
</td>
<td style="text-align:right;">
64
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
54
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
71
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
canada
</td>
<td style="text-align:right;">
70
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
69
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
61
</td>
</tr>
</tbody>
</table>
<p>Second, we generate a basic visualizations with default values.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="tables-and-graphs.html#cb796-1" tabindex="-1"></a><span class="co"># basic chart with two lines</span></span>
<span id="cb796-2"><a href="tables-and-graphs.html#cb796-2" tabindex="-1"></a>pl_lines_basic <span class="ot">&lt;-</span> df_attitude <span class="sc">%&gt;%</span> </span>
<span id="cb796-3"><a href="tables-and-graphs.html#cb796-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>rating, </span>
<span id="cb796-4"><a href="tables-and-graphs.html#cb796-4" tabindex="-1"></a>    <span class="at">color=</span>country, <span class="at">linetype=</span>country)) <span class="sc">+</span> </span>
<span id="cb796-5"><a href="tables-and-graphs.html#cb796-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb796-6"><a href="tables-and-graphs.html#cb796-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;Years&quot;</span>),</span>
<span id="cb796-7"><a href="tables-and-graphs.html#cb796-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;Ratings&quot;</span>),</span>
<span id="cb796-8"><a href="tables-and-graphs.html#cb796-8" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">paste</span>(</span>
<span id="cb796-9"><a href="tables-and-graphs.html#cb796-9" tabindex="-1"></a>        <span class="st">&quot;Main Title for this Figure over&quot;</span>,</span>
<span id="cb796-10"><a href="tables-and-graphs.html#cb796-10" tabindex="-1"></a>        <span class="st">&quot;Countries&quot;</span>, <span class="at">sep=</span><span class="st">&quot; &quot;</span>),</span>
<span id="cb796-11"><a href="tables-and-graphs.html#cb796-11" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(</span>
<span id="cb796-12"><a href="tables-and-graphs.html#cb796-12" tabindex="-1"></a>        <span class="st">&quot;Subtitle for ratings changes across&quot;</span>,</span>
<span id="cb796-13"><a href="tables-and-graphs.html#cb796-13" tabindex="-1"></a>        <span class="st">&quot;countries&quot;</span>, <span class="at">sep=</span><span class="st">&quot; &quot;</span>),</span>
<span id="cb796-14"><a href="tables-and-graphs.html#cb796-14" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(</span>
<span id="cb796-15"><a href="tables-and-graphs.html#cb796-15" tabindex="-1"></a>        <span class="st">&quot;Caption for our figure here &quot;</span>,</span>
<span id="cb796-16"><a href="tables-and-graphs.html#cb796-16" tabindex="-1"></a>        <span class="st">&quot;This is the next line &quot;</span>, </span>
<span id="cb796-17"><a href="tables-and-graphs.html#cb796-17" tabindex="-1"></a>        <span class="st">&quot;Another line&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb796-18"><a href="tables-and-graphs.html#cb796-18" tabindex="-1"></a>  </span>
<span id="cb796-19"><a href="tables-and-graphs.html#cb796-19" tabindex="-1"></a><span class="co"># print figure</span></span>
<span id="cb796-20"><a href="tables-and-graphs.html#cb796-20" tabindex="-1"></a><span class="fu">print</span>(pl_lines_basic)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-407-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Third, we generate a more customized visualization with customized: (1) colors and shapes for lines; (2) x- and y-axis limits, labels, and breaks; (3) customized legend position.</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="tables-and-graphs.html#cb797-1" tabindex="-1"></a><span class="co"># basic chart with two lines</span></span>
<span id="cb797-2"><a href="tables-and-graphs.html#cb797-2" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> df_attitude <span class="sc">%&gt;%</span> </span>
<span id="cb797-3"><a href="tables-and-graphs.html#cb797-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>rating, </span>
<span id="cb797-4"><a href="tables-and-graphs.html#cb797-4" tabindex="-1"></a>    <span class="at">color=</span>country, <span class="at">linetype=</span>country, <span class="at">shape=</span>country)) <span class="sc">+</span> </span>
<span id="cb797-5"><a href="tables-and-graphs.html#cb797-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb797-6"><a href="tables-and-graphs.html#cb797-6" tabindex="-1"></a></span>
<span id="cb797-7"><a href="tables-and-graphs.html#cb797-7" tabindex="-1"></a><span class="co"># Titles</span></span>
<span id="cb797-8"><a href="tables-and-graphs.html#cb797-8" tabindex="-1"></a>st_x <span class="ot">=</span> <span class="st">&quot;Years&quot;</span></span>
<span id="cb797-9"><a href="tables-and-graphs.html#cb797-9" tabindex="-1"></a>st_y <span class="ot">=</span> <span class="st">&quot;Ratings&quot;</span></span>
<span id="cb797-10"><a href="tables-and-graphs.html#cb797-10" tabindex="-1"></a>st_subtitle <span class="ot">=</span> <span class="st">&quot;Ratings changes across countries&quot;</span></span>
<span id="cb797-11"><a href="tables-and-graphs.html#cb797-11" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb797-12"><a href="tables-and-graphs.html#cb797-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb797-13"><a href="tables-and-graphs.html#cb797-13" tabindex="-1"></a>    <span class="at">x =</span> st_x,</span>
<span id="cb797-14"><a href="tables-and-graphs.html#cb797-14" tabindex="-1"></a>    <span class="at">y =</span> st_y,</span>
<span id="cb797-15"><a href="tables-and-graphs.html#cb797-15" tabindex="-1"></a>    <span class="at">subtitle =</span> st_subtitle)</span>
<span id="cb797-16"><a href="tables-and-graphs.html#cb797-16" tabindex="-1"></a>  </span>
<span id="cb797-17"><a href="tables-and-graphs.html#cb797-17" tabindex="-1"></a><span class="co"># Figure improvements</span></span>
<span id="cb797-18"><a href="tables-and-graphs.html#cb797-18" tabindex="-1"></a><span class="co"># set shapes and colors</span></span>
<span id="cb797-19"><a href="tables-and-graphs.html#cb797-19" tabindex="-1"></a>ar_st_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb797-20"><a href="tables-and-graphs.html#cb797-20" tabindex="-1"></a>  <span class="fu">bquote</span>(<span class="st">&quot;Canada&quot;</span>),</span>
<span id="cb797-21"><a href="tables-and-graphs.html#cb797-21" tabindex="-1"></a>  <span class="fu">bquote</span>(<span class="st">&quot;UK&quot;</span>),</span>
<span id="cb797-22"><a href="tables-and-graphs.html#cb797-22" tabindex="-1"></a>  <span class="fu">bquote</span>(<span class="st">&quot;USA&quot;</span>))</span>
<span id="cb797-23"><a href="tables-and-graphs.html#cb797-23" tabindex="-1"></a></span>
<span id="cb797-24"><a href="tables-and-graphs.html#cb797-24" tabindex="-1"></a>ar_st_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#85ccff&quot;</span>, <span class="st">&quot;#026aa3&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb797-25"><a href="tables-and-graphs.html#cb797-25" tabindex="-1"></a>ar_st_linetypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;longdash&quot;</span>)</span>
<span id="cb797-26"><a href="tables-and-graphs.html#cb797-26" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb797-27"><a href="tables-and-graphs.html#cb797-27" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> ar_st_colours, <span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb797-28"><a href="tables-and-graphs.html#cb797-28" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb797-29"><a href="tables-and-graphs.html#cb797-29" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> ar_st_linetypes, <span class="at">labels =</span> ar_st_labels)</span>
<span id="cb797-30"><a href="tables-and-graphs.html#cb797-30" tabindex="-1"></a></span>
<span id="cb797-31"><a href="tables-and-graphs.html#cb797-31" tabindex="-1"></a><span class="co"># Axis</span></span>
<span id="cb797-32"><a href="tables-and-graphs.html#cb797-32" tabindex="-1"></a>x_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Yr 1990&quot;</span>, <span class="st">&quot;Year 2000&quot;</span>, <span class="st">&quot;Y 2010&quot;</span>, <span class="st">&quot;y-2015&quot;</span>, <span class="st">&quot;2020 (year)&quot;</span>)</span>
<span id="cb797-33"><a href="tables-and-graphs.html#cb797-33" tabindex="-1"></a>x_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb797-34"><a href="tables-and-graphs.html#cb797-34" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb797-35"><a href="tables-and-graphs.html#cb797-35" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb797-36"><a href="tables-and-graphs.html#cb797-36" tabindex="-1"></a></span>
<span id="cb797-37"><a href="tables-and-graphs.html#cb797-37" tabindex="-1"></a>y_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">90</span>, <span class="at">length.out=</span><span class="dv">6</span>)</span>
<span id="cb797-38"><a href="tables-and-graphs.html#cb797-38" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;y=&#39;</span>, y_breaks)</span>
<span id="cb797-39"><a href="tables-and-graphs.html#cb797-39" tabindex="-1"></a>y_min <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb797-40"><a href="tables-and-graphs.html#cb797-40" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb797-41"><a href="tables-and-graphs.html#cb797-41" tabindex="-1"></a></span>
<span id="cb797-42"><a href="tables-and-graphs.html#cb797-42" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span> </span>
<span id="cb797-43"><a href="tables-and-graphs.html#cb797-43" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb797-44"><a href="tables-and-graphs.html#cb797-44" tabindex="-1"></a>    <span class="at">labels =</span> x_labels, <span class="at">breaks =</span> x_breaks,</span>
<span id="cb797-45"><a href="tables-and-graphs.html#cb797-45" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(x_min, x_max)</span>
<span id="cb797-46"><a href="tables-and-graphs.html#cb797-46" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb797-47"><a href="tables-and-graphs.html#cb797-47" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb797-48"><a href="tables-and-graphs.html#cb797-48" tabindex="-1"></a>    <span class="co"># Adjust x-label angle</span></span>
<span id="cb797-49"><a href="tables-and-graphs.html#cb797-49" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">45</span>, </span>
<span id="cb797-50"><a href="tables-and-graphs.html#cb797-50" tabindex="-1"></a>    <span class="co"># Adjust x-label distance to x-axis (up vs down)</span></span>
<span id="cb797-51"><a href="tables-and-graphs.html#cb797-51" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">0.4</span>, </span>
<span id="cb797-52"><a href="tables-and-graphs.html#cb797-52" tabindex="-1"></a>    <span class="co"># Adjust x-label left vs right wwith respect ot break point</span></span>
<span id="cb797-53"><a href="tables-and-graphs.html#cb797-53" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb797-54"><a href="tables-and-graphs.html#cb797-54" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb797-55"><a href="tables-and-graphs.html#cb797-55" tabindex="-1"></a>    <span class="at">labels =</span> y_labels, <span class="at">breaks =</span> y_breaks,</span>
<span id="cb797-56"><a href="tables-and-graphs.html#cb797-56" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(y_min, y_max)</span>
<span id="cb797-57"><a href="tables-and-graphs.html#cb797-57" tabindex="-1"></a>  )</span>
<span id="cb797-58"><a href="tables-and-graphs.html#cb797-58" tabindex="-1"></a></span>
<span id="cb797-59"><a href="tables-and-graphs.html#cb797-59" tabindex="-1"></a><span class="co"># print figure</span></span>
<span id="cb797-60"><a href="tables-and-graphs.html#cb797-60" tabindex="-1"></a><span class="fu">print</span>(pl_lines)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-408-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="ggplot-line-advanced" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> ggplot Line Advanced<a href="tables-and-graphs.html#ggplot-line-advanced" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="continuous-y-and-x-variables-three-categories-one-is-subplot" class="section level4 hasAnchor" number="10.2.2.1">
<h4><span class="header-section-number">10.2.2.1</span> Continuous Y and X Variables, Three Categories, One is Subplot<a href="tables-and-graphs.html#continuous-y-and-x-variables-three-categories-one-is-subplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Visualize one continuous variable, along the x-axis, given three categorical variables, with 12 combined categories <span class="math inline">\(3\times2\times2=12\)</span>:</p>
<ul>
<li>one as subplot (productivity type), 3 unique values</li>
<li>one as line-color (gamma levels), 2 unique values</li>
<li>one as line-type (GE vs PE), 2 unique values</li>
</ul>
<p>The outcome is continuous CEV, generated for results with different productivity types (subplot), generated for PE vs GE (linetype), and at different parameter specifications (lower and higher gamma). X-axis is continuous. The graphs rely on this csv file <a href="https://github.com/FanWangEcon/R4Econ/tree/master/tabgraph/ggline/_file">cev_data.csv</a>.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="tables-and-graphs.html#cb798-1" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb798-2"><a href="tables-and-graphs.html#cb798-2" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb798-3"><a href="tables-and-graphs.html#cb798-3" tabindex="-1"></a></span>
<span id="cb798-4"><a href="tables-and-graphs.html#cb798-4" tabindex="-1"></a><span class="co"># Load in CSV</span></span>
<span id="cb798-5"><a href="tables-and-graphs.html#cb798-5" tabindex="-1"></a>bl_save_img <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb798-6"><a href="tables-and-graphs.html#cb798-6" tabindex="-1"></a>spt_csv_root <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;C:/Users/fan/R4Econ/tabgraph/ggline/_file/&quot;</span>)</span>
<span id="cb798-7"><a href="tables-and-graphs.html#cb798-7" tabindex="-1"></a>spt_img_root <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;C:/Users/fan/R4Econ/tabgraph/ggline/_file/&quot;</span>)</span>
<span id="cb798-8"><a href="tables-and-graphs.html#cb798-8" tabindex="-1"></a>spn_cev_data <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_csv_root, <span class="st">&quot;cev_data.csv&quot;</span>)</span>
<span id="cb798-9"><a href="tables-and-graphs.html#cb798-9" tabindex="-1"></a>spn_cev_graph <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_img_root, <span class="st">&quot;cev_graph.png&quot;</span>)</span>
<span id="cb798-10"><a href="tables-and-graphs.html#cb798-10" tabindex="-1"></a>spn_cev_graph_eps <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_img_root, <span class="st">&quot;cev_graph.eps&quot;</span>)</span>
<span id="cb798-11"><a href="tables-and-graphs.html#cb798-11" tabindex="-1"></a>df_cev_graph <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read.csv</span>(spn_cev_data)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>X)</span>
<span id="cb798-12"><a href="tables-and-graphs.html#cb798-12" tabindex="-1"></a></span>
<span id="cb798-13"><a href="tables-and-graphs.html#cb798-13" tabindex="-1"></a><span class="co"># Dataset subsetting ------</span></span>
<span id="cb798-14"><a href="tables-and-graphs.html#cb798-14" tabindex="-1"></a></span>
<span id="cb798-15"><a href="tables-and-graphs.html#cb798-15" tabindex="-1"></a><span class="co"># Line Patterns and Colors ------</span></span>
<span id="cb798-16"><a href="tables-and-graphs.html#cb798-16" tabindex="-1"></a><span class="co"># ar_st_age_group_leg_labels &lt;- c(&quot;\nGE\n\u03B3=0.42\n&quot;, &quot;\nGE\n\u03B3=0.56\n&quot;,</span></span>
<span id="cb798-17"><a href="tables-and-graphs.html#cb798-17" tabindex="-1"></a><span class="co">#                                 &quot;\nPE\n\u03B3=0.42\n&quot;, &quot;\nPE\n\u03B3=0.42\n&quot;)</span></span>
<span id="cb798-18"><a href="tables-and-graphs.html#cb798-18" tabindex="-1"></a>ar_st_age_group_leg_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb798-19"><a href="tables-and-graphs.html#cb798-19" tabindex="-1"></a>  <span class="fu">bquote</span>(<span class="st">&quot;GE,&quot;</span> <span class="sc">~</span> gamma <span class="sc">==</span> .(<span class="fl">0.42</span>)),</span>
<span id="cb798-20"><a href="tables-and-graphs.html#cb798-20" tabindex="-1"></a>  <span class="fu">bquote</span>(<span class="st">&quot;GE,&quot;</span> <span class="sc">~</span> gamma <span class="sc">==</span> .(<span class="fl">0.56</span>)),</span>
<span id="cb798-21"><a href="tables-and-graphs.html#cb798-21" tabindex="-1"></a>  <span class="fu">bquote</span>(<span class="st">&quot;PE,&quot;</span> <span class="sc">~</span> gamma <span class="sc">==</span> .(<span class="fl">0.42</span>)),</span>
<span id="cb798-22"><a href="tables-and-graphs.html#cb798-22" tabindex="-1"></a>  <span class="fu">bquote</span>(<span class="st">&quot;PE,&quot;</span> <span class="sc">~</span> gamma <span class="sc">==</span> .(<span class="fl">0.56</span>))</span>
<span id="cb798-23"><a href="tables-and-graphs.html#cb798-23" tabindex="-1"></a>)</span>
<span id="cb798-24"><a href="tables-and-graphs.html#cb798-24" tabindex="-1"></a>ar_st_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#85ccff&quot;</span>, <span class="st">&quot;#026aa3&quot;</span>, <span class="st">&quot;#85ccff&quot;</span>, <span class="st">&quot;#026aa3&quot;</span>)</span>
<span id="cb798-25"><a href="tables-and-graphs.html#cb798-25" tabindex="-1"></a>ar_st_linetypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;longdash&quot;</span>)</span>
<span id="cb798-26"><a href="tables-and-graphs.html#cb798-26" tabindex="-1"></a></span>
<span id="cb798-27"><a href="tables-and-graphs.html#cb798-27" tabindex="-1"></a><span class="co"># Labels and Other Strings -------</span></span>
<span id="cb798-28"><a href="tables-and-graphs.html#cb798-28" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb798-29"><a href="tables-and-graphs.html#cb798-29" tabindex="-1"></a>st_x <span class="ot">&lt;-</span> <span class="st">&quot;Wealth&quot;</span></span>
<span id="cb798-30"><a href="tables-and-graphs.html#cb798-30" tabindex="-1"></a>st_y <span class="ot">&lt;-</span> <span class="st">&quot;Welfare Gain (% CEV)&quot;</span></span>
<span id="cb798-31"><a href="tables-and-graphs.html#cb798-31" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb798-32"><a href="tables-and-graphs.html#cb798-32" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb798-33"><a href="tables-and-graphs.html#cb798-33" tabindex="-1"></a>  <span class="st">&quot;R4Econ/tabgraph/ggline/htmlpdfr/fs_ggline_mgrp_ncts.html&quot;</span></span>
<span id="cb798-34"><a href="tables-and-graphs.html#cb798-34" tabindex="-1"></a>)</span>
<span id="cb798-35"><a href="tables-and-graphs.html#cb798-35" tabindex="-1"></a></span>
<span id="cb798-36"><a href="tables-and-graphs.html#cb798-36" tabindex="-1"></a><span class="co"># ar_st_age_group_leg_labels &lt;- c(&quot;C\u2013Optimal&quot;, &quot;V\u2013Optimal&quot;)</span></span>
<span id="cb798-37"><a href="tables-and-graphs.html#cb798-37" tabindex="-1"></a></span>
<span id="cb798-38"><a href="tables-and-graphs.html#cb798-38" tabindex="-1"></a>prod_type_recode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb798-39"><a href="tables-and-graphs.html#cb798-39" tabindex="-1"></a>  <span class="st">&quot;Productivity Type</span><span class="sc">\n</span><span class="st">(-1 sd)&quot;</span> <span class="ot">=</span> <span class="st">&quot;8993&quot;</span>,</span>
<span id="cb798-40"><a href="tables-and-graphs.html#cb798-40" tabindex="-1"></a>  <span class="st">&quot;Productivity Type</span><span class="sc">\n</span><span class="st">(mean)&quot;</span> <span class="ot">=</span> <span class="st">&quot;10189&quot;</span>,</span>
<span id="cb798-41"><a href="tables-and-graphs.html#cb798-41" tabindex="-1"></a>  <span class="st">&quot;Productivity Type</span><span class="sc">\n</span><span class="st">(+1 sd)&quot;</span> <span class="ot">=</span> <span class="st">&quot;12244&quot;</span></span>
<span id="cb798-42"><a href="tables-and-graphs.html#cb798-42" tabindex="-1"></a>)</span>
<span id="cb798-43"><a href="tables-and-graphs.html#cb798-43" tabindex="-1"></a></span>
<span id="cb798-44"><a href="tables-and-graphs.html#cb798-44" tabindex="-1"></a>x_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;200k&quot;</span>, <span class="st">&quot;400k&quot;</span>, <span class="st">&quot;600k&quot;</span>, <span class="st">&quot;800k&quot;</span>)</span>
<span id="cb798-45"><a href="tables-and-graphs.html#cb798-45" tabindex="-1"></a>x_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb798-46"><a href="tables-and-graphs.html#cb798-46" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb798-47"><a href="tables-and-graphs.html#cb798-47" tabindex="-1"></a>  <span class="dv">5</span>,</span>
<span id="cb798-48"><a href="tables-and-graphs.html#cb798-48" tabindex="-1"></a>  <span class="dv">10</span>,</span>
<span id="cb798-49"><a href="tables-and-graphs.html#cb798-49" tabindex="-1"></a>  <span class="dv">15</span>,</span>
<span id="cb798-50"><a href="tables-and-graphs.html#cb798-50" tabindex="-1"></a>  <span class="dv">20</span></span>
<span id="cb798-51"><a href="tables-and-graphs.html#cb798-51" tabindex="-1"></a>)</span>
<span id="cb798-52"><a href="tables-and-graphs.html#cb798-52" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb798-53"><a href="tables-and-graphs.html#cb798-53" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb798-54"><a href="tables-and-graphs.html#cb798-54" tabindex="-1"></a></span>
<span id="cb798-55"><a href="tables-and-graphs.html#cb798-55" tabindex="-1"></a><span class="co"># y_labels &lt;- c(&#39;-0.01&#39;,</span></span>
<span id="cb798-56"><a href="tables-and-graphs.html#cb798-56" tabindex="-1"></a><span class="co">#               &#39;\u2191\u2191\nWelfare\nGain\n\nCEV=0\n\nWelfare\nLoss\n\u2193\u2193&#39;,</span></span>
<span id="cb798-57"><a href="tables-and-graphs.html#cb798-57" tabindex="-1"></a><span class="co">#               &#39;+0.01&#39;, &#39;+0.02&#39;, &#39;+0.03&#39;, &#39;+0.04&#39;,&#39;+0.05&#39;)</span></span>
<span id="cb798-58"><a href="tables-and-graphs.html#cb798-58" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb798-59"><a href="tables-and-graphs.html#cb798-59" tabindex="-1"></a>  <span class="st">&quot;-0.5 pp&quot;</span>,</span>
<span id="cb798-60"><a href="tables-and-graphs.html#cb798-60" tabindex="-1"></a>  <span class="st">&quot;CEV=0&quot;</span>,</span>
<span id="cb798-61"><a href="tables-and-graphs.html#cb798-61" tabindex="-1"></a>  <span class="st">&quot;+0.5 pp&quot;</span>, <span class="st">&quot;+1.0 pp&quot;</span>, <span class="st">&quot;+1.5 pp&quot;</span>, <span class="st">&quot;+2.0 pp&quot;</span>, <span class="st">&quot;+2.5 pp&quot;</span></span>
<span id="cb798-62"><a href="tables-and-graphs.html#cb798-62" tabindex="-1"></a>)</span>
<span id="cb798-63"><a href="tables-and-graphs.html#cb798-63" tabindex="-1"></a>y_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.01</span>, <span class="dv">0</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>)</span>
<span id="cb798-64"><a href="tables-and-graphs.html#cb798-64" tabindex="-1"></a>y_min <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.011</span></span>
<span id="cb798-65"><a href="tables-and-graphs.html#cb798-65" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="fl">0.051</span></span>
<span id="cb798-66"><a href="tables-and-graphs.html#cb798-66" tabindex="-1"></a></span>
<span id="cb798-67"><a href="tables-and-graphs.html#cb798-67" tabindex="-1"></a><span class="co"># data change -------</span></span>
<span id="cb798-68"><a href="tables-and-graphs.html#cb798-68" tabindex="-1"></a>df_cev_graph <span class="ot">&lt;-</span> df_cev_graph <span class="sc">%&gt;%</span></span>
<span id="cb798-69"><a href="tables-and-graphs.html#cb798-69" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(counter_policy, <span class="sc">~</span> <span class="fu">grepl</span>(<span class="st">&quot;70|42&quot;</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb798-70"><a href="tables-and-graphs.html#cb798-70" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prod_type_lvl =</span> <span class="fu">as.factor</span>(prod_type_lvl)) <span class="sc">%&gt;%</span></span>
<span id="cb798-71"><a href="tables-and-graphs.html#cb798-71" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prod_type_lvl =</span> <span class="fu">fct_recode</span>(prod_type_lvl, <span class="sc">!!!</span>prod_type_recode))</span>
<span id="cb798-72"><a href="tables-and-graphs.html#cb798-72" tabindex="-1"></a></span>
<span id="cb798-73"><a href="tables-and-graphs.html#cb798-73" tabindex="-1"></a><span class="co"># graph ------</span></span>
<span id="cb798-74"><a href="tables-and-graphs.html#cb798-74" tabindex="-1"></a>pl_cev <span class="ot">&lt;-</span> df_cev_graph <span class="sc">%&gt;%</span></span>
<span id="cb798-75"><a href="tables-and-graphs.html#cb798-75" tabindex="-1"></a>  <span class="fu">group_by</span>(prod_type_st, cash_tt) <span class="sc">%&gt;%</span></span>
<span id="cb798-76"><a href="tables-and-graphs.html#cb798-76" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb798-77"><a href="tables-and-graphs.html#cb798-77" tabindex="-1"></a>    <span class="at">x =</span> cash_tt, <span class="at">y =</span> cev_lvl,</span>
<span id="cb798-78"><a href="tables-and-graphs.html#cb798-78" tabindex="-1"></a>    <span class="at">colour =</span> counter_policy, <span class="at">linetype =</span> counter_policy, <span class="at">shape =</span> counter_policy</span>
<span id="cb798-79"><a href="tables-and-graphs.html#cb798-79" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb798-80"><a href="tables-and-graphs.html#cb798-80" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>prod_type_lvl, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb798-81"><a href="tables-and-graphs.html#cb798-81" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;auto&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">FALSE</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb798-82"><a href="tables-and-graphs.html#cb798-82" tabindex="-1"></a></span>
<span id="cb798-83"><a href="tables-and-graphs.html#cb798-83" tabindex="-1"></a><span class="co"># labels</span></span>
<span id="cb798-84"><a href="tables-and-graphs.html#cb798-84" tabindex="-1"></a>pl_cev <span class="ot">&lt;-</span> pl_cev <span class="sc">+</span></span>
<span id="cb798-85"><a href="tables-and-graphs.html#cb798-85" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb798-86"><a href="tables-and-graphs.html#cb798-86" tabindex="-1"></a>    <span class="at">x =</span> st_x,</span>
<span id="cb798-87"><a href="tables-and-graphs.html#cb798-87" tabindex="-1"></a>    <span class="at">y =</span> st_y,</span>
<span id="cb798-88"><a href="tables-and-graphs.html#cb798-88" tabindex="-1"></a>    <span class="at">subtitle =</span> st_subtitle</span>
<span id="cb798-89"><a href="tables-and-graphs.html#cb798-89" tabindex="-1"></a>  )</span>
<span id="cb798-90"><a href="tables-and-graphs.html#cb798-90" tabindex="-1"></a></span>
<span id="cb798-91"><a href="tables-and-graphs.html#cb798-91" tabindex="-1"></a><span class="co"># set shapes and colors</span></span>
<span id="cb798-92"><a href="tables-and-graphs.html#cb798-92" tabindex="-1"></a>pl_cev <span class="ot">&lt;-</span> pl_cev <span class="sc">+</span></span>
<span id="cb798-93"><a href="tables-and-graphs.html#cb798-93" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> ar_st_colours, <span class="at">labels =</span> ar_st_age_group_leg_labels) <span class="sc">+</span></span>
<span id="cb798-94"><a href="tables-and-graphs.html#cb798-94" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">labels =</span> ar_st_age_group_leg_labels) <span class="sc">+</span></span>
<span id="cb798-95"><a href="tables-and-graphs.html#cb798-95" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> ar_st_linetypes, <span class="at">labels =</span> ar_st_age_group_leg_labels) <span class="sc">+</span></span>
<span id="cb798-96"><a href="tables-and-graphs.html#cb798-96" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb798-97"><a href="tables-and-graphs.html#cb798-97" tabindex="-1"></a>    <span class="at">labels =</span> x_labels, <span class="at">breaks =</span> x_breaks,</span>
<span id="cb798-98"><a href="tables-and-graphs.html#cb798-98" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(x_min, x_max)</span>
<span id="cb798-99"><a href="tables-and-graphs.html#cb798-99" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb798-100"><a href="tables-and-graphs.html#cb798-100" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb798-101"><a href="tables-and-graphs.html#cb798-101" tabindex="-1"></a>    <span class="at">labels =</span> y_labels, <span class="at">breaks =</span> y_breaks,</span>
<span id="cb798-102"><a href="tables-and-graphs.html#cb798-102" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(y_min, y_max)</span>
<span id="cb798-103"><a href="tables-and-graphs.html#cb798-103" tabindex="-1"></a>  )</span>
<span id="cb798-104"><a href="tables-and-graphs.html#cb798-104" tabindex="-1"></a></span>
<span id="cb798-105"><a href="tables-and-graphs.html#cb798-105" tabindex="-1"></a><span class="co"># Horizontal line</span></span>
<span id="cb798-106"><a href="tables-and-graphs.html#cb798-106" tabindex="-1"></a>pl_cev <span class="ot">&lt;-</span> pl_cev <span class="sc">+</span></span>
<span id="cb798-107"><a href="tables-and-graphs.html#cb798-107" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb798-108"><a href="tables-and-graphs.html#cb798-108" tabindex="-1"></a><span class="co"># geom_hline(yintercept=0, linetype=&#39;dotted&#39;, colour=&quot;black&quot;, size=2)</span></span>
<span id="cb798-109"><a href="tables-and-graphs.html#cb798-109" tabindex="-1"></a></span>
<span id="cb798-110"><a href="tables-and-graphs.html#cb798-110" tabindex="-1"></a><span class="co"># theme</span></span>
<span id="cb798-111"><a href="tables-and-graphs.html#cb798-111" tabindex="-1"></a>pl_cev <span class="ot">&lt;-</span> pl_cev <span class="sc">+</span></span>
<span id="cb798-112"><a href="tables-and-graphs.html#cb798-112" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb798-113"><a href="tables-and-graphs.html#cb798-113" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb798-114"><a href="tables-and-graphs.html#cb798-114" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb798-115"><a href="tables-and-graphs.html#cb798-115" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb798-116"><a href="tables-and-graphs.html#cb798-116" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.16</span>, <span class="fl">0.65</span>),</span>
<span id="cb798-117"><a href="tables-and-graphs.html#cb798-117" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb798-118"><a href="tables-and-graphs.html#cb798-118" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb798-119"><a href="tables-and-graphs.html#cb798-119" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb798-120"><a href="tables-and-graphs.html#cb798-120" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb798-121"><a href="tables-and-graphs.html#cb798-121" tabindex="-1"></a>    ),</span>
<span id="cb798-122"><a href="tables-and-graphs.html#cb798-122" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb798-123"><a href="tables-and-graphs.html#cb798-123" tabindex="-1"></a>  )</span>
<span id="cb798-124"><a href="tables-and-graphs.html#cb798-124" tabindex="-1"></a></span>
<span id="cb798-125"><a href="tables-and-graphs.html#cb798-125" tabindex="-1"></a><span class="co"># Print Images to Screen -----</span></span>
<span id="cb798-126"><a href="tables-and-graphs.html#cb798-126" tabindex="-1"></a><span class="fu">print</span>(pl_cev)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-410-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="tables-and-graphs.html#cb799-1" tabindex="-1"></a><span class="co"># Save Image Outputs -----</span></span>
<span id="cb799-2"><a href="tables-and-graphs.html#cb799-2" tabindex="-1"></a><span class="cf">if</span> (bl_save_img) {</span>
<span id="cb799-3"><a href="tables-and-graphs.html#cb799-3" tabindex="-1"></a>  <span class="fu">png</span>(spn_cev_graph,</span>
<span id="cb799-4"><a href="tables-and-graphs.html#cb799-4" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">160</span>,</span>
<span id="cb799-5"><a href="tables-and-graphs.html#cb799-5" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">105</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>,</span>
<span id="cb799-6"><a href="tables-and-graphs.html#cb799-6" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">150</span>, <span class="at">pointsize =</span> <span class="dv">7</span></span>
<span id="cb799-7"><a href="tables-and-graphs.html#cb799-7" tabindex="-1"></a>  )</span>
<span id="cb799-8"><a href="tables-and-graphs.html#cb799-8" tabindex="-1"></a>  <span class="fu">ggsave</span>(</span>
<span id="cb799-9"><a href="tables-and-graphs.html#cb799-9" tabindex="-1"></a>    spn_cev_graph_eps,</span>
<span id="cb799-10"><a href="tables-and-graphs.html#cb799-10" tabindex="-1"></a>    <span class="at">plot =</span> <span class="fu">last_plot</span>(),</span>
<span id="cb799-11"><a href="tables-and-graphs.html#cb799-11" tabindex="-1"></a>    <span class="at">device =</span> <span class="st">&quot;eps&quot;</span>,</span>
<span id="cb799-12"><a href="tables-and-graphs.html#cb799-12" tabindex="-1"></a>    <span class="at">path =</span> <span class="cn">NULL</span>,</span>
<span id="cb799-13"><a href="tables-and-graphs.html#cb799-13" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb799-14"><a href="tables-and-graphs.html#cb799-14" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">200</span>,</span>
<span id="cb799-15"><a href="tables-and-graphs.html#cb799-15" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">100</span>,</span>
<span id="cb799-16"><a href="tables-and-graphs.html#cb799-16" tabindex="-1"></a>    <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb799-17"><a href="tables-and-graphs.html#cb799-17" tabindex="-1"></a>    <span class="at">dpi =</span> <span class="dv">150</span>,</span>
<span id="cb799-18"><a href="tables-and-graphs.html#cb799-18" tabindex="-1"></a>    <span class="at">limitsize =</span> <span class="cn">TRUE</span></span>
<span id="cb799-19"><a href="tables-and-graphs.html#cb799-19" tabindex="-1"></a>  )</span>
<span id="cb799-20"><a href="tables-and-graphs.html#cb799-20" tabindex="-1"></a>  <span class="fu">print</span>(pl_cev)</span>
<span id="cb799-21"><a href="tables-and-graphs.html#cb799-21" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb799-22"><a href="tables-and-graphs.html#cb799-22" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
</div>
<div id="continuous-y-and-x-variables-two-categories-one-is-subplot" class="section level4 hasAnchor" number="10.2.2.2">
<h4><span class="header-section-number">10.2.2.2</span> Continuous Y and X Variables, Two Categories, One is Subplot<a href="tables-and-graphs.html#continuous-y-and-x-variables-two-categories-one-is-subplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In contrast to the first line plot, in this second example, we use both varying line color as well as line shape and scatter type to distinguish categories of one categorical variable. Visualize one continuous variable, along the x-axis, given three categorical variables, with 10 combined categories <span class="math inline">\(2\times5=10\)</span>:</p>
<ul>
<li>one as subplot (GE vs PE), 2 unique values</li>
<li>one with line-color, line-color and scatter shape joint variation (counterfactual type), 5 unique values</li>
</ul>
<p>The outcome is change in male and female labor participation gaps, generated under partial and general equilibrium (subplot), generated for different counterfactual policies (linetype). X-axis is calendar year. Features:</p>
<ul>
<li>Calendar year as x-axis</li>
<li>Line + scatter with varying line patterns and scatter shapes</li>
<li>Scatter shapes</li>
<li>Show five lines together, with 2 lines stand out more, and 4 lines overall different than 1</li>
<li>Legend box area with longer legend text, transparent and no border</li>
</ul>
<p>For data processing, converts all possible numerical variables to numeric.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="tables-and-graphs.html#cb801-1" tabindex="-1"></a><span class="co"># Load in CSV</span></span>
<span id="cb801-2"><a href="tables-and-graphs.html#cb801-2" tabindex="-1"></a>bl_save_img <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb801-3"><a href="tables-and-graphs.html#cb801-3" tabindex="-1"></a>spt_csv_root <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;C:/Users/fan/R4Econ/tabgraph/ggline/_file/&quot;</span>)</span>
<span id="cb801-4"><a href="tables-and-graphs.html#cb801-4" tabindex="-1"></a>spt_img_root <span class="ot">&lt;-</span> spt_csv_root</span>
<span id="cb801-5"><a href="tables-and-graphs.html#cb801-5" tabindex="-1"></a>spn_flfp_sklocc_data <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_csv_root, <span class="st">&quot;flfp_data.csv&quot;</span>)</span>
<span id="cb801-6"><a href="tables-and-graphs.html#cb801-6" tabindex="-1"></a>spn_flfp_sklocc_graph <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_img_root, <span class="st">&quot;flfp_sam2fshr_graph.png&quot;</span>)</span>
<span id="cb801-7"><a href="tables-and-graphs.html#cb801-7" tabindex="-1"></a>spn_flfp_sklocc_graph_eps <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_img_root, <span class="st">&quot;flfp_sam2fshr_graph.eps&quot;</span>)</span>
<span id="cb801-8"><a href="tables-and-graphs.html#cb801-8" tabindex="-1"></a></span>
<span id="cb801-9"><a href="tables-and-graphs.html#cb801-9" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb801-10"><a href="tables-and-graphs.html#cb801-10" tabindex="-1"></a><span class="co"># Convert all convertable numeric columns from string to numeric</span></span>
<span id="cb801-11"><a href="tables-and-graphs.html#cb801-11" tabindex="-1"></a><span class="co"># https://stackoverflow.com/a/49054046/8280804</span></span>
<span id="cb801-12"><a href="tables-and-graphs.html#cb801-12" tabindex="-1"></a>is_all_numeric <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb801-13"><a href="tables-and-graphs.html#cb801-13" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(<span class="fu">na.omit</span>(x))))) <span class="sc">&amp;</span> <span class="fu">is.character</span>(x)</span>
<span id="cb801-14"><a href="tables-and-graphs.html#cb801-14" tabindex="-1"></a>}</span>
<span id="cb801-15"><a href="tables-and-graphs.html#cb801-15" tabindex="-1"></a>df_flfp <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read.csv</span>(spn_flfp_sklocc_data)) <span class="sc">%&gt;%</span></span>
<span id="cb801-16"><a href="tables-and-graphs.html#cb801-16" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is_all_numeric, as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb801-17"><a href="tables-and-graphs.html#cb801-17" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="dv">2014</span>)</span>
<span id="cb801-18"><a href="tables-and-graphs.html#cb801-18" tabindex="-1"></a></span>
<span id="cb801-19"><a href="tables-and-graphs.html#cb801-19" tabindex="-1"></a><span class="co"># Dataset subsetting ------</span></span>
<span id="cb801-20"><a href="tables-and-graphs.html#cb801-20" tabindex="-1"></a></span>
<span id="cb801-21"><a href="tables-and-graphs.html#cb801-21" tabindex="-1"></a><span class="co"># Line Patterns and Colors ------</span></span>
<span id="cb801-22"><a href="tables-and-graphs.html#cb801-22" tabindex="-1"></a>ctr_var_recode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb801-23"><a href="tables-and-graphs.html#cb801-23" tabindex="-1"></a>  <span class="st">&quot;No change&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb801-24"><a href="tables-and-graphs.html#cb801-24" tabindex="-1"></a>  <span class="st">&quot;Married&quot;</span> <span class="ot">=</span> <span class="st">&quot;31&quot;</span>,</span>
<span id="cb801-25"><a href="tables-and-graphs.html#cb801-25" tabindex="-1"></a>  <span class="st">&quot;Children &lt; 5&quot;</span> <span class="ot">=</span> <span class="st">&quot;32&quot;</span>,</span>
<span id="cb801-26"><a href="tables-and-graphs.html#cb801-26" tabindex="-1"></a>  <span class="st">&quot;Appliance&quot;</span> <span class="ot">=</span> <span class="st">&quot;33&quot;</span>,</span>
<span id="cb801-27"><a href="tables-and-graphs.html#cb801-27" tabindex="-1"></a>  <span class="st">&quot;WBL Index&quot;</span> <span class="ot">=</span> <span class="st">&quot;34&quot;</span></span>
<span id="cb801-28"><a href="tables-and-graphs.html#cb801-28" tabindex="-1"></a>)</span>
<span id="cb801-29"><a href="tables-and-graphs.html#cb801-29" tabindex="-1"></a></span>
<span id="cb801-30"><a href="tables-and-graphs.html#cb801-30" tabindex="-1"></a><span class="co"># https://www.rgbtohex.net/</span></span>
<span id="cb801-31"><a href="tables-and-graphs.html#cb801-31" tabindex="-1"></a>ar_st_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#262626&quot;</span>, <span class="st">&quot;#FFC001&quot;</span>, <span class="st">&quot;#ED8137&quot;</span>, <span class="st">&quot;#4472C4&quot;</span>, <span class="st">&quot;#3E9651&quot;</span>)</span>
<span id="cb801-32"><a href="tables-and-graphs.html#cb801-32" tabindex="-1"></a><span class="co"># http://www.sthda.com/english/wiki/ggplot2-line-types-how-to-change-line-types-of-a-graph-in-r-software</span></span>
<span id="cb801-33"><a href="tables-and-graphs.html#cb801-33" tabindex="-1"></a>ar_st_linetypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>)</span>
<span id="cb801-34"><a href="tables-and-graphs.html#cb801-34" tabindex="-1"></a><span class="co"># http://sape.inf.usi.ch/quick-reference/ggplot2/shape</span></span>
<span id="cb801-35"><a href="tables-and-graphs.html#cb801-35" tabindex="-1"></a><span class="co"># 32 is invisible shape</span></span>
<span id="cb801-36"><a href="tables-and-graphs.html#cb801-36" tabindex="-1"></a>ar_it_shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">5</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">1</span>)</span>
<span id="cb801-37"><a href="tables-and-graphs.html#cb801-37" tabindex="-1"></a></span>
<span id="cb801-38"><a href="tables-and-graphs.html#cb801-38" tabindex="-1"></a><span class="co"># Labels and Other Strings -------</span></span>
<span id="cb801-39"><a href="tables-and-graphs.html#cb801-39" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb801-40"><a href="tables-and-graphs.html#cb801-40" tabindex="-1"></a>st_x <span class="ot">&lt;-</span> <span class="st">&quot;Years&quot;</span></span>
<span id="cb801-41"><a href="tables-and-graphs.html#cb801-41" tabindex="-1"></a>st_y <span class="ot">&lt;-</span> <span class="st">&quot;Change in Aggregate (Male - Female) Participation Shares&quot;</span></span>
<span id="cb801-42"><a href="tables-and-graphs.html#cb801-42" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb801-43"><a href="tables-and-graphs.html#cb801-43" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb801-44"><a href="tables-and-graphs.html#cb801-44" tabindex="-1"></a>  <span class="st">&quot;R4Econ/tabgraph/ggline/htmlpdfr/fs_ggline_mgrp_ncts.html&quot;</span></span>
<span id="cb801-45"><a href="tables-and-graphs.html#cb801-45" tabindex="-1"></a>)</span>
<span id="cb801-46"><a href="tables-and-graphs.html#cb801-46" tabindex="-1"></a></span>
<span id="cb801-47"><a href="tables-and-graphs.html#cb801-47" tabindex="-1"></a><span class="co"># ge_pe_recode &lt;- c(</span></span>
<span id="cb801-48"><a href="tables-and-graphs.html#cb801-48" tabindex="-1"></a><span class="co">#   &quot;General Equilibrium\n(Adjust Wages)&quot; = &quot;GE&quot;,</span></span>
<span id="cb801-49"><a href="tables-and-graphs.html#cb801-49" tabindex="-1"></a><span class="co">#   &quot;Partial Equilibrium\n(Wage as Observed)&quot; = &quot;PE&quot;</span></span>
<span id="cb801-50"><a href="tables-and-graphs.html#cb801-50" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb801-51"><a href="tables-and-graphs.html#cb801-51" tabindex="-1"></a>ge_pe_recode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb801-52"><a href="tables-and-graphs.html#cb801-52" tabindex="-1"></a>  <span class="st">&quot;General Equilibrium&quot;</span> <span class="ot">=</span> <span class="st">&quot;GE&quot;</span>,</span>
<span id="cb801-53"><a href="tables-and-graphs.html#cb801-53" tabindex="-1"></a>  <span class="st">&quot;Partial Equilibrium&quot;</span> <span class="ot">=</span> <span class="st">&quot;PE&quot;</span></span>
<span id="cb801-54"><a href="tables-and-graphs.html#cb801-54" tabindex="-1"></a>)</span>
<span id="cb801-55"><a href="tables-and-graphs.html#cb801-55" tabindex="-1"></a><span class="co"># x.breaks &lt;- c(1989, seq(1992, 2004, by = 2), 2005, seq(2008, 2014, by = 2))</span></span>
<span id="cb801-56"><a href="tables-and-graphs.html#cb801-56" tabindex="-1"></a><span class="co"># x.labels &lt;- paste(x.breaks[1:13])</span></span>
<span id="cb801-57"><a href="tables-and-graphs.html#cb801-57" tabindex="-1"></a>x.breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1989</span>, <span class="dv">2014</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb801-58"><a href="tables-and-graphs.html#cb801-58" tabindex="-1"></a>x.labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(x.breaks[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb801-59"><a href="tables-and-graphs.html#cb801-59" tabindex="-1"></a>x.min <span class="ot">&lt;-</span> <span class="dv">1989</span></span>
<span id="cb801-60"><a href="tables-and-graphs.html#cb801-60" tabindex="-1"></a>x.max <span class="ot">&lt;-</span> <span class="dv">2014</span></span>
<span id="cb801-61"><a href="tables-and-graphs.html#cb801-61" tabindex="-1"></a></span>
<span id="cb801-62"><a href="tables-and-graphs.html#cb801-62" tabindex="-1"></a>y.breaks <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.30</span>, <span class="fl">0.05</span>, <span class="at">by =</span> <span class="fl">0.05</span>), <span class="dv">2</span>)</span>
<span id="cb801-63"><a href="tables-and-graphs.html#cb801-63" tabindex="-1"></a>y.labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">paste</span>(y.breaks[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y.breaks)] <span class="sc">*</span> <span class="dv">100</span>), <span class="st">&quot;%&quot;</span>)</span>
<span id="cb801-64"><a href="tables-and-graphs.html#cb801-64" tabindex="-1"></a></span>
<span id="cb801-65"><a href="tables-and-graphs.html#cb801-65" tabindex="-1"></a>y.min <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.26</span></span>
<span id="cb801-66"><a href="tables-and-graphs.html#cb801-66" tabindex="-1"></a>y.max <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb801-67"><a href="tables-and-graphs.html#cb801-67" tabindex="-1"></a></span>
<span id="cb801-68"><a href="tables-and-graphs.html#cb801-68" tabindex="-1"></a><span class="co"># data change -------</span></span>
<span id="cb801-69"><a href="tables-and-graphs.html#cb801-69" tabindex="-1"></a>df_flfp_sklocc_graph <span class="ot">&lt;-</span> df_flfp <span class="sc">%&gt;%</span></span>
<span id="cb801-70"><a href="tables-and-graphs.html#cb801-70" tabindex="-1"></a>  <span class="fu">filter</span>(ctr_var_idx <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>) <span class="sc">&amp;</span> category <span class="sc">==</span> <span class="st">&quot;C001&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb801-71"><a href="tables-and-graphs.html#cb801-71" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb801-72"><a href="tables-and-graphs.html#cb801-72" tabindex="-1"></a>    <span class="at">ge_pe =</span> <span class="fu">as.factor</span>(ge_pe),</span>
<span id="cb801-73"><a href="tables-and-graphs.html#cb801-73" tabindex="-1"></a>    <span class="at">ctr_var_idx =</span> <span class="fu">as.factor</span>(ctr_var_idx)</span>
<span id="cb801-74"><a href="tables-and-graphs.html#cb801-74" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb801-75"><a href="tables-and-graphs.html#cb801-75" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ge_pe =</span> <span class="fu">fct_recode</span>(ge_pe, <span class="sc">!!!</span>ge_pe_recode)) <span class="sc">%&gt;%</span></span>
<span id="cb801-76"><a href="tables-and-graphs.html#cb801-76" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ctr_var_idx =</span> <span class="fu">fct_recode</span>(ctr_var_idx, <span class="sc">!!!</span>ctr_var_recode)) <span class="sc">%&gt;%</span></span>
<span id="cb801-77"><a href="tables-and-graphs.html#cb801-77" tabindex="-1"></a>  <span class="fu">select</span>(year, ctr_var_idx, ge_pe, part_yeargender_shr_m2f_dfv1st)</span>
<span id="cb801-78"><a href="tables-and-graphs.html#cb801-78" tabindex="-1"></a></span>
<span id="cb801-79"><a href="tables-and-graphs.html#cb801-79" tabindex="-1"></a><span class="co"># graph ------</span></span>
<span id="cb801-80"><a href="tables-and-graphs.html#cb801-80" tabindex="-1"></a>pl_flfp_agg <span class="ot">&lt;-</span> df_flfp_sklocc_graph <span class="sc">%&gt;%</span></span>
<span id="cb801-81"><a href="tables-and-graphs.html#cb801-81" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb801-82"><a href="tables-and-graphs.html#cb801-82" tabindex="-1"></a>    <span class="at">x =</span> year, <span class="at">y =</span> part_yeargender_shr_m2f_dfv1st,</span>
<span id="cb801-83"><a href="tables-and-graphs.html#cb801-83" tabindex="-1"></a>    <span class="at">colour =</span> ctr_var_idx, <span class="at">linetype =</span> ctr_var_idx, <span class="at">shape =</span> ctr_var_idx</span>
<span id="cb801-84"><a href="tables-and-graphs.html#cb801-84" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb801-85"><a href="tables-and-graphs.html#cb801-85" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ge_pe, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb801-86"><a href="tables-and-graphs.html#cb801-86" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb801-87"><a href="tables-and-graphs.html#cb801-87" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb801-88"><a href="tables-and-graphs.html#cb801-88" tabindex="-1"></a></span>
<span id="cb801-89"><a href="tables-and-graphs.html#cb801-89" tabindex="-1"></a><span class="co"># labels</span></span>
<span id="cb801-90"><a href="tables-and-graphs.html#cb801-90" tabindex="-1"></a>pl_flfp_agg <span class="ot">&lt;-</span> pl_flfp_agg <span class="sc">+</span></span>
<span id="cb801-91"><a href="tables-and-graphs.html#cb801-91" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb801-92"><a href="tables-and-graphs.html#cb801-92" tabindex="-1"></a>    <span class="at">x =</span> st_x,</span>
<span id="cb801-93"><a href="tables-and-graphs.html#cb801-93" tabindex="-1"></a>    <span class="at">y =</span> st_y</span>
<span id="cb801-94"><a href="tables-and-graphs.html#cb801-94" tabindex="-1"></a>  )</span>
<span id="cb801-95"><a href="tables-and-graphs.html#cb801-95" tabindex="-1"></a><span class="co"># subtitle = st_subtitle</span></span>
<span id="cb801-96"><a href="tables-and-graphs.html#cb801-96" tabindex="-1"></a></span>
<span id="cb801-97"><a href="tables-and-graphs.html#cb801-97" tabindex="-1"></a><span class="co"># set shapes and colors</span></span>
<span id="cb801-98"><a href="tables-and-graphs.html#cb801-98" tabindex="-1"></a><span class="co"># scale_colour_manual(values = ar_st_colours, labels = ctr_var_recode) +</span></span>
<span id="cb801-99"><a href="tables-and-graphs.html#cb801-99" tabindex="-1"></a><span class="co"># scale_shape_manual(values=ar_it_shapes, labels = ctr_var_recode) +</span></span>
<span id="cb801-100"><a href="tables-and-graphs.html#cb801-100" tabindex="-1"></a><span class="co"># scale_linetype_manual(values = ar_st_linetypes, labels = ctr_var_recode) +</span></span>
<span id="cb801-101"><a href="tables-and-graphs.html#cb801-101" tabindex="-1"></a>pl_flfp_agg <span class="ot">&lt;-</span> pl_flfp_agg <span class="sc">+</span></span>
<span id="cb801-102"><a href="tables-and-graphs.html#cb801-102" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> ar_st_colours) <span class="sc">+</span></span>
<span id="cb801-103"><a href="tables-and-graphs.html#cb801-103" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> ar_it_shapes) <span class="sc">+</span></span>
<span id="cb801-104"><a href="tables-and-graphs.html#cb801-104" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> ar_st_linetypes) <span class="sc">+</span></span>
<span id="cb801-105"><a href="tables-and-graphs.html#cb801-105" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb801-106"><a href="tables-and-graphs.html#cb801-106" tabindex="-1"></a>    <span class="at">labels =</span> x.labels, <span class="at">breaks =</span> x.breaks,</span>
<span id="cb801-107"><a href="tables-and-graphs.html#cb801-107" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(x.min, x.max)</span>
<span id="cb801-108"><a href="tables-and-graphs.html#cb801-108" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb801-109"><a href="tables-and-graphs.html#cb801-109" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb801-110"><a href="tables-and-graphs.html#cb801-110" tabindex="-1"></a>    <span class="at">labels =</span> y.labels, <span class="at">breaks =</span> y.breaks,</span>
<span id="cb801-111"><a href="tables-and-graphs.html#cb801-111" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(y.min, y.max)</span>
<span id="cb801-112"><a href="tables-and-graphs.html#cb801-112" tabindex="-1"></a>  )</span>
<span id="cb801-113"><a href="tables-and-graphs.html#cb801-113" tabindex="-1"></a></span>
<span id="cb801-114"><a href="tables-and-graphs.html#cb801-114" tabindex="-1"></a><span class="co"># Horizontal line</span></span>
<span id="cb801-115"><a href="tables-and-graphs.html#cb801-115" tabindex="-1"></a>pl_flfp_agg <span class="ot">&lt;-</span> pl_flfp_agg <span class="sc">+</span></span>
<span id="cb801-116"><a href="tables-and-graphs.html#cb801-116" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb801-117"><a href="tables-and-graphs.html#cb801-117" tabindex="-1"></a><span class="co"># geom_hline(yintercept=0, linetype=&#39;dotted&#39;, colour=&quot;black&quot;, size=2)</span></span>
<span id="cb801-118"><a href="tables-and-graphs.html#cb801-118" tabindex="-1"></a></span>
<span id="cb801-119"><a href="tables-and-graphs.html#cb801-119" tabindex="-1"></a><span class="co"># theme</span></span>
<span id="cb801-120"><a href="tables-and-graphs.html#cb801-120" tabindex="-1"></a>pl_flfp_agg <span class="ot">&lt;-</span> pl_flfp_agg <span class="sc">+</span></span>
<span id="cb801-121"><a href="tables-and-graphs.html#cb801-121" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb801-122"><a href="tables-and-graphs.html#cb801-122" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb801-123"><a href="tables-and-graphs.html#cb801-123" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb801-124"><a href="tables-and-graphs.html#cb801-124" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb801-125"><a href="tables-and-graphs.html#cb801-125" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb801-126"><a href="tables-and-graphs.html#cb801-126" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.27</span>),</span>
<span id="cb801-127"><a href="tables-and-graphs.html#cb801-127" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb801-128"><a href="tables-and-graphs.html#cb801-128" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb801-129"><a href="tables-and-graphs.html#cb801-129" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb801-130"><a href="tables-and-graphs.html#cb801-130" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb801-131"><a href="tables-and-graphs.html#cb801-131" tabindex="-1"></a>    ),</span>
<span id="cb801-132"><a href="tables-and-graphs.html#cb801-132" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.0</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb801-133"><a href="tables-and-graphs.html#cb801-133" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb801-134"><a href="tables-and-graphs.html#cb801-134" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb801-135"><a href="tables-and-graphs.html#cb801-135" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb801-136"><a href="tables-and-graphs.html#cb801-136" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Set to 1989 Level:&quot;</span>),</span>
<span id="cb801-137"><a href="tables-and-graphs.html#cb801-137" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Set to 1989 Level:&quot;</span>),</span>
<span id="cb801-138"><a href="tables-and-graphs.html#cb801-138" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Set to 1989 Level:&quot;</span>)</span>
<span id="cb801-139"><a href="tables-and-graphs.html#cb801-139" tabindex="-1"></a>  )</span>
<span id="cb801-140"><a href="tables-and-graphs.html#cb801-140" tabindex="-1"></a></span>
<span id="cb801-141"><a href="tables-and-graphs.html#cb801-141" tabindex="-1"></a><span class="co"># Print Images to Screen </span></span>
<span id="cb801-142"><a href="tables-and-graphs.html#cb801-142" tabindex="-1"></a><span class="fu">print</span>(pl_flfp_agg)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-411-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="tables-and-graphs.html#cb802-1" tabindex="-1"></a><span class="co"># Save Image Outputs -----</span></span>
<span id="cb802-2"><a href="tables-and-graphs.html#cb802-2" tabindex="-1"></a><span class="cf">if</span> (bl_save_img) {</span>
<span id="cb802-3"><a href="tables-and-graphs.html#cb802-3" tabindex="-1"></a>  <span class="fu">png</span>(spn_flfp_sklocc_graph,</span>
<span id="cb802-4"><a href="tables-and-graphs.html#cb802-4" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">200</span>,</span>
<span id="cb802-5"><a href="tables-and-graphs.html#cb802-5" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">100</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>,</span>
<span id="cb802-6"><a href="tables-and-graphs.html#cb802-6" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">150</span>, <span class="at">pointsize =</span> <span class="dv">7</span></span>
<span id="cb802-7"><a href="tables-and-graphs.html#cb802-7" tabindex="-1"></a>  )</span>
<span id="cb802-8"><a href="tables-and-graphs.html#cb802-8" tabindex="-1"></a>  <span class="fu">ggsave</span>(</span>
<span id="cb802-9"><a href="tables-and-graphs.html#cb802-9" tabindex="-1"></a>    spn_flfp_sklocc_graph_eps,</span>
<span id="cb802-10"><a href="tables-and-graphs.html#cb802-10" tabindex="-1"></a>    <span class="at">plot =</span> <span class="fu">last_plot</span>(),</span>
<span id="cb802-11"><a href="tables-and-graphs.html#cb802-11" tabindex="-1"></a>    <span class="at">device =</span> <span class="st">&quot;eps&quot;</span>,</span>
<span id="cb802-12"><a href="tables-and-graphs.html#cb802-12" tabindex="-1"></a>    <span class="at">path =</span> <span class="cn">NULL</span>,</span>
<span id="cb802-13"><a href="tables-and-graphs.html#cb802-13" tabindex="-1"></a>    <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb802-14"><a href="tables-and-graphs.html#cb802-14" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">200</span>,</span>
<span id="cb802-15"><a href="tables-and-graphs.html#cb802-15" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">100</span>,</span>
<span id="cb802-16"><a href="tables-and-graphs.html#cb802-16" tabindex="-1"></a>    <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb802-17"><a href="tables-and-graphs.html#cb802-17" tabindex="-1"></a>    <span class="at">dpi =</span> <span class="dv">150</span>,</span>
<span id="cb802-18"><a href="tables-and-graphs.html#cb802-18" tabindex="-1"></a>    <span class="at">limitsize =</span> <span class="cn">TRUE</span></span>
<span id="cb802-19"><a href="tables-and-graphs.html#cb802-19" tabindex="-1"></a>  )</span>
<span id="cb802-20"><a href="tables-and-graphs.html#cb802-20" tabindex="-1"></a>  <span class="fu">print</span>(pl_flfp_agg)</span>
<span id="cb802-21"><a href="tables-and-graphs.html#cb802-21" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb802-22"><a href="tables-and-graphs.html#cb802-22" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
</div>
<div id="continuous-y-and-x-variables-four-categories-three-for-subplot" class="section level4 hasAnchor" number="10.2.2.3">
<h4><span class="header-section-number">10.2.2.3</span> Continuous Y and X Variables, Four Categories, Three for Subplot<a href="tables-and-graphs.html#continuous-y-and-x-variables-four-categories-three-for-subplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In contrast to the line plot above, in this third example, we have three categorical variables that will be visualized via plots and subplots. We have four categoricalv variables overall, for the fourth categorical variable, as in the second example, we continue to use both varying line color as well as line shape and scatter type to distinguish categories of this fourth categorical variable. Visualize one continuous variable, along the x-axis, given four categorical variables, with 60 combined categories <span class="math inline">\(3\times2\times2\times3=36\)</span>:</p>
<ul>
<li>one as plot, generate three different plots, 3 unique values, achieved by saving a function and running the function three times with variable conditioning.</li>
<li>one as <em>facet_grid</em> row group, 2 unique values.</li>
<li>one as <em>facet_grid</em> column group, 2 unique values.</li>
<li>one with line-color, line-color and scatter shape joint variation (counterfactual type), 3 unique values</li>
</ul>
<p>Following the example above, continue to analyze female labor participation. Generated under partial and general equilibrium (subplot), and skill and occupational groups. , generated for different counterfactual policies (linetype). X-axis is calendar year.</p>
<p>Features:</p>
<ul>
<li><em>facet_grid</em>: Multiple rows and columns for faceting, row and column labels</li>
<li>No spacing for empty title line</li>
<li>Graph as function with simple variable and parameter adjustment</li>
<li>No minor grid</li>
<li>Do not show ylabel.</li>
</ul>
<p>First define the graphing function:</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="tables-and-graphs.html#cb804-1" tabindex="-1"></a><span class="co"># The graphing function with limited parameter options.</span></span>
<span id="cb804-2"><a href="tables-and-graphs.html#cb804-2" tabindex="-1"></a>ff_grhlfp_gepeedu_byocc <span class="ot">&lt;-</span></span>
<span id="cb804-3"><a href="tables-and-graphs.html#cb804-3" tabindex="-1"></a>  <span class="cf">function</span>(<span class="at">bl_save_img =</span> <span class="cn">TRUE</span>,</span>
<span id="cb804-4"><a href="tables-and-graphs.html#cb804-4" tabindex="-1"></a>           <span class="at">st_occ =</span> <span class="st">&quot;Manual&quot;</span>,</span>
<span id="cb804-5"><a href="tables-and-graphs.html#cb804-5" tabindex="-1"></a>           <span class="at">y_breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fl">0.08</span>, <span class="fl">0.18</span>, <span class="at">by =</span> <span class="fl">0.02</span>), <span class="dv">2</span>),</span>
<span id="cb804-6"><a href="tables-and-graphs.html#cb804-6" tabindex="-1"></a>           <span class="at">y_min =</span> <span class="fl">0.08</span>,</span>
<span id="cb804-7"><a href="tables-and-graphs.html#cb804-7" tabindex="-1"></a>           <span class="at">y_max =</span> <span class="fl">0.19</span>,</span>
<span id="cb804-8"><a href="tables-and-graphs.html#cb804-8" tabindex="-1"></a>           <span class="at">ar_leg_position =</span> <span class="fu">c</span>(<span class="fl">0.29</span>, <span class="fl">0.50</span>),</span>
<span id="cb804-9"><a href="tables-and-graphs.html#cb804-9" tabindex="-1"></a>           <span class="at">it_width =</span> <span class="dv">160</span>, <span class="at">it_height =</span> <span class="dv">105</span>,</span>
<span id="cb804-10"><a href="tables-and-graphs.html#cb804-10" tabindex="-1"></a>           <span class="at">st_subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb804-11"><a href="tables-and-graphs.html#cb804-11" tabindex="-1"></a>             <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb804-12"><a href="tables-and-graphs.html#cb804-12" tabindex="-1"></a>             <span class="st">&quot;R4Econ/tabgraph/ggline/htmlpdfr/fs_ggline_mgrp_ncts.html&quot;</span></span>
<span id="cb804-13"><a href="tables-and-graphs.html#cb804-13" tabindex="-1"></a>           )) {</span>
<span id="cb804-14"><a href="tables-and-graphs.html#cb804-14" tabindex="-1"></a></span>
<span id="cb804-15"><a href="tables-and-graphs.html#cb804-15" tabindex="-1"></a>    <span class="co"># Load in CSV</span></span>
<span id="cb804-16"><a href="tables-and-graphs.html#cb804-16" tabindex="-1"></a>    spt_csv_root <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;C:/Users/fan/R4Econ/tabgraph/ggline/_file/&quot;</span>)</span>
<span id="cb804-17"><a href="tables-and-graphs.html#cb804-17" tabindex="-1"></a>    spt_img_root <span class="ot">&lt;-</span> spt_csv_root</span>
<span id="cb804-18"><a href="tables-and-graphs.html#cb804-18" tabindex="-1"></a>    spn_flfp_sklocc_data <span class="ot">&lt;-</span> <span class="fu">paste0</span>(spt_csv_root, <span class="st">&quot;flfp_data.csv&quot;</span>)</span>
<span id="cb804-19"><a href="tables-and-graphs.html#cb804-19" tabindex="-1"></a>    spn_flfp_sklocc_graph <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb804-20"><a href="tables-and-graphs.html#cb804-20" tabindex="-1"></a>      spt_img_root,</span>
<span id="cb804-21"><a href="tables-and-graphs.html#cb804-21" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">&quot;flfp_gepe_colhigh_&quot;</span>, <span class="fu">tolower</span>(st_occ), <span class="st">&quot;_graph.png&quot;</span>)</span>
<span id="cb804-22"><a href="tables-and-graphs.html#cb804-22" tabindex="-1"></a>    )</span>
<span id="cb804-23"><a href="tables-and-graphs.html#cb804-23" tabindex="-1"></a>    spn_flfp_sklocc_graph_eps <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb804-24"><a href="tables-and-graphs.html#cb804-24" tabindex="-1"></a>      spt_img_root,</span>
<span id="cb804-25"><a href="tables-and-graphs.html#cb804-25" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">&quot;flfp_gepe_colhigh_&quot;</span>, <span class="fu">tolower</span>(st_occ), <span class="st">&quot;_graph.eps&quot;</span>)</span>
<span id="cb804-26"><a href="tables-and-graphs.html#cb804-26" tabindex="-1"></a>    )</span>
<span id="cb804-27"><a href="tables-and-graphs.html#cb804-27" tabindex="-1"></a></span>
<span id="cb804-28"><a href="tables-and-graphs.html#cb804-28" tabindex="-1"></a>    <span class="co"># Load data</span></span>
<span id="cb804-29"><a href="tables-and-graphs.html#cb804-29" tabindex="-1"></a>    <span class="co"># Convert all convertable numeric columns from string to numeric</span></span>
<span id="cb804-30"><a href="tables-and-graphs.html#cb804-30" tabindex="-1"></a>    <span class="co"># https://stackoverflow.com/a/49054046/8280804</span></span>
<span id="cb804-31"><a href="tables-and-graphs.html#cb804-31" tabindex="-1"></a>    is_all_numeric <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb804-32"><a href="tables-and-graphs.html#cb804-32" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(<span class="fu">na.omit</span>(x))))) <span class="sc">&amp;</span> <span class="fu">is.character</span>(x)</span>
<span id="cb804-33"><a href="tables-and-graphs.html#cb804-33" tabindex="-1"></a>    }</span>
<span id="cb804-34"><a href="tables-and-graphs.html#cb804-34" tabindex="-1"></a>    df_flfp <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read.csv</span>(spn_flfp_sklocc_data)) <span class="sc">%&gt;%</span></span>
<span id="cb804-35"><a href="tables-and-graphs.html#cb804-35" tabindex="-1"></a>      <span class="fu">mutate_if</span>(is_all_numeric, as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb804-36"><a href="tables-and-graphs.html#cb804-36" tabindex="-1"></a>      <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="dv">2014</span>)</span>
<span id="cb804-37"><a href="tables-and-graphs.html#cb804-37" tabindex="-1"></a></span>
<span id="cb804-38"><a href="tables-and-graphs.html#cb804-38" tabindex="-1"></a>    <span class="co"># Dataset subsetting ------</span></span>
<span id="cb804-39"><a href="tables-and-graphs.html#cb804-39" tabindex="-1"></a></span>
<span id="cb804-40"><a href="tables-and-graphs.html#cb804-40" tabindex="-1"></a>    <span class="co"># Line Patterns and Colors ------</span></span>
<span id="cb804-41"><a href="tables-and-graphs.html#cb804-41" tabindex="-1"></a>    ctr_var_recode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb804-42"><a href="tables-and-graphs.html#cb804-42" tabindex="-1"></a>      <span class="st">&quot;Prediction no Counterfactual&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb804-43"><a href="tables-and-graphs.html#cb804-43" tabindex="-1"></a>      <span class="st">&quot;Married at 1989 Levels&quot;</span> <span class="ot">=</span> <span class="st">&quot;31&quot;</span>,</span>
<span id="cb804-44"><a href="tables-and-graphs.html#cb804-44" tabindex="-1"></a>      <span class="st">&quot;Children &lt; 5 at 1989 Levels&quot;</span> <span class="ot">=</span> <span class="st">&quot;32&quot;</span>,</span>
<span id="cb804-45"><a href="tables-and-graphs.html#cb804-45" tabindex="-1"></a>      <span class="st">&quot;Appliance at 1989 Levels&quot;</span> <span class="ot">=</span> <span class="st">&quot;33&quot;</span>,</span>
<span id="cb804-46"><a href="tables-and-graphs.html#cb804-46" tabindex="-1"></a>      <span class="st">&quot;WBL Index at 1989 Levels&quot;</span> <span class="ot">=</span> <span class="st">&quot;34&quot;</span></span>
<span id="cb804-47"><a href="tables-and-graphs.html#cb804-47" tabindex="-1"></a>    )</span>
<span id="cb804-48"><a href="tables-and-graphs.html#cb804-48" tabindex="-1"></a></span>
<span id="cb804-49"><a href="tables-and-graphs.html#cb804-49" tabindex="-1"></a>    <span class="co"># https://www.rgbtohex.net/</span></span>
<span id="cb804-50"><a href="tables-and-graphs.html#cb804-50" tabindex="-1"></a>    <span class="co"># ar_st_colours &lt;- c(&quot;#262626&quot;, &quot;#FFC001&quot;, &quot;#ED8137&quot;, &quot;#4472C4&quot;, &quot;#3E9651&quot;)</span></span>
<span id="cb804-51"><a href="tables-and-graphs.html#cb804-51" tabindex="-1"></a>    ar_st_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#262626&quot;</span>, <span class="st">&quot;#ED8137&quot;</span>, <span class="st">&quot;#4472C4&quot;</span>)</span>
<span id="cb804-52"><a href="tables-and-graphs.html#cb804-52" tabindex="-1"></a>    <span class="co"># http://www.sthda.com/english/wiki/ggplot2-line-types-how-to-change-line-types-of-a-graph-in-r-software</span></span>
<span id="cb804-53"><a href="tables-and-graphs.html#cb804-53" tabindex="-1"></a>    ar_st_linetypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;solid&quot;</span>)</span>
<span id="cb804-54"><a href="tables-and-graphs.html#cb804-54" tabindex="-1"></a>    <span class="co"># http://sape.inf.usi.ch/quick-reference/ggplot2/shape</span></span>
<span id="cb804-55"><a href="tables-and-graphs.html#cb804-55" tabindex="-1"></a>    <span class="co"># 32 is invisible shape</span></span>
<span id="cb804-56"><a href="tables-and-graphs.html#cb804-56" tabindex="-1"></a>    <span class="co"># ar_it_shapes &lt;- c(32, 5, 17, 15, 1)</span></span>
<span id="cb804-57"><a href="tables-and-graphs.html#cb804-57" tabindex="-1"></a>    ar_it_shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">17</span>, <span class="dv">15</span>)</span>
<span id="cb804-58"><a href="tables-and-graphs.html#cb804-58" tabindex="-1"></a></span>
<span id="cb804-59"><a href="tables-and-graphs.html#cb804-59" tabindex="-1"></a>    <span class="co"># Labels and Other Strings -------</span></span>
<span id="cb804-60"><a href="tables-and-graphs.html#cb804-60" tabindex="-1"></a>    st_x <span class="ot">&lt;-</span> <span class="st">&quot;Years&quot;</span></span>
<span id="cb804-61"><a href="tables-and-graphs.html#cb804-61" tabindex="-1"></a>    st_y <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Female &quot;</span>, st_occ, <span class="st">&quot; Occupation Participation Shares&quot;</span>)</span>
<span id="cb804-62"><a href="tables-and-graphs.html#cb804-62" tabindex="-1"></a></span>
<span id="cb804-63"><a href="tables-and-graphs.html#cb804-63" tabindex="-1"></a>    <span class="co"># ge_pe_recode &lt;- c(</span></span>
<span id="cb804-64"><a href="tables-and-graphs.html#cb804-64" tabindex="-1"></a>    <span class="co">#   &quot;General Equilibrium\n(Adjust Wages)&quot; = &quot;GE&quot;,</span></span>
<span id="cb804-65"><a href="tables-and-graphs.html#cb804-65" tabindex="-1"></a>    <span class="co">#   &quot;Partial Equilibrium\n(Wage as Observed)&quot; = &quot;PE&quot;</span></span>
<span id="cb804-66"><a href="tables-and-graphs.html#cb804-66" tabindex="-1"></a>    <span class="co"># )</span></span>
<span id="cb804-67"><a href="tables-and-graphs.html#cb804-67" tabindex="-1"></a>    ge_pe_recode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb804-68"><a href="tables-and-graphs.html#cb804-68" tabindex="-1"></a>      <span class="st">&quot;General Equilibrium&quot;</span> <span class="ot">=</span> <span class="st">&quot;GE&quot;</span>,</span>
<span id="cb804-69"><a href="tables-and-graphs.html#cb804-69" tabindex="-1"></a>      <span class="st">&quot;Partial Equilibrium&quot;</span> <span class="ot">=</span> <span class="st">&quot;PE&quot;</span></span>
<span id="cb804-70"><a href="tables-and-graphs.html#cb804-70" tabindex="-1"></a>    )</span>
<span id="cb804-71"><a href="tables-and-graphs.html#cb804-71" tabindex="-1"></a>    <span class="co"># ge_pe_recode &lt;- c(</span></span>
<span id="cb804-72"><a href="tables-and-graphs.html#cb804-72" tabindex="-1"></a>    <span class="co">#   &quot;GE&quot; = &quot;GE&quot;,</span></span>
<span id="cb804-73"><a href="tables-and-graphs.html#cb804-73" tabindex="-1"></a>    <span class="co">#   &quot;PE&quot; = &quot;PE&quot;</span></span>
<span id="cb804-74"><a href="tables-and-graphs.html#cb804-74" tabindex="-1"></a>    <span class="co"># )</span></span>
<span id="cb804-75"><a href="tables-and-graphs.html#cb804-75" tabindex="-1"></a></span>
<span id="cb804-76"><a href="tables-and-graphs.html#cb804-76" tabindex="-1"></a>    skilled_unskilled_recode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb804-77"><a href="tables-and-graphs.html#cb804-77" tabindex="-1"></a>      <span class="st">&quot;College Women&quot;</span> <span class="ot">=</span> <span class="st">&quot;skilled&quot;</span>,</span>
<span id="cb804-78"><a href="tables-and-graphs.html#cb804-78" tabindex="-1"></a>      <span class="st">&quot;Secondary Women&quot;</span> <span class="ot">=</span> <span class="st">&quot;unskilled&quot;</span></span>
<span id="cb804-79"><a href="tables-and-graphs.html#cb804-79" tabindex="-1"></a>    )</span>
<span id="cb804-80"><a href="tables-and-graphs.html#cb804-80" tabindex="-1"></a></span>
<span id="cb804-81"><a href="tables-and-graphs.html#cb804-81" tabindex="-1"></a>    <span class="co"># x_breaks &lt;- seq(1989, 2014, by = 5)</span></span>
<span id="cb804-82"><a href="tables-and-graphs.html#cb804-82" tabindex="-1"></a>    x_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span>)</span>
<span id="cb804-83"><a href="tables-and-graphs.html#cb804-83" tabindex="-1"></a>    x_labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(x_breaks[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_breaks)])</span>
<span id="cb804-84"><a href="tables-and-graphs.html#cb804-84" tabindex="-1"></a>    x_min <span class="ot">&lt;-</span> <span class="dv">1989</span></span>
<span id="cb804-85"><a href="tables-and-graphs.html#cb804-85" tabindex="-1"></a>    x_max <span class="ot">&lt;-</span> <span class="dv">2014</span></span>
<span id="cb804-86"><a href="tables-and-graphs.html#cb804-86" tabindex="-1"></a></span>
<span id="cb804-87"><a href="tables-and-graphs.html#cb804-87" tabindex="-1"></a>    <span class="co"># y_breaks &lt;- round(seq(0.08, 0.18, by = 0.02), 2)</span></span>
<span id="cb804-88"><a href="tables-and-graphs.html#cb804-88" tabindex="-1"></a>    y_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">paste</span>(y_breaks[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_breaks)] <span class="sc">*</span> <span class="dv">100</span>), <span class="st">&quot;%&quot;</span>)</span>
<span id="cb804-89"><a href="tables-and-graphs.html#cb804-89" tabindex="-1"></a></span>
<span id="cb804-90"><a href="tables-and-graphs.html#cb804-90" tabindex="-1"></a>    <span class="co"># y_min &lt;- 0.08</span></span>
<span id="cb804-91"><a href="tables-and-graphs.html#cb804-91" tabindex="-1"></a>    <span class="co"># y_max &lt;- 0.19</span></span>
<span id="cb804-92"><a href="tables-and-graphs.html#cb804-92" tabindex="-1"></a></span>
<span id="cb804-93"><a href="tables-and-graphs.html#cb804-93" tabindex="-1"></a>    <span class="co"># data change -------</span></span>
<span id="cb804-94"><a href="tables-and-graphs.html#cb804-94" tabindex="-1"></a>    df_flfp_sklocc_graph <span class="ot">&lt;-</span> df_flfp <span class="sc">%&gt;%</span></span>
<span id="cb804-95"><a href="tables-and-graphs.html#cb804-95" tabindex="-1"></a>      <span class="fu">filter</span>(ctr_var_idx <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">32</span>, <span class="dv">33</span>) <span class="sc">&amp;</span></span>
<span id="cb804-96"><a href="tables-and-graphs.html#cb804-96" tabindex="-1"></a>        gender <span class="sc">==</span> <span class="st">&quot;Female&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb804-97"><a href="tables-and-graphs.html#cb804-97" tabindex="-1"></a>        occupation <span class="sc">%in%</span> <span class="fu">c</span>(st_occ)) <span class="sc">%&gt;%</span></span>
<span id="cb804-98"><a href="tables-and-graphs.html#cb804-98" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb804-99"><a href="tables-and-graphs.html#cb804-99" tabindex="-1"></a>        <span class="at">ge_pe =</span> <span class="fu">as.factor</span>(ge_pe),</span>
<span id="cb804-100"><a href="tables-and-graphs.html#cb804-100" tabindex="-1"></a>        <span class="at">ctr_var_idx =</span> <span class="fu">as.factor</span>(ctr_var_idx)</span>
<span id="cb804-101"><a href="tables-and-graphs.html#cb804-101" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb804-102"><a href="tables-and-graphs.html#cb804-102" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb804-103"><a href="tables-and-graphs.html#cb804-103" tabindex="-1"></a>        <span class="at">ge_pe =</span> <span class="fu">fct_recode</span>(ge_pe, <span class="sc">!!!</span>ge_pe_recode),</span>
<span id="cb804-104"><a href="tables-and-graphs.html#cb804-104" tabindex="-1"></a>        <span class="at">skill =</span> <span class="fu">fct_recode</span>(skill, <span class="sc">!!!</span>skilled_unskilled_recode),</span>
<span id="cb804-105"><a href="tables-and-graphs.html#cb804-105" tabindex="-1"></a>        <span class="at">ctr_var_idx =</span> <span class="fu">fct_recode</span>(ctr_var_idx, <span class="sc">!!!</span>ctr_var_recode)</span>
<span id="cb804-106"><a href="tables-and-graphs.html#cb804-106" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb804-107"><a href="tables-and-graphs.html#cb804-107" tabindex="-1"></a>      <span class="fu">select</span>(year, skill, occupation, ctr_var_idx, ge_pe, genskl_part_share)</span>
<span id="cb804-108"><a href="tables-and-graphs.html#cb804-108" tabindex="-1"></a></span>
<span id="cb804-109"><a href="tables-and-graphs.html#cb804-109" tabindex="-1"></a>    <span class="co"># graph ------</span></span>
<span id="cb804-110"><a href="tables-and-graphs.html#cb804-110" tabindex="-1"></a>    pl_flfp_sklocc <span class="ot">&lt;-</span> df_flfp_sklocc_graph <span class="sc">%&gt;%</span></span>
<span id="cb804-111"><a href="tables-and-graphs.html#cb804-111" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb804-112"><a href="tables-and-graphs.html#cb804-112" tabindex="-1"></a>        <span class="at">x =</span> year, <span class="at">y =</span> genskl_part_share,</span>
<span id="cb804-113"><a href="tables-and-graphs.html#cb804-113" tabindex="-1"></a>        <span class="at">colour =</span> ctr_var_idx, <span class="at">linetype =</span> ctr_var_idx, <span class="at">shape =</span> ctr_var_idx</span>
<span id="cb804-114"><a href="tables-and-graphs.html#cb804-114" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb804-115"><a href="tables-and-graphs.html#cb804-115" tabindex="-1"></a>      <span class="fu">facet_grid</span>(skill <span class="sc">~</span> ge_pe) <span class="sc">+</span></span>
<span id="cb804-116"><a href="tables-and-graphs.html#cb804-116" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb804-117"><a href="tables-and-graphs.html#cb804-117" tabindex="-1"></a>      <span class="fu">geom_point</span>()</span>
<span id="cb804-118"><a href="tables-and-graphs.html#cb804-118" tabindex="-1"></a></span>
<span id="cb804-119"><a href="tables-and-graphs.html#cb804-119" tabindex="-1"></a>    <span class="co"># labels</span></span>
<span id="cb804-120"><a href="tables-and-graphs.html#cb804-120" tabindex="-1"></a>    <span class="cf">if</span> (st_subtitle <span class="sc">==</span> <span class="st">&quot;&quot;</span>) {</span>
<span id="cb804-121"><a href="tables-and-graphs.html#cb804-121" tabindex="-1"></a>      pl_flfp_sklocc <span class="ot">&lt;-</span> pl_flfp_sklocc <span class="sc">+</span></span>
<span id="cb804-122"><a href="tables-and-graphs.html#cb804-122" tabindex="-1"></a>        <span class="fu">labs</span>(</span>
<span id="cb804-123"><a href="tables-and-graphs.html#cb804-123" tabindex="-1"></a>          <span class="at">x =</span> st_x,</span>
<span id="cb804-124"><a href="tables-and-graphs.html#cb804-124" tabindex="-1"></a>          <span class="at">y =</span> st_y</span>
<span id="cb804-125"><a href="tables-and-graphs.html#cb804-125" tabindex="-1"></a>        )</span>
<span id="cb804-126"><a href="tables-and-graphs.html#cb804-126" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb804-127"><a href="tables-and-graphs.html#cb804-127" tabindex="-1"></a>      pl_flfp_sklocc <span class="ot">&lt;-</span> pl_flfp_sklocc <span class="sc">+</span></span>
<span id="cb804-128"><a href="tables-and-graphs.html#cb804-128" tabindex="-1"></a>        <span class="fu">labs</span>(</span>
<span id="cb804-129"><a href="tables-and-graphs.html#cb804-129" tabindex="-1"></a>          <span class="at">x =</span> st_x,</span>
<span id="cb804-130"><a href="tables-and-graphs.html#cb804-130" tabindex="-1"></a>          <span class="at">y =</span> st_y,</span>
<span id="cb804-131"><a href="tables-and-graphs.html#cb804-131" tabindex="-1"></a>          <span class="at">subtitle =</span> st_subtitle</span>
<span id="cb804-132"><a href="tables-and-graphs.html#cb804-132" tabindex="-1"></a>        )</span>
<span id="cb804-133"><a href="tables-and-graphs.html#cb804-133" tabindex="-1"></a>    }</span>
<span id="cb804-134"><a href="tables-and-graphs.html#cb804-134" tabindex="-1"></a></span>
<span id="cb804-135"><a href="tables-and-graphs.html#cb804-135" tabindex="-1"></a>    <span class="co"># set shapes and colors</span></span>
<span id="cb804-136"><a href="tables-and-graphs.html#cb804-136" tabindex="-1"></a>    pl_flfp_sklocc <span class="ot">&lt;-</span> pl_flfp_sklocc <span class="sc">+</span></span>
<span id="cb804-137"><a href="tables-and-graphs.html#cb804-137" tabindex="-1"></a>      <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> ar_st_colours) <span class="sc">+</span></span>
<span id="cb804-138"><a href="tables-and-graphs.html#cb804-138" tabindex="-1"></a>      <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> ar_it_shapes) <span class="sc">+</span></span>
<span id="cb804-139"><a href="tables-and-graphs.html#cb804-139" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> ar_st_linetypes) <span class="sc">+</span></span>
<span id="cb804-140"><a href="tables-and-graphs.html#cb804-140" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(</span>
<span id="cb804-141"><a href="tables-and-graphs.html#cb804-141" tabindex="-1"></a>        <span class="at">labels =</span> x_labels, <span class="at">breaks =</span> x_breaks,</span>
<span id="cb804-142"><a href="tables-and-graphs.html#cb804-142" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(x_min, x_max)</span>
<span id="cb804-143"><a href="tables-and-graphs.html#cb804-143" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb804-144"><a href="tables-and-graphs.html#cb804-144" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(</span>
<span id="cb804-145"><a href="tables-and-graphs.html#cb804-145" tabindex="-1"></a>        <span class="at">labels =</span> y_labels, <span class="at">breaks =</span> y_breaks,</span>
<span id="cb804-146"><a href="tables-and-graphs.html#cb804-146" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(y_min, y_max)</span>
<span id="cb804-147"><a href="tables-and-graphs.html#cb804-147" tabindex="-1"></a>      )</span>
<span id="cb804-148"><a href="tables-and-graphs.html#cb804-148" tabindex="-1"></a></span>
<span id="cb804-149"><a href="tables-and-graphs.html#cb804-149" tabindex="-1"></a>    <span class="co"># theme</span></span>
<span id="cb804-150"><a href="tables-and-graphs.html#cb804-150" tabindex="-1"></a>    pl_flfp_sklocc <span class="ot">&lt;-</span> pl_flfp_sklocc <span class="sc">+</span></span>
<span id="cb804-151"><a href="tables-and-graphs.html#cb804-151" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb804-152"><a href="tables-and-graphs.html#cb804-152" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb804-153"><a href="tables-and-graphs.html#cb804-153" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb804-154"><a href="tables-and-graphs.html#cb804-154" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb804-155"><a href="tables-and-graphs.html#cb804-155" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb804-156"><a href="tables-and-graphs.html#cb804-156" tabindex="-1"></a>        <span class="at">legend.position =</span> ar_leg_position,</span>
<span id="cb804-157"><a href="tables-and-graphs.html#cb804-157" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb804-158"><a href="tables-and-graphs.html#cb804-158" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb804-159"><a href="tables-and-graphs.html#cb804-159" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb804-160"><a href="tables-and-graphs.html#cb804-160" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb804-161"><a href="tables-and-graphs.html#cb804-161" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb804-162"><a href="tables-and-graphs.html#cb804-162" tabindex="-1"></a>        ),</span>
<span id="cb804-163"><a href="tables-and-graphs.html#cb804-163" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.0</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb804-164"><a href="tables-and-graphs.html#cb804-164" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.1</span>, <span class="at">hjust =</span> <span class="fl">0.1</span>)</span>
<span id="cb804-165"><a href="tables-and-graphs.html#cb804-165" tabindex="-1"></a>        <span class="co"># axis.text.y = element_text(angle = 90, hjust = 0.4)</span></span>
<span id="cb804-166"><a href="tables-and-graphs.html#cb804-166" tabindex="-1"></a>      )</span>
<span id="cb804-167"><a href="tables-and-graphs.html#cb804-167" tabindex="-1"></a>    <span class="co"># element_text(angle = 90, hjust = 0.4)</span></span>
<span id="cb804-168"><a href="tables-and-graphs.html#cb804-168" tabindex="-1"></a>    <span class="co"># axis.title.y = element_blank(), # no y-label</span></span>
<span id="cb804-169"><a href="tables-and-graphs.html#cb804-169" tabindex="-1"></a></span>
<span id="cb804-170"><a href="tables-and-graphs.html#cb804-170" tabindex="-1"></a>    <span class="co"># Save Image Outputs -----</span></span>
<span id="cb804-171"><a href="tables-and-graphs.html#cb804-171" tabindex="-1"></a>    <span class="cf">if</span> (bl_save_img) {</span>
<span id="cb804-172"><a href="tables-and-graphs.html#cb804-172" tabindex="-1"></a>      <span class="fu">ggsave</span>(</span>
<span id="cb804-173"><a href="tables-and-graphs.html#cb804-173" tabindex="-1"></a>        spn_flfp_sklocc_graph,</span>
<span id="cb804-174"><a href="tables-and-graphs.html#cb804-174" tabindex="-1"></a>        <span class="at">plot =</span> <span class="fu">last_plot</span>(),</span>
<span id="cb804-175"><a href="tables-and-graphs.html#cb804-175" tabindex="-1"></a>        <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb804-176"><a href="tables-and-graphs.html#cb804-176" tabindex="-1"></a>        <span class="at">path =</span> <span class="cn">NULL</span>,</span>
<span id="cb804-177"><a href="tables-and-graphs.html#cb804-177" tabindex="-1"></a>        <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb804-178"><a href="tables-and-graphs.html#cb804-178" tabindex="-1"></a>        <span class="at">width =</span> it_width,</span>
<span id="cb804-179"><a href="tables-and-graphs.html#cb804-179" tabindex="-1"></a>        <span class="at">height =</span> it_height,</span>
<span id="cb804-180"><a href="tables-and-graphs.html#cb804-180" tabindex="-1"></a>        <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb804-181"><a href="tables-and-graphs.html#cb804-181" tabindex="-1"></a>        <span class="at">dpi =</span> <span class="dv">150</span>,</span>
<span id="cb804-182"><a href="tables-and-graphs.html#cb804-182" tabindex="-1"></a>        <span class="at">limitsize =</span> <span class="cn">TRUE</span></span>
<span id="cb804-183"><a href="tables-and-graphs.html#cb804-183" tabindex="-1"></a>      )</span>
<span id="cb804-184"><a href="tables-and-graphs.html#cb804-184" tabindex="-1"></a>      <span class="fu">ggsave</span>(</span>
<span id="cb804-185"><a href="tables-and-graphs.html#cb804-185" tabindex="-1"></a>        spn_flfp_sklocc_graph_eps,</span>
<span id="cb804-186"><a href="tables-and-graphs.html#cb804-186" tabindex="-1"></a>        <span class="at">plot =</span> <span class="fu">last_plot</span>(),</span>
<span id="cb804-187"><a href="tables-and-graphs.html#cb804-187" tabindex="-1"></a>        <span class="at">device =</span> <span class="st">&quot;eps&quot;</span>,</span>
<span id="cb804-188"><a href="tables-and-graphs.html#cb804-188" tabindex="-1"></a>        <span class="at">path =</span> <span class="cn">NULL</span>,</span>
<span id="cb804-189"><a href="tables-and-graphs.html#cb804-189" tabindex="-1"></a>        <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb804-190"><a href="tables-and-graphs.html#cb804-190" tabindex="-1"></a>        <span class="at">width =</span> it_width,</span>
<span id="cb804-191"><a href="tables-and-graphs.html#cb804-191" tabindex="-1"></a>        <span class="at">height =</span> it_height,</span>
<span id="cb804-192"><a href="tables-and-graphs.html#cb804-192" tabindex="-1"></a>        <span class="at">units =</span> <span class="fu">c</span>(<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb804-193"><a href="tables-and-graphs.html#cb804-193" tabindex="-1"></a>        <span class="at">dpi =</span> <span class="dv">150</span>,</span>
<span id="cb804-194"><a href="tables-and-graphs.html#cb804-194" tabindex="-1"></a>        <span class="at">limitsize =</span> <span class="cn">TRUE</span></span>
<span id="cb804-195"><a href="tables-and-graphs.html#cb804-195" tabindex="-1"></a>      )</span>
<span id="cb804-196"><a href="tables-and-graphs.html#cb804-196" tabindex="-1"></a>       <span class="co"># dev.off()</span></span>
<span id="cb804-197"><a href="tables-and-graphs.html#cb804-197" tabindex="-1"></a>    }</span>
<span id="cb804-198"><a href="tables-and-graphs.html#cb804-198" tabindex="-1"></a></span>
<span id="cb804-199"><a href="tables-and-graphs.html#cb804-199" tabindex="-1"></a>    <span class="fu">return</span>(pl_flfp_sklocc)</span>
<span id="cb804-200"><a href="tables-and-graphs.html#cb804-200" tabindex="-1"></a>  }</span></code></pre></div>
<p>Second, run the function, for Manual, Routine and Analytical Works Separately.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="tables-and-graphs.html#cb805-1" tabindex="-1"></a>it_width <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb805-2"><a href="tables-and-graphs.html#cb805-2" tabindex="-1"></a>it_height <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb805-3"><a href="tables-and-graphs.html#cb805-3" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb805-4"><a href="tables-and-graphs.html#cb805-4" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb805-5"><a href="tables-and-graphs.html#cb805-5" tabindex="-1"></a>  <span class="st">&quot;R4Econ/tabgraph/ggline/htmlpdfr/fs_ggline_mgrp_ncts.html&quot;</span></span>
<span id="cb805-6"><a href="tables-and-graphs.html#cb805-6" tabindex="-1"></a>)</span>
<span id="cb805-7"><a href="tables-and-graphs.html#cb805-7" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb805-8"><a href="tables-and-graphs.html#cb805-8" tabindex="-1"></a><span class="co"># Manual,</span></span>
<span id="cb805-9"><a href="tables-and-graphs.html#cb805-9" tabindex="-1"></a>pl_flfp_sklocc_manual <span class="ot">&lt;-</span> <span class="fu">ff_grhlfp_gepeedu_byocc</span>(</span>
<span id="cb805-10"><a href="tables-and-graphs.html#cb805-10" tabindex="-1"></a>  <span class="at">bl_save_img =</span> <span class="cn">TRUE</span>,</span>
<span id="cb805-11"><a href="tables-and-graphs.html#cb805-11" tabindex="-1"></a>  <span class="at">st_occ =</span> <span class="st">&quot;Manual&quot;</span>,</span>
<span id="cb805-12"><a href="tables-and-graphs.html#cb805-12" tabindex="-1"></a>  <span class="at">y_breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fl">0.00</span>, <span class="fl">0.25</span>, <span class="at">by =</span> <span class="fl">0.05</span>), <span class="dv">2</span>),</span>
<span id="cb805-13"><a href="tables-and-graphs.html#cb805-13" tabindex="-1"></a>  <span class="at">y_min =</span> <span class="fl">0.00</span>, <span class="at">y_max =</span> <span class="fl">0.25</span>,</span>
<span id="cb805-14"><a href="tables-and-graphs.html#cb805-14" tabindex="-1"></a>  <span class="at">ar_leg_position =</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.80</span>),</span>
<span id="cb805-15"><a href="tables-and-graphs.html#cb805-15" tabindex="-1"></a>  <span class="at">it_width =</span> it_width, <span class="at">it_height =</span> it_height,</span>
<span id="cb805-16"><a href="tables-and-graphs.html#cb805-16" tabindex="-1"></a>  <span class="at">st_subtitle =</span> st_subtitle</span>
<span id="cb805-17"><a href="tables-and-graphs.html#cb805-17" tabindex="-1"></a>)</span>
<span id="cb805-18"><a href="tables-and-graphs.html#cb805-18" tabindex="-1"></a><span class="fu">print</span>(pl_flfp_sklocc_manual)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-413-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="tables-and-graphs.html#cb806-1" tabindex="-1"></a><span class="co"># Routine</span></span>
<span id="cb806-2"><a href="tables-and-graphs.html#cb806-2" tabindex="-1"></a>pl_flfp_sklocc_routine <span class="ot">&lt;-</span> <span class="fu">ff_grhlfp_gepeedu_byocc</span>(</span>
<span id="cb806-3"><a href="tables-and-graphs.html#cb806-3" tabindex="-1"></a>  <span class="at">bl_save_img =</span> <span class="cn">TRUE</span>,</span>
<span id="cb806-4"><a href="tables-and-graphs.html#cb806-4" tabindex="-1"></a>  <span class="at">st_occ =</span> <span class="st">&quot;Routine&quot;</span>,</span>
<span id="cb806-5"><a href="tables-and-graphs.html#cb806-5" tabindex="-1"></a>  <span class="at">y_breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fl">0.08</span>, <span class="fl">0.18</span>, <span class="at">by =</span> <span class="fl">0.02</span>), <span class="dv">2</span>),</span>
<span id="cb806-6"><a href="tables-and-graphs.html#cb806-6" tabindex="-1"></a>  <span class="at">y_min =</span> <span class="fl">0.08</span>, <span class="at">y_max =</span> <span class="fl">0.19</span>,</span>
<span id="cb806-7"><a href="tables-and-graphs.html#cb806-7" tabindex="-1"></a>  <span class="at">ar_leg_position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb806-8"><a href="tables-and-graphs.html#cb806-8" tabindex="-1"></a>  <span class="at">it_width =</span> it_width, <span class="at">it_height =</span> it_height,</span>
<span id="cb806-9"><a href="tables-and-graphs.html#cb806-9" tabindex="-1"></a>  <span class="at">st_subtitle =</span> st_subtitle</span>
<span id="cb806-10"><a href="tables-and-graphs.html#cb806-10" tabindex="-1"></a>)</span>
<span id="cb806-11"><a href="tables-and-graphs.html#cb806-11" tabindex="-1"></a><span class="fu">print</span>(pl_flfp_sklocc_routine)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-413-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="tables-and-graphs.html#cb807-1" tabindex="-1"></a><span class="co"># Analytical</span></span>
<span id="cb807-2"><a href="tables-and-graphs.html#cb807-2" tabindex="-1"></a>pl_flfp_sklocc_analytical <span class="ot">&lt;-</span> <span class="fu">ff_grhlfp_gepeedu_byocc</span>(</span>
<span id="cb807-3"><a href="tables-and-graphs.html#cb807-3" tabindex="-1"></a>  <span class="at">bl_save_img =</span> <span class="cn">TRUE</span>,</span>
<span id="cb807-4"><a href="tables-and-graphs.html#cb807-4" tabindex="-1"></a>  <span class="at">st_occ =</span> <span class="st">&quot;Analytical&quot;</span>,</span>
<span id="cb807-5"><a href="tables-and-graphs.html#cb807-5" tabindex="-1"></a>  <span class="at">y_breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fl">0.10</span>, <span class="fl">0.60</span>, <span class="at">by =</span> <span class="fl">0.10</span>), <span class="dv">2</span>),</span>
<span id="cb807-6"><a href="tables-and-graphs.html#cb807-6" tabindex="-1"></a>  <span class="at">y_min =</span> <span class="fl">0.05</span>, <span class="at">y_max =</span> <span class="fl">0.60</span>,</span>
<span id="cb807-7"><a href="tables-and-graphs.html#cb807-7" tabindex="-1"></a>  <span class="at">ar_leg_position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb807-8"><a href="tables-and-graphs.html#cb807-8" tabindex="-1"></a>  <span class="at">it_width =</span> it_width, <span class="at">it_height =</span> it_height,</span>
<span id="cb807-9"><a href="tables-and-graphs.html#cb807-9" tabindex="-1"></a>  <span class="at">st_subtitle =</span> st_subtitle</span>
<span id="cb807-10"><a href="tables-and-graphs.html#cb807-10" tabindex="-1"></a>)</span>
<span id="cb807-11"><a href="tables-and-graphs.html#cb807-11" tabindex="-1"></a><span class="fu">print</span>(pl_flfp_sklocc_analytical)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-413-3.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="time-series-plots-with-shaded-areas" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Time-series Plots with Shaded Areas<a href="tables-and-graphs.html#time-series-plots-with-shaded-areas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="single-time-series-with-single-type-of-shade" class="section level4 hasAnchor" number="10.2.3.1">
<h4><span class="header-section-number">10.2.3.1</span> Single Time-series with Single Type of Shade<a href="tables-and-graphs.html#single-time-series-with-single-type-of-shade" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We will construct three country-specific fake GDP time-series (converted from the <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/attitude.html">attitude</a> dataset). Then we will randomly select a subset of months and shade these months. This will generate a “recession” plot, where recession periods are shaded.</p>
<p>One of the assumption will be that we have data at discrete intervals, and the shaded areas will take mid-points.</p>
<p>First, we repeat the basic time-series data construction found in <a href="https://fanwangecon.github.io/R4Econ/tabgraph/ggline/htmlpdfr/fs_ggline_basic.html">R4Econ.fs_ggline_basic</a>.</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="tables-and-graphs.html#cb808-1" tabindex="-1"></a><span class="co"># Load data, and treat index as &quot;year&quot;, pretend data to be country-data</span></span>
<span id="cb808-2"><a href="tables-and-graphs.html#cb808-2" tabindex="-1"></a>df_gdp <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(attitude) <span class="sc">%&gt;%</span></span>
<span id="cb808-3"><a href="tables-and-graphs.html#cb808-3" tabindex="-1"></a>    <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;year&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb808-4"><a href="tables-and-graphs.html#cb808-4" tabindex="-1"></a>    <span class="fu">select</span>(year, rating, complaints, learning) <span class="sc">%&gt;%</span></span>
<span id="cb808-5"><a href="tables-and-graphs.html#cb808-5" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">stats_usa =</span> rating, <span class="at">stats_uk =</span> learning) <span class="sc">%&gt;%</span></span>
<span id="cb808-6"><a href="tables-and-graphs.html#cb808-6" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb808-7"><a href="tables-and-graphs.html#cb808-7" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;stats_&quot;</span>),</span>
<span id="cb808-8"><a href="tables-and-graphs.html#cb808-8" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>),</span>
<span id="cb808-9"><a href="tables-and-graphs.html#cb808-9" tabindex="-1"></a>        <span class="at">names_pattern =</span> <span class="fu">paste0</span>(<span class="st">&quot;stats_(.*)&quot;</span>),</span>
<span id="cb808-10"><a href="tables-and-graphs.html#cb808-10" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">&quot;gdp&quot;</span></span>
<span id="cb808-11"><a href="tables-and-graphs.html#cb808-11" tabindex="-1"></a>    )</span>
<span id="cb808-12"><a href="tables-and-graphs.html#cb808-12" tabindex="-1"></a></span>
<span id="cb808-13"><a href="tables-and-graphs.html#cb808-13" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb808-14"><a href="tables-and-graphs.html#cb808-14" tabindex="-1"></a><span class="fu">kable</span>(df_gdp[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
complaints
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
gdp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
39
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
63
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
54
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
71
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
69
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
61
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
47
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;">
usa
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;">
uk
</td>
<td style="text-align:right;">
66
</td>
</tr>
</tbody>
</table>
<p>Second, we select a subset of period to shade. We generate a random subset of non-overlapping consecutive numbers following what is outlined in <a href="https://fanwangecon.github.io/R4Econ/amto/array/htmlpdfr/fs_ary_generate.html">R4Econ.fs_ary_generate</a>.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="tables-and-graphs.html#cb809-1" tabindex="-1"></a><span class="co"># Number of random starting index</span></span>
<span id="cb809-2"><a href="tables-and-graphs.html#cb809-2" tabindex="-1"></a>it_start_idx <span class="ot">&lt;-</span> <span class="fu">min</span>(df_gdp<span class="sc">$</span>year)</span>
<span id="cb809-3"><a href="tables-and-graphs.html#cb809-3" tabindex="-1"></a>it_end_idx <span class="ot">&lt;-</span> <span class="fu">max</span>(df_gdp<span class="sc">$</span>year)</span>
<span id="cb809-4"><a href="tables-and-graphs.html#cb809-4" tabindex="-1"></a>it_startdraws_max <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb809-5"><a href="tables-and-graphs.html#cb809-5" tabindex="-1"></a>it_duramax <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb809-6"><a href="tables-and-graphs.html#cb809-6" tabindex="-1"></a>it_backward_win <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb809-7"><a href="tables-and-graphs.html#cb809-7" tabindex="-1"></a>it_forward_win <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb809-8"><a href="tables-and-graphs.html#cb809-8" tabindex="-1"></a></span>
<span id="cb809-9"><a href="tables-and-graphs.html#cb809-9" tabindex="-1"></a><span class="co"># Random seed</span></span>
<span id="cb809-10"><a href="tables-and-graphs.html#cb809-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb809-11"><a href="tables-and-graphs.html#cb809-11" tabindex="-1"></a><span class="co"># Draw random index between min and max</span></span>
<span id="cb809-12"><a href="tables-and-graphs.html#cb809-12" tabindex="-1"></a>ar_it_start_idx <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(</span>
<span id="cb809-13"><a href="tables-and-graphs.html#cb809-13" tabindex="-1"></a>    <span class="fu">seq</span>(it_start_idx, it_end_idx),</span>
<span id="cb809-14"><a href="tables-and-graphs.html#cb809-14" tabindex="-1"></a>    it_startdraws_max,</span>
<span id="cb809-15"><a href="tables-and-graphs.html#cb809-15" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb809-16"><a href="tables-and-graphs.html#cb809-16" tabindex="-1"></a>))</span>
<span id="cb809-17"><a href="tables-and-graphs.html#cb809-17" tabindex="-1"></a><span class="co"># Draw random durations, replace = TRUE because can repeat</span></span>
<span id="cb809-18"><a href="tables-and-graphs.html#cb809-18" tabindex="-1"></a>ar_it_duration <span class="ot">&lt;-</span> <span class="fu">sample</span>(it_duramax, it_startdraws_max, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb809-19"><a href="tables-and-graphs.html#cb809-19" tabindex="-1"></a></span>
<span id="cb809-20"><a href="tables-and-graphs.html#cb809-20" tabindex="-1"></a><span class="co"># Check space between starts</span></span>
<span id="cb809-21"><a href="tables-and-graphs.html#cb809-21" tabindex="-1"></a>ar_it_startgap <span class="ot">&lt;-</span> <span class="fu">diff</span>(ar_it_start_idx)</span>
<span id="cb809-22"><a href="tables-and-graphs.html#cb809-22" tabindex="-1"></a>ar_it_dura_lenm1 <span class="ot">&lt;-</span> ar_it_duration[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(ar_it_duration) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb809-23"><a href="tables-and-graphs.html#cb809-23" tabindex="-1"></a><span class="co"># Adjust durations</span></span>
<span id="cb809-24"><a href="tables-and-graphs.html#cb809-24" tabindex="-1"></a>ar_it_dura_bd <span class="ot">&lt;-</span> <span class="fu">pmin</span>(ar_it_startgap <span class="sc">-</span> <span class="dv">2</span>, ar_it_dura_lenm1)</span>
<span id="cb809-25"><a href="tables-and-graphs.html#cb809-25" tabindex="-1"></a>ar_it_duration[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(ar_it_duration) <span class="sc">-</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> ar_it_dura_bd</span>
<span id="cb809-26"><a href="tables-and-graphs.html#cb809-26" tabindex="-1"></a></span>
<span id="cb809-27"><a href="tables-and-graphs.html#cb809-27" tabindex="-1"></a><span class="co"># Drop consecutive starts</span></span>
<span id="cb809-28"><a href="tables-and-graphs.html#cb809-28" tabindex="-1"></a>ar_bl_dura_nonneg <span class="ot">&lt;-</span> <span class="fu">which</span>(ar_it_duration <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb809-29"><a href="tables-and-graphs.html#cb809-29" tabindex="-1"></a>ar_it_start_idx <span class="ot">&lt;-</span> ar_it_start_idx[ar_bl_dura_nonneg]</span>
<span id="cb809-30"><a href="tables-and-graphs.html#cb809-30" tabindex="-1"></a>ar_it_duration <span class="ot">&lt;-</span> ar_it_duration[ar_bl_dura_nonneg]</span>
<span id="cb809-31"><a href="tables-and-graphs.html#cb809-31" tabindex="-1"></a></span>
<span id="cb809-32"><a href="tables-and-graphs.html#cb809-32" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb809-33"><a href="tables-and-graphs.html#cb809-33" tabindex="-1"></a><span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb809-34"><a href="tables-and-graphs.html#cb809-34" tabindex="-1"></a>    <span class="st">&quot;random starts + duration: &quot;</span>,</span>
<span id="cb809-35"><a href="tables-and-graphs.html#cb809-35" tabindex="-1"></a>    <span class="st">&quot;{ar_it_start_idx} + {ar_it_duration}&quot;</span></span>
<span id="cb809-36"><a href="tables-and-graphs.html#cb809-36" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## random starts + duration: 5 + 1
## random starts + duration: 12 + 1
## random starts + duration: 16 + 1
## random starts + duration: 22 + 2
## random starts + duration: 26 + 0
## random starts + duration: 28 + 2</code></pre>
<p>Third, convert integers to half-point mid-distance, unless exceed lower or upper bounds, and build start and end points. We also construct back and forward window around</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="tables-and-graphs.html#cb811-1" tabindex="-1"></a><span class="co"># Offset by half of an integer</span></span>
<span id="cb811-2"><a href="tables-and-graphs.html#cb811-2" tabindex="-1"></a>ar_fl_start_time <span class="ot">&lt;-</span> ar_it_start_idx <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb811-3"><a href="tables-and-graphs.html#cb811-3" tabindex="-1"></a>ar_fl_end_time <span class="ot">&lt;-</span> ar_it_start_idx <span class="sc">+</span> ar_it_duration <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb811-4"><a href="tables-and-graphs.html#cb811-4" tabindex="-1"></a></span>
<span id="cb811-5"><a href="tables-and-graphs.html#cb811-5" tabindex="-1"></a><span class="co"># Bound by min and max</span></span>
<span id="cb811-6"><a href="tables-and-graphs.html#cb811-6" tabindex="-1"></a>ar_fl_end_time <span class="ot">&lt;-</span> <span class="fu">pmin</span>(ar_fl_end_time, it_end_idx)</span>
<span id="cb811-7"><a href="tables-and-graphs.html#cb811-7" tabindex="-1"></a>ar_fl_start_time <span class="ot">&lt;-</span> <span class="fu">pmax</span>(ar_fl_start_time, it_start_idx)</span>
<span id="cb811-8"><a href="tables-and-graphs.html#cb811-8" tabindex="-1"></a></span>
<span id="cb811-9"><a href="tables-and-graphs.html#cb811-9" tabindex="-1"></a><span class="co"># Backward window</span></span>
<span id="cb811-10"><a href="tables-and-graphs.html#cb811-10" tabindex="-1"></a>ar_fl_end_time_win_backward <span class="ot">&lt;-</span> ar_fl_start_time</span>
<span id="cb811-11"><a href="tables-and-graphs.html#cb811-11" tabindex="-1"></a>ar_fl_start_time_win_backward <span class="ot">&lt;-</span> <span class="fu">pmax</span>(</span>
<span id="cb811-12"><a href="tables-and-graphs.html#cb811-12" tabindex="-1"></a>    ar_fl_start_time <span class="sc">-</span> it_backward_win, it_start_idx</span>
<span id="cb811-13"><a href="tables-and-graphs.html#cb811-13" tabindex="-1"></a>)</span>
<span id="cb811-14"><a href="tables-and-graphs.html#cb811-14" tabindex="-1"></a></span>
<span id="cb811-15"><a href="tables-and-graphs.html#cb811-15" tabindex="-1"></a><span class="co"># Forward window</span></span>
<span id="cb811-16"><a href="tables-and-graphs.html#cb811-16" tabindex="-1"></a>ar_fl_end_time_win_forward <span class="ot">&lt;-</span> <span class="fu">pmin</span>(</span>
<span id="cb811-17"><a href="tables-and-graphs.html#cb811-17" tabindex="-1"></a>    ar_fl_end_time <span class="sc">+</span> it_forward_win, it_end_idx</span>
<span id="cb811-18"><a href="tables-and-graphs.html#cb811-18" tabindex="-1"></a>)</span>
<span id="cb811-19"><a href="tables-and-graphs.html#cb811-19" tabindex="-1"></a>ar_fl_start_time_win_forward <span class="ot">&lt;-</span> ar_fl_end_time</span>
<span id="cb811-20"><a href="tables-and-graphs.html#cb811-20" tabindex="-1"></a></span>
<span id="cb811-21"><a href="tables-and-graphs.html#cb811-21" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb811-22"><a href="tables-and-graphs.html#cb811-22" tabindex="-1"></a><span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb811-23"><a href="tables-and-graphs.html#cb811-23" tabindex="-1"></a>    <span class="st">&quot;random start-time vs end-time: &quot;</span>,</span>
<span id="cb811-24"><a href="tables-and-graphs.html#cb811-24" tabindex="-1"></a>    <span class="st">&quot;{ar_fl_start_time} + {ar_fl_end_time}&quot;</span></span>
<span id="cb811-25"><a href="tables-and-graphs.html#cb811-25" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## random start-time vs end-time: 4.5 + 6.5
## random start-time vs end-time: 11.5 + 13.5
## random start-time vs end-time: 15.5 + 17.5
## random start-time vs end-time: 21.5 + 24.5
## random start-time vs end-time: 25.5 + 26.5
## random start-time vs end-time: 27.5 + 30</code></pre>
<p>Fourth, we construct a dataframe with variables as start and end of each non-overlapping recessions. We have a main window, and a lower and upper window bounds as well.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="tables-and-graphs.html#cb813-1" tabindex="-1"></a><span class="co"># Variable names</span></span>
<span id="cb813-2"><a href="tables-and-graphs.html#cb813-2" tabindex="-1"></a><span class="co"># w1 = backward, w2 = main, w3 = forward, use w1, w2, w3 to facilate legend fill sorting</span></span>
<span id="cb813-3"><a href="tables-and-graphs.html#cb813-3" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb813-4"><a href="tables-and-graphs.html#cb813-4" tabindex="-1"></a>    <span class="st">&quot;recess_id&quot;</span>,</span>
<span id="cb813-5"><a href="tables-and-graphs.html#cb813-5" tabindex="-1"></a>    <span class="st">&quot;year_start_w2&quot;</span>, <span class="st">&quot;year_end_w2&quot;</span>,</span>
<span id="cb813-6"><a href="tables-and-graphs.html#cb813-6" tabindex="-1"></a>    <span class="st">&quot;year_start_w1&quot;</span>, <span class="st">&quot;year_end_w1&quot;</span>,</span>
<span id="cb813-7"><a href="tables-and-graphs.html#cb813-7" tabindex="-1"></a>    <span class="st">&quot;year_start_w3&quot;</span>, <span class="st">&quot;year_end_w3&quot;</span></span>
<span id="cb813-8"><a href="tables-and-graphs.html#cb813-8" tabindex="-1"></a>)</span>
<span id="cb813-9"><a href="tables-and-graphs.html#cb813-9" tabindex="-1"></a></span>
<span id="cb813-10"><a href="tables-and-graphs.html#cb813-10" tabindex="-1"></a><span class="co"># Recession index file</span></span>
<span id="cb813-11"><a href="tables-and-graphs.html#cb813-11" tabindex="-1"></a>df_recession <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(</span>
<span id="cb813-12"><a href="tables-and-graphs.html#cb813-12" tabindex="-1"></a>    ar_fl_start_time, ar_fl_end_time,</span>
<span id="cb813-13"><a href="tables-and-graphs.html#cb813-13" tabindex="-1"></a>    ar_fl_start_time_win_backward, ar_fl_end_time_win_backward,</span>
<span id="cb813-14"><a href="tables-and-graphs.html#cb813-14" tabindex="-1"></a>    ar_fl_start_time_win_forward, ar_fl_end_time_win_forward</span>
<span id="cb813-15"><a href="tables-and-graphs.html#cb813-15" tabindex="-1"></a>)) <span class="sc">%&gt;%</span></span>
<span id="cb813-16"><a href="tables-and-graphs.html#cb813-16" tabindex="-1"></a>    <span class="fu">rowid_to_column</span>() <span class="sc">%&gt;%</span></span>
<span id="cb813-17"><a href="tables-and-graphs.html#cb813-17" tabindex="-1"></a>    <span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb813-18"><a href="tables-and-graphs.html#cb813-18" tabindex="-1"></a></span>
<span id="cb813-19"><a href="tables-and-graphs.html#cb813-19" tabindex="-1"></a><span class="co"># Reshape from Wide to Long</span></span>
<span id="cb813-20"><a href="tables-and-graphs.html#cb813-20" tabindex="-1"></a>df_recession <span class="ot">&lt;-</span> df_recession <span class="sc">%&gt;%</span></span>
<span id="cb813-21"><a href="tables-and-graphs.html#cb813-21" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb813-22"><a href="tables-and-graphs.html#cb813-22" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;year&quot;</span>),</span>
<span id="cb813-23"><a href="tables-and-graphs.html#cb813-23" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;window&quot;</span>),</span>
<span id="cb813-24"><a href="tables-and-graphs.html#cb813-24" tabindex="-1"></a>        <span class="at">names_pattern =</span> <span class="st">&quot;year_(.*)_(.*)&quot;</span>,</span>
<span id="cb813-25"><a href="tables-and-graphs.html#cb813-25" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">&quot;year&quot;</span></span>
<span id="cb813-26"><a href="tables-and-graphs.html#cb813-26" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb813-27"><a href="tables-and-graphs.html#cb813-27" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb813-28"><a href="tables-and-graphs.html#cb813-28" tabindex="-1"></a>        <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&quot;recess_id&quot;</span>, <span class="st">&quot;window&quot;</span>),</span>
<span id="cb813-29"><a href="tables-and-graphs.html#cb813-29" tabindex="-1"></a>        <span class="at">names_from =</span> time,</span>
<span id="cb813-30"><a href="tables-and-graphs.html#cb813-30" tabindex="-1"></a>        <span class="at">names_prefix =</span> <span class="st">&quot;year_&quot;</span>,</span>
<span id="cb813-31"><a href="tables-and-graphs.html#cb813-31" tabindex="-1"></a>        <span class="at">values_from =</span> year</span>
<span id="cb813-32"><a href="tables-and-graphs.html#cb813-32" tabindex="-1"></a>    )</span></code></pre></div>
<p>Fifth, visualize time-series with shaded areas for “recessions”. Note that we are considering here “recessions” that are not country-specific.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="tables-and-graphs.html#cb814-1" tabindex="-1"></a><span class="co"># basic chart with two lines</span></span>
<span id="cb814-2"><a href="tables-and-graphs.html#cb814-2" tabindex="-1"></a>pl_lines_basic <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb814-3"><a href="tables-and-graphs.html#cb814-3" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> df_gdp, <span class="fu">aes</span>(</span>
<span id="cb814-4"><a href="tables-and-graphs.html#cb814-4" tabindex="-1"></a>        <span class="at">x =</span> year, <span class="at">y =</span> gdp,</span>
<span id="cb814-5"><a href="tables-and-graphs.html#cb814-5" tabindex="-1"></a>        <span class="at">color =</span> country, <span class="at">linetype =</span> country</span>
<span id="cb814-6"><a href="tables-and-graphs.html#cb814-6" tabindex="-1"></a>    ), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb814-7"><a href="tables-and-graphs.html#cb814-7" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> df_recession <span class="sc">%&gt;%</span></span>
<span id="cb814-8"><a href="tables-and-graphs.html#cb814-8" tabindex="-1"></a>        <span class="fu">filter</span>(window <span class="sc">==</span> <span class="st">&quot;w2&quot;</span>), <span class="fu">aes</span>(</span>
<span id="cb814-9"><a href="tables-and-graphs.html#cb814-9" tabindex="-1"></a>        <span class="at">xmin =</span> year_start, <span class="at">xmax =</span> year_end,</span>
<span id="cb814-10"><a href="tables-and-graphs.html#cb814-10" tabindex="-1"></a>        <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span></span>
<span id="cb814-11"><a href="tables-and-graphs.html#cb814-11" tabindex="-1"></a>    ), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb814-12"><a href="tables-and-graphs.html#cb814-12" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb814-13"><a href="tables-and-graphs.html#cb814-13" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;Years&quot;</span>),</span>
<span id="cb814-14"><a href="tables-and-graphs.html#cb814-14" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;Ratings&quot;</span>),</span>
<span id="cb814-15"><a href="tables-and-graphs.html#cb814-15" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">paste</span>(</span>
<span id="cb814-16"><a href="tables-and-graphs.html#cb814-16" tabindex="-1"></a>            <span class="st">&quot;Main Title for this Figure over Countries (Shaded Recessions)&quot;</span>,</span>
<span id="cb814-17"><a href="tables-and-graphs.html#cb814-17" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">&quot; &quot;</span></span>
<span id="cb814-18"><a href="tables-and-graphs.html#cb814-18" tabindex="-1"></a>        ),</span>
<span id="cb814-19"><a href="tables-and-graphs.html#cb814-19" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste</span>(</span>
<span id="cb814-20"><a href="tables-and-graphs.html#cb814-20" tabindex="-1"></a>            <span class="st">&quot;Subtitle for ratings changes across&quot;</span>,</span>
<span id="cb814-21"><a href="tables-and-graphs.html#cb814-21" tabindex="-1"></a>            <span class="st">&quot;countries&quot;</span>,</span>
<span id="cb814-22"><a href="tables-and-graphs.html#cb814-22" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">&quot; &quot;</span></span>
<span id="cb814-23"><a href="tables-and-graphs.html#cb814-23" tabindex="-1"></a>        ),</span>
<span id="cb814-24"><a href="tables-and-graphs.html#cb814-24" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">paste</span>(</span>
<span id="cb814-25"><a href="tables-and-graphs.html#cb814-25" tabindex="-1"></a>            <span class="st">&quot;Caption for our figure here &quot;</span>,</span>
<span id="cb814-26"><a href="tables-and-graphs.html#cb814-26" tabindex="-1"></a>            <span class="st">&quot;This is the next line &quot;</span>,</span>
<span id="cb814-27"><a href="tables-and-graphs.html#cb814-27" tabindex="-1"></a>            <span class="st">&quot;Another line&quot;</span>,</span>
<span id="cb814-28"><a href="tables-and-graphs.html#cb814-28" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb814-29"><a href="tables-and-graphs.html#cb814-29" tabindex="-1"></a>        )</span>
<span id="cb814-30"><a href="tables-and-graphs.html#cb814-30" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb814-31"><a href="tables-and-graphs.html#cb814-31" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb814-32"><a href="tables-and-graphs.html#cb814-32" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>country, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb814-33"><a href="tables-and-graphs.html#cb814-33" tabindex="-1"></a></span>
<span id="cb814-34"><a href="tables-and-graphs.html#cb814-34" tabindex="-1"></a><span class="co"># print figure</span></span>
<span id="cb814-35"><a href="tables-and-graphs.html#cb814-35" tabindex="-1"></a><span class="fu">print</span>(pl_lines_basic)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-419-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Sixth, we generate a more customized visualization with customized: (1) colors and shapes for lines as well as for windows; (2) x- and y-axis limits, labels, and breaks; (3) customized legend position.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="tables-and-graphs.html#cb815-1" tabindex="-1"></a><span class="co"># Window color</span></span>
<span id="cb815-2"><a href="tables-and-graphs.html#cb815-2" tabindex="-1"></a>st_win_leg_title <span class="ot">&lt;-</span> <span class="st">&quot;Window&quot;</span></span>
<span id="cb815-3"><a href="tables-and-graphs.html#cb815-3" tabindex="-1"></a>st_win_color <span class="ot">&lt;-</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb815-4"><a href="tables-and-graphs.html#cb815-4" tabindex="-1"></a>st_win_label <span class="ot">&lt;-</span> <span class="st">&quot;Recession&quot;</span></span>
<span id="cb815-5"><a href="tables-and-graphs.html#cb815-5" tabindex="-1"></a><span class="co"># basic chart with two lines</span></span>
<span id="cb815-6"><a href="tables-and-graphs.html#cb815-6" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb815-7"><a href="tables-and-graphs.html#cb815-7" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> df_gdp, <span class="fu">aes</span>(</span>
<span id="cb815-8"><a href="tables-and-graphs.html#cb815-8" tabindex="-1"></a>        <span class="at">x =</span> year, <span class="at">y =</span> gdp,</span>
<span id="cb815-9"><a href="tables-and-graphs.html#cb815-9" tabindex="-1"></a>        <span class="at">color =</span> country, <span class="at">linetype =</span> country</span>
<span id="cb815-10"><a href="tables-and-graphs.html#cb815-10" tabindex="-1"></a>    ), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb815-11"><a href="tables-and-graphs.html#cb815-11" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> df_recession <span class="sc">%&gt;%</span></span>
<span id="cb815-12"><a href="tables-and-graphs.html#cb815-12" tabindex="-1"></a>        <span class="fu">filter</span>(window <span class="sc">==</span> <span class="st">&quot;w2&quot;</span>), <span class="fu">aes</span>(</span>
<span id="cb815-13"><a href="tables-and-graphs.html#cb815-13" tabindex="-1"></a>        <span class="at">xmin =</span> year_start, <span class="at">xmax =</span> year_end,</span>
<span id="cb815-14"><a href="tables-and-graphs.html#cb815-14" tabindex="-1"></a>        <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb815-15"><a href="tables-and-graphs.html#cb815-15" tabindex="-1"></a>        <span class="at">fill =</span> st_win_color</span>
<span id="cb815-16"><a href="tables-and-graphs.html#cb815-16" tabindex="-1"></a>    ), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb815-17"><a href="tables-and-graphs.html#cb815-17" tabindex="-1"></a>    <span class="fu">theme_light</span>()</span>
<span id="cb815-18"><a href="tables-and-graphs.html#cb815-18" tabindex="-1"></a></span>
<span id="cb815-19"><a href="tables-and-graphs.html#cb815-19" tabindex="-1"></a><span class="co"># Titles</span></span>
<span id="cb815-20"><a href="tables-and-graphs.html#cb815-20" tabindex="-1"></a>st_x <span class="ot">&lt;-</span> <span class="st">&quot;Years&quot;</span></span>
<span id="cb815-21"><a href="tables-and-graphs.html#cb815-21" tabindex="-1"></a>st_y <span class="ot">&lt;-</span> <span class="st">&quot;GDP&quot;</span></span>
<span id="cb815-22"><a href="tables-and-graphs.html#cb815-22" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="st">&quot;GDP changes across countries (shaded recessions)&quot;</span></span>
<span id="cb815-23"><a href="tables-and-graphs.html#cb815-23" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb815-24"><a href="tables-and-graphs.html#cb815-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb815-25"><a href="tables-and-graphs.html#cb815-25" tabindex="-1"></a>        <span class="at">x =</span> st_x,</span>
<span id="cb815-26"><a href="tables-and-graphs.html#cb815-26" tabindex="-1"></a>        <span class="at">y =</span> st_y,</span>
<span id="cb815-27"><a href="tables-and-graphs.html#cb815-27" tabindex="-1"></a>        <span class="at">subtitle =</span> st_subtitle</span>
<span id="cb815-28"><a href="tables-and-graphs.html#cb815-28" tabindex="-1"></a>    )</span>
<span id="cb815-29"><a href="tables-and-graphs.html#cb815-29" tabindex="-1"></a></span>
<span id="cb815-30"><a href="tables-and-graphs.html#cb815-30" tabindex="-1"></a><span class="co"># Figure improvements</span></span>
<span id="cb815-31"><a href="tables-and-graphs.html#cb815-31" tabindex="-1"></a><span class="co"># set shapes and colors</span></span>
<span id="cb815-32"><a href="tables-and-graphs.html#cb815-32" tabindex="-1"></a>st_line_leg_title <span class="ot">&lt;-</span> <span class="st">&quot;Country&quot;</span></span>
<span id="cb815-33"><a href="tables-and-graphs.html#cb815-33" tabindex="-1"></a>ar_st_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb815-34"><a href="tables-and-graphs.html#cb815-34" tabindex="-1"></a>    <span class="fu">bquote</span>(<span class="st">&quot;UK&quot;</span>),</span>
<span id="cb815-35"><a href="tables-and-graphs.html#cb815-35" tabindex="-1"></a>    <span class="fu">bquote</span>(<span class="st">&quot;USA&quot;</span>)</span>
<span id="cb815-36"><a href="tables-and-graphs.html#cb815-36" tabindex="-1"></a>)</span>
<span id="cb815-37"><a href="tables-and-graphs.html#cb815-37" tabindex="-1"></a></span>
<span id="cb815-38"><a href="tables-and-graphs.html#cb815-38" tabindex="-1"></a>ar_st_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#026aa3&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb815-39"><a href="tables-and-graphs.html#cb815-39" tabindex="-1"></a>ar_st_linetypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)</span>
<span id="cb815-40"><a href="tables-and-graphs.html#cb815-40" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb815-41"><a href="tables-and-graphs.html#cb815-41" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> ar_st_colours, <span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb815-42"><a href="tables-and-graphs.html#cb815-42" tabindex="-1"></a>    <span class="fu">scale_shape_discrete</span>(<span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb815-43"><a href="tables-and-graphs.html#cb815-43" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> ar_st_linetypes, <span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb815-44"><a href="tables-and-graphs.html#cb815-44" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(st_win_color), <span class="at">labels =</span> <span class="fu">c</span>(st_win_label)) <span class="sc">+</span></span>
<span id="cb815-45"><a href="tables-and-graphs.html#cb815-45" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb815-46"><a href="tables-and-graphs.html#cb815-46" tabindex="-1"></a>        <span class="at">fill =</span> st_win_leg_title,</span>
<span id="cb815-47"><a href="tables-and-graphs.html#cb815-47" tabindex="-1"></a>        <span class="at">colour =</span> st_line_leg_title, <span class="at">linetype =</span> st_line_leg_title</span>
<span id="cb815-48"><a href="tables-and-graphs.html#cb815-48" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb815-49"><a href="tables-and-graphs.html#cb815-49" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">&quot;line&quot;</span>))</span>
<span id="cb815-50"><a href="tables-and-graphs.html#cb815-50" tabindex="-1"></a></span>
<span id="cb815-51"><a href="tables-and-graphs.html#cb815-51" tabindex="-1"></a><span class="co"># Axis</span></span>
<span id="cb815-52"><a href="tables-and-graphs.html#cb815-52" tabindex="-1"></a>x_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="at">length.out =</span> <span class="dv">30</span>)</span>
<span id="cb815-53"><a href="tables-and-graphs.html#cb815-53" tabindex="-1"></a>x_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Year &quot;</span>, x_breaks <span class="sc">+</span> <span class="dv">1990</span>)</span>
<span id="cb815-54"><a href="tables-and-graphs.html#cb815-54" tabindex="-1"></a></span>
<span id="cb815-55"><a href="tables-and-graphs.html#cb815-55" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb815-56"><a href="tables-and-graphs.html#cb815-56" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb815-57"><a href="tables-and-graphs.html#cb815-57" tabindex="-1"></a></span>
<span id="cb815-58"><a href="tables-and-graphs.html#cb815-58" tabindex="-1"></a>y_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">90</span>, <span class="at">length.out =</span> <span class="dv">6</span>)</span>
<span id="cb815-59"><a href="tables-and-graphs.html#cb815-59" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;y=&quot;</span>, y_breaks)</span>
<span id="cb815-60"><a href="tables-and-graphs.html#cb815-60" tabindex="-1"></a>y_min <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb815-61"><a href="tables-and-graphs.html#cb815-61" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb815-62"><a href="tables-and-graphs.html#cb815-62" tabindex="-1"></a></span>
<span id="cb815-63"><a href="tables-and-graphs.html#cb815-63" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb815-64"><a href="tables-and-graphs.html#cb815-64" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb815-65"><a href="tables-and-graphs.html#cb815-65" tabindex="-1"></a>        <span class="at">labels =</span> x_labels, <span class="at">breaks =</span> x_breaks,</span>
<span id="cb815-66"><a href="tables-and-graphs.html#cb815-66" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(x_min, x_max)</span>
<span id="cb815-67"><a href="tables-and-graphs.html#cb815-67" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb815-68"><a href="tables-and-graphs.html#cb815-68" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb815-69"><a href="tables-and-graphs.html#cb815-69" tabindex="-1"></a>        <span class="co"># Adjust x-label angle</span></span>
<span id="cb815-70"><a href="tables-and-graphs.html#cb815-70" tabindex="-1"></a>        <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb815-71"><a href="tables-and-graphs.html#cb815-71" tabindex="-1"></a>        <span class="co"># Adjust x-label distance to x-axis (up vs down)</span></span>
<span id="cb815-72"><a href="tables-and-graphs.html#cb815-72" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.4</span>,</span>
<span id="cb815-73"><a href="tables-and-graphs.html#cb815-73" tabindex="-1"></a>        <span class="co"># Adjust x-label left vs right wwith respect ot break point</span></span>
<span id="cb815-74"><a href="tables-and-graphs.html#cb815-74" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="fl">0.5</span></span>
<span id="cb815-75"><a href="tables-and-graphs.html#cb815-75" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb815-76"><a href="tables-and-graphs.html#cb815-76" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb815-77"><a href="tables-and-graphs.html#cb815-77" tabindex="-1"></a>        <span class="at">labels =</span> y_labels, <span class="at">breaks =</span> y_breaks,</span>
<span id="cb815-78"><a href="tables-and-graphs.html#cb815-78" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(y_min, y_max)</span>
<span id="cb815-79"><a href="tables-and-graphs.html#cb815-79" tabindex="-1"></a>    )</span>
<span id="cb815-80"><a href="tables-and-graphs.html#cb815-80" tabindex="-1"></a></span>
<span id="cb815-81"><a href="tables-and-graphs.html#cb815-81" tabindex="-1"></a><span class="co"># print figure</span></span>
<span id="cb815-82"><a href="tables-and-graphs.html#cb815-82" tabindex="-1"></a><span class="fu">print</span>(pl_lines)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-420-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Finally, we generate a figure with three fill colors for the three windows, main, backward, and forward windows. We reuse various parameters used in the prior block.</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="tables-and-graphs.html#cb816-1" tabindex="-1"></a><span class="co"># Window color</span></span>
<span id="cb816-2"><a href="tables-and-graphs.html#cb816-2" tabindex="-1"></a>st_win_leg_title <span class="ot">&lt;-</span> <span class="st">&quot;Window&quot;</span></span>
<span id="cb816-3"><a href="tables-and-graphs.html#cb816-3" tabindex="-1"></a><span class="co"># basic chart with two lines</span></span>
<span id="cb816-4"><a href="tables-and-graphs.html#cb816-4" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb816-5"><a href="tables-and-graphs.html#cb816-5" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> df_gdp, <span class="fu">aes</span>(</span>
<span id="cb816-6"><a href="tables-and-graphs.html#cb816-6" tabindex="-1"></a>        <span class="at">x =</span> year, <span class="at">y =</span> gdp,</span>
<span id="cb816-7"><a href="tables-and-graphs.html#cb816-7" tabindex="-1"></a>        <span class="at">color =</span> country, <span class="at">linetype =</span> country</span>
<span id="cb816-8"><a href="tables-and-graphs.html#cb816-8" tabindex="-1"></a>    ), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb816-9"><a href="tables-and-graphs.html#cb816-9" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> df_recession, <span class="fu">aes</span>(</span>
<span id="cb816-10"><a href="tables-and-graphs.html#cb816-10" tabindex="-1"></a>        <span class="at">xmin =</span> year_start, <span class="at">xmax =</span> year_end,</span>
<span id="cb816-11"><a href="tables-and-graphs.html#cb816-11" tabindex="-1"></a>        <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb816-12"><a href="tables-and-graphs.html#cb816-12" tabindex="-1"></a>        <span class="at">fill =</span> window</span>
<span id="cb816-13"><a href="tables-and-graphs.html#cb816-13" tabindex="-1"></a>    ), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb816-14"><a href="tables-and-graphs.html#cb816-14" tabindex="-1"></a>    <span class="fu">theme_light</span>()</span>
<span id="cb816-15"><a href="tables-and-graphs.html#cb816-15" tabindex="-1"></a></span>
<span id="cb816-16"><a href="tables-and-graphs.html#cb816-16" tabindex="-1"></a><span class="co"># Titles</span></span>
<span id="cb816-17"><a href="tables-and-graphs.html#cb816-17" tabindex="-1"></a>st_x <span class="ot">&lt;-</span> <span class="st">&quot;Years&quot;</span></span>
<span id="cb816-18"><a href="tables-and-graphs.html#cb816-18" tabindex="-1"></a>st_y <span class="ot">&lt;-</span> <span class="st">&quot;GDP&quot;</span></span>
<span id="cb816-19"><a href="tables-and-graphs.html#cb816-19" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="st">&quot;GDP changes across countries (shaded recessions, with pre and post)&quot;</span></span>
<span id="cb816-20"><a href="tables-and-graphs.html#cb816-20" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb816-21"><a href="tables-and-graphs.html#cb816-21" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb816-22"><a href="tables-and-graphs.html#cb816-22" tabindex="-1"></a>        <span class="at">x =</span> st_x,</span>
<span id="cb816-23"><a href="tables-and-graphs.html#cb816-23" tabindex="-1"></a>        <span class="at">y =</span> st_y,</span>
<span id="cb816-24"><a href="tables-and-graphs.html#cb816-24" tabindex="-1"></a>        <span class="at">subtitle =</span> st_subtitle</span>
<span id="cb816-25"><a href="tables-and-graphs.html#cb816-25" tabindex="-1"></a>    )</span>
<span id="cb816-26"><a href="tables-and-graphs.html#cb816-26" tabindex="-1"></a></span>
<span id="cb816-27"><a href="tables-and-graphs.html#cb816-27" tabindex="-1"></a><span class="co"># Figure improvements</span></span>
<span id="cb816-28"><a href="tables-and-graphs.html#cb816-28" tabindex="-1"></a><span class="co"># fill label and colors</span></span>
<span id="cb816-29"><a href="tables-and-graphs.html#cb816-29" tabindex="-1"></a>ar_st_win_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb816-30"><a href="tables-and-graphs.html#cb816-30" tabindex="-1"></a>ar_st_win_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Backward&quot;</span>, <span class="st">&quot;Recession&quot;</span>, <span class="st">&quot;Forward&quot;</span>)</span>
<span id="cb816-31"><a href="tables-and-graphs.html#cb816-31" tabindex="-1"></a><span class="co"># set shapes and colors</span></span>
<span id="cb816-32"><a href="tables-and-graphs.html#cb816-32" tabindex="-1"></a>st_line_leg_title <span class="ot">&lt;-</span> <span class="st">&quot;Country&quot;</span></span>
<span id="cb816-33"><a href="tables-and-graphs.html#cb816-33" tabindex="-1"></a>ar_st_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb816-34"><a href="tables-and-graphs.html#cb816-34" tabindex="-1"></a>    <span class="fu">bquote</span>(<span class="st">&quot;UK&quot;</span>),</span>
<span id="cb816-35"><a href="tables-and-graphs.html#cb816-35" tabindex="-1"></a>    <span class="fu">bquote</span>(<span class="st">&quot;USA&quot;</span>)</span>
<span id="cb816-36"><a href="tables-and-graphs.html#cb816-36" tabindex="-1"></a>)</span>
<span id="cb816-37"><a href="tables-and-graphs.html#cb816-37" tabindex="-1"></a></span>
<span id="cb816-38"><a href="tables-and-graphs.html#cb816-38" tabindex="-1"></a>ar_st_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#026aa3&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb816-39"><a href="tables-and-graphs.html#cb816-39" tabindex="-1"></a>ar_st_linetypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>)</span>
<span id="cb816-40"><a href="tables-and-graphs.html#cb816-40" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb816-41"><a href="tables-and-graphs.html#cb816-41" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> ar_st_colours, <span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb816-42"><a href="tables-and-graphs.html#cb816-42" tabindex="-1"></a>    <span class="fu">scale_shape_discrete</span>(<span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb816-43"><a href="tables-and-graphs.html#cb816-43" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> ar_st_linetypes, <span class="at">labels =</span> ar_st_labels) <span class="sc">+</span></span>
<span id="cb816-44"><a href="tables-and-graphs.html#cb816-44" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(ar_st_win_color), <span class="at">labels =</span> <span class="fu">c</span>(ar_st_win_label)) <span class="sc">+</span></span>
<span id="cb816-45"><a href="tables-and-graphs.html#cb816-45" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb816-46"><a href="tables-and-graphs.html#cb816-46" tabindex="-1"></a>        <span class="at">fill =</span> st_win_leg_title,</span>
<span id="cb816-47"><a href="tables-and-graphs.html#cb816-47" tabindex="-1"></a>        <span class="at">colour =</span> st_line_leg_title, <span class="at">linetype =</span> st_line_leg_title</span>
<span id="cb816-48"><a href="tables-and-graphs.html#cb816-48" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb816-49"><a href="tables-and-graphs.html#cb816-49" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">&quot;line&quot;</span>))</span>
<span id="cb816-50"><a href="tables-and-graphs.html#cb816-50" tabindex="-1"></a></span>
<span id="cb816-51"><a href="tables-and-graphs.html#cb816-51" tabindex="-1"></a><span class="co"># Axis</span></span>
<span id="cb816-52"><a href="tables-and-graphs.html#cb816-52" tabindex="-1"></a>x_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="at">length.out =</span> <span class="dv">30</span>)</span>
<span id="cb816-53"><a href="tables-and-graphs.html#cb816-53" tabindex="-1"></a>x_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Year &quot;</span>, x_breaks <span class="sc">+</span> <span class="dv">1990</span>)</span>
<span id="cb816-54"><a href="tables-and-graphs.html#cb816-54" tabindex="-1"></a></span>
<span id="cb816-55"><a href="tables-and-graphs.html#cb816-55" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb816-56"><a href="tables-and-graphs.html#cb816-56" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb816-57"><a href="tables-and-graphs.html#cb816-57" tabindex="-1"></a></span>
<span id="cb816-58"><a href="tables-and-graphs.html#cb816-58" tabindex="-1"></a>y_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">90</span>, <span class="at">length.out =</span> <span class="dv">6</span>)</span>
<span id="cb816-59"><a href="tables-and-graphs.html#cb816-59" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;y=&quot;</span>, y_breaks)</span>
<span id="cb816-60"><a href="tables-and-graphs.html#cb816-60" tabindex="-1"></a>y_min <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb816-61"><a href="tables-and-graphs.html#cb816-61" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb816-62"><a href="tables-and-graphs.html#cb816-62" tabindex="-1"></a></span>
<span id="cb816-63"><a href="tables-and-graphs.html#cb816-63" tabindex="-1"></a>pl_lines <span class="ot">&lt;-</span> pl_lines <span class="sc">+</span></span>
<span id="cb816-64"><a href="tables-and-graphs.html#cb816-64" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb816-65"><a href="tables-and-graphs.html#cb816-65" tabindex="-1"></a>        <span class="at">labels =</span> x_labels, <span class="at">breaks =</span> x_breaks,</span>
<span id="cb816-66"><a href="tables-and-graphs.html#cb816-66" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(x_min, x_max)</span>
<span id="cb816-67"><a href="tables-and-graphs.html#cb816-67" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb816-68"><a href="tables-and-graphs.html#cb816-68" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb816-69"><a href="tables-and-graphs.html#cb816-69" tabindex="-1"></a>        <span class="co"># Adjust x-label angle</span></span>
<span id="cb816-70"><a href="tables-and-graphs.html#cb816-70" tabindex="-1"></a>        <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb816-71"><a href="tables-and-graphs.html#cb816-71" tabindex="-1"></a>        <span class="co"># Adjust x-label distance to x-axis (up vs down)</span></span>
<span id="cb816-72"><a href="tables-and-graphs.html#cb816-72" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.4</span>,</span>
<span id="cb816-73"><a href="tables-and-graphs.html#cb816-73" tabindex="-1"></a>        <span class="co"># Adjust x-label left vs right wwith respect ot break point</span></span>
<span id="cb816-74"><a href="tables-and-graphs.html#cb816-74" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="fl">0.5</span></span>
<span id="cb816-75"><a href="tables-and-graphs.html#cb816-75" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb816-76"><a href="tables-and-graphs.html#cb816-76" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb816-77"><a href="tables-and-graphs.html#cb816-77" tabindex="-1"></a>        <span class="at">labels =</span> y_labels, <span class="at">breaks =</span> y_breaks,</span>
<span id="cb816-78"><a href="tables-and-graphs.html#cb816-78" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(y_min, y_max)</span>
<span id="cb816-79"><a href="tables-and-graphs.html#cb816-79" tabindex="-1"></a>    )</span>
<span id="cb816-80"><a href="tables-and-graphs.html#cb816-80" tabindex="-1"></a></span>
<span id="cb816-81"><a href="tables-and-graphs.html#cb816-81" tabindex="-1"></a><span class="co"># print figure</span></span>
<span id="cb816-82"><a href="tables-and-graphs.html#cb816-82" tabindex="-1"></a><span class="fu">print</span>(pl_lines)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-421-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="ggplot-scatter-related-plots" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> ggplot Scatter Related Plots<a href="tables-and-graphs.html#ggplot-scatter-related-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="ggplot-scatter-plot" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> ggplot Scatter Plot<a href="tables-and-graphs.html#ggplot-scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="scatter-plot-with-unique-shape-color-and-label-for-each" class="section level4 hasAnchor" number="10.3.1.1">
<h4><span class="header-section-number">10.3.1.1</span> Scatter Plot with Unique Shape, Color, and Label for Each<a href="tables-and-graphs.html#scatter-plot-with-unique-shape-color-and-label-for-each" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>y-axis: horsepower</li>
<li>x-axis: time for 1/4 Miles (QSEC)</li>
<li>filter: select to display six cars as six scattered points</li>
</ol>
<p>First, select the relevant variables and filter.</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="tables-and-graphs.html#cb817-1" tabindex="-1"></a><span class="co"># Include row-name (car-names) as a variable</span></span>
<span id="cb817-2"><a href="tables-and-graphs.html#cb817-2" tabindex="-1"></a>tb_carnames <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(mtcars, <span class="at">var =</span> <span class="st">&quot;car_name&quot;</span>)  <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb817-3"><a href="tables-and-graphs.html#cb817-3" tabindex="-1"></a><span class="co"># Select only six observations for scatter plot</span></span>
<span id="cb817-4"><a href="tables-and-graphs.html#cb817-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb817-5"><a href="tables-and-graphs.html#cb817-5" tabindex="-1"></a>it_cars_select <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb817-6"><a href="tables-and-graphs.html#cb817-6" tabindex="-1"></a>tb_carnames_selected <span class="ot">&lt;-</span> tb_carnames[<span class="fu">sample</span>(<span class="fu">dim</span>(tb_carnames)[<span class="dv">1</span>], it_cars_select, <span class="at">replace=</span><span class="cn">FALSE</span>), ]</span>
<span id="cb817-7"><a href="tables-and-graphs.html#cb817-7" tabindex="-1"></a><span class="co"># Select only car name and a few variables</span></span>
<span id="cb817-8"><a href="tables-and-graphs.html#cb817-8" tabindex="-1"></a>tb_carnames_selected <span class="ot">&lt;-</span> tb_carnames_selected <span class="sc">%&gt;%</span> </span>
<span id="cb817-9"><a href="tables-and-graphs.html#cb817-9" tabindex="-1"></a>  <span class="fu">select</span>(car_name, hp, qsec) <span class="sc">%&gt;%</span></span>
<span id="cb817-10"><a href="tables-and-graphs.html#cb817-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">car_name =</span> <span class="fu">factor</span>(car_name))</span></code></pre></div>
<p>Second, add styling for each point:</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="tables-and-graphs.html#cb818-1" tabindex="-1"></a><span class="co"># https://www.rgbtohex.net/</span></span>
<span id="cb818-2"><a href="tables-and-graphs.html#cb818-2" tabindex="-1"></a><span class="co"># https://fanwangecon.github.io/M4Econ/graph/tools/htmlpdfm/fs_color.html</span></span>
<span id="cb818-3"><a href="tables-and-graphs.html#cb818-3" tabindex="-1"></a><span class="co"># ar_st_colours &lt;- c(</span></span>
<span id="cb818-4"><a href="tables-and-graphs.html#cb818-4" tabindex="-1"></a><span class="co">#   &quot;#262626&quot;, &quot;#922428&quot;, </span></span>
<span id="cb818-5"><a href="tables-and-graphs.html#cb818-5" tabindex="-1"></a><span class="co">#   &quot;#6b4c9a&quot;, &quot;#535154&quot;, </span></span>
<span id="cb818-6"><a href="tables-and-graphs.html#cb818-6" tabindex="-1"></a><span class="co">#   &quot;#3e9651&quot;, &quot;#396ab1&quot;, </span></span>
<span id="cb818-7"><a href="tables-and-graphs.html#cb818-7" tabindex="-1"></a><span class="co">#   &quot;#cc2529&quot;, &quot;#ED8137&quot;)</span></span>
<span id="cb818-8"><a href="tables-and-graphs.html#cb818-8" tabindex="-1"></a>ar_st_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb818-9"><a href="tables-and-graphs.html#cb818-9" tabindex="-1"></a>  <span class="st">&quot;#922428&quot;</span>, <span class="st">&quot;#922428&quot;</span>, </span>
<span id="cb818-10"><a href="tables-and-graphs.html#cb818-10" tabindex="-1"></a>  <span class="st">&quot;#3e9651&quot;</span>, <span class="st">&quot;#3e9651&quot;</span>, </span>
<span id="cb818-11"><a href="tables-and-graphs.html#cb818-11" tabindex="-1"></a>  <span class="st">&quot;#396ab1&quot;</span>, <span class="st">&quot;#396ab1&quot;</span>, </span>
<span id="cb818-12"><a href="tables-and-graphs.html#cb818-12" tabindex="-1"></a>  <span class="st">&quot;#cc2529&quot;</span>, <span class="st">&quot;#cc2529&quot;</span>)</span>
<span id="cb818-13"><a href="tables-and-graphs.html#cb818-13" tabindex="-1"></a><span class="co"># http://sape.inf.usi.ch/quick-reference/ggplot2/shape</span></span>
<span id="cb818-14"><a href="tables-and-graphs.html#cb818-14" tabindex="-1"></a><span class="co"># 32 is invisible shape</span></span>
<span id="cb818-15"><a href="tables-and-graphs.html#cb818-15" tabindex="-1"></a><span class="co"># ar_it_shapes &lt;- c(32, 5, 17, 15, 1)</span></span>
<span id="cb818-16"><a href="tables-and-graphs.html#cb818-16" tabindex="-1"></a>ar_it_shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb818-17"><a href="tables-and-graphs.html#cb818-17" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">15</span>, <span class="co"># square</span></span>
<span id="cb818-18"><a href="tables-and-graphs.html#cb818-18" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">16</span>, <span class="co"># circle</span></span>
<span id="cb818-19"><a href="tables-and-graphs.html#cb818-19" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">17</span>, <span class="co"># triangle</span></span>
<span id="cb818-20"><a href="tables-and-graphs.html#cb818-20" tabindex="-1"></a>  <span class="dv">5</span>, <span class="dv">18</span> <span class="co"># diamond</span></span>
<span id="cb818-21"><a href="tables-and-graphs.html#cb818-21" tabindex="-1"></a>  )</span></code></pre></div>
<p>Third, draw a scatter plot, with defaults.</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="tables-and-graphs.html#cb819-1" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb819-2"><a href="tables-and-graphs.html#cb819-2" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Scatter plot of HP and QSEC with unique color and shapes&#39;</span>)</span>
<span id="cb819-3"><a href="tables-and-graphs.html#cb819-3" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb819-4"><a href="tables-and-graphs.html#cb819-4" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/tabgraph/ggscatter/htmlpdfr/fs_ggscatter_3cts_mdisc.html&#39;</span>)</span>
<span id="cb819-5"><a href="tables-and-graphs.html#cb819-5" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;mtcars dataset, &#39;</span>,</span>
<span id="cb819-6"><a href="tables-and-graphs.html#cb819-6" tabindex="-1"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb819-7"><a href="tables-and-graphs.html#cb819-7" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;HP = Horse Power&#39;</span></span>
<span id="cb819-8"><a href="tables-and-graphs.html#cb819-8" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;QSEC = time for 1/4 Miles&#39;</span></span>
<span id="cb819-9"><a href="tables-and-graphs.html#cb819-9" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb819-10"><a href="tables-and-graphs.html#cb819-10" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> tb_carnames_selected <span class="sc">%&gt;%</span></span>
<span id="cb819-11"><a href="tables-and-graphs.html#cb819-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>qsec, </span>
<span id="cb819-12"><a href="tables-and-graphs.html#cb819-12" tabindex="-1"></a>             <span class="at">colour =</span> car_name, <span class="at">shape =</span> car_name, </span>
<span id="cb819-13"><a href="tables-and-graphs.html#cb819-13" tabindex="-1"></a>             <span class="at">label=</span>car_name)) <span class="sc">+</span></span>
<span id="cb819-14"><a href="tables-and-graphs.html#cb819-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">stroke =</span> <span class="fl">1.75</span>) <span class="sc">+</span> </span>
<span id="cb819-15"><a href="tables-and-graphs.html#cb819-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb819-16"><a href="tables-and-graphs.html#cb819-16" tabindex="-1"></a>       <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption)</span>
<span id="cb819-17"><a href="tables-and-graphs.html#cb819-17" tabindex="-1"></a>  <span class="co"># geom_text(color=&#39;black&#39;, size = 3.5, check_overlap = TRUE)</span></span>
<span id="cb819-18"><a href="tables-and-graphs.html#cb819-18" tabindex="-1"></a><span class="co"># Display preliminary</span></span>
<span id="cb819-19"><a href="tables-and-graphs.html#cb819-19" tabindex="-1"></a><span class="co"># print(plt_mtcars_scatter)</span></span></code></pre></div>
<p>Fourth, add in color and shape for each point based on our specifications.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="tables-and-graphs.html#cb820-1" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span>    </span>
<span id="cb820-2"><a href="tables-and-graphs.html#cb820-2" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> ar_st_colours) <span class="sc">+</span></span>
<span id="cb820-3"><a href="tables-and-graphs.html#cb820-3" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> ar_it_shapes)</span>
<span id="cb820-4"><a href="tables-and-graphs.html#cb820-4" tabindex="-1"></a><span class="co"># Display preliminary</span></span>
<span id="cb820-5"><a href="tables-and-graphs.html#cb820-5" tabindex="-1"></a><span class="fu">print</span>(plt_mtcars_scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-426-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Fifth, axis control, add-in mid-lines and additional layer of axis to show differences from added mid-lines. Add two layers of y and x labels, so that we have levels as well as deviations from the horizontal and vertical lines. Have two layers of labels so that have levels and deviations from levels.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="tables-and-graphs.html#cb821-1" tabindex="-1"></a><span class="co"># A. Y-line and X-line</span></span>
<span id="cb821-2"><a href="tables-and-graphs.html#cb821-2" tabindex="-1"></a>fl_y_line_val <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb821-3"><a href="tables-and-graphs.html#cb821-3" tabindex="-1"></a>fl_x_line_val <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb821-4"><a href="tables-and-graphs.html#cb821-4" tabindex="-1"></a></span>
<span id="cb821-5"><a href="tables-and-graphs.html#cb821-5" tabindex="-1"></a><span class="co"># B. X labels</span></span>
<span id="cb821-6"><a href="tables-and-graphs.html#cb821-6" tabindex="-1"></a>x_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">350</span>)</span>
<span id="cb821-7"><a href="tables-and-graphs.html#cb821-7" tabindex="-1"></a><span class="co"># x labels layer 2</span></span>
<span id="cb821-8"><a href="tables-and-graphs.html#cb821-8" tabindex="-1"></a>x_breaks_devi <span class="ot">&lt;-</span> x_breaks <span class="sc">-</span> fl_x_line_val</span>
<span id="cb821-9"><a href="tables-and-graphs.html#cb821-9" tabindex="-1"></a>st_x_breaks_devi <span class="ot">&lt;-</span> <span class="fu">paste0</span>(x_breaks_devi)</span>
<span id="cb821-10"><a href="tables-and-graphs.html#cb821-10" tabindex="-1"></a>st_x_breaks_devi[x_breaks_devi<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;+&quot;</span>, st_x_breaks_devi[x_breaks_devi<span class="sc">&gt;</span><span class="dv">0</span>])</span>
<span id="cb821-11"><a href="tables-and-graphs.html#cb821-11" tabindex="-1"></a>st_x_breaks_devi[x_breaks_devi<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;±&quot;</span>, st_x_breaks_devi[x_breaks_devi<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb821-12"><a href="tables-and-graphs.html#cb821-12" tabindex="-1"></a><span class="co"># x labels layer 1 and 2 joined</span></span>
<span id="cb821-13"><a href="tables-and-graphs.html#cb821-13" tabindex="-1"></a>x_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_x_breaks_devi[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_breaks)], <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>, x_breaks[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_breaks)])</span>
<span id="cb821-14"><a href="tables-and-graphs.html#cb821-14" tabindex="-1"></a><span class="co"># x-bounds</span></span>
<span id="cb821-15"><a href="tables-and-graphs.html#cb821-15" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb821-16"><a href="tables-and-graphs.html#cb821-16" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="dv">350</span></span>
<span id="cb821-17"><a href="tables-and-graphs.html#cb821-17" tabindex="-1"></a></span>
<span id="cb821-18"><a href="tables-and-graphs.html#cb821-18" tabindex="-1"></a><span class="co"># C. Y labels layer 1</span></span>
<span id="cb821-19"><a href="tables-and-graphs.html#cb821-19" tabindex="-1"></a>y_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">14</span>, <span class="dv">20</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb821-20"><a href="tables-and-graphs.html#cb821-20" tabindex="-1"></a><span class="co"># Y labels layer 2</span></span>
<span id="cb821-21"><a href="tables-and-graphs.html#cb821-21" tabindex="-1"></a>y_breaks_devi <span class="ot">&lt;-</span> y_breaks <span class="sc">-</span> fl_y_line_val</span>
<span id="cb821-22"><a href="tables-and-graphs.html#cb821-22" tabindex="-1"></a>st_y_breaks_devi <span class="ot">&lt;-</span> <span class="fu">paste0</span>(y_breaks_devi)</span>
<span id="cb821-23"><a href="tables-and-graphs.html#cb821-23" tabindex="-1"></a>st_y_breaks_devi[y_breaks_devi<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;+&quot;</span>, st_y_breaks_devi[y_breaks_devi<span class="sc">&gt;</span><span class="dv">0</span>])</span>
<span id="cb821-24"><a href="tables-and-graphs.html#cb821-24" tabindex="-1"></a>st_y_breaks_devi[y_breaks_devi<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;±&quot;</span>, st_y_breaks_devi[y_breaks_devi<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb821-25"><a href="tables-and-graphs.html#cb821-25" tabindex="-1"></a><span class="co"># Y labels layer 1 and 2 joined</span></span>
<span id="cb821-26"><a href="tables-and-graphs.html#cb821-26" tabindex="-1"></a>y_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(y_breaks[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_breaks)], <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>, st_y_breaks_devi[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_breaks)])</span>
<span id="cb821-27"><a href="tables-and-graphs.html#cb821-27" tabindex="-1"></a><span class="co"># y-bounds</span></span>
<span id="cb821-28"><a href="tables-and-graphs.html#cb821-28" tabindex="-1"></a>y_min <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb821-29"><a href="tables-and-graphs.html#cb821-29" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb821-30"><a href="tables-and-graphs.html#cb821-30" tabindex="-1"></a></span>
<span id="cb821-31"><a href="tables-and-graphs.html#cb821-31" tabindex="-1"></a><span class="co"># D. Add custom axis</span></span>
<span id="cb821-32"><a href="tables-and-graphs.html#cb821-32" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span> </span>
<span id="cb821-33"><a href="tables-and-graphs.html#cb821-33" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>fl_y_line_val, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb821-34"><a href="tables-and-graphs.html#cb821-34" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>fl_x_line_val, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb821-35"><a href="tables-and-graphs.html#cb821-35" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb821-36"><a href="tables-and-graphs.html#cb821-36" tabindex="-1"></a>    <span class="at">labels =</span> x_labels, <span class="at">breaks =</span> x_breaks,</span>
<span id="cb821-37"><a href="tables-and-graphs.html#cb821-37" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(x_min, x_max)</span>
<span id="cb821-38"><a href="tables-and-graphs.html#cb821-38" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb821-39"><a href="tables-and-graphs.html#cb821-39" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb821-40"><a href="tables-and-graphs.html#cb821-40" tabindex="-1"></a>    <span class="at">labels =</span> y_labels, <span class="at">breaks =</span> y_breaks,</span>
<span id="cb821-41"><a href="tables-and-graphs.html#cb821-41" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(y_min, y_max)</span>
<span id="cb821-42"><a href="tables-and-graphs.html#cb821-42" tabindex="-1"></a>  )</span>
<span id="cb821-43"><a href="tables-and-graphs.html#cb821-43" tabindex="-1"></a></span>
<span id="cb821-44"><a href="tables-and-graphs.html#cb821-44" tabindex="-1"></a><span class="co"># E. Rotate Text</span></span>
<span id="cb821-45"><a href="tables-and-graphs.html#cb821-45" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span> </span>
<span id="cb821-46"><a href="tables-and-graphs.html#cb821-46" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb821-47"><a href="tables-and-graphs.html#cb821-47" tabindex="-1"></a></span>
<span id="cb821-48"><a href="tables-and-graphs.html#cb821-48" tabindex="-1"></a><span class="co"># F. print</span></span>
<span id="cb821-49"><a href="tables-and-graphs.html#cb821-49" tabindex="-1"></a><span class="fu">print</span>(plt_mtcars_scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-427-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="three-continuous-variables-and-two-categorical-variables" class="section level4 hasAnchor" number="10.3.1.2">
<h4><span class="header-section-number">10.3.1.2</span> Three Continuous Variables and Two Categorical Variables<a href="tables-and-graphs.html#three-continuous-variables-and-two-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We will generate a graph that is very similar to the graph shown for <a href="https://fanwangecon.github.io/R4Econ/amto/tibble/htmlpdfr/fs_tib_factors.html">fs_tib_factors</a>, with the addition that scatter color and shape will be for two separate variables, and with the addition that scatter size will be for an additional continuous variable.</p>
<p>We have three continuous variables:</p>
<ol style="list-style-type: decimal">
<li>y-axis: time for 1/4 Miles (QSEC)</li>
<li>x-axis: horsepower</li>
<li>scatter-size: miles per gallon (mpg)</li>
</ol>
<p>We have two categorical ariables:</p>
<ol style="list-style-type: decimal">
<li>color: vs engine shape (vshaped or straight)</li>
<li>shape: am shift type (auto or manual)</li>
</ol>
<p>First, Load in the mtcars dataset and convert to categorical variables to factor with labels.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="tables-and-graphs.html#cb822-1" tabindex="-1"></a><span class="co"># First make sure these are factors</span></span>
<span id="cb822-2"><a href="tables-and-graphs.html#cb822-2" tabindex="-1"></a>tb_mtcars <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mtcars) <span class="sc">%&gt;%</span></span>
<span id="cb822-3"><a href="tables-and-graphs.html#cb822-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs =</span> <span class="fu">as_factor</span>(vs), <span class="at">am =</span> <span class="fu">as_factor</span>(am))</span>
<span id="cb822-4"><a href="tables-and-graphs.html#cb822-4" tabindex="-1"></a><span class="co"># Second Label the Factors</span></span>
<span id="cb822-5"><a href="tables-and-graphs.html#cb822-5" tabindex="-1"></a>am_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">auto_shift =</span> <span class="st">&quot;0&quot;</span>, <span class="at">manual_shift =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb822-6"><a href="tables-and-graphs.html#cb822-6" tabindex="-1"></a>vs_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">vshaped_engine =</span> <span class="st">&quot;0&quot;</span>, <span class="at">straight_engine =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb822-7"><a href="tables-and-graphs.html#cb822-7" tabindex="-1"></a>tb_mtcars <span class="ot">&lt;-</span> tb_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb822-8"><a href="tables-and-graphs.html#cb822-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs =</span> <span class="fu">fct_recode</span>(vs, <span class="sc">!!!</span>vs_levels),</span>
<span id="cb822-9"><a href="tables-and-graphs.html#cb822-9" tabindex="-1"></a>         <span class="at">am =</span> <span class="fu">fct_recode</span>(am, <span class="sc">!!!</span>am_levels))</span></code></pre></div>
<p>Second, generate the core graph, a scatterplot with a nonlinear trendline. Note that in the example below color and shpae only apply to the jitter scatter, but not the trendline graph.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="tables-and-graphs.html#cb823-1" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb823-2"><a href="tables-and-graphs.html#cb823-2" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span></span>
<span id="cb823-3"><a href="tables-and-graphs.html#cb823-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(tb_mtcars, <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>qsec)) <span class="sc">+</span></span>
<span id="cb823-4"><a href="tables-and-graphs.html#cb823-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">size=</span>mpg, <span class="at">colour=</span>vs, <span class="at">shape=</span>am), <span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb823-5"><a href="tables-and-graphs.html#cb823-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.50</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb823-6"><a href="tables-and-graphs.html#cb823-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>Third, control Color and Shape Information. There will be two colors and two shapes. See all <a href="https://www.google.com/search?q=r+points+shapes&amp;oq=r+point+shapes">shape listing</a>.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="tables-and-graphs.html#cb824-1" tabindex="-1"></a><span class="co"># Color controls</span></span>
<span id="cb824-2"><a href="tables-and-graphs.html#cb824-2" tabindex="-1"></a>ar_st_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#33cc33&quot;</span>, <span class="st">&quot;#F8766D&quot;</span>)</span>
<span id="cb824-3"><a href="tables-and-graphs.html#cb824-3" tabindex="-1"></a>ar_st_colors_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;v-shaped&quot;</span>, <span class="st">&quot;straight&quot;</span>)</span>
<span id="cb824-4"><a href="tables-and-graphs.html#cb824-4" tabindex="-1"></a>fl_legend_color_symbol_size <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb824-5"><a href="tables-and-graphs.html#cb824-5" tabindex="-1"></a>st_leg_color_lab <span class="ot">&lt;-</span> <span class="st">&quot;Engine-Shape&quot;</span></span>
<span id="cb824-6"><a href="tables-and-graphs.html#cb824-6" tabindex="-1"></a><span class="co"># Shape controls</span></span>
<span id="cb824-7"><a href="tables-and-graphs.html#cb824-7" tabindex="-1"></a>ar_it_shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">15</span>)</span>
<span id="cb824-8"><a href="tables-and-graphs.html#cb824-8" tabindex="-1"></a>ar_st_shapes_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;auto&quot;</span>, <span class="st">&quot;manuel&quot;</span>)</span>
<span id="cb824-9"><a href="tables-and-graphs.html#cb824-9" tabindex="-1"></a>fl_legend_shape_symbol_size <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb824-10"><a href="tables-and-graphs.html#cb824-10" tabindex="-1"></a>st_leg_shape_lab <span class="ot">&lt;-</span> <span class="st">&quot;Transmission&quot;</span></span></code></pre></div>
<p>Fourth, control the size of the scatter, which will be the MPG variable.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="tables-and-graphs.html#cb825-1" tabindex="-1"></a><span class="co"># Control scatter point size</span></span>
<span id="cb825-2"><a href="tables-and-graphs.html#cb825-2" tabindex="-1"></a>fl_min_size <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb825-3"><a href="tables-and-graphs.html#cb825-3" tabindex="-1"></a>fl_max_size <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb825-4"><a href="tables-and-graphs.html#cb825-4" tabindex="-1"></a>ar_size_range <span class="ot">&lt;-</span> <span class="fu">c</span>(fl_min_size, fl_max_size)</span>
<span id="cb825-5"><a href="tables-and-graphs.html#cb825-5" tabindex="-1"></a>st_leg_size_lab <span class="ot">&lt;-</span> <span class="st">&quot;MPG&quot;</span></span></code></pre></div>
<p>Fifth, control graph strings.</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="tables-and-graphs.html#cb826-1" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb826-2"><a href="tables-and-graphs.html#cb826-2" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Distribution of HP and QSEC from mtcars&#39;</span>)</span>
<span id="cb826-3"><a href="tables-and-graphs.html#cb826-3" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb826-4"><a href="tables-and-graphs.html#cb826-4" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/tabgraph/ggscatter/htmlpdfr/fs_ggscatter_3cts_mdisc.html&#39;</span>)</span>
<span id="cb826-5"><a href="tables-and-graphs.html#cb826-5" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;mtcars dataset, &#39;</span>,</span>
<span id="cb826-6"><a href="tables-and-graphs.html#cb826-6" tabindex="-1"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb826-7"><a href="tables-and-graphs.html#cb826-7" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;HP = Horse Power&#39;</span></span>
<span id="cb826-8"><a href="tables-and-graphs.html#cb826-8" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;QSEC = time for 1/4 Miles&#39;</span></span></code></pre></div>
<p>Sixth, combine graphical components.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="tables-and-graphs.html#cb827-1" tabindex="-1"></a><span class="co"># Add titles and labels</span></span>
<span id="cb827-2"><a href="tables-and-graphs.html#cb827-2" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb827-3"><a href="tables-and-graphs.html#cb827-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb827-4"><a href="tables-and-graphs.html#cb827-4" tabindex="-1"></a>       <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption)</span>
<span id="cb827-5"><a href="tables-and-graphs.html#cb827-5" tabindex="-1"></a><span class="co"># Color, shape and size controls</span></span>
<span id="cb827-6"><a href="tables-and-graphs.html#cb827-6" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb827-7"><a href="tables-and-graphs.html#cb827-7" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span>ar_st_colors, <span class="at">labels=</span>ar_st_colors_label) <span class="sc">+</span></span>
<span id="cb827-8"><a href="tables-and-graphs.html#cb827-8" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span>ar_it_shapes, <span class="at">labels=</span>ar_st_shapes_label) <span class="sc">+</span></span>
<span id="cb827-9"><a href="tables-and-graphs.html#cb827-9" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> ar_size_range)</span></code></pre></div>
<p>Eigth, replace default legends titles for color, shape and size.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="tables-and-graphs.html#cb828-1" tabindex="-1"></a><span class="co"># replace the default labels for each legend segment</span></span>
<span id="cb828-2"><a href="tables-and-graphs.html#cb828-2" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb828-3"><a href="tables-and-graphs.html#cb828-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> st_leg_color_lab,</span>
<span id="cb828-4"><a href="tables-and-graphs.html#cb828-4" tabindex="-1"></a>       <span class="at">shape =</span> st_leg_shape_lab,</span>
<span id="cb828-5"><a href="tables-and-graphs.html#cb828-5" tabindex="-1"></a>       <span class="at">size =</span> st_leg_size_lab)</span></code></pre></div>
<p>Ninth, additional controls for the graph.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="tables-and-graphs.html#cb829-1" tabindex="-1"></a><span class="co"># Control the order of legend display</span></span>
<span id="cb829-2"><a href="tables-and-graphs.html#cb829-2" tabindex="-1"></a><span class="co"># Show color, show shape, then show size.</span></span>
<span id="cb829-3"><a href="tables-and-graphs.html#cb829-3" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span> <span class="fu">guides</span>(</span>
<span id="cb829-4"><a href="tables-and-graphs.html#cb829-4" tabindex="-1"></a>  <span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">order =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> fl_legend_color_symbol_size)),</span>
<span id="cb829-5"><a href="tables-and-graphs.html#cb829-5" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">order =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> fl_legend_shape_symbol_size)),</span>
<span id="cb829-6"><a href="tables-and-graphs.html#cb829-6" tabindex="-1"></a>  <span class="at">size =</span> <span class="fu">guide_legend</span>(<span class="at">order =</span> <span class="dv">3</span>))</span>
<span id="cb829-7"><a href="tables-and-graphs.html#cb829-7" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb829-8"><a href="tables-and-graphs.html#cb829-8" tabindex="-1"></a><span class="fu">print</span>(plt_mtcars_scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-435-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="ggplot-multiple-scatter-lines-with-facet-wrap" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> ggplot Multiple Scatter-Lines with Facet Wrap<a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="multiple-scatter-lines-with-facet-wrap" class="section level4 hasAnchor" number="10.3.2.1">
<h4><span class="header-section-number">10.3.2.1</span> Multiple Scatter-Lines with Facet Wrap<a href="tables-and-graphs.html#multiple-scatter-lines-with-facet-wrap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Two subplots, for auto and manual transitions. The x-axis is horse-power, the y-axis shows QSEC. Different colors represent v-shaped and straight-engines.</p>
<ol style="list-style-type: decimal">
<li>y-axis: time for 1/4 Miles (QSEC)</li>
<li>x-axis: horsepower (hp)</li>
<li>facet-wrap: auto or manual (am)</li>
<li>colored line and point shapes: vshaped or straight engine (vs)</li>
</ol>
<p>First, Load in the mtcars dataset and convert to categorical variables to factor with labels.</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="tables-and-graphs.html#cb830-1" tabindex="-1"></a><span class="co"># First make sure these are factors</span></span>
<span id="cb830-2"><a href="tables-and-graphs.html#cb830-2" tabindex="-1"></a>tb_mtcars <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mtcars) <span class="sc">%&gt;%</span></span>
<span id="cb830-3"><a href="tables-and-graphs.html#cb830-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs =</span> <span class="fu">as_factor</span>(vs), <span class="at">am =</span> <span class="fu">as_factor</span>(am))</span>
<span id="cb830-4"><a href="tables-and-graphs.html#cb830-4" tabindex="-1"></a><span class="co"># Second Label the Factors</span></span>
<span id="cb830-5"><a href="tables-and-graphs.html#cb830-5" tabindex="-1"></a>am_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">auto_shift =</span> <span class="st">&quot;0&quot;</span>, <span class="at">manual_shift =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb830-6"><a href="tables-and-graphs.html#cb830-6" tabindex="-1"></a>vs_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;vshaped engine&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>, <span class="st">&quot;straight engine&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb830-7"><a href="tables-and-graphs.html#cb830-7" tabindex="-1"></a>tb_mtcars <span class="ot">&lt;-</span> tb_mtcars <span class="sc">%&gt;%</span></span>
<span id="cb830-8"><a href="tables-and-graphs.html#cb830-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vs =</span> <span class="fu">fct_recode</span>(vs, <span class="sc">!!!</span>vs_levels),</span>
<span id="cb830-9"><a href="tables-and-graphs.html#cb830-9" tabindex="-1"></a>         <span class="at">am =</span> <span class="fu">fct_recode</span>(am, <span class="sc">!!!</span>am_levels))</span></code></pre></div>
<p>Second, generate the core graph, a line plot and facet wrapping over the <em>am</em> variable. Note that <em>vs</em> variable has different color as well as line type and shape</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="tables-and-graphs.html#cb831-1" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb831-2"><a href="tables-and-graphs.html#cb831-2" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span></span>
<span id="cb831-3"><a href="tables-and-graphs.html#cb831-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(tb_mtcars, <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>qsec,</span>
<span id="cb831-4"><a href="tables-and-graphs.html#cb831-4" tabindex="-1"></a>                        <span class="at">colour=</span>am, <span class="at">shape=</span>am, <span class="at">linetype=</span>am)) <span class="sc">+</span></span>
<span id="cb831-5"><a href="tables-and-graphs.html#cb831-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="co"># Lwd = line width</span></span>
<span id="cb831-6"><a href="tables-and-graphs.html#cb831-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># stroke = point shape width</span></span>
<span id="cb831-7"><a href="tables-and-graphs.html#cb831-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> vs,</span>
<span id="cb831-8"><a href="tables-and-graphs.html#cb831-8" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>,</span>
<span id="cb831-9"><a href="tables-and-graphs.html#cb831-9" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb831-10"><a href="tables-and-graphs.html#cb831-10" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">label_wrap_gen</span>(<span class="at">multi_line=</span><span class="cn">FALSE</span>))</span></code></pre></div>
<p>Third, control Color, Shape and Line-type Information. There will be two colors, two shapes and two linetypes. See all <a href="https://www.google.com/search?q=r+points+shapes&amp;oq=r+point+shapes">shape listing</a> and <a href="https://www.google.com/search?q=r+points+shapes&amp;oq=r+point+shapes">linetype listing</a>., See all <a href="https://www.google.com/search?q=r+linetype&amp;oq=r+linetype">shape listing</a>.</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="tables-and-graphs.html#cb832-1" tabindex="-1"></a><span class="co"># Color controls</span></span>
<span id="cb832-2"><a href="tables-and-graphs.html#cb832-2" tabindex="-1"></a>ar_st_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#33cc33&quot;</span>, <span class="st">&quot;#F8766D&quot;</span>)</span>
<span id="cb832-3"><a href="tables-and-graphs.html#cb832-3" tabindex="-1"></a>ar_st_colors_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;auto&quot;</span>, <span class="st">&quot;manual&quot;</span>)</span>
<span id="cb832-4"><a href="tables-and-graphs.html#cb832-4" tabindex="-1"></a>fl_legend_color_symbol_size <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb832-5"><a href="tables-and-graphs.html#cb832-5" tabindex="-1"></a>st_leg_color_lab <span class="ot">&lt;-</span> <span class="st">&quot;Transmission&quot;</span></span>
<span id="cb832-6"><a href="tables-and-graphs.html#cb832-6" tabindex="-1"></a><span class="co"># Shape controls</span></span>
<span id="cb832-7"><a href="tables-and-graphs.html#cb832-7" tabindex="-1"></a>ar_it_shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb832-8"><a href="tables-and-graphs.html#cb832-8" tabindex="-1"></a>ar_st_shapes_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;auto&quot;</span>, <span class="st">&quot;manual&quot;</span>)</span>
<span id="cb832-9"><a href="tables-and-graphs.html#cb832-9" tabindex="-1"></a>fl_legend_shape_symbol_size <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb832-10"><a href="tables-and-graphs.html#cb832-10" tabindex="-1"></a>st_leg_shape_lab <span class="ot">&lt;-</span> <span class="st">&quot;Transmission&quot;</span></span>
<span id="cb832-11"><a href="tables-and-graphs.html#cb832-11" tabindex="-1"></a><span class="co"># Line-Type controls</span></span>
<span id="cb832-12"><a href="tables-and-graphs.html#cb832-12" tabindex="-1"></a>ar_st_linetypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dashed&#39;</span>)</span>
<span id="cb832-13"><a href="tables-and-graphs.html#cb832-13" tabindex="-1"></a>ar_st_linetypes_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;auto&quot;</span>, <span class="st">&quot;manual&quot;</span>)</span>
<span id="cb832-14"><a href="tables-and-graphs.html#cb832-14" tabindex="-1"></a>fl_legend_linetype_symbol_size <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb832-15"><a href="tables-and-graphs.html#cb832-15" tabindex="-1"></a>st_leg_linetype_lab <span class="ot">&lt;-</span> <span class="st">&quot;Transmission&quot;</span></span></code></pre></div>
<p>Fourth, manaully specify an x-axis.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="tables-and-graphs.html#cb833-1" tabindex="-1"></a><span class="co"># x labeling and axis control</span></span>
<span id="cb833-2"><a href="tables-and-graphs.html#cb833-2" tabindex="-1"></a>ar_st_x_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;50 hp&#39;</span>, <span class="st">&#39;150 hp&#39;</span>, <span class="st">&#39;250 hp&#39;</span>, <span class="st">&#39;350 hp&#39;</span>)</span>
<span id="cb833-3"><a href="tables-and-graphs.html#cb833-3" tabindex="-1"></a>ar_fl_x_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">250</span>, <span class="dv">350</span>)</span>
<span id="cb833-4"><a href="tables-and-graphs.html#cb833-4" tabindex="-1"></a>ar_fl_x_limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">360</span>)</span>
<span id="cb833-5"><a href="tables-and-graphs.html#cb833-5" tabindex="-1"></a><span class="co"># y labeling and axis control</span></span>
<span id="cb833-6"><a href="tables-and-graphs.html#cb833-6" tabindex="-1"></a>ar_st_y_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;15 QSEC&#39;</span>, <span class="st">&#39;18&#39;</span>, <span class="st">&#39;21&#39;</span>, <span class="st">&#39;24 QSEC&#39;</span>)</span>
<span id="cb833-7"><a href="tables-and-graphs.html#cb833-7" tabindex="-1"></a>ar_fl_y_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">21</span>, <span class="dv">24</span>)</span>
<span id="cb833-8"><a href="tables-and-graphs.html#cb833-8" tabindex="-1"></a>ar_fl_y_limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">13.5</span>, <span class="fl">25.5</span>)</span></code></pre></div>
<p>Fifth, control graph strings.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="tables-and-graphs.html#cb834-1" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb834-2"><a href="tables-and-graphs.html#cb834-2" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;How QSEC varies by Horse-power, by Engine and Transmission Types&#39;</span>)</span>
<span id="cb834-3"><a href="tables-and-graphs.html#cb834-3" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb834-4"><a href="tables-and-graphs.html#cb834-4" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/tabgraph/multiplot/htmlpdfr/fs_ggscatter_facet_wrap.html&#39;</span>)</span>
<span id="cb834-5"><a href="tables-and-graphs.html#cb834-5" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;mtcars dataset, &#39;</span>,</span>
<span id="cb834-6"><a href="tables-and-graphs.html#cb834-6" tabindex="-1"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb834-7"><a href="tables-and-graphs.html#cb834-7" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;HP = Horse Power&#39;</span></span>
<span id="cb834-8"><a href="tables-and-graphs.html#cb834-8" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;QSEC = time for 1/4 Miles&#39;</span></span></code></pre></div>
<p>Sixth, combine graphical components.</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="tables-and-graphs.html#cb835-1" tabindex="-1"></a><span class="co"># Add titles and labels</span></span>
<span id="cb835-2"><a href="tables-and-graphs.html#cb835-2" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb835-3"><a href="tables-and-graphs.html#cb835-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb835-4"><a href="tables-and-graphs.html#cb835-4" tabindex="-1"></a>       <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption)</span>
<span id="cb835-5"><a href="tables-and-graphs.html#cb835-5" tabindex="-1"></a></span>
<span id="cb835-6"><a href="tables-and-graphs.html#cb835-6" tabindex="-1"></a><span class="co"># x and y-axis ticks controls</span></span>
<span id="cb835-7"><a href="tables-and-graphs.html#cb835-7" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb835-8"><a href="tables-and-graphs.html#cb835-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> ar_st_x_labels,</span>
<span id="cb835-9"><a href="tables-and-graphs.html#cb835-9" tabindex="-1"></a>                     <span class="at">breaks =</span> ar_fl_x_breaks,</span>
<span id="cb835-10"><a href="tables-and-graphs.html#cb835-10" tabindex="-1"></a>                     <span class="at">limits =</span> ar_fl_x_limits) <span class="sc">+</span></span>
<span id="cb835-11"><a href="tables-and-graphs.html#cb835-11" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> ar_st_y_labels,</span>
<span id="cb835-12"><a href="tables-and-graphs.html#cb835-12" tabindex="-1"></a>                     <span class="at">breaks =</span> ar_fl_y_breaks,</span>
<span id="cb835-13"><a href="tables-and-graphs.html#cb835-13" tabindex="-1"></a>                     <span class="at">limits =</span> ar_fl_y_limits)</span>
<span id="cb835-14"><a href="tables-and-graphs.html#cb835-14" tabindex="-1"></a></span>
<span id="cb835-15"><a href="tables-and-graphs.html#cb835-15" tabindex="-1"></a><span class="co"># Color, shape and linetype controls</span></span>
<span id="cb835-16"><a href="tables-and-graphs.html#cb835-16" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb835-17"><a href="tables-and-graphs.html#cb835-17" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span>ar_st_colors, <span class="at">labels=</span>ar_st_colors_label) <span class="sc">+</span></span>
<span id="cb835-18"><a href="tables-and-graphs.html#cb835-18" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span>ar_it_shapes, <span class="at">labels=</span>ar_st_shapes_label) <span class="sc">+</span></span>
<span id="cb835-19"><a href="tables-and-graphs.html#cb835-19" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span>ar_st_linetypes, <span class="at">labels=</span>ar_st_linetypes_label)</span></code></pre></div>
<p>Seventh, replace default legends, and set figure font overall etc.</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="tables-and-graphs.html#cb836-1" tabindex="-1"></a><span class="co"># has legend theme</span></span>
<span id="cb836-2"><a href="tables-and-graphs.html#cb836-2" tabindex="-1"></a>theme_custom <span class="ot">&lt;-</span> <span class="fu">theme</span>(</span>
<span id="cb836-3"><a href="tables-and-graphs.html#cb836-3" tabindex="-1"></a>  <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb836-4"><a href="tables-and-graphs.html#cb836-4" tabindex="-1"></a>  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb836-5"><a href="tables-and-graphs.html#cb836-5" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb836-6"><a href="tables-and-graphs.html#cb836-6" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.80</span>),</span>
<span id="cb836-7"><a href="tables-and-graphs.html#cb836-7" tabindex="-1"></a>  <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">&quot;line&quot;</span>),</span>
<span id="cb836-8"><a href="tables-and-graphs.html#cb836-8" tabindex="-1"></a>  <span class="at">legend.background =</span></span>
<span id="cb836-9"><a href="tables-and-graphs.html#cb836-9" tabindex="-1"></a>    <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;solid&#39;</span>))</span>
<span id="cb836-10"><a href="tables-and-graphs.html#cb836-10" tabindex="-1"></a><span class="co"># no legend theme (no y)</span></span>
<span id="cb836-11"><a href="tables-and-graphs.html#cb836-11" tabindex="-1"></a>theme_custom_blank <span class="ot">&lt;-</span> <span class="fu">theme</span>(</span>
<span id="cb836-12"><a href="tables-and-graphs.html#cb836-12" tabindex="-1"></a>  <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb836-13"><a href="tables-and-graphs.html#cb836-13" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb836-14"><a href="tables-and-graphs.html#cb836-14" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb836-15"><a href="tables-and-graphs.html#cb836-15" tabindex="-1"></a>  <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb836-16"><a href="tables-and-graphs.html#cb836-16" tabindex="-1"></a>  <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb836-17"><a href="tables-and-graphs.html#cb836-17" tabindex="-1"></a>  <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>())</span></code></pre></div>
<p>Eighth, graph out.</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="tables-and-graphs.html#cb837-1" tabindex="-1"></a><span class="co"># replace the default labels for each legend segment</span></span>
<span id="cb837-2"><a href="tables-and-graphs.html#cb837-2" tabindex="-1"></a>plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span> theme_custom</span>
<span id="cb837-3"><a href="tables-and-graphs.html#cb837-3" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb837-4"><a href="tables-and-graphs.html#cb837-4" tabindex="-1"></a><span class="fu">print</span>(plt_mtcars_scatter)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-444-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="divide-facet-wrapped-plot-into-subplots" class="section level4 hasAnchor" number="10.3.2.2">
<h4><span class="header-section-number">10.3.2.2</span> Divide Facet Wrapped Plot into Subplots<a href="tables-and-graphs.html#divide-facet-wrapped-plot-into-subplots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given the facet-wrapped plot just generated, now save alternative plot versions, where each subplot is saved by itself. Will simply use the code from above, but call inside lapply over different am categories.</p>
<p>Below generate a matrix with multiple data columns, then use apply over each row of the matrix and select different columns of values for each subplot generation.</p>
<p>First generate with legend versions, then without legend versions. These are versions that would be used to more freely compose graph together.</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="tables-and-graphs.html#cb838-1" tabindex="-1"></a><span class="cf">for</span> (it_subplot_as_own_vsr <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) {</span>
<span id="cb838-2"><a href="tables-and-graphs.html#cb838-2" tabindex="-1"></a></span>
<span id="cb838-3"><a href="tables-and-graphs.html#cb838-3" tabindex="-1"></a>  <span class="cf">if</span> (it_subplot_as_own_vsr <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb838-4"><a href="tables-and-graphs.html#cb838-4" tabindex="-1"></a>    theme_custom_use <span class="ot">&lt;-</span> theme_custom</span>
<span id="cb838-5"><a href="tables-and-graphs.html#cb838-5" tabindex="-1"></a>    <span class="co"># st_file_suffix &lt;- &#39;_haslegend&#39;</span></span>
<span id="cb838-6"><a href="tables-and-graphs.html#cb838-6" tabindex="-1"></a>    <span class="co"># it_width &lt;- 100</span></span>
<span id="cb838-7"><a href="tables-and-graphs.html#cb838-7" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (it_subplot_as_own_vsr <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb838-8"><a href="tables-and-graphs.html#cb838-8" tabindex="-1"></a>    theme_custom_use <span class="ot">&lt;-</span> theme_custom_blank</span>
<span id="cb838-9"><a href="tables-and-graphs.html#cb838-9" tabindex="-1"></a>    <span class="co"># st_file_suffix &lt;- &#39;_nolegend&#39;</span></span>
<span id="cb838-10"><a href="tables-and-graphs.html#cb838-10" tabindex="-1"></a>    <span class="co"># it_width &lt;- 88</span></span>
<span id="cb838-11"><a href="tables-and-graphs.html#cb838-11" tabindex="-1"></a>  }</span>
<span id="cb838-12"><a href="tables-and-graphs.html#cb838-12" tabindex="-1"></a></span>
<span id="cb838-13"><a href="tables-and-graphs.html#cb838-13" tabindex="-1"></a>  <span class="co"># unique vs as matrix</span></span>
<span id="cb838-14"><a href="tables-and-graphs.html#cb838-14" tabindex="-1"></a>  <span class="co"># ar_uniques &lt;-sort(unique(tb_mtcars$vs))</span></span>
<span id="cb838-15"><a href="tables-and-graphs.html#cb838-15" tabindex="-1"></a>  <span class="co"># mt_unique_vs &lt;- matrix(data=ar_uniques, nrow=length(ar_uniques), ncol=1)</span></span>
<span id="cb838-16"><a href="tables-and-graphs.html#cb838-16" tabindex="-1"></a>  mt_unique_vs <span class="ot">&lt;-</span> tb_mtcars <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(vs) <span class="sc">%&gt;%</span></span>
<span id="cb838-17"><a href="tables-and-graphs.html#cb838-17" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mpg=</span><span class="fu">mean</span>(mpg)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb838-18"><a href="tables-and-graphs.html#cb838-18" tabindex="-1"></a>  <span class="co"># apply over</span></span>
<span id="cb838-19"><a href="tables-and-graphs.html#cb838-19" tabindex="-1"></a>  ls_plots <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_unique_vs, <span class="dv">1</span>, <span class="cf">function</span>(ar_vs_cate_row) {</span>
<span id="cb838-20"><a href="tables-and-graphs.html#cb838-20" tabindex="-1"></a>    <span class="co"># 1. Graph main</span></span>
<span id="cb838-21"><a href="tables-and-graphs.html#cb838-21" tabindex="-1"></a>    plt_mtcars_scatter <span class="ot">&lt;-</span></span>
<span id="cb838-22"><a href="tables-and-graphs.html#cb838-22" tabindex="-1"></a>      <span class="fu">ggplot</span>(tb_mtcars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(vs <span class="sc">==</span> ar_vs_cate_row[<span class="dv">1</span>]),</span>
<span id="cb838-23"><a href="tables-and-graphs.html#cb838-23" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>qsec,</span>
<span id="cb838-24"><a href="tables-and-graphs.html#cb838-24" tabindex="-1"></a>                 <span class="at">colour=</span>am, <span class="at">shape=</span>am, <span class="at">linetype=</span>am)) <span class="sc">+</span></span>
<span id="cb838-25"><a href="tables-and-graphs.html#cb838-25" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="co"># Lwd = line width</span></span>
<span id="cb838-26"><a href="tables-and-graphs.html#cb838-26" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>)</span>
<span id="cb838-27"><a href="tables-and-graphs.html#cb838-27" tabindex="-1"></a></span>
<span id="cb838-28"><a href="tables-and-graphs.html#cb838-28" tabindex="-1"></a>    <span class="co"># 2. Add titles and labels</span></span>
<span id="cb838-29"><a href="tables-and-graphs.html#cb838-29" tabindex="-1"></a>    plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb838-30"><a href="tables-and-graphs.html#cb838-30" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb838-31"><a href="tables-and-graphs.html#cb838-31" tabindex="-1"></a>           <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption)</span>
<span id="cb838-32"><a href="tables-and-graphs.html#cb838-32" tabindex="-1"></a></span>
<span id="cb838-33"><a href="tables-and-graphs.html#cb838-33" tabindex="-1"></a>    <span class="co"># 3. x and y ticks</span></span>
<span id="cb838-34"><a href="tables-and-graphs.html#cb838-34" tabindex="-1"></a>    plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb838-35"><a href="tables-and-graphs.html#cb838-35" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> ar_st_x_labels, <span class="at">breaks =</span> ar_fl_x_breaks, <span class="at">limits =</span> ar_fl_x_limits) <span class="sc">+</span></span>
<span id="cb838-36"><a href="tables-and-graphs.html#cb838-36" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> ar_st_y_labels, <span class="at">breaks =</span> ar_fl_y_breaks, <span class="at">limits =</span> ar_fl_y_limits)</span>
<span id="cb838-37"><a href="tables-and-graphs.html#cb838-37" tabindex="-1"></a></span>
<span id="cb838-38"><a href="tables-and-graphs.html#cb838-38" tabindex="-1"></a>    <span class="co"># 4. Color, shape and linetype controls</span></span>
<span id="cb838-39"><a href="tables-and-graphs.html#cb838-39" tabindex="-1"></a>    plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span></span>
<span id="cb838-40"><a href="tables-and-graphs.html#cb838-40" tabindex="-1"></a>      <span class="fu">scale_colour_manual</span>(<span class="at">values=</span>ar_st_colors, <span class="at">labels=</span>ar_st_colors_label) <span class="sc">+</span></span>
<span id="cb838-41"><a href="tables-and-graphs.html#cb838-41" tabindex="-1"></a>      <span class="fu">scale_shape_manual</span>(<span class="at">values=</span>ar_it_shapes, <span class="at">labels=</span>ar_st_shapes_label) <span class="sc">+</span></span>
<span id="cb838-42"><a href="tables-and-graphs.html#cb838-42" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span>ar_st_linetypes, <span class="at">labels=</span>ar_st_linetypes_label)</span>
<span id="cb838-43"><a href="tables-and-graphs.html#cb838-43" tabindex="-1"></a></span>
<span id="cb838-44"><a href="tables-and-graphs.html#cb838-44" tabindex="-1"></a>    <span class="co"># 5. replace the default labels for each legend segment</span></span>
<span id="cb838-45"><a href="tables-and-graphs.html#cb838-45" tabindex="-1"></a>    plt_mtcars_scatter <span class="ot">&lt;-</span> plt_mtcars_scatter <span class="sc">+</span> theme_custom_use</span>
<span id="cb838-46"><a href="tables-and-graphs.html#cb838-46" tabindex="-1"></a>  })</span>
<span id="cb838-47"><a href="tables-and-graphs.html#cb838-47" tabindex="-1"></a>  <span class="co"># show</span></span>
<span id="cb838-48"><a href="tables-and-graphs.html#cb838-48" tabindex="-1"></a>  <span class="fu">print</span>(ls_plots)</span>
<span id="cb838-49"><a href="tables-and-graphs.html#cb838-49" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-445-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-445-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[1]]</code></pre>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-445-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-445-4.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="write-and-read-plots" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Write and Read Plots<a href="tables-and-graphs.html#write-and-read-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="import-and-export-images" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Import and Export Images<a href="tables-and-graphs.html#import-and-export-images" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>Work with the R plot function.</p>
<div id="export-images-different-formats-with-plot" class="section level4 hasAnchor" number="10.4.1.1">
<h4><span class="header-section-number">10.4.1.1</span> Export Images Different Formats with Plot()<a href="tables-and-graphs.html#export-images-different-formats-with-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="generate-and-record-a-plot" class="section level5 hasAnchor" number="10.4.1.1.1">
<h5><span class="header-section-number">10.4.1.1.1</span> Generate and Record A Plot<a href="tables-and-graphs.html#generate-and-record-a-plot" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Generate a graph and recordPlot() it. The generated graph does not have legends Yet. Crucially, there are no titles, legends, axis, labels in the figures. As we stack the figures together, do not add those. Only add at the end jointly for all figure elements together to control at one spot things.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="tables-and-graphs.html#cb843-1" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-2"><a href="tables-and-graphs.html#cb843-2" tabindex="-1"></a><span class="co"># First, Strings</span></span>
<span id="cb843-3"><a href="tables-and-graphs.html#cb843-3" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-4"><a href="tables-and-graphs.html#cb843-4" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb843-5"><a href="tables-and-graphs.html#cb843-5" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Scatter, Line and Curve Joint Ploting Example Using Base R</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb843-6"><a href="tables-and-graphs.html#cb843-6" tabindex="-1"></a>                   <span class="st">&#39;plot() + curve():sin(x)*cos(x), sin(x)+tan(x)+cos(x)&#39;</span>)</span>
<span id="cb843-7"><a href="tables-and-graphs.html#cb843-7" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb843-8"><a href="tables-and-graphs.html#cb843-8" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/tabgraph/inout/htmlpdfr/fs_base_curve.html&#39;</span>)</span>
<span id="cb843-9"><a href="tables-and-graphs.html#cb843-9" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;x&#39;</span></span>
<span id="cb843-10"><a href="tables-and-graphs.html#cb843-10" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;f(x)&#39;</span></span>
<span id="cb843-11"><a href="tables-and-graphs.html#cb843-11" tabindex="-1"></a></span>
<span id="cb843-12"><a href="tables-and-graphs.html#cb843-12" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-13"><a href="tables-and-graphs.html#cb843-13" tabindex="-1"></a><span class="co"># Second, functions</span></span>
<span id="cb843-14"><a href="tables-and-graphs.html#cb843-14" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-15"><a href="tables-and-graphs.html#cb843-15" tabindex="-1"></a>fc_sin_cos_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sin</span>(x)<span class="sc">*</span><span class="fu">cos</span>(x)</span>
<span id="cb843-16"><a href="tables-and-graphs.html#cb843-16" tabindex="-1"></a>st_line_3_y_legend <span class="ot">&lt;-</span> <span class="st">&#39;sin(x)*cos(x)&#39;</span></span>
<span id="cb843-17"><a href="tables-and-graphs.html#cb843-17" tabindex="-1"></a>fc_sin_cos_tan <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sin</span>(x) <span class="sc">+</span> <span class="fu">cos</span>(x) <span class="sc">+</span> <span class="fu">tan</span>(x)</span>
<span id="cb843-18"><a href="tables-and-graphs.html#cb843-18" tabindex="-1"></a>st_line_4_y_legend <span class="ot">&lt;-</span> <span class="st">&#39;sin(x) + tan(x) + cos(x)&#39;</span></span>
<span id="cb843-19"><a href="tables-and-graphs.html#cb843-19" tabindex="-1"></a></span>
<span id="cb843-20"><a href="tables-and-graphs.html#cb843-20" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-21"><a href="tables-and-graphs.html#cb843-21" tabindex="-1"></a><span class="co"># Third, patterns</span></span>
<span id="cb843-22"><a href="tables-and-graphs.html#cb843-22" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-23"><a href="tables-and-graphs.html#cb843-23" tabindex="-1"></a>st_line_3_black <span class="ot">&lt;-</span> <span class="st">&#39;black&#39;</span></span>
<span id="cb843-24"><a href="tables-and-graphs.html#cb843-24" tabindex="-1"></a>st_line_4_purple <span class="ot">&lt;-</span> <span class="st">&#39;orange&#39;</span></span>
<span id="cb843-25"><a href="tables-and-graphs.html#cb843-25" tabindex="-1"></a><span class="co"># line type</span></span>
<span id="cb843-26"><a href="tables-and-graphs.html#cb843-26" tabindex="-1"></a>st_line_3_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotted&#39;</span></span>
<span id="cb843-27"><a href="tables-and-graphs.html#cb843-27" tabindex="-1"></a>st_line_4_lty <span class="ot">&lt;-</span> <span class="st">&#39;dotdash&#39;</span></span>
<span id="cb843-28"><a href="tables-and-graphs.html#cb843-28" tabindex="-1"></a><span class="co"># line width</span></span>
<span id="cb843-29"><a href="tables-and-graphs.html#cb843-29" tabindex="-1"></a>st_line_3_lwd <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb843-30"><a href="tables-and-graphs.html#cb843-30" tabindex="-1"></a>st_line_4_lwd <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb843-31"><a href="tables-and-graphs.html#cb843-31" tabindex="-1"></a></span>
<span id="cb843-32"><a href="tables-and-graphs.html#cb843-32" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-33"><a href="tables-and-graphs.html#cb843-33" tabindex="-1"></a><span class="co"># Fourth: Share xlim and ylim</span></span>
<span id="cb843-34"><a href="tables-and-graphs.html#cb843-34" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-35"><a href="tables-and-graphs.html#cb843-35" tabindex="-1"></a>ar_xlim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb843-36"><a href="tables-and-graphs.html#cb843-36" tabindex="-1"></a>ar_ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>)</span>
<span id="cb843-37"><a href="tables-and-graphs.html#cb843-37" tabindex="-1"></a></span>
<span id="cb843-38"><a href="tables-and-graphs.html#cb843-38" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-39"><a href="tables-and-graphs.html#cb843-39" tabindex="-1"></a><span class="co"># Fifth: Even margins</span></span>
<span id="cb843-40"><a href="tables-and-graphs.html#cb843-40" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-41"><a href="tables-and-graphs.html#cb843-41" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span>
<span id="cb843-42"><a href="tables-and-graphs.html#cb843-42" tabindex="-1"></a></span>
<span id="cb843-43"><a href="tables-and-graphs.html#cb843-43" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-44"><a href="tables-and-graphs.html#cb843-44" tabindex="-1"></a><span class="co"># Sixth, the four objects and do not print yet:</span></span>
<span id="cb843-45"><a href="tables-and-graphs.html#cb843-45" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb843-46"><a href="tables-and-graphs.html#cb843-46" tabindex="-1"></a><span class="co"># Graph Curve 3</span></span>
<span id="cb843-47"><a href="tables-and-graphs.html#cb843-47" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb843-48"><a href="tables-and-graphs.html#cb843-48" tabindex="-1"></a><span class="fu">curve</span>(fc_sin_cos_diff,</span>
<span id="cb843-49"><a href="tables-and-graphs.html#cb843-49" tabindex="-1"></a>      <span class="at">col =</span> st_line_3_black,</span>
<span id="cb843-50"><a href="tables-and-graphs.html#cb843-50" tabindex="-1"></a>      <span class="at">lwd =</span> st_line_3_lwd, <span class="at">lty =</span> st_line_3_lty,</span>
<span id="cb843-51"><a href="tables-and-graphs.html#cb843-51" tabindex="-1"></a>      <span class="at">from =</span> ar_xlim[<span class="dv">1</span>], <span class="at">to =</span> ar_xlim[<span class="dv">2</span>], <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb843-52"><a href="tables-and-graphs.html#cb843-52" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span>
<span id="cb843-53"><a href="tables-and-graphs.html#cb843-53" tabindex="-1"></a><span class="co"># Graph Curve 4</span></span>
<span id="cb843-54"><a href="tables-and-graphs.html#cb843-54" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb843-55"><a href="tables-and-graphs.html#cb843-55" tabindex="-1"></a><span class="fu">curve</span>(fc_sin_cos_tan,</span>
<span id="cb843-56"><a href="tables-and-graphs.html#cb843-56" tabindex="-1"></a>      <span class="at">col =</span> st_line_4_purple,</span>
<span id="cb843-57"><a href="tables-and-graphs.html#cb843-57" tabindex="-1"></a>      <span class="at">lwd =</span> st_line_4_lwd, <span class="at">lty =</span> st_line_4_lty,</span>
<span id="cb843-58"><a href="tables-and-graphs.html#cb843-58" tabindex="-1"></a>      <span class="at">from =</span> ar_xlim[<span class="dv">1</span>], <span class="at">to =</span> ar_xlim[<span class="dv">2</span>], <span class="at">ylim =</span> ar_ylim,</span>
<span id="cb843-59"><a href="tables-and-graphs.html#cb843-59" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">ann=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="tables-and-graphs.html#cb844-1" tabindex="-1"></a>pl_curves_save <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code></pre></div>
</div>
<div id="generate-large-font-and-small-font-versions-of-plot" class="section level5 hasAnchor" number="10.4.1.1.2">
<h5><span class="header-section-number">10.4.1.1.2</span> Generate Large Font and Small Font Versions of PLot<a href="tables-and-graphs.html#generate-large-font-and-small-font-versions-of-plot" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Generate larger font version:</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="tables-and-graphs.html#cb845-1" tabindex="-1"></a><span class="co"># Replay</span></span>
<span id="cb845-2"><a href="tables-and-graphs.html#cb845-2" tabindex="-1"></a>pl_curves_save</span>
<span id="cb845-3"><a href="tables-and-graphs.html#cb845-3" tabindex="-1"></a></span>
<span id="cb845-4"><a href="tables-and-graphs.html#cb845-4" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb845-5"><a href="tables-and-graphs.html#cb845-5" tabindex="-1"></a><span class="co"># Seventh, Set Title and Legend and Plot Jointly</span></span>
<span id="cb845-6"><a href="tables-and-graphs.html#cb845-6" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb845-7"><a href="tables-and-graphs.html#cb845-7" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb845-8"><a href="tables-and-graphs.html#cb845-8" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">=</span> <span class="fl">0.75</span></span>
<span id="cb845-9"><a href="tables-and-graphs.html#cb845-9" tabindex="-1"></a>fl_ces_fig_leg <span class="ot">=</span> <span class="fl">0.75</span></span>
<span id="cb845-10"><a href="tables-and-graphs.html#cb845-10" tabindex="-1"></a>fl_ces_fig_small <span class="ot">=</span> <span class="fl">0.65</span></span>
<span id="cb845-11"><a href="tables-and-graphs.html#cb845-11" tabindex="-1"></a></span>
<span id="cb845-12"><a href="tables-and-graphs.html#cb845-12" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb845-13"><a href="tables-and-graphs.html#cb845-13" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb845-14"><a href="tables-and-graphs.html#cb845-14" tabindex="-1"></a>      <span class="at">cex.lab=</span>fl_ces_fig_reg,</span>
<span id="cb845-15"><a href="tables-and-graphs.html#cb845-15" tabindex="-1"></a>      <span class="at">cex.main=</span>fl_ces_fig_reg,</span>
<span id="cb845-16"><a href="tables-and-graphs.html#cb845-16" tabindex="-1"></a>      <span class="at">cex.sub=</span>fl_ces_fig_small)</span>
<span id="cb845-17"><a href="tables-and-graphs.html#cb845-17" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb845-18"><a href="tables-and-graphs.html#cb845-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb845-19"><a href="tables-and-graphs.html#cb845-19" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb845-20"><a href="tables-and-graphs.html#cb845-20" tabindex="-1"></a></span>
<span id="cb845-21"><a href="tables-and-graphs.html#cb845-21" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb845-22"><a href="tables-and-graphs.html#cb845-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb845-23"><a href="tables-and-graphs.html#cb845-23" tabindex="-1"></a>       <span class="at">bg=</span><span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb845-24"><a href="tables-and-graphs.html#cb845-24" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb845-25"><a href="tables-and-graphs.html#cb845-25" tabindex="-1"></a>       <span class="fu">c</span>(st_line_3_y_legend, st_line_4_y_legend),</span>
<span id="cb845-26"><a href="tables-and-graphs.html#cb845-26" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(st_line_3_black, st_line_4_purple),</span>
<span id="cb845-27"><a href="tables-and-graphs.html#cb845-27" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb845-28"><a href="tables-and-graphs.html#cb845-28" tabindex="-1"></a>       <span class="at">cex =</span> fl_ces_fig_leg,</span>
<span id="cb845-29"><a href="tables-and-graphs.html#cb845-29" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(st_line_3_lty, st_line_4_lty),</span>
<span id="cb845-30"><a href="tables-and-graphs.html#cb845-30" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(st_line_3_lwd,st_line_4_lwd),</span>
<span id="cb845-31"><a href="tables-and-graphs.html#cb845-31" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="tables-and-graphs.html#cb846-1" tabindex="-1"></a><span class="co"># record final plot</span></span>
<span id="cb846-2"><a href="tables-and-graphs.html#cb846-2" tabindex="-1"></a>pl_curves_large <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb846-3"><a href="tables-and-graphs.html#cb846-3" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>Generate smaller font version:</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="tables-and-graphs.html#cb847-1" tabindex="-1"></a><span class="co"># Replay</span></span>
<span id="cb847-2"><a href="tables-and-graphs.html#cb847-2" tabindex="-1"></a>pl_curves_save</span>
<span id="cb847-3"><a href="tables-and-graphs.html#cb847-3" tabindex="-1"></a></span>
<span id="cb847-4"><a href="tables-and-graphs.html#cb847-4" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb847-5"><a href="tables-and-graphs.html#cb847-5" tabindex="-1"></a><span class="co"># Seventh, Set Title and Legend and Plot Jointly</span></span>
<span id="cb847-6"><a href="tables-and-graphs.html#cb847-6" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb847-7"><a href="tables-and-graphs.html#cb847-7" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb847-8"><a href="tables-and-graphs.html#cb847-8" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">=</span> <span class="fl">0.45</span></span>
<span id="cb847-9"><a href="tables-and-graphs.html#cb847-9" tabindex="-1"></a>fl_ces_fig_leg <span class="ot">=</span> <span class="fl">0.45</span></span>
<span id="cb847-10"><a href="tables-and-graphs.html#cb847-10" tabindex="-1"></a>fl_ces_fig_small <span class="ot">=</span> <span class="fl">0.25</span></span>
<span id="cb847-11"><a href="tables-and-graphs.html#cb847-11" tabindex="-1"></a></span>
<span id="cb847-12"><a href="tables-and-graphs.html#cb847-12" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb847-13"><a href="tables-and-graphs.html#cb847-13" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb847-14"><a href="tables-and-graphs.html#cb847-14" tabindex="-1"></a>      <span class="at">cex.lab=</span>fl_ces_fig_reg,</span>
<span id="cb847-15"><a href="tables-and-graphs.html#cb847-15" tabindex="-1"></a>      <span class="at">cex.main=</span>fl_ces_fig_reg,</span>
<span id="cb847-16"><a href="tables-and-graphs.html#cb847-16" tabindex="-1"></a>      <span class="at">cex.sub=</span>fl_ces_fig_small)</span>
<span id="cb847-17"><a href="tables-and-graphs.html#cb847-17" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb847-18"><a href="tables-and-graphs.html#cb847-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis=</span>fl_ces_fig_reg)</span>
<span id="cb847-19"><a href="tables-and-graphs.html#cb847-19" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb847-20"><a href="tables-and-graphs.html#cb847-20" tabindex="-1"></a></span>
<span id="cb847-21"><a href="tables-and-graphs.html#cb847-21" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb847-22"><a href="tables-and-graphs.html#cb847-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb847-23"><a href="tables-and-graphs.html#cb847-23" tabindex="-1"></a>       <span class="at">bg=</span><span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb847-24"><a href="tables-and-graphs.html#cb847-24" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb847-25"><a href="tables-and-graphs.html#cb847-25" tabindex="-1"></a>       <span class="fu">c</span>(st_line_3_y_legend, st_line_4_y_legend),</span>
<span id="cb847-26"><a href="tables-and-graphs.html#cb847-26" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(st_line_3_black, st_line_4_purple),</span>
<span id="cb847-27"><a href="tables-and-graphs.html#cb847-27" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb847-28"><a href="tables-and-graphs.html#cb847-28" tabindex="-1"></a>       <span class="at">cex =</span> fl_ces_fig_leg,</span>
<span id="cb847-29"><a href="tables-and-graphs.html#cb847-29" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(st_line_3_lty, st_line_4_lty),</span>
<span id="cb847-30"><a href="tables-and-graphs.html#cb847-30" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(st_line_3_lwd,st_line_4_lwd),</span>
<span id="cb847-31"><a href="tables-and-graphs.html#cb847-31" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="tables-and-graphs.html#cb848-1" tabindex="-1"></a><span class="co"># record final plot</span></span>
<span id="cb848-2"><a href="tables-and-graphs.html#cb848-2" tabindex="-1"></a>pl_curves_small <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb848-3"><a href="tables-and-graphs.html#cb848-3" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="save-plot-with-varying-resolutions-and-heights" class="section level5 hasAnchor" number="10.4.1.1.3">
<h5><span class="header-section-number">10.4.1.1.3</span> Save Plot with Varying Resolutions and Heights<a href="tables-and-graphs.html#save-plot-with-varying-resolutions-and-heights" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Export recorded plot.</p>
<p>A4 paper is 8.3 x 11.7, with 1 inch margins, the remaining area is 6.3 x 9.7. For figures that should take half of the page, the height should be 4.8 inch. One third of a page should be 3.2 inch. 6.3 inch is 160mm and 3 inch is 76 mm. In the example below, use</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="tables-and-graphs.html#cb849-1" tabindex="-1"></a><span class="co"># Store both in within folder directory and root image directory:</span></span>
<span id="cb849-2"><a href="tables-and-graphs.html#cb849-2" tabindex="-1"></a><span class="co"># C:\Users\fan\R4Econ\tabgraph\inout\_img</span></span>
<span id="cb849-3"><a href="tables-and-graphs.html#cb849-3" tabindex="-1"></a><span class="co"># C:\Users\fan\R4Econ\_img</span></span>
<span id="cb849-4"><a href="tables-and-graphs.html#cb849-4" tabindex="-1"></a><span class="co"># need to store in both because bookdown and indi pdf path differ.</span></span>
<span id="cb849-5"><a href="tables-and-graphs.html#cb849-5" tabindex="-1"></a><span class="co"># Wrap in try because will not work underbookdown, but images already created</span></span>
<span id="cb849-6"><a href="tables-and-graphs.html#cb849-6" tabindex="-1"></a></span>
<span id="cb849-7"><a href="tables-and-graphs.html#cb849-7" tabindex="-1"></a>ls_spt_root <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;..//..//&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb849-8"><a href="tables-and-graphs.html#cb849-8" tabindex="-1"></a>spt_prefix <span class="ot">&lt;-</span> <span class="st">&#39;_img/fs_img_io_2curve&#39;</span></span>
<span id="cb849-9"><a href="tables-and-graphs.html#cb849-9" tabindex="-1"></a></span>
<span id="cb849-10"><a href="tables-and-graphs.html#cb849-10" tabindex="-1"></a><span class="cf">for</span> (spt_root <span class="cf">in</span> ls_spt_root) {</span>
<span id="cb849-11"><a href="tables-and-graphs.html#cb849-11" tabindex="-1"></a>  <span class="co"># Changing pointsize will not change font sizes inside, just rescale</span></span>
<span id="cb849-12"><a href="tables-and-graphs.html#cb849-12" tabindex="-1"></a>  <span class="co"># PNG 72</span></span>
<span id="cb849-13"><a href="tables-and-graphs.html#cb849-13" tabindex="-1"></a>  <span class="fu">try</span>(<span class="fu">png</span>(<span class="fu">paste0</span>(spt_root, spt_prefix, <span class="st">&quot;_w135h76_res72.png&quot;</span>),</span>
<span id="cb849-14"><a href="tables-and-graphs.html#cb849-14" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">135</span> , <span class="at">height =</span> <span class="dv">76</span>, <span class="at">units=</span><span class="st">&#39;mm&#39;</span>, <span class="at">res =</span> <span class="dv">72</span>, <span class="at">pointsize=</span><span class="dv">7</span>))</span>
<span id="cb849-15"><a href="tables-and-graphs.html#cb849-15" tabindex="-1"></a>  <span class="fu">print</span>(pl_curves_large)</span>
<span id="cb849-16"><a href="tables-and-graphs.html#cb849-16" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb849-17"><a href="tables-and-graphs.html#cb849-17" tabindex="-1"></a>  <span class="co"># PNG 300</span></span>
<span id="cb849-18"><a href="tables-and-graphs.html#cb849-18" tabindex="-1"></a>  <span class="fu">try</span>(<span class="fu">png</span>(<span class="fu">paste0</span>(spt_root, spt_prefix, <span class="st">&quot;_w135h76_res300.png&quot;</span>),</span>
<span id="cb849-19"><a href="tables-and-graphs.html#cb849-19" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">135</span>, <span class="at">height =</span> <span class="dv">76</span>, <span class="at">units=</span><span class="st">&#39;mm&#39;</span>, <span class="at">res =</span> <span class="dv">300</span>, <span class="at">pointsize=</span><span class="dv">7</span>))</span>
<span id="cb849-20"><a href="tables-and-graphs.html#cb849-20" tabindex="-1"></a>  <span class="fu">print</span>(pl_curves_large)</span>
<span id="cb849-21"><a href="tables-and-graphs.html#cb849-21" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb849-22"><a href="tables-and-graphs.html#cb849-22" tabindex="-1"></a>  <span class="co"># PNG 300, SMALL, POINT SIZE LOWER</span></span>
<span id="cb849-23"><a href="tables-and-graphs.html#cb849-23" tabindex="-1"></a>  <span class="fu">try</span>(<span class="fu">png</span>(<span class="fu">paste0</span>(spt_root, spt_prefix, <span class="st">&quot;_w80h48_res300.png&quot;</span>),</span>
<span id="cb849-24"><a href="tables-and-graphs.html#cb849-24" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">80</span>, <span class="at">height =</span> <span class="dv">48</span>, <span class="at">units=</span><span class="st">&#39;mm&#39;</span>, <span class="at">res =</span> <span class="dv">300</span>, <span class="at">pointsize=</span><span class="dv">7</span>))</span>
<span id="cb849-25"><a href="tables-and-graphs.html#cb849-25" tabindex="-1"></a>  <span class="fu">print</span>(pl_curves_small)</span>
<span id="cb849-26"><a href="tables-and-graphs.html#cb849-26" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb849-27"><a href="tables-and-graphs.html#cb849-27" tabindex="-1"></a>  <span class="co"># PNG 300</span></span>
<span id="cb849-28"><a href="tables-and-graphs.html#cb849-28" tabindex="-1"></a>  <span class="fu">try</span>(<span class="fu">png</span>(<span class="fu">paste0</span>(spt_root, spt_prefix, <span class="st">&quot;_w160h100_res300.png&quot;</span>),</span>
<span id="cb849-29"><a href="tables-and-graphs.html#cb849-29" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">160</span>, <span class="at">height =</span> <span class="dv">100</span>, <span class="at">units=</span><span class="st">&#39;mm&#39;</span>, <span class="at">res =</span> <span class="dv">300</span>))</span>
<span id="cb849-30"><a href="tables-and-graphs.html#cb849-30" tabindex="-1"></a>  <span class="fu">print</span>(pl_curves_large)</span>
<span id="cb849-31"><a href="tables-and-graphs.html#cb849-31" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb849-32"><a href="tables-and-graphs.html#cb849-32" tabindex="-1"></a></span>
<span id="cb849-33"><a href="tables-and-graphs.html#cb849-33" tabindex="-1"></a>  <span class="co"># EPS</span></span>
<span id="cb849-34"><a href="tables-and-graphs.html#cb849-34" tabindex="-1"></a>  <span class="fu">setEPS</span>()</span>
<span id="cb849-35"><a href="tables-and-graphs.html#cb849-35" tabindex="-1"></a>  <span class="fu">try</span>(<span class="fu">postscript</span>(<span class="fu">paste0</span>(spt_root, spt_prefix, <span class="st">&quot;_fs_2curve.eps&quot;</span>)))</span>
<span id="cb849-36"><a href="tables-and-graphs.html#cb849-36" tabindex="-1"></a>  <span class="fu">print</span>(pl_curves_large)</span>
<span id="cb849-37"><a href="tables-and-graphs.html#cb849-37" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb849-38"><a href="tables-and-graphs.html#cb849-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error in png(paste0(spt_root, spt_prefix, &quot;_w135h76_res72.png&quot;), width = 135,  : 
##   unable to start png() device
## Error in png(paste0(spt_root, spt_prefix, &quot;_w135h76_res300.png&quot;), width = 135,  : 
##   unable to start png() device
## Error in png(paste0(spt_root, spt_prefix, &quot;_w80h48_res300.png&quot;), width = 80,  : 
##   unable to start png() device
## Error in png(paste0(spt_root, spt_prefix, &quot;_w160h100_res300.png&quot;), width = 160,  : 
##   unable to start png() device
## Error in postscript(paste0(spt_root, spt_prefix, &quot;_fs_2curve.eps&quot;)) : 
##   cannot open file &#39;..//..//_img/fs_img_io_2curve_fs_2curve.eps&#39;</code></pre>
</div>
<div id="low-and-high-resolution-figure" class="section level5 hasAnchor" number="10.4.1.1.4">
<h5><span class="header-section-number">10.4.1.1.4</span> Low and High Resolution Figure<a href="tables-and-graphs.html#low-and-high-resolution-figure" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The standard resolution often produces very low quality images. Resolution should be increased. See figure comparison.</p>
<center>
<img src="_img/fs_img_io_2curve_w135h76_res72.png" height="304mm" width="540mm" style="float:center">
</center>
<br />
<center>
<img src="_img/fs_img_io_2curve_w135h76_res300.png" height="304mm" width="540mm" style="float:center">
</center>
</div>
<div id="smaller-and-larger-figures" class="section level5 hasAnchor" number="10.4.1.1.5">
<h5><span class="header-section-number">10.4.1.1.5</span> Smaller and Larger Figures<a href="tables-and-graphs.html#smaller-and-larger-figures" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Smaller and larger figures with different font size comparison. Note that earlier, we generated the figure without legends, labels, etc first, recorded the figure. Then we associated the same underlying figure with differently sized titles, legends, axis, labels.</p>
<center>
<img src="_img/fs_img_io_2curve_w80h48_res300.png" height="192mm" width="320mm" style="float:center">
</center>
<br />
<center>
<img src="_img/fs_img_io_2curve_w160h100_res300.png" height="400mm" width="640mm" style="float:center">
</center>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="get-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
