<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2021-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="optimization.html"/>
<link rel="next" href="statistics.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-dataframes"><i class="fa fa-check"></i><b>1.4.5</b> String Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarize-data.html"><a href="summarize-data.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.2.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.3.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.4" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-compare"><i class="fa fa-check"></i><b>4.3</b> Join and Compare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.1</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.1</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.3</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.4</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-function"><i class="fa fa-check"></i><b>8.2</b> Production Function</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
<li class="chapter" data-level="8.3.4" data-path="mathematics.html"><a href="mathematics.html#location-population-and-pollution"><i class="fa fa-check"></i><b>8.3.4</b> Location, Population, and Pollution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
<li class="chapter" data-level="9.3.2" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-marginal-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.3.2</b> Obtaining Joint Distribution from Marginal with Rectilinear Restrictions</a></li>
<li class="chapter" data-level="9.3.3" data-path="statistics.html"><a href="statistics.html#obtaining-joint-distribution-from-conditional-with-rectilinear-restrictions"><i class="fa fa-check"></i><b>9.3.3</b> Obtaining Joint Distribution from Conditional with Rectilinear Restrictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-and-development.html"><a href="code-and-development.html"><i class="fa fa-check"></i><b>12</b> Code and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="code-and-development.html"><a href="code-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.1</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="code-and-development.html"><a href="code-and-development.html#file-path"><i class="fa fa-check"></i><b>12.1.1</b> File Path</a></li>
<li class="chapter" data-level="12.1.2" data-path="code-and-development.html"><a href="code-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.1.2</b> Text to File</a></li>
<li class="chapter" data-level="12.1.3" data-path="code-and-development.html"><a href="code-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.1.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="code-and-development.html"><a href="code-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.2</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="code-and-development.html"><a href="code-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.2.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="code-and-development.html"><a href="code-and-development.html#command-line"><i class="fa fa-check"></i><b>12.3</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="code-and-development.html"><a href="code-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.3.1</b> Shell and System Commands</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate, Gather, Bind and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-join-and-comparejoin-and-compare-links"><i class="fa fa-check"></i><b>A.4.3</b> <span>Section 4.3 Join and Compare</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-polynomial-fittingpolynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 Polynomial Fitting</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> <span>Section 5.3 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Quantile Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Basics</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionproduction-function-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Production Function</span> links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> <span>Section 8.3 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 Random Draws</span> links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> <span>Section 9.2 Distributions</span> links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> <span>Section 9.3 Discrete Random Variable</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> <span>Section 10.2 ggplot Line Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> <span>Section 10.3 ggplot Scatter Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> <span>Section 10.4 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> <span>Section 11.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#code-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Code and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.1</b> <span>Section 12.1 Files In and Out</span> links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.2</b> <span>Section 12.2 Python with R</span> links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.3</b> <span>Section 12.3 Command Line</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mathematics" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Mathematics</h1>

<div id="basics" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Basics</h2>

<div id="log-with-different-bases-and-exponents" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Log with Different Bases and Exponents</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="log-of-bases-that-are-not-10-2-and-e" class="section level4" number="8.1.1.1">
<h4><span class="header-section-number">8.1.1.1</span> Log of Bases that Are not 10, 2 and e</h4>
<p>What is <span class="math inline">\(y\)</span> below, with arbitrary base <span class="math inline">\(x\)</span>? It is <span class="math inline">\(y=\frac{\log\left(z\right)}{\log\left(x\right)}\)</span>, because:
<span class="math display">\[
\begin{aligned}
x^y &amp;= z\\
x^{\frac{\log\left(z\right)}{\log\left(x\right)}}&amp;=z\\
\log\left(x^{\frac{\log\left(z\right)}{\log\left(x\right)}}\right)&amp;=\log\left(z\right)\\
\frac{\log\left(z\right)}{\log\left(x\right)}\log\left(x\right)&amp;=\log\left(z\right)\\
\frac{\log\left(z\right)}{\log\left(x\right)}&amp;=\frac{\log\left(z\right)}{\log\left(x\right)}\\
\end{aligned}
\]</span></p>
<p>Given these, we can compute the exponents, <span class="math inline">\(y\)</span>, for non-standard bases, <span class="math inline">\(x\)</span>, given the value for <span class="math inline">\(z\)</span>.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="mathematics.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base 1.1</span></span>
<span id="cb520-2"><a href="mathematics.html#cb520-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb520-3"><a href="mathematics.html#cb520-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">5.5</span></span>
<span id="cb520-4"><a href="mathematics.html#cb520-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x<span class="sc">^</span>y</span>
<span id="cb520-5"><a href="mathematics.html#cb520-5" aria-hidden="true" tabindex="-1"></a><span class="co"># given z and knowing x, and what is y?</span></span>
<span id="cb520-6"><a href="mathematics.html#cb520-6" aria-hidden="true" tabindex="-1"></a>y_solved <span class="ot">&lt;-</span> <span class="fu">log</span>(z) <span class="sc">/</span> <span class="fu">log</span>(x)</span>
<span id="cb520-7"><a href="mathematics.html#cb520-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dispaly</span></span>
<span id="cb520-8"><a href="mathematics.html#cb520-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;y_solved=&quot;</span>, y_solved, <span class="st">&quot;, y=&quot;</span>, y))</span></code></pre></div>
<pre><code>## [1] &quot;y_solved=5.5, y=5.5&quot;</code></pre>
</div>
<div id="rescale-bounded-model-parameters-to-unconstrained-with-exponentiation" class="section level4" number="8.1.1.2">
<h4><span class="header-section-number">8.1.1.2</span> Rescale Bounded Model Parameters to Unconstrained with Exponentiation</h4>
<p>We have a parameter to be estimated, the parameter’s values can range between positive 1 and negative infinity. We want to use an estimator that us unconstrained. Use exponentiation to rescale the parameter so that is become unconstrained, use different bases so that the speed at which the parameter value approaches its bounds can be controlled.</p>
<p>While <span class="math inline">\(y\)</span> is not bounded, <span class="math inline">\(f(y;x)\)</span> is bounded:
<span class="math display">\[
\begin{aligned}
&amp;f(y; x) = 1 - x^{y}\\
&amp;\text{where } x &gt;1 \text{ and }  -\infty &lt; y &lt; \infty\\
&amp;\text{then, } 1 &gt; f(y; x) &gt; -\infty
\end{aligned}
\]</span></p>
<p>With <span class="math inline">\(x&gt;1\)</span>, as <span class="math inline">\(y\)</span> increases <span class="math inline">\(f(y;x)\)</span> decreases:
<span class="math display">\[
\frac{d f(y; x)}{dy} = - x^{y}\log(x) &lt; 0 \text{ when } x &gt; 1
\]</span></p>
<p><span class="math inline">\(x\)</span> controls the speed at which <span class="math inline">\(f(y)\)</span> approaches its bounds. In the simulation below, we try a number of different bases, at higher bases (2, e=2.71, 10), as <span class="math inline">\(y\)</span> value changes <span class="math inline">\(f(y)\)</span> shifts too quickly to the bounds. But a base value of <span class="math inline">\(x=1.03\)</span> or <span class="math inline">\(x=1.04\)</span> would work well in an unbounded estimation routine that still generates parameters within bounds, which is below 1 in the case here.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="mathematics.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of unbounded values, high and low</span></span>
<span id="cb522-2"><a href="mathematics.html#cb522-2" aria-hidden="true" tabindex="-1"></a>ar_y_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb522-3"><a href="mathematics.html#cb522-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Different base values</span></span>
<span id="cb522-4"><a href="mathematics.html#cb522-4" aria-hidden="true" tabindex="-1"></a>ar_bases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.01</span>, <span class="fl">1.02</span>, <span class="fl">1.03</span>, <span class="fl">1.04</span>, <span class="fl">1.1</span>, <span class="dv">2</span>, <span class="fl">2.71</span>, <span class="dv">10</span>)</span>
<span id="cb522-5"><a href="mathematics.html#cb522-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform back to f(y) scale with different bases</span></span>
<span id="cb522-6"><a href="mathematics.html#cb522-6" aria-hidden="true" tabindex="-1"></a>mt_f_of_y_vary_x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,</span>
<span id="cb522-7"><a href="mathematics.html#cb522-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">length</span>(ar_y_vals),</span>
<span id="cb522-8"><a href="mathematics.html#cb522-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">length</span>(ar_bases)</span>
<span id="cb522-9"><a href="mathematics.html#cb522-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb522-10"><a href="mathematics.html#cb522-10" aria-hidden="true" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;yvalidx&quot;</span>, <span class="st">&quot;y_vals&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;base&quot;</span>, ar_bases))</span>
<span id="cb522-11"><a href="mathematics.html#cb522-11" aria-hidden="true" tabindex="-1"></a>mt_f_of_y_vary_x[, <span class="dv">1</span>] <span class="ot">&lt;-</span> ar_y_vals</span>
<span id="cb522-12"><a href="mathematics.html#cb522-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_base <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_bases))) {</span>
<span id="cb522-13"><a href="mathematics.html#cb522-13" aria-hidden="true" tabindex="-1"></a>  fl_base <span class="ot">&lt;-</span> ar_bases[it_base]</span>
<span id="cb522-14"><a href="mathematics.html#cb522-14" aria-hidden="true" tabindex="-1"></a>  ar_f_y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> fl_base<span class="sc">^</span>ar_y_vals</span>
<span id="cb522-15"><a href="mathematics.html#cb522-15" aria-hidden="true" tabindex="-1"></a>  mt_f_of_y_vary_x[, <span class="dv">1</span> <span class="sc">+</span> it_base] <span class="ot">&lt;-</span> ar_f_y</span>
<span id="cb522-16"><a href="mathematics.html#cb522-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb522-17"><a href="mathematics.html#cb522-17" aria-hidden="true" tabindex="-1"></a><span class="co"># To tibble</span></span>
<span id="cb522-18"><a href="mathematics.html#cb522-18" aria-hidden="true" tabindex="-1"></a>tb_f_of_y_vary_x <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_f_of_y_vary_x) <span class="sc">%&gt;%</span></span>
<span id="cb522-19"><a href="mathematics.html#cb522-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-20"><a href="mathematics.html#cb522-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb522-21"><a href="mathematics.html#cb522-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb522-22"><a href="mathematics.html#cb522-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tb_f_of_y_vary_x) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
yvalidx
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y_vals
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.01
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.02
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.03
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.04
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base2.71
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-33.079054
</td>
<td style="text-align:right;">
0.2804631
</td>
<td style="text-align:right;">
0.4805850
</td>
<td style="text-align:right;">
0.6238537
</td>
<td style="text-align:right;">
0.7267544
</td>
<td style="text-align:right;">
0.9572664
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-30.457963
</td>
<td style="text-align:right;">
0.2614502
</td>
<td style="text-align:right;">
0.4529131
</td>
<td style="text-align:right;">
0.5935527
</td>
<td style="text-align:right;">
0.6971698
</td>
<td style="text-align:right;">
0.9451391
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-16.676929
</td>
<td style="text-align:right;">
0.1529038
</td>
<td style="text-align:right;">
0.2812538
</td>
<td style="text-align:right;">
0.3891782
</td>
<td style="text-align:right;">
0.4800804
</td>
<td style="text-align:right;">
0.7959685
</td>
<td style="text-align:right;">
9.999905e-01
</td>
<td style="text-align:right;">
9.999999e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-12.910841
</td>
<td style="text-align:right;">
0.1205575
</td>
<td style="text-align:right;">
0.2256014
</td>
<td style="text-align:right;">
0.3172517
</td>
<td style="text-align:right;">
0.3973221
</td>
<td style="text-align:right;">
0.7078636
</td>
<td style="text-align:right;">
9.998701e-01
</td>
<td style="text-align:right;">
9.999974e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-6.044928
</td>
<td style="text-align:right;">
0.0583758
</td>
<td style="text-align:right;">
0.1128183
</td>
<td style="text-align:right;">
0.1636272
</td>
<td style="text-align:right;">
0.2110769
</td>
<td style="text-align:right;">
0.4379380
</td>
<td style="text-align:right;">
9.848541e-01
</td>
<td style="text-align:right;">
9.975860e-01
</td>
<td style="text-align:right;">
9.999991e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-5.758399
</td>
<td style="text-align:right;">
0.0556874
</td>
<td style="text-align:right;">
0.1077701
</td>
<td style="text-align:right;">
0.1565135
</td>
<td style="text-align:right;">
0.2021610
</td>
<td style="text-align:right;">
0.4223771
</td>
<td style="text-align:right;">
9.815265e-01
</td>
<td style="text-align:right;">
9.967879e-01
</td>
<td style="text-align:right;">
9.999983e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-5.743401
</td>
<td style="text-align:right;">
0.0555464
</td>
<td style="text-align:right;">
0.1075051
</td>
<td style="text-align:right;">
0.1561395
</td>
<td style="text-align:right;">
0.2016916
</td>
<td style="text-align:right;">
0.4215508
</td>
<td style="text-align:right;">
9.813334e-01
</td>
<td style="text-align:right;">
9.967395e-01
</td>
<td style="text-align:right;">
9.999982e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-0.567698
</td>
<td style="text-align:right;">
0.0056329
</td>
<td style="text-align:right;">
0.0111790
</td>
<td style="text-align:right;">
0.0166405
</td>
<td style="text-align:right;">
0.0220195
</td>
<td style="text-align:right;">
0.0526696
</td>
<td style="text-align:right;">
3.253075e-01
</td>
<td style="text-align:right;">
4.321885e-01
</td>
<td style="text-align:right;">
7.294161e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
2.454721
</td>
<td style="text-align:right;">
-0.0247260
</td>
<td style="text-align:right;">
-0.0498108
</td>
<td style="text-align:right;">
-0.0752558
</td>
<td style="text-align:right;">
-0.1010628
</td>
<td style="text-align:right;">
-0.2635939
</td>
<td style="text-align:right;">
-4.482073e+00
</td>
<td style="text-align:right;">
-1.055631e+01
</td>
<td style="text-align:right;">
-2.839191e+02
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
5.499020
</td>
<td style="text-align:right;">
-0.0562417
</td>
<td style="text-align:right;">
-0.1150453
</td>
<td style="text-align:right;">
-0.1765006
</td>
<td style="text-align:right;">
-0.2406997
</td>
<td style="text-align:right;">
-0.6889594
</td>
<td style="text-align:right;">
-4.422412e+01
</td>
<td style="text-align:right;">
-2.393848e+02
</td>
<td style="text-align:right;">
-3.155143e+05
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5.956853
</td>
<td style="text-align:right;">
-0.0610645
</td>
<td style="text-align:right;">
-0.1252006
</td>
<td style="text-align:right;">
-0.1925304
</td>
<td style="text-align:right;">
-0.2631796
</td>
<td style="text-align:right;">
-0.7642906
</td>
<td style="text-align:right;">
-6.111426e+01
</td>
<td style="text-align:right;">
-3.784322e+02
</td>
<td style="text-align:right;">
-9.054242e+05
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6.182477
</td>
<td style="text-align:right;">
-0.0634493
</td>
<td style="text-align:right;">
-0.1302392
</td>
<td style="text-align:right;">
-0.2005102
</td>
<td style="text-align:right;">
-0.2744073
</td>
<td style="text-align:right;">
-0.8026414
</td>
<td style="text-align:right;">
-7.162918e+01
</td>
<td style="text-align:right;">
-4.741414e+02
</td>
<td style="text-align:right;">
-1.522219e+06
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
6.743568
</td>
<td style="text-align:right;">
-0.0694032
</td>
<td style="text-align:right;">
-0.1428674
</td>
<td style="text-align:right;">
-0.2205869
</td>
<td style="text-align:right;">
-0.3027632
</td>
<td style="text-align:right;">
-0.9016667
</td>
<td style="text-align:right;">
-1.061560e+02
</td>
<td style="text-align:right;">
-8.303005e+02
</td>
<td style="text-align:right;">
-5.540748e+06
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
8.392309
</td>
<td style="text-align:right;">
-0.0870920
</td>
<td style="text-align:right;">
-0.1807971
</td>
<td style="text-align:right;">
-0.2815453
</td>
<td style="text-align:right;">
-0.3897895
</td>
<td style="text-align:right;">
-1.2252571
</td>
<td style="text-align:right;">
-3.349980e+02
</td>
<td style="text-align:right;">
-4.300421e+03
</td>
<td style="text-align:right;">
-2.467792e+08
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8.537745
</td>
<td style="text-align:right;">
-0.0886663
</td>
<td style="text-align:right;">
-0.1842028
</td>
<td style="text-align:right;">
-0.2870664
</td>
<td style="text-align:right;">
-0.3977397
</td>
<td style="text-align:right;">
-1.2563175
</td>
<td style="text-align:right;">
-3.706357e+02
</td>
<td style="text-align:right;">
-4.971578e+03
</td>
<td style="text-align:right;">
-3.449415e+08
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
11.199607
</td>
<td style="text-align:right;">
-0.1178864
</td>
<td style="text-align:right;">
-0.2482988
</td>
<td style="text-align:right;">
-0.3924252
</td>
<td style="text-align:right;">
-0.5515533
</td>
<td style="text-align:right;">
-1.9079157
</td>
<td style="text-align:right;">
-2.350894e+03
</td>
<td style="text-align:right;">
-7.064474e+04
</td>
<td style="text-align:right;">
-1.583460e+11
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
12.805015
</td>
<td style="text-align:right;">
-0.1358873
</td>
<td style="text-align:right;">
-0.2886214
</td>
<td style="text-align:right;">
-0.4600941
</td>
<td style="text-align:right;">
-0.6523885
</td>
<td style="text-align:right;">
-2.3887066
</td>
<td style="text-align:right;">
-7.155385e+03
</td>
<td style="text-align:right;">
-3.500879e+05
</td>
<td style="text-align:right;">
-6.382858e+12
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13.492957
</td>
<td style="text-align:right;">
-0.1436894
</td>
<td style="text-align:right;">
-0.3062964
</td>
<td style="text-align:right;">
-0.4900887
</td>
<td style="text-align:right;">
-0.6975795
</td>
<td style="text-align:right;">
-2.6183428
</td>
<td style="text-align:right;">
-1.152782e+04
</td>
<td style="text-align:right;">
-6.950808e+05
</td>
<td style="text-align:right;">
-3.111407e+13
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
23.309229
</td>
<td style="text-align:right;">
-0.2610372
</td>
<td style="text-align:right;">
-0.5865851
</td>
<td style="text-align:right;">
-0.9917087
</td>
<td style="text-align:right;">
-1.4947901
</td>
<td style="text-align:right;">
-8.2221374
</td>
<td style="text-align:right;">
-1.039387e+07
</td>
<td style="text-align:right;">
-1.236461e+10
</td>
<td style="text-align:right;">
-2.038118e+23
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
33.498931
</td>
<td style="text-align:right;">
-0.3956014
</td>
<td style="text-align:right;">
-0.9413175
</td>
<td style="text-align:right;">
-1.6917412
</td>
<td style="text-align:right;">
-2.7204773
</td>
<td style="text-align:right;">
-23.3562658
</td>
<td style="text-align:right;">
-1.213900e+10
</td>
<td style="text-align:right;">
-3.191600e+14
</td>
<td style="text-align:right;">
-3.154504e+33
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="positive-exponents" class="section level4" number="8.1.1.3">
<h4><span class="header-section-number">8.1.1.3</span> Positive Exponents</h4>
<p>Define exponents to consider and x-values to consider.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="mathematics.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="co"># positive value exponents</span></span>
<span id="cb523-2"><a href="mathematics.html#cb523-2" aria-hidden="true" tabindex="-1"></a>ar_exponents_posv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>)</span>
<span id="cb523-3"><a href="mathematics.html#cb523-3" aria-hidden="true" tabindex="-1"></a><span class="co"># positive and negative values of the base</span></span>
<span id="cb523-4"><a href="mathematics.html#cb523-4" aria-hidden="true" tabindex="-1"></a>ar_baseval_pos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-10</span>, <span class="fl">1.5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb523-5"><a href="mathematics.html#cb523-5" aria-hidden="true" tabindex="-1"></a><span class="co"># base to power</span></span>
<span id="cb523-6"><a href="mathematics.html#cb523-6" aria-hidden="true" tabindex="-1"></a>mt_x2a_val <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(ar_exponents_posv), <span class="at">ncol =</span> <span class="fu">length</span>(ar_baseval_pos))</span>
<span id="cb523-7"><a href="mathematics.html#cb523-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate values</span></span>
<span id="cb523-8"><a href="mathematics.html#cb523-8" aria-hidden="true" tabindex="-1"></a>it_row_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb523-9"><a href="mathematics.html#cb523-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (fl_exponents_posv <span class="cf">in</span> ar_exponents_posv) {</span>
<span id="cb523-10"><a href="mathematics.html#cb523-10" aria-hidden="true" tabindex="-1"></a>  it_row_ctr <span class="ot">&lt;-</span> it_row_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb523-11"><a href="mathematics.html#cb523-11" aria-hidden="true" tabindex="-1"></a>  mt_x2a_val[it_row_ctr, ] <span class="ot">&lt;-</span> ar_baseval_pos<span class="sc">^</span>fl_exponents_posv</span>
<span id="cb523-12"><a href="mathematics.html#cb523-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that the smaller exponents functions are higher when <span class="math inline">\(x&lt;1\)</span>, but lower when <span class="math inline">\(x&gt;1\)</span>.
<span class="math display">\[\text{if } b &gt; a &gt; 0 \text{, then, } \left(x^a - x^b\right) &gt; 0 \text{, for all } 1 &gt; x &gt;0\]</span>
<span class="math display">\[\text{if } b &gt; a &gt; 0 \text{, then, } \left(x^a - x^b\right) &lt; 0 \text{, for all } x &gt; 1\]</span>
Note we also have: <span class="math inline">\(\lim_{a\rightarrow 0} x^a = 1\)</span> and <span class="math inline">\(\lim_{a\rightarrow 1} x^a = x\)</span> bounds. When <span class="math inline">\(a&gt;1\)</span>, function becomes convex.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="mathematics.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x and bounds</span></span>
<span id="cb524-2"><a href="mathematics.html#cb524-2" aria-hidden="true" tabindex="-1"></a>ar_xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(ar_baseval_pos), <span class="fu">max</span>(ar_baseval_pos))</span>
<span id="cb524-3"><a href="mathematics.html#cb524-3" aria-hidden="true" tabindex="-1"></a>ar_ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb524-4"><a href="mathematics.html#cb524-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function line</span></span>
<span id="cb524-5"><a href="mathematics.html#cb524-5" aria-hidden="true" tabindex="-1"></a>st_line_1_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">1</span>])</span>
<span id="cb524-6"><a href="mathematics.html#cb524-6" aria-hidden="true" tabindex="-1"></a>st_line_2_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">2</span>])</span>
<span id="cb524-7"><a href="mathematics.html#cb524-7" aria-hidden="true" tabindex="-1"></a>st_line_3_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">3</span>])</span>
<span id="cb524-8"><a href="mathematics.html#cb524-8" aria-hidden="true" tabindex="-1"></a>st_line_4_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">4</span>])</span>
<span id="cb524-9"><a href="mathematics.html#cb524-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Color and line</span></span>
<span id="cb524-10"><a href="mathematics.html#cb524-10" aria-hidden="true" tabindex="-1"></a>st_point_1_pch <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb524-11"><a href="mathematics.html#cb524-11" aria-hidden="true" tabindex="-1"></a>st_point_1_cex <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb524-12"><a href="mathematics.html#cb524-12" aria-hidden="true" tabindex="-1"></a>ar_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb524-13"><a href="mathematics.html#cb524-13" aria-hidden="true" tabindex="-1"></a>ar_ltys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;dotdash&quot;</span>)</span>
<span id="cb524-14"><a href="mathematics.html#cb524-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph and combine</span></span>
<span id="cb524-15"><a href="mathematics.html#cb524-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_graph <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)) {</span>
<span id="cb524-16"><a href="mathematics.html#cb524-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_graph <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb524-17"><a href="mathematics.html#cb524-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb524-18"><a href="mathematics.html#cb524-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb524-19"><a href="mathematics.html#cb524-19" aria-hidden="true" tabindex="-1"></a>  ar_y_current <span class="ot">&lt;-</span> mt_x2a_val[it_graph, ]</span>
<span id="cb524-20"><a href="mathematics.html#cb524-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(ar_baseval_pos, ar_y_current,</span>
<span id="cb524-21"><a href="mathematics.html#cb524-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb524-22"><a href="mathematics.html#cb524-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> ar_colors[it_graph], <span class="at">lty =</span> ar_ltys[it_graph],</span>
<span id="cb524-23"><a href="mathematics.html#cb524-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">10</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim, <span class="at">panel.first =</span> <span class="fu">grid</span>(),</span>
<span id="cb524-24"><a href="mathematics.html#cb524-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ann =</span> <span class="cn">FALSE</span></span>
<span id="cb524-25"><a href="mathematics.html#cb524-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb524-26"><a href="mathematics.html#cb524-26" aria-hidden="true" tabindex="-1"></a>  plot_line <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb524-27"><a href="mathematics.html#cb524-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb524-28"><a href="mathematics.html#cb524-28" aria-hidden="true" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb524-29"><a href="mathematics.html#cb524-29" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb524-30"><a href="mathematics.html#cb524-30" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_small <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb524-31"><a href="mathematics.html#cb524-31" aria-hidden="true" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb524-32"><a href="mathematics.html#cb524-32" aria-hidden="true" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Positive Exponential Graphing&quot;</span>)</span>
<span id="cb524-33"><a href="mathematics.html#cb524-33" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb524-34"><a href="mathematics.html#cb524-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb524-35"><a href="mathematics.html#cb524-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;R4Econ/math/solutions/htmlpdfr/fs_inequality.html&quot;</span></span>
<span id="cb524-36"><a href="mathematics.html#cb524-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb524-37"><a href="mathematics.html#cb524-37" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&quot;x&quot;</span></span>
<span id="cb524-38"><a href="mathematics.html#cb524-38" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&quot;x^exponent&quot;</span></span>
<span id="cb524-39"><a href="mathematics.html#cb524-39" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb524-40"><a href="mathematics.html#cb524-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb524-41"><a href="mathematics.html#cb524-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.lab =</span> fl_ces_fig_reg,</span>
<span id="cb524-42"><a href="mathematics.html#cb524-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.main =</span> fl_ces_fig_reg,</span>
<span id="cb524-43"><a href="mathematics.html#cb524-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.sub =</span> fl_ces_fig_small</span>
<span id="cb524-44"><a href="mathematics.html#cb524-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb524-45"><a href="mathematics.html#cb524-45" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb524-46"><a href="mathematics.html#cb524-46" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb524-47"><a href="mathematics.html#cb524-47" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb524-48"><a href="mathematics.html#cb524-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb524-49"><a href="mathematics.html#cb524-49" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb524-50"><a href="mathematics.html#cb524-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">inset =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb524-51"><a href="mathematics.html#cb524-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb524-52"><a href="mathematics.html#cb524-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(st_line_1_y_legend, st_line_2_y_legend, st_line_3_y_legend, st_line_4_y_legend),</span>
<span id="cb524-53"><a href="mathematics.html#cb524-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(ar_colors[<span class="dv">1</span>], ar_colors[<span class="dv">2</span>], ar_colors[<span class="dv">3</span>], ar_colors[<span class="dv">4</span>]),</span>
<span id="cb524-54"><a href="mathematics.html#cb524-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb524-55"><a href="mathematics.html#cb524-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(ar_ltys[<span class="dv">1</span>], ar_ltys[<span class="dv">2</span>], ar_ltys[<span class="dv">3</span>], ar_ltys[<span class="dv">4</span>]),</span>
<span id="cb524-56"><a href="mathematics.html#cb524-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Legends&quot;</span>,</span>
<span id="cb524-57"><a href="mathematics.html#cb524-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.intersp =</span> <span class="dv">2</span></span>
<span id="cb524-58"><a href="mathematics.html#cb524-58" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-254-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="negative-exponents" class="section level4" number="8.1.1.4">
<h4><span class="header-section-number">8.1.1.4</span> Negative Exponents</h4>
<p>Similar to above, but now with negative exonents.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="mathematics.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># positive value exponents</span></span>
<span id="cb525-2"><a href="mathematics.html#cb525-2" aria-hidden="true" tabindex="-1"></a>ar_exponents_posv <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>)</span>
<span id="cb525-3"><a href="mathematics.html#cb525-3" aria-hidden="true" tabindex="-1"></a><span class="co"># positive and negative values of the base</span></span>
<span id="cb525-4"><a href="mathematics.html#cb525-4" aria-hidden="true" tabindex="-1"></a>ar_baseval_pos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-10</span>, <span class="fl">1.5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb525-5"><a href="mathematics.html#cb525-5" aria-hidden="true" tabindex="-1"></a><span class="co"># base to power</span></span>
<span id="cb525-6"><a href="mathematics.html#cb525-6" aria-hidden="true" tabindex="-1"></a>mt_x2a_val <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(ar_exponents_posv), <span class="at">ncol =</span> <span class="fu">length</span>(ar_baseval_pos))</span>
<span id="cb525-7"><a href="mathematics.html#cb525-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate values</span></span>
<span id="cb525-8"><a href="mathematics.html#cb525-8" aria-hidden="true" tabindex="-1"></a>it_row_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb525-9"><a href="mathematics.html#cb525-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (fl_exponents_posv <span class="cf">in</span> ar_exponents_posv) {</span>
<span id="cb525-10"><a href="mathematics.html#cb525-10" aria-hidden="true" tabindex="-1"></a>  it_row_ctr <span class="ot">&lt;-</span> it_row_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb525-11"><a href="mathematics.html#cb525-11" aria-hidden="true" tabindex="-1"></a>  mt_x2a_val[it_row_ctr, ] <span class="ot">&lt;-</span> ar_baseval_pos<span class="sc">^</span>fl_exponents_posv</span>
<span id="cb525-12"><a href="mathematics.html#cb525-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>For positive exponents, when <span class="math inline">\(x&lt;1\)</span>, <span class="math inline">\(x^a&lt;1\)</span>, when <span class="math inline">\(x&gt;1\)</span>, <span class="math inline">\(x^a&gt;1\)</span>. For negative exponents, when <span class="math inline">\(x&lt;1\)</span>, <span class="math inline">\(x^a&gt;1\)</span>, and when <span class="math inline">\(x&gt;1\)</span>, <span class="math inline">\(x^a&lt;1\)</span>. Large positive exponents generate small values when <span class="math inline">\(x&lt;1\)</span>, and large negative exponents generate very large values when <span class="math inline">\(x&lt;1\)</span>.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="mathematics.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x and bounds</span></span>
<span id="cb526-2"><a href="mathematics.html#cb526-2" aria-hidden="true" tabindex="-1"></a>ar_xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(ar_baseval_pos), <span class="fu">max</span>(ar_baseval_pos))</span>
<span id="cb526-3"><a href="mathematics.html#cb526-3" aria-hidden="true" tabindex="-1"></a>ar_ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb526-4"><a href="mathematics.html#cb526-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function line</span></span>
<span id="cb526-5"><a href="mathematics.html#cb526-5" aria-hidden="true" tabindex="-1"></a>st_line_1_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">1</span>])</span>
<span id="cb526-6"><a href="mathematics.html#cb526-6" aria-hidden="true" tabindex="-1"></a>st_line_2_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">2</span>])</span>
<span id="cb526-7"><a href="mathematics.html#cb526-7" aria-hidden="true" tabindex="-1"></a>st_line_3_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">3</span>])</span>
<span id="cb526-8"><a href="mathematics.html#cb526-8" aria-hidden="true" tabindex="-1"></a>st_line_4_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">4</span>])</span>
<span id="cb526-9"><a href="mathematics.html#cb526-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Color and line</span></span>
<span id="cb526-10"><a href="mathematics.html#cb526-10" aria-hidden="true" tabindex="-1"></a>st_point_1_pch <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb526-11"><a href="mathematics.html#cb526-11" aria-hidden="true" tabindex="-1"></a>st_point_1_cex <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb526-12"><a href="mathematics.html#cb526-12" aria-hidden="true" tabindex="-1"></a>ar_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb526-13"><a href="mathematics.html#cb526-13" aria-hidden="true" tabindex="-1"></a>ar_ltys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;dotdash&quot;</span>)</span>
<span id="cb526-14"><a href="mathematics.html#cb526-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph and combine</span></span>
<span id="cb526-15"><a href="mathematics.html#cb526-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_graph <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)) {</span>
<span id="cb526-16"><a href="mathematics.html#cb526-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_graph <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb526-17"><a href="mathematics.html#cb526-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb526-18"><a href="mathematics.html#cb526-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb526-19"><a href="mathematics.html#cb526-19" aria-hidden="true" tabindex="-1"></a>  ar_y_current <span class="ot">&lt;-</span> mt_x2a_val[it_graph, ]</span>
<span id="cb526-20"><a href="mathematics.html#cb526-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(ar_baseval_pos, ar_y_current,</span>
<span id="cb526-21"><a href="mathematics.html#cb526-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb526-22"><a href="mathematics.html#cb526-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> ar_colors[it_graph], <span class="at">lty =</span> ar_ltys[it_graph],</span>
<span id="cb526-23"><a href="mathematics.html#cb526-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">10</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim, <span class="at">panel.first =</span> <span class="fu">grid</span>(),</span>
<span id="cb526-24"><a href="mathematics.html#cb526-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ann =</span> <span class="cn">FALSE</span></span>
<span id="cb526-25"><a href="mathematics.html#cb526-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb526-26"><a href="mathematics.html#cb526-26" aria-hidden="true" tabindex="-1"></a>  plot_line <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb526-27"><a href="mathematics.html#cb526-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb526-28"><a href="mathematics.html#cb526-28" aria-hidden="true" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb526-29"><a href="mathematics.html#cb526-29" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb526-30"><a href="mathematics.html#cb526-30" aria-hidden="true" tabindex="-1"></a>fl_ces_fig_small <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb526-31"><a href="mathematics.html#cb526-31" aria-hidden="true" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb526-32"><a href="mathematics.html#cb526-32" aria-hidden="true" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Negative Exponential Graphing&quot;</span>)</span>
<span id="cb526-33"><a href="mathematics.html#cb526-33" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb526-34"><a href="mathematics.html#cb526-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb526-35"><a href="mathematics.html#cb526-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;R4Econ/math/solutions/htmlpdfr/fs_inequality.html&quot;</span></span>
<span id="cb526-36"><a href="mathematics.html#cb526-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb526-37"><a href="mathematics.html#cb526-37" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&quot;x&quot;</span></span>
<span id="cb526-38"><a href="mathematics.html#cb526-38" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&quot;x^exponent&quot;</span></span>
<span id="cb526-39"><a href="mathematics.html#cb526-39" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb526-40"><a href="mathematics.html#cb526-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb526-41"><a href="mathematics.html#cb526-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.lab =</span> fl_ces_fig_reg,</span>
<span id="cb526-42"><a href="mathematics.html#cb526-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.main =</span> fl_ces_fig_reg,</span>
<span id="cb526-43"><a href="mathematics.html#cb526-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.sub =</span> fl_ces_fig_small</span>
<span id="cb526-44"><a href="mathematics.html#cb526-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb526-45"><a href="mathematics.html#cb526-45" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb526-46"><a href="mathematics.html#cb526-46" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb526-47"><a href="mathematics.html#cb526-47" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb526-48"><a href="mathematics.html#cb526-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb526-49"><a href="mathematics.html#cb526-49" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb526-50"><a href="mathematics.html#cb526-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">inset =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb526-51"><a href="mathematics.html#cb526-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb526-52"><a href="mathematics.html#cb526-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(st_line_1_y_legend, st_line_2_y_legend, st_line_3_y_legend, st_line_4_y_legend),</span>
<span id="cb526-53"><a href="mathematics.html#cb526-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(ar_colors[<span class="dv">1</span>], ar_colors[<span class="dv">2</span>], ar_colors[<span class="dv">3</span>], ar_colors[<span class="dv">4</span>]),</span>
<span id="cb526-54"><a href="mathematics.html#cb526-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb526-55"><a href="mathematics.html#cb526-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(ar_ltys[<span class="dv">1</span>], ar_ltys[<span class="dv">2</span>], ar_ltys[<span class="dv">3</span>], ar_ltys[<span class="dv">4</span>]),</span>
<span id="cb526-56"><a href="mathematics.html#cb526-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Legends&quot;</span>,</span>
<span id="cb526-57"><a href="mathematics.html#cb526-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.intersp =</span> <span class="dv">2</span></span>
<span id="cb526-58"><a href="mathematics.html#cb526-58" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-256-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="inequality-and-exponents" class="section level4" number="8.1.1.5">
<h4><span class="header-section-number">8.1.1.5</span> Inequality and Exponents</h4>
<p>Suppose we have the inequality <span class="math inline">\(0 &lt; a &lt; b\)</span>, if we apply positive exponents to them, the direction of the inequality will stay the same: If <span class="math inline">\(0 &lt; a &lt; b\)</span>, then <span class="math inline">\(0 &lt; a^{ \mid \alpha\mid} &lt; b^{ \mid \alpha\mid}\)</span> if <span class="math inline">\(\alpha &lt; 0\)</span>. Think about the graphs above, think of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> as points along the x-axis, note that positive exponents are strictly increasing (although some concavely and some convexly) along the x-axis. Comparing <span class="math inline">\(x^\alpha\)</span> at <span class="math inline">\(0&lt;b&lt;a\)</span> anywhere along the x-axis has still has <span class="math inline">\(b^\alpha&lt;a^\alpha\)</span>.</p>
<p>In contrast, if <span class="math inline">\(0 &lt; a &lt; b\)</span>, then <span class="math inline">\(a^{- \mid \alpha\mid} &gt; b^{- \mid \alpha\mid} &gt; 0\)</span> if <span class="math inline">\(\alpha &lt; 0\)</span>. Sign flips. Visually from above, the sign-flipping happens because negative exponential is strictly decreasing along <span class="math inline">\(x&gt;0\)</span>.</p>

</div>
</div>
<div id="rescale-a-parameter-with-fixed-min-and-max" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Rescale a Parameter with Fixed Min and Max</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="using-a-quadratic-function-to-fit-three-points-uniquely" class="section level4" number="8.1.2.1">
<h4><span class="header-section-number">8.1.2.1</span> Using A Quadratic Function to Fit Three Points Uniquely</h4>
<p>Given e &lt; x &lt; f, use f(x) to rescale x, such that f(e)=e, f(f)=f, but f(z)=<span class="math inline">\(\alpha \cdot z\)</span> for one particular z between e and f, where
<span class="math inline">\(\alpha\)</span> &gt; 1. And in this case, assume that <span class="math inline">\(\alpha \cdot z &lt; f\)</span>. We can fit these three points using the Quadratic function uniquely. In another word, there is a unique quadratic function that crosses these three points. Note the quadratic function is either concave or convex through the entire domain.</p>
<p>Suppose that <span class="math inline">\(e=0\)</span>, <span class="math inline">\(f=10\)</span>, <span class="math inline">\(z=2\)</span>, and <span class="math inline">\(\alpha=1.5\)</span>. Using a quadratic to fit:</p>
<p><span class="math display">\[
y(x) = a \cdot x^2 + b \cdot x + c
\]</span>
We have three equations:
<span class="math display">\[
0 = a \cdot 0 + b \cdot 0 + c\\
2 \cdot 1.5 = a \cdot 2^2 + b \cdot 2 + c\\
10 = a \cdot 10^2 + b \cdot 10 + c
\]</span>
Given these, we have, <span class="math inline">\(c = 0\)</span>, and subsequently, 2 equations and 2 unknowns:
<span class="math display">\[
3 = a \cdot 4 + b \cdot 2\\
10 = a \cdot 100 + b \cdot 10
\]</span></p>
<p>Hence:
<span class="math display">\[
a = \frac{3-2b}{4}\\
10 = \frac{3-2b}{4}\cdot 100 + b \cdot 10\\
10 = 75 - 50b + 10b\\
\]</span>
And finally:
<span class="math display">\[
a = \frac{3-2*1.625}{4}=-0.0625\\
b = \frac{65}{40}=1.625\\
c = 0
\]</span></p>
<p>Generate the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> points above for the quadratic function:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="mathematics.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set values</span></span>
<span id="cb527-2"><a href="mathematics.html#cb527-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb527-3"><a href="mathematics.html#cb527-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb527-4"><a href="mathematics.html#cb527-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb527-5"><a href="mathematics.html#cb527-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb527-6"><a href="mathematics.html#cb527-6" aria-hidden="true" tabindex="-1"></a><span class="co"># apply formulas from above</span></span>
<span id="cb527-7"><a href="mathematics.html#cb527-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.0625</span></span>
<span id="cb527-8"><a href="mathematics.html#cb527-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.625</span></span>
<span id="cb527-9"><a href="mathematics.html#cb527-9" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb527-10"><a href="mathematics.html#cb527-10" aria-hidden="true" tabindex="-1"></a><span class="co"># grid of values beween a and b, 11 points covering z = 2</span></span>
<span id="cb527-11"><a href="mathematics.html#cb527-11" aria-hidden="true" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(e, f, <span class="at">length.out =</span> <span class="dv">11</span>)</span>
<span id="cb527-12"><a href="mathematics.html#cb527-12" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale</span></span>
<span id="cb527-13"><a href="mathematics.html#cb527-13" aria-hidden="true" tabindex="-1"></a>ar_grid_quad <span class="ot">&lt;-</span> a<span class="sc">*</span>ar_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>ar_x <span class="sc">+</span> c</span>
<span id="cb527-14"><a href="mathematics.html#cb527-14" aria-hidden="true" tabindex="-1"></a><span class="co"># show values</span></span>
<span id="cb527-15"><a href="mathematics.html#cb527-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">print</span>(<span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_x, ar_grid_quad))), </span>
<span id="cb527-16"><a href="mathematics.html#cb527-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Quadratic Fit of Three Equations and Three Unknowns</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb527-17"><a href="mathematics.html#cb527-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Satisfies: f(0)=0, f(10)=10, f(2)=3&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb527-18"><a href="mathematics.html#cb527-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-258">Table 8.1: </span>Quadratic Fit of Three Equations and Three Unknowns
Satisfies: f(0)=0, f(10)=10, f(2)=3
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_grid_quad
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.5625
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.3125
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5.5000
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6.5625
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7.5000
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8.3125
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9.5625
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10.0000
</td>
</tr>
</tbody>
</table>
<p>We have three equations:
<span class="math display">\[
0 = a \cdot 0 + b \cdot 0 + c\\
0.75 = a \cdot 0.5^2 + b \cdot 0.5 + c\\
3.5 = a \cdot 3.5^2 + b \cdot 3.5 + c
\]</span>
Given these, we have, <span class="math inline">\(c = 0\)</span>, and subsequently, 2 equations and 2 unknowns:
<span class="math display">\[
0.75 = a \cdot 0.25 + b \cdot 0.5\\
3.5 = a \cdot 12.25 + b \cdot 3.5
\]</span></p>
<p>Hence:
<span class="math display">\[
a = \frac{0.75-0.5b}{0.25}\\
3.5 = \frac{0.75-0.5b}{0.25}\cdot 12.25 + b \cdot 3.5\\
3.5 = 36.75 - 24.5b + 3.5b\\
\]</span>
And finally:
<span class="math display">\[
a = \frac{0.75-0.5*1.58333}{0.25}=-0.1666\\
b = \frac{36.75-3.5}{24.5-3.5}=1.58333\\
c = 0
\]</span>
Generate the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> points above for the quadratic function:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="mathematics.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set values</span></span>
<span id="cb528-2"><a href="mathematics.html#cb528-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb528-3"><a href="mathematics.html#cb528-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb528-4"><a href="mathematics.html#cb528-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb528-5"><a href="mathematics.html#cb528-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb528-6"><a href="mathematics.html#cb528-6" aria-hidden="true" tabindex="-1"></a><span class="co"># apply formulas from above</span></span>
<span id="cb528-7"><a href="mathematics.html#cb528-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.16666666</span></span>
<span id="cb528-8"><a href="mathematics.html#cb528-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.583333333</span></span>
<span id="cb528-9"><a href="mathematics.html#cb528-9" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb528-10"><a href="mathematics.html#cb528-10" aria-hidden="true" tabindex="-1"></a><span class="co"># grid of values beween a and b, 11 points covering z = 2</span></span>
<span id="cb528-11"><a href="mathematics.html#cb528-11" aria-hidden="true" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(e, f, <span class="at">length.out =</span> <span class="dv">100000</span>)</span>
<span id="cb528-12"><a href="mathematics.html#cb528-12" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale</span></span>
<span id="cb528-13"><a href="mathematics.html#cb528-13" aria-hidden="true" tabindex="-1"></a>ar_grid_quad <span class="ot">&lt;-</span> a<span class="sc">*</span>ar_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>ar_x <span class="sc">+</span> c</span>
<span id="cb528-14"><a href="mathematics.html#cb528-14" aria-hidden="true" tabindex="-1"></a><span class="co"># show values</span></span>
<span id="cb528-15"><a href="mathematics.html#cb528-15" aria-hidden="true" tabindex="-1"></a><span class="co"># cbind(ar_x, ar_grid_quad)</span></span>
<span id="cb528-16"><a href="mathematics.html#cb528-16" aria-hidden="true" tabindex="-1"></a>ar_x[<span class="fu">which.min</span>(<span class="fu">abs</span>(ar_grid_quad <span class="sc">-</span> <span class="fl">0.75</span>))]</span></code></pre></div>
<pre><code>## [1] 0.500015</code></pre>

</div>
</div>
<div id="find-nearest" class="section level3" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Find Nearest</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="neart-point-along-a-line-through-orgin-to-another-point" class="section level4" number="8.1.3.1">
<h4><span class="header-section-number">8.1.3.1</span> Neart Point Along a Line Through Orgin to Another Point</h4>
<p>We first have <span class="math inline">\(X_1\)</span> an <span class="math inline">\(Y_1\)</span>, given these, we are able to generate <span class="math inline">\(R =\frac{Y_2}{X_2}\)</span>, a ratio. We want to iteratively update <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span>, where <span class="math inline">\(1\)</span> subscript indicates the first iteration, but we only know the ratio. Think of <span class="math inline">\(R\)</span> as a line through the origin with <span class="math inline">\(R\)</span> as the slope.</p>
<p>We generate <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y_2\)</span> by finding the point along the <span class="math inline">\(R\)</span> as slope origin line that is the closest to the <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span>. At the resulting point, <span class="math inline">\(R\)</span> will be respected, and it will differ least in distance to the earlier iteration’s <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span> points.</p>
<ol style="list-style-type: decimal">
<li>The slope of the diagonal line is <span class="math inline">\(-\frac{X_2}{Y_2}=-\frac{1}{R}\)</span></li>
<li>The diagonal line must cross <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span>, solve for this line’s y-intercept</li>
<li>Solve for the intersection of the diagonal line and the origin line with <span class="math inline">\(R\)</span> as slope</li>
</ol>
<p>Implementing step (2):</p>
<p><span class="math display">\[
\begin{aligned}
Y_1 &amp;= I - \frac{1}{R}\cdot X_1\\
I &amp;= Y_1 + \frac{X_1}{R} \\
I &amp;=  \frac{Y_1\cdot R + X_1}{R}\\
\end{aligned}
\]</span></p>
<p>Implementing step (3):
<span class="math display">\[
\begin{aligned}
Y &amp;= \frac{Y_1\cdot R + X_1}{R} - \frac{1}{R}\cdot X\\
Y &amp;= R \cdot X \\
R \cdot X &amp;= \frac{Y_1\cdot R + X_1}{R} - \frac{1}{R}\cdot X\\
\left(R + \frac{1}{R}\right) \cdot X &amp;= \frac{Y_1\cdot R + X_1}{R}\\
\frac{R^2 + 1}{R} \cdot X &amp;= \frac{Y_1\cdot R + X_1}{R}\\
X &amp;= \frac{Y_1\cdot R + X_1}{R} \cdot \frac{R}{R^2 + 1}\\
\end{aligned}
\]</span></p>
<p>And we have:
<span class="math display">\[
\begin{aligned}
X &amp;= \frac{Y_1\cdot R + X_1}{R^2 + 1}\\
Y &amp;= \frac{Y_1\cdot R^2 + X_1\cdot R}{R^2 + 1}\\
\end{aligned}
\]</span></p>
<p>Visualize the results:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="mathematics.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random parameter Values for X1, Y1, and X2/Y2 ratio</span></span>
<span id="cb530-2"><a href="mathematics.html#cb530-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb530-3"><a href="mathematics.html#cb530-3" aria-hidden="true" tabindex="-1"></a>fl_x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb530-4"><a href="mathematics.html#cb530-4" aria-hidden="true" tabindex="-1"></a>fl_y1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb530-5"><a href="mathematics.html#cb530-5" aria-hidden="true" tabindex="-1"></a>fl_r <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb530-6"><a href="mathematics.html#cb530-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-7"><a href="mathematics.html#cb530-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Diaganol</span></span>
<span id="cb530-8"><a href="mathematics.html#cb530-8" aria-hidden="true" tabindex="-1"></a>fl_diag_slope <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> fl_r</span>
<span id="cb530-9"><a href="mathematics.html#cb530-9" aria-hidden="true" tabindex="-1"></a>fl_diag_yintercept <span class="ot">&lt;-</span> (fl_y1 <span class="sc">*</span> fl_r <span class="sc">+</span> fl_x1) <span class="sc">/</span> fl_r</span>
<span id="cb530-10"><a href="mathematics.html#cb530-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-11"><a href="mathematics.html#cb530-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Closest point</span></span>
<span id="cb530-12"><a href="mathematics.html#cb530-12" aria-hidden="true" tabindex="-1"></a>fl_x2 <span class="ot">&lt;-</span> (fl_y1 <span class="sc">*</span> fl_r <span class="sc">+</span> fl_x1) <span class="sc">/</span> (fl_r<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb530-13"><a href="mathematics.html#cb530-13" aria-hidden="true" tabindex="-1"></a>fl_y2 <span class="ot">&lt;-</span> (fl_y1 <span class="sc">*</span> fl_r<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> fl_x1 <span class="sc">*</span> fl_r) <span class="sc">/</span> (fl_r<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb530-14"><a href="mathematics.html#cb530-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-15"><a href="mathematics.html#cb530-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print state</span></span>
<span id="cb530-16"><a href="mathematics.html#cb530-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;x1=&quot;</span>, fl_x1, <span class="st">&quot;x2=&quot;</span>, fl_x2, <span class="st">&quot;R=&quot;</span>, fl_r, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;x1= 1.68041526339948 x2= 3.6609038475849 R= 1.92471175687388&quot;</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="mathematics.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;x2=&quot;</span>, fl_x2, <span class="st">&quot;y2=&quot;</span>, fl_y2, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;x2= 3.6609038475849 y2= 7.04618467623146&quot;</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="mathematics.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X and y lims</span></span>
<span id="cb534-2"><a href="mathematics.html#cb534-2" aria-hidden="true" tabindex="-1"></a>ar_xylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">max</span>(fl_x1, fl_y2) <span class="sc">*</span> <span class="fl">1.5</span>)</span>
<span id="cb534-3"><a href="mathematics.html#cb534-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-4"><a href="mathematics.html#cb534-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb534-5"><a href="mathematics.html#cb534-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb534-6"><a href="mathematics.html#cb534-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Line through origin</span></span>
<span id="cb534-7"><a href="mathematics.html#cb534-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">0</span> <span class="sc">+</span> fl_r <span class="sc">*</span> x, ar_xylim[<span class="dv">1</span>], ar_xylim[<span class="dv">2</span>],</span>
<span id="cb534-8"><a href="mathematics.html#cb534-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb534-9"><a href="mathematics.html#cb534-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> ar_xylim,</span>
<span id="cb534-10"><a href="mathematics.html#cb534-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb534-11"><a href="mathematics.html#cb534-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb534-12"><a href="mathematics.html#cb534-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Diaganol line</span></span>
<span id="cb534-13"><a href="mathematics.html#cb534-13" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(fl_diag_yintercept <span class="sc">+</span> fl_diag_slope <span class="sc">*</span> x,</span>
<span id="cb534-14"><a href="mathematics.html#cb534-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb534-15"><a href="mathematics.html#cb534-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb534-16"><a href="mathematics.html#cb534-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> ar_xylim,</span>
<span id="cb534-17"><a href="mathematics.html#cb534-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb534-18"><a href="mathematics.html#cb534-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb534-19"><a href="mathematics.html#cb534-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Point</span></span>
<span id="cb534-20"><a href="mathematics.html#cb534-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(fl_x1, fl_y1,</span>
<span id="cb534-21"><a href="mathematics.html#cb534-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb534-22"><a href="mathematics.html#cb534-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb534-23"><a href="mathematics.html#cb534-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb534-24"><a href="mathematics.html#cb534-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb534-25"><a href="mathematics.html#cb534-25" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(fl_x2, fl_y2,</span>
<span id="cb534-26"><a href="mathematics.html#cb534-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb534-27"><a href="mathematics.html#cb534-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">9</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb534-28"><a href="mathematics.html#cb534-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb534-29"><a href="mathematics.html#cb534-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb534-30"><a href="mathematics.html#cb534-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Origin lines</span></span>
<span id="cb534-31"><a href="mathematics.html#cb534-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb534-32"><a href="mathematics.html#cb534-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">v =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">0</span>,</span>
<span id="cb534-33"><a href="mathematics.html#cb534-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span></span>
<span id="cb534-34"><a href="mathematics.html#cb534-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb534-35"><a href="mathematics.html#cb534-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-36"><a href="mathematics.html#cb534-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Titles</span></span>
<span id="cb534-37"><a href="mathematics.html#cb534-37" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb534-38"><a href="mathematics.html#cb534-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb534-39"><a href="mathematics.html#cb534-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Line through origin and orthogonal line</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb534-40"><a href="mathematics.html#cb534-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Find closest point along black line to red star&quot;</span></span>
<span id="cb534-41"><a href="mathematics.html#cb534-41" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb534-42"><a href="mathematics.html#cb534-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub =</span> <span class="fu">paste0</span>(</span>
<span id="cb534-43"><a href="mathematics.html#cb534-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Black line goes through origin,&quot;</span>,</span>
<span id="cb534-44"><a href="mathematics.html#cb534-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot; blue line goes through (x1,y1) and (x2, y2)&quot;</span></span>
<span id="cb534-45"><a href="mathematics.html#cb534-45" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb534-46"><a href="mathematics.html#cb534-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y values&quot;</span></span>
<span id="cb534-47"><a href="mathematics.html#cb534-47" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-261-1.png" width="504" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="linear-scalar-fx0-solutions" class="section level3" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Linear Scalar f(x)=0 Solutions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="ratio" class="section level4" number="8.1.4.1">
<h4><span class="header-section-number">8.1.4.1</span> Ratio</h4>
<p>Here are some common ratios.</p>
<div id="unif-draw-min-and-max-ratio" class="section level5" number="8.1.4.1.1">
<h5><span class="header-section-number">8.1.4.1.1</span> Unif Draw Min and Max Ratio</h5>
<p>We want to draw numbers such that we have some mean <span class="math inline">\(b\)</span>, and that the possible maximum and minimum value drawn are at most <span class="math inline">\(a\)</span> times apart. Given <span class="math inline">\(b\)</span> and <span class="math inline">\(a\)</span>, solve for <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
f(x) = \frac{b+x}{b-x} - a = 0
\]</span></p>
<p><span class="math display">\[
b \cdot a - x \cdot a = b + x \\
b \cdot a - b = x + x \cdot a  \\
b \left(a - 1\right) = x \left( a+ 1\right)  \\
x = \frac{b\left(a-1\right)}{a+1}\\
\]</span></p>
<p>Uniformly draw</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="mathematics.html#cb535-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb535-2"><a href="mathematics.html#cb535-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb535-3"><a href="mathematics.html#cb535-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> (b<span class="sc">*</span>(a<span class="dv">-1</span>))<span class="sc">/</span>(a<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb535-4"><a href="mathematics.html#cb535-4" aria-hidden="true" tabindex="-1"></a>ar_unif_draws <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min=</span>b<span class="sc">-</span>x, <span class="at">max=</span>b<span class="sc">+</span>x)</span>
<span id="cb535-5"><a href="mathematics.html#cb535-5" aria-hidden="true" tabindex="-1"></a>fl_max_min_ratio <span class="ot">&lt;-</span> <span class="fu">max</span>(ar_unif_draws)<span class="sc">/</span><span class="fu">min</span>(ar_unif_draws)</span>
<span id="cb535-6"><a href="mathematics.html#cb535-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;fl_max_min_ratio =&#39;</span>, fl_max_min_ratio, <span class="st">&#39;is close to a =&#39;</span>, a, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## fl_max_min_ratio = 1.976291 is close to a = 2</code></pre>

</div>
</div>
</div>
</div>
<div id="production-function" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Production Function</h2>

<div id="nested-ces-production-function" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Nested CES Production Function</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="the-nested-ces-problem" class="section level4" number="8.2.1.1">
<h4><span class="header-section-number">8.2.1.1</span> The Nested CES Problem</h4>
<p>We have the following production function with four inputs <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span>. There are three <span class="math inline">\(\rho\)</span> parameters <span class="math inline">\(\rho_x\)</span>, <span class="math inline">\(\rho_y\)</span> and <span class="math inline">\(\rho_o\)</span> that correspond to inner-nest and outter nest elasticity of substitution between inputs.</p>
<p>The firm’s expenditure minimization problem has the following objective:</p>
<p><span class="math display">\[
\min_{x_1, x_2, y_1, y_2} \left(
x_1 \cdot p_{x_1} + 
x_2 \cdot p_{x_2} +
y_1 \cdot p_{y_1} + 
y_2 \cdot p_{y_2}
\right)
\]</span></p>
<p>The production quantity constraint is, using a constant-returns doubly-nested production function:</p>
<p><span class="math display">\[
Y= Z \cdot 
\left(
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^\frac{1}{{\rho_x}}
\right)
^{\rho_{o}} + 
\beta_{o_2} 
\left(
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{1}{{\rho_y}}
\right)
^{\rho_{o}} 
\right)^\frac{1}{\rho_{o}}
\]</span></p>
<p>Note that we are assuming constant-returns to scale in a competitive setting, so firms do not make profits. We solve for expenditure minimization rather than profit maximization.</p>
<div id="marginal-product-of-labor" class="section level5" number="8.2.1.1.1">
<h5><span class="header-section-number">8.2.1.1.1</span> Marginal Product of Labor</h5>
<p>A key object to consider is the marginal product of input (labor or capital). Taking derivative of output <span class="math inline">\(Y\)</span> with respect to input <span class="math inline">\(x_1\)</span>, we have:</p>
<p><span class="math display">\[
\frac{\partial Y}{\partial x_1}= 
\left[
\frac{1}{\rho_{o}}
Z 
\left(
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^\frac{1}{{\rho_x}}
\right)
^{\rho_{o}} + 
\beta_{o_2} 
\left(
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{1}{{\rho_y}}
\right)
^{\rho_{o}} 
\right)^{\frac{1}{\rho_{o}} - 1}
\right]
\cdot 
\left[
\rho_{o}
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^\frac{1}{{\rho_x}}
\right)^{\rho_{o}-1}
\right]
\cdot 
\left[
  \frac{1}{{\rho_x}}
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot 
\left[
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
<p>What is the relationship between the marginal product of labor and the wage? Let <span class="math inline">\(\lambda\)</span> be the lagrange multiplier for the overall problem:</p>
<p><span class="math display">\[
p_{x_1} = \lambda \cdot \left(\frac{\partial Y}{\partial x_1}\right)
\]</span></p>
</div>
</div>
<div id="denesting-the-nested-ces-problem" class="section level4" number="8.2.1.2">
<h4><span class="header-section-number">8.2.1.2</span> Denesting the Nested CES Problem</h4>
<p>Rather than solving the problem above directly in an expenditure minimization, we can divide the problem above into three parts, the <strong>X Problem</strong>, the <strong>Y Problem</strong> and the <strong>Z Problem</strong>.</p>
<div id="three-denested-sub-problems-x-y-and-o-problems" class="section level5" number="8.2.1.2.1">
<h5><span class="header-section-number">8.2.1.2.1</span> Three Denested Sub-problems, X, Y and O Problems</h5>
<p><strong>The X problem</strong>:</p>
<p><span class="math display">\[
\min_{x_1, x_2}
\left(
x_1 \cdot p_{x_1} + 
x_2 \cdot p_{x_2}
\right)
\]</span>
<span class="math display">\[
O_x = 
\left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
\right)^\frac{1}{{\rho_x}}
\]</span></p>
<p><strong>The Y problem</strong>:</p>
<p><span class="math display">\[
\min_{y_1, y_2}
\left(
y_1 \cdot p_{y_1} + 
y_2 \cdot p_{y_2}
\right)
\]</span>
<span class="math display">\[
O_y = 
\left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
\right)^\frac{1}{{\rho_y}}
\]</span></p>
<p><strong>The O problem</strong>:</p>
<p><span class="math display">\[
\min_{o_1, o_2}
\left(
O_x \cdot p_{o_1} + 
O_y \cdot p_{o_2}
\right)
\]</span>
<span class="math display">\[
Y = 
Z\cdot\left(
    \beta_{o_1} O_x^{\rho_o} + \beta_{o_2} O_y^{\rho_o} 
\right)^\frac{1}{{\rho_o}}
\]</span></p>
</div>
<div id="marginal-product-of-labor-for-de-nested-problem" class="section level5" number="8.2.1.2.2">
<h5><span class="header-section-number">8.2.1.2.2</span> Marginal Product of Labor for De-nested Problem</h5>
<p>We can also take the derivative of the output requirement for the X problem with respect to <span class="math inline">\(x_1\)</span>, we have:</p>
<p><span class="math display">\[
\frac{\partial O_x}{\partial x_1}= 
\left[
  \frac{1}{{\rho_x}}
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot 
\left[
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
<p>Which simplifies a little bit to:
<span class="math display">\[
\frac{\partial O_x}{\partial x_1}= 
\left[
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot 
\left[
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
<p>What is the relationship between the marginal product of labor and the wage for the problem in the subnest? Let <span class="math inline">\(\lambda_x\)</span> be the lagrange multiplier for the lagrange multiplier specific to the subnest:</p>
<p><span class="math display">\[
p_{x_1} = \lambda_x \cdot \left(\frac{\partial O_x}{\partial x_1}\right)
\]</span></p>
<p>This means that we have the following FOC from solving the expenditure minimization problem:</p>
<p><span class="math display">\[
p_{x_1} = 
\lambda_x \cdot
\left[
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot 
\left[
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
</div>
</div>
<div id="solving-the-nested-ces-problem" class="section level4" number="8.2.1.3">
<h4><span class="header-section-number">8.2.1.3</span> Solving the Nested-CES Problem</h4>
<p>Conceptually, we can solve the nested-ces problem in two stages. First, given aggregate prices, solve for optimal aggregate inputs. Second, given the aggregate inputs, which are output requirements for inner nests, solve for optimal choices within nests.</p>
<p>There are two functions of interest, one function provides A</p>
</div>
<div id="identification" class="section level4" number="8.2.1.4">
<h4><span class="header-section-number">8.2.1.4</span> Identification</h4>
<div id="relative-marginal-product" class="section level5" number="8.2.1.4.1">
<h5><span class="header-section-number">8.2.1.4.1</span> Relative Marginal Product</h5>
<p>Note that <span class="math inline">\(\frac{1}{\rho} - 1 = \frac{1}{\rho} - \frac{\rho}{\rho} = \frac{1-\rho}{\rho}\)</span>, and <span class="math inline">\(x^{\frac{1-\rho}{\rho}} = \left(x^{\frac{1}{\rho}}\right)^{1-\rho}\)</span>.</p>
<p>Relative marginal product within the same sub-nest:</p>
<p><span class="math display">\[
\frac{p_{x_1}}{p_{x_2}}
=\frac{
  \frac{\partial Y}{\partial x_1}
}
{
  \frac{\partial Y}{\partial x_2}
}
=\frac{
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
}
{
  \rho_x
  \beta_{x_2} x_2^{\rho_x-1}
}
=\frac{\beta_{x_1}}{\beta_{x_2}}\cdot
\left(\frac{x_1}{x_2}\right)^{\rho_x-1}
\]</span></p>
<p>Relative marginal product across subnests:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{
  \frac{\partial Y}{\partial x_1}
}
{
  \frac{\partial Y}{\partial y_1}
}
&amp;=\frac{p_{x_1}}{p_{y_1}}
\\
\frac{
  \frac{\partial Y}{\partial x_1}
}
{
  \frac{\partial Y}{\partial y_1}
}
&amp;=\frac{
\left[
\rho_{o}
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^\frac{1}{{\rho_x}}
\right)^{\rho_{o}-1}
\right]
\cdot 
\left[
  \frac{1}{{\rho_x}}
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot 
\left[
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
\right]
}
{
\left[
\rho_{o}
\beta_{o_2}
\left(
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{1}{{\rho_y}}
\right)^{\rho_{o}-1}
\right]
\cdot 
\left[
  \frac{1}{{\rho_y}}
  \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^{\frac{1}{{\rho_y}} - 1}
\right]
\cdot 
\left[
  \rho_y
  \beta_{y_1} y_1^{\rho_y-1}
\right]
}\\
&amp;=\frac{
\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]
}
{
\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]
}
\cdot
\left[
\frac{\beta_{o_1}\beta_{x_1}}{\beta_{o_2}\beta_{y_1}}  
\right]
\cdot
\frac{
\left[
   x_1^{\rho_x-1}
\right]
}
{
\left[
   y_1^{\rho_y-1}
\right]
}
\\
\end{aligned}
\]</span></p>
<p>Note that in the equation above, the first term is the same across for the relative MPL across all within subnest terms.</p>
<p>There are four derivative ratios. First:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_1}}{p_{y_1}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_1}}{\beta_{o_2}\beta_{y_1}}\right]
\cdot
\frac{\left[x_1^{\rho_x-1}\right]}
{\left[y_1^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span>
Second:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_1}}{p_{y_2}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_1}}{\beta_{o_2}\beta_{y_2}}\right]
\cdot
\frac{\left[x_1^{\rho_x-1}\right]}
{\left[y_2^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span>
Third:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_2}}{p_{y_1}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_2}}{\beta_{o_2}\beta_{y_1}}\right]
\cdot
\frac{\left[x_2^{\rho_x-1}\right]}
{\left[y_1^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span>
Fourth:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_2}}{p_{y_2}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_2}}{\beta_{o_2}\beta_{y_2}}\right]
\cdot
\frac{\left[x_2^{\rho_x-1}\right]}
{\left[y_2^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span></p>
<p>Note that we have overall seven unknowns, three share parameters, and three elasticity parameters, and a output and productivity ratio. It looks like we have six equations, but only perhaps 3? Three of the above can not be used.</p>
</div>
<div id="identification-with-aggregate-data-over-two-periods" class="section level5" number="8.2.1.4.2">
<h5><span class="header-section-number">8.2.1.4.2</span> Identification with Aggregate Data over two Periods</h5>
<p>We say: (1) given the level of nested structure you have, what is the number of restrictions you have to impose on share or elasticity in order to fully identify the model.</p>
<p>The identification of the three share and elasticity parameters can be achieved by using the following two equations over three periods.</p>
<p><span class="math display">\[
\begin{aligned}
\log\left(\frac{p_{x_1}}{p_{x_2}}\right)
&amp;=\log\left(\frac{\beta_{x_1}}{\beta_{x_2}}\right)
+
\left(\rho_x-1\right)\cdot
\log\left(\frac{x_1}{x_2}\right)
\\
\log\left(\frac{p_{y_1}}{p_{y_2}}\right)
&amp;=\log\left(\frac{\beta_{y_1}}{\beta_{y_2}}\right)
+
\left(\rho_y-1\right)\cdot
\log\left(\frac{y_1}{y_2}\right)
\\
\log\left(\frac{p_{x_1}}{p_{y_1}}\right)
&amp;=
\log\left(
  \frac{\beta_{o_1}}{\beta_{o_2}}
  \left[
    \frac{
      \beta_{x_1} \cdot x_1^{\rho_x-1} \cdot O_y^{\rho_y}
    }{
      \beta_{y_1} \cdot y_1^{\rho_y-1} \cdot O_x^{\rho_x}
      }
  \right]
  \right)
+
\rho_o
\cdot
\log\left[
\frac{O_x}{O_y}  
  \right]
\end{aligned}
\]</span>
Note that the contents in the square brackets are data given the results from the other equations.</p>
<p>The identification of the inner-nest elasticity and share parameters is based on inner-nest quantity and relative price relationships. The relative price across nests, and the relative aggregate quantity across nets, then pin down the elasticity and share parameters across nests. In another word, within nest information on relative prices and quantity contain no information on higher nest parameters, but higher nest parameters are a function of lower nest parameters.</p>
<p>Note that for the higher nest, the intercept term is fully flexibly determined by outter nest share parameters, however, the specific translation between outter nest intercept and share values is scaled by inner-nest estimates and aggregate outputs.</p>
<p>Where
<span class="math display">\[
\begin{aligned}
  O_x &amp;= \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x} 
    \right)^{\frac{1}{{\rho_x}}}\\
  O_y &amp;= \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y} 
    \right)^\frac{1}{{\rho_y}}
\end{aligned}
\]</span></p>

</div>
</div>
</div>
</div>
<div id="inequality-models" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Inequality Models</h2>

<div id="gini-discrete-sample" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> GINI Discrete Sample</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>This works out how the <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> function works from <a href="https://fanwangecon.github.io/">Fan</a>’s <em><a href="https://fanwangecon.github.io/REconTools/">REconTools</a></em> Package.</p>
<div id="gini-formula-for-discrete-sample" class="section level4" number="8.3.1.1">
<h4><span class="header-section-number">8.3.1.1</span> GINI Formula for Discrete Sample</h4>
<p>There is an vector values (all positive). This could be height information for N individuals. It could also be income information for N individuals. Calculate the <a href="https://en.wikipedia.org/wiki/Gini_coefficient">GINI</a> coefficient treating the given vector as population. This is not an estimation exercise where we want to estimate population GINI based on a sample. The given array is the population. The population is discrete, and only has these N individuals in the length n vector.</p>
<p>Note that when the sample size is small, there is a limit to inequality using the formula defined below given each <span class="math inline">\(N\)</span>. So for small <span class="math inline">\(N\)</span>, can not really compare inequality across arrays with different <span class="math inline">\(N\)</span>, can only compare arrays with the same <span class="math inline">\(N\)</span>.</p>
<p>The GINI formula used here is:
<span class="math display">\[
 GINI =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p>Derive the formula in the steps below.</p>
<p><em>Step 1 Area Formula</em></p>
<p><span class="math display">\[
 \Gamma = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{x_j}{\sum_{\widehat{j}=1}^N x_{\widehat{j}} }
      \right)
  \right)
\]</span></p>
<p><em>Step 2 Total Area Given Perfect equality</em></p>
<p>With perfect equality <span class="math inline">\(x_i=a\)</span> for all <span class="math inline">\(i\)</span>, so need to divide by that.</p>
<p><span class="math display">\[
 \Gamma^{\text{equal}} = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{a}{\sum_{\widehat{j}=1}^N a }
      \right)
  \right)
  = \frac{N+1}{N}\cdot\frac{1}{2}
\]</span></p>
<p>As the number of elements of the vecotr increases:
<span class="math display">\[
 \lim_{N \rightarrow \infty}\Gamma^{\text{equal}}
  = \lim_{N \rightarrow \infty} \frac{N+1}{N}\cdot\frac{1}{2}
  = \frac{1}{2}
\]</span></p>
<p><em>Step 3 Arriving at Finite Vector GINI Formula</em></p>
<p>Given what we have from above, we obtain the GINI formula, divide by total area below 45 degree line.</p>
<p><span class="math display">\[
 GINI =
  1 -
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    N \cdot \sum_{i=1}^N x_i
  \right)^{-1}
  \cdot
  \left( \frac{N+1}{N}\cdot\frac{1}{2} \right)^{-1}
  =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p><em>Step 4 Maximum Inequality given N</em></p>
<p>Suppose <span class="math inline">\(x_i=0\)</span> for all <span class="math inline">\(i&lt;N\)</span>, then:</p>
<p><span class="math display">\[
 GINI^{x_i = 0 \text{ except } i=N}
 =
  1 - \frac{2}{N+1}
  \cdot
  X_N
  \cdot
  \left(
    X_N
  \right)^{-1}
 =
 1 - \frac{2}{N+1}
\]</span></p>
<p><span class="math display">\[
 \lim_{N \rightarrow \infty} GINI^{x_i = 0 \text{ except } i=N}
 =
 1 -
 \lim_{N \rightarrow \infty}
 \frac{2}{N+1}
 = 1
\]</span></p>
<p>Note that for small N, for example if <span class="math inline">\(N=10\)</span>, even when one person holds all income, all others have 0 income, the formula will not produce GINI is zero, but that GINI is equal to <span class="math inline">\(\frac{2}{11}\approx 0.1818\)</span>. If <span class="math inline">\(N=2\)</span>, inequality is at most, <span class="math inline">\(\frac{2}{3}\approx 0.667\)</span>.</p>
<p><span class="math display">\[
 MostUnequalGINI\left(N\right) = 1 - \frac{2}{N+1} = \frac{N-1}{N+1}
\]</span></p>
<div id="implement-gini-formula-for-discrete-sample" class="section level5" number="8.3.1.1.1">
<h5><span class="header-section-number">8.3.1.1.1</span> Implement GINI Formula for Discrete Sample</h5>
<p>The <strong>GINI</strong> formula just derived is trivial to compute.</p>
<ol style="list-style-type: decimal">
<li>scalar: <span class="math inline">\(\frac{2}{N+1}\)</span></li>
<li>cumsum: <span class="math inline">\(\sum_{j=1}^{i} x_j\)</span></li>
<li>sum of cumsum: <span class="math inline">\(\left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)\)</span></li>
<li>sum: <span class="math inline">\(\sum_{i=1}^N X_i\)</span></li>
</ol>
<p>There are no package dependencies. Define the formula here:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="mathematics.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula, directly implement the GINI formula Following Step 4 above</span></span>
<span id="cb537-2"><a href="mathematics.html#cb537-2" aria-hidden="true" tabindex="-1"></a>ffi_dist_gini_vector_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_pos) {</span>
<span id="cb537-3"><a href="mathematics.html#cb537-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check length and given warning</span></span>
<span id="cb537-4"><a href="mathematics.html#cb537-4" aria-hidden="true" tabindex="-1"></a>  it_n <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_pos)</span>
<span id="cb537-5"><a href="mathematics.html#cb537-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_n <span class="sc">&lt;=</span> <span class="dv">100</span>)  <span class="fu">warning</span>(<span class="st">&#39;Data vector has n=&#39;</span>,it_n,<span class="st">&#39;, max-inequality/max-gini=&#39;</span>,(it_n<span class="dv">-1</span>)<span class="sc">/</span>(it_n <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb537-6"><a href="mathematics.html#cb537-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort</span></span>
<span id="cb537-7"><a href="mathematics.html#cb537-7" aria-hidden="true" tabindex="-1"></a>  ar_pos <span class="ot">&lt;-</span> <span class="fu">sort</span>(ar_pos)</span>
<span id="cb537-8"><a href="mathematics.html#cb537-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># formula implement</span></span>
<span id="cb537-9"><a href="mathematics.html#cb537-9" aria-hidden="true" tabindex="-1"></a>  fl_gini <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="dv">2</span><span class="sc">/</span>(it_n<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_pos))<span class="sc">*</span>(<span class="fu">sum</span>(ar_pos))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb537-10"><a href="mathematics.html#cb537-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini)</span>
<span id="cb537-11"><a href="mathematics.html#cb537-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Generate a number of examples Arrays for testing</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="mathematics.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example Arrays of data</span></span>
<span id="cb538-2"><a href="mathematics.html#cb538-2" aria-hidden="true" tabindex="-1"></a>ar_equal_n1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>)</span>
<span id="cb538-3"><a href="mathematics.html#cb538-3" aria-hidden="true" tabindex="-1"></a>ar_ineql_n1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>)</span>
<span id="cb538-4"><a href="mathematics.html#cb538-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-5"><a href="mathematics.html#cb538-5" aria-hidden="true" tabindex="-1"></a>ar_equal_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb538-6"><a href="mathematics.html#cb538-6" aria-hidden="true" tabindex="-1"></a>ar_ineql_alittle_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb538-7"><a href="mathematics.html#cb538-7" aria-hidden="true" tabindex="-1"></a>ar_ineql_somewht_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb538-8"><a href="mathematics.html#cb538-8" aria-hidden="true" tabindex="-1"></a>ar_ineql_alotine_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb538-9"><a href="mathematics.html#cb538-9" aria-hidden="true" tabindex="-1"></a>ar_ineql_veryvry_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">8</span>)</span>
<span id="cb538-10"><a href="mathematics.html#cb538-10" aria-hidden="true" tabindex="-1"></a>ar_ineql_mostmst_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">13</span>)</span>
<span id="cb538-11"><a href="mathematics.html#cb538-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-12"><a href="mathematics.html#cb538-12" aria-hidden="true" tabindex="-1"></a>ar_equal_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb538-13"><a href="mathematics.html#cb538-13" aria-hidden="true" tabindex="-1"></a>ar_ineql_some_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">21</span>,<span class="dv">34</span>,<span class="dv">55</span>,<span class="dv">89</span>)</span>
<span id="cb538-14"><a href="mathematics.html#cb538-14" aria-hidden="true" tabindex="-1"></a>ar_ineql_very_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">8</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">13</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">21</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">34</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">55</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">89</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb538-15"><a href="mathematics.html#cb538-15" aria-hidden="true" tabindex="-1"></a>ar_ineql_extr_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">^</span><span class="dv">3</span>,<span class="dv">5</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">^</span><span class="dv">5</span>,<span class="dv">13</span><span class="sc">^</span><span class="dv">6</span>,<span class="dv">21</span><span class="sc">^</span><span class="dv">7</span>,<span class="dv">34</span><span class="sc">^</span><span class="dv">8</span>,<span class="dv">55</span><span class="sc">^</span><span class="dv">9</span>,<span class="dv">89</span><span class="sc">^</span><span class="dv">10</span>)</span></code></pre></div>
<p>Now test the example arrays above using the function based no our formula:</p>
<pre><code>## 
## Small N=1 Hard-Code</code></pre>
<pre><code>## ar_equal_n1: 0</code></pre>
<pre><code>## ar_ineql_n1: 0</code></pre>
<pre><code>## 
## Small N=2 Hard-Code, converge to 1/3, see formula above</code></pre>
<pre><code>## ar_ineql_alittle_n2: 0.1111111</code></pre>
<pre><code>## ar_ineql_somewht_n2: 0.2592593</code></pre>
<pre><code>## ar_ineql_alotine_n2: 0.3131313</code></pre>
<pre><code>## ar_ineql_veryvry_n2: 0.3307393</code></pre>
<pre><code>## 
## Small N=10 Hard-Code, convege to 9/11=0.8181, see formula above</code></pre>
<pre><code>## ar_equal_n10: 0</code></pre>
<pre><code>## ar_ineql_some_n10: 0.5395514</code></pre>
<pre><code>## ar_ineql_very_n10: 0.7059554</code></pre>
<pre><code>## ar_ineql_extr_n10: 0.8181549</code></pre>
</div>
</div>
</div>
<div id="gini-formula-for-discrete-random-varialbe" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> GINI Formula for Discrete Random Varialbe</h3>
<p>For a discrete random variable, we are two arrays, an array of <span class="math inline">\(x\)</span> values, and an array of <span class="math inline">\(f(x)\)</span> probability mass at each <span class="math inline">\(x\)</span> value. Suppose the <span class="math inline">\(x\)</span> values are unique/non-repeating. This is also Implemented in <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> with the <a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/stats/ff_disc_rand_var_gini.m">ff_disc_rand_var_gini</a> function.</p>
<p>Generate two arrays for <span class="math inline">\(x\)</span> and <span class="math inline">\(f(x)\)</span>, we will use the <a href="https://fanwangecon.github.io/Stat4Econ/probability_discrete/htmlpdfr/binomial.html">binomial distribution</a>:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="mathematics.html#cb552-1" aria-hidden="true" tabindex="-1"></a>ar_choice_unique_sorted <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb552-2"><a href="mathematics.html#cb552-2" aria-hidden="true" tabindex="-1"></a>ar_choice_prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_choice_unique_sorted, <span class="dv">100</span>, <span class="fl">0.01</span>)</span></code></pre></div>
<p>Generate mean and cumulative mean at each point:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="mathematics.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. to normalize, get mean (binomial so mean is p*N=50)</span></span>
<span id="cb553-2"><a href="mathematics.html#cb553-2" aria-hidden="true" tabindex="-1"></a>fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_unique_sorted<span class="sc">*</span>ar_choice_prob);</span>
<span id="cb553-3"><a href="mathematics.html#cb553-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. get cumulative mean at each point</span></span>
<span id="cb553-4"><a href="mathematics.html#cb553-4" aria-hidden="true" tabindex="-1"></a>ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_choice_unique_sorted<span class="sc">*</span>ar_choice_prob);</span></code></pre></div>
<p>Normalizing and area calculation, following the same principle as above:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="mathematics.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Share of wealth (income etc) accounted for up to this sorted type</span></span>
<span id="cb554-2"><a href="mathematics.html#cb554-2" aria-hidden="true" tabindex="-1"></a>ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb554-3"><a href="mathematics.html#cb554-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. The total area, is the each height times each width summed up</span></span>
<span id="cb554-4"><a href="mathematics.html#cb554-4" aria-hidden="true" tabindex="-1"></a>fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_prob<span class="sc">*</span>ar_height);</span></code></pre></div>
<p>Finally GINI coefficient:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="mathematics.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. area below 45 degree line might not be 1/2, depends on discretness</span></span>
<span id="cb555-2"><a href="mathematics.html#cb555-2" aria-hidden="true" tabindex="-1"></a>fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_prob<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_choice_prob)<span class="sc">/</span><span class="fu">sum</span>(ar_choice_prob)))</span>
<span id="cb555-3"><a href="mathematics.html#cb555-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-4"><a href="mathematics.html#cb555-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Gini is the distance between</span></span>
<span id="cb555-5"><a href="mathematics.html#cb555-5" aria-hidden="true" tabindex="-1"></a>fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb555-6"><a href="mathematics.html#cb555-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gini_index=&#39;</span>, fl_gini_index))</span></code></pre></div>
<pre><code>## [1] &quot;fl_gini_index=0.468573066002754&quot;</code></pre>
<div id="discrete-random-variable-as-function" class="section level4" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Discrete Random Variable as Function</h4>
<p>Organizing the code above as a function, and testing results out with the <a href="https://fanwangecon.github.io/Stat4Econ/probability_discrete/htmlpdfr/binomial.html">binomial distribution</a> as an example.</p>
<p>For the binomial distribution, if the probability of success is very close to zero, that means nearly all mass is at lose all or nearly losing all. There will be non-zero but very small mass at higher levels of wins. Hence this should mean extreme inequality. GINI index should be close to 1. Alternatively, GINI index should be close to 0 when we have near 100 percent chance of success, then all mass is at winning all, perfect equality.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="mathematics.html#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining the code from above</span></span>
<span id="cb557-2"><a href="mathematics.html#cb557-2" aria-hidden="true" tabindex="-1"></a>ffi_dist_gini_random_var_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_x_sorted, ar_prob_of_x) {</span>
<span id="cb557-3"><a href="mathematics.html#cb557-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param ar_x_sorted sorted array of values</span></span>
<span id="cb557-4"><a href="mathematics.html#cb557-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param ar_prob_of_x probability mass for each element along `ar_x_sorted`, sums to 1</span></span>
<span id="cb557-5"><a href="mathematics.html#cb557-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-6"><a href="mathematics.html#cb557-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. to normalize, get mean (binomial so mean is p*N=50)</span></span>
<span id="cb557-7"><a href="mathematics.html#cb557-7" aria-hidden="true" tabindex="-1"></a>  fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb557-8"><a href="mathematics.html#cb557-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. get cumulative mean at each point</span></span>
<span id="cb557-9"><a href="mathematics.html#cb557-9" aria-hidden="true" tabindex="-1"></a>  ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb557-10"><a href="mathematics.html#cb557-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Share of wealth (income etc) accounted for up to this sorted type</span></span>
<span id="cb557-11"><a href="mathematics.html#cb557-11" aria-hidden="true" tabindex="-1"></a>  ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb557-12"><a href="mathematics.html#cb557-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. The total area, is the each height times each width summed up</span></span>
<span id="cb557-13"><a href="mathematics.html#cb557-13" aria-hidden="true" tabindex="-1"></a>  fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>ar_height);</span>
<span id="cb557-14"><a href="mathematics.html#cb557-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5. area below 45 degree line might not be 1/2, depends on discretness</span></span>
<span id="cb557-15"><a href="mathematics.html#cb557-15" aria-hidden="true" tabindex="-1"></a>  fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_prob_of_x)<span class="sc">/</span><span class="fu">sum</span>(ar_prob_of_x)))</span>
<span id="cb557-16"><a href="mathematics.html#cb557-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6. Gini is the distance between</span></span>
<span id="cb557-17"><a href="mathematics.html#cb557-17" aria-hidden="true" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb557-18"><a href="mathematics.html#cb557-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-19"><a href="mathematics.html#cb557-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini_index)</span>
<span id="cb557-20"><a href="mathematics.html#cb557-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Testing the function with the Binomial Distribution:</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="mathematics.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (fl_binom_success_prob <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.0001</span>,<span class="fl">0.9999</span>,<span class="at">length.out=</span><span class="dv">10</span>)) {</span>
<span id="cb558-2"><a href="mathematics.html#cb558-2" aria-hidden="true" tabindex="-1"></a>  ar_x_sorted <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb558-3"><a href="mathematics.html#cb558-3" aria-hidden="true" tabindex="-1"></a>  ar_prob_of_x <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_x_sorted, <span class="dv">100</span>, fl_binom_success_prob)</span>
<span id="cb558-4"><a href="mathematics.html#cb558-4" aria-hidden="true" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> <span class="fu">ffi_dist_gini_random_var_pos_test</span>(ar_x_sorted, ar_prob_of_x)</span>
<span id="cb558-5"><a href="mathematics.html#cb558-5" aria-hidden="true" tabindex="-1"></a>  st_print <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;binom p(success)=&#39;</span>, fl_binom_success_prob ,</span>
<span id="cb558-6"><a href="mathematics.html#cb558-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;, the fl_gini_index=&#39;</span>, fl_gini_index)</span>
<span id="cb558-7"><a href="mathematics.html#cb558-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(st_print)</span>
<span id="cb558-8"><a href="mathematics.html#cb558-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;binom p(success)=1e-04, the fl_gini_index=0.990048846889393&quot;
## [1] &quot;binom p(success)=0.111188888888889, the fl_gini_index=0.147061101509638&quot;
## [1] &quot;binom p(success)=0.222277777777778, the fl_gini_index=0.0989942681255604&quot;
## [1] &quot;binom p(success)=0.333366666666667, the fl_gini_index=0.0753059593394789&quot;
## [1] &quot;binom p(success)=0.444455555555556, the fl_gini_index=0.0596495299535176&quot;
## [1] &quot;binom p(success)=0.555544444444444, the fl_gini_index=0.0476678493269222&quot;
## [1] &quot;binom p(success)=0.666633333333333, the fl_gini_index=0.0375168214334586&quot;
## [1] &quot;binom p(success)=0.777722222222222, the fl_gini_index=0.0280646430085938&quot;
## [1] &quot;binom p(success)=0.888811111111111, the fl_gini_index=0.0180312757603542&quot;
## [1] &quot;binom p(success)=0.9999, the fl_gini_index=9.90197372312816e-07&quot;</code></pre>
</div>
<div id="compare-discrete-sample-and-discrete-random-variable-functions-for-gini" class="section level4" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Compare Discrete Sample and Discrete Random Variable Functions for GINI</h4>
<p><a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> provides the GINI implementation for a discrete random variable. The procedure is the same as prior, except now each element of the “x” array has element specific weights associated with it. The function can handle unsorted array with non-unique values.</p>
<p>Test and compare <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> provides the GINI implementation for a discrete random variable and <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a>.</p>
<p>There is a vector of values from 1 to 100, in ascending order. What is the equal-weighted gini, the gini result when smaller numbers have higher weights, and when larger numbers have higher weights?</p>
<p>First, generate the relevant values.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="mathematics.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># array</span></span>
<span id="cb560-2"><a href="mathematics.html#cb560-2" aria-hidden="true" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">30</span>)</span>
<span id="cb560-3"><a href="mathematics.html#cb560-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prob array</span></span>
<span id="cb560-4"><a href="mathematics.html#cb560-4" aria-hidden="true" tabindex="-1"></a>ar_prob_x_unif <span class="ot">&lt;-</span> <span class="fu">rep.int</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_x))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">rep.int</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_x)))</span>
<span id="cb560-5"><a href="mathematics.html#cb560-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prob higher at lower values</span></span>
<span id="cb560-6"><a href="mathematics.html#cb560-6" aria-hidden="true" tabindex="-1"></a>ar_prob_x_lowval_highwgt <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))</span>
<span id="cb560-7"><a href="mathematics.html#cb560-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prob higher at lower values</span></span>
<span id="cb560-8"><a href="mathematics.html#cb560-8" aria-hidden="true" tabindex="-1"></a>ar_prob_x_highval_highwgt <span class="ot">&lt;-</span> (<span class="fu">cumsum</span>(ar_prob_x_unif))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))</span>
<span id="cb560-9"><a href="mathematics.html#cb560-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb560-10"><a href="mathematics.html#cb560-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">cbind</span>(ar_x, ar_prob_x_unif, ar_prob_x_lowval_highwgt, ar_prob_x_highval_highwgt)) <span class="sc">%&gt;%</span></span>
<span id="cb560-11"><a href="mathematics.html#cb560-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_unif
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_lowval_highwgt
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_highval_highwgt
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0645161
</td>
<td style="text-align:right;">
0.0021505
</td>
</tr>
<tr>
<td style="text-align:right;">
4.413793
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0623656
</td>
<td style="text-align:right;">
0.0043011
</td>
</tr>
<tr>
<td style="text-align:right;">
7.827586
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0602151
</td>
<td style="text-align:right;">
0.0064516
</td>
</tr>
<tr>
<td style="text-align:right;">
11.241379
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0580645
</td>
<td style="text-align:right;">
0.0086022
</td>
</tr>
<tr>
<td style="text-align:right;">
14.655172
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0559140
</td>
<td style="text-align:right;">
0.0107527
</td>
</tr>
<tr>
<td style="text-align:right;">
18.068966
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0537634
</td>
<td style="text-align:right;">
0.0129032
</td>
</tr>
<tr>
<td style="text-align:right;">
21.482759
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0516129
</td>
<td style="text-align:right;">
0.0150538
</td>
</tr>
<tr>
<td style="text-align:right;">
24.896552
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0494624
</td>
<td style="text-align:right;">
0.0172043
</td>
</tr>
<tr>
<td style="text-align:right;">
28.310345
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0473118
</td>
<td style="text-align:right;">
0.0193548
</td>
</tr>
<tr>
<td style="text-align:right;">
31.724138
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0451613
</td>
<td style="text-align:right;">
0.0215054
</td>
</tr>
<tr>
<td style="text-align:right;">
35.137931
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0430108
</td>
<td style="text-align:right;">
0.0236559
</td>
</tr>
<tr>
<td style="text-align:right;">
38.551724
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0408602
</td>
<td style="text-align:right;">
0.0258065
</td>
</tr>
<tr>
<td style="text-align:right;">
41.965517
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0387097
</td>
<td style="text-align:right;">
0.0279570
</td>
</tr>
<tr>
<td style="text-align:right;">
45.379310
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0365591
</td>
<td style="text-align:right;">
0.0301075
</td>
</tr>
<tr>
<td style="text-align:right;">
48.793103
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0344086
</td>
<td style="text-align:right;">
0.0322581
</td>
</tr>
<tr>
<td style="text-align:right;">
52.206897
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0322581
</td>
<td style="text-align:right;">
0.0344086
</td>
</tr>
<tr>
<td style="text-align:right;">
55.620690
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0301075
</td>
<td style="text-align:right;">
0.0365591
</td>
</tr>
<tr>
<td style="text-align:right;">
59.034483
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0279570
</td>
<td style="text-align:right;">
0.0387097
</td>
</tr>
<tr>
<td style="text-align:right;">
62.448276
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0258065
</td>
<td style="text-align:right;">
0.0408602
</td>
</tr>
<tr>
<td style="text-align:right;">
65.862069
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0236559
</td>
<td style="text-align:right;">
0.0430108
</td>
</tr>
<tr>
<td style="text-align:right;">
69.275862
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0215054
</td>
<td style="text-align:right;">
0.0451613
</td>
</tr>
<tr>
<td style="text-align:right;">
72.689655
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0193548
</td>
<td style="text-align:right;">
0.0473118
</td>
</tr>
<tr>
<td style="text-align:right;">
76.103448
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0172043
</td>
<td style="text-align:right;">
0.0494624
</td>
</tr>
<tr>
<td style="text-align:right;">
79.517241
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0150538
</td>
<td style="text-align:right;">
0.0516129
</td>
</tr>
<tr>
<td style="text-align:right;">
82.931034
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0129032
</td>
<td style="text-align:right;">
0.0537634
</td>
</tr>
<tr>
<td style="text-align:right;">
86.344828
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0107527
</td>
<td style="text-align:right;">
0.0559140
</td>
</tr>
<tr>
<td style="text-align:right;">
89.758621
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0086022
</td>
<td style="text-align:right;">
0.0580645
</td>
</tr>
<tr>
<td style="text-align:right;">
93.172414
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0064516
</td>
<td style="text-align:right;">
0.0602151
</td>
</tr>
<tr>
<td style="text-align:right;">
96.586207
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0043011
</td>
<td style="text-align:right;">
0.0623656
</td>
</tr>
<tr>
<td style="text-align:right;">
100.000000
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0021505
</td>
<td style="text-align:right;">
0.0645161
</td>
</tr>
</tbody>
</table>
<p>Second, generate GINI values. What should happen?</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> and <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> results should be the same when the uniform distribution is used.</li>
<li>GINI should be higher, more inequality, if there is higher weights on the lower values.</li>
<li>GINI should be lower, more equality, if there is higher weight on the higher values.</li>
</ol>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="mathematics.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_vector_pos</span>(ar_x)</span></code></pre></div>
<pre><code>## [1] 0.3267327</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="mathematics.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_unif)</span></code></pre></div>
<pre><code>## [1] 0.3267327</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="mathematics.html#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_lowval_highwgt)</span></code></pre></div>
<pre><code>## [1] 0.4010343</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="mathematics.html#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_highval_highwgt)</span></code></pre></div>
<pre><code>## [1] 0.1926849</code></pre>

</div>
</div>
<div id="atkinson-inequality-index" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Atkinson Inequality Index</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="atkinson-inequality-measures" class="section level4" number="8.3.3.1">
<h4><span class="header-section-number">8.3.3.1</span> Atkinson Inequality Measures</h4>
<p><a href="https://linkinghub.elsevier.com/retrieve/pii/0022053170900396">Atkinson (JET, 1970)</a> studies five standard inequality measures. Atkinson finds that given the same income data across countries, different inequality measure lead to different rankings of which country is more unequal. Atkinson develops an measure of inequality that changes depending on an inequality aversion parameter.</p>
<p><span class="math display">\[
\text{Atkinson Inequality} =
A\left(
\left\{Y_i\right\}_{i=1}^N,
\lambda
\right)
= 1 -
\left(
\sum_{i=1}^N \frac{1}{N}
  \left(
    \frac{Y_i}{\sum_{j=1}^N \left( \frac{Y_j}{N} \right) }
  \right)^{\lambda}
\right)^{\frac{1}{\lambda}}
\in \left[0,1\right]
\]</span></p>
<p><span class="math inline">\(A\left(\left\{Y_i\right\}_{i=1}^N,\lambda\right)\)</span> equals to zero is perfect equality. 1 is Perfect inequality. If <span class="math inline">\(\lambda=1\)</span>, the inequality measure is always equal to 0 because the planner does not care abouot inequality anymore.</p>
</div>
<div id="atkinson-inequality-function" class="section level4" number="8.3.3.2">
<h4><span class="header-section-number">8.3.3.2</span> Atkinson Inequality Function</h4>
<p>Programming up the equation above, we have, given a sample of data:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="mathematics.html#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb569-2"><a href="mathematics.html#cb569-2" aria-hidden="true" tabindex="-1"></a>ffi_atkinson_ineq <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_data, fl_rho) {</span>
<span id="cb569-3"><a href="mathematics.html#cb569-3" aria-hidden="true" tabindex="-1"></a>  ar_data_demean <span class="ot">&lt;-</span> ar_data<span class="sc">/</span><span class="fu">mean</span>(ar_data)</span>
<span id="cb569-4"><a href="mathematics.html#cb569-4" aria-hidden="true" tabindex="-1"></a>  it_len <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_data_demean)</span>
<span id="cb569-5"><a href="mathematics.html#cb569-5" aria-hidden="true" tabindex="-1"></a>  fl_atkinson <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(ar_data_demean<span class="sc">^</span>{fl_rho}<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>it_len))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>fl_rho)</span>
<span id="cb569-6"><a href="mathematics.html#cb569-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_atkinson)</span>
<span id="cb569-7"><a href="mathematics.html#cb569-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>When each element of the data array has weight, we have:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="mathematics.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb570-2"><a href="mathematics.html#cb570-2" aria-hidden="true" tabindex="-1"></a>ffi_atkinson_random_var_ineq <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_data, ar_prob_data, fl_rho) {</span>
<span id="cb570-3"><a href="mathematics.html#cb570-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param ar_data array sorted array values</span></span>
<span id="cb570-4"><a href="mathematics.html#cb570-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param ar_prob_data array probability mass for each element along `ar_data`, sums to 1</span></span>
<span id="cb570-5"><a href="mathematics.html#cb570-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; @param fl_rho float inequality aversion parameter fl_rho = 1 for planner</span></span>
<span id="cb570-6"><a href="mathematics.html#cb570-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; without inequality aversion. fl_rho = -infinity for fully inequality averse.</span></span>
<span id="cb570-7"><a href="mathematics.html#cb570-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-8"><a href="mathematics.html#cb570-8" aria-hidden="true" tabindex="-1"></a>  fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_data<span class="sc">*</span>ar_prob_data);</span>
<span id="cb570-9"><a href="mathematics.html#cb570-9" aria-hidden="true" tabindex="-1"></a>  fl_atkinson <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="fu">sum</span>(ar_prob_data<span class="sc">*</span>(ar_data<span class="sc">^</span>{fl_rho}))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>fl_rho))<span class="sc">/</span>fl_mean</span>
<span id="cb570-10"><a href="mathematics.html#cb570-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_atkinson)</span>
<span id="cb570-11"><a href="mathematics.html#cb570-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="atkinson-inequality-examples" class="section level4" number="8.3.3.3">
<h4><span class="header-section-number">8.3.3.3</span> Atkinson Inequality Examples</h4>
<p>Given a vector of observables, compute the Atkinson inequality measure given different inequality aversion.</p>
<div id="data-samples-and-weighted-data" class="section level5" number="8.3.3.3.1">
<h5><span class="header-section-number">8.3.3.3.1</span> Data Samples and Weighted Data</h5>
<p>The <span class="math inline">\(\rho\)</span> preference vector.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="mathematics.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preference Vector</span></span>
<span id="cb571-2"><a href="mathematics.html#cb571-2" aria-hidden="true" tabindex="-1"></a>ar_rho <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.0</span>,<span class="fl">2.0</span>, <span class="at">length.out=</span><span class="dv">30</span>))))</span>
<span id="cb571-3"><a href="mathematics.html#cb571-3" aria-hidden="true" tabindex="-1"></a>ar_rho <span class="ot">&lt;-</span> <span class="fu">unique</span>(ar_rho)</span>
<span id="cb571-4"><a href="mathematics.html#cb571-4" aria-hidden="true" tabindex="-1"></a>mt_rho <span class="ot">&lt;-</span> <span class="fu">matrix</span>(ar_rho, <span class="at">nrow=</span><span class="fu">length</span>(ar_rho), <span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p>Sampled version for <span class="math inline">\(N\)</span> sampled points, random, uniform and one-rich.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="mathematics.html#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random normal Data Vector (not equal outcomes)</span></span>
<span id="cb572-2"><a href="mathematics.html#cb572-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb572-3"><a href="mathematics.html#cb572-3" aria-hidden="true" tabindex="-1"></a>it_sample_N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb572-4"><a href="mathematics.html#cb572-4" aria-hidden="true" tabindex="-1"></a>fl_rnorm_mean <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb572-5"><a href="mathematics.html#cb572-5" aria-hidden="true" tabindex="-1"></a>fl_rnorm_sd <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb572-6"><a href="mathematics.html#cb572-6" aria-hidden="true" tabindex="-1"></a>ar_data_rnorm <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(it_sample_N, <span class="at">mean=</span>fl_rnorm_mean, <span class="at">sd=</span>fl_rnorm_sd)</span>
<span id="cb572-7"><a href="mathematics.html#cb572-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Uniform Data Vector (Equal)</span></span>
<span id="cb572-8"><a href="mathematics.html#cb572-8" aria-hidden="true" tabindex="-1"></a>ar_data_unif <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_data_rnorm))</span>
<span id="cb572-9"><a href="mathematics.html#cb572-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-10"><a href="mathematics.html#cb572-10" aria-hidden="true" tabindex="-1"></a><span class="co"># One Rich (last person has income equal to the sum of all others*100)</span></span>
<span id="cb572-11"><a href="mathematics.html#cb572-11" aria-hidden="true" tabindex="-1"></a>ar_data_onerich <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="fu">length</span>(ar_data_rnorm))</span>
<span id="cb572-12"><a href="mathematics.html#cb572-12" aria-hidden="true" tabindex="-1"></a>ar_data_onerich[<span class="fu">length</span>(ar_data_onerich)] <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">head</span>(ar_data_onerich,<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<p>Given the same distributions, random, uniform and one-rich, generate discrete random variable versions below. We approximate <a href="https://fanwangecon.github.io/R4Econ/statistics/discrandvar/htmlpdfr/fs_disc_approx_cts.html">continuous normal with discrete binomial</a>:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="mathematics.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use binomial to approximate normal</span></span>
<span id="cb573-2"><a href="mathematics.html#cb573-2" aria-hidden="true" tabindex="-1"></a>fl_p_binom <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>fl_rnorm_mean</span>
<span id="cb573-3"><a href="mathematics.html#cb573-3" aria-hidden="true" tabindex="-1"></a>fl_n_binom <span class="ot">&lt;-</span> <span class="fu">round</span>(fl_rnorm_mean<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(fl_rnorm_mean <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb573-4"><a href="mathematics.html#cb573-4" aria-hidden="true" tabindex="-1"></a>fl_binom_mean <span class="ot">&lt;-</span> fl_n_binom<span class="sc">*</span>fl_p_binom</span>
<span id="cb573-5"><a href="mathematics.html#cb573-5" aria-hidden="true" tabindex="-1"></a>fl_binom_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(fl_n_binom<span class="sc">*</span>fl_p_binom<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_p_binom))</span>
<span id="cb573-6"><a href="mathematics.html#cb573-6" aria-hidden="true" tabindex="-1"></a><span class="co"># drv = discrete random variable</span></span>
<span id="cb573-7"><a href="mathematics.html#cb573-7" aria-hidden="true" tabindex="-1"></a>ar_drv_rbinom_xval <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, fl_n_binom)</span>
<span id="cb573-8"><a href="mathematics.html#cb573-8" aria-hidden="true" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_drv_rbinom_xval, <span class="at">size=</span>fl_n_binom, <span class="at">prob=</span>fl_p_binom)</span>
<span id="cb573-9"><a href="mathematics.html#cb573-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore weight at x=0</span></span>
<span id="cb573-10"><a href="mathematics.html#cb573-10" aria-hidden="true" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> ar_drv_rbinom_prob<span class="sc">/</span><span class="fu">sum</span>(ar_drv_rbinom_prob)</span></code></pre></div>
<p>Additionally, for the one-rich vector created earlier, now consider several probability mass over them, change the weight assigned to the richest person.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="mathematics.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This should be the same as the unweighted version</span></span>
<span id="cb574-2"><a href="mathematics.html#cb574-2" aria-hidden="true" tabindex="-1"></a>ar_drv_onerich_prob_unif <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>it_sample_N, it_sample_N)</span>
<span id="cb574-3"><a href="mathematics.html#cb574-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This puts almost no weight on the last rich person</span></span>
<span id="cb574-4"><a href="mathematics.html#cb574-4" aria-hidden="true" tabindex="-1"></a><span class="co"># richlswgt = rich less weight</span></span>
<span id="cb574-5"><a href="mathematics.html#cb574-5" aria-hidden="true" tabindex="-1"></a>ar_drv_onerich_prob_richlswgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_unif</span>
<span id="cb574-6"><a href="mathematics.html#cb574-6" aria-hidden="true" tabindex="-1"></a>ar_drv_onerich_prob_richlswgt[it_sample_N] <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>it_sample_N)<span class="sc">*</span><span class="fl">0.1</span></span>
<span id="cb574-7"><a href="mathematics.html#cb574-7" aria-hidden="true" tabindex="-1"></a>ar_drv_onerich_prob_richlswgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_richlswgt<span class="sc">/</span><span class="fu">sum</span>(ar_drv_onerich_prob_richlswgt)</span>
<span id="cb574-8"><a href="mathematics.html#cb574-8" aria-hidden="true" tabindex="-1"></a><span class="co"># This puts more weight on the rich person</span></span>
<span id="cb574-9"><a href="mathematics.html#cb574-9" aria-hidden="true" tabindex="-1"></a><span class="co"># richmrwgt = rich more weight</span></span>
<span id="cb574-10"><a href="mathematics.html#cb574-10" aria-hidden="true" tabindex="-1"></a>ar_drv_onerich_prob_richmrwgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_unif</span>
<span id="cb574-11"><a href="mathematics.html#cb574-11" aria-hidden="true" tabindex="-1"></a>ar_drv_onerich_prob_richmrwgt[it_sample_N] <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>it_sample_N)<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb574-12"><a href="mathematics.html#cb574-12" aria-hidden="true" tabindex="-1"></a>ar_drv_onerich_prob_richmrwgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_richmrwgt<span class="sc">/</span><span class="fu">sum</span>(ar_drv_onerich_prob_richmrwgt)</span></code></pre></div>
</div>
<div id="testing-atkinson-index-at-single-rho-value" class="section level5" number="8.3.3.3.2">
<h5><span class="header-section-number">8.3.3.3.2</span> Testing Atkinson Index at Single rho Value</h5>
<p>Atkinson index with <span class="math inline">\(\rho=-1\)</span>, which is a planner with some aversion towards inequality, this is equivalent to CRRA=2.</p>
<p>Testing with normal sample draw vs normal approximated with binomial discrete random variable:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="mathematics.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.05372126</span></span>
<span id="cb575-2"><a href="mathematics.html#cb575-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_rnorm, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.00335581</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="mathematics.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.03443246</span></span>
<span id="cb577-2"><a href="mathematics.html#cb577-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_drv_rbinom_xval, ar_drv_rbinom_prob, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.003642523</code></pre>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="mathematics.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0</span></span>
<span id="cb579-2"><a href="mathematics.html#cb579-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Testing with</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="mathematics.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.89, sample</span></span>
<span id="cb581-2"><a href="mathematics.html#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_onerich, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.9027248</code></pre>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="mathematics.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.89, drv, uniform weight</span></span>
<span id="cb583-2"><a href="mathematics.html#cb583-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_data_onerich, ar_drv_onerich_prob_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.9027248</code></pre>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="mathematics.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.49, drv, less weight on rich</span></span>
<span id="cb585-2"><a href="mathematics.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_data_onerich, ar_drv_onerich_prob_richlswgt, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.4965518</code></pre>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="mathematics.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.97, drv, more weight on rich</span></span>
<span id="cb587-2"><a href="mathematics.html#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_data_onerich, ar_drv_onerich_prob_richmrwgt, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.9821147</code></pre>
<p>Create vector of inequality aversion parameters and graph legends.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="mathematics.html#cb589-1" aria-hidden="true" tabindex="-1"></a>ar_log_1_minus_rho <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>ar_rho)</span>
<span id="cb589-2"><a href="mathematics.html#cb589-2" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;log(1-rho), rho is Planner</span><span class="sc">\&#39;</span><span class="st">s Inequality Aversion</span><span class="sc">\n</span><span class="st">Efficiency (rho=0.99, left); log utility (rho = 0, middle); Equality (rho=-99, right)&#39;</span></span>
<span id="cb589-3"><a href="mathematics.html#cb589-3" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;Index: 0 = Total Equality, 1 = Total Inequality&#39;</span></span></code></pre></div>
</div>
<div id="atkinson-inequality-and-normally-distributed-data" class="section level5" number="8.3.3.3.3">
<h5><span class="header-section-number">8.3.3.3.3</span> Atkinson Inequality and Normally Distributed Data</h5>
<p>How does Atkinson Inequality measure change with respect to a vector of normal random data as inequality aversion shifts? Note that in the example below, the bionomial approximated version is very similar to the normally drawn sample version. until rho beocmes very negative.</p>
<p>At very negative rho values, the binomial approximation has very tiny, but positive mass for all small values starting from 0, the normally drawn sample has no mass at those points. The Atkinson inequality planner increasingly only cares about the individual with the lowest value from the binomial approximated version, and given the low value of those individuals compared to others, despite having no mass, the inequality index is almost 1.</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="mathematics.html#cb590-1" aria-hidden="true" tabindex="-1"></a>ar_ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb590-2"><a href="mathematics.html#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First line</span></span>
<span id="cb590-3"><a href="mathematics.html#cb590-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span>
<span id="cb590-4"><a href="mathematics.html#cb590-4" aria-hidden="true" tabindex="-1"></a>ar_atkinson_sample <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){</span>
<span id="cb590-5"><a href="mathematics.html#cb590-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ffi_atkinson_ineq</span>(ar_data_rnorm, row[<span class="dv">1</span>])})</span>
<span id="cb590-6"><a href="mathematics.html#cb590-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_sample,</span>
<span id="cb590-7"><a href="mathematics.html#cb590-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb590-8"><a href="mathematics.html#cb590-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb590-9"><a href="mathematics.html#cb590-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Second line</span></span>
<span id="cb590-10"><a href="mathematics.html#cb590-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb590-11"><a href="mathematics.html#cb590-11" aria-hidden="true" tabindex="-1"></a>ar_atkinson_drv <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){</span>
<span id="cb590-12"><a href="mathematics.html#cb590-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ffi_atkinson_random_var_ineq</span>(ar_drv_rbinom_xval, ar_drv_rbinom_prob, row[<span class="dv">1</span>])})</span>
<span id="cb590-13"><a href="mathematics.html#cb590-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv,</span>
<span id="cb590-14"><a href="mathematics.html#cb590-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb590-15"><a href="mathematics.html#cb590-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb590-16"><a href="mathematics.html#cb590-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Title</span></span>
<span id="cb590-17"><a href="mathematics.html#cb590-17" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;Atkinson Inequality and Random data&#39;</span>,</span>
<span id="cb590-18"><a href="mathematics.html#cb590-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub =</span> <span class="st">&#39;Red Line=sample, Blue Dots=discrete random variable&#39;</span>)</span>
<span id="cb590-19"><a href="mathematics.html#cb590-19" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-287-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="atkinson-inequality-with-an-extremely-wealthy-individual" class="section level5" number="8.3.3.3.4">
<h5><span class="header-section-number">8.3.3.3.4</span> Atkinson Inequality with an Extremely Wealthy Individual</h5>
<p>Now with the one person has the wealth of all others in the vector times 10.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="mathematics.html#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First line</span></span>
<span id="cb591-2"><a href="mathematics.html#cb591-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span>
<span id="cb591-3"><a href="mathematics.html#cb591-3" aria-hidden="true" tabindex="-1"></a>ar_atkinson <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_ineq</span>(</span>
<span id="cb591-4"><a href="mathematics.html#cb591-4" aria-hidden="true" tabindex="-1"></a>  ar_data_onerich, row[<span class="dv">1</span>])})</span>
<span id="cb591-5"><a href="mathematics.html#cb591-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson,</span>
<span id="cb591-6"><a href="mathematics.html#cb591-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb591-7"><a href="mathematics.html#cb591-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb591-8"><a href="mathematics.html#cb591-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Second line</span></span>
<span id="cb591-9"><a href="mathematics.html#cb591-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb591-10"><a href="mathematics.html#cb591-10" aria-hidden="true" tabindex="-1"></a>ar_atkinson_drv <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_random_var_ineq</span>(</span>
<span id="cb591-11"><a href="mathematics.html#cb591-11" aria-hidden="true" tabindex="-1"></a>  ar_data_onerich, ar_drv_onerich_prob_unif, row[<span class="dv">1</span>])})</span>
<span id="cb591-12"><a href="mathematics.html#cb591-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv,</span>
<span id="cb591-13"><a href="mathematics.html#cb591-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb591-14"><a href="mathematics.html#cb591-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb591-15"><a href="mathematics.html#cb591-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Third line</span></span>
<span id="cb591-16"><a href="mathematics.html#cb591-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb591-17"><a href="mathematics.html#cb591-17" aria-hidden="true" tabindex="-1"></a>ar_atkinson_drv_richlswgt <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_random_var_ineq</span>(</span>
<span id="cb591-18"><a href="mathematics.html#cb591-18" aria-hidden="true" tabindex="-1"></a>  ar_data_onerich, ar_drv_onerich_prob_richlswgt, row[<span class="dv">1</span>])})</span>
<span id="cb591-19"><a href="mathematics.html#cb591-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv_richlswgt,</span>
<span id="cb591-20"><a href="mathematics.html#cb591-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb591-21"><a href="mathematics.html#cb591-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb591-22"><a href="mathematics.html#cb591-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Fourth line</span></span>
<span id="cb591-23"><a href="mathematics.html#cb591-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb591-24"><a href="mathematics.html#cb591-24" aria-hidden="true" tabindex="-1"></a>ar_atkinson_drv_richmrwgt <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_random_var_ineq</span>(</span>
<span id="cb591-25"><a href="mathematics.html#cb591-25" aria-hidden="true" tabindex="-1"></a>  ar_data_onerich, ar_drv_onerich_prob_richmrwgt, row[<span class="dv">1</span>])})</span>
<span id="cb591-26"><a href="mathematics.html#cb591-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv_richmrwgt,</span>
<span id="cb591-27"><a href="mathematics.html#cb591-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb591-28"><a href="mathematics.html#cb591-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;darkorange&#39;</span>)</span>
<span id="cb591-29"><a href="mathematics.html#cb591-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Title</span></span>
<span id="cb591-30"><a href="mathematics.html#cb591-30" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;One Person has Income of All Others Summed up Times 10&#39;</span>,</span>
<span id="cb591-31"><a href="mathematics.html#cb591-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub  =</span> <span class="st">&#39;Red=sample, Blue=drv, Oranges=more richest, Black=less richest&#39;</span>)</span>
<span id="cb591-32"><a href="mathematics.html#cb591-32" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-288-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="atkinson-inequality-with-an-uniform-distribution" class="section level5" number="8.3.3.3.5">
<h5><span class="header-section-number">8.3.3.3.5</span> Atkinson Inequality with an Uniform Distribution</h5>
<p>The Uniform Results, since allocations are uniform, zero for all.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="mathematics.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span>
<span id="cb592-2"><a href="mathematics.html#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="mathematics.html#cb594-1" aria-hidden="true" tabindex="-1"></a>ar_atkinson <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, row[<span class="dv">1</span>])})</span>
<span id="cb594-2"><a href="mathematics.html#cb594-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson, <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label)</span>
<span id="cb594-3"><a href="mathematics.html#cb594-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;Atkinson Inequality and Uniform Distribution&#39;</span>)</span>
<span id="cb594-4"><a href="mathematics.html#cb594-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-289-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="analyzing-equation-mechanics" class="section level4" number="8.3.3.4">
<h4><span class="header-section-number">8.3.3.4</span> Analyzing Equation Mechanics</h4>
<p>How does the Aktinson Family utility function work? THe Atkinson Family Utility has the following functional form.</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
\alpha
\cdot
A^{\lambda}
+
\beta
\cdot
B^{\lambda}
\right)^{\frac{1}{\lambda}}
\]</span></p>
<p>Several key issues here:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(V^{\text{social}}\)</span> is the utility of some social planner</li>
<li><span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are allocations for Alex and Ben.</li>
<li><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are biases that a social planner has for Alex and Ben: <span class="math inline">\(\alpha+\beta=1\)</span>, <span class="math inline">\(\alpha&gt;0\)</span>, and <span class="math inline">\(\beta&gt;0\)</span></li>
<li><span class="math inline">\(-\infty &lt; \lambda \le 1\)</span> is a measure of inequality aversion
<ul>
<li><span class="math inline">\(\lambda=1\)</span> is when the planner cares about weighted total allocations (efficient, Utilitarian)</li>
<li><span class="math inline">\(\lambda=-\infty\)</span> is when the planner cares about only the minimum between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> allocations (equality, Rawlsian)</li>
</ul></li>
</ol>
<p>What if only care about Alex? Clearly, if the planner only cares about Ben, <span class="math inline">\(\beta=1\)</span>, then:</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
B^{\lambda}
\right)^{\frac{1}{\lambda}}
= B
\]</span></p>
<p>Clearly, regardless of the value of <span class="math inline">\(\lambda\)</span>, as <span class="math inline">\(B\)</span> increases <span class="math inline">\(V\)</span> increases. What Happens to V when A or B increases? What is the derivative of <span class="math inline">\(V\)</span> with respect to <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>?</p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \frac{1}{\lambda}
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1}{\lambda}-1}
    \cdot
    \lambda
    \alpha
    A^{\lambda -1}
\]</span></p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1-\lambda}{\lambda}}
    \cdot
    \alpha
    A^{\lambda -1}
    &gt;0
\]</span></p>
<p>Note that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span>. When <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(Z^{\lambda}&gt;0\)</span>. For example <span class="math inline">\(10^{-2}=\frac{1}{100}\)</span>. And For example <span class="math inline">\(0.1^{\frac{3}{-2}}=\frac{1}{0.1^{1.5}}\)</span>. Still Positive.</p>
<p>While the overall <span class="math inline">\(V\)</span> increases with increasing <span class="math inline">\(A\)</span>, but if we did not have the outter power term, the situation is different. In particular, when <span class="math inline">\(\lambda &lt; 0\)</span>:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{d \left(\alpha A^{\lambda} + \beta B^{\lambda}\right)}{dA}=\alpha\lambda A^{\lambda -1}&lt;0
\]</span>
Without the outter <span class="math inline">\(\frac{1}{\lambda}\)</span> power, negative <span class="math inline">\(\lambda\)</span> would lead to decreasing weighted sum. But:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{dG^{\frac{1}{\lambda}}}{dG}=\frac{1}{\lambda}\cdot G^{\frac{1-\lambda}{\lambda}}&lt;0
\]</span>
so when <span class="math inline">\(G\)</span> is increasing and <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> would decrease. But when <span class="math inline">\(G\left(A,B\right)\)</span> is decreasing, as is the case with increasing <span class="math inline">\(A\)</span> when <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> will actually increase. This confirms that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span> for <span class="math inline">\(\lambda &lt;0\)</span>. The result is symmetric for <span class="math inline">\(\lambda &gt;0\)</span>.</p>
</div>
<div id="indifference-curve-graph" class="section level4" number="8.3.3.5">
<h4><span class="header-section-number">8.3.3.5</span> Indifference Curve Graph</h4>
<p>Given <span class="math inline">\(V^{\ast}\)</span>, we can show the combinations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> points that provide the same utility. We want to be able to potentially draw multiple indifference curves at the same time. Note that indifference curves are defined by <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\lambda\)</span> only. Each indifference curve is a set of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> coordinates. So to generate multiple indifference curves means to generate many sets of <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> associated with different planner preferences, and then these could be graphed out.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="mathematics.html#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A as x-axis, need bounds on A</span></span>
<span id="cb595-2"><a href="mathematics.html#cb595-2" aria-hidden="true" tabindex="-1"></a>fl_A_min <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb595-3"><a href="mathematics.html#cb595-3" aria-hidden="true" tabindex="-1"></a>fl_A_max <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb595-4"><a href="mathematics.html#cb595-4" aria-hidden="true" tabindex="-1"></a>it_A_grid <span class="ot">=</span> <span class="dv">50000</span></span>
<span id="cb595-5"><a href="mathematics.html#cb595-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-6"><a href="mathematics.html#cb595-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb595-7"><a href="mathematics.html#cb595-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ar_lambda &lt;- 1 - (10^(c(seq(-2,2, length.out=3))))</span></span>
<span id="cb595-8"><a href="mathematics.html#cb595-8" aria-hidden="true" tabindex="-1"></a>ar_lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.06</span>, <span class="sc">-</span><span class="dv">6</span>)</span>
<span id="cb595-9"><a href="mathematics.html#cb595-9" aria-hidden="true" tabindex="-1"></a>ar_beta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="at">length.out =</span> <span class="dv">3</span>)</span>
<span id="cb595-10"><a href="mathematics.html#cb595-10" aria-hidden="true" tabindex="-1"></a>ar_beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>)</span>
<span id="cb595-11"><a href="mathematics.html#cb595-11" aria-hidden="true" tabindex="-1"></a>ar_v_star <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">1</span>)</span>
<span id="cb595-12"><a href="mathematics.html#cb595-12" aria-hidden="true" tabindex="-1"></a>tb_pref <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb595-13"><a href="mathematics.html#cb595-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(ar_beta) <span class="sc">%&gt;%</span> <span class="fu">expand_grid</span>(ar_v_star) <span class="sc">%&gt;%</span></span>
<span id="cb595-14"><a href="mathematics.html#cb595-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(<span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb595-15"><a href="mathematics.html#cb595-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;indiff_id&quot;</span>)</span>
<span id="cb595-16"><a href="mathematics.html#cb595-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-17"><a href="mathematics.html#cb595-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate indifference points with apply and anonymous function</span></span>
<span id="cb595-18"><a href="mathematics.html#cb595-18" aria-hidden="true" tabindex="-1"></a><span class="co"># tb_pref, whatever is selected from it, must be all numeric</span></span>
<span id="cb595-19"><a href="mathematics.html#cb595-19" aria-hidden="true" tabindex="-1"></a><span class="co"># if there are strings, would cause conversion error.</span></span>
<span id="cb595-20"><a href="mathematics.html#cb595-20" aria-hidden="true" tabindex="-1"></a>ls_df_indiff <span class="ot">&lt;-</span> <span class="fu">apply</span>(tb_pref, <span class="dv">1</span>, <span class="cf">function</span>(x){</span>
<span id="cb595-21"><a href="mathematics.html#cb595-21" aria-hidden="true" tabindex="-1"></a>  indiff_id <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb595-22"><a href="mathematics.html#cb595-22" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb595-23"><a href="mathematics.html#cb595-23" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb595-24"><a href="mathematics.html#cb595-24" aria-hidden="true" tabindex="-1"></a>  vstar <span class="ot">&lt;-</span> x[<span class="dv">4</span>]</span>
<span id="cb595-25"><a href="mathematics.html#cb595-25" aria-hidden="true" tabindex="-1"></a>  ar_fl_A_indiff <span class="ot">&lt;-</span> <span class="fu">seq</span>(fl_A_min, fl_A_max, <span class="at">length.out=</span>it_A_grid)</span>
<span id="cb595-26"><a href="mathematics.html#cb595-26" aria-hidden="true" tabindex="-1"></a>  ar_fl_B_indiff <span class="ot">&lt;-</span> (((vstar<span class="sc">^</span>lambda) <span class="sc">-</span></span>
<span id="cb595-27"><a href="mathematics.html#cb595-27" aria-hidden="true" tabindex="-1"></a>                        (beta<span class="sc">*</span>ar_fl_A_indiff<span class="sc">^</span>(lambda)))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb595-28"><a href="mathematics.html#cb595-28" aria-hidden="true" tabindex="-1"></a>  mt_A_B_indiff <span class="ot">&lt;-</span> <span class="fu">cbind</span>(indiff_id, lambda, beta, vstar,</span>
<span id="cb595-29"><a href="mathematics.html#cb595-29" aria-hidden="true" tabindex="-1"></a>                         ar_fl_A_indiff, ar_fl_B_indiff)</span>
<span id="cb595-30"><a href="mathematics.html#cb595-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(mt_A_B_indiff) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indiff_id&#39;</span>, <span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>,</span>
<span id="cb595-31"><a href="mathematics.html#cb595-31" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;indiff_A&#39;</span>, <span class="st">&#39;indiff_B&#39;</span>)</span>
<span id="cb595-32"><a href="mathematics.html#cb595-32" aria-hidden="true" tabindex="-1"></a>  tb_A_B_indiff <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_A_B_indiff) <span class="sc">%&gt;%</span></span>
<span id="cb595-33"><a href="mathematics.html#cb595-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;A_grid_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb595-34"><a href="mathematics.html#cb595-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(indiff_B <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> indiff_B <span class="sc">&lt;=</span> <span class="fu">max</span>(ar_fl_A_indiff))</span>
<span id="cb595-35"><a href="mathematics.html#cb595-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tb_A_B_indiff)</span>
<span id="cb595-36"><a href="mathematics.html#cb595-36" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb595-37"><a href="mathematics.html#cb595-37" aria-hidden="true" tabindex="-1"></a>df_indiff <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, ls_df_indiff) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code></pre></div>
<p>Note that many more A grid points are needed to fully plot out the leontief line.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="mathematics.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb596-2"><a href="mathematics.html#cb596-2" aria-hidden="true" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Indifference Curves Aktinson Atkinson Utility (CES)&#39;</span>)</span>
<span id="cb596-3"><a href="mathematics.html#cb596-3" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Each Panel Different beta=A</span><span class="sc">\&#39;</span><span class="st">s Weight lambda=inequality aversion</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb596-4"><a href="mathematics.html#cb596-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb596-5"><a href="mathematics.html#cb596-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/func_ineq/htmlpdfr/fs_atkinson_ces.html&#39;</span>)</span>
<span id="cb596-6"><a href="mathematics.html#cb596-6" aria-hidden="true" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Indifference Curve 2 Individuals, &#39;</span>,</span>
<span id="cb596-7"><a href="mathematics.html#cb596-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb596-8"><a href="mathematics.html#cb596-8" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;A&#39;</span></span>
<span id="cb596-9"><a href="mathematics.html#cb596-9" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;B&#39;</span></span>
<span id="cb596-10"><a href="mathematics.html#cb596-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-11"><a href="mathematics.html#cb596-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb596-12"><a href="mathematics.html#cb596-12" aria-hidden="true" tabindex="-1"></a>plt_indiff <span class="ot">&lt;-</span></span>
<span id="cb596-13"><a href="mathematics.html#cb596-13" aria-hidden="true" tabindex="-1"></a>  df_indiff <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">lambda =</span> <span class="fu">as_factor</span>(lambda),</span>
<span id="cb596-14"><a href="mathematics.html#cb596-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fu">as_factor</span>(beta),</span>
<span id="cb596-15"><a href="mathematics.html#cb596-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vstar =</span> <span class="fu">as_factor</span>(vstar)) <span class="sc">%&gt;%</span></span>
<span id="cb596-16"><a href="mathematics.html#cb596-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>indiff_A, <span class="at">y=</span>indiff_B,</span>
<span id="cb596-17"><a href="mathematics.html#cb596-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span>lambda)) <span class="sc">+</span></span>
<span id="cb596-18"><a href="mathematics.html#cb596-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> beta) <span class="sc">+</span></span>
<span id="cb596-19"><a href="mathematics.html#cb596-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb596-20"><a href="mathematics.html#cb596-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb596-21"><a href="mathematics.html#cb596-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption) <span class="sc">+</span></span>
<span id="cb596-22"><a href="mathematics.html#cb596-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb596-23"><a href="mathematics.html#cb596-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-24"><a href="mathematics.html#cb596-24" aria-hidden="true" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb596-25"><a href="mathematics.html#cb596-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_indiff)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-291-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="location-population-and-pollution" class="section level3" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Location, Population, and Pollution</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="simulate-population-distribution-over-location-and-demographics" class="section level4" number="8.3.4.1">
<h4><span class="header-section-number">8.3.4.1</span> Simulate Population Distribution over Location and Demographics</h4>
<p>Use the binomial distribution to generate heterogenous demographic break-down by location. There are N demographic cells, and the binomial distribution provides the probability mass in each of the N cell. Different bernoulli “win” chance for each location. There is also probability distribution over population in each location.</p>
<p>First, construct empty population share dataframe:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="mathematics.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7 different age groups and 12 different locationso</span></span>
<span id="cb597-2"><a href="mathematics.html#cb597-2" aria-hidden="true" tabindex="-1"></a>it_N_pop_groups <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb597-3"><a href="mathematics.html#cb597-3" aria-hidden="true" tabindex="-1"></a>it_M_location <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb597-4"><a href="mathematics.html#cb597-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix of demographics by location</span></span>
<span id="cb597-5"><a href="mathematics.html#cb597-5" aria-hidden="true" tabindex="-1"></a>mt_pop_data_frac <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span>it_M_location, <span class="at">ncol=</span>it_N_pop_groups)  </span>
<span id="cb597-6"><a href="mathematics.html#cb597-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_pop_data_frac) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;popgrp&#39;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,it_N_pop_groups))</span>
<span id="cb597-7"><a href="mathematics.html#cb597-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mt_pop_data_frac) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;location&#39;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,it_M_location))</span>
<span id="cb597-8"><a href="mathematics.html#cb597-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb597-9"><a href="mathematics.html#cb597-9" aria-hidden="true" tabindex="-1"></a>mt_pop_data_frac <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp1
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp2
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp3
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp4
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp5
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp6
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp7
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p>Second, generate conditional population distribution for each location, and then multiply by the share of population in each locality:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="mathematics.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Share of population per location</span></span>
<span id="cb598-2"><a href="mathematics.html#cb598-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb598-3"><a href="mathematics.html#cb598-3" aria-hidden="true" tabindex="-1"></a>ar_p_loc <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span>it_M_location<span class="dv">-1</span>), <span class="dv">3</span><span class="sc">*</span>it_M_location<span class="dv">-1</span>, <span class="fl">0.5</span>)</span>
<span id="cb598-4"><a href="mathematics.html#cb598-4" aria-hidden="true" tabindex="-1"></a>it_start <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_p_loc)<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>it_M_location<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb598-5"><a href="mathematics.html#cb598-5" aria-hidden="true" tabindex="-1"></a>ar_p_loc <span class="ot">&lt;-</span> ar_p_loc[it_start<span class="sc">:</span>(it_start<span class="sc">+</span>it_M_location<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb598-6"><a href="mathematics.html#cb598-6" aria-hidden="true" tabindex="-1"></a>ar_p_loc <span class="ot">&lt;-</span> ar_p_loc<span class="sc">/</span><span class="fu">sum</span>(ar_p_loc)</span>
<span id="cb598-7"><a href="mathematics.html#cb598-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-8"><a href="mathematics.html#cb598-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Different bernoulli &quot;win&quot; probability for each location</span></span>
<span id="cb598-9"><a href="mathematics.html#cb598-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb598-10"><a href="mathematics.html#cb598-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ar_fl_unif_prob &lt;- sort(runif(it_M_location)*(0.25)+0.4)</span></span>
<span id="cb598-11"><a href="mathematics.html#cb598-11" aria-hidden="true" tabindex="-1"></a>ar_fl_unif_prob <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(it_M_location))</span>
<span id="cb598-12"><a href="mathematics.html#cb598-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-13"><a href="mathematics.html#cb598-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate population proportion by locality</span></span>
<span id="cb598-14"><a href="mathematics.html#cb598-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_loc <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>it_M_location ) {</span>
<span id="cb598-15"><a href="mathematics.html#cb598-15" aria-hidden="true" tabindex="-1"></a>  ar_p_pop_condi_loc <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>(it_N_pop_groups<span class="dv">-1</span>), it_N_pop_groups<span class="dv">-1</span>, ar_fl_unif_prob[it_loc])</span>
<span id="cb598-16"><a href="mathematics.html#cb598-16" aria-hidden="true" tabindex="-1"></a>  mt_pop_data_frac[it_loc,] <span class="ot">&lt;-</span> ar_p_pop_condi_loc<span class="sc">*</span>ar_p_loc[it_loc]</span>
<span id="cb598-17"><a href="mathematics.html#cb598-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb598-18"><a href="mathematics.html#cb598-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-19"><a href="mathematics.html#cb598-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum of cells, should equal to 1</span></span>
<span id="cb598-20"><a href="mathematics.html#cb598-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;pop frac sum = &#39;</span>, <span class="fu">sum</span>(mt_pop_data_frac)))</span></code></pre></div>
<pre><code>## [1] &quot;pop frac sum = 0.962953679726938&quot;</code></pre>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="mathematics.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb600-2"><a href="mathematics.html#cb600-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(mt_pop_data_frac<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb600-3"><a href="mathematics.html#cb600-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&#39;Share of population in each location and demographic cell&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb600-4"><a href="mathematics.html#cb600-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-294">Table 8.2: </span>Share of population in each location and demographic cell
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp7
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:right;">
1.63
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
1.40
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
1.90
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
1.73
</td>
<td style="text-align:right;">
2.89
</td>
<td style="text-align:right;">
2.71
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
2.89
</td>
<td style="text-align:right;">
3.93
</td>
<td style="text-align:right;">
2.85
</td>
<td style="text-align:right;">
0.86
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
2.23
</td>
<td style="text-align:right;">
4.26
</td>
<td style="text-align:right;">
4.33
</td>
<td style="text-align:right;">
1.83
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:right;">
4.03
</td>
<td style="text-align:right;">
4.72
</td>
<td style="text-align:right;">
2.31
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
3.28
</td>
<td style="text-align:right;">
4.55
</td>
<td style="text-align:right;">
2.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
2.57
</td>
<td style="text-align:right;">
3.68
</td>
<td style="text-align:right;">
2.19
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
4.38
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
1.28
</td>
<td style="text-align:right;">
2.82
</td>
</tr>
</tbody>
</table>
</div>
<div id="simulate-enviromental-exposure" class="section level4" number="8.3.4.2">
<h4><span class="header-section-number">8.3.4.2</span> Simulate Enviromental Exposure</h4>
<p>Use log-normal distribution to describe average daily PM10 exposures distribution by locality:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="mathematics.html#cb601-1" aria-hidden="true" tabindex="-1"></a>fl_meanlog <span class="ot">&lt;-</span> <span class="fl">3.4</span></span>
<span id="cb601-2"><a href="mathematics.html#cb601-2" aria-hidden="true" tabindex="-1"></a>fl_sdlog <span class="ot">&lt;-</span> <span class="fl">0.35</span></span>
<span id="cb601-3"><a href="mathematics.html#cb601-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="at">meanlog =</span> fl_meanlog, <span class="at">sdlog =</span> fl_sdlog))</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-295-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>First, draw pollution measure for each locality:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="mathematics.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw</span></span>
<span id="cb602-2"><a href="mathematics.html#cb602-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb602-3"><a href="mathematics.html#cb602-3" aria-hidden="true" tabindex="-1"></a>ar_pollution_loc <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(it_M_location, <span class="at">meanlog =</span> fl_meanlog, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb602-4"><a href="mathematics.html#cb602-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pollution dataframe</span></span>
<span id="cb602-5"><a href="mathematics.html#cb602-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 by 3 matrix</span></span>
<span id="cb602-6"><a href="mathematics.html#cb602-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-7"><a href="mathematics.html#cb602-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Names</span></span>
<span id="cb602-8"><a href="mathematics.html#cb602-8" aria-hidden="true" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;location&#39;</span>,<span class="st">&#39;avgdailypm10&#39;</span>)</span>
<span id="cb602-9"><a href="mathematics.html#cb602-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-10"><a href="mathematics.html#cb602-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb602-11"><a href="mathematics.html#cb602-11" aria-hidden="true" tabindex="-1"></a>tb_loc_pollution <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ar_pollution_loc) <span class="sc">%&gt;%</span></span>
<span id="cb602-12"><a href="mathematics.html#cb602-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb602-13"><a href="mathematics.html#cb602-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames)) <span class="sc">%&gt;%</span></span>
<span id="cb602-14"><a href="mathematics.html#cb602-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="fu">paste0</span>(<span class="st">&#39;location&#39;</span>, location))</span>
<span id="cb602-15"><a href="mathematics.html#cb602-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-16"><a href="mathematics.html#cb602-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb602-17"><a href="mathematics.html#cb602-17" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tb_loc_pollution) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
location
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
avgdailypm10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:right;">
51.70466
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:right;">
30.71275
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:right;">
31.35114
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:right;">
54.61304
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:right;">
35.20967
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:right;">
19.24456
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:right;">
23.56121
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:right;">
25.63653
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:right;">
45.99021
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:right;">
33.98553
</td>
</tr>
</tbody>
</table>
<p>Second, reshape population data:</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="mathematics.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape population data, so each observation is location/demo</span></span>
<span id="cb603-2"><a href="mathematics.html#cb603-2" aria-hidden="true" tabindex="-1"></a>df_pop_data_frac_long <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_pop_data_frac, <span class="at">rownames=</span><span class="st">&#39;location&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb603-3"><a href="mathematics.html#cb603-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&#39;popgrp&#39;</span>),</span>
<span id="cb603-4"><a href="mathematics.html#cb603-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;popgrp&#39;</span>),</span>
<span id="cb603-5"><a href="mathematics.html#cb603-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="fu">paste0</span>(<span class="st">&quot;popgrp(.*)&quot;</span>),</span>
<span id="cb603-6"><a href="mathematics.html#cb603-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;pop_frac&quot;</span>)</span></code></pre></div>
<p>Third, join with pollution data:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="mathematics.html#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape population data, so each observation is location/demo</span></span>
<span id="cb604-2"><a href="mathematics.html#cb604-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_long <span class="ot">&lt;-</span> df_pop_data_frac_long <span class="sc">%&gt;%</span></span>
<span id="cb604-3"><a href="mathematics.html#cb604-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tb_loc_pollution, <span class="at">by=</span><span class="st">&#39;location&#39;</span>)</span>
<span id="cb604-4"><a href="mathematics.html#cb604-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-5"><a href="mathematics.html#cb604-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb604-6"><a href="mathematics.html#cb604-6" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_long[<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(it_N_pop_groups<span class="sc">*</span><span class="fl">2.5</span>),] <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
location
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pop_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
avgdailypm10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0109366
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0013417
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0000686
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0000019
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
24.62676
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0163003
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0070132
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0012573
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0001202
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.0000065
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.0000002
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
27.64481
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0058760
</td>
<td style="text-align:right;">
51.70466
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0140000
</td>
<td style="text-align:right;">
51.70466
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0138984
</td>
<td style="text-align:right;">
51.70466
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0073587
</td>
<td style="text-align:right;">
51.70466
</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-demographic-group-specific-exposure-distributions" class="section level4" number="8.3.4.3">
<h4><span class="header-section-number">8.3.4.3</span> Compute Demographic Group Specific Exposure Distributions</h4>
<p>What is the p10, median, p90 and mean pollution exposure for each demographic group?</p>
<ol style="list-style-type: decimal">
<li>group by population group</li>
<li>sort by pollution exposure within group</li>
<li>generate population group specific conditional population weights</li>
<li>generate population CDF for each population group (sorted by pollution)</li>
</ol>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="mathematics.html#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Follow four steps above</span></span>
<span id="cb605-2"><a href="mathematics.html#cb605-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_by_popgrp_cdf <span class="ot">&lt;-</span> df_pop_pollution_long <span class="sc">%&gt;%</span></span>
<span id="cb605-3"><a href="mathematics.html#cb605-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(popgrp, avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb605-4"><a href="mathematics.html#cb605-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(popgrp) <span class="sc">%&gt;%</span></span>
<span id="cb605-5"><a href="mathematics.html#cb605-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdf_pop_condi_popgrp_sortpm10 =</span> <span class="fu">cumsum</span>(pop_frac<span class="sc">/</span><span class="fu">sum</span>(pop_frac)),</span>
<span id="cb605-6"><a href="mathematics.html#cb605-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pmf_pop_condi_popgrp_sortpm10 =</span> (pop_frac<span class="sc">/</span><span class="fu">sum</span>(pop_frac)))</span>
<span id="cb605-7"><a href="mathematics.html#cb605-7" aria-hidden="true" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb605-8"><a href="mathematics.html#cb605-8" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_by_popgrp_cdf[<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(it_N_pop_groups<span class="sc">*</span><span class="fl">5.5</span>),] <span class="sc">%&gt;%</span> </span>
<span id="cb605-9"><a href="mathematics.html#cb605-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
location
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pop_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
avgdailypm10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cdf_pop_condi_popgrp_sortpm10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pmf_pop_condi_popgrp_sortpm10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000364
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
0.0010453
</td>
<td style="text-align:right;">
0.0010453
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000151
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
0.0014804
</td>
<td style="text-align:right;">
0.0004351
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0109366
</td>
<td style="text-align:right;">
24.62676
</td>
<td style="text-align:right;">
0.3156484
</td>
<td style="text-align:right;">
0.3141680
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000104
</td>
<td style="text-align:right;">
25.63653
</td>
<td style="text-align:right;">
0.3159471
</td>
<td style="text-align:right;">
0.0002988
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0163003
</td>
<td style="text-align:right;">
27.64481
</td>
<td style="text-align:right;">
0.7841942
</td>
<td style="text-align:right;">
0.4682471
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0005879
</td>
<td style="text-align:right;">
30.71275
</td>
<td style="text-align:right;">
0.8010816
</td>
<td style="text-align:right;">
0.0168874
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0007392
</td>
<td style="text-align:right;">
31.35114
</td>
<td style="text-align:right;">
0.8223166
</td>
<td style="text-align:right;">
0.0212350
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
33.98553
</td>
<td style="text-align:right;">
0.8223168
</td>
<td style="text-align:right;">
0.0000002
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000681
</td>
<td style="text-align:right;">
35.20967
</td>
<td style="text-align:right;">
0.8242718
</td>
<td style="text-align:right;">
0.0019550
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
45.99021
</td>
<td style="text-align:right;">
0.8242721
</td>
<td style="text-align:right;">
0.0000003
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0058760
</td>
<td style="text-align:right;">
51.70466
</td>
<td style="text-align:right;">
0.9930669
</td>
<td style="text-align:right;">
0.1687948
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0002413
</td>
<td style="text-align:right;">
54.61304
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.0069331
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0006400
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
0.0172871
</td>
<td style="text-align:right;">
0.0172871
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0003150
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
0.0257947
</td>
<td style="text-align:right;">
0.0085076
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0013417
</td>
<td style="text-align:right;">
24.62676
</td>
<td style="text-align:right;">
0.0620374
</td>
<td style="text-align:right;">
0.0362427
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0002235
</td>
<td style="text-align:right;">
25.63653
</td>
<td style="text-align:right;">
0.0680736
</td>
<td style="text-align:right;">
0.0060362
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0070132
</td>
<td style="text-align:right;">
27.64481
</td>
<td style="text-align:right;">
0.2575157
</td>
<td style="text-align:right;">
0.1894421
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0042712
</td>
<td style="text-align:right;">
30.71275
</td>
<td style="text-align:right;">
0.3728918
</td>
<td style="text-align:right;">
0.1153760
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0055479
</td>
<td style="text-align:right;">
31.35114
</td>
<td style="text-align:right;">
0.5227547
</td>
<td style="text-align:right;">
0.1498629
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0000004
</td>
<td style="text-align:right;">
33.98553
</td>
<td style="text-align:right;">
0.5227662
</td>
<td style="text-align:right;">
0.0000116
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0010378
</td>
<td style="text-align:right;">
35.20967
</td>
<td style="text-align:right;">
0.5508009
</td>
<td style="text-align:right;">
0.0280347
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0000008
</td>
<td style="text-align:right;">
45.99021
</td>
<td style="text-align:right;">
0.5508213
</td>
<td style="text-align:right;">
0.0000203
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0140000
</td>
<td style="text-align:right;">
51.70466
</td>
<td style="text-align:right;">
0.9289930
</td>
<td style="text-align:right;">
0.3781718
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0026287
</td>
<td style="text-align:right;">
54.61304
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.0710070
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0046896
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
0.0638166
</td>
<td style="text-align:right;">
0.0638166
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0027290
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
0.1009539
</td>
<td style="text-align:right;">
0.0371373
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0000686
</td>
<td style="text-align:right;">
24.62676
</td>
<td style="text-align:right;">
0.1018872
</td>
<td style="text-align:right;">
0.0009333
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0020006
</td>
<td style="text-align:right;">
25.63653
</td>
<td style="text-align:right;">
0.1291118
</td>
<td style="text-align:right;">
0.0272246
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0012573
</td>
<td style="text-align:right;">
27.64481
</td>
<td style="text-align:right;">
0.1462207
</td>
<td style="text-align:right;">
0.0171089
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0129304
</td>
<td style="text-align:right;">
30.71275
</td>
<td style="text-align:right;">
0.3221799
</td>
<td style="text-align:right;">
0.1759592
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0173492
</td>
<td style="text-align:right;">
31.35114
</td>
<td style="text-align:right;">
0.5582709
</td>
<td style="text-align:right;">
0.2360910
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0000141
</td>
<td style="text-align:right;">
33.98553
</td>
<td style="text-align:right;">
0.5584625
</td>
<td style="text-align:right;">
0.0001916
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0065945
</td>
<td style="text-align:right;">
35.20967
</td>
<td style="text-align:right;">
0.6482016
</td>
<td style="text-align:right;">
0.0897391
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0000242
</td>
<td style="text-align:right;">
45.99021
</td>
<td style="text-align:right;">
0.6485305
</td>
<td style="text-align:right;">
0.0003290
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0138984
</td>
<td style="text-align:right;">
51.70466
</td>
<td style="text-align:right;">
0.8376617
</td>
<td style="text-align:right;">
0.1891312
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0119295
</td>
<td style="text-align:right;">
54.61304
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.1623383
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0183277
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
0.1224562
</td>
<td style="text-align:right;">
0.1224562
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0126118
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
0.2067219
</td>
<td style="text-align:right;">
0.0842656
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="compute-the-gini-index-by-population-subgroup" class="section level4" number="8.3.4.4">
<h4><span class="header-section-number">8.3.4.4</span> Compute the Gini Index by Population Subgroup</h4>
<p>The Gini index from <a href="https://fanwangecon.github.io/R4Econ/math/func_ineq/htmlpdfr/fs_gini_disc.html">fs_gini_disc</a>.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="mathematics.html#cb606-1" aria-hidden="true" tabindex="-1"></a>ffi_dist_gini_random_var_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_x_sorted, ar_prob_of_x) {</span>
<span id="cb606-2"><a href="mathematics.html#cb606-2" aria-hidden="true" tabindex="-1"></a>  fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb606-3"><a href="mathematics.html#cb606-3" aria-hidden="true" tabindex="-1"></a>  ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb606-4"><a href="mathematics.html#cb606-4" aria-hidden="true" tabindex="-1"></a>  ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb606-5"><a href="mathematics.html#cb606-5" aria-hidden="true" tabindex="-1"></a>  fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>ar_height);</span>
<span id="cb606-6"><a href="mathematics.html#cb606-6" aria-hidden="true" tabindex="-1"></a>  fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_prob_of_x)<span class="sc">/</span><span class="fu">sum</span>(ar_prob_of_x)))</span>
<span id="cb606-7"><a href="mathematics.html#cb606-7" aria-hidden="true" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb606-8"><a href="mathematics.html#cb606-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini_index)</span>
<span id="cb606-9"><a href="mathematics.html#cb606-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Compute Gini index for sub-group:</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="mathematics.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute GINI by group</span></span>
<span id="cb607-2"><a href="mathematics.html#cb607-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollu_gini <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span></span>
<span id="cb607-3"><a href="mathematics.html#cb607-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(popgrp) <span class="sc">%&gt;%</span></span>
<span id="cb607-4"><a href="mathematics.html#cb607-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">popgrp_gini =</span> <span class="fu">ffi_dist_gini_random_var_pos_test</span>(</span>
<span id="cb607-5"><a href="mathematics.html#cb607-5" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>avgdailypm10, .<span class="sc">$</span>pmf_pop_condi_popgrp_sortpm10)) <span class="sc">%&gt;%</span></span>
<span id="cb607-6"><a href="mathematics.html#cb607-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(popgrp_gini)) <span class="sc">%&gt;%</span></span>
<span id="cb607-7"><a href="mathematics.html#cb607-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb607-8"><a href="mathematics.html#cb607-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(popgrp) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(1L) <span class="sc">%&gt;%</span> </span>
<span id="cb607-9"><a href="mathematics.html#cb607-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp)</span>
<span id="cb607-10"><a href="mathematics.html#cb607-10" aria-hidden="true" tabindex="-1"></a>              , <span class="at">by=</span><span class="st">&quot;popgrp&quot;</span>)</span>
<span id="cb607-11"><a href="mathematics.html#cb607-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb607-12"><a href="mathematics.html#cb607-12" aria-hidden="true" tabindex="-1"></a>df_pop_pollu_gini <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp_gini
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.1206861
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.1075096
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.1380319
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.1543002
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.1680265
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.1754309
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.1453136
</td>
</tr>
</tbody>
</table>
</div>
<div id="visualize-the-distributions" class="section level4" number="8.3.4.5">
<h4><span class="header-section-number">8.3.4.5</span> Visualize the Distributions</h4>
<p>Visualizing distributions. Visualize the CDF:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="mathematics.html#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visaulize Distributions, CDF for different population groups</span></span>
<span id="cb608-2"><a href="mathematics.html#cb608-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span></span>
<span id="cb608-3"><a href="mathematics.html#cb608-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(popgrp, avgdailypm10, cdf_pop_condi_popgrp_sortpm10 ) <span class="sc">%&gt;%</span></span>
<span id="cb608-4"><a href="mathematics.html#cb608-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>avgdailypm10, <span class="at">y=</span>cdf_pop_condi_popgrp_sortpm10, </span>
<span id="cb608-5"><a href="mathematics.html#cb608-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span>popgrp)) <span class="sc">+</span></span>
<span id="cb608-6"><a href="mathematics.html#cb608-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb608-7"><a href="mathematics.html#cb608-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb608-8"><a href="mathematics.html#cb608-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;CDF of Pollution Distribution by Population Types&#39;</span>,</span>
<span id="cb608-9"><a href="mathematics.html#cb608-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Pollution Levels&#39;</span>,</span>
<span id="cb608-10"><a href="mathematics.html#cb608-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Cumulative Probability Mass&#39;</span>,</span>
<span id="cb608-11"><a href="mathematics.html#cb608-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;Testing Data&#39;</span>) </span>
<span id="cb608-12"><a href="mathematics.html#cb608-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lineplot)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-302-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Visualize the Probability Mass (real data should look much less chaotic than this):</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="mathematics.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visaulize Distributions, CDF for different population groups</span></span>
<span id="cb609-2"><a href="mathematics.html#cb609-2" aria-hidden="true" tabindex="-1"></a>lineplot_pmf <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span></span>
<span id="cb609-3"><a href="mathematics.html#cb609-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(popgrp, avgdailypm10, pmf_pop_condi_popgrp_sortpm10 ) <span class="sc">%&gt;%</span></span>
<span id="cb609-4"><a href="mathematics.html#cb609-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>avgdailypm10, <span class="at">y=</span>pmf_pop_condi_popgrp_sortpm10, </span>
<span id="cb609-5"><a href="mathematics.html#cb609-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span>popgrp)) <span class="sc">+</span></span>
<span id="cb609-6"><a href="mathematics.html#cb609-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb609-7"><a href="mathematics.html#cb609-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb609-8"><a href="mathematics.html#cb609-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Prob Mass Func of Pollution by Population Types&#39;</span>,</span>
<span id="cb609-9"><a href="mathematics.html#cb609-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Pollution Levels&#39;</span>,</span>
<span id="cb609-10"><a href="mathematics.html#cb609-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Probability Mass&#39;</span>,</span>
<span id="cb609-11"><a href="mathematics.html#cb609-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;Testing Data&#39;</span>) </span>
<span id="cb609-12"><a href="mathematics.html#cb609-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lineplot_pmf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-303-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="various-quantiles" class="section level4" number="8.3.4.6">
<h4><span class="header-section-number">8.3.4.6</span> Various Quantiles</h4>
<p>Measure quantiles of pollution exposures for different population groups:</p>
<ol style="list-style-type: decimal">
<li>Consider CDF larger than current quantile of interest.</li>
<li>Slice group-specific CDF that is higher and closest to quantile of interest.</li>
<li>Merge results for different quantiles together.</li>
</ol>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="mathematics.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate pollution quantiles by population groups</span></span>
<span id="cb610-2"><a href="mathematics.html#cb610-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_distribution <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb610-3"><a href="mathematics.html#cb610-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(popgrp) <span class="sc">%&gt;%</span></span>
<span id="cb610-4"><a href="mathematics.html#cb610-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pm10_mean =</span> <span class="fu">weighted.mean</span>(avgdailypm10, pop_frac)) <span class="sc">%&gt;%</span></span>
<span id="cb610-5"><a href="mathematics.html#cb610-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pm10_sd_gap =</span> pop_frac<span class="sc">*</span>(avgdailypm10 <span class="sc">-</span> pm10_mean)<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb610-6"><a href="mathematics.html#cb610-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pm10_sd =</span> <span class="fu">sqrt</span>(<span class="fu">weighted.mean</span>(pm10_sd_gap, pop_frac))) <span class="sc">%&gt;%</span></span>
<span id="cb610-7"><a href="mathematics.html#cb610-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pm10_sd_gap) <span class="sc">%&gt;%</span></span>
<span id="cb610-8"><a href="mathematics.html#cb610-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-9"><a href="mathematics.html#cb610-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-10"><a href="mathematics.html#cb610-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pm10_p10 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb610-11"><a href="mathematics.html#cb610-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(popgrp, pm10_mean, pm10_sd, pm10_p10) <span class="sc">%&gt;%</span></span>
<span id="cb610-12"><a href="mathematics.html#cb610-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollu_gini, <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb610-13"><a href="mathematics.html#cb610-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb610-14"><a href="mathematics.html#cb610-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-15"><a href="mathematics.html#cb610-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-16"><a href="mathematics.html#cb610-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p20 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb610-17"><a href="mathematics.html#cb610-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p20), </span>
<span id="cb610-18"><a href="mathematics.html#cb610-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-19"><a href="mathematics.html#cb610-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb610-20"><a href="mathematics.html#cb610-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-21"><a href="mathematics.html#cb610-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-22"><a href="mathematics.html#cb610-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p50 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb610-23"><a href="mathematics.html#cb610-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p50), </span>
<span id="cb610-24"><a href="mathematics.html#cb610-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-25"><a href="mathematics.html#cb610-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb610-26"><a href="mathematics.html#cb610-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-27"><a href="mathematics.html#cb610-27" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-28"><a href="mathematics.html#cb610-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p80 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb610-29"><a href="mathematics.html#cb610-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p80), </span>
<span id="cb610-30"><a href="mathematics.html#cb610-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-31"><a href="mathematics.html#cb610-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb610-32"><a href="mathematics.html#cb610-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.90</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-33"><a href="mathematics.html#cb610-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-34"><a href="mathematics.html#cb610-34" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p90 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb610-35"><a href="mathematics.html#cb610-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p90), </span>
<span id="cb610-36"><a href="mathematics.html#cb610-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb610-37"><a href="mathematics.html#cb610-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(popgrp, pm10_mean, pm10_sd, popgrp_gini, <span class="fu">everything</span>())</span>
<span id="cb610-38"><a href="mathematics.html#cb610-38" aria-hidden="true" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb610-39"><a href="mathematics.html#cb610-39" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_distribution <span class="sc">%&gt;%</span> </span>
<span id="cb610-40"><a href="mathematics.html#cb610-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&#39;PM10 Exposure Distribution by Population Groups&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb610-41"><a href="mathematics.html#cb610-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-304">Table 8.3: </span>PM10 Exposure Distribution by Population Groups
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp_gini
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p20
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p50
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p80
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p90
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
31.07894
</td>
<td style="text-align:right;">
0.8098981
</td>
<td style="text-align:right;">
0.1206861
</td>
<td style="text-align:right;">
24.62676
</td>
<td style="text-align:right;">
24.62676
</td>
<td style="text-align:right;">
27.64481
</td>
<td style="text-align:right;">
30.71275
</td>
<td style="text-align:right;">
51.70466
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
39.47897
</td>
<td style="text-align:right;">
1.0628619
</td>
<td style="text-align:right;">
0.1075096
</td>
<td style="text-align:right;">
27.64481
</td>
<td style="text-align:right;">
27.64481
</td>
<td style="text-align:right;">
31.35114
</td>
<td style="text-align:right;">
51.70466
</td>
<td style="text-align:right;">
51.70466
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
37.92901
</td>
<td style="text-align:right;">
1.2140423
</td>
<td style="text-align:right;">
0.1380319
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
30.71275
</td>
<td style="text-align:right;">
31.35114
</td>
<td style="text-align:right;">
51.70466
</td>
<td style="text-align:right;">
54.61304
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
34.86470
</td>
<td style="text-align:right;">
1.7692120
</td>
<td style="text-align:right;">
0.1543002
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
31.35114
</td>
<td style="text-align:right;">
51.70466
</td>
<td style="text-align:right;">
54.61304
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
32.56731
</td>
<td style="text-align:right;">
2.2367922
</td>
<td style="text-align:right;">
0.1680265
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
30.71275
</td>
<td style="text-align:right;">
35.20967
</td>
<td style="text-align:right;">
54.61304
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
31.46626
</td>
<td style="text-align:right;">
2.0286573
</td>
<td style="text-align:right;">
0.1754309
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
25.63653
</td>
<td style="text-align:right;">
35.20967
</td>
<td style="text-align:right;">
54.61304
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
33.50541
</td>
<td style="text-align:right;">
1.7562952
</td>
<td style="text-align:right;">
0.1453136
</td>
<td style="text-align:right;">
19.24456
</td>
<td style="text-align:right;">
23.56121
</td>
<td style="text-align:right;">
33.98553
</td>
<td style="text-align:right;">
45.99021
</td>
<td style="text-align:right;">
45.99021
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="optimization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
