<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="<p>Run system executable and shell commands.
Activate conda environment with shell script.</p>" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2021-04-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="optimization.html"/>
<link rel="next" href="statistics.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#variables-in-dataframes"><i class="fa fa-check"></i><b>1.4</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-dataframe"><i class="fa fa-check"></i><b>1.4.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="1.4.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#factor-label-and-combine"><i class="fa fa-check"></i><b>1.4.2</b> Factor Label and Combine</a></li>
<li class="chapter" data-level="1.4.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#drawly-random-rows"><i class="fa fa-check"></i><b>1.4.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="1.4.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>1.4.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="1.4.5" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-dataframes"><i class="fa fa-check"></i><b>1.4.5</b> String Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>2</b> Summarize Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarize-data.html"><a href="summarize-data.html#counting-observation"><i class="fa fa-check"></i><b>2.1</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-data.html"><a href="summarize-data.html#uncount"><i class="fa fa-check"></i><b>2.1.1</b> Uncount</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarize-data.html"><a href="summarize-data.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.2</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarize-data.html"><a href="summarize-data.html#sorting"><i class="fa fa-check"></i><b>2.2.1</b> Sorting</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarize-data.html"><a href="summarize-data.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.2.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarize-data.html"><a href="summarize-data.html#group-statistics"><i class="fa fa-check"></i><b>2.3</b> Group Statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="summarize-data.html"><a href="summarize-data.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.3.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarize-data.html"><a href="summarize-data.html#groups-statistics"><i class="fa fa-check"></i><b>2.3.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.3.3" data-path="summarize-data.html"><a href="summarize-data.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.3.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.3.4" data-path="summarize-data.html"><a href="summarize-data.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.3.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarize-data.html"><a href="summarize-data.html#distributional-statistics"><i class="fa fa-check"></i><b>2.4</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="summarize-data.html"><a href="summarize-data.html#histogram"><i class="fa fa-check"></i><b>2.4.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summarize-data.html"><a href="summarize-data.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.5</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="summarize-data.html"><a href="summarize-data.html#generate-replace-variables"><i class="fa fa-check"></i><b>2.5.1</b> Generate Replace Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-to-wide"><i class="fa fa-check"></i><b>4.2.1</b> Long to Wide</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-compare"><i class="fa fa-check"></i><b>4.3</b> Join and Compare</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.1</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.1.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.1.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.2</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.2.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1</b> Bisection</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#bisection-1"><i class="fa fa-check"></i><b>7.1.1</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#analytical-solutions"><i class="fa fa-check"></i><b>8.1</b> Analytical Solutions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.1</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.2</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.2</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.2.1</b> Gini Discrete Sample</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.2.2</b> Gini Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.2.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.2.3</b> Atkinson Inequality Index</a></li>
<li class="chapter" data-level="8.2.4" data-path="mathematics.html"><a href="mathematics.html#location-population-and-pollution"><i class="fa fa-check"></i><b>8.2.4</b> Location, Population, and Pollution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.1.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-facet-wrap-sub-group-graphs"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Scatter Facet Wrap Sub-group Graphs</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-and-development.html"><a href="code-and-development.html"><i class="fa fa-check"></i><b>12</b> Code and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="code-and-development.html"><a href="code-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.1</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="code-and-development.html"><a href="code-and-development.html#file-path"><i class="fa fa-check"></i><b>12.1.1</b> File Path</a></li>
<li class="chapter" data-level="12.1.2" data-path="code-and-development.html"><a href="code-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.1.2</b> Text to File</a></li>
<li class="chapter" data-level="12.1.3" data-path="code-and-development.html"><a href="code-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.1.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="code-and-development.html"><a href="code-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.2</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="code-and-development.html"><a href="code-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.2.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="code-and-development.html"><a href="code-and-development.html#command-line"><i class="fa fa-check"></i><b>12.3</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="code-and-development.html"><a href="code-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.3.1</b> Shell and System Commands</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> <span>Section 1.1 List</span> links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> <span>Section 1.2 Array</span> links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> <span>Section 1.3 Matrix</span> links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.1.4</b> <span>Section 1.4 Variables in Dataframes</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-data-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Data links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.1</b> <span>Section 2.1 Counting Observation</span> links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.2</b> <span>Section 2.2 Sorting, Indexing, Slicing</span> links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-group-statisticsgroup-statistics-links"><i class="fa fa-check"></i><b>A.2.3</b> <span>Section 2.3 Group Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.4</b> <span>Section 2.4 Distributional Statistics</span> links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.5</b> <span>Section 2.5 Summarize Multiple Variables</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> <span>Section 3.1 Dataframe Mutate</span> links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> <span>Section 3.2 Dataframe Do Anything</span> links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> <span>Section 3.3 Apply and pmap</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> <span>Section 4.1 Generate, Gather, Bind and Join</span> links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> <span>Section 4.2 Wide and Long</span> links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-join-and-comparejoin-and-compare-links"><i class="fa fa-check"></i><b>A.4.3</b> <span>Section 4.3 Join and Compare</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.1</b> <span>Section 5.1 OLS and IV</span> links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.2</b> <span>Section 5.2 Decomposition</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> <span>Section 6.1 Logit Regression</span> links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> <span>Section 6.2 Quantile Regression</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-bisectionbisection-links"><i class="fa fa-check"></i><b>A.7.1</b> <span>Section 7.1 Bisection</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-analytical-solutionsanalytical-solutions-links"><i class="fa fa-check"></i><b>A.8.1</b> <span>Section 8.1 Analytical Solutions</span> links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.2</b> <span>Section 8.2 Inequality Models</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.1</b> <span>Section 9.1 Distributions</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> <span>Section 10.1 R Base Plots</span> links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> <span>Section 10.2 ggplot Line Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> <span>Section 10.3 ggplot Scatter Related Plots</span> links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> <span>Section 10.4 Write and Read Plots</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> <span>Section 11.1 Environmental Data</span> links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#code-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Code and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.1</b> <span>Section 12.1 Files In and Out</span> links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.2</b> <span>Section 12.2 Python with R</span> links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.3</b> <span>Section 12.3 Command Line</span> links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mathematics" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Mathematics</h1>

<div id="analytical-solutions" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Analytical Solutions</h2>

<div id="rescale-a-parameter-with-fixed-min-and-max" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Rescale a Parameter with Fixed Min and Max</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="using-a-quadratic-function-to-fit-three-points-uniquely" class="section level4" number="8.1.1.1">
<h4><span class="header-section-number">8.1.1.1</span> Using A Quadratic Function to Fit Three Points Uniquely</h4>
<p>Given e &lt; x &lt; f, use f(x) to rescale x, such that f(e)=e, f(f)=f, but f(z)=<span class="math inline">\(\alpha \cdot z\)</span> for one particular z between e and f, where
<span class="math inline">\(\alpha\)</span> &gt; 1. And in this case, assume that <span class="math inline">\(\alpha \cdot z &lt; f\)</span>. We can fit these three points using the Quadratic function uniquely. In another word, there is a unique quadratic function that crosses these three points. Note the quadratic function is either concave or convex through the entire domain.</p>
<p>Suppose that <span class="math inline">\(e=0\)</span>, <span class="math inline">\(f=10\)</span>, <span class="math inline">\(z=2\)</span>, and <span class="math inline">\(\alpha=1.5\)</span>. Using a quadratic to fit:</p>
<p><span class="math display">\[
y(x) = a \cdot x^2 + b \cdot x + c
\]</span>
We have three equations:
<span class="math display">\[
0 = a \cdot 0 + b \cdot 0 + c\\
2 \cdot 1.5 = a \cdot 2^2 + b \cdot 2 + c\\
10 = a \cdot 10^2 + b \cdot 10 + c
\]</span>
Given these, we have, <span class="math inline">\(c = 0\)</span>, and subsequently, 2 equations and 2 unknowns:
<span class="math display">\[
3 = a \cdot 4 + b \cdot 2\\
10 = a \cdot 100 + b \cdot 10
\]</span></p>
<p>Hence:
<span class="math display">\[
a = \frac{3-2b}{4}\\
10 = \frac{3-2b}{4}\cdot 100 + b \cdot 10\\
10 = 75 - 50b + 10b\\
\]</span>
And finally:
<span class="math display">\[
a = \frac{3-2*1.625}{4}=-0.0625\\
b = \frac{65}{40}=1.625\\
c = 0
\]</span></p>
<p>Generate the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> points above for the quadratic function:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="mathematics.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set values</span></span>
<span id="cb451-2"><a href="mathematics.html#cb451-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb451-3"><a href="mathematics.html#cb451-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb451-4"><a href="mathematics.html#cb451-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb451-5"><a href="mathematics.html#cb451-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb451-6"><a href="mathematics.html#cb451-6" aria-hidden="true" tabindex="-1"></a><span class="co"># apply formulas from above</span></span>
<span id="cb451-7"><a href="mathematics.html#cb451-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.0625</span></span>
<span id="cb451-8"><a href="mathematics.html#cb451-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.625</span></span>
<span id="cb451-9"><a href="mathematics.html#cb451-9" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb451-10"><a href="mathematics.html#cb451-10" aria-hidden="true" tabindex="-1"></a><span class="co"># grid of values beween a and b, 11 points covering z = 2</span></span>
<span id="cb451-11"><a href="mathematics.html#cb451-11" aria-hidden="true" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(e, f, <span class="at">length.out =</span> <span class="dv">11</span>)</span>
<span id="cb451-12"><a href="mathematics.html#cb451-12" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale</span></span>
<span id="cb451-13"><a href="mathematics.html#cb451-13" aria-hidden="true" tabindex="-1"></a>ar_grid_quad <span class="ot">&lt;-</span> a<span class="sc">*</span>ar_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>ar_x <span class="sc">+</span> c</span>
<span id="cb451-14"><a href="mathematics.html#cb451-14" aria-hidden="true" tabindex="-1"></a><span class="co"># show values</span></span>
<span id="cb451-15"><a href="mathematics.html#cb451-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">print</span>(<span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_x, ar_grid_quad))), </span>
<span id="cb451-16"><a href="mathematics.html#cb451-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Quadratic Fit of Three Equations and Three Unknowns</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb451-17"><a href="mathematics.html#cb451-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Satisfies: f(0)=0, f(10)=10, f(2)=3&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb451-18"><a href="mathematics.html#cb451-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-226">Table 8.1: </span>Quadratic Fit of Three Equations and Three Unknowns
Satisfies: f(0)=0, f(10)=10, f(2)=3
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_grid_quad
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.562
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.000
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.312
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5.500
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6.562
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7.500
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8.312
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9.000
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9.562
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10.000
</td>
</tr>
</tbody>
</table>
<p>We have three equations:
<span class="math display">\[
0 = a \cdot 0 + b \cdot 0 + c\\
0.75 = a \cdot 0.5^2 + b \cdot 0.5 + c\\
3.5 = a \cdot 3.5^2 + b \cdot 3.5 + c
\]</span>
Given these, we have, <span class="math inline">\(c = 0\)</span>, and subsequently, 2 equations and 2 unknowns:
<span class="math display">\[
0.75 = a \cdot 0.25 + b \cdot 0.5\\
3.5 = a \cdot 12.25 + b \cdot 3.5
\]</span></p>
<p>Hence:
<span class="math display">\[
a = \frac{0.75-0.5b}{0.25}\\
3.5 = \frac{0.75-0.5b}{0.25}\cdot 12.25 + b \cdot 3.5\\
3.5 = 36.75 - 24.5b + 3.5b\\
\]</span>
And finally:
<span class="math display">\[
a = \frac{0.75-0.5*1.58333}{0.25}=-0.1666\\
b = \frac{36.75-3.5}{24.5-3.5}=1.58333\\
c = 0
\]</span>
Generate the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> points above for the quadratic function:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="mathematics.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set values</span></span>
<span id="cb452-2"><a href="mathematics.html#cb452-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb452-3"><a href="mathematics.html#cb452-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb452-4"><a href="mathematics.html#cb452-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb452-5"><a href="mathematics.html#cb452-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb452-6"><a href="mathematics.html#cb452-6" aria-hidden="true" tabindex="-1"></a><span class="co"># apply formulas from above</span></span>
<span id="cb452-7"><a href="mathematics.html#cb452-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.16666666</span></span>
<span id="cb452-8"><a href="mathematics.html#cb452-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.583333333</span></span>
<span id="cb452-9"><a href="mathematics.html#cb452-9" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb452-10"><a href="mathematics.html#cb452-10" aria-hidden="true" tabindex="-1"></a><span class="co"># grid of values beween a and b, 11 points covering z = 2</span></span>
<span id="cb452-11"><a href="mathematics.html#cb452-11" aria-hidden="true" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(e, f, <span class="at">length.out =</span> <span class="dv">100000</span>)</span>
<span id="cb452-12"><a href="mathematics.html#cb452-12" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale</span></span>
<span id="cb452-13"><a href="mathematics.html#cb452-13" aria-hidden="true" tabindex="-1"></a>ar_grid_quad <span class="ot">&lt;-</span> a<span class="sc">*</span>ar_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b<span class="sc">*</span>ar_x <span class="sc">+</span> c</span>
<span id="cb452-14"><a href="mathematics.html#cb452-14" aria-hidden="true" tabindex="-1"></a><span class="co"># show values</span></span>
<span id="cb452-15"><a href="mathematics.html#cb452-15" aria-hidden="true" tabindex="-1"></a><span class="co"># cbind(ar_x, ar_grid_quad)</span></span>
<span id="cb452-16"><a href="mathematics.html#cb452-16" aria-hidden="true" tabindex="-1"></a>ar_x[<span class="fu">which.min</span>(<span class="fu">abs</span>(ar_grid_quad <span class="sc">-</span> <span class="fl">0.75</span>))]</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>

</div>
</div>
<div id="linear-scalar-fx0-solutions" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Linear Scalar f(x)=0 Solutions</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="ratio" class="section level4" number="8.1.2.1">
<h4><span class="header-section-number">8.1.2.1</span> Ratio</h4>
<p>Here are some common ratios.</p>
<div id="unif-draw-min-and-max-ratio" class="section level5" number="8.1.2.1.1">
<h5><span class="header-section-number">8.1.2.1.1</span> Unif Draw Min and Max Ratio</h5>
<p>We want to draw numbers such that we have some mean <span class="math inline">\(b\)</span>, and that the possible maximum and minimum value drawn are at most <span class="math inline">\(a\)</span> times apart. Given <span class="math inline">\(b\)</span> and <span class="math inline">\(a\)</span>, solve for <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
f(x) = \frac{b+x}{b-x} - a = 0
\]</span></p>
<p><span class="math display">\[
b \cdot a - x \cdot a = b + x \\
b \cdot a - b = x + x \cdot a  \\
b \left(a - 1\right) = x \left( a+ 1\right)  \\
x = \frac{b\left(a-1\right)}{a+1}\\
\]</span></p>
<p>Uniformly draw</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="mathematics.html#cb454-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb454-2"><a href="mathematics.html#cb454-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb454-3"><a href="mathematics.html#cb454-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> (b<span class="sc">*</span>(a<span class="dv">-1</span>))<span class="sc">/</span>(a<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb454-4"><a href="mathematics.html#cb454-4" aria-hidden="true" tabindex="-1"></a>ar_unif_draws <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min=</span>b<span class="sc">-</span>x, <span class="at">max=</span>b<span class="sc">+</span>x)</span>
<span id="cb454-5"><a href="mathematics.html#cb454-5" aria-hidden="true" tabindex="-1"></a>fl_max_min_ratio <span class="ot">&lt;-</span> <span class="fu">max</span>(ar_unif_draws)<span class="sc">/</span><span class="fu">min</span>(ar_unif_draws)</span>
<span id="cb454-6"><a href="mathematics.html#cb454-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;fl_max_min_ratio =&#39;</span>, fl_max_min_ratio, <span class="st">&#39;is close to a =&#39;</span>, a, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## fl_max_min_ratio = 1.999 is close to a = 2</code></pre>

</div>
</div>
</div>
</div>
<div id="inequality-models" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Inequality Models</h2>

<div id="gini-discrete-sample" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Gini Discrete Sample</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<p>This works out how the <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> function works from <a href="https://fanwangecon.github.io/">Fan</a>’s <em><a href="https://fanwangecon.github.io/REconTools/">REconTools</a></em> Package.</p>
<div id="gini-formula-for-discrete-sample" class="section level4" number="8.2.1.1">
<h4><span class="header-section-number">8.2.1.1</span> Gini Formula for Discrete Sample</h4>
<p>There is an vector values (all positive). This could be height information for N individuals. It could also be income information for N individuals. Calculate the <a href="https://en.wikipedia.org/wiki/Gini_coefficient">GINI</a> coefficient treating the given vector as population. This is not an estimation exercise where we want to estimate population gini based on a sample. The given array is the population. The population is discrete, and only has these N individuals in the length n vector.</p>
<p>Note that when the sample size is small, there is a limit to inequality using the formula defined below given each <span class="math inline">\(N\)</span>. So for small <span class="math inline">\(N\)</span>, can not really compare inequality across arrays with different <span class="math inline">\(N\)</span>, can only compare arrays with the same <span class="math inline">\(N\)</span>.</p>
<p>The GINI formula used here is:
<span class="math display">\[
 GINI =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p>Derive the formula in the steps below.</p>
<p><em>Step 1 Area Formula</em></p>
<p><span class="math display">\[
 \Gamma = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{x_j}{\sum_{\widehat{j}=1}^N x_{\widehat{j}} }
      \right)
  \right)
\]</span></p>
<p><em>Step 2 Total Area Given Perfect equality</em></p>
<p>With perfect equality <span class="math inline">\(x_i=a\)</span> for all <span class="math inline">\(i\)</span>, so need to divide by that.</p>
<p><span class="math display">\[
 \Gamma^{\text{equal}} = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{a}{\sum_{\widehat{j}=1}^N a }
      \right)
  \right)
  = \frac{N+1}{N}\cdot\frac{1}{2}
\]</span></p>
<p>As the number of elements of the vecotr increases:
<span class="math display">\[
 \lim_{N \rightarrow \infty}\Gamma^{\text{equal}}
  = \lim_{N \rightarrow \infty} \frac{N+1}{N}\cdot\frac{1}{2}
  = \frac{1}{2}
\]</span></p>
<p><em>Step 3 Arriving at Finite Vector Gini Formula</em></p>
<p>Given what we have from above, we obtain the gini formula, divide by total area below 45 degree line.</p>
<p><span class="math display">\[
 GINI =
  1 -
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    N \cdot \sum_{i=1}^N x_i
  \right)^{-1}
  \cdot
  \left( \frac{N+1}{N}\cdot\frac{1}{2} \right)^{-1}
  =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p><em>Step 4 Maximum Inequality given N</em></p>
<p>Suppose <span class="math inline">\(x_i=0\)</span> for all <span class="math inline">\(i&lt;N\)</span>, then:</p>
<p><span class="math display">\[
 GINI^{x_i = 0 \text{ except } i=N}
 =
  1 - \frac{2}{N+1}
  \cdot
  X_N
  \cdot
  \left(
    X_N
  \right)^{-1}
 =
 1 - \frac{2}{N+1}
\]</span></p>
<p><span class="math display">\[
 \lim_{N \rightarrow \infty} GINI^{x_i = 0 \text{ except } i=N}
 =
 1 -
 \lim_{N \rightarrow \infty}
 \frac{2}{N+1}
 = 1
\]</span></p>
<p>Note that for small N, for example if <span class="math inline">\(N=10\)</span>, even when one person holds all income, all others have 0 income, the formula will not produce gini is zero, but that gini is equal to <span class="math inline">\(\frac{2}{11}\approx 0.1818\)</span>. If <span class="math inline">\(N=2\)</span>, inequality is at most, <span class="math inline">\(\frac{2}{3}\approx 0.667\)</span>.</p>
<p><span class="math display">\[
 MostUnequalGINI\left(N\right) = 1 - \frac{2}{N+1} = \frac{N-1}{N+1}
\]</span></p>
<div id="implement-gini-formula-for-discrete-sample" class="section level5" number="8.2.1.1.1">
<h5><span class="header-section-number">8.2.1.1.1</span> Implement GINI Formula for Discrete Sample</h5>
<p>The <strong>GINI</strong> formula just derived is trivial to compute.</p>
<ol style="list-style-type: decimal">
<li>scalar: <span class="math inline">\(\frac{2}{N+1}\)</span></li>
<li>cumsum: <span class="math inline">\(\sum_{j=1}^{i} x_j\)</span></li>
<li>sum of cumsum: <span class="math inline">\(\left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)\)</span></li>
<li>sum: <span class="math inline">\(\sum_{i=1}^N X_i\)</span></li>
</ol>
<p>There are no package dependencies. Define the formula here:</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="mathematics.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula, directly implement the GINI formula Following Step 4 above</span></span>
<span id="cb456-2"><a href="mathematics.html#cb456-2" aria-hidden="true" tabindex="-1"></a>ffi_dist_gini_vector_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_pos) {</span>
<span id="cb456-3"><a href="mathematics.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check length and given warning</span></span>
<span id="cb456-4"><a href="mathematics.html#cb456-4" aria-hidden="true" tabindex="-1"></a>  it_n <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_pos)</span>
<span id="cb456-5"><a href="mathematics.html#cb456-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (it_n <span class="sc">&lt;=</span> <span class="dv">100</span>)  <span class="fu">warning</span>(<span class="st">&#39;Data vector has n=&#39;</span>,it_n,<span class="st">&#39;, max-inequality/max-gini=&#39;</span>,(it_n<span class="dv">-1</span>)<span class="sc">/</span>(it_n <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb456-6"><a href="mathematics.html#cb456-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort</span></span>
<span id="cb456-7"><a href="mathematics.html#cb456-7" aria-hidden="true" tabindex="-1"></a>  ar_pos <span class="ot">&lt;-</span> <span class="fu">sort</span>(ar_pos)</span>
<span id="cb456-8"><a href="mathematics.html#cb456-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># formula implement</span></span>
<span id="cb456-9"><a href="mathematics.html#cb456-9" aria-hidden="true" tabindex="-1"></a>  fl_gini <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="dv">2</span><span class="sc">/</span>(it_n<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_pos))<span class="sc">*</span>(<span class="fu">sum</span>(ar_pos))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb456-10"><a href="mathematics.html#cb456-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini)</span>
<span id="cb456-11"><a href="mathematics.html#cb456-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Generate a number of examples Arrays for testing</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="mathematics.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example Arrays of data</span></span>
<span id="cb457-2"><a href="mathematics.html#cb457-2" aria-hidden="true" tabindex="-1"></a>ar_equal_n1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>)</span>
<span id="cb457-3"><a href="mathematics.html#cb457-3" aria-hidden="true" tabindex="-1"></a>ar_ineql_n1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>)</span>
<span id="cb457-4"><a href="mathematics.html#cb457-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-5"><a href="mathematics.html#cb457-5" aria-hidden="true" tabindex="-1"></a>ar_equal_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb457-6"><a href="mathematics.html#cb457-6" aria-hidden="true" tabindex="-1"></a>ar_ineql_alittle_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb457-7"><a href="mathematics.html#cb457-7" aria-hidden="true" tabindex="-1"></a>ar_ineql_somewht_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb457-8"><a href="mathematics.html#cb457-8" aria-hidden="true" tabindex="-1"></a>ar_ineql_alotine_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb457-9"><a href="mathematics.html#cb457-9" aria-hidden="true" tabindex="-1"></a>ar_ineql_veryvry_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">8</span>)</span>
<span id="cb457-10"><a href="mathematics.html#cb457-10" aria-hidden="true" tabindex="-1"></a>ar_ineql_mostmst_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">13</span>)</span>
<span id="cb457-11"><a href="mathematics.html#cb457-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-12"><a href="mathematics.html#cb457-12" aria-hidden="true" tabindex="-1"></a>ar_equal_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb457-13"><a href="mathematics.html#cb457-13" aria-hidden="true" tabindex="-1"></a>ar_ineql_some_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">21</span>,<span class="dv">34</span>,<span class="dv">55</span>,<span class="dv">89</span>)</span>
<span id="cb457-14"><a href="mathematics.html#cb457-14" aria-hidden="true" tabindex="-1"></a>ar_ineql_very_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">8</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">13</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">21</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">34</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">55</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">89</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb457-15"><a href="mathematics.html#cb457-15" aria-hidden="true" tabindex="-1"></a>ar_ineql_extr_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">^</span><span class="dv">3</span>,<span class="dv">5</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">^</span><span class="dv">5</span>,<span class="dv">13</span><span class="sc">^</span><span class="dv">6</span>,<span class="dv">21</span><span class="sc">^</span><span class="dv">7</span>,<span class="dv">34</span><span class="sc">^</span><span class="dv">8</span>,<span class="dv">55</span><span class="sc">^</span><span class="dv">9</span>,<span class="dv">89</span><span class="sc">^</span><span class="dv">10</span>)</span></code></pre></div>
<p>Now test the example arrays above using the function based no our formula:</p>
<pre><code>## 
## Small N=1 Hard-Code</code></pre>
<pre><code>## ar_equal_n1: 0</code></pre>
<pre><code>## ar_ineql_n1: 0</code></pre>
<pre><code>## 
## Small N=2 Hard-Code, converge to 1/3, see formula above</code></pre>
<pre><code>## ar_ineql_alittle_n2: 0.1111</code></pre>
<pre><code>## ar_ineql_somewht_n2: 0.2593</code></pre>
<pre><code>## ar_ineql_alotine_n2: 0.3131</code></pre>
<pre><code>## ar_ineql_veryvry_n2: 0.3307</code></pre>
<pre><code>## 
## Small N=10 Hard-Code, convege to 9/11=0.8181, see formula above</code></pre>
<pre><code>## ar_equal_n10: 0</code></pre>
<pre><code>## ar_ineql_some_n10: 0.5396</code></pre>
<pre><code>## ar_ineql_very_n10: 0.706</code></pre>
<pre><code>## ar_ineql_extr_n10: 0.8182</code></pre>
</div>
</div>
</div>
<div id="gini-formula-for-discrete-random-varialbe" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Gini Formula for Discrete Random Varialbe</h3>
<p>For a discrete random variable, we are two arrays, an array of <span class="math inline">\(x\)</span> values, and an array of <span class="math inline">\(f(x)\)</span> probability mass at each <span class="math inline">\(x\)</span> value. Suppose the <span class="math inline">\(x\)</span> values are unique/non-repeating. This is also Implemented in <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> with the <a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/stats/ff_disc_rand_var_gini.m">ff_disc_rand_var_gini</a> function.</p>
<p>Generate two arrays for <span class="math inline">\(x\)</span> and <span class="math inline">\(f(x)\)</span>, we will use the <a href="https://fanwangecon.github.io/Stat4Econ/probability_discrete/htmlpdfr/binomial.html">binomial distribution</a>:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="mathematics.html#cb471-1" aria-hidden="true" tabindex="-1"></a>ar_choice_unique_sorted <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb471-2"><a href="mathematics.html#cb471-2" aria-hidden="true" tabindex="-1"></a>ar_choice_prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_choice_unique_sorted, <span class="dv">100</span>, <span class="fl">0.01</span>)</span></code></pre></div>
<p>Generate mean and cumulative mean at each point:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="mathematics.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. to normalize, get mean (binomial so mean is p*N=50)</span></span>
<span id="cb472-2"><a href="mathematics.html#cb472-2" aria-hidden="true" tabindex="-1"></a>fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_unique_sorted<span class="sc">*</span>ar_choice_prob);</span>
<span id="cb472-3"><a href="mathematics.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. get cumulative mean at each point</span></span>
<span id="cb472-4"><a href="mathematics.html#cb472-4" aria-hidden="true" tabindex="-1"></a>ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_choice_unique_sorted<span class="sc">*</span>ar_choice_prob);</span></code></pre></div>
<p>Normalizing and area calculation, following the same principle as above:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="mathematics.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Share of wealth (income etc) accounted for up to this sorted type</span></span>
<span id="cb473-2"><a href="mathematics.html#cb473-2" aria-hidden="true" tabindex="-1"></a>ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb473-3"><a href="mathematics.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. The total area, is the each height times each width summed up</span></span>
<span id="cb473-4"><a href="mathematics.html#cb473-4" aria-hidden="true" tabindex="-1"></a>fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_prob<span class="sc">*</span>ar_height);</span></code></pre></div>
<p>Finally GINI coefficient:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="mathematics.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. area below 45 degree line might not be 1/2, depends on discretness</span></span>
<span id="cb474-2"><a href="mathematics.html#cb474-2" aria-hidden="true" tabindex="-1"></a>fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_prob<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_choice_prob)<span class="sc">/</span><span class="fu">sum</span>(ar_choice_prob)))</span>
<span id="cb474-3"><a href="mathematics.html#cb474-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-4"><a href="mathematics.html#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Gini is the distance between</span></span>
<span id="cb474-5"><a href="mathematics.html#cb474-5" aria-hidden="true" tabindex="-1"></a>fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb474-6"><a href="mathematics.html#cb474-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gini_index=&#39;</span>, fl_gini_index))</span></code></pre></div>
<pre><code>## [1] &quot;fl_gini_index=0.468573066002754&quot;</code></pre>
<div id="discrete-random-variable-as-function" class="section level4" number="8.2.2.1">
<h4><span class="header-section-number">8.2.2.1</span> Discrete Random Variable as Function</h4>
<p>Organizing the code above as a function, and testing results out with the <a href="https://fanwangecon.github.io/Stat4Econ/probability_discrete/htmlpdfr/binomial.html">binomial distribution</a> as an example.</p>
<p>For the binomial distribution, if the probability of success is very close to zero, that means nearly all mass is at lose all or nearly losing all. There will be non-zero but very small mass at higher levels of wins. Hence this should mean extreme inequality. GINI index should be close to 1. Alternatively, GINI index should be close to 0 when we have near 100 percent chance of success, then all mass is at winning all, perfect equality.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="mathematics.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining the code from above</span></span>
<span id="cb476-2"><a href="mathematics.html#cb476-2" aria-hidden="true" tabindex="-1"></a>ffi_dist_gini_random_var_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_x_sorted, ar_prob_of_x) {</span>
<span id="cb476-3"><a href="mathematics.html#cb476-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check length and given warning</span></span>
<span id="cb476-4"><a href="mathematics.html#cb476-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb476-5"><a href="mathematics.html#cb476-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. to normalize, get mean (binomial so mean is p*N=50)</span></span>
<span id="cb476-6"><a href="mathematics.html#cb476-6" aria-hidden="true" tabindex="-1"></a>  fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb476-7"><a href="mathematics.html#cb476-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. get cumulative mean at each point</span></span>
<span id="cb476-8"><a href="mathematics.html#cb476-8" aria-hidden="true" tabindex="-1"></a>  ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb476-9"><a href="mathematics.html#cb476-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Share of wealth (income etc) accounted for up to this sorted type</span></span>
<span id="cb476-10"><a href="mathematics.html#cb476-10" aria-hidden="true" tabindex="-1"></a>  ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb476-11"><a href="mathematics.html#cb476-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. The total area, is the each height times each width summed up</span></span>
<span id="cb476-12"><a href="mathematics.html#cb476-12" aria-hidden="true" tabindex="-1"></a>  fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>ar_height);</span>
<span id="cb476-13"><a href="mathematics.html#cb476-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5. area below 45 degree line might not be 1/2, depends on discretness</span></span>
<span id="cb476-14"><a href="mathematics.html#cb476-14" aria-hidden="true" tabindex="-1"></a>  fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_prob_of_x)<span class="sc">/</span><span class="fu">sum</span>(ar_prob_of_x)))</span>
<span id="cb476-15"><a href="mathematics.html#cb476-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6. Gini is the distance between</span></span>
<span id="cb476-16"><a href="mathematics.html#cb476-16" aria-hidden="true" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb476-17"><a href="mathematics.html#cb476-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb476-18"><a href="mathematics.html#cb476-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini_index)</span>
<span id="cb476-19"><a href="mathematics.html#cb476-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Testing the function with the Binomial Distribution:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="mathematics.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (fl_binom_success_prob <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.0001</span>,<span class="fl">0.9999</span>,<span class="at">length.out=</span><span class="dv">10</span>)) {</span>
<span id="cb477-2"><a href="mathematics.html#cb477-2" aria-hidden="true" tabindex="-1"></a>  ar_x_sorted <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb477-3"><a href="mathematics.html#cb477-3" aria-hidden="true" tabindex="-1"></a>  ar_prob_of_x <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_x_sorted, <span class="dv">100</span>, fl_binom_success_prob)</span>
<span id="cb477-4"><a href="mathematics.html#cb477-4" aria-hidden="true" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> <span class="fu">ffi_dist_gini_random_var_pos_test</span>(ar_x_sorted, ar_prob_of_x)</span>
<span id="cb477-5"><a href="mathematics.html#cb477-5" aria-hidden="true" tabindex="-1"></a>  st_print <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;binom p(success)=&#39;</span>, fl_binom_success_prob ,</span>
<span id="cb477-6"><a href="mathematics.html#cb477-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;, the fl_gini_index=&#39;</span>, fl_gini_index)</span>
<span id="cb477-7"><a href="mathematics.html#cb477-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(st_print)</span>
<span id="cb477-8"><a href="mathematics.html#cb477-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;binom p(success)=0.0001, the fl_gini_index=0.990048846889393&quot;
## [1] &quot;binom p(success)=0.111188888888889, the fl_gini_index=0.147061101509638&quot;
## [1] &quot;binom p(success)=0.222277777777778, the fl_gini_index=0.0989942681255604&quot;
## [1] &quot;binom p(success)=0.333366666666667, the fl_gini_index=0.0753059593394789&quot;
## [1] &quot;binom p(success)=0.444455555555556, the fl_gini_index=0.0596495299535176&quot;
## [1] &quot;binom p(success)=0.555544444444444, the fl_gini_index=0.0476678493269222&quot;
## [1] &quot;binom p(success)=0.666633333333333, the fl_gini_index=0.0375168214334586&quot;
## [1] &quot;binom p(success)=0.777722222222222, the fl_gini_index=0.0280646430085938&quot;
## [1] &quot;binom p(success)=0.888811111111111, the fl_gini_index=0.0180312757603542&quot;
## [1] &quot;binom p(success)=0.9999, the fl_gini_index=0.000000990197372312816&quot;</code></pre>
</div>
<div id="compare-discrete-sample-and-discrete-random-variable-functions-for-gini" class="section level4" number="8.2.2.2">
<h4><span class="header-section-number">8.2.2.2</span> Compare Discrete Sample and Discrete Random Variable Functions for GINI</h4>
<p><a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> provides the GINI implementation for a discrete random variable. The procedure is the same as prior, except now each element of the “x” array has element specific weights associated with it. The function can handle unsorted array with non-unique values.</p>
<p>Test and compare <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> provides the GINI implementation for a discrete random variable and <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a>.</p>
<p>There is a vector of values from 1 to 100, in ascending order. What is the equal-weighted gini, the gini result when smaller numbers have higher weights, and when larger numbers have higher weights?</p>
<p>First, generate the relevant values.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="mathematics.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># array</span></span>
<span id="cb479-2"><a href="mathematics.html#cb479-2" aria-hidden="true" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">30</span>)</span>
<span id="cb479-3"><a href="mathematics.html#cb479-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prob array</span></span>
<span id="cb479-4"><a href="mathematics.html#cb479-4" aria-hidden="true" tabindex="-1"></a>ar_prob_x_unif <span class="ot">&lt;-</span> <span class="fu">rep.int</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_x))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">rep.int</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_x)))</span>
<span id="cb479-5"><a href="mathematics.html#cb479-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prob higher at lower values</span></span>
<span id="cb479-6"><a href="mathematics.html#cb479-6" aria-hidden="true" tabindex="-1"></a>ar_prob_x_lowval_highwgt <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))</span>
<span id="cb479-7"><a href="mathematics.html#cb479-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prob higher at lower values</span></span>
<span id="cb479-8"><a href="mathematics.html#cb479-8" aria-hidden="true" tabindex="-1"></a>ar_prob_x_highval_highwgt <span class="ot">&lt;-</span> (<span class="fu">cumsum</span>(ar_prob_x_unif))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))</span>
<span id="cb479-9"><a href="mathematics.html#cb479-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb479-10"><a href="mathematics.html#cb479-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">cbind</span>(ar_x, ar_prob_x_unif, ar_prob_x_lowval_highwgt, ar_prob_x_highval_highwgt)) <span class="sc">%&gt;%</span></span>
<span id="cb479-11"><a href="mathematics.html#cb479-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_unif
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_lowval_highwgt
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_highval_highwgt
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0645
</td>
<td style="text-align:right;">
0.0022
</td>
</tr>
<tr>
<td style="text-align:right;">
4.414
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0624
</td>
<td style="text-align:right;">
0.0043
</td>
</tr>
<tr>
<td style="text-align:right;">
7.828
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0602
</td>
<td style="text-align:right;">
0.0065
</td>
</tr>
<tr>
<td style="text-align:right;">
11.241
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0581
</td>
<td style="text-align:right;">
0.0086
</td>
</tr>
<tr>
<td style="text-align:right;">
14.655
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0559
</td>
<td style="text-align:right;">
0.0108
</td>
</tr>
<tr>
<td style="text-align:right;">
18.069
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0538
</td>
<td style="text-align:right;">
0.0129
</td>
</tr>
<tr>
<td style="text-align:right;">
21.483
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0516
</td>
<td style="text-align:right;">
0.0151
</td>
</tr>
<tr>
<td style="text-align:right;">
24.897
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0495
</td>
<td style="text-align:right;">
0.0172
</td>
</tr>
<tr>
<td style="text-align:right;">
28.310
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0473
</td>
<td style="text-align:right;">
0.0194
</td>
</tr>
<tr>
<td style="text-align:right;">
31.724
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0452
</td>
<td style="text-align:right;">
0.0215
</td>
</tr>
<tr>
<td style="text-align:right;">
35.138
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0430
</td>
<td style="text-align:right;">
0.0237
</td>
</tr>
<tr>
<td style="text-align:right;">
38.552
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0409
</td>
<td style="text-align:right;">
0.0258
</td>
</tr>
<tr>
<td style="text-align:right;">
41.965
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0387
</td>
<td style="text-align:right;">
0.0280
</td>
</tr>
<tr>
<td style="text-align:right;">
45.379
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0366
</td>
<td style="text-align:right;">
0.0301
</td>
</tr>
<tr>
<td style="text-align:right;">
48.793
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0344
</td>
<td style="text-align:right;">
0.0323
</td>
</tr>
<tr>
<td style="text-align:right;">
52.207
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0323
</td>
<td style="text-align:right;">
0.0344
</td>
</tr>
<tr>
<td style="text-align:right;">
55.621
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0301
</td>
<td style="text-align:right;">
0.0366
</td>
</tr>
<tr>
<td style="text-align:right;">
59.035
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0280
</td>
<td style="text-align:right;">
0.0387
</td>
</tr>
<tr>
<td style="text-align:right;">
62.448
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0258
</td>
<td style="text-align:right;">
0.0409
</td>
</tr>
<tr>
<td style="text-align:right;">
65.862
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0237
</td>
<td style="text-align:right;">
0.0430
</td>
</tr>
<tr>
<td style="text-align:right;">
69.276
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0215
</td>
<td style="text-align:right;">
0.0452
</td>
</tr>
<tr>
<td style="text-align:right;">
72.690
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0194
</td>
<td style="text-align:right;">
0.0473
</td>
</tr>
<tr>
<td style="text-align:right;">
76.103
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0172
</td>
<td style="text-align:right;">
0.0495
</td>
</tr>
<tr>
<td style="text-align:right;">
79.517
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0151
</td>
<td style="text-align:right;">
0.0516
</td>
</tr>
<tr>
<td style="text-align:right;">
82.931
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0129
</td>
<td style="text-align:right;">
0.0538
</td>
</tr>
<tr>
<td style="text-align:right;">
86.345
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0108
</td>
<td style="text-align:right;">
0.0559
</td>
</tr>
<tr>
<td style="text-align:right;">
89.759
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0086
</td>
<td style="text-align:right;">
0.0581
</td>
</tr>
<tr>
<td style="text-align:right;">
93.172
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0065
</td>
<td style="text-align:right;">
0.0602
</td>
</tr>
<tr>
<td style="text-align:right;">
96.586
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0043
</td>
<td style="text-align:right;">
0.0624
</td>
</tr>
<tr>
<td style="text-align:right;">
100.000
</td>
<td style="text-align:right;">
0.0333
</td>
<td style="text-align:right;">
0.0022
</td>
<td style="text-align:right;">
0.0645
</td>
</tr>
</tbody>
</table>
<p>Second, generate GINI values. What should happen?</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> and <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> results should be the same when the uniform distribution is used.</li>
<li>GINI should be higher, more inequality, if there is higher weights on the lower values.</li>
<li>GINI should be lower, more equality, if there is higher weight on the higher values.</li>
</ol>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="mathematics.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_vector_pos</span>(ar_x)</span></code></pre></div>
<pre><code>## [1] 0.3267</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="mathematics.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_unif)</span></code></pre></div>
<pre><code>## [1] 0.3267</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="mathematics.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_lowval_highwgt)</span></code></pre></div>
<pre><code>## [1] 0.401</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="mathematics.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_highval_highwgt)</span></code></pre></div>
<pre><code>## [1] 0.1927</code></pre>

</div>
</div>
<div id="atkinson-inequality-index" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Atkinson Inequality Index</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="atkinson-inequality-measures" class="section level4" number="8.2.3.1">
<h4><span class="header-section-number">8.2.3.1</span> Atkinson Inequality Measures</h4>
<p><a href="https://linkinghub.elsevier.com/retrieve/pii/0022053170900396">Atkinson (JET, 1970)</a> studies five standard inequality measures. Atkinson finds that given the same income data across countries, different inequality measure lead to different rankings of which country is more unequal. Atkinson develops an measure of inequality that changes depending on an inequality aversion parameter.</p>
<p><span class="math display">\[
\text{Atkinson Inequality} =
A\left(
\left\{Y_i\right\}_{i=1}^N,
\lambda
\right)
= 1 -
\left(
\sum_{i=1}^N \frac{1}{N}
  \left(
    \frac{Y_i}{\sum_{j=1}^N \left( \frac{Y_j}{N} \right) }
  \right)^{\lambda}
\right)^{\frac{1}{\lambda}}
\in \left[0,1\right]
\]</span></p>
<p><span class="math inline">\(A\left(\left\{Y_i\right\}_{i=1}^N,\lambda\right)\)</span> equals to zero is perfect equality. 1 is Perfect inequality. If <span class="math inline">\(\lambda=1\)</span>, the inequality measure is always equal to 0 because the planner does not care abouot inequality anymore.</p>
</div>
<div id="atkinson-inequality-function" class="section level4" number="8.2.3.2">
<h4><span class="header-section-number">8.2.3.2</span> Atkinson Inequality Function</h4>
<p>Programming up the equation above, we have:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="mathematics.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb488-2"><a href="mathematics.html#cb488-2" aria-hidden="true" tabindex="-1"></a>ffi_atkinson_ineq <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_data, fl_rho) {</span>
<span id="cb488-3"><a href="mathematics.html#cb488-3" aria-hidden="true" tabindex="-1"></a>  ar_data_demean <span class="ot">&lt;-</span> ar_data<span class="sc">/</span><span class="fu">mean</span>(ar_data)</span>
<span id="cb488-4"><a href="mathematics.html#cb488-4" aria-hidden="true" tabindex="-1"></a>  it_len <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_data_demean)</span>
<span id="cb488-5"><a href="mathematics.html#cb488-5" aria-hidden="true" tabindex="-1"></a>  fl_atkinson <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(ar_data_demean<span class="sc">^</span>{fl_rho}<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>it_len))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>fl_rho)</span>
<span id="cb488-6"><a href="mathematics.html#cb488-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_atkinson)</span>
<span id="cb488-7"><a href="mathematics.html#cb488-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="atkinson-inequality-examples" class="section level4" number="8.2.3.3">
<h4><span class="header-section-number">8.2.3.3</span> Atkinson Inequality Examples</h4>
<p>Given a vectr of observables, compute the atkinson inequality measure given different inequality aversion.</p>
<p>Preference vector and data vector:</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="mathematics.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preference Vector</span></span>
<span id="cb489-2"><a href="mathematics.html#cb489-2" aria-hidden="true" tabindex="-1"></a>ar_rho <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.2</span>,<span class="fl">2.2</span>, <span class="at">length.out=</span><span class="dv">60</span>)))))</span>
<span id="cb489-3"><a href="mathematics.html#cb489-3" aria-hidden="true" tabindex="-1"></a>ar_rho <span class="ot">&lt;-</span> <span class="fu">unique</span>(ar_rho)</span>
<span id="cb489-4"><a href="mathematics.html#cb489-4" aria-hidden="true" tabindex="-1"></a>mt_rho <span class="ot">&lt;-</span> <span class="fu">matrix</span>(ar_rho, <span class="at">nrow=</span><span class="fu">length</span>(ar_rho), <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb489-5"><a href="mathematics.html#cb489-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-6"><a href="mathematics.html#cb489-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Data Vector (not equal outcomes)</span></span>
<span id="cb489-7"><a href="mathematics.html#cb489-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb489-8"><a href="mathematics.html#cb489-8" aria-hidden="true" tabindex="-1"></a>ar_data_rand <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb489-9"><a href="mathematics.html#cb489-9" aria-hidden="true" tabindex="-1"></a>ar_data_rand <span class="ot">&lt;-</span> ar_data_rand <span class="sc">-</span> <span class="fu">min</span>(ar_data_rand) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb489-10"><a href="mathematics.html#cb489-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-11"><a href="mathematics.html#cb489-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Uniform Data Vector (Equal)</span></span>
<span id="cb489-12"><a href="mathematics.html#cb489-12" aria-hidden="true" tabindex="-1"></a>ar_data_unif <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_data_rand))</span>
<span id="cb489-13"><a href="mathematics.html#cb489-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-14"><a href="mathematics.html#cb489-14" aria-hidden="true" tabindex="-1"></a><span class="co"># One Rich (last person has income equal to the sum of all others*100)</span></span>
<span id="cb489-15"><a href="mathematics.html#cb489-15" aria-hidden="true" tabindex="-1"></a>ar_data_onerich <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="fu">length</span>(ar_data_rand))</span>
<span id="cb489-16"><a href="mathematics.html#cb489-16" aria-hidden="true" tabindex="-1"></a>ar_data_onerich[<span class="fu">length</span>(ar_data_onerich)] <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">head</span>(ar_data_onerich,<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<p>Testing Atkinson with different data arrays:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="mathematics.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.1180513</span></span>
<span id="cb490-2"><a href="mathematics.html#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_rand, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1181</code></pre>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="mathematics.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0</span></span>
<span id="cb492-2"><a href="mathematics.html#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="mathematics.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATK = 0.89</span></span>
<span id="cb494-2"><a href="mathematics.html#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_onerich, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8957</code></pre>
<div id="atkinson-inequality-as-inequality-aversion-changes" class="section level5" number="8.2.3.3.1">
<h5><span class="header-section-number">8.2.3.3.1</span> Atkinson Inequality as Inequality Aversion Changes</h5>
<p>This is the vector of inequality aversion parameters:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="mathematics.html#cb496-1" aria-hidden="true" tabindex="-1"></a>ar_rho</span></code></pre></div>
<pre><code>##  [1]    1.00000    0.99369    0.99251    0.99110    0.98944    0.98746    0.98511    0.98232    0.97901    0.97508    0.97041    0.96486    0.95828    0.95046
## [15]    0.94118    0.93017    0.91708    0.90155    0.88310    0.86121    0.83520    0.80433    0.76767    0.72415    0.67247    0.61111    0.53825    0.45174
## [29]    0.34903    0.22708    0.08228   -0.08965   -0.29379   -0.53617   -0.82397   -1.16567   -1.57140   -2.05313   -2.62512   -3.30426   -4.11063   -5.06807
## [43]   -6.20489   -7.55467   -9.15733  -11.06024  -13.31964  -16.00233  -19.18760  -22.96961  -27.46016  -32.79197  -39.12267  -46.63938  -55.56429  -66.16123
## [57]  -78.74343  -93.68282 -111.42100 -132.48231 -157.48932</code></pre>
<p>How does Atkinson Inequality measure change with respect to a vector of random data as inequality aversion shifts:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="mathematics.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb498-2"><a href="mathematics.html#cb498-2" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;Lambda, left Rawlsian, right (1) is Utilitarian&#39;</span></span>
<span id="cb498-3"><a href="mathematics.html#cb498-3" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;Atkinson Inequality, 0 = perfect equal&#39;</span></span>
<span id="cb498-4"><a href="mathematics.html#cb498-4" aria-hidden="true" tabindex="-1"></a>ar_ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb498-5"><a href="mathematics.html#cb498-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_rand, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1181</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="mathematics.html#cb500-1" aria-hidden="true" tabindex="-1"></a>ar_atkinson <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_ineq</span>(ar_data_rand, row[<span class="dv">1</span>])})</span>
<span id="cb500-2"><a href="mathematics.html#cb500-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_rho, ar_atkinson, <span class="at">ylim =</span> ar_ylim)</span>
<span id="cb500-3"><a href="mathematics.html#cb500-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;A vector of Random data&#39;</span>, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label)</span>
<span id="cb500-4"><a href="mathematics.html#cb500-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-246-1.png" width="672" style="display: block; margin: auto;" />
Now with the one person has the wealth of all others in the vector times 10:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="mathematics.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb501-2"><a href="mathematics.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_onerich, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8957</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="mathematics.html#cb503-1" aria-hidden="true" tabindex="-1"></a>ar_atkinson <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_ineq</span>(ar_data_onerich, row[<span class="dv">1</span>])})</span>
<span id="cb503-2"><a href="mathematics.html#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_rho, ar_atkinson, <span class="at">ylim =</span> ar_ylim)</span>
<span id="cb503-3"><a href="mathematics.html#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;1 person has the (income of all others summed up)*10&#39;</span>, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label)</span>
<span id="cb503-4"><a href="mathematics.html#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-247-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The Uniform Results, since allocations are uniform, zero for all:</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="mathematics.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb504-2"><a href="mathematics.html#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="mathematics.html#cb506-1" aria-hidden="true" tabindex="-1"></a>ar_atkinson <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, row[<span class="dv">1</span>])})</span>
<span id="cb506-2"><a href="mathematics.html#cb506-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_rho, ar_atkinson, <span class="at">ylim =</span> ar_ylim)</span>
<span id="cb506-3"><a href="mathematics.html#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;uniform distribution&#39;</span>, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label)</span>
<span id="cb506-4"><a href="mathematics.html#cb506-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-248-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="analyzing-equation-mechanics" class="section level4" number="8.2.3.4">
<h4><span class="header-section-number">8.2.3.4</span> Analyzing Equation Mechanics</h4>
<p>How does the Aktinson Family utility function work? THe Atkinson Family Utility has the following functional form.</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
\alpha
\cdot
A^{\lambda}
+
\beta
\cdot
B^{\lambda}
\right)^{\frac{1}{\lambda}}
\]</span></p>
<p>Several key issues here:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(V^{\text{social}}\)</span> is the utility of some social planner</li>
<li><span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are allocations for Alex and Ben.</li>
<li><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are biases that a social planner has for Alex and Ben: <span class="math inline">\(\alpha+\beta=1\)</span>, <span class="math inline">\(\alpha&gt;0\)</span>, and <span class="math inline">\(\beta&gt;0\)</span></li>
<li><span class="math inline">\(-\infty &lt; \lambda \le 1\)</span> is a measure of inequality aversion
<ul>
<li><span class="math inline">\(\lambda=1\)</span> is when the planner cares about weighted total allocations (efficient, Utilitarian)</li>
<li><span class="math inline">\(\lambda=-\infty\)</span> is when the planner cares about only the minimum between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> allocations (equality, Rawlsian)</li>
</ul></li>
</ol>
<p>What if only care about Alex? Clearly, if the planner only cares about Ben, <span class="math inline">\(\beta=1\)</span>, then:</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
B^{\lambda}
\right)^{\frac{1}{\lambda}}
= B
\]</span></p>
<p>Clearly, regardless of the value of <span class="math inline">\(\lambda\)</span>, as <span class="math inline">\(B\)</span> increases <span class="math inline">\(V\)</span> increases. What Happens to V when A or B increases? What is the derivative of <span class="math inline">\(V\)</span> with respect to <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>?</p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \frac{1}{\lambda}
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1}{\lambda}-1}
    \cdot
    \lambda
    \alpha
    A^{\lambda -1}
\]</span></p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1-\lambda}{\lambda}}
    \cdot
    \alpha
    A^{\lambda -1}
    &gt;0
\]</span></p>
<p>Note that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span>. When <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(Z^{\lambda}&gt;0\)</span>. For example <span class="math inline">\(10^{-2}=\frac{1}{100}\)</span>. And For example <span class="math inline">\(0.1^{\frac{3}{-2}}=\frac{1}{0.1^{1.5}}\)</span>. Still Positive.</p>
<p>While the overall <span class="math inline">\(V\)</span> increases with increasing <span class="math inline">\(A\)</span>, but if we did not have the outter power term, the situation is different. In particular, when <span class="math inline">\(\lambda &lt; 0\)</span>:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{d \left(\alpha A^{\lambda} + \beta B^{\lambda}\right)}{dA}=\alpha\lambda A^{\lambda -1}&lt;0
\]</span>
Without the outter <span class="math inline">\(\frac{1}{\lambda}\)</span> power, negative <span class="math inline">\(\lambda\)</span> would lead to decreasing weighted sum. But:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{dG^{\frac{1}{\lambda}}}{dG}=\frac{1}{\lambda}\cdot G^{\frac{1-\lambda}{\lambda}}&lt;0
\]</span>
so when <span class="math inline">\(G\)</span> is increasing and <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> would decrease. But when <span class="math inline">\(G\left(A,B\right)\)</span> is decreasing, as is the case with increasing <span class="math inline">\(A\)</span> when <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> will actually increase. This confirms that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span> for <span class="math inline">\(\lambda &lt;0\)</span>. The result is symmetric for <span class="math inline">\(\lambda &gt;0\)</span>.</p>
</div>
<div id="indifference-curve-graph" class="section level4" number="8.2.3.5">
<h4><span class="header-section-number">8.2.3.5</span> Indifference Curve Graph</h4>
<p>Given <span class="math inline">\(V^{\ast}\)</span>, we can show the combinations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> points that provide the same utility. We want to be able to potentially draw multiple indifference curves at the same time. Note that indifference curves are defined by <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\lambda\)</span> only. Each indifference curve is a set of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> coordinates. So to generate multiple indifference curves means to generate many sets of <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> associated with different planner preferences, and then these could be graphed out.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="mathematics.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A as x-axis, need bounds on A</span></span>
<span id="cb507-2"><a href="mathematics.html#cb507-2" aria-hidden="true" tabindex="-1"></a>fl_A_min <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb507-3"><a href="mathematics.html#cb507-3" aria-hidden="true" tabindex="-1"></a>fl_A_max <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb507-4"><a href="mathematics.html#cb507-4" aria-hidden="true" tabindex="-1"></a>it_A_grid <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb507-5"><a href="mathematics.html#cb507-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-6"><a href="mathematics.html#cb507-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb507-7"><a href="mathematics.html#cb507-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ar_lambda &lt;- 1 - (10^(c(seq(-2,2, length.out=3))))</span></span>
<span id="cb507-8"><a href="mathematics.html#cb507-8" aria-hidden="true" tabindex="-1"></a>ar_lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.06</span>, <span class="sc">-</span><span class="dv">6</span>)</span>
<span id="cb507-9"><a href="mathematics.html#cb507-9" aria-hidden="true" tabindex="-1"></a>ar_beta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="at">length.out =</span> <span class="dv">3</span>)</span>
<span id="cb507-10"><a href="mathematics.html#cb507-10" aria-hidden="true" tabindex="-1"></a>ar_beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>)</span>
<span id="cb507-11"><a href="mathematics.html#cb507-11" aria-hidden="true" tabindex="-1"></a>ar_v_star <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">1</span>)</span>
<span id="cb507-12"><a href="mathematics.html#cb507-12" aria-hidden="true" tabindex="-1"></a>tb_pref <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb507-13"><a href="mathematics.html#cb507-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(ar_beta) <span class="sc">%&gt;%</span> <span class="fu">expand_grid</span>(ar_v_star) <span class="sc">%&gt;%</span></span>
<span id="cb507-14"><a href="mathematics.html#cb507-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(<span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb507-15"><a href="mathematics.html#cb507-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;indiff_id&quot;</span>)</span>
<span id="cb507-16"><a href="mathematics.html#cb507-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-17"><a href="mathematics.html#cb507-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate indifference points with apply and anonymous function</span></span>
<span id="cb507-18"><a href="mathematics.html#cb507-18" aria-hidden="true" tabindex="-1"></a><span class="co"># tb_pref, whatever is selected from it, must be all numeric</span></span>
<span id="cb507-19"><a href="mathematics.html#cb507-19" aria-hidden="true" tabindex="-1"></a><span class="co"># if there are strings, would cause conversion error.</span></span>
<span id="cb507-20"><a href="mathematics.html#cb507-20" aria-hidden="true" tabindex="-1"></a>ls_df_indiff <span class="ot">&lt;-</span> <span class="fu">apply</span>(tb_pref, <span class="dv">1</span>, <span class="cf">function</span>(x){</span>
<span id="cb507-21"><a href="mathematics.html#cb507-21" aria-hidden="true" tabindex="-1"></a>  indiff_id <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb507-22"><a href="mathematics.html#cb507-22" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb507-23"><a href="mathematics.html#cb507-23" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb507-24"><a href="mathematics.html#cb507-24" aria-hidden="true" tabindex="-1"></a>  vstar <span class="ot">&lt;-</span> x[<span class="dv">4</span>]</span>
<span id="cb507-25"><a href="mathematics.html#cb507-25" aria-hidden="true" tabindex="-1"></a>  ar_fl_A_indiff <span class="ot">&lt;-</span> <span class="fu">seq</span>(fl_A_min, fl_A_max, <span class="at">length.out=</span>it_A_grid)</span>
<span id="cb507-26"><a href="mathematics.html#cb507-26" aria-hidden="true" tabindex="-1"></a>  ar_fl_B_indiff <span class="ot">&lt;-</span> (((vstar<span class="sc">^</span>lambda) <span class="sc">-</span></span>
<span id="cb507-27"><a href="mathematics.html#cb507-27" aria-hidden="true" tabindex="-1"></a>                        (beta<span class="sc">*</span>ar_fl_A_indiff<span class="sc">^</span>(lambda)))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb507-28"><a href="mathematics.html#cb507-28" aria-hidden="true" tabindex="-1"></a>  mt_A_B_indiff <span class="ot">&lt;-</span> <span class="fu">cbind</span>(indiff_id, lambda, beta, vstar,</span>
<span id="cb507-29"><a href="mathematics.html#cb507-29" aria-hidden="true" tabindex="-1"></a>                         ar_fl_A_indiff, ar_fl_B_indiff)</span>
<span id="cb507-30"><a href="mathematics.html#cb507-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(mt_A_B_indiff) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indiff_id&#39;</span>, <span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>,</span>
<span id="cb507-31"><a href="mathematics.html#cb507-31" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;indiff_A&#39;</span>, <span class="st">&#39;indiff_B&#39;</span>)</span>
<span id="cb507-32"><a href="mathematics.html#cb507-32" aria-hidden="true" tabindex="-1"></a>  tb_A_B_indiff <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_A_B_indiff) <span class="sc">%&gt;%</span></span>
<span id="cb507-33"><a href="mathematics.html#cb507-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;A_grid_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb507-34"><a href="mathematics.html#cb507-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(indiff_B <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> indiff_B <span class="sc">&lt;=</span> <span class="fu">max</span>(ar_fl_A_indiff))</span>
<span id="cb507-35"><a href="mathematics.html#cb507-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tb_A_B_indiff)</span>
<span id="cb507-36"><a href="mathematics.html#cb507-36" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb507-37"><a href="mathematics.html#cb507-37" aria-hidden="true" tabindex="-1"></a>df_indiff <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, ls_df_indiff) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code></pre></div>
<p>Note that many more A grid points are needed to fully plot out the leontief line.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="mathematics.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb508-2"><a href="mathematics.html#cb508-2" aria-hidden="true" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Indifference Curves Aktinson Atkinson Utility (CES)&#39;</span>)</span>
<span id="cb508-3"><a href="mathematics.html#cb508-3" aria-hidden="true" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Each Panel Different beta=A</span><span class="sc">\&#39;</span><span class="st">s Weight lambda=inequality aversion</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb508-4"><a href="mathematics.html#cb508-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb508-5"><a href="mathematics.html#cb508-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/func_ineq/htmlpdfr/fs_atkinson_ces.html&#39;</span>)</span>
<span id="cb508-6"><a href="mathematics.html#cb508-6" aria-hidden="true" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Indifference Curve 2 Individuals, &#39;</span>,</span>
<span id="cb508-7"><a href="mathematics.html#cb508-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb508-8"><a href="mathematics.html#cb508-8" aria-hidden="true" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;A&#39;</span></span>
<span id="cb508-9"><a href="mathematics.html#cb508-9" aria-hidden="true" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;B&#39;</span></span>
<span id="cb508-10"><a href="mathematics.html#cb508-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-11"><a href="mathematics.html#cb508-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb508-12"><a href="mathematics.html#cb508-12" aria-hidden="true" tabindex="-1"></a>plt_indiff <span class="ot">&lt;-</span></span>
<span id="cb508-13"><a href="mathematics.html#cb508-13" aria-hidden="true" tabindex="-1"></a>  df_indiff <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">lambda =</span> <span class="fu">as_factor</span>(lambda),</span>
<span id="cb508-14"><a href="mathematics.html#cb508-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fu">as_factor</span>(beta),</span>
<span id="cb508-15"><a href="mathematics.html#cb508-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vstar =</span> <span class="fu">as_factor</span>(vstar)) <span class="sc">%&gt;%</span></span>
<span id="cb508-16"><a href="mathematics.html#cb508-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>indiff_A, <span class="at">y=</span>indiff_B,</span>
<span id="cb508-17"><a href="mathematics.html#cb508-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span>lambda)) <span class="sc">+</span></span>
<span id="cb508-18"><a href="mathematics.html#cb508-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> beta) <span class="sc">+</span></span>
<span id="cb508-19"><a href="mathematics.html#cb508-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb508-20"><a href="mathematics.html#cb508-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb508-21"><a href="mathematics.html#cb508-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption) <span class="sc">+</span></span>
<span id="cb508-22"><a href="mathematics.html#cb508-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb508-23"><a href="mathematics.html#cb508-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-24"><a href="mathematics.html#cb508-24" aria-hidden="true" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb508-25"><a href="mathematics.html#cb508-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt_indiff)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-250-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="location-population-and-pollution" class="section level3" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Location, Population, and Pollution</h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> Package, <a href="https://fanwangecon.github.io/R4Econ/">R Code Examples</a> Repository (<a href="https://fanwangecon.github.io/R4Econ/bookdown">bookdown site</a>), or <a href="https://fanwangecon.github.io/Stat4Econ/">Intro Stats with R</a> Repository (<a href="https://fanwangecon.github.io/Stat4Econ/bookdown">bookdown site</a>).</p>
</blockquote>
<div id="simulate-population-distribution-over-location-and-demographics" class="section level4" number="8.2.4.1">
<h4><span class="header-section-number">8.2.4.1</span> Simulate Population Distribution over Location and Demographics</h4>
<p>Use the binomial distribution to generate heterogenous demographic break-down by location. There are N demographic cells, and the binomial distribution provides the probability mass in each of the N cell. Different bernoulli “win” chance for each location. There is also probability distribution over population in each location.</p>
<p>First, construct empty population share dataframe:</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="mathematics.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7 different age groups and 12 different locationso</span></span>
<span id="cb509-2"><a href="mathematics.html#cb509-2" aria-hidden="true" tabindex="-1"></a>it_N_pop_groups <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb509-3"><a href="mathematics.html#cb509-3" aria-hidden="true" tabindex="-1"></a>it_M_location <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb509-4"><a href="mathematics.html#cb509-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix of demographics by location</span></span>
<span id="cb509-5"><a href="mathematics.html#cb509-5" aria-hidden="true" tabindex="-1"></a>mt_pop_data_frac <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span>it_M_location, <span class="at">ncol=</span>it_N_pop_groups)  </span>
<span id="cb509-6"><a href="mathematics.html#cb509-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mt_pop_data_frac) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;popgrp&#39;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,it_N_pop_groups))</span>
<span id="cb509-7"><a href="mathematics.html#cb509-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mt_pop_data_frac) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;location&#39;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,it_M_location))</span>
<span id="cb509-8"><a href="mathematics.html#cb509-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb509-9"><a href="mathematics.html#cb509-9" aria-hidden="true" tabindex="-1"></a>mt_pop_data_frac <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp1
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp2
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp3
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp4
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp5
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp6
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp7
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p>Second, generate conditional population distribution for each location, and then multiply by the share of population in each locality:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="mathematics.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Share of population per location</span></span>
<span id="cb510-2"><a href="mathematics.html#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb510-3"><a href="mathematics.html#cb510-3" aria-hidden="true" tabindex="-1"></a>ar_p_loc <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span>it_M_location<span class="dv">-1</span>), <span class="dv">3</span><span class="sc">*</span>it_M_location<span class="dv">-1</span>, <span class="fl">0.5</span>)</span>
<span id="cb510-4"><a href="mathematics.html#cb510-4" aria-hidden="true" tabindex="-1"></a>it_start <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_p_loc)<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>it_M_location<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb510-5"><a href="mathematics.html#cb510-5" aria-hidden="true" tabindex="-1"></a>ar_p_loc <span class="ot">&lt;-</span> ar_p_loc[it_start<span class="sc">:</span>(it_start<span class="sc">+</span>it_M_location<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb510-6"><a href="mathematics.html#cb510-6" aria-hidden="true" tabindex="-1"></a>ar_p_loc <span class="ot">&lt;-</span> ar_p_loc<span class="sc">/</span><span class="fu">sum</span>(ar_p_loc)</span>
<span id="cb510-7"><a href="mathematics.html#cb510-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-8"><a href="mathematics.html#cb510-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Different bernoulli &quot;win&quot; probability for each location</span></span>
<span id="cb510-9"><a href="mathematics.html#cb510-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb510-10"><a href="mathematics.html#cb510-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ar_fl_unif_prob &lt;- sort(runif(it_M_location)*(0.25)+0.4)</span></span>
<span id="cb510-11"><a href="mathematics.html#cb510-11" aria-hidden="true" tabindex="-1"></a>ar_fl_unif_prob <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(it_M_location))</span>
<span id="cb510-12"><a href="mathematics.html#cb510-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-13"><a href="mathematics.html#cb510-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate population proportion by locality</span></span>
<span id="cb510-14"><a href="mathematics.html#cb510-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it_loc <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>it_M_location ) {</span>
<span id="cb510-15"><a href="mathematics.html#cb510-15" aria-hidden="true" tabindex="-1"></a>  ar_p_pop_condi_loc <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>(it_N_pop_groups<span class="dv">-1</span>), it_N_pop_groups<span class="dv">-1</span>, ar_fl_unif_prob[it_loc])</span>
<span id="cb510-16"><a href="mathematics.html#cb510-16" aria-hidden="true" tabindex="-1"></a>  mt_pop_data_frac[it_loc,] <span class="ot">&lt;-</span> ar_p_pop_condi_loc<span class="sc">*</span>ar_p_loc[it_loc]</span>
<span id="cb510-17"><a href="mathematics.html#cb510-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb510-18"><a href="mathematics.html#cb510-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-19"><a href="mathematics.html#cb510-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum of cells, should equal to 1</span></span>
<span id="cb510-20"><a href="mathematics.html#cb510-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;pop frac sum = &#39;</span>, <span class="fu">sum</span>(mt_pop_data_frac)))</span></code></pre></div>
<pre><code>## [1] &quot;pop frac sum = 0.962953679726938&quot;</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="mathematics.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb512-2"><a href="mathematics.html#cb512-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(mt_pop_data_frac<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb512-3"><a href="mathematics.html#cb512-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&#39;Share of population in each location and demographic cell&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb512-4"><a href="mathematics.html#cb512-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-253">Table 8.2: </span>Share of population in each location and demographic cell
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp7
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:right;">
1.63
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
1.40
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
1.90
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
1.73
</td>
<td style="text-align:right;">
2.89
</td>
<td style="text-align:right;">
2.71
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
2.89
</td>
<td style="text-align:right;">
3.93
</td>
<td style="text-align:right;">
2.85
</td>
<td style="text-align:right;">
0.86
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
2.23
</td>
<td style="text-align:right;">
4.26
</td>
<td style="text-align:right;">
4.33
</td>
<td style="text-align:right;">
1.83
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:right;">
4.03
</td>
<td style="text-align:right;">
4.72
</td>
<td style="text-align:right;">
2.31
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
3.28
</td>
<td style="text-align:right;">
4.55
</td>
<td style="text-align:right;">
2.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
2.57
</td>
<td style="text-align:right;">
3.68
</td>
<td style="text-align:right;">
2.19
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
4.38
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
1.28
</td>
<td style="text-align:right;">
2.82
</td>
</tr>
</tbody>
</table>
</div>
<div id="simulate-enviromental-exposure" class="section level4" number="8.2.4.2">
<h4><span class="header-section-number">8.2.4.2</span> Simulate Enviromental Exposure</h4>
<p>Use log-normal distribution to describe average daily PM10 exposures distribution by locality:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="mathematics.html#cb513-1" aria-hidden="true" tabindex="-1"></a>fl_meanlog <span class="ot">&lt;-</span> <span class="fl">3.4</span></span>
<span id="cb513-2"><a href="mathematics.html#cb513-2" aria-hidden="true" tabindex="-1"></a>fl_sdlog <span class="ot">&lt;-</span> <span class="fl">0.35</span></span>
<span id="cb513-3"><a href="mathematics.html#cb513-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="at">meanlog =</span> fl_meanlog, <span class="at">sdlog =</span> fl_sdlog))</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-254-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>First, draw pollution measure for each locality:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="mathematics.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw</span></span>
<span id="cb514-2"><a href="mathematics.html#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb514-3"><a href="mathematics.html#cb514-3" aria-hidden="true" tabindex="-1"></a>ar_pollution_loc <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(it_M_location, <span class="at">meanlog =</span> fl_meanlog, <span class="at">sdlog =</span> fl_sdlog)</span>
<span id="cb514-4"><a href="mathematics.html#cb514-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pollution dataframe</span></span>
<span id="cb514-5"><a href="mathematics.html#cb514-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 by 3 matrix</span></span>
<span id="cb514-6"><a href="mathematics.html#cb514-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-7"><a href="mathematics.html#cb514-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Names</span></span>
<span id="cb514-8"><a href="mathematics.html#cb514-8" aria-hidden="true" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;location&#39;</span>,<span class="st">&#39;avgdailypm10&#39;</span>)</span>
<span id="cb514-9"><a href="mathematics.html#cb514-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-10"><a href="mathematics.html#cb514-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine to tibble, add name col1, col2, etc.</span></span>
<span id="cb514-11"><a href="mathematics.html#cb514-11" aria-hidden="true" tabindex="-1"></a>tb_loc_pollution <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(ar_pollution_loc) <span class="sc">%&gt;%</span></span>
<span id="cb514-12"><a href="mathematics.html#cb514-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb514-13"><a href="mathematics.html#cb514-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_varnames)) <span class="sc">%&gt;%</span></span>
<span id="cb514-14"><a href="mathematics.html#cb514-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="fu">paste0</span>(<span class="st">&#39;location&#39;</span>, location))</span>
<span id="cb514-15"><a href="mathematics.html#cb514-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-16"><a href="mathematics.html#cb514-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb514-17"><a href="mathematics.html#cb514-17" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tb_loc_pollution) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
location
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
avgdailypm10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:right;">
51.70
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:right;">
30.71
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:right;">
31.35
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:right;">
54.61
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:right;">
35.21
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:right;">
19.24
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:right;">
23.56
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:right;">
25.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:right;">
45.99
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:right;">
33.99
</td>
</tr>
</tbody>
</table>
<p>Second, reshape population data:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="mathematics.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape population data, so each observation is location/demo</span></span>
<span id="cb515-2"><a href="mathematics.html#cb515-2" aria-hidden="true" tabindex="-1"></a>df_pop_data_frac_long <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_pop_data_frac, <span class="at">rownames=</span><span class="st">&#39;location&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb515-3"><a href="mathematics.html#cb515-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&#39;popgrp&#39;</span>),</span>
<span id="cb515-4"><a href="mathematics.html#cb515-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;popgrp&#39;</span>),</span>
<span id="cb515-5"><a href="mathematics.html#cb515-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="fu">paste0</span>(<span class="st">&quot;popgrp(.*)&quot;</span>),</span>
<span id="cb515-6"><a href="mathematics.html#cb515-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;pop_frac&quot;</span>)</span></code></pre></div>
<p>Third, join with pollution data:</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="mathematics.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape population data, so each observation is location/demo</span></span>
<span id="cb516-2"><a href="mathematics.html#cb516-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_long <span class="ot">&lt;-</span> df_pop_data_frac_long <span class="sc">%&gt;%</span></span>
<span id="cb516-3"><a href="mathematics.html#cb516-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tb_loc_pollution, <span class="at">by=</span><span class="st">&#39;location&#39;</span>)</span>
<span id="cb516-4"><a href="mathematics.html#cb516-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-5"><a href="mathematics.html#cb516-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb516-6"><a href="mathematics.html#cb516-6" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_long[<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(it_N_pop_groups<span class="sc">*</span><span class="fl">2.5</span>),] <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
location
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pop_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
avgdailypm10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0109
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0013
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
24.63
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0163
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0070
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0013
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0059
</td>
<td style="text-align:right;">
51.70
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0140
</td>
<td style="text-align:right;">
51.70
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0139
</td>
<td style="text-align:right;">
51.70
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0074
</td>
<td style="text-align:right;">
51.70
</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-demographic-group-specific-exposure-distributions" class="section level4" number="8.2.4.3">
<h4><span class="header-section-number">8.2.4.3</span> Compute Demographic Group Specific Exposure Distributions</h4>
<p>What is the p10, median, p90 and mean pollution exposure for each demographic group?</p>
<ol style="list-style-type: decimal">
<li>group by population group</li>
<li>sort by pollution exposure within group</li>
<li>generate population group specific conditional population weights</li>
<li>generate population CDF for each population group (sorted by pollution)</li>
</ol>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="mathematics.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Follow four steps above</span></span>
<span id="cb517-2"><a href="mathematics.html#cb517-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_by_popgrp_cdf <span class="ot">&lt;-</span> df_pop_pollution_long <span class="sc">%&gt;%</span></span>
<span id="cb517-3"><a href="mathematics.html#cb517-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(popgrp, avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb517-4"><a href="mathematics.html#cb517-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(popgrp) <span class="sc">%&gt;%</span></span>
<span id="cb517-5"><a href="mathematics.html#cb517-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdf_pop_condi_popgrp_sortpm10 =</span> <span class="fu">cumsum</span>(pop_frac<span class="sc">/</span><span class="fu">sum</span>(pop_frac)),</span>
<span id="cb517-6"><a href="mathematics.html#cb517-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pmf_pop_condi_popgrp_sortpm10 =</span> (pop_frac<span class="sc">/</span><span class="fu">sum</span>(pop_frac)))</span>
<span id="cb517-7"><a href="mathematics.html#cb517-7" aria-hidden="true" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb517-8"><a href="mathematics.html#cb517-8" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_by_popgrp_cdf[<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(it_N_pop_groups<span class="sc">*</span><span class="fl">5.5</span>),] <span class="sc">%&gt;%</span> </span>
<span id="cb517-9"><a href="mathematics.html#cb517-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
location
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pop_frac
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
avgdailypm10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
cdf_pop_condi_popgrp_sortpm10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pmf_pop_condi_popgrp_sortpm10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
0.0010
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
0.0015
</td>
<td style="text-align:right;">
0.0004
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0109
</td>
<td style="text-align:right;">
24.63
</td>
<td style="text-align:right;">
0.3156
</td>
<td style="text-align:right;">
0.3142
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
25.64
</td>
<td style="text-align:right;">
0.3159
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0163
</td>
<td style="text-align:right;">
27.64
</td>
<td style="text-align:right;">
0.7842
</td>
<td style="text-align:right;">
0.4682
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0006
</td>
<td style="text-align:right;">
30.71
</td>
<td style="text-align:right;">
0.8011
</td>
<td style="text-align:right;">
0.0169
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
31.35
</td>
<td style="text-align:right;">
0.8223
</td>
<td style="text-align:right;">
0.0212
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
33.99
</td>
<td style="text-align:right;">
0.8223
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
35.21
</td>
<td style="text-align:right;">
0.8243
</td>
<td style="text-align:right;">
0.0020
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
45.99
</td>
<td style="text-align:right;">
0.8243
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0059
</td>
<td style="text-align:right;">
51.70
</td>
<td style="text-align:right;">
0.9931
</td>
<td style="text-align:right;">
0.1688
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
54.61
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
0.0069
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0006
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
0.0173
</td>
<td style="text-align:right;">
0.0173
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0003
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
0.0258
</td>
<td style="text-align:right;">
0.0085
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0013
</td>
<td style="text-align:right;">
24.63
</td>
<td style="text-align:right;">
0.0620
</td>
<td style="text-align:right;">
0.0362
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
25.64
</td>
<td style="text-align:right;">
0.0681
</td>
<td style="text-align:right;">
0.0060
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0070
</td>
<td style="text-align:right;">
27.64
</td>
<td style="text-align:right;">
0.2575
</td>
<td style="text-align:right;">
0.1894
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0043
</td>
<td style="text-align:right;">
30.71
</td>
<td style="text-align:right;">
0.3729
</td>
<td style="text-align:right;">
0.1154
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0055
</td>
<td style="text-align:right;">
31.35
</td>
<td style="text-align:right;">
0.5228
</td>
<td style="text-align:right;">
0.1499
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
33.99
</td>
<td style="text-align:right;">
0.5228
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0010
</td>
<td style="text-align:right;">
35.21
</td>
<td style="text-align:right;">
0.5508
</td>
<td style="text-align:right;">
0.0280
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
45.99
</td>
<td style="text-align:right;">
0.5508
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0140
</td>
<td style="text-align:right;">
51.70
</td>
<td style="text-align:right;">
0.9290
</td>
<td style="text-align:right;">
0.3782
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.0026
</td>
<td style="text-align:right;">
54.61
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
0.0710
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0047
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
0.0638
</td>
<td style="text-align:right;">
0.0638
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0027
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
0.1010
</td>
<td style="text-align:right;">
0.0371
</td>
</tr>
<tr>
<td style="text-align:left;">
location1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0001
</td>
<td style="text-align:right;">
24.63
</td>
<td style="text-align:right;">
0.1019
</td>
<td style="text-align:right;">
0.0009
</td>
</tr>
<tr>
<td style="text-align:left;">
location10
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0020
</td>
<td style="text-align:right;">
25.64
</td>
<td style="text-align:right;">
0.1291
</td>
<td style="text-align:right;">
0.0272
</td>
</tr>
<tr>
<td style="text-align:left;">
location2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0013
</td>
<td style="text-align:right;">
27.64
</td>
<td style="text-align:right;">
0.1462
</td>
<td style="text-align:right;">
0.0171
</td>
</tr>
<tr>
<td style="text-align:left;">
location4
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0129
</td>
<td style="text-align:right;">
30.71
</td>
<td style="text-align:right;">
0.3222
</td>
<td style="text-align:right;">
0.1760
</td>
</tr>
<tr>
<td style="text-align:left;">
location5
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0173
</td>
<td style="text-align:right;">
31.35
</td>
<td style="text-align:right;">
0.5583
</td>
<td style="text-align:right;">
0.2361
</td>
</tr>
<tr>
<td style="text-align:left;">
location12
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
33.99
</td>
<td style="text-align:right;">
0.5585
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
location7
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0066
</td>
<td style="text-align:right;">
35.21
</td>
<td style="text-align:right;">
0.6482
</td>
<td style="text-align:right;">
0.0897
</td>
</tr>
<tr>
<td style="text-align:left;">
location11
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
45.99
</td>
<td style="text-align:right;">
0.6485
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
location3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0139
</td>
<td style="text-align:right;">
51.70
</td>
<td style="text-align:right;">
0.8377
</td>
<td style="text-align:right;">
0.1891
</td>
</tr>
<tr>
<td style="text-align:left;">
location6
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.0119
</td>
<td style="text-align:right;">
54.61
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
0.1623
</td>
</tr>
<tr>
<td style="text-align:left;">
location8
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0183
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
0.1225
</td>
<td style="text-align:right;">
0.1225
</td>
</tr>
<tr>
<td style="text-align:left;">
location9
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.0126
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
0.2067
</td>
<td style="text-align:right;">
0.0843
</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-the-gini-index-by-population-subgroup" class="section level4" number="8.2.4.4">
<h4><span class="header-section-number">8.2.4.4</span> Compute the Gini Index by Population Subgroup</h4>
<p>The Gini index from <a href="https://fanwangecon.github.io/R4Econ/math/func_ineq/htmlpdfr/fs_gini_disc.html">fs_gini_disc</a>.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="mathematics.html#cb518-1" aria-hidden="true" tabindex="-1"></a>ffi_dist_gini_random_var_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_x_sorted, ar_prob_of_x) {</span>
<span id="cb518-2"><a href="mathematics.html#cb518-2" aria-hidden="true" tabindex="-1"></a>  fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb518-3"><a href="mathematics.html#cb518-3" aria-hidden="true" tabindex="-1"></a>  ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb518-4"><a href="mathematics.html#cb518-4" aria-hidden="true" tabindex="-1"></a>  ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb518-5"><a href="mathematics.html#cb518-5" aria-hidden="true" tabindex="-1"></a>  fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>ar_height);</span>
<span id="cb518-6"><a href="mathematics.html#cb518-6" aria-hidden="true" tabindex="-1"></a>  fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_prob_of_x)<span class="sc">/</span><span class="fu">sum</span>(ar_prob_of_x)))</span>
<span id="cb518-7"><a href="mathematics.html#cb518-7" aria-hidden="true" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb518-8"><a href="mathematics.html#cb518-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini_index)</span>
<span id="cb518-9"><a href="mathematics.html#cb518-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Compute Gini index for sub-group:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="mathematics.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute GINI by group</span></span>
<span id="cb519-2"><a href="mathematics.html#cb519-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollu_gini <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span></span>
<span id="cb519-3"><a href="mathematics.html#cb519-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(popgrp) <span class="sc">%&gt;%</span></span>
<span id="cb519-4"><a href="mathematics.html#cb519-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">popgrp_gini =</span> <span class="fu">ffi_dist_gini_random_var_pos_test</span>(</span>
<span id="cb519-5"><a href="mathematics.html#cb519-5" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>avgdailypm10, .<span class="sc">$</span>pmf_pop_condi_popgrp_sortpm10)) <span class="sc">%&gt;%</span></span>
<span id="cb519-6"><a href="mathematics.html#cb519-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(popgrp_gini)) <span class="sc">%&gt;%</span></span>
<span id="cb519-7"><a href="mathematics.html#cb519-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb519-8"><a href="mathematics.html#cb519-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(popgrp) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(1L) <span class="sc">%&gt;%</span> </span>
<span id="cb519-9"><a href="mathematics.html#cb519-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp)</span>
<span id="cb519-10"><a href="mathematics.html#cb519-10" aria-hidden="true" tabindex="-1"></a>              , <span class="at">by=</span><span class="st">&quot;popgrp&quot;</span>)</span>
<span id="cb519-11"><a href="mathematics.html#cb519-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb519-12"><a href="mathematics.html#cb519-12" aria-hidden="true" tabindex="-1"></a>df_pop_pollu_gini <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp_gini
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.1207
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.1075
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.1380
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.1543
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.1680
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.1754
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.1453
</td>
</tr>
</tbody>
</table>
</div>
<div id="visualize-the-distributions" class="section level4" number="8.2.4.5">
<h4><span class="header-section-number">8.2.4.5</span> Visualize the Distributions</h4>
<p>Visualizing distributions. Visualize the CDF:</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="mathematics.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visaulize Distributions, CDF for different population groups</span></span>
<span id="cb520-2"><a href="mathematics.html#cb520-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span></span>
<span id="cb520-3"><a href="mathematics.html#cb520-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(popgrp, avgdailypm10, cdf_pop_condi_popgrp_sortpm10 ) <span class="sc">%&gt;%</span></span>
<span id="cb520-4"><a href="mathematics.html#cb520-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>avgdailypm10, <span class="at">y=</span>cdf_pop_condi_popgrp_sortpm10, </span>
<span id="cb520-5"><a href="mathematics.html#cb520-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span>popgrp)) <span class="sc">+</span></span>
<span id="cb520-6"><a href="mathematics.html#cb520-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb520-7"><a href="mathematics.html#cb520-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb520-8"><a href="mathematics.html#cb520-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;CDF of Pollution Distribution by Population Types&#39;</span>,</span>
<span id="cb520-9"><a href="mathematics.html#cb520-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Pollution Levels&#39;</span>,</span>
<span id="cb520-10"><a href="mathematics.html#cb520-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Cumulative Probability Mass&#39;</span>,</span>
<span id="cb520-11"><a href="mathematics.html#cb520-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;Testing Data&#39;</span>) </span>
<span id="cb520-12"><a href="mathematics.html#cb520-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lineplot)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-261-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Visualize the Probability Mass (real data should look much less chaotic than this):</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="mathematics.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visaulize Distributions, CDF for different population groups</span></span>
<span id="cb521-2"><a href="mathematics.html#cb521-2" aria-hidden="true" tabindex="-1"></a>lineplot_pmf <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span></span>
<span id="cb521-3"><a href="mathematics.html#cb521-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(popgrp, avgdailypm10, pmf_pop_condi_popgrp_sortpm10 ) <span class="sc">%&gt;%</span></span>
<span id="cb521-4"><a href="mathematics.html#cb521-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>avgdailypm10, <span class="at">y=</span>pmf_pop_condi_popgrp_sortpm10, </span>
<span id="cb521-5"><a href="mathematics.html#cb521-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span>popgrp)) <span class="sc">+</span></span>
<span id="cb521-6"><a href="mathematics.html#cb521-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb521-7"><a href="mathematics.html#cb521-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb521-8"><a href="mathematics.html#cb521-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Prob Mass Func of Pollution by Population Types&#39;</span>,</span>
<span id="cb521-9"><a href="mathematics.html#cb521-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Pollution Levels&#39;</span>,</span>
<span id="cb521-10"><a href="mathematics.html#cb521-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;Probability Mass&#39;</span>,</span>
<span id="cb521-11"><a href="mathematics.html#cb521-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;Testing Data&#39;</span>) </span>
<span id="cb521-12"><a href="mathematics.html#cb521-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lineplot_pmf)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-262-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="various-quantiles" class="section level4" number="8.2.4.6">
<h4><span class="header-section-number">8.2.4.6</span> Various Quantiles</h4>
<p>Measure quantiles of pollution exposures for different population groups:</p>
<ol style="list-style-type: decimal">
<li>Consider CDF larger than current quantile of interest.</li>
<li>Slice group-specific CDF that is higher and closest to quantile of interest.</li>
<li>Merge results for different quantiles together.</li>
</ol>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="mathematics.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate pollution quantiles by population groups</span></span>
<span id="cb522-2"><a href="mathematics.html#cb522-2" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_distribution <span class="ot">&lt;-</span> df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb522-3"><a href="mathematics.html#cb522-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pm10_mean =</span> <span class="fu">weighted.mean</span>(avgdailypm10, pop_frac)) <span class="sc">%&gt;%</span></span>
<span id="cb522-4"><a href="mathematics.html#cb522-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-5"><a href="mathematics.html#cb522-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-6"><a href="mathematics.html#cb522-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pm10_p10 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb522-7"><a href="mathematics.html#cb522-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(popgrp, pm10_mean, pm10_p10) <span class="sc">%&gt;%</span></span>
<span id="cb522-8"><a href="mathematics.html#cb522-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollu_gini, <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb522-9"><a href="mathematics.html#cb522-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb522-10"><a href="mathematics.html#cb522-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-11"><a href="mathematics.html#cb522-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-12"><a href="mathematics.html#cb522-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p20 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb522-13"><a href="mathematics.html#cb522-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p20), </span>
<span id="cb522-14"><a href="mathematics.html#cb522-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-15"><a href="mathematics.html#cb522-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb522-16"><a href="mathematics.html#cb522-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-17"><a href="mathematics.html#cb522-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-18"><a href="mathematics.html#cb522-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p50 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb522-19"><a href="mathematics.html#cb522-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p50), </span>
<span id="cb522-20"><a href="mathematics.html#cb522-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-21"><a href="mathematics.html#cb522-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb522-22"><a href="mathematics.html#cb522-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-23"><a href="mathematics.html#cb522-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-24"><a href="mathematics.html#cb522-24" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p80 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb522-25"><a href="mathematics.html#cb522-25" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p80), </span>
<span id="cb522-26"><a href="mathematics.html#cb522-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-27"><a href="mathematics.html#cb522-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_pop_pollution_by_popgrp_cdf <span class="sc">%&gt;%</span> </span>
<span id="cb522-28"><a href="mathematics.html#cb522-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cdf_pop_condi_popgrp_sortpm10 <span class="sc">&gt;=</span> <span class="fl">0.90</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-29"><a href="mathematics.html#cb522-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-30"><a href="mathematics.html#cb522-30" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pm10_p90 =</span> avgdailypm10) <span class="sc">%&gt;%</span></span>
<span id="cb522-31"><a href="mathematics.html#cb522-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(popgrp, pm10_p90), </span>
<span id="cb522-32"><a href="mathematics.html#cb522-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&#39;popgrp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-33"><a href="mathematics.html#cb522-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(popgrp, pm10_mean, popgrp_gini, <span class="fu">everything</span>())</span>
<span id="cb522-34"><a href="mathematics.html#cb522-34" aria-hidden="true" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb522-35"><a href="mathematics.html#cb522-35" aria-hidden="true" tabindex="-1"></a>df_pop_pollution_distribution <span class="sc">%&gt;%</span> </span>
<span id="cb522-36"><a href="mathematics.html#cb522-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&#39;PM10 Exposure Distribution by Population Groups&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb522-37"><a href="mathematics.html#cb522-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-263">Table 8.3: </span>PM10 Exposure Distribution by Population Groups
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
popgrp
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
popgrp_gini
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p20
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p50
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p80
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pm10_p90
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
31.08
</td>
<td style="text-align:right;">
0.1207
</td>
<td style="text-align:right;">
24.63
</td>
<td style="text-align:right;">
24.63
</td>
<td style="text-align:right;">
27.64
</td>
<td style="text-align:right;">
30.71
</td>
<td style="text-align:right;">
51.70
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
39.48
</td>
<td style="text-align:right;">
0.1075
</td>
<td style="text-align:right;">
27.64
</td>
<td style="text-align:right;">
27.64
</td>
<td style="text-align:right;">
31.35
</td>
<td style="text-align:right;">
51.70
</td>
<td style="text-align:right;">
51.70
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
37.93
</td>
<td style="text-align:right;">
0.1380
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
30.71
</td>
<td style="text-align:right;">
31.35
</td>
<td style="text-align:right;">
51.70
</td>
<td style="text-align:right;">
54.61
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
34.86
</td>
<td style="text-align:right;">
0.1543
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
31.35
</td>
<td style="text-align:right;">
51.70
</td>
<td style="text-align:right;">
54.61
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
32.57
</td>
<td style="text-align:right;">
0.1680
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
30.71
</td>
<td style="text-align:right;">
35.21
</td>
<td style="text-align:right;">
54.61
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
31.47
</td>
<td style="text-align:right;">
0.1754
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
25.64
</td>
<td style="text-align:right;">
35.21
</td>
<td style="text-align:right;">
54.61
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
33.51
</td>
<td style="text-align:right;">
0.1453
</td>
<td style="text-align:right;">
19.24
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:right;">
33.99
</td>
<td style="text-align:right;">
45.99
</td>
<td style="text-align:right;">
45.99
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="optimization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
