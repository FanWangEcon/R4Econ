<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R</title>
  <meta name="description" content="Running parallel code in R" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Running parallel code in R" />
  <meta name="github-repo" content="fanwangecon/R4Econ" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Mathematics | Data Structures, Estimation and Optimization with R" />
  
  <meta name="twitter:description" content="Running parallel code in R" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="optimization.html"/>
<link rel="next" href="statistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Structures and Estimation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html"><i class="fa fa-check"></i><b>1</b> Array, Matrix, Dataframe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#list"><i class="fa fa-check"></i><b>1.1</b> List</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#lists"><i class="fa fa-check"></i><b>1.1.1</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array"><i class="fa fa-check"></i><b>1.2</b> Array</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#array-basics"><i class="fa fa-check"></i><b>1.2.1</b> Array Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-arrays"><i class="fa fa-check"></i><b>1.2.2</b> Generate Arrays</a></li>
<li class="chapter" data-level="1.2.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-arrays"><i class="fa fa-check"></i><b>1.2.3</b> String Arrays</a></li>
<li class="chapter" data-level="1.2.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#mesh-matrices-arrays-and-scalars"><i class="fa fa-check"></i><b>1.2.4</b> Mesh Matrices, Arrays and Scalars</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#matrix"><i class="fa fa-check"></i><b>1.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#generate-matrixes"><i class="fa fa-check"></i><b>1.3.1</b> Generate Matrixes</a></li>
<li class="chapter" data-level="1.3.2" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#linear-algebra"><i class="fa fa-check"></i><b>1.3.2</b> Linear Algebra</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#regular-expression-date-etc."><i class="fa fa-check"></i><b>1.4</b> Regular Expression, Date, etc.</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="array-matrix-dataframe.html"><a href="array-matrix-dataframe.html#string-regular-expression"><i class="fa fa-check"></i><b>1.4.1</b> String Regular Expression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html"><i class="fa fa-check"></i><b>2</b> Manipulate and Summarize Dataframes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#variables-in-dataframes"><i class="fa fa-check"></i><b>2.1</b> Variables in Dataframes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-dataframe"><i class="fa fa-check"></i><b>2.1.1</b> Generate Dataframe</a></li>
<li class="chapter" data-level="2.1.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-categorical-variables"><i class="fa fa-check"></i><b>2.1.2</b> Generate Categorical Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#drawly-random-rows"><i class="fa fa-check"></i><b>2.1.3</b> Drawly Random Rows</a></li>
<li class="chapter" data-level="2.1.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#generate-variables-conditional-on-others"><i class="fa fa-check"></i><b>2.1.4</b> Generate Variables Conditional On Others</a></li>
<li class="chapter" data-level="2.1.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#string-dataframes"><i class="fa fa-check"></i><b>2.1.5</b> String Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-observation"><i class="fa fa-check"></i><b>2.2</b> Counting Observation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#counting-and-tabulations"><i class="fa fa-check"></i><b>2.2.1</b> Counting and Tabulations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-indexing-slicing"><i class="fa fa-check"></i><b>2.3</b> Sorting, Indexing, Slicing</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#sorting-1"><i class="fa fa-check"></i><b>2.3.1</b> Sorting</a></li>
<li class="chapter" data-level="2.3.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#group-sort-and-slice"><i class="fa fa-check"></i><b>2.3.2</b> Group, Sort and Slice</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#advanced-group-aggregation"><i class="fa fa-check"></i><b>2.4</b> Advanced Group Aggregation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#cumulative-statistics-within-group"><i class="fa fa-check"></i><b>2.4.1</b> Cumulative Statistics within Group</a></li>
<li class="chapter" data-level="2.4.2" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#groups-statistics"><i class="fa fa-check"></i><b>2.4.2</b> Groups Statistics</a></li>
<li class="chapter" data-level="2.4.3" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#one-variable-group-summary"><i class="fa fa-check"></i><b>2.4.3</b> One Variable Group Summary</a></li>
<li class="chapter" data-level="2.4.4" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#nested-within-group-stats"><i class="fa fa-check"></i><b>2.4.4</b> Nested within Group Stats</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#distributional-statistics"><i class="fa fa-check"></i><b>2.5</b> Distributional Statistics</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#histogram"><i class="fa fa-check"></i><b>2.5.1</b> Histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>2.6</b> Summarize Multiple Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="manipulate-and-summarize-dataframes.html"><a href="manipulate-and-summarize-dataframes.html#apply-function-over-multiple-columns-and-rows"><i class="fa fa-check"></i><b>2.6.1</b> Apply Function Over Multiple Columns and Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#dataframe-mutate"><i class="fa fa-check"></i><b>3.1</b> Dataframe Mutate</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="functions.html"><a href="functions.html#row-input-functions"><i class="fa fa-check"></i><b>3.1.1</b> Row Input Functions</a></li>
<li class="chapter" data-level="3.1.2" data-path="functions.html"><a href="functions.html#evaluate-choices-across-states"><i class="fa fa-check"></i><b>3.1.2</b> Evaluate Choices Across States</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dataframe-do-anything"><i class="fa fa-check"></i><b>3.2</b> Dataframe Do Anything</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="functions.html"><a href="functions.html#mx1-by-n-to-mxq-by-n1"><i class="fa fa-check"></i><b>3.2.1</b> (Mx1 by N) to (MxQ by N+1)</a></li>
<li class="chapter" data-level="3.2.2" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mx1-by-1"><i class="fa fa-check"></i><b>3.2.2</b> (MxP by N) to (Mx1 by 1)</a></li>
<li class="chapter" data-level="3.2.3" data-path="functions.html"><a href="functions.html#mxp-by-n-to-mxq-by-nz"><i class="fa fa-check"></i><b>3.2.3</b> (MxP by N) to (MxQ by N+Z)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#apply-and-pmap"><i class="fa fa-check"></i><b>3.3</b> Apply and pmap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="functions.html"><a href="functions.html#apply-and-sapply"><i class="fa fa-check"></i><b>3.3.1</b> Apply and Sapply</a></li>
<li class="chapter" data-level="3.3.2" data-path="functions.html"><a href="functions.html#mutate-evaluate-functions"><i class="fa fa-check"></i><b>3.3.2</b> Mutate Evaluate Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html"><i class="fa fa-check"></i><b>4</b> Multi-dimensional Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-gather-bind-and-join"><i class="fa fa-check"></i><b>4.1</b> Generate, Gather, Bind and Join</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#generate-panel-structure"><i class="fa fa-check"></i><b>4.1.1</b> Generate Panel Structure</a></li>
<li class="chapter" data-level="4.1.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-datasets"><i class="fa fa-check"></i><b>4.1.2</b> Join Datasets</a></li>
<li class="chapter" data-level="4.1.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#gather-files"><i class="fa fa-check"></i><b>4.1.3</b> Gather Files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-and-long"><i class="fa fa-check"></i><b>4.2</b> Wide and Long</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#long-table-to-wide-table"><i class="fa fa-check"></i><b>4.2.1</b> Long Table to Wide Table</a></li>
<li class="chapter" data-level="4.2.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#wide-to-long"><i class="fa fa-check"></i><b>4.2.2</b> Wide to Long</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-comparisons-and-statistics"><i class="fa fa-check"></i><b>4.3</b> Within Panel Comparisons and Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#find-closest-neighbor-on-grid"><i class="fa fa-check"></i><b>4.3.1</b> Find Closest Neighbor on Grid</a></li>
<li class="chapter" data-level="4.3.2" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#within-panel-cross-time-and-cross-group-statistics"><i class="fa fa-check"></i><b>4.3.2</b> Within Panel Cross-time and Cross-group Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#join-and-merge-files-together-by-keys"><i class="fa fa-check"></i><b>4.4</b> Join and Merge Files Together by Keys</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multi-dimensional-data-structures.html"><a href="multi-dimensional-data-structures.html#mesh-join"><i class="fa fa-check"></i><b>4.4.1</b> Mesh Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#linear-and-polynomial-fitting"><i class="fa fa-check"></i><b>5.1</b> Linear and Polynomial Fitting</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#fit-curves-through-points"><i class="fa fa-check"></i><b>5.1.1</b> Fit Curves Through Points</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Polynomial Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv"><i class="fa fa-check"></i><b>5.2</b> OLS and IV</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#ols-and-iv-regression"><i class="fa fa-check"></i><b>5.2.1</b> OLS and IV Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#iv-loop-over-rhs"><i class="fa fa-check"></i><b>5.2.2</b> IV Loop over RHS</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#decomposition"><i class="fa fa-check"></i><b>5.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression.html"><a href="linear-regression.html#decompose-rhs"><i class="fa fa-check"></i><b>5.3.1</b> Decompose RHS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html"><i class="fa fa-check"></i><b>6</b> Nonlinear and Other Regressions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logit-regression"><i class="fa fa-check"></i><b>6.1</b> Logit Regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#binary-logit"><i class="fa fa-check"></i><b>6.1.1</b> Binary Logit</a></li>
<li class="chapter" data-level="6.1.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#logistic-choice-model-with-aggregate-shares"><i class="fa fa-check"></i><b>6.1.2</b> Logistic Choice Model with Aggregate Shares</a></li>
<li class="chapter" data-level="6.1.3" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#prices-from-aggregate-shares-in-logistic-choice-model"><i class="fa fa-check"></i><b>6.1.3</b> Prices from Aggregate Shares in Logistic Choice Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression"><i class="fa fa-check"></i><b>6.2</b> Quantile Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nonlinear-and-other-regressions.html"><a href="nonlinear-and-other-regressions.html#quantile-regression-basics"><i class="fa fa-check"></i><b>6.2.1</b> Quantile Regression Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>7</b> Optimization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimization.html"><a href="optimization.html#grid-based-optimization"><i class="fa fa-check"></i><b>7.1</b> Grid Based Optimization</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="optimization.html"><a href="optimization.html#find-maximum-by-iterating-over-grids"><i class="fa fa-check"></i><b>7.1.1</b> Find Maximum By Iterating Over Grids</a></li>
<li class="chapter" data-level="7.1.2" data-path="optimization.html"><a href="optimization.html#bisection"><i class="fa fa-check"></i><b>7.1.2</b> Bisection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>8</b> Mathematics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mathematics.html"><a href="mathematics.html#basics"><i class="fa fa-check"></i><b>8.1</b> Basics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mathematics.html"><a href="mathematics.html#polynomial-formulas-for-points"><i class="fa fa-check"></i><b>8.1.1</b> Polynomial Formulas for Points</a></li>
<li class="chapter" data-level="8.1.2" data-path="mathematics.html"><a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max"><i class="fa fa-check"></i><b>8.1.2</b> Rescale a Parameter with Fixed Min and Max</a></li>
<li class="chapter" data-level="8.1.3" data-path="mathematics.html"><a href="mathematics.html#log-with-different-bases-and-exponents"><i class="fa fa-check"></i><b>8.1.3</b> Log with Different Bases and Exponents</a></li>
<li class="chapter" data-level="8.1.4" data-path="mathematics.html"><a href="mathematics.html#find-nearest"><i class="fa fa-check"></i><b>8.1.4</b> Find Nearest</a></li>
<li class="chapter" data-level="8.1.5" data-path="mathematics.html"><a href="mathematics.html#linear-scalar-fx0-solutions"><i class="fa fa-check"></i><b>8.1.5</b> Linear Scalar f(x)=0 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mathematics.html"><a href="mathematics.html#production-functions"><i class="fa fa-check"></i><b>8.2</b> Production Functions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mathematics.html"><a href="mathematics.html#nested-ces-production-function"><i class="fa fa-check"></i><b>8.2.1</b> Nested CES Production Function</a></li>
<li class="chapter" data-level="8.2.2" data-path="mathematics.html"><a href="mathematics.html#latent-dynamic-health-production-function"><i class="fa fa-check"></i><b>8.2.2</b> Latent Dynamic Health Production Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mathematics.html"><a href="mathematics.html#inequality-models"><i class="fa fa-check"></i><b>8.3</b> Inequality Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mathematics.html"><a href="mathematics.html#gini-discrete-sample"><i class="fa fa-check"></i><b>8.3.1</b> GINI Discrete Sample</a></li>
<li class="chapter" data-level="8.3.2" data-path="mathematics.html"><a href="mathematics.html#gini-formula-for-discrete-random-varialbe"><i class="fa fa-check"></i><b>8.3.2</b> GINI Formula for Discrete Random Varialbe</a></li>
<li class="chapter" data-level="8.3.3" data-path="mathematics.html"><a href="mathematics.html#atkinson-inequality-index"><i class="fa fa-check"></i><b>8.3.3</b> Atkinson Inequality Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>9</b> Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistics.html"><a href="statistics.html#random-draws"><i class="fa fa-check"></i><b>9.1</b> Random Draws</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistics.html"><a href="statistics.html#randomly-perturbing-a-parameter"><i class="fa fa-check"></i><b>9.1.1</b> Randomly Perturbing a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics.html"><a href="statistics.html#distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistics.html"><a href="statistics.html#integrate-over-normal-guassian-process-shock"><i class="fa fa-check"></i><b>9.2.1</b> Integrate Over Normal Guassian Process Shock</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics.html"><a href="statistics.html#discrete-random-variable"><i class="fa fa-check"></i><b>9.3</b> Discrete Random Variable</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="statistics.html"><a href="statistics.html#discrete-approximation-of-continuous-random-variables"><i class="fa fa-check"></i><b>9.3.1</b> Discrete Approximation of Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html"><i class="fa fa-check"></i><b>10</b> Tables and Graphs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#r-base-plots"><i class="fa fa-check"></i><b>10.1</b> R Base Plots</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#plot-curve-line-and-points"><i class="fa fa-check"></i><b>10.1.1</b> Plot Curve, Line and Points</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-related-plots"><i class="fa fa-check"></i><b>10.2</b> ggplot Line Related Plots</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-plot-basics"><i class="fa fa-check"></i><b>10.2.1</b> ggplot Line Plot Basics</a></li>
<li class="chapter" data-level="10.2.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-line-advanced"><i class="fa fa-check"></i><b>10.2.2</b> ggplot Line Advanced</a></li>
<li class="chapter" data-level="10.2.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#time-series-plots-with-shaded-areas"><i class="fa fa-check"></i><b>10.2.3</b> Time-series Plots with Shaded Areas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-related-plots"><i class="fa fa-check"></i><b>10.3</b> ggplot Scatter Related Plots</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-scatter-plot"><i class="fa fa-check"></i><b>10.3.1</b> ggplot Scatter Plot</a></li>
<li class="chapter" data-level="10.3.2" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#ggplot-multiple-scatter-lines-with-facet-wrap"><i class="fa fa-check"></i><b>10.3.2</b> ggplot Multiple Scatter-Lines with Facet Wrap</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#write-and-read-plots"><i class="fa fa-check"></i><b>10.4</b> Write and Read Plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="tables-and-graphs.html"><a href="tables-and-graphs.html#import-and-export-images"><i class="fa fa-check"></i><b>10.4.1</b> Import and Export Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>11</b> Get Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="get-data.html"><a href="get-data.html#environmental-data"><i class="fa fa-check"></i><b>11.1</b> Environmental Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="get-data.html"><a href="get-data.html#ecmwf-era5-data"><i class="fa fa-check"></i><b>11.1.1</b> ECMWF ERA5 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="coding-and-development.html"><a href="coding-and-development.html"><i class="fa fa-check"></i><b>12</b> Coding and Development</a>
<ul>
<li class="chapter" data-level="12.1" data-path="coding-and-development.html"><a href="coding-and-development.html#installation-and-packages"><i class="fa fa-check"></i><b>12.1</b> Installation and Packages</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="coding-and-development.html"><a href="coding-and-development.html#r-installation-and-set-up"><i class="fa fa-check"></i><b>12.1.1</b> R Installation and Set-Up</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="coding-and-development.html"><a href="coding-and-development.html#files-in-and-out"><i class="fa fa-check"></i><b>12.2</b> Files In and Out</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="coding-and-development.html"><a href="coding-and-development.html#file-path"><i class="fa fa-check"></i><b>12.2.1</b> File Path</a></li>
<li class="chapter" data-level="12.2.2" data-path="coding-and-development.html"><a href="coding-and-development.html#text-to-file"><i class="fa fa-check"></i><b>12.2.2</b> Text to File</a></li>
<li class="chapter" data-level="12.2.3" data-path="coding-and-development.html"><a href="coding-and-development.html#rmd-to-html"><i class="fa fa-check"></i><b>12.2.3</b> Rmd to HTML</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="coding-and-development.html"><a href="coding-and-development.html#python-with-r"><i class="fa fa-check"></i><b>12.3</b> Python with R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="coding-and-development.html"><a href="coding-and-development.html#reticulate-basics"><i class="fa fa-check"></i><b>12.3.1</b> Reticulate Basics</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="coding-and-development.html"><a href="coding-and-development.html#command-line"><i class="fa fa-check"></i><b>12.4</b> Command Line</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="coding-and-development.html"><a href="coding-and-development.html#shell-and-system-commands"><i class="fa fa-check"></i><b>12.4.1</b> Shell and System Commands</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="coding-and-development.html"><a href="coding-and-development.html#run-code-in-parallel-in-r"><i class="fa fa-check"></i><b>12.5</b> Run Code in Parallel in R</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="coding-and-development.html"><a href="coding-and-development.html#parallel-loop-in-r"><i class="fa fa-check"></i><b>12.5.1</b> Parallel Loop in R</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#array-matrix-dataframe-links"><i class="fa fa-check"></i><b>A.1</b> Array, Matrix, Dataframe links</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.1-listlist-links"><i class="fa fa-check"></i><b>A.1.1</b> Section 1.1 List links</a></li>
<li class="chapter" data-level="A.1.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.2-arrayarray-links"><i class="fa fa-check"></i><b>A.1.2</b> Section 1.2 Array links</a></li>
<li class="chapter" data-level="A.1.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.3-matrixmatrix-links"><i class="fa fa-check"></i><b>A.1.3</b> Section 1.3 Matrix links</a></li>
<li class="chapter" data-level="A.1.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-1.4-regular-expression-date-etc.regular-expression-date-etc.-links"><i class="fa fa-check"></i><b>A.1.4</b> Section 1.4 Regular Expression, Date, etc. links</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#manipulate-and-summarize-dataframes-links"><i class="fa fa-check"></i><b>A.2</b> Manipulate and Summarize Dataframes links</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.1-variables-in-dataframesvariables-in-dataframes-links"><i class="fa fa-check"></i><b>A.2.1</b> Section 2.1 Variables in Dataframes links</a></li>
<li class="chapter" data-level="A.2.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.2-counting-observationcounting-observation-links"><i class="fa fa-check"></i><b>A.2.2</b> Section 2.2 Counting Observation links</a></li>
<li class="chapter" data-level="A.2.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.3-sorting-indexing-slicingsorting-indexing-slicing-links"><i class="fa fa-check"></i><b>A.2.3</b> Section 2.3 Sorting, Indexing, Slicing links</a></li>
<li class="chapter" data-level="A.2.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.4-advanced-group-aggregationadvanced-group-aggregation-links"><i class="fa fa-check"></i><b>A.2.4</b> Section 2.4 Advanced Group Aggregation links</a></li>
<li class="chapter" data-level="A.2.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.5-distributional-statisticsdistributional-statistics-links"><i class="fa fa-check"></i><b>A.2.5</b> Section 2.5 Distributional Statistics links</a></li>
<li class="chapter" data-level="A.2.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-2.6-summarize-multiple-variablessummarize-multiple-variables-links"><i class="fa fa-check"></i><b>A.2.6</b> Section 2.6 Summarize Multiple Variables links</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#functions-links"><i class="fa fa-check"></i><b>A.3</b> Functions links</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.1-dataframe-mutatedataframe-mutate-links"><i class="fa fa-check"></i><b>A.3.1</b> Section 3.1 Dataframe Mutate links</a></li>
<li class="chapter" data-level="A.3.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.2-dataframe-do-anythingdataframe-do-anything-links"><i class="fa fa-check"></i><b>A.3.2</b> Section 3.2 Dataframe Do Anything links</a></li>
<li class="chapter" data-level="A.3.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-3.3-apply-and-pmapapply-and-pmap-links"><i class="fa fa-check"></i><b>A.3.3</b> Section 3.3 Apply and pmap links</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#multi-dimensional-data-structures-links"><i class="fa fa-check"></i><b>A.4</b> Multi-dimensional Data Structures links</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.1-generate-gather-bind-and-joingenerate-gather-bind-and-join-links"><i class="fa fa-check"></i><b>A.4.1</b> Section 4.1 Generate, Gather, Bind and Join links</a></li>
<li class="chapter" data-level="A.4.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.2-wide-and-longwide-and-long-links"><i class="fa fa-check"></i><b>A.4.2</b> Section 4.2 Wide and Long links</a></li>
<li class="chapter" data-level="A.4.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.3-within-panel-comparisons-and-statisticswithin-panel-comparisons-and-statistics-links"><i class="fa fa-check"></i><b>A.4.3</b> Section 4.3 Within Panel Comparisons and Statistics links</a></li>
<li class="chapter" data-level="A.4.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-4.4-join-and-merge-files-together-by-keysjoin-and-merge-files-together-by-keys-links"><i class="fa fa-check"></i><b>A.4.4</b> Section 4.4 Join and Merge Files Together by Keys links</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#linear-regression-links"><i class="fa fa-check"></i><b>A.5</b> Linear Regression links</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.1-linear-and-polynomial-fittinglinear-and-polynomial-fitting-links"><i class="fa fa-check"></i><b>A.5.1</b> Section 5.1 Linear and Polynomial Fitting links</a></li>
<li class="chapter" data-level="A.5.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.2-ols-and-ivols-and-iv-links"><i class="fa fa-check"></i><b>A.5.2</b> Section 5.2 OLS and IV links</a></li>
<li class="chapter" data-level="A.5.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-5.3-decompositiondecomposition-links"><i class="fa fa-check"></i><b>A.5.3</b> Section 5.3 Decomposition links</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#nonlinear-and-other-regressions-links"><i class="fa fa-check"></i><b>A.6</b> Nonlinear and Other Regressions links</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.1-logit-regressionlogit-regression-links"><i class="fa fa-check"></i><b>A.6.1</b> Section 6.1 Logit Regression links</a></li>
<li class="chapter" data-level="A.6.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-6.2-quantile-regressionquantile-regression-links"><i class="fa fa-check"></i><b>A.6.2</b> Section 6.2 Quantile Regression links</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#optimization-links"><i class="fa fa-check"></i><b>A.7</b> Optimization links</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-7.1-grid-based-optimizationgrid-based-optimization-links"><i class="fa fa-check"></i><b>A.7.1</b> Section 7.1 Grid Based Optimization links</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="index-and-code-links.html"><a href="index-and-code-links.html#mathematics-links"><i class="fa fa-check"></i><b>A.8</b> Mathematics links</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.1-basicsbasics-links"><i class="fa fa-check"></i><b>A.8.1</b> Section 8.1 Basics links</a></li>
<li class="chapter" data-level="A.8.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.2-production-functionsproduction-functions-links"><i class="fa fa-check"></i><b>A.8.2</b> Section 8.2 Production Functions links</a></li>
<li class="chapter" data-level="A.8.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-8.3-inequality-modelsinequality-models-links"><i class="fa fa-check"></i><b>A.8.3</b> Section 8.3 Inequality Models links</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="index-and-code-links.html"><a href="index-and-code-links.html#statistics-links"><i class="fa fa-check"></i><b>A.9</b> Statistics links</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.1-random-drawsrandom-draws-links"><i class="fa fa-check"></i><b>A.9.1</b> Section 9.1 Random Draws links</a></li>
<li class="chapter" data-level="A.9.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.2-distributionsdistributions-links"><i class="fa fa-check"></i><b>A.9.2</b> Section 9.2 Distributions links</a></li>
<li class="chapter" data-level="A.9.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-9.3-discrete-random-variablediscrete-random-variable-links"><i class="fa fa-check"></i><b>A.9.3</b> Section 9.3 Discrete Random Variable links</a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="index-and-code-links.html"><a href="index-and-code-links.html#tables-and-graphs-links"><i class="fa fa-check"></i><b>A.10</b> Tables and Graphs links</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.1-r-base-plotsr-base-plots-links"><i class="fa fa-check"></i><b>A.10.1</b> Section 10.1 R Base Plots links</a></li>
<li class="chapter" data-level="A.10.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.2-ggplot-line-related-plotsggplot-line-related-plots-links"><i class="fa fa-check"></i><b>A.10.2</b> Section 10.2 ggplot Line Related Plots links</a></li>
<li class="chapter" data-level="A.10.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.3-ggplot-scatter-related-plotsggplot-scatter-related-plots-links"><i class="fa fa-check"></i><b>A.10.3</b> Section 10.3 ggplot Scatter Related Plots links</a></li>
<li class="chapter" data-level="A.10.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-10.4-write-and-read-plotswrite-and-read-plots-links"><i class="fa fa-check"></i><b>A.10.4</b> Section 10.4 Write and Read Plots links</a></li>
</ul></li>
<li class="chapter" data-level="A.11" data-path="index-and-code-links.html"><a href="index-and-code-links.html#get-data-links"><i class="fa fa-check"></i><b>A.11</b> Get Data links</a>
<ul>
<li class="chapter" data-level="A.11.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-11.1-environmental-dataenvironmental-data-links"><i class="fa fa-check"></i><b>A.11.1</b> Section 11.1 Environmental Data links</a></li>
</ul></li>
<li class="chapter" data-level="A.12" data-path="index-and-code-links.html"><a href="index-and-code-links.html#coding-and-development-links"><i class="fa fa-check"></i><b>A.12</b> Coding and Development links</a>
<ul>
<li class="chapter" data-level="A.12.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.1-installation-and-packagesinstallation-and-packages-links"><i class="fa fa-check"></i><b>A.12.1</b> Section 12.1 Installation and Packages links</a></li>
<li class="chapter" data-level="A.12.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.2-files-in-and-outfiles-in-and-out-links"><i class="fa fa-check"></i><b>A.12.2</b> Section 12.2 Files In and Out links</a></li>
<li class="chapter" data-level="A.12.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.3-python-with-rpython-with-r-links"><i class="fa fa-check"></i><b>A.12.3</b> Section 12.3 Python with R links</a></li>
<li class="chapter" data-level="A.12.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.4-command-linecommand-line-links"><i class="fa fa-check"></i><b>A.12.4</b> Section 12.4 Command Line links</a></li>
<li class="chapter" data-level="A.12.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#section-12.5-run-code-in-parallel-in-rrun-code-in-parallel-in-r-links"><i class="fa fa-check"></i><b>A.12.5</b> Section 12.5 Run Code in Parallel in R links</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/R4Econ/bookdown/index.html" target="blank">R4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Structures, Estimation and Optimization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mathematics" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Mathematics<a href="mathematics.html#mathematics" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="basics" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Basics<a href="mathematics.html#basics" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="polynomial-formulas-for-points" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Polynomial Formulas for Points<a href="mathematics.html#polynomial-formulas-for-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="formulas-for-quadratic-parameters-and-three-points" class="section level4 hasAnchor" number="8.1.1.1">
<h4><span class="header-section-number">8.1.1.1</span> Formulas for Quadratic Parameters and Three Points<a href="mathematics.html#formulas-for-quadratic-parameters-and-three-points" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are three points defined by their x and y coordinates, find a curve that fits through them exactly.</p>
<p>First, we have three equations with three unknowns, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_1 &amp;= A + B \cdot x_1 + C \cdot x_1^2\\
y_2 &amp;= A + B \cdot x_2 + C \cdot x_2^2\\
y_3 &amp;= A + B \cdot x_3 + C \cdot x_3^2\\
\end{aligned}
\]</span></p>
<p>Second, we rewrite the problem in <a href="https://fanwangecon.github.io/Math4Econ/matrix_system_of_equations/htmlpdfm/matrix_linear_system_2.html">matrix form</a>.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
1 &amp; x_1 &amp; x_1^2 \\
1 &amp; x_2 &amp; x_2^2 \\
1 &amp; x_3 &amp; x_3^2 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
A \\
B \\
C
\end{bmatrix}
&amp; =
\begin{bmatrix}
y_1 \\
y_2 \\
y_3
\end{bmatrix}\\
\end{aligned}
\]</span></p>
<p>Third, we solve the system of equations for the unknown vector <span class="math inline">\([A,B,C]\)</span>, via <a href="https://fanwangecon.github.io/Math4Econ/matrix_system_of_equations/htmlpdfm/matrix_row_echelon_form.html">elementary row operations</a>. The code below uses matlab to arrive at symbolic analytical solutions for for <span class="math inline">\([A,B,C]\)</span>.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode octave"><code class="sourceCode octave"><span id="cb662-1"><a href="mathematics.html#cb662-1" tabindex="-1"></a><span class="fu">clc</span></span>
<span id="cb662-2"><a href="mathematics.html#cb662-2" tabindex="-1"></a><span class="bu">clear</span></span>
<span id="cb662-3"><a href="mathematics.html#cb662-3" tabindex="-1"></a></span>
<span id="cb662-4"><a href="mathematics.html#cb662-4" tabindex="-1"></a><span class="co">% Define inputs</span></span>
<span id="cb662-5"><a href="mathematics.html#cb662-5" tabindex="-1"></a>syms x11 x12 x21 x22 x31 x32 y1 y2 y3</span>
<span id="cb662-6"><a href="mathematics.html#cb662-6" tabindex="-1"></a>mt_sm_z <span class="op">=</span> [<span class="fl">1</span><span class="op">,</span>x11<span class="op">,</span>x12<span class="op">;</span><span class="fl">1</span><span class="op">,</span>x21<span class="op">,</span>x22<span class="op">;</span><span class="fl">1</span><span class="op">,</span>x31<span class="op">,</span>x32]<span class="op">;</span></span>
<span id="cb662-7"><a href="mathematics.html#cb662-7" tabindex="-1"></a>ar_sm_y <span class="op">=</span> [y1<span class="op">;</span>y2<span class="op">;</span>y3]<span class="op">;</span></span>
<span id="cb662-8"><a href="mathematics.html#cb662-8" tabindex="-1"></a></span>
<span id="cb662-9"><a href="mathematics.html#cb662-9" tabindex="-1"></a><span class="co">% Solve analytically</span></span>
<span id="cb662-10"><a href="mathematics.html#cb662-10" tabindex="-1"></a>ar_sm_solu <span class="op">=</span> <span class="fu">linsolve</span>(mt_sm_z<span class="op">,</span> ar_sm_y)</span>
<span id="cb662-11"><a href="mathematics.html#cb662-11" tabindex="-1"></a></span>
<span id="cb662-12"><a href="mathematics.html#cb662-12" tabindex="-1"></a><span class="co">% Randomly draw x and y values</span></span>
<span id="cb662-13"><a href="mathematics.html#cb662-13" tabindex="-1"></a>rng(<span class="fl">1234</span>)<span class="op">;</span></span>
<span id="cb662-14"><a href="mathematics.html#cb662-14" tabindex="-1"></a>mt_rand <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb662-15"><a href="mathematics.html#cb662-15" tabindex="-1"></a>mt_rand <span class="op">=</span> [<span class="fl">0.1915</span><span class="op">,</span> <span class="fl">0.6221</span><span class="op">,</span> <span class="fl">0.4377</span><span class="op">;</span></span>
<span id="cb662-16"><a href="mathematics.html#cb662-16" tabindex="-1"></a>  <span class="fl">0.7854</span><span class="op">,</span> <span class="fl">0.7800</span><span class="op">,</span> <span class="fl">0.2726</span>]<span class="op">&#39;;</span></span>
<span id="cb662-17"><a href="mathematics.html#cb662-17" tabindex="-1"></a>[fl_x1<span class="op">,</span> fl_x2<span class="op">,</span> fl_x3] <span class="op">=</span> <span class="fu">deal</span>(mt_rand(<span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span> mt_rand(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span> mt_rand(<span class="fl">3</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb662-18"><a href="mathematics.html#cb662-18" tabindex="-1"></a>[fl_y1<span class="op">,</span> fl_y2<span class="op">,</span> fl_y3] <span class="op">=</span> <span class="fu">deal</span>(mt_rand(<span class="fl">1</span><span class="op">,</span><span class="fl">2</span>)<span class="op">,</span> mt_rand(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span>)<span class="op">,</span> mt_rand(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb662-19"><a href="mathematics.html#cb662-19" tabindex="-1"></a>[fl_x11<span class="op">,</span> fl_x21<span class="op">,</span> fl_x31] <span class="op">=</span> <span class="fu">deal</span>(fl_x1<span class="op">,</span> fl_x2<span class="op">,</span> fl_x3)<span class="op">;</span></span>
<span id="cb662-20"><a href="mathematics.html#cb662-20" tabindex="-1"></a>[fl_x12<span class="op">,</span> fl_x22<span class="op">,</span> fl_x32] <span class="op">=</span> <span class="fu">deal</span>(fl_x1<span class="op">^</span><span class="fl">2</span><span class="op">,</span> fl_x2<span class="op">^</span><span class="fl">2</span><span class="op">,</span> fl_x3<span class="op">^</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb662-21"><a href="mathematics.html#cb662-21" tabindex="-1"></a></span>
<span id="cb662-22"><a href="mathematics.html#cb662-22" tabindex="-1"></a><span class="co">% Numerically evaluate coefficients</span></span>
<span id="cb662-23"><a href="mathematics.html#cb662-23" tabindex="-1"></a>ar_fl_solu <span class="op">=</span> <span class="fu">double</span>(subs(ar_sm_solu<span class="op">,</span> <span class="op">...</span></span>
<span id="cb662-24"><a href="mathematics.html#cb662-24" tabindex="-1"></a>  {x11<span class="op">,</span> x12<span class="op">,</span> x21<span class="op">,</span> x22<span class="op">,</span> x31<span class="op">,</span> x32<span class="op">,</span> y1<span class="op">,</span> y2<span class="op">,</span> y3}<span class="op">,</span> <span class="op">...</span></span>
<span id="cb662-25"><a href="mathematics.html#cb662-25" tabindex="-1"></a>  {fl_x11<span class="op">,</span>fl_x12<span class="op">,</span>fl_x21<span class="op">,</span>fl_x22<span class="op">,</span>fl_x31<span class="op">,</span>fl_x32<span class="op">,</span>fl_y1<span class="op">,</span>fl_y2<span class="op">,</span>fl_y3}))<span class="op">;</span></span>
<span id="cb662-26"><a href="mathematics.html#cb662-26" tabindex="-1"></a><span class="fu">disp</span>([<span class="st">&#39;ar_fl_solu=&#39;</span><span class="op">,</span> <span class="fu">num2str</span>(ar_fl_solu<span class="op">&#39;</span>)])</span>
<span id="cb662-27"><a href="mathematics.html#cb662-27" tabindex="-1"></a></span>
<span id="cb662-28"><a href="mathematics.html#cb662-28" tabindex="-1"></a><span class="co">% Y predictions</span></span>
<span id="cb662-29"><a href="mathematics.html#cb662-29" tabindex="-1"></a>mt_fl_z <span class="op">=</span> [<span class="fl">1</span><span class="op">,</span>fl_x11<span class="op">,</span>fl_x12<span class="op">;</span><span class="fl">1</span><span class="op">,</span>fl_x21<span class="op">,</span>fl_x22<span class="op">;</span><span class="fl">1</span><span class="op">,</span>fl_x31<span class="op">,</span>fl_x32]<span class="op">;</span></span>
<span id="cb662-30"><a href="mathematics.html#cb662-30" tabindex="-1"></a>ar_fl_y_pred <span class="op">=</span> mt_fl_z<span class="op">*</span>ar_fl_solu<span class="op">;</span></span>
<span id="cb662-31"><a href="mathematics.html#cb662-31" tabindex="-1"></a>ar_fl_x_actual <span class="op">=</span> [fl_x1<span class="op">;</span>fl_x2<span class="op">;</span>fl_x3]<span class="op">;</span></span>
<span id="cb662-32"><a href="mathematics.html#cb662-32" tabindex="-1"></a>ar_fl_y_actual <span class="op">=</span> [fl_y1<span class="op">;</span>fl_y2<span class="op">;</span>fl_y3]<span class="op">;</span></span>
<span id="cb662-33"><a href="mathematics.html#cb662-33" tabindex="-1"></a></span>
<span id="cb662-34"><a href="mathematics.html#cb662-34" tabindex="-1"></a><span class="co">% Compare results</span></span>
<span id="cb662-35"><a href="mathematics.html#cb662-35" tabindex="-1"></a>tb_test <span class="op">=</span> array2table([ar_fl_x_actual<span class="op">&#39;;</span>ar_fl_y_actual<span class="op">&#39;;</span>ar_fl_y_pred<span class="op">&#39;</span>]<span class="op">&#39;</span>)<span class="op">;</span></span>
<span id="cb662-36"><a href="mathematics.html#cb662-36" tabindex="-1"></a>cl_col_names <span class="op">=</span> [<span class="st">&quot;x_actual&quot;</span><span class="op">,</span><span class="st">&quot;y_actual&quot;</span><span class="op">,</span> <span class="st">&quot;y_predict&quot;</span>]<span class="op">;</span></span>
<span id="cb662-37"><a href="mathematics.html#cb662-37" tabindex="-1"></a>cl_row_names <span class="op">=</span> <span class="fu">strcat</span>(<span class="st">&#39;obs_&#39;</span><span class="op">,</span> string((<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)))<span class="op">;</span></span>
<span id="cb662-38"><a href="mathematics.html#cb662-38" tabindex="-1"></a>tb_test.Properties.VariableNames <span class="op">=</span> matlab.lang.makeValidName(cl_col_names)<span class="op">;</span></span>
<span id="cb662-39"><a href="mathematics.html#cb662-39" tabindex="-1"></a>tb_test.Properties.RowNames <span class="op">=</span> matlab.lang.makeValidName(cl_row_names)<span class="op">;</span></span>
<span id="cb662-40"><a href="mathematics.html#cb662-40" tabindex="-1"></a><span class="fu">display</span>(tb_test)<span class="op">;</span></span></code></pre></div>
<p>Fourth, the solutions are as follows.</p>
<p><span class="math display">\[
A =
\frac{x_1 x_2^2 y_3 - x_1^2 x_2 y_3 - x_1 x_3^2 y_2 + x_1^2 x_3 y_2 + x_2 x_3^2 y_1 - x_2^2 x_3 y_1}{x_1 x_2^2 - x_1^2 x_2 - x_1 x_3^2 + x_1^2 x_3 + x_2 x_3^2 - x_2^2 x_3}
\]</span></p>
<p><span class="math display">\[
B = \frac{-\left(x_1^2 y_2 - x_1^2 y_3 - x_2^2 y_1 + x_2^2 y_3 + x_3^2 y_1 - x_3^2 y_2\right)}{x_1 x_2^2 - x_1^2 x_2 - x_1 x_3^2 + x_1^2 x_3 + x_2 x_3^2 - x_2^2 x_3}
\]</span></p>
<p><span class="math display">\[
C = \frac{x_1 y_2 - x_1 y_3 - x_2 y_1 + x_2 y_3 + x_3 y_1 - x_3 y_2}{x_1 x_2^2 - x_1^2 x_2 - x_1 x_3^2 + x_1^2 x_3 + x_2 x_3^2 - x_2^2 x_3}
\]</span></p>
<p>Fifth, given three pairs randomly drawn x and y points, we use the formulas just derived to find the parameters for the quadratic polynomial.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="mathematics.html#cb663-1" tabindex="-1"></a><span class="co"># Inputs X and Y</span></span>
<span id="cb663-2"><a href="mathematics.html#cb663-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb663-3"><a href="mathematics.html#cb663-3" tabindex="-1"></a><span class="co"># Draw Randomly</span></span>
<span id="cb663-4"><a href="mathematics.html#cb663-4" tabindex="-1"></a>mt_rnorm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb663-5"><a href="mathematics.html#cb663-5" tabindex="-1"></a><span class="co"># # Fixed Values</span></span>
<span id="cb663-6"><a href="mathematics.html#cb663-6" tabindex="-1"></a><span class="co"># mt_rnorm &lt;- matrix(c(</span></span>
<span id="cb663-7"><a href="mathematics.html#cb663-7" tabindex="-1"></a><span class="co">#   0.1915, 0.6221, 0.4377,</span></span>
<span id="cb663-8"><a href="mathematics.html#cb663-8" tabindex="-1"></a><span class="co">#   0.7854, 0.7800, 0.2726</span></span>
<span id="cb663-9"><a href="mathematics.html#cb663-9" tabindex="-1"></a><span class="co"># ), nrow = 3, ncol = 2)</span></span>
<span id="cb663-10"><a href="mathematics.html#cb663-10" tabindex="-1"></a><span class="fu">colnames</span>(mt_rnorm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb663-11"><a href="mathematics.html#cb663-11" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb663-12"><a href="mathematics.html#cb663-12" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb663-13"><a href="mathematics.html#cb663-13" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb663-14"><a href="mathematics.html#cb663-14" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb663-15"><a href="mathematics.html#cb663-15" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb663-16"><a href="mathematics.html#cb663-16" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb663-17"><a href="mathematics.html#cb663-17" tabindex="-1"></a></span>
<span id="cb663-18"><a href="mathematics.html#cb663-18" tabindex="-1"></a><span class="co"># X quadratic</span></span>
<span id="cb663-19"><a href="mathematics.html#cb663-19" tabindex="-1"></a>x11 <span class="ot">&lt;-</span> x1</span>
<span id="cb663-20"><a href="mathematics.html#cb663-20" tabindex="-1"></a>x12 <span class="ot">&lt;-</span> x1<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb663-21"><a href="mathematics.html#cb663-21" tabindex="-1"></a>x21 <span class="ot">&lt;-</span> x2</span>
<span id="cb663-22"><a href="mathematics.html#cb663-22" tabindex="-1"></a>x22 <span class="ot">&lt;-</span> x2<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb663-23"><a href="mathematics.html#cb663-23" tabindex="-1"></a>x31 <span class="ot">&lt;-</span> x3</span>
<span id="cb663-24"><a href="mathematics.html#cb663-24" tabindex="-1"></a>x32 <span class="ot">&lt;-</span> x3<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb663-25"><a href="mathematics.html#cb663-25" tabindex="-1"></a></span>
<span id="cb663-26"><a href="mathematics.html#cb663-26" tabindex="-1"></a><span class="co"># Shared denominator</span></span>
<span id="cb663-27"><a href="mathematics.html#cb663-27" tabindex="-1"></a>fl_denominator <span class="ot">&lt;-</span> (x11 <span class="sc">*</span> x22 <span class="sc">-</span> x12 <span class="sc">*</span> x21</span>
<span id="cb663-28"><a href="mathematics.html#cb663-28" tabindex="-1"></a>  <span class="sc">-</span> x11 <span class="sc">*</span> x32 <span class="sc">+</span> x12 <span class="sc">*</span> x31</span>
<span id="cb663-29"><a href="mathematics.html#cb663-29" tabindex="-1"></a>  <span class="sc">+</span> x21 <span class="sc">*</span> x32 <span class="sc">-</span> x22 <span class="sc">*</span> x31)</span>
<span id="cb663-30"><a href="mathematics.html#cb663-30" tabindex="-1"></a></span>
<span id="cb663-31"><a href="mathematics.html#cb663-31" tabindex="-1"></a><span class="co"># Solve for A, B, and C exact fit quadratic coefficients</span></span>
<span id="cb663-32"><a href="mathematics.html#cb663-32" tabindex="-1"></a>fl_A <span class="ot">&lt;-</span> (x11 <span class="sc">*</span> x22 <span class="sc">*</span> y3 <span class="sc">-</span> x12 <span class="sc">*</span> x21 <span class="sc">*</span> y3</span>
<span id="cb663-33"><a href="mathematics.html#cb663-33" tabindex="-1"></a>  <span class="sc">-</span> x11 <span class="sc">*</span> x32 <span class="sc">*</span> y2 <span class="sc">+</span> x12 <span class="sc">*</span> x31 <span class="sc">*</span> y2</span>
<span id="cb663-34"><a href="mathematics.html#cb663-34" tabindex="-1"></a>  <span class="sc">+</span> x21 <span class="sc">*</span> x32 <span class="sc">*</span> y1 <span class="sc">-</span> x22 <span class="sc">*</span> x31 <span class="sc">*</span> y1) <span class="sc">/</span> fl_denominator</span>
<span id="cb663-35"><a href="mathematics.html#cb663-35" tabindex="-1"></a></span>
<span id="cb663-36"><a href="mathematics.html#cb663-36" tabindex="-1"></a>fl_B <span class="ot">&lt;-</span> <span class="sc">-</span>(x12 <span class="sc">*</span> y2 <span class="sc">-</span> x12 <span class="sc">*</span> y3</span>
<span id="cb663-37"><a href="mathematics.html#cb663-37" tabindex="-1"></a>  <span class="sc">-</span> x22 <span class="sc">*</span> y1 <span class="sc">+</span> x22 <span class="sc">*</span> y3</span>
<span id="cb663-38"><a href="mathematics.html#cb663-38" tabindex="-1"></a>  <span class="sc">+</span> x32 <span class="sc">*</span> y1 <span class="sc">-</span> x32 <span class="sc">*</span> y2) <span class="sc">/</span> fl_denominator</span>
<span id="cb663-39"><a href="mathematics.html#cb663-39" tabindex="-1"></a></span>
<span id="cb663-40"><a href="mathematics.html#cb663-40" tabindex="-1"></a>fl_C <span class="ot">&lt;-</span> (x11 <span class="sc">*</span> y2 <span class="sc">-</span> x11 <span class="sc">*</span> y3</span>
<span id="cb663-41"><a href="mathematics.html#cb663-41" tabindex="-1"></a>  <span class="sc">-</span> x21 <span class="sc">*</span> y1 <span class="sc">+</span> x21 <span class="sc">*</span> y3</span>
<span id="cb663-42"><a href="mathematics.html#cb663-42" tabindex="-1"></a>  <span class="sc">+</span> x31 <span class="sc">*</span> y1 <span class="sc">-</span> x31 <span class="sc">*</span> y2) <span class="sc">/</span> fl_denominator</span>
<span id="cb663-43"><a href="mathematics.html#cb663-43" tabindex="-1"></a></span>
<span id="cb663-44"><a href="mathematics.html#cb663-44" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb663-45"><a href="mathematics.html#cb663-45" tabindex="-1"></a>st_display <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb663-46"><a href="mathematics.html#cb663-46" tabindex="-1"></a>  <span class="st">&quot;A(intercept)=&quot;</span>, <span class="fu">round</span>(fl_A, <span class="dv">3</span>),</span>
<span id="cb663-47"><a href="mathematics.html#cb663-47" tabindex="-1"></a>  <span class="st">&quot;, B(lin)=&quot;</span>, <span class="fu">round</span>(fl_B, <span class="dv">3</span>),</span>
<span id="cb663-48"><a href="mathematics.html#cb663-48" tabindex="-1"></a>  <span class="st">&quot;, C(quad)=&quot;</span>, <span class="fu">round</span>(fl_C, <span class="dv">3</span>)</span>
<span id="cb663-49"><a href="mathematics.html#cb663-49" tabindex="-1"></a>)</span>
<span id="cb663-50"><a href="mathematics.html#cb663-50" tabindex="-1"></a><span class="fu">print</span>(st_display)</span></code></pre></div>
<pre><code>## [1] &quot;A(intercept)=1.105, B(lin)=-0.226, C(quad)=0.334&quot;</code></pre>
<p>Sixth, to check that the estimates are correct, we derive results from running quadratic estimation with the three points of data drawn. We use both polynomial and orthogonal polynomials below.</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="mathematics.html#cb665-1" tabindex="-1"></a><span class="co"># Estimation results</span></span>
<span id="cb665-2"><a href="mathematics.html#cb665-2" tabindex="-1"></a>df_rnorm <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_rnorm)</span>
<span id="cb665-3"><a href="mathematics.html#cb665-3" tabindex="-1"></a><span class="co"># Linear and quadratic terms</span></span>
<span id="cb665-4"><a href="mathematics.html#cb665-4" tabindex="-1"></a>rs_lm_quad <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> df_rnorm)</span>
<span id="cb665-5"><a href="mathematics.html#cb665-5" tabindex="-1"></a><span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">summary.lm</span>(rs_lm_quad))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = y ~ x + I(x^2), data = df_rnorm)
## 
## Residuals:
## ALL 3 residuals are 0: no residual degrees of freedom!
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   1.1054        NaN     NaN      NaN
## x            -0.2264        NaN     NaN      NaN
## I(x^2)        0.3343        NaN     NaN      NaN
## 
## Residual standard error: NaN on 0 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:    NaN 
## F-statistic:   NaN on 2 and 0 DF,  p-value: NA</code></pre>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="mathematics.html#cb667-1" tabindex="-1"></a><span class="co"># Using orthogonal polynomials</span></span>
<span id="cb667-2"><a href="mathematics.html#cb667-2" tabindex="-1"></a><span class="co"># vs. rs_lm_quad: different parameters, but same predictions</span></span>
<span id="cb667-3"><a href="mathematics.html#cb667-3" tabindex="-1"></a>rs_lm_quad_otho <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data =</span> df_rnorm)</span>
<span id="cb667-4"><a href="mathematics.html#cb667-4" tabindex="-1"></a><span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">summary.lm</span>(rs_lm_quad_otho))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = y ~ poly(x, 2), data = df_rnorm)
## 
## Residuals:
## ALL 3 residuals are 0: no residual degrees of freedom!
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   1.6383        NaN     NaN      NaN
## poly(x, 2)1   1.3109        NaN     NaN      NaN
## poly(x, 2)2   0.1499        NaN     NaN      NaN
## 
## Residual standard error: NaN on 0 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:    NaN 
## F-statistic:   NaN on 2 and 0 DF,  p-value: NA</code></pre>
<p>Seventh, now we compare between the predications based on analytical solutions and lm regression.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="mathematics.html#cb669-1" tabindex="-1"></a><span class="co"># Matrix of input values</span></span>
<span id="cb669-2"><a href="mathematics.html#cb669-2" tabindex="-1"></a>mt_vals_xs <span class="ot">&lt;-</span> <span class="fu">t</span>(</span>
<span id="cb669-3"><a href="mathematics.html#cb669-3" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, x1, x1<span class="sc">**</span><span class="dv">2</span>, <span class="dv">1</span>, x2, x2<span class="sc">**</span><span class="dv">2</span>, <span class="dv">1</span>, x3, x3<span class="sc">**</span><span class="dv">2</span>),</span>
<span id="cb669-4"><a href="mathematics.html#cb669-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb669-5"><a href="mathematics.html#cb669-5" tabindex="-1"></a>  )</span>
<span id="cb669-6"><a href="mathematics.html#cb669-6" tabindex="-1"></a>)</span>
<span id="cb669-7"><a href="mathematics.html#cb669-7" tabindex="-1"></a></span>
<span id="cb669-8"><a href="mathematics.html#cb669-8" tabindex="-1"></a><span class="co"># Predictions from LM poly prediction</span></span>
<span id="cb669-9"><a href="mathematics.html#cb669-9" tabindex="-1"></a>ar_pred_lm <span class="ot">&lt;-</span> mt_vals_xs <span class="sc">%*%</span> <span class="fu">as.numeric</span>(rs_lm_quad<span class="sc">$</span>coefficients)</span>
<span id="cb669-10"><a href="mathematics.html#cb669-10" tabindex="-1"></a>as_pred_lm_otho <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict</span>(rs_lm_quad_otho)</span>
<span id="cb669-11"><a href="mathematics.html#cb669-11" tabindex="-1"></a></span>
<span id="cb669-12"><a href="mathematics.html#cb669-12" tabindex="-1"></a><span class="co"># Predictions based on analytical solutions</span></span>
<span id="cb669-13"><a href="mathematics.html#cb669-13" tabindex="-1"></a>ar_pred_sym <span class="ot">&lt;-</span> mt_vals_xs <span class="sc">%*%</span> <span class="fu">c</span>(fl_A, fl_B, fl_C)</span>
<span id="cb669-14"><a href="mathematics.html#cb669-14" tabindex="-1"></a></span>
<span id="cb669-15"><a href="mathematics.html#cb669-15" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb669-16"><a href="mathematics.html#cb669-16" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb669-17"><a href="mathematics.html#cb669-17" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb669-18"><a href="mathematics.html#cb669-18" tabindex="-1"></a>    df_rnorm, ar_pred_sym,</span>
<span id="cb669-19"><a href="mathematics.html#cb669-19" tabindex="-1"></a>    ar_pred_lm, as_pred_lm_otho</span>
<span id="cb669-20"><a href="mathematics.html#cb669-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb669-21"><a href="mathematics.html#cb669-21" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res =</span> ar_pred_lm <span class="sc">-</span> y),</span>
<span id="cb669-22"><a href="mathematics.html#cb669-22" tabindex="-1"></a>  <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb669-23"><a href="mathematics.html#cb669-23" tabindex="-1"></a>    <span class="st">&quot;Quadratic Fit of 3 Sets of Random (X,Y) Points&quot;</span></span>
<span id="cb669-24"><a href="mathematics.html#cb669-24" tabindex="-1"></a>  )</span>
<span id="cb669-25"><a href="mathematics.html#cb669-25" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-332">Table 8.1: </span>Quadratic Fit of 3 Sets of Random (X,Y) Points
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_pred_sym
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_pred_lm
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
as_pred_lm_otho
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4395244
</td>
<td style="text-align:right;">
1.070508
</td>
<td style="text-align:right;">
1.070508
</td>
<td style="text-align:right;">
1.070508
</td>
<td style="text-align:right;">
1.070508
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7698225
</td>
<td style="text-align:right;">
1.129288
</td>
<td style="text-align:right;">
1.129288
</td>
<td style="text-align:right;">
1.129288
</td>
<td style="text-align:right;">
1.129288
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.5587083
</td>
<td style="text-align:right;">
2.715065
</td>
<td style="text-align:right;">
2.715065
</td>
<td style="text-align:right;">
2.715065
</td>
<td style="text-align:right;">
2.715065
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div id="formulas-for-quadratic-parameters-and-differences" class="section level4 hasAnchor" number="8.1.1.2">
<h4><span class="header-section-number">8.1.1.2</span> Formulas for Quadratic Parameters and Differences<a href="mathematics.html#formulas-for-quadratic-parameters-and-differences" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similar to the prior example, we remain interested in quadratic parameters, however, we no longer observe three sets of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values, instead, we observe differences in the <span class="math inline">\(y\)</span> values. Specifically, we observe <span class="math inline">\(\Delta y_2\)</span> and <span class="math inline">\(\Delta y_3\)</span>, not <span class="math inline">\(y_3\)</span>, <span class="math inline">\(y_2\)</span>, and <span class="math inline">\(y_1\)</span>. We do still observe <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span>. We can no longer identify <span class="math inline">\(A\)</span>, but we can still identify <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_2 - y_1 = \Delta y_2 &amp;= B \cdot ( x_2 - x_1 ) + C \cdot ( x_2^2 - x_1^2) \\
y_3 - y_2 = \Delta y_3 &amp;= B \cdot ( x_3 - x_2 ) + C \cdot ( x_3^2 - x_2^2) \\
\end{aligned}
\]</span></p>
<p>First, we rewrite the problem in <a href="https://fanwangecon.github.io/Math4Econ/matrix_system_of_equations/htmlpdfm/matrix_linear_system_2.html">matrix form</a>.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
\underbrace{ x_2 - x_1 }_{T} &amp; \underbrace{ x_2^2 - x_1^2}_{U} \\
\underbrace{ x_3 - x_2 }_{V} &amp; \underbrace{ x_3^2 - x_2^2}_{W} \\
\end{bmatrix}
\cdot
\begin{bmatrix}
B \\
C
\end{bmatrix}
&amp; =
\begin{bmatrix}
\underbrace{y_2 - y_1}_{R} \\
\underbrace{y_3 - y_2}_{S}
\end{bmatrix}\\
\end{aligned}
\]</span></p>
<p>Second, we solve the system of equations for the unknown vector <span class="math inline">\([B,C]\)</span>, via <a href="https://fanwangecon.github.io/Math4Econ/matrix_system_of_equations/htmlpdfm/matrix_row_echelon_form.html">elementary row operations</a>. The code below uses matlab to arrive at symbolic analytical solutions for for <span class="math inline">\([B,C]\)</span>. Derivations of the solutions are also shown here: <a href="https://fanwangecon.github.io/Math4Econ/matrix_system_of_equations/htmlpdfm/matrix_row_echelon_form.html#16_Reduced_Row_Echelon_Form_with_2_Equations_and_2_Unknowns">Reduced Row Echelon Form with 2 Equations and 2 Unknowns</a>.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode octave"><code class="sourceCode octave"><span id="cb670-1"><a href="mathematics.html#cb670-1" tabindex="-1"></a><span class="fu">clc</span></span>
<span id="cb670-2"><a href="mathematics.html#cb670-2" tabindex="-1"></a><span class="bu">clear</span></span>
<span id="cb670-3"><a href="mathematics.html#cb670-3" tabindex="-1"></a></span>
<span id="cb670-4"><a href="mathematics.html#cb670-4" tabindex="-1"></a><span class="co">% Define inputs</span></span>
<span id="cb670-5"><a href="mathematics.html#cb670-5" tabindex="-1"></a>syms T U V W R S</span>
<span id="cb670-6"><a href="mathematics.html#cb670-6" tabindex="-1"></a>mt_sm_z <span class="op">=</span> [T<span class="op">,</span> U<span class="op">;</span> V<span class="op">,</span> W]<span class="op">;</span></span>
<span id="cb670-7"><a href="mathematics.html#cb670-7" tabindex="-1"></a>ar_sm_y <span class="op">=</span> [R<span class="op">;</span> S]<span class="op">;</span></span>
<span id="cb670-8"><a href="mathematics.html#cb670-8" tabindex="-1"></a></span>
<span id="cb670-9"><a href="mathematics.html#cb670-9" tabindex="-1"></a><span class="co">% Solve analytically</span></span>
<span id="cb670-10"><a href="mathematics.html#cb670-10" tabindex="-1"></a>ar_sm_solu <span class="op">=</span> <span class="fu">linsolve</span>(mt_sm_z<span class="op">,</span> ar_sm_y)</span>
<span id="cb670-11"><a href="mathematics.html#cb670-11" tabindex="-1"></a></span>
<span id="cb670-12"><a href="mathematics.html#cb670-12" tabindex="-1"></a><span class="co">% Randomly draw x and y values</span></span>
<span id="cb670-13"><a href="mathematics.html#cb670-13" tabindex="-1"></a>rng(<span class="fl">1234</span>)<span class="op">;</span></span>
<span id="cb670-14"><a href="mathematics.html#cb670-14" tabindex="-1"></a>mt_rand <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb670-15"><a href="mathematics.html#cb670-15" tabindex="-1"></a><span class="co">% Use below to check not-exact fit, gap actual and predict of y</span></span>
<span id="cb670-16"><a href="mathematics.html#cb670-16" tabindex="-1"></a>mt_rand <span class="op">=</span> [<span class="fl">0.1915</span><span class="op">,</span> <span class="fl">0.6221</span><span class="op">,</span> <span class="fl">0.4377</span><span class="op">;</span></span>
<span id="cb670-17"><a href="mathematics.html#cb670-17" tabindex="-1"></a>           <span class="fl">0.7854</span><span class="op">,</span> <span class="fl">0.7800</span><span class="op">,</span> <span class="fl">0.2726</span>]<span class="op">&#39;;</span></span>
<span id="cb670-18"><a href="mathematics.html#cb670-18" tabindex="-1"></a><span class="co">% Use below to check for exact fit 2nd 3rd points same</span></span>
<span id="cb670-19"><a href="mathematics.html#cb670-19" tabindex="-1"></a><span class="co">% mt_rand = [0.1915, 0.6221, 0.6221;</span></span>
<span id="cb670-20"><a href="mathematics.html#cb670-20" tabindex="-1"></a><span class="co">%  0.7854, 0.7800, 0.7800]&#39;;</span></span>
<span id="cb670-21"><a href="mathematics.html#cb670-21" tabindex="-1"></a>[fl_x1<span class="op">,</span> fl_x2<span class="op">,</span> fl_x3] <span class="op">=</span> <span class="fu">deal</span>(mt_rand(<span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span> mt_rand(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span> mt_rand(<span class="fl">3</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb670-22"><a href="mathematics.html#cb670-22" tabindex="-1"></a>[fl_y1<span class="op">,</span> fl_y2<span class="op">,</span> fl_y3] <span class="op">=</span> <span class="fu">deal</span>(mt_rand(<span class="fl">1</span><span class="op">,</span><span class="fl">2</span>)<span class="op">,</span> mt_rand(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span>)<span class="op">,</span> mt_rand(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb670-23"><a href="mathematics.html#cb670-23" tabindex="-1"></a>[fl_x11<span class="op">,</span> fl_x21<span class="op">,</span> fl_x31] <span class="op">=</span> <span class="fu">deal</span>(fl_x1<span class="op">,</span> fl_x2<span class="op">,</span> fl_x3)<span class="op">;</span></span>
<span id="cb670-24"><a href="mathematics.html#cb670-24" tabindex="-1"></a>[fl_x12<span class="op">,</span> fl_x22<span class="op">,</span> fl_x32] <span class="op">=</span> <span class="fu">deal</span>(fl_x1<span class="op">^</span><span class="fl">2</span><span class="op">,</span> fl_x2<span class="op">^</span><span class="fl">2</span><span class="op">,</span> fl_x3<span class="op">^</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb670-25"><a href="mathematics.html#cb670-25" tabindex="-1"></a></span>
<span id="cb670-26"><a href="mathematics.html#cb670-26" tabindex="-1"></a><span class="co">% Define values of U V Q and S</span></span>
<span id="cb670-27"><a href="mathematics.html#cb670-27" tabindex="-1"></a>fl_T <span class="op">=</span> fl_x21 <span class="op">-</span> fl_x11<span class="op">;</span></span>
<span id="cb670-28"><a href="mathematics.html#cb670-28" tabindex="-1"></a>fl_U <span class="op">=</span> fl_x22 <span class="op">-</span> fl_x12<span class="op">;</span></span>
<span id="cb670-29"><a href="mathematics.html#cb670-29" tabindex="-1"></a>fl_V <span class="op">=</span> fl_x31 <span class="op">-</span> fl_x21<span class="op">;</span></span>
<span id="cb670-30"><a href="mathematics.html#cb670-30" tabindex="-1"></a>fl_W <span class="op">=</span> fl_x32 <span class="op">-</span> fl_x22<span class="op">;</span></span>
<span id="cb670-31"><a href="mathematics.html#cb670-31" tabindex="-1"></a>fl_R <span class="op">=</span> fl_y2 <span class="op">-</span> fl_y1<span class="op">;</span></span>
<span id="cb670-32"><a href="mathematics.html#cb670-32" tabindex="-1"></a>fl_S <span class="op">=</span> fl_y3 <span class="op">-</span> fl_y2<span class="op">;</span></span>
<span id="cb670-33"><a href="mathematics.html#cb670-33" tabindex="-1"></a></span>
<span id="cb670-34"><a href="mathematics.html#cb670-34" tabindex="-1"></a><span class="co">% Numerically evaluate coefficients</span></span>
<span id="cb670-35"><a href="mathematics.html#cb670-35" tabindex="-1"></a>ar_fl_solu <span class="op">=</span> <span class="fu">double</span>(subs(ar_sm_solu<span class="op">,</span> <span class="op">...</span></span>
<span id="cb670-36"><a href="mathematics.html#cb670-36" tabindex="-1"></a>  {T<span class="op">,</span> U<span class="op">,</span> V<span class="op">,</span> W<span class="op">,</span> R<span class="op">,</span> S}<span class="op">,</span> <span class="op">...</span></span>
<span id="cb670-37"><a href="mathematics.html#cb670-37" tabindex="-1"></a>  {fl_T<span class="op">,</span> fl_U<span class="op">,</span> fl_V<span class="op">,</span> fl_W<span class="op">,</span> fl_R<span class="op">,</span> fl_S}))<span class="op">;</span></span>
<span id="cb670-38"><a href="mathematics.html#cb670-38" tabindex="-1"></a><span class="fu">disp</span>([<span class="st">&#39;ar_fl_solu=&#39;</span><span class="op">,</span> <span class="fu">num2str</span>(ar_fl_solu<span class="op">&#39;</span>)])</span>
<span id="cb670-39"><a href="mathematics.html#cb670-39" tabindex="-1"></a></span>
<span id="cb670-40"><a href="mathematics.html#cb670-40" tabindex="-1"></a><span class="co">% Y difference predictions</span></span>
<span id="cb670-41"><a href="mathematics.html#cb670-41" tabindex="-1"></a>mt_fl_z <span class="op">=</span> [fl_T<span class="op">,</span> fl_U<span class="op">;</span>fl_V<span class="op">,</span> fl_W]<span class="op">;</span></span>
<span id="cb670-42"><a href="mathematics.html#cb670-42" tabindex="-1"></a>ar_fl_y_diff_pred <span class="op">=</span> mt_fl_z<span class="op">*</span>ar_fl_solu<span class="op">;</span></span>
<span id="cb670-43"><a href="mathematics.html#cb670-43" tabindex="-1"></a>ar_fl_x_diff_actual <span class="op">=</span> [fl_T<span class="op">;</span>fl_V]<span class="op">;</span></span>
<span id="cb670-44"><a href="mathematics.html#cb670-44" tabindex="-1"></a>ar_fl_x_sqr_diff_actual <span class="op">=</span> [fl_U<span class="op">;</span>fl_W]<span class="op">;</span></span>
<span id="cb670-45"><a href="mathematics.html#cb670-45" tabindex="-1"></a>ar_fl_y_diff_actual <span class="op">=</span> [fl_R<span class="op">;</span>fl_S]<span class="op">;</span></span>
<span id="cb670-46"><a href="mathematics.html#cb670-46" tabindex="-1"></a></span>
<span id="cb670-47"><a href="mathematics.html#cb670-47" tabindex="-1"></a><span class="co">% Compare results</span></span>
<span id="cb670-48"><a href="mathematics.html#cb670-48" tabindex="-1"></a>tb_test <span class="op">=</span> array2table( <span class="op">...</span></span>
<span id="cb670-49"><a href="mathematics.html#cb670-49" tabindex="-1"></a>  [ar_fl_x_diff_actual<span class="op">&#39;;</span> ar_fl_x_sqr_diff_actual<span class="op">&#39;;</span> <span class="op">...</span></span>
<span id="cb670-50"><a href="mathematics.html#cb670-50" tabindex="-1"></a>   ar_fl_y_diff_actual<span class="op">&#39;;</span> ar_fl_y_diff_pred<span class="op">&#39;</span>]<span class="op">&#39;</span>)<span class="op">;</span></span>
<span id="cb670-51"><a href="mathematics.html#cb670-51" tabindex="-1"></a>cl_col_names <span class="op">=</span> [<span class="st">&quot;x_diff_actual&quot;</span><span class="op">,</span> <span class="st">&quot;x_sqr_diff_actual&quot;</span><span class="op">,</span> <span class="op">...</span></span>
<span id="cb670-52"><a href="mathematics.html#cb670-52" tabindex="-1"></a>                <span class="st">&quot;y_diff_actual&quot;</span><span class="op">,</span> <span class="st">&quot;y_diff_predict&quot;</span>]<span class="op">;</span></span>
<span id="cb670-53"><a href="mathematics.html#cb670-53" tabindex="-1"></a>cl_row_names <span class="op">=</span> <span class="fu">strcat</span>(<span class="st">&#39;diff_obs_&#39;</span><span class="op">,</span> string((<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb670-54"><a href="mathematics.html#cb670-54" tabindex="-1"></a>tb_test.Properties.VariableNames <span class="op">=</span> matlab.lang.makeValidName(cl_col_names)<span class="op">;</span></span>
<span id="cb670-55"><a href="mathematics.html#cb670-55" tabindex="-1"></a>tb_test.Properties.RowNames <span class="op">=</span> matlab.lang.makeValidName(cl_row_names)<span class="op">;</span></span>
<span id="cb670-56"><a href="mathematics.html#cb670-56" tabindex="-1"></a><span class="fu">display</span>(tb_test)<span class="op">;</span></span></code></pre></div>
<p>Third, the solutions for the intercept and quadratic terms based on differences in <span class="math inline">\(y\)</span> values and based on functions of the all <span class="math inline">\(x\)</span> values are as follows.</p>
<p><span class="math display">\[
\begin{aligned}
B &amp;= \frac{R W - S U}{ T W - U V}\\
  &amp;= \frac{
\left( y_2 - y_1 \right)
\cdot\left( x_3^2 - x_2^2 \right) -
\left( y_3 - y_2 \right)
\cdot\left( x_2^2 - x_1^2 \right)
}{
\left( x_2 - x_1 \right)
\cdot\left( x_3^2 - x_2^2 \right) -
\left( x_2^2 - x_1^2 \right)
\cdot\left( x_3 - x_2 \right)
}\\
&amp;\\
C &amp;= \frac{S T - R V}{ T W - U V}\\
  &amp;= \frac{
\left( y_3 - y_2 \right)
\cdot\left( x_2 - x_1 \right) -
\left( y_2 - y_1 \right)
\cdot\left( x_3 - x_2 \right)
}{
\left( x_2 - x_1 \right)
\cdot\left( x_3^2 - x_2^2 \right) -
\left( x_2^2 - x_1^2 \right)
\cdot\left( x_3 - x_2 \right)
}
\end{aligned}
\]</span></p>
<p>Fourth, given three pairs randomly drawn x and y points, we use the formulas just derived to find the parameters for the best-fitting slope and quadratic parameters given observed y differences.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="mathematics.html#cb671-1" tabindex="-1"></a><span class="co"># Inputs X and Y</span></span>
<span id="cb671-2"><a href="mathematics.html#cb671-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb671-3"><a href="mathematics.html#cb671-3" tabindex="-1"></a><span class="co"># Draw Randomly</span></span>
<span id="cb671-4"><a href="mathematics.html#cb671-4" tabindex="-1"></a>mt_rnorm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb671-5"><a href="mathematics.html#cb671-5" tabindex="-1"></a><span class="co"># # Three fixed and different set of points</span></span>
<span id="cb671-6"><a href="mathematics.html#cb671-6" tabindex="-1"></a><span class="co"># mt_rnorm &lt;- matrix(c(</span></span>
<span id="cb671-7"><a href="mathematics.html#cb671-7" tabindex="-1"></a><span class="co">#   0.1915, 0.6221, 0.4377,</span></span>
<span id="cb671-8"><a href="mathematics.html#cb671-8" tabindex="-1"></a><span class="co">#   0.7854, 0.7800, 0.2726</span></span>
<span id="cb671-9"><a href="mathematics.html#cb671-9" tabindex="-1"></a><span class="co"># ), nrow = 3, ncol = 2)</span></span>
<span id="cb671-10"><a href="mathematics.html#cb671-10" tabindex="-1"></a></span>
<span id="cb671-11"><a href="mathematics.html#cb671-11" tabindex="-1"></a><span class="fu">colnames</span>(mt_rnorm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb671-12"><a href="mathematics.html#cb671-12" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb671-13"><a href="mathematics.html#cb671-13" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb671-14"><a href="mathematics.html#cb671-14" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb671-15"><a href="mathematics.html#cb671-15" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb671-16"><a href="mathematics.html#cb671-16" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb671-17"><a href="mathematics.html#cb671-17" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb671-18"><a href="mathematics.html#cb671-18" tabindex="-1"></a></span>
<span id="cb671-19"><a href="mathematics.html#cb671-19" tabindex="-1"></a><span class="co"># X quadratic</span></span>
<span id="cb671-20"><a href="mathematics.html#cb671-20" tabindex="-1"></a>x11 <span class="ot">&lt;-</span> x1</span>
<span id="cb671-21"><a href="mathematics.html#cb671-21" tabindex="-1"></a>x12 <span class="ot">&lt;-</span> x1<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb671-22"><a href="mathematics.html#cb671-22" tabindex="-1"></a>x21 <span class="ot">&lt;-</span> x2</span>
<span id="cb671-23"><a href="mathematics.html#cb671-23" tabindex="-1"></a>x22 <span class="ot">&lt;-</span> x2<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb671-24"><a href="mathematics.html#cb671-24" tabindex="-1"></a>x31 <span class="ot">&lt;-</span> x3</span>
<span id="cb671-25"><a href="mathematics.html#cb671-25" tabindex="-1"></a>x32 <span class="ot">&lt;-</span> x3<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb671-26"><a href="mathematics.html#cb671-26" tabindex="-1"></a></span>
<span id="cb671-27"><a href="mathematics.html#cb671-27" tabindex="-1"></a><span class="co"># Define U and V, as well as Q and S</span></span>
<span id="cb671-28"><a href="mathematics.html#cb671-28" tabindex="-1"></a>fl_T <span class="ot">&lt;-</span> x21 <span class="sc">-</span> x11;</span>
<span id="cb671-29"><a href="mathematics.html#cb671-29" tabindex="-1"></a>fl_U <span class="ot">&lt;-</span> x22 <span class="sc">-</span> x12;</span>
<span id="cb671-30"><a href="mathematics.html#cb671-30" tabindex="-1"></a>fl_V <span class="ot">&lt;-</span> x31 <span class="sc">-</span> x21;</span>
<span id="cb671-31"><a href="mathematics.html#cb671-31" tabindex="-1"></a>fl_W <span class="ot">&lt;-</span> x32 <span class="sc">-</span> x22;</span>
<span id="cb671-32"><a href="mathematics.html#cb671-32" tabindex="-1"></a>fl_R <span class="ot">&lt;-</span> y2 <span class="sc">-</span>  y1;</span>
<span id="cb671-33"><a href="mathematics.html#cb671-33" tabindex="-1"></a>fl_S <span class="ot">&lt;-</span> y3 <span class="sc">-</span>  y2;</span>
<span id="cb671-34"><a href="mathematics.html#cb671-34" tabindex="-1"></a></span>
<span id="cb671-35"><a href="mathematics.html#cb671-35" tabindex="-1"></a><span class="co"># Shared denominator</span></span>
<span id="cb671-36"><a href="mathematics.html#cb671-36" tabindex="-1"></a>fl_denominator <span class="ot">&lt;-</span> (fl_T<span class="sc">*</span>fl_W <span class="sc">-</span> fl_U<span class="sc">*</span>fl_V)</span>
<span id="cb671-37"><a href="mathematics.html#cb671-37" tabindex="-1"></a></span>
<span id="cb671-38"><a href="mathematics.html#cb671-38" tabindex="-1"></a><span class="co"># Solve for A and B coefficients (not exact fit)</span></span>
<span id="cb671-39"><a href="mathematics.html#cb671-39" tabindex="-1"></a>fl_B <span class="ot">&lt;-</span> (fl_R <span class="sc">*</span> fl_W <span class="sc">-</span> fl_S <span class="sc">*</span> fl_U) <span class="sc">/</span> fl_denominator</span>
<span id="cb671-40"><a href="mathematics.html#cb671-40" tabindex="-1"></a>fl_C <span class="ot">&lt;-</span> (fl_S <span class="sc">*</span> fl_T <span class="sc">-</span> fl_R <span class="sc">*</span> fl_V) <span class="sc">/</span> fl_denominator</span>
<span id="cb671-41"><a href="mathematics.html#cb671-41" tabindex="-1"></a></span>
<span id="cb671-42"><a href="mathematics.html#cb671-42" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb671-43"><a href="mathematics.html#cb671-43" tabindex="-1"></a>st_display <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb671-44"><a href="mathematics.html#cb671-44" tabindex="-1"></a>  <span class="st">&quot;B(lin)=&quot;</span>, <span class="fu">round</span>(fl_B, <span class="dv">3</span>),</span>
<span id="cb671-45"><a href="mathematics.html#cb671-45" tabindex="-1"></a>  <span class="st">&quot;, C(quad)=&quot;</span>, <span class="fu">round</span>(fl_C, <span class="dv">3</span>)</span>
<span id="cb671-46"><a href="mathematics.html#cb671-46" tabindex="-1"></a>)</span>
<span id="cb671-47"><a href="mathematics.html#cb671-47" tabindex="-1"></a><span class="fu">print</span>(st_display)</span></code></pre></div>
<pre><code>## [1] &quot;B(lin)=-0.226, C(quad)=0.334&quot;</code></pre>
<p>Fifth, to check that the estimates are correct, we derive results from running linear estimation with the three points of data drawn, using all level information. As prior, we use both polynomial and orthogonal polynomials below. Note that we can not run this regression in practice because we do not observe levels, just differences.</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="mathematics.html#cb673-1" tabindex="-1"></a><span class="co"># Estimation results</span></span>
<span id="cb673-2"><a href="mathematics.html#cb673-2" tabindex="-1"></a>df_rnorm <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_rnorm)</span>
<span id="cb673-3"><a href="mathematics.html#cb673-3" tabindex="-1"></a><span class="co"># Linear and quadratic terms</span></span>
<span id="cb673-4"><a href="mathematics.html#cb673-4" tabindex="-1"></a>rs_lm_quad <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> df_rnorm)</span>
<span id="cb673-5"><a href="mathematics.html#cb673-5" tabindex="-1"></a><span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">summary.lm</span>(rs_lm_quad))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = y ~ x + I(x^2), data = df_rnorm)
## 
## Residuals:
## ALL 3 residuals are 0: no residual degrees of freedom!
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   1.1054        NaN     NaN      NaN
## x            -0.2264        NaN     NaN      NaN
## I(x^2)        0.3343        NaN     NaN      NaN
## 
## Residual standard error: NaN on 0 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:    NaN 
## F-statistic:   NaN on 2 and 0 DF,  p-value: NA</code></pre>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="mathematics.html#cb675-1" tabindex="-1"></a><span class="co"># Using orthogonal polynomials</span></span>
<span id="cb675-2"><a href="mathematics.html#cb675-2" tabindex="-1"></a><span class="co"># vs. rs_lm_quad: different parameters, but same predictions</span></span>
<span id="cb675-3"><a href="mathematics.html#cb675-3" tabindex="-1"></a>rs_lm_quad_otho <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data =</span> df_rnorm)</span>
<span id="cb675-4"><a href="mathematics.html#cb675-4" tabindex="-1"></a><span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">summary.lm</span>(rs_lm_quad_otho))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = y ~ poly(x, 2), data = df_rnorm)
## 
## Residuals:
## ALL 3 residuals are 0: no residual degrees of freedom!
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   1.6383        NaN     NaN      NaN
## poly(x, 2)1   1.3109        NaN     NaN      NaN
## poly(x, 2)2   0.1499        NaN     NaN      NaN
## 
## Residual standard error: NaN on 0 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:    NaN 
## F-statistic:   NaN on 2 and 0 DF,  p-value: NA</code></pre>
<p>Sixth, now we compare between the predications based on analytical solutions using differences in <span class="math inline">\(y\)</span>, and lm regression. The fit of differences in <span class="math inline">\(y\)</span> are exact.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="mathematics.html#cb677-1" tabindex="-1"></a><span class="co"># Matrix of input values</span></span>
<span id="cb677-2"><a href="mathematics.html#cb677-2" tabindex="-1"></a>mt_vals_xs <span class="ot">&lt;-</span> <span class="fu">t</span>(</span>
<span id="cb677-3"><a href="mathematics.html#cb677-3" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(x2 <span class="sc">-</span> x1, x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> x1<span class="sc">^</span><span class="dv">2</span>, x3 <span class="sc">-</span> x2, x3<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> x2<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb677-4"><a href="mathematics.html#cb677-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb677-5"><a href="mathematics.html#cb677-5" tabindex="-1"></a>  )</span>
<span id="cb677-6"><a href="mathematics.html#cb677-6" tabindex="-1"></a>)</span>
<span id="cb677-7"><a href="mathematics.html#cb677-7" tabindex="-1"></a></span>
<span id="cb677-8"><a href="mathematics.html#cb677-8" tabindex="-1"></a><span class="co"># Predictions from LM poly prediction</span></span>
<span id="cb677-9"><a href="mathematics.html#cb677-9" tabindex="-1"></a>ar_pred_lm <span class="ot">&lt;-</span> mt_vals_xs <span class="sc">%*%</span> <span class="fu">as.vector</span>(rs_lm_quad<span class="sc">$</span>coefficients)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb677-10"><a href="mathematics.html#cb677-10" tabindex="-1"></a>as_pred_lm_otho_lvl <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict</span>(rs_lm_quad_otho)</span>
<span id="cb677-11"><a href="mathematics.html#cb677-11" tabindex="-1"></a>as_pred_lm_otho <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">diff</span>(as_pred_lm_otho_lvl)))</span>
<span id="cb677-12"><a href="mathematics.html#cb677-12" tabindex="-1"></a></span>
<span id="cb677-13"><a href="mathematics.html#cb677-13" tabindex="-1"></a><span class="co"># Predictions based on analytical solutions</span></span>
<span id="cb677-14"><a href="mathematics.html#cb677-14" tabindex="-1"></a>ar_pred_sym <span class="ot">&lt;-</span> mt_vals_xs <span class="sc">%*%</span> <span class="fu">c</span>(fl_B, fl_C)</span>
<span id="cb677-15"><a href="mathematics.html#cb677-15" tabindex="-1"></a></span>
<span id="cb677-16"><a href="mathematics.html#cb677-16" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb677-17"><a href="mathematics.html#cb677-17" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb677-18"><a href="mathematics.html#cb677-18" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb677-19"><a href="mathematics.html#cb677-19" tabindex="-1"></a>    <span class="fu">as_tibble</span>(<span class="fu">apply</span>(df_rnorm, <span class="dv">2</span>, diff)), ar_pred_sym,</span>
<span id="cb677-20"><a href="mathematics.html#cb677-20" tabindex="-1"></a>    ar_pred_lm, as_pred_lm_otho</span>
<span id="cb677-21"><a href="mathematics.html#cb677-21" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb677-22"><a href="mathematics.html#cb677-22" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res =</span> ar_pred_lm <span class="sc">-</span> y),</span>
<span id="cb677-23"><a href="mathematics.html#cb677-23" tabindex="-1"></a>  <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb677-24"><a href="mathematics.html#cb677-24" tabindex="-1"></a>    <span class="st">&quot;Quadratic Fit, given 3 Sets of Random (X,Y) Points&#39; Differences in Y&quot;</span></span>
<span id="cb677-25"><a href="mathematics.html#cb677-25" tabindex="-1"></a>  )</span>
<span id="cb677-26"><a href="mathematics.html#cb677-26" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-336">Table 8.2: </span>Quadratic Fit, given 3 Sets of Random (X,Y) Points’ Differences in Y
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_pred_sym
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_pred_lm
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
as_pred_lm_otho
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.3302982
</td>
<td style="text-align:right;">
0.0587793
</td>
<td style="text-align:right;">
0.0587793
</td>
<td style="text-align:right;">
0.0587793
</td>
<td style="text-align:right;">
0.0587793
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
1.7888858
</td>
<td style="text-align:right;">
1.5857773
</td>
<td style="text-align:right;">
1.5857773
</td>
<td style="text-align:right;">
1.5857773
</td>
<td style="text-align:right;">
1.5857773
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div id="formulas-for-linear-fit-with-three-points" class="section level4 hasAnchor" number="8.1.1.3">
<h4><span class="header-section-number">8.1.1.3</span> Formulas for Linear Fit with Three Points<a href="mathematics.html#formulas-for-linear-fit-with-three-points" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have three points, what are the optimizing intercept and slope parameters? We solve the following problem to minimize the sum-squared error given linear fit with the three points.</p>
<p>First, the minimizing objective function is:</p>
<p><span class="math display">\[
O(A,B) =
\left\{
  \left(
    y_1 - A - B x_1
  \right)^2
  +
  \left(
    y_2 - A - B x_2
  \right)^2
  +
  \left(
    y_3 - A - B x_3
  \right)^2
\right\}
\]</span></p>
<p>Second, we solve for <span class="math inline">\(min_{A,B} O(A,B)\)</span>. We take derivative of <span class="math inline">\(O(A,B)\)</span> with respect to <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial O}{\partial A} &amp;= - \left(
    y_1 - A - B x_1
  \right) - \left(
    y_2 - A - B x_2
  \right) - \left(
    y_3 - A - B x_3
  \right)\\
&amp;= A + B x_1 - y_1 +
  A + B x_2 - y_2 +
  A + B x_3 - y_3\\
&amp;= 3 A + \left(x_1 + x_2 + x_3\right) B -
  \left(y_1 + y_2 + y_3\right)\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial O}{\partial B} &amp;= -
  x_1 \left(
    y_1 - A - B x_1
  \right) -
  x_2 \left(
    y_2 - A - B x_2
  \right) -
  x_3 \left(
    y_3 - A - B x_3
  \right)\\
&amp;= \left(x_1 + x_2 + x_3\right) A +
   \left(x_1^2 + x_2^2 + x_3^2\right) B -
  \left(x_1 y_1 + x_2 y_2 + x_3 y_3\right)\\
\end{aligned}
\]</span></p>
<p>Third, at the optimizing minimum (note quadratic), we now have two equations with two unknowns:</p>
<p><span class="math display">\[
\begin{aligned}
\left(y_1 + y_2 + y_3\right) &amp;=
3 A + \left(x_1 + x_2 + x_3\right) B\\
\left(x_1 y_1 + x_2 y_2 + x_3 y_3\right) &amp;=
\left(x_1 + x_2 + x_3\right) A +
\left(x_1^2 + x_2^2 + x_3^2\right) B \\
\end{aligned}
\]</span></p>
<p>Fourth, we rewrite the problem in <a href="https://fanwangecon.github.io/Math4Econ/matrix_system_of_equations/htmlpdfm/matrix_linear_system_2.html">matrix form</a>.</p>
<p><span class="math display">\[
\begin{aligned}
\begin{bmatrix}
3 &amp; \underbrace{x_1 + x_2 + x_3}_{U} \\
\underbrace{x_1 + x_2 + x_3}_{U} &amp; \underbrace{x_1^2 + x_2^2 + x_3^2}_{V} \\
\end{bmatrix}
\cdot
\begin{bmatrix}
A \\
B
\end{bmatrix}
&amp; =
\begin{bmatrix}
\underbrace{y_1 + y_2 + y_3}_{Q} \\
\underbrace{x_1 y_1 + x_2 y_2 + x_3 y_3}_{S}
\end{bmatrix}\\
\end{aligned}
\]</span></p>
<p>Fifth, we solve the system of equations for the unknown vector <span class="math inline">\([A,B]\)</span>, via <a href="https://fanwangecon.github.io/Math4Econ/matrix_system_of_equations/htmlpdfm/matrix_row_echelon_form.html">elementary row operations</a>. The code below uses matlab to arrive at symbolic analytical solutions for for <span class="math inline">\([A,B]\)</span>.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode octave"><code class="sourceCode octave"><span id="cb678-1"><a href="mathematics.html#cb678-1" tabindex="-1"></a><span class="fu">clc</span></span>
<span id="cb678-2"><a href="mathematics.html#cb678-2" tabindex="-1"></a><span class="bu">clear</span></span>
<span id="cb678-3"><a href="mathematics.html#cb678-3" tabindex="-1"></a></span>
<span id="cb678-4"><a href="mathematics.html#cb678-4" tabindex="-1"></a><span class="co">% Define inputs</span></span>
<span id="cb678-5"><a href="mathematics.html#cb678-5" tabindex="-1"></a>syms U V Q S</span>
<span id="cb678-6"><a href="mathematics.html#cb678-6" tabindex="-1"></a>mt_sm_z <span class="op">=</span> [<span class="fl">3</span><span class="op">,</span> U<span class="op">;</span> U<span class="op">,</span> V]<span class="op">;</span></span>
<span id="cb678-7"><a href="mathematics.html#cb678-7" tabindex="-1"></a>ar_sm_y <span class="op">=</span> [Q<span class="op">;</span> S]<span class="op">;</span></span>
<span id="cb678-8"><a href="mathematics.html#cb678-8" tabindex="-1"></a></span>
<span id="cb678-9"><a href="mathematics.html#cb678-9" tabindex="-1"></a><span class="co">% Solve analytically</span></span>
<span id="cb678-10"><a href="mathematics.html#cb678-10" tabindex="-1"></a>ar_sm_solu <span class="op">=</span> <span class="fu">linsolve</span>(mt_sm_z<span class="op">,</span> ar_sm_y)</span>
<span id="cb678-11"><a href="mathematics.html#cb678-11" tabindex="-1"></a></span>
<span id="cb678-12"><a href="mathematics.html#cb678-12" tabindex="-1"></a><span class="co">% Randomly draw x and y values</span></span>
<span id="cb678-13"><a href="mathematics.html#cb678-13" tabindex="-1"></a>rng(<span class="fl">1234</span>)<span class="op">;</span></span>
<span id="cb678-14"><a href="mathematics.html#cb678-14" tabindex="-1"></a>mt_rand <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb678-15"><a href="mathematics.html#cb678-15" tabindex="-1"></a><span class="co">% Use below to check not-exact fit, gap actual and predict of y</span></span>
<span id="cb678-16"><a href="mathematics.html#cb678-16" tabindex="-1"></a>mt_rand <span class="op">=</span> [<span class="fl">0.1915</span><span class="op">,</span> <span class="fl">0.6221</span><span class="op">,</span> <span class="fl">0.4377</span><span class="op">;</span></span>
<span id="cb678-17"><a href="mathematics.html#cb678-17" tabindex="-1"></a>  <span class="fl">0.7854</span><span class="op">,</span> <span class="fl">0.7800</span><span class="op">,</span> <span class="fl">0.2726</span>]<span class="op">&#39;;</span></span>
<span id="cb678-18"><a href="mathematics.html#cb678-18" tabindex="-1"></a><span class="co">% Use below to check for exact fit 2nd 3rd points same</span></span>
<span id="cb678-19"><a href="mathematics.html#cb678-19" tabindex="-1"></a><span class="co">% mt_rand = [0.1915, 0.6221, 0.6221;</span></span>
<span id="cb678-20"><a href="mathematics.html#cb678-20" tabindex="-1"></a><span class="co">%  0.7854, 0.7800, 0.7800]&#39;;</span></span>
<span id="cb678-21"><a href="mathematics.html#cb678-21" tabindex="-1"></a>[fl_x1<span class="op">,</span> fl_x2<span class="op">,</span> fl_x3] <span class="op">=</span> <span class="fu">deal</span>(mt_rand(<span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span> mt_rand(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span> mt_rand(<span class="fl">3</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb678-22"><a href="mathematics.html#cb678-22" tabindex="-1"></a>[fl_y1<span class="op">,</span> fl_y2<span class="op">,</span> fl_y3] <span class="op">=</span> <span class="fu">deal</span>(mt_rand(<span class="fl">1</span><span class="op">,</span><span class="fl">2</span>)<span class="op">,</span> mt_rand(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span>)<span class="op">,</span> mt_rand(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb678-23"><a href="mathematics.html#cb678-23" tabindex="-1"></a>[fl_x11<span class="op">,</span> fl_x21<span class="op">,</span> fl_x31] <span class="op">=</span> <span class="fu">deal</span>(fl_x1<span class="op">,</span> fl_x2<span class="op">,</span> fl_x3)<span class="op">;</span></span>
<span id="cb678-24"><a href="mathematics.html#cb678-24" tabindex="-1"></a>[fl_x12<span class="op">,</span> fl_x22<span class="op">,</span> fl_x32] <span class="op">=</span> <span class="fu">deal</span>(fl_x1<span class="op">^</span><span class="fl">2</span><span class="op">,</span> fl_x2<span class="op">^</span><span class="fl">2</span><span class="op">,</span> fl_x3<span class="op">^</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb678-25"><a href="mathematics.html#cb678-25" tabindex="-1"></a></span>
<span id="cb678-26"><a href="mathematics.html#cb678-26" tabindex="-1"></a><span class="co">% Define values of U V Q and S</span></span>
<span id="cb678-27"><a href="mathematics.html#cb678-27" tabindex="-1"></a>fl_U <span class="op">=</span> fl_x11 <span class="op">+</span> fl_x21 <span class="op">+</span> fl_x31<span class="op">;</span></span>
<span id="cb678-28"><a href="mathematics.html#cb678-28" tabindex="-1"></a>fl_V <span class="op">=</span> fl_x12 <span class="op">+</span> fl_x22 <span class="op">+</span> fl_x32<span class="op">;</span></span>
<span id="cb678-29"><a href="mathematics.html#cb678-29" tabindex="-1"></a>fl_Q <span class="op">=</span> fl_y1 <span class="op">+</span> fl_y2 <span class="op">+</span> fl_y3<span class="op">;</span></span>
<span id="cb678-30"><a href="mathematics.html#cb678-30" tabindex="-1"></a>fl_S <span class="op">=</span> fl_y1<span class="op">*</span>fl_x11 <span class="op">+</span> fl_y2<span class="op">*</span>fl_x21 <span class="op">+</span> fl_y3<span class="op">*</span>fl_x31<span class="op">;</span></span>
<span id="cb678-31"><a href="mathematics.html#cb678-31" tabindex="-1"></a></span>
<span id="cb678-32"><a href="mathematics.html#cb678-32" tabindex="-1"></a><span class="co">% Numerically evaluate coefficients</span></span>
<span id="cb678-33"><a href="mathematics.html#cb678-33" tabindex="-1"></a>ar_fl_solu <span class="op">=</span> <span class="fu">double</span>(subs(ar_sm_solu<span class="op">,</span> <span class="op">...</span></span>
<span id="cb678-34"><a href="mathematics.html#cb678-34" tabindex="-1"></a>  {U<span class="op">,</span> V<span class="op">,</span> Q<span class="op">,</span> S}<span class="op">,</span> <span class="op">...</span></span>
<span id="cb678-35"><a href="mathematics.html#cb678-35" tabindex="-1"></a>  {fl_U<span class="op">,</span> fl_V<span class="op">,</span> fl_Q<span class="op">,</span> fl_S}))<span class="op">;</span></span>
<span id="cb678-36"><a href="mathematics.html#cb678-36" tabindex="-1"></a><span class="fu">disp</span>([<span class="st">&#39;ar_fl_solu=&#39;</span><span class="op">,</span> <span class="fu">num2str</span>(ar_fl_solu<span class="op">&#39;</span>)])</span>
<span id="cb678-37"><a href="mathematics.html#cb678-37" tabindex="-1"></a></span>
<span id="cb678-38"><a href="mathematics.html#cb678-38" tabindex="-1"></a><span class="co">% Y predictions</span></span>
<span id="cb678-39"><a href="mathematics.html#cb678-39" tabindex="-1"></a>mt_fl_z <span class="op">=</span> [<span class="fl">1</span><span class="op">,</span>fl_x11<span class="op">;</span><span class="fl">1</span><span class="op">,</span>fl_x21<span class="op">;</span><span class="fl">1</span><span class="op">,</span>fl_x31]<span class="op">;</span></span>
<span id="cb678-40"><a href="mathematics.html#cb678-40" tabindex="-1"></a>ar_fl_y_pred <span class="op">=</span> mt_fl_z<span class="op">*</span>ar_fl_solu<span class="op">;</span></span>
<span id="cb678-41"><a href="mathematics.html#cb678-41" tabindex="-1"></a>ar_fl_x_actual <span class="op">=</span> [fl_x1<span class="op">;</span>fl_x2<span class="op">;</span>fl_x3]<span class="op">;</span></span>
<span id="cb678-42"><a href="mathematics.html#cb678-42" tabindex="-1"></a>ar_fl_y_actual <span class="op">=</span> [fl_y1<span class="op">;</span>fl_y2<span class="op">;</span>fl_y3]<span class="op">;</span></span>
<span id="cb678-43"><a href="mathematics.html#cb678-43" tabindex="-1"></a></span>
<span id="cb678-44"><a href="mathematics.html#cb678-44" tabindex="-1"></a><span class="co">% Compare results</span></span>
<span id="cb678-45"><a href="mathematics.html#cb678-45" tabindex="-1"></a>tb_test <span class="op">=</span> array2table([ar_fl_x_actual<span class="op">&#39;;</span>ar_fl_y_actual<span class="op">&#39;;</span>ar_fl_y_pred<span class="op">&#39;</span>]<span class="op">&#39;</span>)<span class="op">;</span></span>
<span id="cb678-46"><a href="mathematics.html#cb678-46" tabindex="-1"></a>cl_col_names <span class="op">=</span> [<span class="st">&quot;x_actual&quot;</span><span class="op">,</span><span class="st">&quot;y_actual&quot;</span><span class="op">,</span> <span class="st">&quot;y_predict&quot;</span>]<span class="op">;</span></span>
<span id="cb678-47"><a href="mathematics.html#cb678-47" tabindex="-1"></a>cl_row_names <span class="op">=</span> <span class="fu">strcat</span>(<span class="st">&#39;obs_&#39;</span><span class="op">,</span> string((<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>)))<span class="op">;</span></span>
<span id="cb678-48"><a href="mathematics.html#cb678-48" tabindex="-1"></a>tb_test.Properties.VariableNames <span class="op">=</span> matlab.lang.makeValidName(cl_col_names)<span class="op">;</span></span>
<span id="cb678-49"><a href="mathematics.html#cb678-49" tabindex="-1"></a>tb_test.Properties.RowNames <span class="op">=</span> matlab.lang.makeValidName(cl_row_names)<span class="op">;</span></span>
<span id="cb678-50"><a href="mathematics.html#cb678-50" tabindex="-1"></a><span class="fu">display</span>(tb_test)<span class="op">;</span></span></code></pre></div>
<p>Sixth, the solutions are as follows.</p>
<p><span class="math display">\[
\begin{aligned}
A &amp;= \frac{Q V - S U}{- U^2 + 3 V}\\
  &amp;= \frac{
\left(y_1 + y_2 + y_3\right)
\cdot \left(x_1^2 + x_2^2 + x_3^2\right) -
\left(x_1 y_1 + x_2 y_2 + x_3 y_3\right)
\cdot \left(x_1 + x_2 + x_3\right)
}{
3\cdot \left(x_1^2 + x_2^2 + x_3^2\right) -
\left(x_1 + x_2 + x_3\right)^2
}\\
&amp;\\
B &amp;= \frac{3 S - Q U}{- U^2 + 3 V}\\
  &amp;= \frac{
3 \left(x_1 y_1 + x_2 y_2 + x_3 y_3\right) -
\left(y_1 + y_2 + y_3\right) \cdot
\left(x_1 + x_2 + x_3\right)
}{
3\cdot \left(x_1^2 + x_2^2 + x_3^2\right) -
\left(x_1 + x_2 + x_3\right)^2
}
\end{aligned}
\]</span></p>
<p>Seventh, given three pairs randomly drawn x and y points, we use the formulas just derived to find the parameters for the best-fitting y-intercept and slope values.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="mathematics.html#cb679-1" tabindex="-1"></a><span class="co"># Inputs X and Y</span></span>
<span id="cb679-2"><a href="mathematics.html#cb679-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb679-3"><a href="mathematics.html#cb679-3" tabindex="-1"></a><span class="co"># Draw Randomly</span></span>
<span id="cb679-4"><a href="mathematics.html#cb679-4" tabindex="-1"></a>mt_rnorm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb679-5"><a href="mathematics.html#cb679-5" tabindex="-1"></a><span class="co"># # Three fixed and different set of points</span></span>
<span id="cb679-6"><a href="mathematics.html#cb679-6" tabindex="-1"></a><span class="co"># mt_rnorm &lt;- matrix(c(</span></span>
<span id="cb679-7"><a href="mathematics.html#cb679-7" tabindex="-1"></a><span class="co">#   0.1915, 0.6221, 0.4377,</span></span>
<span id="cb679-8"><a href="mathematics.html#cb679-8" tabindex="-1"></a><span class="co">#   0.7854, 0.7800, 0.2726</span></span>
<span id="cb679-9"><a href="mathematics.html#cb679-9" tabindex="-1"></a><span class="co"># ), nrow = 3, ncol = 2)</span></span>
<span id="cb679-10"><a href="mathematics.html#cb679-10" tabindex="-1"></a><span class="co"># # Below, the 2nd and 3rd points are the same</span></span>
<span id="cb679-11"><a href="mathematics.html#cb679-11" tabindex="-1"></a><span class="co"># mt_rnorm &lt;- matrix(c(</span></span>
<span id="cb679-12"><a href="mathematics.html#cb679-12" tabindex="-1"></a><span class="co">#   0.1915, 0.6221, 0.6221,</span></span>
<span id="cb679-13"><a href="mathematics.html#cb679-13" tabindex="-1"></a><span class="co">#   0.7854, 0.7800, 0.7800</span></span>
<span id="cb679-14"><a href="mathematics.html#cb679-14" tabindex="-1"></a><span class="co"># ), nrow = 3, ncol = 2)</span></span>
<span id="cb679-15"><a href="mathematics.html#cb679-15" tabindex="-1"></a></span>
<span id="cb679-16"><a href="mathematics.html#cb679-16" tabindex="-1"></a><span class="fu">colnames</span>(mt_rnorm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb679-17"><a href="mathematics.html#cb679-17" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb679-18"><a href="mathematics.html#cb679-18" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb679-19"><a href="mathematics.html#cb679-19" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb679-20"><a href="mathematics.html#cb679-20" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb679-21"><a href="mathematics.html#cb679-21" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb679-22"><a href="mathematics.html#cb679-22" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> mt_rnorm[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb679-23"><a href="mathematics.html#cb679-23" tabindex="-1"></a></span>
<span id="cb679-24"><a href="mathematics.html#cb679-24" tabindex="-1"></a><span class="co"># X quadratic</span></span>
<span id="cb679-25"><a href="mathematics.html#cb679-25" tabindex="-1"></a>x11 <span class="ot">&lt;-</span> x1</span>
<span id="cb679-26"><a href="mathematics.html#cb679-26" tabindex="-1"></a>x12 <span class="ot">&lt;-</span> x1<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb679-27"><a href="mathematics.html#cb679-27" tabindex="-1"></a>x21 <span class="ot">&lt;-</span> x2</span>
<span id="cb679-28"><a href="mathematics.html#cb679-28" tabindex="-1"></a>x22 <span class="ot">&lt;-</span> x2<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb679-29"><a href="mathematics.html#cb679-29" tabindex="-1"></a>x31 <span class="ot">&lt;-</span> x3</span>
<span id="cb679-30"><a href="mathematics.html#cb679-30" tabindex="-1"></a>x32 <span class="ot">&lt;-</span> x3<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb679-31"><a href="mathematics.html#cb679-31" tabindex="-1"></a></span>
<span id="cb679-32"><a href="mathematics.html#cb679-32" tabindex="-1"></a><span class="co"># Define U and V, as well as Q and S</span></span>
<span id="cb679-33"><a href="mathematics.html#cb679-33" tabindex="-1"></a>fl_U <span class="ot">&lt;-</span> x11 <span class="sc">+</span> x21 <span class="sc">+</span> x31</span>
<span id="cb679-34"><a href="mathematics.html#cb679-34" tabindex="-1"></a>fl_V <span class="ot">&lt;-</span> x12 <span class="sc">+</span> x22 <span class="sc">+</span> x32</span>
<span id="cb679-35"><a href="mathematics.html#cb679-35" tabindex="-1"></a>fl_Q <span class="ot">&lt;-</span> y1 <span class="sc">+</span> y2 <span class="sc">+</span> y3</span>
<span id="cb679-36"><a href="mathematics.html#cb679-36" tabindex="-1"></a>fl_S <span class="ot">&lt;-</span> x11<span class="sc">*</span>y1 <span class="sc">+</span> x21<span class="sc">*</span>y2 <span class="sc">+</span> x31<span class="sc">*</span>y3</span>
<span id="cb679-37"><a href="mathematics.html#cb679-37" tabindex="-1"></a></span>
<span id="cb679-38"><a href="mathematics.html#cb679-38" tabindex="-1"></a><span class="co"># Shared denominator</span></span>
<span id="cb679-39"><a href="mathematics.html#cb679-39" tabindex="-1"></a>fl_denominator <span class="ot">&lt;-</span> (<span class="dv">3</span><span class="sc">*</span>fl_V <span class="sc">-</span> fl_U<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb679-40"><a href="mathematics.html#cb679-40" tabindex="-1"></a></span>
<span id="cb679-41"><a href="mathematics.html#cb679-41" tabindex="-1"></a><span class="co"># Solve for A and B coefficients (not exact fit)</span></span>
<span id="cb679-42"><a href="mathematics.html#cb679-42" tabindex="-1"></a>fl_A <span class="ot">&lt;-</span> (fl_Q <span class="sc">*</span> fl_V <span class="sc">-</span> fl_S <span class="sc">*</span> fl_U) <span class="sc">/</span> fl_denominator</span>
<span id="cb679-43"><a href="mathematics.html#cb679-43" tabindex="-1"></a></span>
<span id="cb679-44"><a href="mathematics.html#cb679-44" tabindex="-1"></a>fl_B <span class="ot">&lt;-</span> (<span class="dv">3</span> <span class="sc">*</span> fl_S <span class="sc">-</span> fl_Q <span class="sc">*</span> fl_U) <span class="sc">/</span> fl_denominator</span>
<span id="cb679-45"><a href="mathematics.html#cb679-45" tabindex="-1"></a></span>
<span id="cb679-46"><a href="mathematics.html#cb679-46" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb679-47"><a href="mathematics.html#cb679-47" tabindex="-1"></a>st_display <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb679-48"><a href="mathematics.html#cb679-48" tabindex="-1"></a>  <span class="st">&quot;A(intercept)=&quot;</span>, <span class="fu">round</span>(fl_A, <span class="dv">3</span>),</span>
<span id="cb679-49"><a href="mathematics.html#cb679-49" tabindex="-1"></a>  <span class="st">&quot;, B(lin)=&quot;</span>, <span class="fu">round</span>(fl_B, <span class="dv">3</span>)</span>
<span id="cb679-50"><a href="mathematics.html#cb679-50" tabindex="-1"></a>)</span>
<span id="cb679-51"><a href="mathematics.html#cb679-51" tabindex="-1"></a><span class="fu">print</span>(st_display)</span></code></pre></div>
<pre><code>## [1] &quot;A(intercept)=0.617, B(lin)=0.813&quot;</code></pre>
<p>Eighth, to check that the estimates are correct, we derive results from running linear estimation with the three points of data drawn. We use both polynomial and orthogonal polynomials below.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="mathematics.html#cb681-1" tabindex="-1"></a><span class="co"># Estimation results</span></span>
<span id="cb681-2"><a href="mathematics.html#cb681-2" tabindex="-1"></a>df_rnorm <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_rnorm)</span>
<span id="cb681-3"><a href="mathematics.html#cb681-3" tabindex="-1"></a><span class="co"># Linear and quadratic terms</span></span>
<span id="cb681-4"><a href="mathematics.html#cb681-4" tabindex="-1"></a>rs_lm_quad <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df_rnorm)</span>
<span id="cb681-5"><a href="mathematics.html#cb681-5" tabindex="-1"></a><span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">summary.lm</span>(rs_lm_quad))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = y ~ x, data = df_rnorm)
## 
## Residuals:
##        1        2        3 
##  0.09601 -0.11374  0.01773 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  0.61718    0.14533   4.247   0.1472  
## x            0.81297    0.09296   8.746   0.0725 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1499 on 1 degrees of freedom
## Multiple R-squared:  0.9871, Adjusted R-squared:  0.9742 
## F-statistic: 76.48 on 1 and 1 DF,  p-value: 0.07248</code></pre>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="mathematics.html#cb683-1" tabindex="-1"></a><span class="co"># Using orthogonal polynomials</span></span>
<span id="cb683-2"><a href="mathematics.html#cb683-2" tabindex="-1"></a><span class="co"># vs. rs_lm_quad: different parameters, but same predictions</span></span>
<span id="cb683-3"><a href="mathematics.html#cb683-3" tabindex="-1"></a>rs_lm_quad_otho <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">1</span>), <span class="at">data =</span> df_rnorm)</span>
<span id="cb683-4"><a href="mathematics.html#cb683-4" tabindex="-1"></a><span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">summary.lm</span>(rs_lm_quad_otho))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = y ~ poly(x, 1), data = df_rnorm)
## 
## Residuals:
##        1        2        3 
##  0.09601 -0.11374  0.01773 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  1.63829    0.08654  18.931   0.0336 *
## poly(x, 1)   1.31089    0.14989   8.746   0.0725 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1499 on 1 degrees of freedom
## Multiple R-squared:  0.9871, Adjusted R-squared:  0.9742 
## F-statistic: 76.48 on 1 and 1 DF,  p-value: 0.07248</code></pre>
<p>Ninth, now we compare between the predications based on analytical solutions and lm regression. Again, note that the fit is not exact.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="mathematics.html#cb685-1" tabindex="-1"></a><span class="co"># Matrix of input values</span></span>
<span id="cb685-2"><a href="mathematics.html#cb685-2" tabindex="-1"></a>mt_vals_xs <span class="ot">&lt;-</span> <span class="fu">t</span>(</span>
<span id="cb685-3"><a href="mathematics.html#cb685-3" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, x1, <span class="dv">1</span>, x2, <span class="dv">1</span>, x3),</span>
<span id="cb685-4"><a href="mathematics.html#cb685-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb685-5"><a href="mathematics.html#cb685-5" tabindex="-1"></a>  )</span>
<span id="cb685-6"><a href="mathematics.html#cb685-6" tabindex="-1"></a>)</span>
<span id="cb685-7"><a href="mathematics.html#cb685-7" tabindex="-1"></a></span>
<span id="cb685-8"><a href="mathematics.html#cb685-8" tabindex="-1"></a><span class="co"># Predictions from LM poly prediction</span></span>
<span id="cb685-9"><a href="mathematics.html#cb685-9" tabindex="-1"></a>ar_pred_lm <span class="ot">&lt;-</span> mt_vals_xs <span class="sc">%*%</span> <span class="fu">as.vector</span>(rs_lm_quad<span class="sc">$</span>coefficients)</span>
<span id="cb685-10"><a href="mathematics.html#cb685-10" tabindex="-1"></a>as_pred_lm_otho <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict</span>(rs_lm_quad_otho)</span>
<span id="cb685-11"><a href="mathematics.html#cb685-11" tabindex="-1"></a></span>
<span id="cb685-12"><a href="mathematics.html#cb685-12" tabindex="-1"></a><span class="co"># Predictions based on analytical solutions</span></span>
<span id="cb685-13"><a href="mathematics.html#cb685-13" tabindex="-1"></a>ar_pred_sym <span class="ot">&lt;-</span> mt_vals_xs <span class="sc">%*%</span> <span class="fu">c</span>(fl_A, fl_B)</span>
<span id="cb685-14"><a href="mathematics.html#cb685-14" tabindex="-1"></a></span>
<span id="cb685-15"><a href="mathematics.html#cb685-15" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb685-16"><a href="mathematics.html#cb685-16" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb685-17"><a href="mathematics.html#cb685-17" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb685-18"><a href="mathematics.html#cb685-18" tabindex="-1"></a>    df_rnorm, ar_pred_sym,</span>
<span id="cb685-19"><a href="mathematics.html#cb685-19" tabindex="-1"></a>    ar_pred_lm, as_pred_lm_otho</span>
<span id="cb685-20"><a href="mathematics.html#cb685-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb685-21"><a href="mathematics.html#cb685-21" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res =</span> ar_pred_lm <span class="sc">-</span> y),</span>
<span id="cb685-22"><a href="mathematics.html#cb685-22" tabindex="-1"></a>  <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb685-23"><a href="mathematics.html#cb685-23" tabindex="-1"></a>    <span class="st">&quot;Linear Fit of 3 Sets of Random (X,Y) Points&quot;</span></span>
<span id="cb685-24"><a href="mathematics.html#cb685-24" tabindex="-1"></a>  )</span>
<span id="cb685-25"><a href="mathematics.html#cb685-25" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-340">Table 8.3: </span>Linear Fit of 3 Sets of Random (X,Y) Points
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_pred_sym
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_pred_lm
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
as_pred_lm_otho
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
res
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4395244
</td>
<td style="text-align:right;">
1.070508
</td>
<td style="text-align:right;">
0.9744999
</td>
<td style="text-align:right;">
0.9744999
</td>
<td style="text-align:right;">
0.9744999
</td>
<td style="text-align:right;">
-0.0960085
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7698225
</td>
<td style="text-align:right;">
1.129288
</td>
<td style="text-align:right;">
1.2430232
</td>
<td style="text-align:right;">
1.2430232
</td>
<td style="text-align:right;">
1.2430232
</td>
<td style="text-align:right;">
0.1137354
</td>
</tr>
<tr>
<td style="text-align:right;">
2.5587083
</td>
<td style="text-align:right;">
2.715065
</td>
<td style="text-align:right;">
2.6973381
</td>
<td style="text-align:right;">
2.6973381
</td>
<td style="text-align:right;">
2.6973381
</td>
<td style="text-align:right;">
-0.0177269
</td>
</tr>
</tbody>
</table>

</div>
</div>
<div id="rescale-a-parameter-with-fixed-min-and-max" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Rescale a Parameter with Fixed Min and Max<a href="mathematics.html#rescale-a-parameter-with-fixed-min-and-max" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="rescale-a-fraction-between-0-and-1" class="section level4 hasAnchor" number="8.1.2.1">
<h4><span class="header-section-number">8.1.2.1</span> Rescale a Fraction Between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span><a href="mathematics.html#rescale-a-fraction-between-0-and-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have ratio <span class="math inline">\(0&lt;\theta&lt;1\)</span>, we want to multiply <span class="math inline">\(\theta\)</span> to get closer to 0 or to 1, but to not exceed the bounds of <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. This is achieved by the following <span class="math inline">\(\widehat{\theta}\left(\theta, \lambda\right)\)</span> function, where we adjust <span class="math inline">\(\lambda\)</span> between negative and positive infinities to move <span class="math inline">\(\theta\)</span> closer to <span class="math inline">\(0\)</span> (as <span class="math inline">\(\lambda\rightarrow-\infty\)</span>) or <span class="math inline">\(\theta\)</span> closer to <span class="math inline">\(1\)</span> (as <span class="math inline">\(\lambda\rightarrow\infty\)</span>).</p>
<p><span class="math display">\[
\widehat{\theta}\left(\theta, \lambda\right)=
\theta \cdot
      \left(
      \frac{
        \exp\left(\lambda\right)
      }{
        1 + \theta\cdot\left(\exp\left(\lambda\right) - 1\right)
      }
      \right)
\]</span></p>
<p>Given this function form, when <span class="math inline">\(\lambda=0\)</span>, we are back to <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(0 \le \widehat{\theta}\left(\lambda\right) \le 1\)</span>, which allows <span class="math inline">\(\widehat{\theta}\)</span> to be used as the “chance of success” parameter as we freely vary <span class="math inline">\(\lambda\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\theta}\left(\theta, \lambda=0\right) &amp;=
\theta \cdot \left(\frac{1}{1 + \theta\cdot(1-1)}\right) = \theta \\
\lim_{\lambda \rightarrow -\infty} \widehat{\theta}\left(\theta, \lambda\right) &amp;=
\theta \cdot \left(\frac{0}{1 + \theta\cdot(0-1)}\right) = 0 \\
\lim_{\lambda \rightarrow \infty} \widehat{\theta}\left(\theta, \lambda\right) &amp;=
\theta \cdot \left(\frac{\exp(\lambda)}{\theta \cdot \exp(\lambda)}\right) = 1 \\
\end{aligned}
\]</span></p>
<p>To test this, first, we write out the rescaling function.</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="mathematics.html#cb686-1" tabindex="-1"></a><span class="co"># Construct the formula</span></span>
<span id="cb686-2"><a href="mathematics.html#cb686-2" tabindex="-1"></a>ffi_theta_lambda_0t1 <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, lambda) {</span>
<span id="cb686-3"><a href="mathematics.html#cb686-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.finite</span>(<span class="fu">exp</span>(lambda))) {</span>
<span id="cb686-4"><a href="mathematics.html#cb686-4" tabindex="-1"></a>    theta <span class="sc">*</span> (<span class="fu">exp</span>(lambda) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> theta <span class="sc">*</span> (<span class="fu">exp</span>(lambda) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb686-5"><a href="mathematics.html#cb686-5" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb686-6"><a href="mathematics.html#cb686-6" tabindex="-1"></a>    <span class="co"># If lambda is large, exp(lambda)=inf, ratio above becomes 1</span></span>
<span id="cb686-7"><a href="mathematics.html#cb686-7" tabindex="-1"></a>    <span class="dv">1</span></span>
<span id="cb686-8"><a href="mathematics.html#cb686-8" tabindex="-1"></a>  }</span>
<span id="cb686-9"><a href="mathematics.html#cb686-9" tabindex="-1"></a>}</span>
<span id="cb686-10"><a href="mathematics.html#cb686-10" tabindex="-1"></a><span class="co"># Test the function</span></span>
<span id="cb686-11"><a href="mathematics.html#cb686-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ffi_theta_lambda_0t1</span>(<span class="fl">0.5</span>, <span class="fl">1e1</span>))</span></code></pre></div>
<pre><code>## [1] 0.9999546</code></pre>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="mathematics.html#cb688-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ffi_theta_lambda_0t1</span>(<span class="fl">0.5</span>, <span class="fl">1e2</span>))</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="mathematics.html#cb690-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ffi_theta_lambda_0t1</span>(<span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">1e3</span>))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Second, given theta, we evaluate the function with differing lambda values.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="mathematics.html#cb692-1" tabindex="-1"></a><span class="co"># Create Function</span></span>
<span id="cb692-2"><a href="mathematics.html#cb692-2" tabindex="-1"></a>ffi_fixtheta_varylambda_0t1 <span class="ot">&lt;-</span></span>
<span id="cb692-3"><a href="mathematics.html#cb692-3" tabindex="-1"></a>  <span class="cf">function</span>(<span class="at">ar_lambda_pos =</span></span>
<span id="cb692-4"><a href="mathematics.html#cb692-4" tabindex="-1"></a>             <span class="fl">1e1</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">4</span>)),</span>
<span id="cb692-5"><a href="mathematics.html#cb692-5" tabindex="-1"></a>           <span class="at">theta =</span> <span class="fl">0.5</span>) {</span>
<span id="cb692-6"><a href="mathematics.html#cb692-6" tabindex="-1"></a></span>
<span id="cb692-7"><a href="mathematics.html#cb692-7" tabindex="-1"></a>    <span class="co"># Construct lambda vector</span></span>
<span id="cb692-8"><a href="mathematics.html#cb692-8" tabindex="-1"></a>    ar_lambda <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>((<span class="fu">c</span>(<span class="sc">-</span>ar_lambda_pos, <span class="dv">0</span>, ar_lambda_pos))))</span>
<span id="cb692-9"><a href="mathematics.html#cb692-9" tabindex="-1"></a>    <span class="co"># sapply</span></span>
<span id="cb692-10"><a href="mathematics.html#cb692-10" tabindex="-1"></a>    ar_theta_hat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ar_lambda, ffi_theta_lambda_0t1, <span class="at">theta =</span> theta)</span>
<span id="cb692-11"><a href="mathematics.html#cb692-11" tabindex="-1"></a>    <span class="co"># Create table</span></span>
<span id="cb692-12"><a href="mathematics.html#cb692-12" tabindex="-1"></a>    ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;theta_hat&quot;</span>, <span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb692-13"><a href="mathematics.html#cb692-13" tabindex="-1"></a>    tb_theta_hat_lambda <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(</span>
<span id="cb692-14"><a href="mathematics.html#cb692-14" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="fu">round</span>(ar_theta_hat, <span class="dv">5</span>), ar_lambda)</span>
<span id="cb692-15"><a href="mathematics.html#cb692-15" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb692-16"><a href="mathematics.html#cb692-16" tabindex="-1"></a>      <span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">c</span>(ar_st_varnames)) <span class="sc">%&gt;%</span></span>
<span id="cb692-17"><a href="mathematics.html#cb692-17" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">theta =</span> theta)</span>
<span id="cb692-18"><a href="mathematics.html#cb692-18" tabindex="-1"></a>    <span class="co"># return</span></span>
<span id="cb692-19"><a href="mathematics.html#cb692-19" tabindex="-1"></a>    <span class="fu">return</span>(tb_theta_hat_lambda)</span>
<span id="cb692-20"><a href="mathematics.html#cb692-20" tabindex="-1"></a>  }</span>
<span id="cb692-21"><a href="mathematics.html#cb692-21" tabindex="-1"></a></span>
<span id="cb692-22"><a href="mathematics.html#cb692-22" tabindex="-1"></a><span class="co"># Test function</span></span>
<span id="cb692-23"><a href="mathematics.html#cb692-23" tabindex="-1"></a>tb_theta_hat_lambda <span class="ot">&lt;-</span> <span class="fu">ffi_fixtheta_varylambda_0t1</span>()</span>
<span id="cb692-24"><a href="mathematics.html#cb692-24" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb692-25"><a href="mathematics.html#cb692-25" tabindex="-1"></a><span class="fu">kable</span>(tb_theta_hat_lambda,</span>
<span id="cb692-26"><a href="mathematics.html#cb692-26" tabindex="-1"></a>  <span class="at">caption =</span> <span class="fu">paste</span>(</span>
<span id="cb692-27"><a href="mathematics.html#cb692-27" tabindex="-1"></a>    <span class="st">&quot;Theta-hat rescaling&quot;</span>,</span>
<span id="cb692-28"><a href="mathematics.html#cb692-28" tabindex="-1"></a>    <span class="st">&quot;, given different lambda rescalers.&quot;</span>,</span>
<span id="cb692-29"><a href="mathematics.html#cb692-29" tabindex="-1"></a>    <span class="at">separator =</span> <span class="st">&quot; &quot;</span></span>
<span id="cb692-30"><a href="mathematics.html#cb692-30" tabindex="-1"></a>  )</span>
<span id="cb692-31"><a href="mathematics.html#cb692-31" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-343">Table 8.4: </span>Theta-hat rescaling , given different lambda rescalers.
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
theta_hat
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
theta
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.00005
</td>
<td style="text-align:right;">
-10.0000000
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.01340
</td>
<td style="text-align:right;">
-4.2986623
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.13613
</td>
<td style="text-align:right;">
-1.8478498
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.31124
</td>
<td style="text-align:right;">
-0.7943282
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.68876
</td>
<td style="text-align:right;">
0.7943282
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.86387
</td>
<td style="text-align:right;">
1.8478498
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.98660
</td>
<td style="text-align:right;">
4.2986623
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.99995
</td>
<td style="text-align:right;">
10.0000000
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
<p>Third, we run the function we just created for two three different <span class="math inline">\(\theta\)</span> levels, and we stack the results together.</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="mathematics.html#cb693-1" tabindex="-1"></a><span class="co"># Evaluate at differing thetas</span></span>
<span id="cb693-2"><a href="mathematics.html#cb693-2" tabindex="-1"></a>ar_lambda_pos <span class="ot">&lt;-</span> <span class="fl">1e1</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">2</span>))</span>
<span id="cb693-3"><a href="mathematics.html#cb693-3" tabindex="-1"></a>tb_theta_hat_lambda_low <span class="ot">&lt;-</span> <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.1</span>)</span>
<span id="cb693-4"><a href="mathematics.html#cb693-4" tabindex="-1"></a>tb_theta_hat_lambda_mid <span class="ot">&lt;-</span> <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.5</span>)</span>
<span id="cb693-5"><a href="mathematics.html#cb693-5" tabindex="-1"></a>tb_theta_hat_lambda_hgh <span class="ot">&lt;-</span> <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.9</span>)</span>
<span id="cb693-6"><a href="mathematics.html#cb693-6" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb693-7"><a href="mathematics.html#cb693-7" tabindex="-1"></a>tb_theta_hat_lambda_combo <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb693-8"><a href="mathematics.html#cb693-8" tabindex="-1"></a>  tb_theta_hat_lambda_low,</span>
<span id="cb693-9"><a href="mathematics.html#cb693-9" tabindex="-1"></a>  tb_theta_hat_lambda_mid,</span>
<span id="cb693-10"><a href="mathematics.html#cb693-10" tabindex="-1"></a>  tb_theta_hat_lambda_hgh</span>
<span id="cb693-11"><a href="mathematics.html#cb693-11" tabindex="-1"></a>)</span>
<span id="cb693-12"><a href="mathematics.html#cb693-12" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb693-13"><a href="mathematics.html#cb693-13" tabindex="-1"></a><span class="fu">kable</span>(tb_theta_hat_lambda_combo,</span>
<span id="cb693-14"><a href="mathematics.html#cb693-14" tabindex="-1"></a>  <span class="at">caption =</span> <span class="fu">paste</span>(</span>
<span id="cb693-15"><a href="mathematics.html#cb693-15" tabindex="-1"></a>    <span class="st">&quot;Theta-hat rescaling&quot;</span>,</span>
<span id="cb693-16"><a href="mathematics.html#cb693-16" tabindex="-1"></a>    <span class="st">&quot;, with multiple theta values&quot;</span>,</span>
<span id="cb693-17"><a href="mathematics.html#cb693-17" tabindex="-1"></a>    <span class="st">&quot;, given different lambda rescalers.&quot;</span>,</span>
<span id="cb693-18"><a href="mathematics.html#cb693-18" tabindex="-1"></a>    <span class="at">separator =</span> <span class="st">&quot; &quot;</span></span>
<span id="cb693-19"><a href="mathematics.html#cb693-19" tabindex="-1"></a>  )</span>
<span id="cb693-20"><a href="mathematics.html#cb693-20" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-344">Table 8.5: </span>Theta-hat rescaling , with multiple theta values , given different lambda rescalers.
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
theta_hat
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
theta
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.00001
</td>
<td style="text-align:right;">
-10.0000000
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.04781
</td>
<td style="text-align:right;">
-0.7943282
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.10000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.19736
</td>
<td style="text-align:right;">
0.7943282
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.99959
</td>
<td style="text-align:right;">
10.0000000
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.00005
</td>
<td style="text-align:right;">
-10.0000000
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.31124
</td>
<td style="text-align:right;">
-0.7943282
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.68876
</td>
<td style="text-align:right;">
0.7943282
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.99995
</td>
<td style="text-align:right;">
10.0000000
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.00041
</td>
<td style="text-align:right;">
-10.0000000
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:right;">
0.80264
</td>
<td style="text-align:right;">
-0.7943282
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:right;">
0.90000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:right;">
0.95219
</td>
<td style="text-align:right;">
0.7943282
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:right;">
0.99999
</td>
<td style="text-align:right;">
10.0000000
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
</tbody>
</table>
<p>Fourth, we visualize the results from above. We generate a denser x-grid for this purpose, and we evaluate at 9 different theta values from <span class="math inline">\(\theta=0.01\)</span> to <span class="math inline">\(\theta=0.99\)</span>. We can see in the graph that all <span class="math inline">\(0&lt;\hat{\theta}&lt;1\)</span>.</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="mathematics.html#cb694-1" tabindex="-1"></a><span class="co"># Generate a denser result</span></span>
<span id="cb694-2"><a href="mathematics.html#cb694-2" tabindex="-1"></a>ar_lambda_pos <span class="ot">&lt;-</span> <span class="fl">1e1</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb694-3"><a href="mathematics.html#cb694-3" tabindex="-1"></a>tb_theta_hat_lambda_combo <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb694-4"><a href="mathematics.html#cb694-4" tabindex="-1"></a>  <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.01</span>),</span>
<span id="cb694-5"><a href="mathematics.html#cb694-5" tabindex="-1"></a>  <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.10</span>),</span>
<span id="cb694-6"><a href="mathematics.html#cb694-6" tabindex="-1"></a>  <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.25</span>),</span>
<span id="cb694-7"><a href="mathematics.html#cb694-7" tabindex="-1"></a>  <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.50</span>),</span>
<span id="cb694-8"><a href="mathematics.html#cb694-8" tabindex="-1"></a>  <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.75</span>),</span>
<span id="cb694-9"><a href="mathematics.html#cb694-9" tabindex="-1"></a>  <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.90</span>),</span>
<span id="cb694-10"><a href="mathematics.html#cb694-10" tabindex="-1"></a>  <span class="fu">ffi_fixtheta_varylambda_0t1</span>(ar_lambda_pos, <span class="fl">0.99</span>)</span>
<span id="cb694-11"><a href="mathematics.html#cb694-11" tabindex="-1"></a>)</span>
<span id="cb694-12"><a href="mathematics.html#cb694-12" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb694-13"><a href="mathematics.html#cb694-13" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Rescale a Fraction (theta), Constrained Between 0 and 1&quot;</span>)</span>
<span id="cb694-14"><a href="mathematics.html#cb694-14" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb694-15"><a href="mathematics.html#cb694-15" tabindex="-1"></a>  <span class="st">&quot;Note that when LAMBDA = 0, THETA-HAT = theta.&quot;</span></span>
<span id="cb694-16"><a href="mathematics.html#cb694-16" tabindex="-1"></a>)</span>
<span id="cb694-17"><a href="mathematics.html#cb694-17" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb694-18"><a href="mathematics.html#cb694-18" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb694-19"><a href="mathematics.html#cb694-19" tabindex="-1"></a>  <span class="st">&quot;R4Econ/math/solutions/htmlpdfr/fs_rescale.html&quot;</span></span>
<span id="cb694-20"><a href="mathematics.html#cb694-20" tabindex="-1"></a>)</span>
<span id="cb694-21"><a href="mathematics.html#cb694-21" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&quot;Different rescaling LAMBDA values&quot;</span></span>
<span id="cb694-22"><a href="mathematics.html#cb694-22" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&quot;Rescaled THETA-HAT values between 0 and 1&quot;</span></span>
<span id="cb694-23"><a href="mathematics.html#cb694-23" tabindex="-1"></a>ar_y_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">0.99</span>)</span>
<span id="cb694-24"><a href="mathematics.html#cb694-24" tabindex="-1"></a><span class="co"># Graph</span></span>
<span id="cb694-25"><a href="mathematics.html#cb694-25" tabindex="-1"></a>tb_theta_hat_lambda_combo <span class="sc">%&gt;%</span></span>
<span id="cb694-26"><a href="mathematics.html#cb694-26" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">theta =</span> <span class="fu">as.factor</span>(theta)) <span class="sc">%&gt;%</span></span>
<span id="cb694-27"><a href="mathematics.html#cb694-27" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb694-28"><a href="mathematics.html#cb694-28" tabindex="-1"></a>    <span class="at">x =</span> lambda, <span class="at">y =</span> theta_hat,</span>
<span id="cb694-29"><a href="mathematics.html#cb694-29" tabindex="-1"></a>    <span class="at">color =</span> theta, <span class="at">linetype =</span> theta</span>
<span id="cb694-30"><a href="mathematics.html#cb694-30" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb694-31"><a href="mathematics.html#cb694-31" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb694-32"><a href="mathematics.html#cb694-32" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb694-33"><a href="mathematics.html#cb694-33" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb694-34"><a href="mathematics.html#cb694-34" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb694-35"><a href="mathematics.html#cb694-35" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb694-36"><a href="mathematics.html#cb694-36" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb694-37"><a href="mathematics.html#cb694-37" tabindex="-1"></a>    <span class="at">title =</span> st_title,</span>
<span id="cb694-38"><a href="mathematics.html#cb694-38" tabindex="-1"></a>    <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb694-39"><a href="mathematics.html#cb694-39" tabindex="-1"></a>    <span class="at">x =</span> st_x_label,</span>
<span id="cb694-40"><a href="mathematics.html#cb694-40" tabindex="-1"></a>    <span class="at">y =</span> st_y_label,</span>
<span id="cb694-41"><a href="mathematics.html#cb694-41" tabindex="-1"></a>    <span class="at">caption =</span> st_caption</span>
<span id="cb694-42"><a href="mathematics.html#cb694-42" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb694-43"><a href="mathematics.html#cb694-43" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb694-44"><a href="mathematics.html#cb694-44" tabindex="-1"></a>    <span class="at">breaks =</span> ar_y_breaks,</span>
<span id="cb694-45"><a href="mathematics.html#cb694-45" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb694-46"><a href="mathematics.html#cb694-46" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb694-47"><a href="mathematics.html#cb694-47" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb694-48"><a href="mathematics.html#cb694-48" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(</span>
<span id="cb694-49"><a href="mathematics.html#cb694-49" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb694-50"><a href="mathematics.html#cb694-50" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb694-51"><a href="mathematics.html#cb694-51" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">1</span></span>
<span id="cb694-52"><a href="mathematics.html#cb694-52" tabindex="-1"></a>    ),</span>
<span id="cb694-53"><a href="mathematics.html#cb694-53" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">&quot;line&quot;</span>)</span>
<span id="cb694-54"><a href="mathematics.html#cb694-54" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-345-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="fit-three-points-with-ends-along-45-degree-line" class="section level4 hasAnchor" number="8.1.2.2">
<h4><span class="header-section-number">8.1.2.2</span> Fit Three Points with Ends Along 45 Degree Line<a href="mathematics.html#fit-three-points-with-ends-along-45-degree-line" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given e &lt; x &lt; f, use f(x) to rescale x, such that f(e)=e, f(f)=f, but f(z)=<span class="math inline">\(\alpha \cdot z\)</span> for one particular z between e and f, with <span class="math inline">\(\alpha\)</span> &gt; 1. And in this case, assume that <span class="math inline">\(\alpha \cdot z &lt; f\)</span>. Note that this is case where we have three points, and the starting and the ending points are along the 45 degree line.</p>
<p>We can fit these three points using the Quadratic function exactly. In another word, there is a unique quadratic function that crosses these three points. Note the quadratic function is either concave or convex through the entire domain.</p>
<p>First, as an example, suppose that <span class="math inline">\(e=0\)</span>, <span class="math inline">\(f=10\)</span>, <span class="math inline">\(z=2\)</span>, and <span class="math inline">\(\alpha=1.5\)</span>. Using a quadratic to fit:</p>
<p><span class="math display">\[
y(x) = a \cdot x^2 + b \cdot x + c
\]</span>
We have three equations:
<span class="math display">\[
0 = a \cdot 0 + b \cdot 0 + c\\
2 \cdot 1.5 = a \cdot 2^2 + b \cdot 2 + c\\
10 = a \cdot 10^2 + b \cdot 10 + c
\]</span>
Given these, we have, <span class="math inline">\(c = 0\)</span>, and subsequently, 2 equations and 2 unknowns:
<span class="math display">\[
3 = a \cdot 4 + b \cdot 2\\
10 = a \cdot 100 + b \cdot 10
\]</span></p>
<p>Hence:
<span class="math display">\[
a = \frac{3-2b}{4}\\
10 = \frac{3-2b}{4}\cdot 100 + b \cdot 10\\
10 = 75 - 50b + 10b\\
\]</span>
And finally:
<span class="math display">\[
a = \frac{3-2*1.625}{4}=-0.0625\\
b = \frac{65}{40}=1.625\\
c = 0
\]</span></p>
<p>Generate the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> points above for the quadratic function:</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="mathematics.html#cb695-1" tabindex="-1"></a><span class="co"># set values</span></span>
<span id="cb695-2"><a href="mathematics.html#cb695-2" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb695-3"><a href="mathematics.html#cb695-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb695-4"><a href="mathematics.html#cb695-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb695-5"><a href="mathematics.html#cb695-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb695-6"><a href="mathematics.html#cb695-6" tabindex="-1"></a><span class="co"># apply formulas from above</span></span>
<span id="cb695-7"><a href="mathematics.html#cb695-7" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.0625</span></span>
<span id="cb695-8"><a href="mathematics.html#cb695-8" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.625</span></span>
<span id="cb695-9"><a href="mathematics.html#cb695-9" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb695-10"><a href="mathematics.html#cb695-10" tabindex="-1"></a><span class="co"># grid of values beween a and b, 11 points covering z = 2</span></span>
<span id="cb695-11"><a href="mathematics.html#cb695-11" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(e, f, <span class="at">length.out =</span> <span class="dv">11</span>)</span>
<span id="cb695-12"><a href="mathematics.html#cb695-12" tabindex="-1"></a><span class="co"># rescale</span></span>
<span id="cb695-13"><a href="mathematics.html#cb695-13" tabindex="-1"></a>ar_grid_quad <span class="ot">&lt;-</span> a <span class="sc">*</span> ar_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b <span class="sc">*</span> ar_x <span class="sc">+</span> c</span>
<span id="cb695-14"><a href="mathematics.html#cb695-14" tabindex="-1"></a><span class="co"># show values</span></span>
<span id="cb695-15"><a href="mathematics.html#cb695-15" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">print</span>(<span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_x, ar_grid_quad))),</span>
<span id="cb695-16"><a href="mathematics.html#cb695-16" tabindex="-1"></a>  <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb695-17"><a href="mathematics.html#cb695-17" tabindex="-1"></a>    <span class="st">&quot;Quadratic Fit of Three Equations and Three Unknowns</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb695-18"><a href="mathematics.html#cb695-18" tabindex="-1"></a>    <span class="st">&quot;Satisfies: f(0)=0, f(10)=10, f(2)=3&quot;</span></span>
<span id="cb695-19"><a href="mathematics.html#cb695-19" tabindex="-1"></a>  )</span>
<span id="cb695-20"><a href="mathematics.html#cb695-20" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb695-21"><a href="mathematics.html#cb695-21" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-346">Table 8.6: </span>Quadratic Fit of Three Equations and Three Unknowns
Satisfies: f(0)=0, f(10)=10, f(2)=3
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_grid_quad
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.5625
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.3125
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5.5000
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6.5625
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7.5000
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8.3125
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9.5625
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10.0000
</td>
</tr>
</tbody>
</table>
<p>Second, as another example, suppose that <span class="math inline">\(e=0\)</span>, <span class="math inline">\(f=3.5\)</span>, <span class="math inline">\(z=0.5\)</span>, and <span class="math inline">\(\alpha=1.5\)</span>. Using a quadratic to fit these, we have three equations:</p>
<p><span class="math display">\[
0 = a \cdot 0 + b \cdot 0 + c\\
0.75 = a \cdot 0.5^2 + b \cdot 0.5 + c\\
3.5 = a \cdot 3.5^2 + b \cdot 3.5 + c
\]</span>
Given these, we have, <span class="math inline">\(c = 0\)</span>, and subsequently, 2 equations and 2 unknowns:
<span class="math display">\[
0.75 = a \cdot 0.25 + b \cdot 0.5\\
3.5 = a \cdot 12.25 + b \cdot 3.5
\]</span></p>
<p>Hence:
<span class="math display">\[
a = \frac{0.75-0.5b}{0.25}\\
3.5 = \frac{0.75-0.5b}{0.25}\cdot 12.25 + b \cdot 3.5\\
3.5 = 36.75 - 24.5b + 3.5b\\
\]</span>
And finally:
<span class="math display">\[
a = \frac{0.75-0.5*1.58333}{0.25}=-0.1666\\
b = \frac{36.75-3.5}{24.5-3.5}=1.58333\\
c = 0
\]</span></p>
<p>Generate the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> points above for the quadratic function:</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="mathematics.html#cb696-1" tabindex="-1"></a><span class="co"># set values</span></span>
<span id="cb696-2"><a href="mathematics.html#cb696-2" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb696-3"><a href="mathematics.html#cb696-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb696-4"><a href="mathematics.html#cb696-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb696-5"><a href="mathematics.html#cb696-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb696-6"><a href="mathematics.html#cb696-6" tabindex="-1"></a><span class="co"># apply formulas from above</span></span>
<span id="cb696-7"><a href="mathematics.html#cb696-7" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.16666666</span></span>
<span id="cb696-8"><a href="mathematics.html#cb696-8" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.583333333</span></span>
<span id="cb696-9"><a href="mathematics.html#cb696-9" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb696-10"><a href="mathematics.html#cb696-10" tabindex="-1"></a><span class="co"># grid of values beween a and b, 11 points covering z = 2</span></span>
<span id="cb696-11"><a href="mathematics.html#cb696-11" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(e, f, <span class="at">length.out =</span> <span class="dv">100000</span>)</span>
<span id="cb696-12"><a href="mathematics.html#cb696-12" tabindex="-1"></a><span class="co"># rescale</span></span>
<span id="cb696-13"><a href="mathematics.html#cb696-13" tabindex="-1"></a>ar_grid_quad <span class="ot">&lt;-</span> a <span class="sc">*</span> ar_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> b <span class="sc">*</span> ar_x <span class="sc">+</span> c</span>
<span id="cb696-14"><a href="mathematics.html#cb696-14" tabindex="-1"></a><span class="co"># show values</span></span>
<span id="cb696-15"><a href="mathematics.html#cb696-15" tabindex="-1"></a><span class="co"># cbind(ar_x, ar_grid_quad)</span></span>
<span id="cb696-16"><a href="mathematics.html#cb696-16" tabindex="-1"></a>ar_x[<span class="fu">which.min</span>(<span class="fu">abs</span>(ar_grid_quad <span class="sc">-</span> <span class="fl">0.75</span>))]</span></code></pre></div>
<pre><code>## [1] 0.500015</code></pre>
<p>The exercises above are special cases of the formula we derive on this page: <a href="https://fanwangecon.github.io/R4Econ/math/solutions/htmlpdfr/fs_analytical_poly_fit.html#11_Formulas_for_Quadratic_Parameters_and_Three_Points">Formulas for Quadratic Parameters and Three Points</a>.</p>

</div>
</div>
<div id="log-with-different-bases-and-exponents" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Log with Different Bases and Exponents<a href="mathematics.html#log-with-different-bases-and-exponents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="log-of-bases-that-are-not-10-2-and-e" class="section level4 hasAnchor" number="8.1.3.1">
<h4><span class="header-section-number">8.1.3.1</span> Log of Bases that Are not 10, 2 and e<a href="mathematics.html#log-of-bases-that-are-not-10-2-and-e" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What is <span class="math inline">\(y\)</span> below, with arbitrary base <span class="math inline">\(x\)</span>? It is <span class="math inline">\(y=\frac{\log\left(z\right)}{\log\left(x\right)}\)</span>, because:
<span class="math display">\[
\begin{aligned}
x^y &amp;= z\\
x^{\frac{\log\left(z\right)}{\log\left(x\right)}}&amp;=z\\
\log\left(x^{\frac{\log\left(z\right)}{\log\left(x\right)}}\right)&amp;=\log\left(z\right)\\
\frac{\log\left(z\right)}{\log\left(x\right)}\log\left(x\right)&amp;=\log\left(z\right)\\
\frac{\log\left(z\right)}{\log\left(x\right)}&amp;=\frac{\log\left(z\right)}{\log\left(x\right)}\\
\end{aligned}
\]</span></p>
<p>Given these, we can compute the exponents, <span class="math inline">\(y\)</span>, for non-standard bases, <span class="math inline">\(x\)</span>, given the value for <span class="math inline">\(z\)</span>.</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="mathematics.html#cb698-1" tabindex="-1"></a><span class="co"># base 1.1</span></span>
<span id="cb698-2"><a href="mathematics.html#cb698-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb698-3"><a href="mathematics.html#cb698-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">5.5</span></span>
<span id="cb698-4"><a href="mathematics.html#cb698-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> x<span class="sc">^</span>y</span>
<span id="cb698-5"><a href="mathematics.html#cb698-5" tabindex="-1"></a><span class="co"># given z and knowing x, and what is y?</span></span>
<span id="cb698-6"><a href="mathematics.html#cb698-6" tabindex="-1"></a>y_solved <span class="ot">&lt;-</span> <span class="fu">log</span>(z) <span class="sc">/</span> <span class="fu">log</span>(x)</span>
<span id="cb698-7"><a href="mathematics.html#cb698-7" tabindex="-1"></a><span class="co"># dispaly</span></span>
<span id="cb698-8"><a href="mathematics.html#cb698-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;y_solved=&quot;</span>, y_solved, <span class="st">&quot;, y=&quot;</span>, y))</span></code></pre></div>
<pre><code>## [1] &quot;y_solved=5.5, y=5.5&quot;</code></pre>
</div>
<div id="rescale-bounded-model-parameters-to-unconstrained-with-exponentiation" class="section level4 hasAnchor" number="8.1.3.2">
<h4><span class="header-section-number">8.1.3.2</span> Rescale Bounded Model Parameters to Unconstrained with Exponentiation<a href="mathematics.html#rescale-bounded-model-parameters-to-unconstrained-with-exponentiation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have a parameter to be estimated, the parameter’s values can range between positive 1 and negative infinity. We want to use an estimator that us unconstrained. Use exponentiation to rescale the parameter so that is become unconstrained, use different bases so that the speed at which the parameter value approaches its bounds can be controlled.</p>
<p>While <span class="math inline">\(y\)</span> is not bounded, <span class="math inline">\(f(y;x)\)</span> is bounded:
<span class="math display">\[
\begin{aligned}
&amp;f(y; x) = 1 - x^{y}\\
&amp;\text{where } x &gt;1 \text{ and }  -\infty &lt; y &lt; \infty\\
&amp;\text{then, } 1 &gt; f(y; x) &gt; -\infty
\end{aligned}
\]</span></p>
<p>With <span class="math inline">\(x&gt;1\)</span>, as <span class="math inline">\(y\)</span> increases <span class="math inline">\(f(y;x)\)</span> decreases:
<span class="math display">\[
\frac{d f(y; x)}{dy} = - x^{y}\log(x) &lt; 0 \text{ when } x &gt; 1
\]</span></p>
<p><span class="math inline">\(x\)</span> controls the speed at which <span class="math inline">\(f(y)\)</span> approaches its bounds. In the simulation below, we try a number of different bases, at higher bases (2, e=2.71, 10), as <span class="math inline">\(y\)</span> value changes <span class="math inline">\(f(y)\)</span> shifts too quickly to the bounds. But a base value of <span class="math inline">\(x=1.03\)</span> or <span class="math inline">\(x=1.04\)</span> would work well in an unbounded estimation routine that still generates parameters within bounds, which is below 1 in the case here.</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="mathematics.html#cb700-1" tabindex="-1"></a><span class="co"># Vector of unbounded values, high and low</span></span>
<span id="cb700-2"><a href="mathematics.html#cb700-2" tabindex="-1"></a>ar_y_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb700-3"><a href="mathematics.html#cb700-3" tabindex="-1"></a><span class="co"># Different base values</span></span>
<span id="cb700-4"><a href="mathematics.html#cb700-4" tabindex="-1"></a>ar_bases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.01</span>, <span class="fl">1.02</span>, <span class="fl">1.03</span>, <span class="fl">1.04</span>, <span class="fl">1.1</span>, <span class="dv">2</span>, <span class="fl">2.71</span>, <span class="dv">10</span>)</span>
<span id="cb700-5"><a href="mathematics.html#cb700-5" tabindex="-1"></a><span class="co"># Transform back to f(y) scale with different bases</span></span>
<span id="cb700-6"><a href="mathematics.html#cb700-6" tabindex="-1"></a>mt_f_of_y_vary_x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,</span>
<span id="cb700-7"><a href="mathematics.html#cb700-7" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">length</span>(ar_y_vals),</span>
<span id="cb700-8"><a href="mathematics.html#cb700-8" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">length</span>(ar_bases)</span>
<span id="cb700-9"><a href="mathematics.html#cb700-9" tabindex="-1"></a>)</span>
<span id="cb700-10"><a href="mathematics.html#cb700-10" tabindex="-1"></a>ar_st_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;yvalidx&quot;</span>, <span class="st">&quot;y_vals&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;base&quot;</span>, ar_bases))</span>
<span id="cb700-11"><a href="mathematics.html#cb700-11" tabindex="-1"></a>mt_f_of_y_vary_x[, <span class="dv">1</span>] <span class="ot">&lt;-</span> ar_y_vals</span>
<span id="cb700-12"><a href="mathematics.html#cb700-12" tabindex="-1"></a><span class="cf">for</span> (it_base <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_bases))) {</span>
<span id="cb700-13"><a href="mathematics.html#cb700-13" tabindex="-1"></a>  fl_base <span class="ot">&lt;-</span> ar_bases[it_base]</span>
<span id="cb700-14"><a href="mathematics.html#cb700-14" tabindex="-1"></a>  ar_f_y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> fl_base<span class="sc">^</span>ar_y_vals</span>
<span id="cb700-15"><a href="mathematics.html#cb700-15" tabindex="-1"></a>  mt_f_of_y_vary_x[, <span class="dv">1</span> <span class="sc">+</span> it_base] <span class="ot">&lt;-</span> ar_f_y</span>
<span id="cb700-16"><a href="mathematics.html#cb700-16" tabindex="-1"></a>}</span>
<span id="cb700-17"><a href="mathematics.html#cb700-17" tabindex="-1"></a><span class="co"># To tibble</span></span>
<span id="cb700-18"><a href="mathematics.html#cb700-18" tabindex="-1"></a>tb_f_of_y_vary_x <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_f_of_y_vary_x) <span class="sc">%&gt;%</span></span>
<span id="cb700-19"><a href="mathematics.html#cb700-19" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb700-20"><a href="mathematics.html#cb700-20" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">c</span>(ar_st_varnames))</span>
<span id="cb700-21"><a href="mathematics.html#cb700-21" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb700-22"><a href="mathematics.html#cb700-22" tabindex="-1"></a><span class="fu">kable</span>(tb_f_of_y_vary_x) <span class="sc">%&gt;%</span> <span class="fu">kable_styling_fc_wide</span>()</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:875px; ">
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
yvalidx
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
y_vals
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.01
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.02
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.03
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.04
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base1.1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base2.71
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
base10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-39.332343
</td>
<td style="text-align:right;">
0.3238699
</td>
<td style="text-align:right;">
0.5410820
</td>
<td style="text-align:right;">
0.6873331
</td>
<td style="text-align:right;">
0.7861847
</td>
<td style="text-align:right;">
0.9764534
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-33.733866
</td>
<td style="text-align:right;">
0.2851361
</td>
<td style="text-align:right;">
0.4872768
</td>
<td style="text-align:right;">
0.6310642
</td>
<td style="text-align:right;">
0.7336826
</td>
<td style="text-align:right;">
0.9598519
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-25.301225
</td>
<td style="text-align:right;">
0.2225652
</td>
<td style="text-align:right;">
0.3940942
</td>
<td style="text-align:right;">
0.5266281
</td>
<td style="text-align:right;">
0.6292888
</td>
<td style="text-align:right;">
0.9103161
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-21.356474
</td>
<td style="text-align:right;">
0.1914429
</td>
<td style="text-align:right;">
0.3448652
</td>
<td style="text-align:right;">
0.4680851
</td>
<td style="text-align:right;">
0.5672591
</td>
<td style="text-align:right;">
0.8693835
</td>
<td style="text-align:right;">
9.999996e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-20.520089
</td>
<td style="text-align:right;">
0.1846858
</td>
<td style="text-align:right;">
0.3339241
</td>
<td style="text-align:right;">
0.4547709
</td>
<td style="text-align:right;">
0.5528282
</td>
<td style="text-align:right;">
0.8585450
</td>
<td style="text-align:right;">
9.999993e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-14.577825
</td>
<td style="text-align:right;">
0.1350246
</td>
<td style="text-align:right;">
0.2507475
</td>
<td style="text-align:right;">
0.3500781
</td>
<td style="text-align:right;">
0.4354649
</td>
<td style="text-align:right;">
0.7507790
</td>
<td style="text-align:right;">
9.999591e-01
</td>
<td style="text-align:right;">
9.999995e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-13.737057
</td>
<td style="text-align:right;">
0.1277579
</td>
<td style="text-align:right;">
0.2381685
</td>
<td style="text-align:right;">
0.3337238
</td>
<td style="text-align:right;">
0.4165387
</td>
<td style="text-align:right;">
0.7299860
</td>
<td style="text-align:right;">
9.999268e-01
</td>
<td style="text-align:right;">
9.999989e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-12.500785
</td>
<td style="text-align:right;">
0.1169619
</td>
<td style="text-align:right;">
0.2192876
</td>
<td style="text-align:right;">
0.3089259
</td>
<td style="text-align:right;">
0.3875511
</td>
<td style="text-align:right;">
0.6962202
</td>
<td style="text-align:right;">
9.998275e-01
</td>
<td style="text-align:right;">
9.999961e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
-11.116823
</td>
<td style="text-align:right;">
0.1047176
</td>
<td style="text-align:right;">
0.1975954
</td>
<td style="text-align:right;">
0.2800690
</td>
<td style="text-align:right;">
0.3533886
</td>
<td style="text-align:right;">
0.6533870
</td>
<td style="text-align:right;">
9.995497e-01
</td>
<td style="text-align:right;">
9.999846e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-9.455828
</td>
<td style="text-align:right;">
0.0897979
</td>
<td style="text-align:right;">
0.1707638
</td>
<td style="text-align:right;">
0.2438405
</td>
<td style="text-align:right;">
0.3098624
</td>
<td style="text-align:right;">
0.5939328
</td>
<td style="text-align:right;">
9.985760e-01
</td>
<td style="text-align:right;">
9.999195e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
-8.913239
</td>
<td style="text-align:right;">
0.0848705
</td>
<td style="text-align:right;">
0.1618059
</td>
<td style="text-align:right;">
0.2316152
</td>
<td style="text-align:right;">
0.2950184
</td>
<td style="text-align:right;">
0.5723809
</td>
<td style="text-align:right;">
9.979258e-01
</td>
<td style="text-align:right;">
9.998617e-01
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
-4.359498
</td>
<td style="text-align:right;">
0.0424511
</td>
<td style="text-align:right;">
0.0827081
</td>
<td style="text-align:right;">
0.1209043
</td>
<td style="text-align:right;">
0.1571638
</td>
<td style="text-align:right;">
0.3399928
</td>
<td style="text-align:right;">
9.512853e-01
</td>
<td style="text-align:right;">
9.870440e-01
</td>
<td style="text-align:right;">
9.999563e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2.213654
</td>
<td style="text-align:right;">
-0.0222710
</td>
<td style="text-align:right;">
-0.0448112
</td>
<td style="text-align:right;">
-0.0676212
</td>
<td style="text-align:right;">
-0.0907015
</td>
<td style="text-align:right;">
-0.2348923
</td>
<td style="text-align:right;">
-3.638487e+00
</td>
<td style="text-align:right;">
-8.087498e+00
</td>
<td style="text-align:right;">
-1.625514e+02
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
7.196276
</td>
<td style="text-align:right;">
-0.0742313
</td>
<td style="text-align:right;">
-0.1531591
</td>
<td style="text-align:right;">
-0.2370300
</td>
<td style="text-align:right;">
-0.3261011
</td>
<td style="text-align:right;">
-0.9855152
</td>
<td style="text-align:right;">
-1.456544e+02
</td>
<td style="text-align:right;">
-1.304470e+03
</td>
<td style="text-align:right;">
-1.571363e+07
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
8.015429
</td>
<td style="text-align:right;">
-0.0830230
</td>
<td style="text-align:right;">
-0.1720174
</td>
<td style="text-align:right;">
-0.2673479
</td>
<td style="text-align:right;">
-0.3693975
</td>
<td style="text-align:right;">
-1.1467434
</td>
<td style="text-align:right;">
-2.577525e+02
</td>
<td style="text-align:right;">
-2.953164e+03
</td>
<td style="text-align:right;">
-1.036165e+08
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
9.218324
</td>
<td style="text-align:right;">
-0.0960638
</td>
<td style="text-align:right;">
-0.2002706
</td>
<td style="text-align:right;">
-0.3132206
</td>
<td style="text-align:right;">
-0.4355517
</td>
<td style="text-align:right;">
-1.4075271
</td>
<td style="text-align:right;">
-5.946513e+02
</td>
<td style="text-align:right;">
-9.799568e+03
</td>
<td style="text-align:right;">
-1.653195e+09
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
9.957010
</td>
<td style="text-align:right;">
-0.1041497
</td>
<td style="text-align:right;">
-0.2179571
</td>
<td style="text-align:right;">
-0.3422097
</td>
<td style="text-align:right;">
-0.4777505
</td>
<td style="text-align:right;">
-1.5831365
</td>
<td style="text-align:right;">
-9.929363e+02
</td>
<td style="text-align:right;">
-2.046719e+04
</td>
<td style="text-align:right;">
-9.057525e+09
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14.027118
</td>
<td style="text-align:right;">
-0.1497844
</td>
<td style="text-align:right;">
-0.3201875
</td>
<td style="text-align:right;">
-0.5138027
</td>
<td style="text-align:right;">
-0.7335192
</td>
<td style="text-align:right;">
-2.8073261
</td>
<td style="text-align:right;">
-1.669388e+04
</td>
<td style="text-align:right;">
-1.183889e+06
</td>
<td style="text-align:right;">
-1.064432e+14
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
24.481636
</td>
<td style="text-align:right;">
-0.2758344
</td>
<td style="text-align:right;">
-0.6238514
</td>
<td style="text-align:right;">
-1.0619411
</td>
<td style="text-align:right;">
-1.6121855
</td>
<td style="text-align:right;">
-9.3124213
</td>
<td style="text-align:right;">
-2.342646e+07
</td>
<td style="text-align:right;">
-3.979207e+10
</td>
<td style="text-align:right;">
-3.031349e+24
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
35.738263
</td>
<td style="text-align:right;">
-0.4270474
</td>
<td style="text-align:right;">
-1.0293418
</td>
<td style="text-align:right;">
-1.8759419
</td>
<td style="text-align:right;">
-3.0620190
</td>
<td style="text-align:right;">
-29.1510650
</td>
<td style="text-align:right;">
-5.731774e+10
</td>
<td style="text-align:right;">
-2.975571e+15
</td>
<td style="text-align:right;">
-5.473470e+35
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="positive-exponents" class="section level4 hasAnchor" number="8.1.3.3">
<h4><span class="header-section-number">8.1.3.3</span> Positive Exponents<a href="mathematics.html#positive-exponents" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define exponents to consider and x-values to consider.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="mathematics.html#cb701-1" tabindex="-1"></a><span class="co"># positive value exponents</span></span>
<span id="cb701-2"><a href="mathematics.html#cb701-2" tabindex="-1"></a>ar_exponents_posv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>)</span>
<span id="cb701-3"><a href="mathematics.html#cb701-3" tabindex="-1"></a><span class="co"># positive and negative values of the base</span></span>
<span id="cb701-4"><a href="mathematics.html#cb701-4" tabindex="-1"></a>ar_baseval_pos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-10</span>, <span class="fl">1.5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb701-5"><a href="mathematics.html#cb701-5" tabindex="-1"></a><span class="co"># base to power</span></span>
<span id="cb701-6"><a href="mathematics.html#cb701-6" tabindex="-1"></a>mt_x2a_val <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(ar_exponents_posv), <span class="at">ncol =</span> <span class="fu">length</span>(ar_baseval_pos))</span>
<span id="cb701-7"><a href="mathematics.html#cb701-7" tabindex="-1"></a><span class="co"># Generate values</span></span>
<span id="cb701-8"><a href="mathematics.html#cb701-8" tabindex="-1"></a>it_row_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb701-9"><a href="mathematics.html#cb701-9" tabindex="-1"></a><span class="cf">for</span> (fl_exponents_posv <span class="cf">in</span> ar_exponents_posv) {</span>
<span id="cb701-10"><a href="mathematics.html#cb701-10" tabindex="-1"></a>  it_row_ctr <span class="ot">&lt;-</span> it_row_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb701-11"><a href="mathematics.html#cb701-11" tabindex="-1"></a>  mt_x2a_val[it_row_ctr, ] <span class="ot">&lt;-</span> ar_baseval_pos<span class="sc">^</span>fl_exponents_posv</span>
<span id="cb701-12"><a href="mathematics.html#cb701-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that the smaller exponents functions are higher when <span class="math inline">\(x&lt;1\)</span>, but lower when <span class="math inline">\(x&gt;1\)</span>.
<span class="math display">\[\text{if } b &gt; a &gt; 0 \text{, then, } \left(x^a - x^b\right) &gt; 0 \text{, for all } 1 &gt; x &gt;0\]</span>
<span class="math display">\[\text{if } b &gt; a &gt; 0 \text{, then, } \left(x^a - x^b\right) &lt; 0 \text{, for all } x &gt; 1\]</span>
Note we also have: <span class="math inline">\(\lim_{a\rightarrow 0} x^a = 1\)</span> and <span class="math inline">\(\lim_{a\rightarrow 1} x^a = x\)</span> bounds. When <span class="math inline">\(a&gt;1\)</span>, function becomes convex.</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="mathematics.html#cb702-1" tabindex="-1"></a><span class="co"># x and bounds</span></span>
<span id="cb702-2"><a href="mathematics.html#cb702-2" tabindex="-1"></a>ar_xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(ar_baseval_pos), <span class="fu">max</span>(ar_baseval_pos))</span>
<span id="cb702-3"><a href="mathematics.html#cb702-3" tabindex="-1"></a>ar_ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb702-4"><a href="mathematics.html#cb702-4" tabindex="-1"></a><span class="co"># function line</span></span>
<span id="cb702-5"><a href="mathematics.html#cb702-5" tabindex="-1"></a>st_line_1_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">1</span>])</span>
<span id="cb702-6"><a href="mathematics.html#cb702-6" tabindex="-1"></a>st_line_2_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">2</span>])</span>
<span id="cb702-7"><a href="mathematics.html#cb702-7" tabindex="-1"></a>st_line_3_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">3</span>])</span>
<span id="cb702-8"><a href="mathematics.html#cb702-8" tabindex="-1"></a>st_line_4_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">4</span>])</span>
<span id="cb702-9"><a href="mathematics.html#cb702-9" tabindex="-1"></a><span class="co"># Color and line</span></span>
<span id="cb702-10"><a href="mathematics.html#cb702-10" tabindex="-1"></a>st_point_1_pch <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb702-11"><a href="mathematics.html#cb702-11" tabindex="-1"></a>st_point_1_cex <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb702-12"><a href="mathematics.html#cb702-12" tabindex="-1"></a>ar_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb702-13"><a href="mathematics.html#cb702-13" tabindex="-1"></a>ar_ltys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;dotdash&quot;</span>)</span>
<span id="cb702-14"><a href="mathematics.html#cb702-14" tabindex="-1"></a><span class="co"># Graph and combine</span></span>
<span id="cb702-15"><a href="mathematics.html#cb702-15" tabindex="-1"></a><span class="cf">for</span> (it_graph <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)) {</span>
<span id="cb702-16"><a href="mathematics.html#cb702-16" tabindex="-1"></a>  <span class="cf">if</span> (it_graph <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb702-17"><a href="mathematics.html#cb702-17" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb702-18"><a href="mathematics.html#cb702-18" tabindex="-1"></a>  }</span>
<span id="cb702-19"><a href="mathematics.html#cb702-19" tabindex="-1"></a>  ar_y_current <span class="ot">&lt;-</span> mt_x2a_val[it_graph, ]</span>
<span id="cb702-20"><a href="mathematics.html#cb702-20" tabindex="-1"></a>  <span class="fu">plot</span>(ar_baseval_pos, ar_y_current,</span>
<span id="cb702-21"><a href="mathematics.html#cb702-21" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb702-22"><a href="mathematics.html#cb702-22" tabindex="-1"></a>    <span class="at">col =</span> ar_colors[it_graph], <span class="at">lty =</span> ar_ltys[it_graph],</span>
<span id="cb702-23"><a href="mathematics.html#cb702-23" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">10</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim, <span class="at">panel.first =</span> <span class="fu">grid</span>(),</span>
<span id="cb702-24"><a href="mathematics.html#cb702-24" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ann =</span> <span class="cn">FALSE</span></span>
<span id="cb702-25"><a href="mathematics.html#cb702-25" tabindex="-1"></a>  )</span>
<span id="cb702-26"><a href="mathematics.html#cb702-26" tabindex="-1"></a>  plot_line <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb702-27"><a href="mathematics.html#cb702-27" tabindex="-1"></a>}</span>
<span id="cb702-28"><a href="mathematics.html#cb702-28" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb702-29"><a href="mathematics.html#cb702-29" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb702-30"><a href="mathematics.html#cb702-30" tabindex="-1"></a>fl_ces_fig_small <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb702-31"><a href="mathematics.html#cb702-31" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb702-32"><a href="mathematics.html#cb702-32" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Positive Exponential Graphing&quot;</span>)</span>
<span id="cb702-33"><a href="mathematics.html#cb702-33" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb702-34"><a href="mathematics.html#cb702-34" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb702-35"><a href="mathematics.html#cb702-35" tabindex="-1"></a>  <span class="st">&quot;R4Econ/math/solutions/htmlpdfr/fs_inequality.html&quot;</span></span>
<span id="cb702-36"><a href="mathematics.html#cb702-36" tabindex="-1"></a>)</span>
<span id="cb702-37"><a href="mathematics.html#cb702-37" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&quot;x&quot;</span></span>
<span id="cb702-38"><a href="mathematics.html#cb702-38" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&quot;x^exponent&quot;</span></span>
<span id="cb702-39"><a href="mathematics.html#cb702-39" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb702-40"><a href="mathematics.html#cb702-40" tabindex="-1"></a>  <span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb702-41"><a href="mathematics.html#cb702-41" tabindex="-1"></a>  <span class="at">cex.lab =</span> fl_ces_fig_reg,</span>
<span id="cb702-42"><a href="mathematics.html#cb702-42" tabindex="-1"></a>  <span class="at">cex.main =</span> fl_ces_fig_reg,</span>
<span id="cb702-43"><a href="mathematics.html#cb702-43" tabindex="-1"></a>  <span class="at">cex.sub =</span> fl_ces_fig_small</span>
<span id="cb702-44"><a href="mathematics.html#cb702-44" tabindex="-1"></a>)</span>
<span id="cb702-45"><a href="mathematics.html#cb702-45" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb702-46"><a href="mathematics.html#cb702-46" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb702-47"><a href="mathematics.html#cb702-47" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb702-48"><a href="mathematics.html#cb702-48" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb702-49"><a href="mathematics.html#cb702-49" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb702-50"><a href="mathematics.html#cb702-50" tabindex="-1"></a>  <span class="at">inset =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb702-51"><a href="mathematics.html#cb702-51" tabindex="-1"></a>  <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb702-52"><a href="mathematics.html#cb702-52" tabindex="-1"></a>  <span class="fu">c</span>(st_line_1_y_legend, st_line_2_y_legend, st_line_3_y_legend, st_line_4_y_legend),</span>
<span id="cb702-53"><a href="mathematics.html#cb702-53" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(ar_colors[<span class="dv">1</span>], ar_colors[<span class="dv">2</span>], ar_colors[<span class="dv">3</span>], ar_colors[<span class="dv">4</span>]),</span>
<span id="cb702-54"><a href="mathematics.html#cb702-54" tabindex="-1"></a>  <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb702-55"><a href="mathematics.html#cb702-55" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(ar_ltys[<span class="dv">1</span>], ar_ltys[<span class="dv">2</span>], ar_ltys[<span class="dv">3</span>], ar_ltys[<span class="dv">4</span>]),</span>
<span id="cb702-56"><a href="mathematics.html#cb702-56" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Legends&quot;</span>,</span>
<span id="cb702-57"><a href="mathematics.html#cb702-57" tabindex="-1"></a>  <span class="at">y.intersp =</span> <span class="dv">2</span></span>
<span id="cb702-58"><a href="mathematics.html#cb702-58" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-352-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="negative-exponents" class="section level4 hasAnchor" number="8.1.3.4">
<h4><span class="header-section-number">8.1.3.4</span> Negative Exponents<a href="mathematics.html#negative-exponents" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similar to above, but now with negative exonents.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="mathematics.html#cb703-1" tabindex="-1"></a><span class="co"># positive value exponents</span></span>
<span id="cb703-2"><a href="mathematics.html#cb703-2" tabindex="-1"></a>ar_exponents_posv <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>)</span>
<span id="cb703-3"><a href="mathematics.html#cb703-3" tabindex="-1"></a><span class="co"># positive and negative values of the base</span></span>
<span id="cb703-4"><a href="mathematics.html#cb703-4" tabindex="-1"></a>ar_baseval_pos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-10</span>, <span class="fl">1.5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb703-5"><a href="mathematics.html#cb703-5" tabindex="-1"></a><span class="co"># base to power</span></span>
<span id="cb703-6"><a href="mathematics.html#cb703-6" tabindex="-1"></a>mt_x2a_val <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(ar_exponents_posv), <span class="at">ncol =</span> <span class="fu">length</span>(ar_baseval_pos))</span>
<span id="cb703-7"><a href="mathematics.html#cb703-7" tabindex="-1"></a><span class="co"># Generate values</span></span>
<span id="cb703-8"><a href="mathematics.html#cb703-8" tabindex="-1"></a>it_row_ctr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb703-9"><a href="mathematics.html#cb703-9" tabindex="-1"></a><span class="cf">for</span> (fl_exponents_posv <span class="cf">in</span> ar_exponents_posv) {</span>
<span id="cb703-10"><a href="mathematics.html#cb703-10" tabindex="-1"></a>  it_row_ctr <span class="ot">&lt;-</span> it_row_ctr <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb703-11"><a href="mathematics.html#cb703-11" tabindex="-1"></a>  mt_x2a_val[it_row_ctr, ] <span class="ot">&lt;-</span> ar_baseval_pos<span class="sc">^</span>fl_exponents_posv</span>
<span id="cb703-12"><a href="mathematics.html#cb703-12" tabindex="-1"></a>}</span></code></pre></div>
<p>For positive exponents, when <span class="math inline">\(x&lt;1\)</span>, <span class="math inline">\(x^a&lt;1\)</span>, when <span class="math inline">\(x&gt;1\)</span>, <span class="math inline">\(x^a&gt;1\)</span>. For negative exponents, when <span class="math inline">\(x&lt;1\)</span>, <span class="math inline">\(x^a&gt;1\)</span>, and when <span class="math inline">\(x&gt;1\)</span>, <span class="math inline">\(x^a&lt;1\)</span>. Large positive exponents generate small values when <span class="math inline">\(x&lt;1\)</span>, and large negative exponents generate very large values when <span class="math inline">\(x&lt;1\)</span>.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="mathematics.html#cb704-1" tabindex="-1"></a><span class="co"># x and bounds</span></span>
<span id="cb704-2"><a href="mathematics.html#cb704-2" tabindex="-1"></a>ar_xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(ar_baseval_pos), <span class="fu">max</span>(ar_baseval_pos))</span>
<span id="cb704-3"><a href="mathematics.html#cb704-3" tabindex="-1"></a>ar_ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb704-4"><a href="mathematics.html#cb704-4" tabindex="-1"></a><span class="co"># function line</span></span>
<span id="cb704-5"><a href="mathematics.html#cb704-5" tabindex="-1"></a>st_line_1_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">1</span>])</span>
<span id="cb704-6"><a href="mathematics.html#cb704-6" tabindex="-1"></a>st_line_2_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">2</span>])</span>
<span id="cb704-7"><a href="mathematics.html#cb704-7" tabindex="-1"></a>st_line_3_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">3</span>])</span>
<span id="cb704-8"><a href="mathematics.html#cb704-8" tabindex="-1"></a>st_line_4_y_legend <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x^&quot;</span>, ar_exponents_posv[<span class="dv">4</span>])</span>
<span id="cb704-9"><a href="mathematics.html#cb704-9" tabindex="-1"></a><span class="co"># Color and line</span></span>
<span id="cb704-10"><a href="mathematics.html#cb704-10" tabindex="-1"></a>st_point_1_pch <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb704-11"><a href="mathematics.html#cb704-11" tabindex="-1"></a>st_point_1_cex <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb704-12"><a href="mathematics.html#cb704-12" tabindex="-1"></a>ar_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb704-13"><a href="mathematics.html#cb704-13" tabindex="-1"></a>ar_ltys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;dotdash&quot;</span>)</span>
<span id="cb704-14"><a href="mathematics.html#cb704-14" tabindex="-1"></a><span class="co"># Graph and combine</span></span>
<span id="cb704-15"><a href="mathematics.html#cb704-15" tabindex="-1"></a><span class="cf">for</span> (it_graph <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)) {</span>
<span id="cb704-16"><a href="mathematics.html#cb704-16" tabindex="-1"></a>  <span class="cf">if</span> (it_graph <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb704-17"><a href="mathematics.html#cb704-17" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb704-18"><a href="mathematics.html#cb704-18" tabindex="-1"></a>  }</span>
<span id="cb704-19"><a href="mathematics.html#cb704-19" tabindex="-1"></a>  ar_y_current <span class="ot">&lt;-</span> mt_x2a_val[it_graph, ]</span>
<span id="cb704-20"><a href="mathematics.html#cb704-20" tabindex="-1"></a>  <span class="fu">plot</span>(ar_baseval_pos, ar_y_current,</span>
<span id="cb704-21"><a href="mathematics.html#cb704-21" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb704-22"><a href="mathematics.html#cb704-22" tabindex="-1"></a>    <span class="at">col =</span> ar_colors[it_graph], <span class="at">lty =</span> ar_ltys[it_graph],</span>
<span id="cb704-23"><a href="mathematics.html#cb704-23" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">10</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">xlim =</span> ar_xlim, <span class="at">ylim =</span> ar_ylim, <span class="at">panel.first =</span> <span class="fu">grid</span>(),</span>
<span id="cb704-24"><a href="mathematics.html#cb704-24" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ann =</span> <span class="cn">FALSE</span></span>
<span id="cb704-25"><a href="mathematics.html#cb704-25" tabindex="-1"></a>  )</span>
<span id="cb704-26"><a href="mathematics.html#cb704-26" tabindex="-1"></a>  plot_line <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb704-27"><a href="mathematics.html#cb704-27" tabindex="-1"></a>}</span>
<span id="cb704-28"><a href="mathematics.html#cb704-28" tabindex="-1"></a><span class="co"># CEX sizing Contorl Titling and Legend Sizes</span></span>
<span id="cb704-29"><a href="mathematics.html#cb704-29" tabindex="-1"></a>fl_ces_fig_reg <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb704-30"><a href="mathematics.html#cb704-30" tabindex="-1"></a>fl_ces_fig_small <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb704-31"><a href="mathematics.html#cb704-31" tabindex="-1"></a><span class="co"># R Legend</span></span>
<span id="cb704-32"><a href="mathematics.html#cb704-32" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Negative Exponential Graphing&quot;</span>)</span>
<span id="cb704-33"><a href="mathematics.html#cb704-33" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb704-34"><a href="mathematics.html#cb704-34" tabindex="-1"></a>  <span class="st">&quot;https://fanwangecon.github.io/&quot;</span>,</span>
<span id="cb704-35"><a href="mathematics.html#cb704-35" tabindex="-1"></a>  <span class="st">&quot;R4Econ/math/solutions/htmlpdfr/fs_inequality.html&quot;</span></span>
<span id="cb704-36"><a href="mathematics.html#cb704-36" tabindex="-1"></a>)</span>
<span id="cb704-37"><a href="mathematics.html#cb704-37" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&quot;x&quot;</span></span>
<span id="cb704-38"><a href="mathematics.html#cb704-38" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&quot;x^exponent&quot;</span></span>
<span id="cb704-39"><a href="mathematics.html#cb704-39" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb704-40"><a href="mathematics.html#cb704-40" tabindex="-1"></a>  <span class="at">main =</span> st_title, <span class="at">sub =</span> st_subtitle, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb704-41"><a href="mathematics.html#cb704-41" tabindex="-1"></a>  <span class="at">cex.lab =</span> fl_ces_fig_reg,</span>
<span id="cb704-42"><a href="mathematics.html#cb704-42" tabindex="-1"></a>  <span class="at">cex.main =</span> fl_ces_fig_reg,</span>
<span id="cb704-43"><a href="mathematics.html#cb704-43" tabindex="-1"></a>  <span class="at">cex.sub =</span> fl_ces_fig_small</span>
<span id="cb704-44"><a href="mathematics.html#cb704-44" tabindex="-1"></a>)</span>
<span id="cb704-45"><a href="mathematics.html#cb704-45" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb704-46"><a href="mathematics.html#cb704-46" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">cex.axis =</span> fl_ces_fig_reg)</span>
<span id="cb704-47"><a href="mathematics.html#cb704-47" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb704-48"><a href="mathematics.html#cb704-48" tabindex="-1"></a><span class="co"># Legend sizing CEX</span></span>
<span id="cb704-49"><a href="mathematics.html#cb704-49" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb704-50"><a href="mathematics.html#cb704-50" tabindex="-1"></a>  <span class="at">inset =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb704-51"><a href="mathematics.html#cb704-51" tabindex="-1"></a>  <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb704-52"><a href="mathematics.html#cb704-52" tabindex="-1"></a>  <span class="fu">c</span>(st_line_1_y_legend, st_line_2_y_legend, st_line_3_y_legend, st_line_4_y_legend),</span>
<span id="cb704-53"><a href="mathematics.html#cb704-53" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(ar_colors[<span class="dv">1</span>], ar_colors[<span class="dv">2</span>], ar_colors[<span class="dv">3</span>], ar_colors[<span class="dv">4</span>]),</span>
<span id="cb704-54"><a href="mathematics.html#cb704-54" tabindex="-1"></a>  <span class="at">cex =</span> fl_ces_fig_small,</span>
<span id="cb704-55"><a href="mathematics.html#cb704-55" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(ar_ltys[<span class="dv">1</span>], ar_ltys[<span class="dv">2</span>], ar_ltys[<span class="dv">3</span>], ar_ltys[<span class="dv">4</span>]),</span>
<span id="cb704-56"><a href="mathematics.html#cb704-56" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Legends&quot;</span>,</span>
<span id="cb704-57"><a href="mathematics.html#cb704-57" tabindex="-1"></a>  <span class="at">y.intersp =</span> <span class="dv">2</span></span>
<span id="cb704-58"><a href="mathematics.html#cb704-58" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-354-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="inequality-and-exponents" class="section level4 hasAnchor" number="8.1.3.5">
<h4><span class="header-section-number">8.1.3.5</span> Inequality and Exponents<a href="mathematics.html#inequality-and-exponents" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose we have the inequality <span class="math inline">\(0 &lt; a &lt; b\)</span>, if we apply positive exponents to them, the direction of the inequality will stay the same: If <span class="math inline">\(0 &lt; a &lt; b\)</span>, then <span class="math inline">\(0 &lt; a^{ \mid \alpha\mid} &lt; b^{ \mid \alpha\mid}\)</span> if <span class="math inline">\(\alpha &lt; 0\)</span>. Think about the graphs above, think of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> as points along the x-axis, note that positive exponents are strictly increasing (although some concavely and some convexly) along the x-axis. Comparing <span class="math inline">\(x^\alpha\)</span> at <span class="math inline">\(0&lt;b&lt;a\)</span> anywhere along the x-axis has still has <span class="math inline">\(b^\alpha&lt;a^\alpha\)</span>.</p>
<p>In contrast, if <span class="math inline">\(0 &lt; a &lt; b\)</span>, then <span class="math inline">\(a^{- \mid \alpha\mid} &gt; b^{- \mid \alpha\mid} &gt; 0\)</span> if <span class="math inline">\(\alpha &lt; 0\)</span>. Sign flips. Visually from above, the sign-flipping happens because negative exponential is strictly decreasing along <span class="math inline">\(x&gt;0\)</span>.</p>

</div>
</div>
<div id="find-nearest" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Find Nearest<a href="mathematics.html#find-nearest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="neart-point-along-a-line-through-orgin-to-another-point" class="section level4 hasAnchor" number="8.1.4.1">
<h4><span class="header-section-number">8.1.4.1</span> Neart Point Along a Line Through Orgin to Another Point<a href="mathematics.html#neart-point-along-a-line-through-orgin-to-another-point" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We first have <span class="math inline">\(X_1\)</span> an <span class="math inline">\(Y_1\)</span>, given these, we are able to generate <span class="math inline">\(R =\frac{Y_2}{X_2}\)</span>, a ratio. We want to iteratively update <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span>, where <span class="math inline">\(1\)</span> subscript indicates the first iteration, but we only know the ratio. Think of <span class="math inline">\(R\)</span> as a line through the origin with <span class="math inline">\(R\)</span> as the slope.</p>
<p>We generate <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y_2\)</span> by finding the point along the <span class="math inline">\(R\)</span> as slope origin line that is the closest to the <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span>. At the resulting point, <span class="math inline">\(R\)</span> will be respected, and it will differ least in distance to the earlier iteration’s <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span> points.</p>
<ol style="list-style-type: decimal">
<li>The slope of the diagonal line is <span class="math inline">\(-\frac{X_2}{Y_2}=-\frac{1}{R}\)</span></li>
<li>The diagonal line must cross <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span>, solve for this line’s y-intercept</li>
<li>Solve for the intersection of the diagonal line and the origin line with <span class="math inline">\(R\)</span> as slope</li>
</ol>
<p>Implementing step (2):</p>
<p><span class="math display">\[
\begin{aligned}
Y_1 &amp;= I - \frac{1}{R}\cdot X_1\\
I &amp;= Y_1 + \frac{X_1}{R} \\
I &amp;=  \frac{Y_1\cdot R + X_1}{R}\\
\end{aligned}
\]</span></p>
<p>Implementing step (3):
<span class="math display">\[
\begin{aligned}
Y &amp;= \frac{Y_1\cdot R + X_1}{R} - \frac{1}{R}\cdot X\\
Y &amp;= R \cdot X \\
R \cdot X &amp;= \frac{Y_1\cdot R + X_1}{R} - \frac{1}{R}\cdot X\\
\left(R + \frac{1}{R}\right) \cdot X &amp;= \frac{Y_1\cdot R + X_1}{R}\\
\frac{R^2 + 1}{R} \cdot X &amp;= \frac{Y_1\cdot R + X_1}{R}\\
X &amp;= \frac{Y_1\cdot R + X_1}{R} \cdot \frac{R}{R^2 + 1}\\
\end{aligned}
\]</span></p>
<p>And we have:
<span class="math display">\[
\begin{aligned}
X &amp;= \frac{Y_1\cdot R + X_1}{R^2 + 1}\\
Y &amp;= \frac{Y_1\cdot R^2 + X_1\cdot R}{R^2 + 1}\\
\end{aligned}
\]</span></p>
<p>Visualize the results:</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="mathematics.html#cb705-1" tabindex="-1"></a><span class="co"># Set random parameter Values for X1, Y1, and X2/Y2 ratio</span></span>
<span id="cb705-2"><a href="mathematics.html#cb705-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb705-3"><a href="mathematics.html#cb705-3" tabindex="-1"></a>fl_x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb705-4"><a href="mathematics.html#cb705-4" tabindex="-1"></a>fl_y1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb705-5"><a href="mathematics.html#cb705-5" tabindex="-1"></a>fl_r <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb705-6"><a href="mathematics.html#cb705-6" tabindex="-1"></a></span>
<span id="cb705-7"><a href="mathematics.html#cb705-7" tabindex="-1"></a><span class="co"># Diaganol</span></span>
<span id="cb705-8"><a href="mathematics.html#cb705-8" tabindex="-1"></a>fl_diag_slope <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> fl_r</span>
<span id="cb705-9"><a href="mathematics.html#cb705-9" tabindex="-1"></a>fl_diag_yintercept <span class="ot">&lt;-</span> (fl_y1 <span class="sc">*</span> fl_r <span class="sc">+</span> fl_x1) <span class="sc">/</span> fl_r</span>
<span id="cb705-10"><a href="mathematics.html#cb705-10" tabindex="-1"></a></span>
<span id="cb705-11"><a href="mathematics.html#cb705-11" tabindex="-1"></a><span class="co"># Closest point</span></span>
<span id="cb705-12"><a href="mathematics.html#cb705-12" tabindex="-1"></a>fl_x2 <span class="ot">&lt;-</span> (fl_y1 <span class="sc">*</span> fl_r <span class="sc">+</span> fl_x1) <span class="sc">/</span> (fl_r<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb705-13"><a href="mathematics.html#cb705-13" tabindex="-1"></a>fl_y2 <span class="ot">&lt;-</span> (fl_y1 <span class="sc">*</span> fl_r<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> fl_x1 <span class="sc">*</span> fl_r) <span class="sc">/</span> (fl_r<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb705-14"><a href="mathematics.html#cb705-14" tabindex="-1"></a></span>
<span id="cb705-15"><a href="mathematics.html#cb705-15" tabindex="-1"></a><span class="co"># Print state</span></span>
<span id="cb705-16"><a href="mathematics.html#cb705-16" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;x1=&quot;</span>, fl_x1, <span class="st">&quot;x2=&quot;</span>, fl_x2, <span class="st">&quot;R=&quot;</span>, fl_r, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;x1= 1.68041526339948 x2= 3.6609038475849 R= 1.92471175687388&quot;</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="mathematics.html#cb707-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;x2=&quot;</span>, fl_x2, <span class="st">&quot;y2=&quot;</span>, fl_y2, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;x2= 3.6609038475849 y2= 7.04618467623146&quot;</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="mathematics.html#cb709-1" tabindex="-1"></a><span class="co"># X and y lims</span></span>
<span id="cb709-2"><a href="mathematics.html#cb709-2" tabindex="-1"></a>ar_xylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">max</span>(fl_x1, fl_y2) <span class="sc">*</span> <span class="fl">1.5</span>)</span>
<span id="cb709-3"><a href="mathematics.html#cb709-3" tabindex="-1"></a></span>
<span id="cb709-4"><a href="mathematics.html#cb709-4" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb709-5"><a href="mathematics.html#cb709-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb709-6"><a href="mathematics.html#cb709-6" tabindex="-1"></a><span class="co"># Line through origin</span></span>
<span id="cb709-7"><a href="mathematics.html#cb709-7" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">0</span> <span class="sc">+</span> fl_r <span class="sc">*</span> x, ar_xylim[<span class="dv">1</span>], ar_xylim[<span class="dv">2</span>],</span>
<span id="cb709-8"><a href="mathematics.html#cb709-8" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb709-9"><a href="mathematics.html#cb709-9" tabindex="-1"></a>  <span class="at">ylim =</span> ar_xylim,</span>
<span id="cb709-10"><a href="mathematics.html#cb709-10" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb709-11"><a href="mathematics.html#cb709-11" tabindex="-1"></a>)</span>
<span id="cb709-12"><a href="mathematics.html#cb709-12" tabindex="-1"></a><span class="co"># Diaganol line</span></span>
<span id="cb709-13"><a href="mathematics.html#cb709-13" tabindex="-1"></a><span class="fu">curve</span>(fl_diag_yintercept <span class="sc">+</span> fl_diag_slope <span class="sc">*</span> x,</span>
<span id="cb709-14"><a href="mathematics.html#cb709-14" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb709-15"><a href="mathematics.html#cb709-15" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb709-16"><a href="mathematics.html#cb709-16" tabindex="-1"></a>  <span class="at">ylim =</span> ar_xylim,</span>
<span id="cb709-17"><a href="mathematics.html#cb709-17" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb709-18"><a href="mathematics.html#cb709-18" tabindex="-1"></a>)</span>
<span id="cb709-19"><a href="mathematics.html#cb709-19" tabindex="-1"></a><span class="co"># Point</span></span>
<span id="cb709-20"><a href="mathematics.html#cb709-20" tabindex="-1"></a><span class="fu">points</span>(fl_x1, fl_y1,</span>
<span id="cb709-21"><a href="mathematics.html#cb709-21" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb709-22"><a href="mathematics.html#cb709-22" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb709-23"><a href="mathematics.html#cb709-23" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb709-24"><a href="mathematics.html#cb709-24" tabindex="-1"></a>)</span>
<span id="cb709-25"><a href="mathematics.html#cb709-25" tabindex="-1"></a><span class="fu">points</span>(fl_x2, fl_y2,</span>
<span id="cb709-26"><a href="mathematics.html#cb709-26" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb709-27"><a href="mathematics.html#cb709-27" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">9</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb709-28"><a href="mathematics.html#cb709-28" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb709-29"><a href="mathematics.html#cb709-29" tabindex="-1"></a>)</span>
<span id="cb709-30"><a href="mathematics.html#cb709-30" tabindex="-1"></a><span class="co"># Origin lines</span></span>
<span id="cb709-31"><a href="mathematics.html#cb709-31" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb709-32"><a href="mathematics.html#cb709-32" tabindex="-1"></a>  <span class="at">v =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">0</span>,</span>
<span id="cb709-33"><a href="mathematics.html#cb709-33" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span></span>
<span id="cb709-34"><a href="mathematics.html#cb709-34" tabindex="-1"></a>)</span>
<span id="cb709-35"><a href="mathematics.html#cb709-35" tabindex="-1"></a></span>
<span id="cb709-36"><a href="mathematics.html#cb709-36" tabindex="-1"></a><span class="co"># Titles</span></span>
<span id="cb709-37"><a href="mathematics.html#cb709-37" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb709-38"><a href="mathematics.html#cb709-38" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb709-39"><a href="mathematics.html#cb709-39" tabindex="-1"></a>    <span class="st">&quot;Line through origin and orthogonal line</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb709-40"><a href="mathematics.html#cb709-40" tabindex="-1"></a>    <span class="st">&quot;Find closest point along black line to red star&quot;</span></span>
<span id="cb709-41"><a href="mathematics.html#cb709-41" tabindex="-1"></a>  ),</span>
<span id="cb709-42"><a href="mathematics.html#cb709-42" tabindex="-1"></a>  <span class="at">sub =</span> <span class="fu">paste0</span>(</span>
<span id="cb709-43"><a href="mathematics.html#cb709-43" tabindex="-1"></a>    <span class="st">&quot;Black line goes through origin,&quot;</span>,</span>
<span id="cb709-44"><a href="mathematics.html#cb709-44" tabindex="-1"></a>    <span class="st">&quot; blue line goes through (x1,y1) and (x2, y2)&quot;</span></span>
<span id="cb709-45"><a href="mathematics.html#cb709-45" tabindex="-1"></a>  ),</span>
<span id="cb709-46"><a href="mathematics.html#cb709-46" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y values&quot;</span></span>
<span id="cb709-47"><a href="mathematics.html#cb709-47" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-356-1.png" width="504" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="linear-scalar-fx0-solutions" class="section level3 hasAnchor" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> Linear Scalar f(x)=0 Solutions<a href="mathematics.html#linear-scalar-fx0-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="ratio" class="section level4 hasAnchor" number="8.1.5.1">
<h4><span class="header-section-number">8.1.5.1</span> Ratio<a href="mathematics.html#ratio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here are some common ratios.</p>
<div id="unif-draw-min-and-max-ratio" class="section level5 hasAnchor" number="8.1.5.1.1">
<h5><span class="header-section-number">8.1.5.1.1</span> Unif Draw Min and Max Ratio<a href="mathematics.html#unif-draw-min-and-max-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We want to draw numbers such that we have some mean <span class="math inline">\(b\)</span>, and that the possible maximum and minimum value drawn are at most <span class="math inline">\(a\)</span> times apart. Given <span class="math inline">\(b\)</span> and <span class="math inline">\(a\)</span>, solve for <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
f(x) = \frac{b+x}{b-x} - a = 0
\]</span></p>
<p><span class="math display">\[
b \cdot a - x \cdot a = b + x \\
b \cdot a - b = x + x \cdot a  \\
b \left(a - 1\right) = x \left( a+ 1\right)  \\
x = \frac{b\left(a-1\right)}{a+1}\\
\]</span></p>
<p>Uniformly draw</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="mathematics.html#cb710-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb710-2"><a href="mathematics.html#cb710-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb710-3"><a href="mathematics.html#cb710-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> (b<span class="sc">*</span>(a<span class="dv">-1</span>))<span class="sc">/</span>(a<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb710-4"><a href="mathematics.html#cb710-4" tabindex="-1"></a>ar_unif_draws <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min=</span>b<span class="sc">-</span>x, <span class="at">max=</span>b<span class="sc">+</span>x)</span>
<span id="cb710-5"><a href="mathematics.html#cb710-5" tabindex="-1"></a>fl_max_min_ratio <span class="ot">&lt;-</span> <span class="fu">max</span>(ar_unif_draws)<span class="sc">/</span><span class="fu">min</span>(ar_unif_draws)</span>
<span id="cb710-6"><a href="mathematics.html#cb710-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;fl_max_min_ratio =&#39;</span>, fl_max_min_ratio, <span class="st">&#39;is close to a =&#39;</span>, a, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## fl_max_min_ratio = 1.976291 is close to a = 2</code></pre>

</div>
</div>
</div>
</div>
<div id="production-functions" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Production Functions<a href="mathematics.html#production-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="nested-ces-production-function" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Nested CES Production Function<a href="mathematics.html#nested-ces-production-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="the-nested-ces-problem" class="section level4 hasAnchor" number="8.2.1.1">
<h4><span class="header-section-number">8.2.1.1</span> The Nested CES Problem<a href="mathematics.html#the-nested-ces-problem" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have the following production function with four inputs <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span>. There are three <span class="math inline">\(\rho\)</span> parameters <span class="math inline">\(\rho_x\)</span>, <span class="math inline">\(\rho_y\)</span> and <span class="math inline">\(\rho_o\)</span> that correspond to inner-nest and outter nest elasticity of substitution between inputs.</p>
<p>The firm’s expenditure minimization problem has the following objective:</p>
<p><span class="math display">\[
\min_{x_1, x_2, y_1, y_2} \left(
x_1 \cdot p_{x_1} +
x_2 \cdot p_{x_2} +
y_1 \cdot p_{y_1} +
y_2 \cdot p_{y_2}
\right)
\]</span></p>
<p>The production quantity constraint is, using a constant-returns doubly-nested production function:</p>
<p><span class="math display">\[
Y= Z \cdot
\left(
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^\frac{1}{{\rho_x}}
\right)
^{\rho_{o}} +
\beta_{o_2}
\left(
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{1}{{\rho_y}}
\right)
^{\rho_{o}}
\right)^\frac{1}{\rho_{o}}
\]</span></p>
<p>Note that we are assuming constant-returns to scale in a competitive setting, so firms do not make profits. We solve for expenditure minimization rather than profit maximization.</p>
<div id="marginal-product-of-labor" class="section level5 hasAnchor" number="8.2.1.1.1">
<h5><span class="header-section-number">8.2.1.1.1</span> Marginal Product of Labor<a href="mathematics.html#marginal-product-of-labor" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>A key object to consider is the marginal product of input (labor or capital). Taking derivative of output <span class="math inline">\(Y\)</span> with respect to input <span class="math inline">\(x_1\)</span>, we have:</p>
<p><span class="math display">\[
\frac{\partial Y}{\partial x_1}=
\left[
\frac{1}{\rho_{o}}
Z
\left(
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^\frac{1}{{\rho_x}}
\right)
^{\rho_{o}} +
\beta_{o_2}
\left(
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{1}{{\rho_y}}
\right)
^{\rho_{o}}
\right)^{\frac{1}{\rho_{o}} - 1}
\right]
\cdot
\left[
\rho_{o}
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^\frac{1}{{\rho_x}}
\right)^{\rho_{o}-1}
\right]
\cdot
\left[
  \frac{1}{{\rho_x}}
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot
\left[
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
<p>What is the relationship between the marginal product of labor and the wage? Let <span class="math inline">\(\lambda\)</span> be the lagrange multiplier for the overall problem:</p>
<p><span class="math display">\[
p_{x_1} = \lambda \cdot \left(\frac{\partial Y}{\partial x_1}\right)
\]</span></p>
</div>
</div>
<div id="denesting-the-nested-ces-problem" class="section level4 hasAnchor" number="8.2.1.2">
<h4><span class="header-section-number">8.2.1.2</span> Denesting the Nested CES Problem<a href="mathematics.html#denesting-the-nested-ces-problem" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Rather than solving the problem above directly in an expenditure minimization, we can divide the problem above into three parts, the <strong>X Problem</strong>, the <strong>Y Problem</strong> and the <strong>Z Problem</strong>.</p>
<div id="three-denested-sub-problems-x-y-and-o-problems" class="section level5 hasAnchor" number="8.2.1.2.1">
<h5><span class="header-section-number">8.2.1.2.1</span> Three Denested Sub-problems, X, Y and O Problems<a href="mathematics.html#three-denested-sub-problems-x-y-and-o-problems" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><strong>The X problem</strong>:</p>
<p><span class="math display">\[
\min_{x_1, x_2}
\left(
x_1 \cdot p_{x_1} +
x_2 \cdot p_{x_2}
\right)
\]</span>
<span class="math display">\[
O_x =
\left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
\right)^\frac{1}{{\rho_x}}
\]</span></p>
<p><strong>The Y problem</strong>:</p>
<p><span class="math display">\[
\min_{y_1, y_2}
\left(
y_1 \cdot p_{y_1} +
y_2 \cdot p_{y_2}
\right)
\]</span>
<span class="math display">\[
O_y =
\left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
\right)^\frac{1}{{\rho_y}}
\]</span></p>
<p><strong>The O problem</strong>:</p>
<p><span class="math display">\[
\min_{o_1, o_2}
\left(
O_x \cdot p_{o_1} +
O_y \cdot p_{o_2}
\right)
\]</span>
<span class="math display">\[
Y =
Z\cdot\left(
    \beta_{o_1} O_x^{\rho_o} + \beta_{o_2} O_y^{\rho_o}
\right)^\frac{1}{{\rho_o}}
\]</span></p>
</div>
<div id="marginal-product-of-labor-for-de-nested-problem" class="section level5 hasAnchor" number="8.2.1.2.2">
<h5><span class="header-section-number">8.2.1.2.2</span> Marginal Product of Labor for De-nested Problem<a href="mathematics.html#marginal-product-of-labor-for-de-nested-problem" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We can also take the derivative of the output requirement for the X problem with respect to <span class="math inline">\(x_1\)</span>, we have:</p>
<p><span class="math display">\[
\frac{\partial O_x}{\partial x_1}=
\left[
  \frac{1}{{\rho_x}}
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot
\left[
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
<p>Which simplifies a little bit to:
<span class="math display">\[
\frac{\partial O_x}{\partial x_1}=
\left[
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot
\left[
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
<p>What is the relationship between the marginal product of labor and the wage for the problem in the subnest? Let <span class="math inline">\(\lambda_x\)</span> be the lagrange multiplier for the lagrange multiplier specific to the subnest:</p>
<p><span class="math display">\[
p_{x_1} = \lambda_x \cdot \left(\frac{\partial O_x}{\partial x_1}\right)
\]</span></p>
<p>This means that we have the following FOC from solving the expenditure minimization problem:</p>
<p><span class="math display">\[
p_{x_1} =
\lambda_x \cdot
\left[
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot
\left[
  \beta_{x_1} x_1^{\rho_x-1}
\right]
\]</span></p>
</div>
</div>
<div id="solving-the-nested-ces-problem" class="section level4 hasAnchor" number="8.2.1.3">
<h4><span class="header-section-number">8.2.1.3</span> Solving the Nested-CES Problem<a href="mathematics.html#solving-the-nested-ces-problem" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Conceptually, we can solve the nested-ces problem in two stages. First, given aggregate prices, solve for optimal aggregate inputs. Second, given the aggregate inputs, which are output requirements for inner nests, solve for optimal choices within nests.</p>
<p>There are two functions of interest, one function provides A</p>
</div>
<div id="identification" class="section level4 hasAnchor" number="8.2.1.4">
<h4><span class="header-section-number">8.2.1.4</span> Identification<a href="mathematics.html#identification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="relative-marginal-product" class="section level5 hasAnchor" number="8.2.1.4.1">
<h5><span class="header-section-number">8.2.1.4.1</span> Relative Marginal Product<a href="mathematics.html#relative-marginal-product" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Note that <span class="math inline">\(\frac{1}{\rho} - 1 = \frac{1}{\rho} - \frac{\rho}{\rho} = \frac{1-\rho}{\rho}\)</span>, and <span class="math inline">\(x^{\frac{1-\rho}{\rho}} = \left(x^{\frac{1}{\rho}}\right)^{1-\rho}\)</span>.</p>
<p>Relative marginal product within the same sub-nest:</p>
<p><span class="math display">\[
\frac{p_{x_1}}{p_{x_2}}
=\frac{
  \frac{\partial Y}{\partial x_1}
}
{
  \frac{\partial Y}{\partial x_2}
}
=\frac{
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
}
{
  \rho_x
  \beta_{x_2} x_2^{\rho_x-1}
}
=\frac{\beta_{x_1}}{\beta_{x_2}}\cdot
\left(\frac{x_1}{x_2}\right)^{\rho_x-1}
\]</span></p>
<p>Relative marginal product across subnests:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{
  \frac{\partial Y}{\partial x_1}
}
{
  \frac{\partial Y}{\partial y_1}
}
&amp;=\frac{p_{x_1}}{p_{y_1}}
\\
\frac{
  \frac{\partial Y}{\partial x_1}
}
{
  \frac{\partial Y}{\partial y_1}
}
&amp;=\frac{
\left[
\rho_{o}
\beta_{o_1}
\left(
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^\frac{1}{{\rho_x}}
\right)^{\rho_{o}-1}
\right]
\cdot
\left[
  \frac{1}{{\rho_x}}
  \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{1}{{\rho_x}} - 1}
\right]
\cdot
\left[
  \rho_x
  \beta_{x_1} x_1^{\rho_x-1}
\right]
}
{
\left[
\rho_{o}
\beta_{o_2}
\left(
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{1}{{\rho_y}}
\right)^{\rho_{o}-1}
\right]
\cdot
\left[
  \frac{1}{{\rho_y}}
  \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^{\frac{1}{{\rho_y}} - 1}
\right]
\cdot
\left[
  \rho_y
  \beta_{y_1} y_1^{\rho_y-1}
\right]
}\\
&amp;=\frac{
\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]
}
{
\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]
}
\cdot
\left[
\frac{\beta_{o_1}\beta_{x_1}}{\beta_{o_2}\beta_{y_1}}  
\right]
\cdot
\frac{
\left[
   x_1^{\rho_x-1}
\right]
}
{
\left[
   y_1^{\rho_y-1}
\right]
}
\\
\end{aligned}
\]</span></p>
<p>Note that in the equation above, the first term is the same across for the relative MPL across all within subnest terms.</p>
<p>There are four derivative ratios. First:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_1}}{p_{y_1}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_1}}{\beta_{o_2}\beta_{y_1}}\right]
\cdot
\frac{\left[x_1^{\rho_x-1}\right]}
{\left[y_1^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span>
Second:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_1}}{p_{y_2}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_1}}{\beta_{o_2}\beta_{y_2}}\right]
\cdot
\frac{\left[x_1^{\rho_x-1}\right]}
{\left[y_2^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span>
Third:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_2}}{p_{y_1}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_2}}{\beta_{o_2}\beta_{y_1}}\right]
\cdot
\frac{\left[x_2^{\rho_x-1}\right]}
{\left[y_1^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span>
Fourth:
<span class="math display">\[
\begin{aligned}
\frac{p_{x_2}}{p_{y_2}}&amp;=\frac{\left[
    \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{\rho_{o}-\rho_x}{{\rho_x}}}
\right]}
{\left[
    \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{\rho_{o}-\rho_y}{{\rho_y}}
\right]}
\cdot
\left[\frac{\beta_{o_1}\beta_{x_2}}{\beta_{o_2}\beta_{y_2}}\right]
\cdot
\frac{\left[x_2^{\rho_x-1}\right]}
{\left[y_2^{\rho_y-1}\right]}
\\
\end{aligned}
\]</span></p>
<p>Note that we have overall seven unknowns, three share parameters, and three elasticity parameters, and a output and productivity ratio. It looks like we have six equations, but only perhaps 3? Three of the above can not be used.</p>
</div>
<div id="identification-with-aggregate-data-over-two-periods" class="section level5 hasAnchor" number="8.2.1.4.2">
<h5><span class="header-section-number">8.2.1.4.2</span> Identification with Aggregate Data over two Periods<a href="mathematics.html#identification-with-aggregate-data-over-two-periods" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We say: (1) given the level of nested structure you have, what is the number of restrictions you have to impose on share or elasticity in order to fully identify the model.</p>
<p>The identification of the three share and elasticity parameters can be achieved by using the following two equations over three periods.</p>
<p><span class="math display">\[
\begin{aligned}
\log\left(\frac{p_{x_1}}{p_{x_2}}\right)
&amp;=\log\left(\frac{\beta_{x_1}}{\beta_{x_2}}\right)
+
\left(\rho_x-1\right)\cdot
\log\left(\frac{x_1}{x_2}\right)
\\
\log\left(\frac{p_{y_1}}{p_{y_2}}\right)
&amp;=\log\left(\frac{\beta_{y_1}}{\beta_{y_2}}\right)
+
\left(\rho_y-1\right)\cdot
\log\left(\frac{y_1}{y_2}\right)
\\
\log\left(\frac{p_{x_1}}{p_{y_1}}\right)
&amp;=
\log\left(
  \frac{\beta_{o_1}}{\beta_{o_2}}
  \left[
    \frac{
      \beta_{x_1} \cdot x_1^{\rho_x-1} \cdot O_y^{\rho_y}
    }{
      \beta_{y_1} \cdot y_1^{\rho_y-1} \cdot O_x^{\rho_x}
      }
  \right]
  \right)
+
\rho_o
\cdot
\log\left[
\frac{O_x}{O_y}  
  \right]
\end{aligned}
\]</span>
Note that the contents in the square brackets are data given the results from the other equations.</p>
<p>The identification of the inner-nest elasticity and share parameters is based on inner-nest quantity and relative price relationships. The relative price across nests, and the relative aggregate quantity across nets, then pin down the elasticity and share parameters across nests. In another word, within nest information on relative prices and quantity contain no information on higher nest parameters, but higher nest parameters are a function of lower nest parameters.</p>
<p>Note that for the higher nest, the intercept term is fully flexibly determined by outter nest share parameters, however, the specific translation between outter nest intercept and share values is scaled by inner-nest estimates and aggregate outputs.</p>
<p>Where
<span class="math display">\[
\begin{aligned}
  O_x &amp;= \left(
    \beta_{x_1} x_1^{\rho_x} + \beta_{x_2} x_2^{\rho_x}
    \right)^{\frac{1}{{\rho_x}}}\\
  O_y &amp;= \left(
    \beta_{y_1} y_1^{\rho_y} + \beta_{y_2} y_2^{\rho_y}
    \right)^\frac{1}{{\rho_y}}
\end{aligned}
\]</span></p>

</div>
</div>
</div>
<div id="latent-dynamic-health-production-function" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Latent Dynamic Health Production Function<a href="mathematics.html#latent-dynamic-health-production-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="latent-health-and-observed-health" class="section level4 hasAnchor" number="8.2.2.1">
<h4><span class="header-section-number">8.2.2.1</span> Latent Health and Observed Health<a href="mathematics.html#latent-health-and-observed-health" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, output and input relationship is described generally by:</p>
<p><span class="math display">\[
Y^{\ast}_t = H(X_t, Z_t, Y^{\ast}_t) + \epsilon_t
\thinspace,
\]</span></p>
<p>where we assume the separability between the error term and equation <span class="math inline">\(f\)</span>.</p>
<p>Additionally, assume that:
<span class="math display">\[
\epsilon \sim \mathrm{N}\left( \mu, \sigma\right)
\thinspace.
\]</span></p>
<p>We do not observe <span class="math inline">\(Y^{\ast}_t\)</span>, however, we observe discretized integers <span class="math inline">\(Y_{i,t}\)</span>:</p>
<p><span class="math display">\[
Y_{i,t} \equiv \left\{ j \in \mathcal{N} : G_{j-1} \le Y^{\ast}_{i,t} \le G_j, \text{ for } 0 &lt; j \le J+1)
\right\}
\thinspace.
\]</span></p>
<p>Our parameters of interest are:
- The <span class="math inline">\(H(X_t, Z_t, Y^{\ast,t})\)</span> function.
- What are <span class="math inline">\(\left\{G^{\ast}_{j}\right\}_{j=1}^J\)</span>, assume that <span class="math inline">\(G^{\ast}_{0} = -\infty\)</span> and <span class="math inline">\(G^{\ast}_{J+1} = \infty\)</span>.</p>
<p>If the function is known, we understand the dyanmic evolution of health, and can analyze the effects of changing input on health status for the given population or for alternative populations with different distributions of current inputs.</p>
</div>
<div id="standard-estimation-with-observed-health-status" class="section level4 hasAnchor" number="8.2.2.2">
<h4><span class="header-section-number">8.2.2.2</span> Standard Estimation with Observed Health Status<a href="mathematics.html#standard-estimation-with-observed-health-status" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose we observe the dataset: <span class="math inline">\(\left\{Y_i, X_i, Z_i\right\}_{i=1}^N\)</span>. Suppose that <span class="math inline">\(E[\epsilon|X,Z]=0\)</span>.</p>
<p><span class="math display">\[
P(Y=j|X,Z) =
\Phi\left(
\frac{G_j - H(X,Z) - \mu}{\sigma}
\right) -
\Phi\left(
\frac{G_{j-1} - H(X,Z) - \mu}{\sigma}
\right)
\]</span></p>
<p>Note that we can construct the log-likelihood, to estimate thresholds and the parameters of for example lienarized <span class="math inline">\(f()\)</span> function. Note that we can not identify <span class="math inline">\(\mu\)</span> and also can not identify <span class="math inline">\(\sigma\)</span>. Note that this is ordered-logit/ordered-probit framework. In this framework, would assume homogeneous parameters across individuals.</p>
</div>
<div id="observed-probabilities" class="section level4 hasAnchor" number="8.2.2.3">
<h4><span class="header-section-number">8.2.2.3</span> Observed Probabilities<a href="mathematics.html#observed-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We now observe the probabilities of observing the discrete <span class="math inline">\(Y_i\)</span> values given <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span>. From the data, we have
<span class="math display">\[
\left\{
    P(Y = j | X, Z )
\right\}_{j=1}^{J}
\thinspace.
\]</span></p>
<p>Additionally, we observe probabilities when input changes. These allow us to estimate/identify the model with individual specific parameters and thresholds, and given the nature of the question, do not have to worry about correlation between error and input changes.</p>
<p><span class="math display">\[
Y_t^{\ast} = H_i(X_t,Z_t,Y_{t-1}^{\ast}) + \epsilon
\thinspace.
\]</span></p>
<p>We have the individual-specific <span class="math inline">\(H_i\)</span> function. Our thresholds now can also be individual-specific <span class="math inline">\(\left\{G_{ji}\right\}_{j=1}^J\)</span>.
<!-- might be due to "random effects" rather than fixed individual-specific attributes. Note that this is perception not truth, there could be individual belief. We are capturing the individual-specific belief about the $\alpha_i$ parameter, whatever the truth might be. --></p>
</div>
<div id="single-contemporaneous-input-model" class="section level4 hasAnchor" number="8.2.2.4">
<h4><span class="header-section-number">8.2.2.4</span> Single Contemporaneous Input Model<a href="mathematics.html#single-contemporaneous-input-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose there is no dynamics and we only observe one input. For each individual, we know:
<span class="math display">\[
\left\{
    P(Y = j | Z)
\right\}_{j=1}^{J}
\thinspace.
\]</span></p>
<p>Assuming separability between the error term and the observed component of the model, we have:
<span class="math display">\[
Y^{\ast} = H_i(Z) + \epsilon
\thinspace.
\]</span></p>
<div id="probability-given-current-inputs" class="section level5 hasAnchor" number="8.2.2.4.1">
<h5><span class="header-section-number">8.2.2.4.1</span> Probability given Current Inputs<a href="mathematics.html#probability-given-current-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>For each individual, it might seem like that we can normalize given their current <span class="math inline">\(X\)</span> choices so that this is equal to 0, but we can not. So the probability of observering aparticular discrete health outcome is equal to:</p>
<p><span class="math display">\[
P(Y =j | Z ) = \Phi(G_{ji} - H_i(Z)) - \Phi(G_{j-1,i}  - H_i(Z))
\]</span></p>
<p>Alternatively, this can be written as:</p>
<p><span class="math display">\[
\sum_{\widehat{j}=1}^{j} \left(P(Y = \widehat{j} | Z )\right) = \Phi(G_{ji} - H_i (Z))
\]</span></p>
<p>For any <span class="math inline">\(j\)</span>, just using information given current choices, we can not identify <span class="math inline">\(\left\{G_{ji}\right\}_{j=1}^J\)</span>, because we do not know what <span class="math inline">\(H_i(Z)\)</span> is.</p>
</div>
<div id="probability-at-two-input-levels" class="section level5 hasAnchor" number="8.2.2.4.2">
<h5><span class="header-section-number">8.2.2.4.2</span> Probability at Two Input Levels<a href="mathematics.html#probability-at-two-input-levels" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Now, we observe both:</p>
<p><span class="math display">\[
\left\{
    P(Y = j | Z)
\right\}_{j=1}^{J}
, \text{ and }
\left\{
    P(Y = j | Z + 1)
\right\}_{j=1}^{J}
\]</span></p>
<p>Since the individual thresholds, <span class="math inline">\(\left\{G_{ji}\right\}_{j=1}^J\)</span>, applies to both probabilities, now we are able to identify the change in the <span class="math inline">\(H_i\)</span> from <span class="math inline">\(Z\)</span> to <span class="math inline">\(Z+1\)</span>. Specifically, because:</p>
<p><span class="math display">\[
\Phi^{-1}\left(
    \sum_{\widehat{j}=1}^{j} \left(P(Y = \widehat{j} | Z )\right)
) \right) = G_{ji} - H_i(Z)
\]</span></p>
<p>Hence:</p>
<p><span class="math display">\[
\Phi^{-1}\left(
    \sum_{\widehat{j}=1}^{j} \left(P(Y = \widehat{j} | Z )\right)
) \right) -
\Phi^{-1}\left(
    \sum_{\widehat{j}=1}^{j} \left(P(Y = \widehat{j} | Z+1 )\right)
) \right) =
(G_{ji} - H_i(Z)) - (G_{ji} - H_i(Z+1))
=
H_i(Z+1) - H_i(Z)
,\thinspace
\forall j \in \left\{1,...,J\right\}
\]</span></p>
<p>Note that the above will equal to the same number for any <span class="math inline">\(j\)</span> under the assumption that the error term is distributed normal.</p>
<p>Define the difference as:</p>
<p><span class="math display">\[
\beta^{+}_{i} = H_i(Z+1) - H_i(Z)
\]</span></p>
<p>If <span class="math inline">\(H_i\)</span> is linear in <span class="math inline">\(Z\)</span>, then, <span class="math inline">\(H_i(Z) = \beta^{+}_{i} \cdot Z\)</span>. If rather than adding <span class="math inline">\(1\)</span> to <span class="math inline">\(Z\)</span> we evaluate probabilities after subtracting <span class="math inline">\(1\)</span> from <span class="math inline">\(Z\)</span> and compute following the above procedure <span class="math inline">\(\beta^{-}_{i}\)</span>, we would have <span class="math inline">\(\beta^{+}_{i} = \beta^{-}_{i} = \beta_i\)</span>.</p>
<p>Having identified the <span class="math inline">\(\beta_i\)</span> parameter, which is individual-specific. We can now identify all <span class="math inline">\(\left\{G_{ji}\right\}_{j=1}^J\)</span>:</p>
<p><span class="math display">\[
G_{ji} =
\Phi^{-1}\left(
    \sum_{\widehat{j}=1}^{j} \left(P(Y = \widehat{j} | Z )\right)
) \right)
+ Z \cdot \beta_i
\]</span></p>
<p>We observe <span class="math inline">\(Z\)</span> and the probability, and we have just found <span class="math inline">\(\beta_i\)</span>, so the thresholds are now known.</p>
<p>To conclude, we have Result 1 below:</p>
<blockquote>
<p>Given a latent health production function with a single observed input, a normal additive error term, and given linearity of input and latent health outcome relationship, to <span class="math inline">\(T\)</span> identify individual specific threshold and the effect of input on the latent outcome, we need to observe, for each individual, <span class="math inline">\(\left\{P(Y = j|Z)\right\}_{j=1}^J\)</span> and <span class="math inline">\(P(Y = 1|Z+1)\)</span>.</p>
</blockquote>
<p>As a corrolary of Result 1, Result 2 is:</p>
<blockquote>
<p>More flexibly, given deviations in outcomes of <span class="math inline">\(\beta^{+}_{i}\)</span>, <span class="math inline">\(0\)</span>, and <span class="math inline">\(\beta^{-}_{i}\)</span>, at <span class="math inline">\(Z-1\)</span>, <span class="math inline">\(Z\)</span>, and <span class="math inline">\(Z+1\)</span>, we can fit a quadratic function such that <span class="math inline">\(H_i(Z) = \beta_0 + \beta_1 \cdot Z + \beta_2 \cdot Z^2\)</span>.</p>
</blockquote>
</div>
</div>
<div id="mixture-of-normals" class="section level4 hasAnchor" number="8.2.2.5">
<h4><span class="header-section-number">8.2.2.5</span> Mixture of Normals<a href="mathematics.html#mixture-of-normals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the exercse above, for <span class="math inline">\(Z+1\)</span>, we only needed <span class="math inline">\(P(Y = 1|Z+1)\)</span>. Suppose we observe both <span class="math inline">\(\left\{P(Y = j|Z), P(Y = j|Z+1)\right\}_{j=1}^J\)</span> for both <span class="math inline">\(Z\)</span> and <span class="math inline">\(Z+1\)</span>, then we could allow for a mixture of normal for the error term. Another way to think about this is if we obtain very different <span class="math inline">\(\widehat{\beta}_{i}\)</span> depending on which <span class="math inline">\(P(Y = j|Z+1)\)</span> is observed for which <span class="math inline">\(j\)</span>, we can potentially explain the observed data with more flexible distributional assumptions. A mixture of normal can be assumed, rather than a normal distribution. Adding a mixture introduces three additional parameter, the mean of the second normal, its standard deviation, as well as its weight.</p>
<p>Given these, suppose we have <span class="math inline">\(J \times 2\)</span> probabilities, and <span class="math inline">\(J=4\)</span> (<span class="math inline">\(J=5\)</span> is one minus the rest), this means we have <span class="math inline">\(8\)</span> probabilities available to use, and we have <span class="math inline">\(4\)</span> threshold parameters, one <span class="math inline">\(\beta_i\)</span> parameter, and the <span class="math inline">\(3\)</span> parameters associated with the 2nd normal of the mixture.</p>
<p>Under the mixture of two normals, we have <span class="math inline">\(J\)</span> equations:</p>
<p><span class="math display">\[
\sum_{\widehat{j}=1}^{j} \left(P(Y = \widehat{j} | Z )\right) =
\left(1-\omega_i\right) \cdot \Phi\left(G_{ji}\right)
+ \omega_i \cdot \Phi\left(\frac{G_{ji} - \mu_{\epsilon_2}}{\sigma_{\epsilon_2}}\right)
,\thinspace
\forall j \in \left\{1, ..., J\right\}
\]</span></p>
<p>And <span class="math inline">\(J\)</span> additional equations:</p>
<p><span class="math display">\[
\sum_{\widehat{j}=1}^{j} \left(P(Y = \widehat{j} | Z+1 )\right) =
\left(1-\omega_i\right) \cdot \Phi\left(G_{ji} - \beta_i \right)
+ \omega_i \cdot \Phi\left(\frac{G_{ji} - \beta_i - \mu_{\epsilon_2}}{\sigma_{\epsilon_2}}\right)
,\thinspace
\forall j \in \left\{1, ..., J\right\}
\]</span></p>
<p>When <span class="math inline">\(J=4\)</span>, we solve the above system of <span class="math inline">\(8\)</span> equations with the following <span class="math inline">\(8\)</span> unknowns:</p>
<p><span class="math display">\[
\left\{
G_{1i},
G_{2i},
G_{3i},
G_{4i},
\beta_i,
\omega_i,
\mu_{\epsilon_2},
\sigma_{\epsilon_2}
\right\}
\]</span></p>
<p>This is Result 3.</p>
<p>Additionally normals can be added into the mixture if there are additional moments to fit when other inputs change for example.</p>
</div>
<div id="multiple-inputs" class="section level4 hasAnchor" number="8.2.2.6">
<h4><span class="header-section-number">8.2.2.6</span> Multiple Inputs<a href="mathematics.html#multiple-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose we have two inputs, and still assuming separability between the error term and the observed component of the model, we have:
<span class="math display">\[
Y^{\ast} = H_i(Z, X) + \epsilon
\thinspace.
\]</span></p>
<p>Suppose we have probabilities
<span class="math display">\[
\left\{
    P(Y = j | Z, X),
    P(Y = j | Z + 1, X),
    P(Y = j | Z, X + 1),
    P(Y = j | Z + 1, X + 1)
\right\}_{j=1}^{J}
\thinspace.
\]</span></p>
<p>We can follow the prior procedures to identify
<span class="math display">\[
\beta_i = H_i(Z+1, X) - H_i(Z, X)\\
\alpha_i = H_i(Z, X+1) - H_i(Z, X)\\
\zeta_i = H_i(Z+1, X+1) - H_i(Z, X)\\
\]</span></p>
<p>Given different parametric assumptions on <span class="math inline">\(H_i\)</span>, we can back out different underlying production function parameters. To illustrate, suppose we have:</p>
<p><span class="math display">\[
H_i = \overline{\alpha_i}\cdot X + \overline{\beta_i}\cdot Z + \overline{\zeta_i} \cdot X \cdot Z
\]</span></p>
<p>Then, we can back out the underlying production function parameters with the following three equations and three unknowns:</p>
<p><span class="math display">\[
\beta_i = \overline{\beta_i} + \overline{\zeta}_i\cdot X \\
\alpha_i = \overline{\alpha_i} + \overline{\zeta}_i\cdot Z\\
\zeta_i = \overline{\alpha_i} + \overline{\beta_i} + \overline{\zeta_i} \cdot \left(X + Z + 1\right)
\]</span></p>
<p>This is Result 4.</p>
</div>
<div id="dynamics-and-contemporaneous-input" class="section level4 hasAnchor" number="8.2.2.7">
<h4><span class="header-section-number">8.2.2.7</span> Dynamics and Contemporaneous Input<a href="mathematics.html#dynamics-and-contemporaneous-input" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now we generalize the structure above, to account for dynamics. Our model still has only one input, but we also know the lagged input. For each individual, we know:
<span class="math display">\[
\left\{
    P(Y_t = j | Z_t, Y_{t-1})
\right\}_{j=1}^{J}
\thinspace.
\]</span></p>
<p>Suppose that we have the following dynamic relationship in the latent variable and linear input/output relationship:
<span class="math display">\[
Y^{\ast}_{t} = \rho \cdot Y^{\ast}_{t-1} + \beta_i \cdot Z_{t} + \epsilon
\thinspace.
\]</span>
Note that the <span class="math inline">\(\rho\)</span> is not individual-specific, but <span class="math inline">\(\beta_i\)</span> is.</p>
<div id="identifying-beta_i" class="section level5 hasAnchor" number="8.2.2.7.1">
<h5><span class="header-section-number">8.2.2.7.1</span> Identifying <span class="math inline">\(\beta_i\)</span><a href="mathematics.html#identifying-beta_i" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Despite the inclusion of dynamics, we identify <span class="math inline">\(\beta_i\)</span> in the same way as for the problem without dynamics. This is possible because the <span class="math inline">\(\rho \cdot Y^{\ast}_{t-1}\)</span> is invariant across probabilities of arriving in different health status tomorrow whether input is <span class="math inline">\(Z\)</span> or <span class="math inline">\(Z+1\)</span>. Specifically, we have, for each individual:</p>
<p><span class="math display">\[
\Phi^{-1}\left(
    \sum_{\widehat{j}=1}^{j} \left(P(Y_{t} = \widehat{j} | Z_t, Y^{\ast}_{t-1} )\right)
) \right) -
\Phi^{-1}\left(
    \sum_{\widehat{j}=1}^{j} \left(P(Y_{t} = \widehat{j} | Z+1, Y^{\ast}_{t-1} )\right)
) \right) =
(G_{ji} - \rho \cdot Y^{\ast}_{t-1} - \beta_i \cdot Z_{t} ) - (G_{ji} - \rho \cdot Y^{\ast}_{t-1} - \beta_i \cdot (Z_{t}+1) )
=
\beta_i
,\thinspace
\forall j \in \left\{1,...,J\right\}
\]</span></p>
<p>Below, we try to identify persistence <span class="math inline">\(\rho\)</span> and thresholds <span class="math inline">\(\left\{G_{ji}\right\}_{j=1}^J\)</span></p>
</div>
<div id="identify-gaps-in-thresholds" class="section level5 hasAnchor" number="8.2.2.7.2">
<h5><span class="header-section-number">8.2.2.7.2</span> Identify Gaps In Thresholds<a href="mathematics.html#identify-gaps-in-thresholds" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The presence of potential lagged persistence, however, means that we can no longer directly obtain the individual-specific threshold coefficients, <span class="math inline">\(\left\{G_{ji}\right\}_{j=1}^J\)</span>, as prior.</p>
<p>For each individual, conditional on the same lagged outcome, we have probabilities of arriving at different <span class="math inline">\(j\)</span> health status next period:</p>
<p><span class="math display">\[
G_{ji} + \rho \cdot Y^{\ast}_{t-1}
= \Gamma_{ji} =
\Phi^{-1}\left(
    \sum_{\widehat{j}=1}^{j} \left(P(Y_t = \widehat{j} | Z_t, Y^{\ast}_{t-1} )\right)
) \right)
+ \beta_i  \cdot Z_t
\]</span></p>
<p>Differencing, we have:</p>
<p><span class="math display">\[
\forall (j&#39;-1)=j \ge 1
,\thinspace
\Gamma_{j&#39;,i} - \Gamma_{j,i} =
(G_{j&#39;,i} + \rho \cdot Y^{\ast}_{t-1}) -
(G_{ji} + \rho \cdot Y^{\ast}_{t-1})
= G_{j&#39;,i} - G_{ji}
= \Delta G_{j&#39;,i}
\]</span></p>
<p>So we know the individual specific threshold gaps, but we do not know <span class="math inline">\(G_{j=1,i}\)</span>. We know, <span class="math inline">\(\Gamma_{ji}\)</span>, from the right-hand side in the equation above, but can not distinguish the left-hand side components. Importantly, we do not observe the latent lagged variable <span class="math inline">\(Y^{\ast}_{t-1} \in \mathcal{R}\)</span>, but only observed the discretized value <span class="math inline">\(Y_{t-1} \in \left\{1 ,..,J \right\}\)</span>.</p>
</div>
<div id="linear-restrictions-on-threshold-and-lagged-latent-values-given-rho" class="section level5 hasAnchor" number="8.2.2.7.3">
<h5><span class="header-section-number">8.2.2.7.3</span> Linear Restrictions on Threshold and Lagged Latent Values given <span class="math inline">\(\rho\)</span><a href="mathematics.html#linear-restrictions-on-threshold-and-lagged-latent-values-given-rho" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>From the last section, we have, for <span class="math inline">\(j=1\)</span>:
<span class="math display">\[
\Gamma_{j=1,i} = G_{j=1,i} + \rho \cdot Y_{t-1}^{\ast}
\]</span>
Note that <span class="math inline">\(j=1\)</span> is not for the lagged choice, but relates to the probability of going to <span class="math inline">\(j\)</span> in <span class="math inline">\(t\)</span>.</p>
<p>Note that the <span class="math inline">\(G_{j=1,i}\)</span> is a bound on feasible values for <span class="math inline">\(Y_{t-1}^{\ast}\)</span> if we observe <span class="math inline">\(Y_{t-1}=1\)</span>. Suppose we observed <span class="math inline">\(Y_{t-1}=1\)</span>, we have two equations:
<span class="math display">\[
G_{j=1,i} =  \Gamma_{j=1,i} - \rho \cdot Y_{t-1}^{\ast}\\
G_{j=1,i} &gt; 0 + 1 \times Y_{t-1}^{\ast}
\]</span>
Think of <span class="math inline">\(G_{j=1,i}\)</span> as the Y-axis value and <span class="math inline">\(Y_{t-1}^{\ast}\)</span> as the X-axis value. The first equation is a downward sloping line whose slope is controled by <span class="math inline">\(\rho \in [0,1)\)</span>, and whose Y-intercept we already know. The second equation says that we can restrict our attention to the area to the top left of the 45 degree upward sloping line through the origin. With these two equations, while we do not know the exactly values of threshold <span class="math inline">\(G_{j=1,i}\)</span> and the latent lagged value <span class="math inline">\(Y^{\ast}_{j=1,i}\)</span>, we have substantially restricted the sub-set of jointly valid values that is consistent with observed probabilities given <span class="math inline">\(\rho\)</span>.</p>
<p>Given <span class="math inline">\(\rho\)</span>, and observing <span class="math inline">\(Y_{t-1}=1\)</span>, note that the two equations above provides a minimum threshold and a maximum latent value.
<span class="math display">\[
G^{\text{min}}_{j=1,i}(Y_{t-1}=1) = \frac{\Gamma_{j=1,i}}{1-\rho}\\
Y^{\ast,\text{max}}_{t-1}(Y_{t-1}=1) = \frac{\Gamma_{j=1,i}}{1+\rho}
\]</span></p>
<p>If we observe for the lagged discrete value <span class="math inline">\(Y_{t-1}=j&gt;1\)</span>, then rather than having <span class="math inline">\(2\)</span> equations as above, we have <span class="math inline">\(3\)</span>:</p>
<p><span class="math display">\[
G_{j,i} =  \Gamma_{j,i} - \rho \cdot Y_{t-1}^{\ast}\\
G_{j,i} &gt; 0 + 1 \times Y_{t-1}^{\ast}\\
G_{j,i} &lt; (\Gamma_{j,i}-\Gamma_{j-1,i}) + 1 \times Y_{t-1}^{\ast}
\]</span></p>
<p>Which gives us bounds on the lagged latent value:
<span class="math display">\[
Y^{\ast,\text{max}}_{t-1}(Y_{t-1}=j) = \frac{\Gamma_{j,i}}{1+\rho}\\
Y^{\ast,\text{min}}_{t-1}(Y_{t-1}=j) = \frac{\Gamma_{j-1,i}}{1+\rho}
\]</span></p>
<p>Note that we are explicitly using the information provided by the lagged discrete health status, because that’s what we are relying on to generate the inequality restrictions.</p>
</div>
<div id="the-latent-distribution" class="section level5 hasAnchor" number="8.2.2.7.4">
<h5><span class="header-section-number">8.2.2.7.4</span> The Latent Distribution<a href="mathematics.html#the-latent-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><span class="math inline">\(\rho\)</span> and <span class="math inline">\(\beta_i \cdot Z\)</span> jointly determine the distribution of <span class="math inline">\(f(Y^{\ast})\)</span>. For simplificty, suppose that an individual who uses <span class="math inline">\(Z\)</span> level of input at <span class="math inline">\(t\)</span> uses the same level of input in all past periods, then we know that (given that <span class="math inline">\(\epsilon\)</span> is normalized as a standard normal):
<span class="math display">\[
Y^{\ast} \sim
\mathcal{N}\left(
    \mu_{Y^{\ast}} = \left(\frac{\beta_i \cdot Z}{1-\rho}\right),
    \sigma^2_{Y^{\ast}} = \left(\frac{1}{1-\rho^2}\right)
\right)
\]</span>
Regardless of where threshold cutoff values are, we can compute the chance of observing latent lagged value between some range <span class="math inline">\(P(a&lt;Y^{\ast}_{t-1}&lt;b)\)</span>.</p>
</div>
<div id="estimating-persistence-rho" class="section level5 hasAnchor" number="8.2.2.7.5">
<h5><span class="header-section-number">8.2.2.7.5</span> Estimating Persistence <span class="math inline">\(\rho\)</span><a href="mathematics.html#estimating-persistence-rho" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The intuition for looking for the persistence parameter is that even though given <span class="math inline">\(\rho\)</span>, there is a continuum of threshold and lagged latent values that can explain observed probabilities. However, values of <span class="math inline">\(\rho\)</span> controls, as just shown, the distribution of the latent variable. So as <span class="math inline">\(\rho\)</span> changes, the chance for observing different ranges of latent values changes.</p>
<p>So given that we observe <span class="math inline">\(Y_{t-1}=j\)</span>, we look for <span class="math inline">\(\rho\)</span> to maximize the probability of observing <span class="math inline">\(Y_{t-1}=j\)</span> (without needing to know what the threshold values should be):
<span class="math display">\[
\widehat{\rho}^{\ast} = \arg\max_{\widehat{\rho}}
\left(
    \int_{\frac{\Gamma_{j-1,i}}{1+\widehat{\rho}}}^{\frac{\Gamma_{j,i}}{1+\widehat{\rho}}}
    \phi\left(\frac{Y^{\ast}-\left(\frac{\beta_i \cdot Z}{1-\widehat{\rho}}\right)}{\left(\frac{1}{1-\widehat{\rho}^2}\right)}\right)
    d Y^{\ast}
\right)
\]</span></p>
<p>Note that:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\Gamma_{j,i}\)</span> and <span class="math inline">\(\Gamma_{j-1,i}\)</span> are based on observed probabilities</li>
<li>the integration bounds comes from the lagged discrete outcome which generates the inequality conditions</li>
<li>Discrete thresholds are unrelated to the distribution of the latent variable.</li>
</ol>
<p>Maximizer <span class="math inline">\(\widehat{\rho}\)</span> is an individual-specific maximizer. Not entirely clear if <span class="math inline">\(\widehat{\rho}^{\ast}=\rho\)</span>. Perhaps in expectation <span class="math inline">\(E[\widehat{\rho}]=\rho\)</span>, when we average ovr the estimate from multiple individuals.</p>

</div>
</div>
</div>
</div>
<div id="inequality-models" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Inequality Models<a href="mathematics.html#inequality-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div id="gini-discrete-sample" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> GINI Discrete Sample<a href="mathematics.html#gini-discrete-sample" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<p>This works out how the <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> function works from <a href="https://fanwangecon.github.io/">Fan</a>’s <em><a href="https://fanwangecon.github.io/REconTools/">REconTools</a></em> Package.</p>
<div id="gini-formula-for-discrete-sample" class="section level4 hasAnchor" number="8.3.1.1">
<h4><span class="header-section-number">8.3.1.1</span> GINI Formula for Discrete Sample<a href="mathematics.html#gini-formula-for-discrete-sample" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is an vector values (all positive). This could be height information for N individuals. It could also be income information for N individuals. Calculate the <a href="https://en.wikipedia.org/wiki/Gini_coefficient">GINI</a> coefficient treating the given vector as population. This is not an estimation exercise where we want to estimate population GINI based on a sample. The given array is the population. The population is discrete, and only has these N individuals in the length n vector.</p>
<p>Note that when the sample size is small, there is a limit to inequality using the formula defined below given each <span class="math inline">\(N\)</span>. So for small <span class="math inline">\(N\)</span>, can not really compare inequality across arrays with different <span class="math inline">\(N\)</span>, can only compare arrays with the same <span class="math inline">\(N\)</span>.</p>
<p>The GINI formula used here is:
<span class="math display">\[
GINI =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p>Derive the formula in the steps below.</p>
<p><em>Step 1 Area Formula</em></p>
<p><span class="math display">\[
\Gamma = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{x_j}{\sum_{\widehat{j}=1}^N x_{\widehat{j}} }
      \right)
  \right)
\]</span></p>
<p><em>Step 2 Total Area Given Perfect equality</em></p>
<p>With perfect equality <span class="math inline">\(x_i=a\)</span> for all <span class="math inline">\(i\)</span>, so need to divide by that.</p>
<p><span class="math display">\[
\Gamma^{\text{equal}} = \sum_{i=1}^N \frac{1}{N} \cdot \left(
     \sum_{j=1}^{i} \left(
      \frac{a}{\sum_{\widehat{j}=1}^N a }
      \right)
  \right)
  = \frac{N+1}{N}\cdot\frac{1}{2}
\]</span></p>
<p>As the number of elements of the vecotr increases:
<span class="math display">\[
\lim_{N \rightarrow \infty}\Gamma^{\text{equal}}
  = \lim_{N \rightarrow \infty} \frac{N+1}{N}\cdot\frac{1}{2}
  = \frac{1}{2}
\]</span></p>
<p><em>Step 3 Arriving at Finite Vector GINI Formula</em></p>
<p>Given what we have from above, we obtain the GINI formula, divide by total area below 45 degree line.</p>
<p><span class="math display">\[
GINI =
  1 -
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    N \cdot \sum_{i=1}^N x_i
  \right)^{-1}
  \cdot
  \left( \frac{N+1}{N}\cdot\frac{1}{2} \right)^{-1}
  =
  1 - \frac{2}{N+1}
  \cdot
  \left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)
  \cdot
  \left(
    \sum_{i=1}^N x_i
  \right)^{-1}
\]</span></p>
<p><em>Step 4 Maximum Inequality given N</em></p>
<p>Suppose <span class="math inline">\(x_i=0\)</span> for all <span class="math inline">\(i&lt;N\)</span>, then:</p>
<p><span class="math display">\[
GINI^{x_i = 0 \text{ except } i=N}
=
  1 - \frac{2}{N+1}
  \cdot
  X_N
  \cdot
  \left(
    X_N
  \right)^{-1}
=
1 - \frac{2}{N+1}
\]</span></p>
<p><span class="math display">\[
\lim_{N \rightarrow \infty} GINI^{x_i = 0 \text{ except } i=N}
=
1 -
\lim_{N \rightarrow \infty}
\frac{2}{N+1}
= 1
\]</span></p>
<p>Note that for small N, for example if <span class="math inline">\(N=10\)</span>, even when one person holds all income, all others have 0 income, the formula will not produce GINI is zero, but that GINI is equal to <span class="math inline">\(\frac{2}{11}\approx 0.1818\)</span>. If <span class="math inline">\(N=2\)</span>, inequality is at most, <span class="math inline">\(\frac{2}{3}\approx 0.667\)</span>.</p>
<p><span class="math display">\[
MostUnequalGINI\left(N\right) = 1 - \frac{2}{N+1} = \frac{N-1}{N+1}
\]</span></p>
<div id="implement-gini-formula-for-discrete-sample" class="section level5 hasAnchor" number="8.3.1.1.1">
<h5><span class="header-section-number">8.3.1.1.1</span> Implement GINI Formula for Discrete Sample<a href="mathematics.html#implement-gini-formula-for-discrete-sample" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The <strong>GINI</strong> formula just derived is trivial to compute.</p>
<ol style="list-style-type: decimal">
<li>scalar: <span class="math inline">\(\frac{2}{N+1}\)</span></li>
<li>cumsum: <span class="math inline">\(\sum_{j=1}^{i} x_j\)</span></li>
<li>sum of cumsum: <span class="math inline">\(\left(\sum_{i=1}^N \sum_{j=1}^{i} x_j\right)\)</span></li>
<li>sum: <span class="math inline">\(\sum_{i=1}^N X_i\)</span></li>
</ol>
<p>There are no package dependencies. Define the formula here:</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="mathematics.html#cb712-1" tabindex="-1"></a><span class="co"># Formula, directly implement the GINI formula Following Step 4 above</span></span>
<span id="cb712-2"><a href="mathematics.html#cb712-2" tabindex="-1"></a>ffi_dist_gini_vector_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_pos) {</span>
<span id="cb712-3"><a href="mathematics.html#cb712-3" tabindex="-1"></a>  <span class="co"># Check length and given warning</span></span>
<span id="cb712-4"><a href="mathematics.html#cb712-4" tabindex="-1"></a>  it_n <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_pos)</span>
<span id="cb712-5"><a href="mathematics.html#cb712-5" tabindex="-1"></a>  <span class="cf">if</span> (it_n <span class="sc">&lt;=</span> <span class="dv">100</span>)  <span class="fu">warning</span>(<span class="st">&#39;Data vector has n=&#39;</span>,it_n,<span class="st">&#39;, max-inequality/max-gini=&#39;</span>,(it_n<span class="dv">-1</span>)<span class="sc">/</span>(it_n <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb712-6"><a href="mathematics.html#cb712-6" tabindex="-1"></a>  <span class="co"># Sort</span></span>
<span id="cb712-7"><a href="mathematics.html#cb712-7" tabindex="-1"></a>  ar_pos <span class="ot">&lt;-</span> <span class="fu">sort</span>(ar_pos)</span>
<span id="cb712-8"><a href="mathematics.html#cb712-8" tabindex="-1"></a>  <span class="co"># formula implement</span></span>
<span id="cb712-9"><a href="mathematics.html#cb712-9" tabindex="-1"></a>  fl_gini <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="dv">2</span><span class="sc">/</span>(it_n<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_pos))<span class="sc">*</span>(<span class="fu">sum</span>(ar_pos))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb712-10"><a href="mathematics.html#cb712-10" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini)</span>
<span id="cb712-11"><a href="mathematics.html#cb712-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Generate a number of examples Arrays for testing</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="mathematics.html#cb713-1" tabindex="-1"></a><span class="co"># Example Arrays of data</span></span>
<span id="cb713-2"><a href="mathematics.html#cb713-2" tabindex="-1"></a>ar_equal_n1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>)</span>
<span id="cb713-3"><a href="mathematics.html#cb713-3" tabindex="-1"></a>ar_ineql_n1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>)</span>
<span id="cb713-4"><a href="mathematics.html#cb713-4" tabindex="-1"></a></span>
<span id="cb713-5"><a href="mathematics.html#cb713-5" tabindex="-1"></a>ar_equal_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb713-6"><a href="mathematics.html#cb713-6" tabindex="-1"></a>ar_ineql_alittle_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb713-7"><a href="mathematics.html#cb713-7" tabindex="-1"></a>ar_ineql_somewht_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb713-8"><a href="mathematics.html#cb713-8" tabindex="-1"></a>ar_ineql_alotine_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb713-9"><a href="mathematics.html#cb713-9" tabindex="-1"></a>ar_ineql_veryvry_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">8</span>)</span>
<span id="cb713-10"><a href="mathematics.html#cb713-10" tabindex="-1"></a>ar_ineql_mostmst_n2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">13</span>)</span>
<span id="cb713-11"><a href="mathematics.html#cb713-11" tabindex="-1"></a></span>
<span id="cb713-12"><a href="mathematics.html#cb713-12" tabindex="-1"></a>ar_equal_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb713-13"><a href="mathematics.html#cb713-13" tabindex="-1"></a>ar_ineql_some_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">21</span>,<span class="dv">34</span>,<span class="dv">55</span>,<span class="dv">89</span>)</span>
<span id="cb713-14"><a href="mathematics.html#cb713-14" tabindex="-1"></a>ar_ineql_very_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">8</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">13</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">21</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">34</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">55</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">89</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb713-15"><a href="mathematics.html#cb713-15" tabindex="-1"></a>ar_ineql_extr_n10 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">3</span><span class="sc">^</span><span class="dv">3</span>,<span class="dv">5</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">^</span><span class="dv">5</span>,<span class="dv">13</span><span class="sc">^</span><span class="dv">6</span>,<span class="dv">21</span><span class="sc">^</span><span class="dv">7</span>,<span class="dv">34</span><span class="sc">^</span><span class="dv">8</span>,<span class="dv">55</span><span class="sc">^</span><span class="dv">9</span>,<span class="dv">89</span><span class="sc">^</span><span class="dv">10</span>)</span></code></pre></div>
<p>Now test the example arrays above using the function based no our formula:</p>
<pre><code>## 
## Small N=1 Hard-Code</code></pre>
<pre><code>## ar_equal_n1: 0</code></pre>
<pre><code>## ar_ineql_n1: 0</code></pre>
<pre><code>## 
## Small N=2 Hard-Code, converge to 1/3, see formula above</code></pre>
<pre><code>## ar_ineql_alittle_n2: 0.1111111</code></pre>
<pre><code>## ar_ineql_somewht_n2: 0.2592593</code></pre>
<pre><code>## ar_ineql_alotine_n2: 0.3131313</code></pre>
<pre><code>## ar_ineql_veryvry_n2: 0.3307393</code></pre>
<pre><code>## 
## Small N=10 Hard-Code, convege to 9/11=0.8181, see formula above</code></pre>
<pre><code>## ar_equal_n10: 0</code></pre>
<pre><code>## ar_ineql_some_n10: 0.5395514</code></pre>
<pre><code>## ar_ineql_very_n10: 0.7059554</code></pre>
<pre><code>## ar_ineql_extr_n10: 0.8181549</code></pre>
</div>
</div>
</div>
<div id="gini-formula-for-discrete-random-varialbe" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> GINI Formula for Discrete Random Varialbe<a href="mathematics.html#gini-formula-for-discrete-random-varialbe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a discrete random variable, we are two arrays, an array of <span class="math inline">\(x\)</span> values, and an array of <span class="math inline">\(f(x)\)</span> probability mass at each <span class="math inline">\(x\)</span> value. Suppose the <span class="math inline">\(x\)</span> values are unique/non-repeating. This is also Implemented in <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> with the <a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/stats/ff_disc_rand_var_gini.m">ff_disc_rand_var_gini</a> function.</p>
<p>Generate two arrays for <span class="math inline">\(x\)</span> and <span class="math inline">\(f(x)\)</span>, we will use the <a href="https://fanwangecon.github.io/Stat4Econ/probability_discrete/htmlpdfr/binomial.html">binomial distribution</a>:</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="mathematics.html#cb727-1" tabindex="-1"></a>ar_choice_unique_sorted <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb727-2"><a href="mathematics.html#cb727-2" tabindex="-1"></a>ar_choice_prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_choice_unique_sorted, <span class="dv">100</span>, <span class="fl">0.01</span>)</span></code></pre></div>
<p>Generate mean and cumulative mean at each point:</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="mathematics.html#cb728-1" tabindex="-1"></a><span class="co"># 1. to normalize, get mean (binomial so mean is p*N=50)</span></span>
<span id="cb728-2"><a href="mathematics.html#cb728-2" tabindex="-1"></a>fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_unique_sorted<span class="sc">*</span>ar_choice_prob);</span>
<span id="cb728-3"><a href="mathematics.html#cb728-3" tabindex="-1"></a><span class="co"># 2. get cumulative mean at each point</span></span>
<span id="cb728-4"><a href="mathematics.html#cb728-4" tabindex="-1"></a>ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_choice_unique_sorted<span class="sc">*</span>ar_choice_prob);</span></code></pre></div>
<p>Normalizing and area calculation, following the same principle as above:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="mathematics.html#cb729-1" tabindex="-1"></a><span class="co"># 3. Share of wealth (income etc) accounted for up to this sorted type</span></span>
<span id="cb729-2"><a href="mathematics.html#cb729-2" tabindex="-1"></a>ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb729-3"><a href="mathematics.html#cb729-3" tabindex="-1"></a><span class="co"># 4. The total area, is the each height times each width summed up</span></span>
<span id="cb729-4"><a href="mathematics.html#cb729-4" tabindex="-1"></a>fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_prob<span class="sc">*</span>ar_height);</span></code></pre></div>
<p>Finally GINI coefficient:</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="mathematics.html#cb730-1" tabindex="-1"></a><span class="co"># 5. area below 45 degree line might not be 1/2, depends on discretness</span></span>
<span id="cb730-2"><a href="mathematics.html#cb730-2" tabindex="-1"></a>fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_choice_prob<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_choice_prob)<span class="sc">/</span><span class="fu">sum</span>(ar_choice_prob)))</span>
<span id="cb730-3"><a href="mathematics.html#cb730-3" tabindex="-1"></a></span>
<span id="cb730-4"><a href="mathematics.html#cb730-4" tabindex="-1"></a><span class="co"># 6. Gini is the distance between</span></span>
<span id="cb730-5"><a href="mathematics.html#cb730-5" tabindex="-1"></a>fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb730-6"><a href="mathematics.html#cb730-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;fl_gini_index=&#39;</span>, fl_gini_index))</span></code></pre></div>
<pre><code>## [1] &quot;fl_gini_index=0.468573066002754&quot;</code></pre>
<div id="discrete-random-variable-as-function" class="section level4 hasAnchor" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Discrete Random Variable as Function<a href="mathematics.html#discrete-random-variable-as-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Organizing the code above as a function, and testing results out with the <a href="https://fanwangecon.github.io/Stat4Econ/probability_discrete/htmlpdfr/binomial.html">binomial distribution</a> as an example.</p>
<p>For the binomial distribution, if the probability of success is very close to zero, that means nearly all mass is at lose all or nearly losing all. There will be non-zero but very small mass at higher levels of wins. Hence this should mean extreme inequality. GINI index should be close to 1. Alternatively, GINI index should be close to 0 when we have near 100 percent chance of success, then all mass is at winning all, perfect equality.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="mathematics.html#cb732-1" tabindex="-1"></a><span class="co"># Combining the code from above</span></span>
<span id="cb732-2"><a href="mathematics.html#cb732-2" tabindex="-1"></a>ffi_dist_gini_random_var_pos_test <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_x_sorted, ar_prob_of_x) {</span>
<span id="cb732-3"><a href="mathematics.html#cb732-3" tabindex="-1"></a>  <span class="co">#&#39; @param ar_x_sorted sorted array of values</span></span>
<span id="cb732-4"><a href="mathematics.html#cb732-4" tabindex="-1"></a>  <span class="co">#&#39; @param ar_prob_of_x probability mass for each element along `ar_x_sorted`, sums to 1</span></span>
<span id="cb732-5"><a href="mathematics.html#cb732-5" tabindex="-1"></a></span>
<span id="cb732-6"><a href="mathematics.html#cb732-6" tabindex="-1"></a>  <span class="co"># 1. to normalize, get mean (binomial so mean is p*N=50)</span></span>
<span id="cb732-7"><a href="mathematics.html#cb732-7" tabindex="-1"></a>  fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb732-8"><a href="mathematics.html#cb732-8" tabindex="-1"></a>  <span class="co"># 2. get cumulative mean at each point</span></span>
<span id="cb732-9"><a href="mathematics.html#cb732-9" tabindex="-1"></a>  ar_mean_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(ar_x_sorted<span class="sc">*</span>ar_prob_of_x);</span>
<span id="cb732-10"><a href="mathematics.html#cb732-10" tabindex="-1"></a>  <span class="co"># 3. Share of wealth (income etc) accounted for up to this sorted type</span></span>
<span id="cb732-11"><a href="mathematics.html#cb732-11" tabindex="-1"></a>  ar_height <span class="ot">&lt;-</span> ar_mean_cumsum<span class="sc">/</span>fl_mean;</span>
<span id="cb732-12"><a href="mathematics.html#cb732-12" tabindex="-1"></a>  <span class="co"># 4. The total area, is the each height times each width summed up</span></span>
<span id="cb732-13"><a href="mathematics.html#cb732-13" tabindex="-1"></a>  fl_area_drm <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>ar_height);</span>
<span id="cb732-14"><a href="mathematics.html#cb732-14" tabindex="-1"></a>  <span class="co"># 5. area below 45 degree line might not be 1/2, depends on discretness</span></span>
<span id="cb732-15"><a href="mathematics.html#cb732-15" tabindex="-1"></a>  fl_area_below45 <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_prob_of_x<span class="sc">*</span>(<span class="fu">cumsum</span>(ar_prob_of_x)<span class="sc">/</span><span class="fu">sum</span>(ar_prob_of_x)))</span>
<span id="cb732-16"><a href="mathematics.html#cb732-16" tabindex="-1"></a>  <span class="co"># 6. Gini is the distance between</span></span>
<span id="cb732-17"><a href="mathematics.html#cb732-17" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> (fl_area_below45<span class="sc">-</span>fl_area_drm)<span class="sc">/</span>fl_area_below45</span>
<span id="cb732-18"><a href="mathematics.html#cb732-18" tabindex="-1"></a></span>
<span id="cb732-19"><a href="mathematics.html#cb732-19" tabindex="-1"></a>  <span class="fu">return</span>(fl_gini_index)</span>
<span id="cb732-20"><a href="mathematics.html#cb732-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Testing the function with the Binomial Distribution:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="mathematics.html#cb733-1" tabindex="-1"></a><span class="cf">for</span> (fl_binom_success_prob <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.0001</span>,<span class="fl">0.9999</span>,<span class="at">length.out=</span><span class="dv">10</span>)) {</span>
<span id="cb733-2"><a href="mathematics.html#cb733-2" tabindex="-1"></a>  ar_x_sorted <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb733-3"><a href="mathematics.html#cb733-3" tabindex="-1"></a>  ar_prob_of_x <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_x_sorted, <span class="dv">100</span>, fl_binom_success_prob)</span>
<span id="cb733-4"><a href="mathematics.html#cb733-4" tabindex="-1"></a>  fl_gini_index <span class="ot">&lt;-</span> <span class="fu">ffi_dist_gini_random_var_pos_test</span>(ar_x_sorted, ar_prob_of_x)</span>
<span id="cb733-5"><a href="mathematics.html#cb733-5" tabindex="-1"></a>  st_print <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;binom p(success)=&#39;</span>, fl_binom_success_prob ,</span>
<span id="cb733-6"><a href="mathematics.html#cb733-6" tabindex="-1"></a>                   <span class="st">&#39;, the fl_gini_index=&#39;</span>, fl_gini_index)</span>
<span id="cb733-7"><a href="mathematics.html#cb733-7" tabindex="-1"></a>  <span class="fu">print</span>(st_print)</span>
<span id="cb733-8"><a href="mathematics.html#cb733-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;binom p(success)=1e-04, the fl_gini_index=0.990048846889393&quot;
## [1] &quot;binom p(success)=0.111188888888889, the fl_gini_index=0.147061101509638&quot;
## [1] &quot;binom p(success)=0.222277777777778, the fl_gini_index=0.0989942681255604&quot;
## [1] &quot;binom p(success)=0.333366666666667, the fl_gini_index=0.0753059593394789&quot;
## [1] &quot;binom p(success)=0.444455555555556, the fl_gini_index=0.0596495299535176&quot;
## [1] &quot;binom p(success)=0.555544444444444, the fl_gini_index=0.0476678493269222&quot;
## [1] &quot;binom p(success)=0.666633333333333, the fl_gini_index=0.0375168214334586&quot;
## [1] &quot;binom p(success)=0.777722222222222, the fl_gini_index=0.0280646430085938&quot;
## [1] &quot;binom p(success)=0.888811111111111, the fl_gini_index=0.0180312757603542&quot;
## [1] &quot;binom p(success)=0.9999, the fl_gini_index=9.90197372312816e-07&quot;</code></pre>
</div>
<div id="compare-discrete-sample-and-discrete-random-variable-functions-for-gini" class="section level4 hasAnchor" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Compare Discrete Sample and Discrete Random Variable Functions for GINI<a href="mathematics.html#compare-discrete-sample-and-discrete-random-variable-functions-for-gini" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> provides the GINI implementation for a discrete random variable. The procedure is the same as prior, except now each element of the “x” array has element specific weights associated with it. The function can handle unsorted array with non-unique values.</p>
<p>Test and compare <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> provides the GINI implementation for a discrete random variable and <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a>.</p>
<p>There is a vector of values from 1 to 100, in ascending order. What is the equal-weighted gini, the gini result when smaller numbers have higher weights, and when larger numbers have higher weights?</p>
<p>First, generate the relevant values.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="mathematics.html#cb735-1" tabindex="-1"></a><span class="co"># array</span></span>
<span id="cb735-2"><a href="mathematics.html#cb735-2" tabindex="-1"></a>ar_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">30</span>)</span>
<span id="cb735-3"><a href="mathematics.html#cb735-3" tabindex="-1"></a><span class="co"># prob array</span></span>
<span id="cb735-4"><a href="mathematics.html#cb735-4" tabindex="-1"></a>ar_prob_x_unif <span class="ot">&lt;-</span> <span class="fu">rep.int</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_x))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">rep.int</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_x)))</span>
<span id="cb735-5"><a href="mathematics.html#cb735-5" tabindex="-1"></a><span class="co"># prob higher at lower values</span></span>
<span id="cb735-6"><a href="mathematics.html#cb735-6" tabindex="-1"></a>ar_prob_x_lowval_highwgt <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))</span>
<span id="cb735-7"><a href="mathematics.html#cb735-7" tabindex="-1"></a><span class="co"># prob higher at lower values</span></span>
<span id="cb735-8"><a href="mathematics.html#cb735-8" tabindex="-1"></a>ar_prob_x_highval_highwgt <span class="ot">&lt;-</span> (<span class="fu">cumsum</span>(ar_prob_x_unif))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">cumsum</span>(ar_prob_x_unif))</span>
<span id="cb735-9"><a href="mathematics.html#cb735-9" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb735-10"><a href="mathematics.html#cb735-10" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">cbind</span>(ar_x, ar_prob_x_unif, ar_prob_x_lowval_highwgt, ar_prob_x_highval_highwgt)) <span class="sc">%&gt;%</span></span>
<span id="cb735-11"><a href="mathematics.html#cb735-11" tabindex="-1"></a>  <span class="fu">kable_styling_fc</span>()</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_x
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_unif
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_lowval_highwgt
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ar_prob_x_highval_highwgt
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0645161
</td>
<td style="text-align:right;">
0.0021505
</td>
</tr>
<tr>
<td style="text-align:right;">
4.413793
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0623656
</td>
<td style="text-align:right;">
0.0043011
</td>
</tr>
<tr>
<td style="text-align:right;">
7.827586
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0602151
</td>
<td style="text-align:right;">
0.0064516
</td>
</tr>
<tr>
<td style="text-align:right;">
11.241379
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0580645
</td>
<td style="text-align:right;">
0.0086022
</td>
</tr>
<tr>
<td style="text-align:right;">
14.655172
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0559140
</td>
<td style="text-align:right;">
0.0107527
</td>
</tr>
<tr>
<td style="text-align:right;">
18.068966
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0537634
</td>
<td style="text-align:right;">
0.0129032
</td>
</tr>
<tr>
<td style="text-align:right;">
21.482759
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0516129
</td>
<td style="text-align:right;">
0.0150538
</td>
</tr>
<tr>
<td style="text-align:right;">
24.896552
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0494624
</td>
<td style="text-align:right;">
0.0172043
</td>
</tr>
<tr>
<td style="text-align:right;">
28.310345
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0473118
</td>
<td style="text-align:right;">
0.0193548
</td>
</tr>
<tr>
<td style="text-align:right;">
31.724138
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0451613
</td>
<td style="text-align:right;">
0.0215054
</td>
</tr>
<tr>
<td style="text-align:right;">
35.137931
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0430108
</td>
<td style="text-align:right;">
0.0236559
</td>
</tr>
<tr>
<td style="text-align:right;">
38.551724
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0408602
</td>
<td style="text-align:right;">
0.0258065
</td>
</tr>
<tr>
<td style="text-align:right;">
41.965517
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0387097
</td>
<td style="text-align:right;">
0.0279570
</td>
</tr>
<tr>
<td style="text-align:right;">
45.379310
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0365591
</td>
<td style="text-align:right;">
0.0301075
</td>
</tr>
<tr>
<td style="text-align:right;">
48.793103
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0344086
</td>
<td style="text-align:right;">
0.0322581
</td>
</tr>
<tr>
<td style="text-align:right;">
52.206897
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0322581
</td>
<td style="text-align:right;">
0.0344086
</td>
</tr>
<tr>
<td style="text-align:right;">
55.620690
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0301075
</td>
<td style="text-align:right;">
0.0365591
</td>
</tr>
<tr>
<td style="text-align:right;">
59.034483
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0279570
</td>
<td style="text-align:right;">
0.0387097
</td>
</tr>
<tr>
<td style="text-align:right;">
62.448276
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0258065
</td>
<td style="text-align:right;">
0.0408602
</td>
</tr>
<tr>
<td style="text-align:right;">
65.862069
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0236559
</td>
<td style="text-align:right;">
0.0430108
</td>
</tr>
<tr>
<td style="text-align:right;">
69.275862
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0215054
</td>
<td style="text-align:right;">
0.0451613
</td>
</tr>
<tr>
<td style="text-align:right;">
72.689655
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0193548
</td>
<td style="text-align:right;">
0.0473118
</td>
</tr>
<tr>
<td style="text-align:right;">
76.103448
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0172043
</td>
<td style="text-align:right;">
0.0494624
</td>
</tr>
<tr>
<td style="text-align:right;">
79.517241
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0150538
</td>
<td style="text-align:right;">
0.0516129
</td>
</tr>
<tr>
<td style="text-align:right;">
82.931034
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0129032
</td>
<td style="text-align:right;">
0.0537634
</td>
</tr>
<tr>
<td style="text-align:right;">
86.344828
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0107527
</td>
<td style="text-align:right;">
0.0559140
</td>
</tr>
<tr>
<td style="text-align:right;">
89.758621
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0086022
</td>
<td style="text-align:right;">
0.0580645
</td>
</tr>
<tr>
<td style="text-align:right;">
93.172414
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0064516
</td>
<td style="text-align:right;">
0.0602151
</td>
</tr>
<tr>
<td style="text-align:right;">
96.586207
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0043011
</td>
<td style="text-align:right;">
0.0623656
</td>
</tr>
<tr>
<td style="text-align:right;">
100.000000
</td>
<td style="text-align:right;">
0.0333333
</td>
<td style="text-align:right;">
0.0021505
</td>
<td style="text-align:right;">
0.0645161
</td>
</tr>
</tbody>
</table>
<p>Second, generate GINI values. What should happen?</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_random_var.html">ff_dist_gini_random_var</a> and <a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html">ff_dist_gini_vector_pos</a> results should be the same when the uniform distribution is used.</li>
<li>GINI should be higher, more inequality, if there is higher weights on the lower values.</li>
<li>GINI should be lower, more equality, if there is higher weight on the higher values.</li>
</ol>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="mathematics.html#cb736-1" tabindex="-1"></a><span class="fu">ff_dist_gini_vector_pos</span>(ar_x)</span></code></pre></div>
<pre><code>## [1] 0.3267327</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="mathematics.html#cb738-1" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_unif)</span></code></pre></div>
<pre><code>## [1] 0.3267327</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="mathematics.html#cb740-1" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_lowval_highwgt)</span></code></pre></div>
<pre><code>## [1] 0.4010343</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="mathematics.html#cb742-1" tabindex="-1"></a><span class="fu">ff_dist_gini_random_var</span>(ar_x, ar_prob_x_highval_highwgt)</span></code></pre></div>
<pre><code>## [1] 0.1926849</code></pre>

</div>
</div>
<div id="atkinson-inequality-index" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Atkinson Inequality Index<a href="mathematics.html#atkinson-inequality-index" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/REconTools/">REconTools</a> research support package, <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a> examples page, <a href="https://fanwangecon.github.io/PkgTestR/">PkgTestR</a> packaging guide, or <a href="https://fanwangecon.github.io/Stat4Econ/">Stat4Econ</a> course page.</p>
</blockquote>
<div id="atkinson-inequality-measures" class="section level4 hasAnchor" number="8.3.3.1">
<h4><span class="header-section-number">8.3.3.1</span> Atkinson Inequality Measures<a href="mathematics.html#atkinson-inequality-measures" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://linkinghub.elsevier.com/retrieve/pii/0022053170900396">Atkinson (JET, 1970)</a> studies five standard inequality measures. Atkinson finds that given the same income data across countries, different inequality measure lead to different rankings of which country is more unequal. Atkinson develops an measure of inequality that changes depending on an inequality aversion parameter.</p>
<p><span class="math display">\[
\text{Atkinson Inequality} =
A\left(
\left\{Y_i\right\}_{i=1}^N,
\lambda
\right)
= 1 -
\left(
\sum_{i=1}^N \frac{1}{N}
  \left(
    \frac{Y_i}{\sum_{j=1}^N \left( \frac{Y_j}{N} \right) }
  \right)^{\lambda}
\right)^{\frac{1}{\lambda}}
\in \left[0,1\right]
\]</span></p>
<p><span class="math inline">\(A\left(\left\{Y_i\right\}_{i=1}^N,\lambda\right)\)</span> equals to zero is perfect equality. 1 is Perfect inequality. If <span class="math inline">\(\lambda=1\)</span>, the inequality measure is always equal to 0 because the planner does not care abouot inequality anymore.</p>
</div>
<div id="atkinson-inequality-function" class="section level4 hasAnchor" number="8.3.3.2">
<h4><span class="header-section-number">8.3.3.2</span> Atkinson Inequality Function<a href="mathematics.html#atkinson-inequality-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Programming up the equation above, we have, given a sample of data:</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="mathematics.html#cb744-1" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb744-2"><a href="mathematics.html#cb744-2" tabindex="-1"></a>ffi_atkinson_ineq <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_data, fl_rho) {</span>
<span id="cb744-3"><a href="mathematics.html#cb744-3" tabindex="-1"></a>  ar_data_demean <span class="ot">&lt;-</span> ar_data<span class="sc">/</span><span class="fu">mean</span>(ar_data)</span>
<span id="cb744-4"><a href="mathematics.html#cb744-4" tabindex="-1"></a>  it_len <span class="ot">&lt;-</span> <span class="fu">length</span>(ar_data_demean)</span>
<span id="cb744-5"><a href="mathematics.html#cb744-5" tabindex="-1"></a>  fl_atkinson <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(ar_data_demean<span class="sc">^</span>{fl_rho}<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>it_len))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>fl_rho)</span>
<span id="cb744-6"><a href="mathematics.html#cb744-6" tabindex="-1"></a>  <span class="fu">return</span>(fl_atkinson)</span>
<span id="cb744-7"><a href="mathematics.html#cb744-7" tabindex="-1"></a>}</span></code></pre></div>
<p>When each element of the data array has weight, we have:</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="mathematics.html#cb745-1" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb745-2"><a href="mathematics.html#cb745-2" tabindex="-1"></a>ffi_atkinson_random_var_ineq <span class="ot">&lt;-</span> <span class="cf">function</span>(ar_data, ar_prob_data, fl_rho) {</span>
<span id="cb745-3"><a href="mathematics.html#cb745-3" tabindex="-1"></a>  <span class="co">#&#39; @param ar_data array sorted array values</span></span>
<span id="cb745-4"><a href="mathematics.html#cb745-4" tabindex="-1"></a>  <span class="co">#&#39; @param ar_prob_data array probability mass for each element along `ar_data`, sums to 1</span></span>
<span id="cb745-5"><a href="mathematics.html#cb745-5" tabindex="-1"></a>  <span class="co">#&#39; @param fl_rho float inequality aversion parameter fl_rho = 1 for planner</span></span>
<span id="cb745-6"><a href="mathematics.html#cb745-6" tabindex="-1"></a>  <span class="co">#&#39; without inequality aversion. fl_rho = -infinity for fully inequality averse.</span></span>
<span id="cb745-7"><a href="mathematics.html#cb745-7" tabindex="-1"></a></span>
<span id="cb745-8"><a href="mathematics.html#cb745-8" tabindex="-1"></a>  fl_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(ar_data<span class="sc">*</span>ar_prob_data);</span>
<span id="cb745-9"><a href="mathematics.html#cb745-9" tabindex="-1"></a>  fl_atkinson <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="fu">sum</span>(ar_prob_data<span class="sc">*</span>(ar_data<span class="sc">^</span>{fl_rho}))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>fl_rho))<span class="sc">/</span>fl_mean</span>
<span id="cb745-10"><a href="mathematics.html#cb745-10" tabindex="-1"></a>  <span class="fu">return</span>(fl_atkinson)</span>
<span id="cb745-11"><a href="mathematics.html#cb745-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="atkinson-inequality-examples" class="section level4 hasAnchor" number="8.3.3.3">
<h4><span class="header-section-number">8.3.3.3</span> Atkinson Inequality Examples<a href="mathematics.html#atkinson-inequality-examples" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given a vector of observables, compute the Atkinson inequality measure given different inequality aversion.</p>
<div id="data-samples-and-weighted-data" class="section level5 hasAnchor" number="8.3.3.3.1">
<h5><span class="header-section-number">8.3.3.3.1</span> Data Samples and Weighted Data<a href="mathematics.html#data-samples-and-weighted-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The <span class="math inline">\(\rho\)</span> preference vector.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="mathematics.html#cb746-1" tabindex="-1"></a><span class="co"># Preference Vector</span></span>
<span id="cb746-2"><a href="mathematics.html#cb746-2" tabindex="-1"></a>ar_rho <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.0</span>,<span class="fl">2.0</span>, <span class="at">length.out=</span><span class="dv">30</span>))))</span>
<span id="cb746-3"><a href="mathematics.html#cb746-3" tabindex="-1"></a>ar_rho <span class="ot">&lt;-</span> <span class="fu">unique</span>(ar_rho)</span>
<span id="cb746-4"><a href="mathematics.html#cb746-4" tabindex="-1"></a>mt_rho <span class="ot">&lt;-</span> <span class="fu">matrix</span>(ar_rho, <span class="at">nrow=</span><span class="fu">length</span>(ar_rho), <span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p>Sampled version for <span class="math inline">\(N\)</span> sampled points, random, uniform and one-rich.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="mathematics.html#cb747-1" tabindex="-1"></a><span class="co"># Random normal Data Vector (not equal outcomes)</span></span>
<span id="cb747-2"><a href="mathematics.html#cb747-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb747-3"><a href="mathematics.html#cb747-3" tabindex="-1"></a>it_sample_N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb747-4"><a href="mathematics.html#cb747-4" tabindex="-1"></a>fl_rnorm_mean <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb747-5"><a href="mathematics.html#cb747-5" tabindex="-1"></a>fl_rnorm_sd <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb747-6"><a href="mathematics.html#cb747-6" tabindex="-1"></a>ar_data_rnorm <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(it_sample_N, <span class="at">mean=</span>fl_rnorm_mean, <span class="at">sd=</span>fl_rnorm_sd)</span>
<span id="cb747-7"><a href="mathematics.html#cb747-7" tabindex="-1"></a><span class="co"># Uniform Data Vector (Equal)</span></span>
<span id="cb747-8"><a href="mathematics.html#cb747-8" tabindex="-1"></a>ar_data_unif <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(ar_data_rnorm))</span>
<span id="cb747-9"><a href="mathematics.html#cb747-9" tabindex="-1"></a></span>
<span id="cb747-10"><a href="mathematics.html#cb747-10" tabindex="-1"></a><span class="co"># One Rich (last person has income equal to the sum of all others*100)</span></span>
<span id="cb747-11"><a href="mathematics.html#cb747-11" tabindex="-1"></a>ar_data_onerich <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="fu">length</span>(ar_data_rnorm))</span>
<span id="cb747-12"><a href="mathematics.html#cb747-12" tabindex="-1"></a>ar_data_onerich[<span class="fu">length</span>(ar_data_onerich)] <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">head</span>(ar_data_onerich,<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<p>Given the same distributions, random, uniform and one-rich, generate discrete random variable versions below. We approximate <a href="https://fanwangecon.github.io/R4Econ/statistics/discrandvar/htmlpdfr/fs_disc_approx_cts.html">continuous normal with discrete binomial</a>:</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="mathematics.html#cb748-1" tabindex="-1"></a><span class="co"># Use binomial to approximate normal</span></span>
<span id="cb748-2"><a href="mathematics.html#cb748-2" tabindex="-1"></a>fl_p_binom <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>fl_rnorm_mean</span>
<span id="cb748-3"><a href="mathematics.html#cb748-3" tabindex="-1"></a>fl_n_binom <span class="ot">&lt;-</span> <span class="fu">round</span>(fl_rnorm_mean<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(fl_rnorm_mean <span class="sc">-</span> fl_rnorm_sd<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb748-4"><a href="mathematics.html#cb748-4" tabindex="-1"></a>fl_binom_mean <span class="ot">&lt;-</span> fl_n_binom<span class="sc">*</span>fl_p_binom</span>
<span id="cb748-5"><a href="mathematics.html#cb748-5" tabindex="-1"></a>fl_binom_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(fl_n_binom<span class="sc">*</span>fl_p_binom<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>fl_p_binom))</span>
<span id="cb748-6"><a href="mathematics.html#cb748-6" tabindex="-1"></a><span class="co"># drv = discrete random variable</span></span>
<span id="cb748-7"><a href="mathematics.html#cb748-7" tabindex="-1"></a>ar_drv_rbinom_xval <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, fl_n_binom)</span>
<span id="cb748-8"><a href="mathematics.html#cb748-8" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(ar_drv_rbinom_xval, <span class="at">size=</span>fl_n_binom, <span class="at">prob=</span>fl_p_binom)</span>
<span id="cb748-9"><a href="mathematics.html#cb748-9" tabindex="-1"></a><span class="co"># ignore weight at x=0</span></span>
<span id="cb748-10"><a href="mathematics.html#cb748-10" tabindex="-1"></a>ar_drv_rbinom_prob <span class="ot">&lt;-</span> ar_drv_rbinom_prob<span class="sc">/</span><span class="fu">sum</span>(ar_drv_rbinom_prob)</span></code></pre></div>
<p>Additionally, for the one-rich vector created earlier, now consider several probability mass over them, change the weight assigned to the richest person.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="mathematics.html#cb749-1" tabindex="-1"></a><span class="co"># This should be the same as the unweighted version</span></span>
<span id="cb749-2"><a href="mathematics.html#cb749-2" tabindex="-1"></a>ar_drv_onerich_prob_unif <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>it_sample_N, it_sample_N)</span>
<span id="cb749-3"><a href="mathematics.html#cb749-3" tabindex="-1"></a><span class="co"># This puts almost no weight on the last rich person</span></span>
<span id="cb749-4"><a href="mathematics.html#cb749-4" tabindex="-1"></a><span class="co"># richlswgt = rich less weight</span></span>
<span id="cb749-5"><a href="mathematics.html#cb749-5" tabindex="-1"></a>ar_drv_onerich_prob_richlswgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_unif</span>
<span id="cb749-6"><a href="mathematics.html#cb749-6" tabindex="-1"></a>ar_drv_onerich_prob_richlswgt[it_sample_N] <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>it_sample_N)<span class="sc">*</span><span class="fl">0.1</span></span>
<span id="cb749-7"><a href="mathematics.html#cb749-7" tabindex="-1"></a>ar_drv_onerich_prob_richlswgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_richlswgt<span class="sc">/</span><span class="fu">sum</span>(ar_drv_onerich_prob_richlswgt)</span>
<span id="cb749-8"><a href="mathematics.html#cb749-8" tabindex="-1"></a><span class="co"># This puts more weight on the rich person</span></span>
<span id="cb749-9"><a href="mathematics.html#cb749-9" tabindex="-1"></a><span class="co"># richmrwgt = rich more weight</span></span>
<span id="cb749-10"><a href="mathematics.html#cb749-10" tabindex="-1"></a>ar_drv_onerich_prob_richmrwgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_unif</span>
<span id="cb749-11"><a href="mathematics.html#cb749-11" tabindex="-1"></a>ar_drv_onerich_prob_richmrwgt[it_sample_N] <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>it_sample_N)<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb749-12"><a href="mathematics.html#cb749-12" tabindex="-1"></a>ar_drv_onerich_prob_richmrwgt <span class="ot">&lt;-</span> ar_drv_onerich_prob_richmrwgt<span class="sc">/</span><span class="fu">sum</span>(ar_drv_onerich_prob_richmrwgt)</span></code></pre></div>
</div>
<div id="testing-atkinson-index-at-single-rho-value" class="section level5 hasAnchor" number="8.3.3.3.2">
<h5><span class="header-section-number">8.3.3.3.2</span> Testing Atkinson Index at Single rho Value<a href="mathematics.html#testing-atkinson-index-at-single-rho-value" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Atkinson index with <span class="math inline">\(\rho=-1\)</span>, which is a planner with some aversion towards inequality, this is equivalent to CRRA=2.</p>
<p>Testing with normal sample draw vs normal approximated with binomial discrete random variable:</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="mathematics.html#cb750-1" tabindex="-1"></a><span class="co"># ATK = 0.05372126</span></span>
<span id="cb750-2"><a href="mathematics.html#cb750-2" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_rnorm, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.00335581</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="mathematics.html#cb752-1" tabindex="-1"></a><span class="co"># ATK = 0.03443246</span></span>
<span id="cb752-2"><a href="mathematics.html#cb752-2" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_drv_rbinom_xval, ar_drv_rbinom_prob, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.003642523</code></pre>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="mathematics.html#cb754-1" tabindex="-1"></a><span class="co"># ATK = 0</span></span>
<span id="cb754-2"><a href="mathematics.html#cb754-2" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Testing with</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="mathematics.html#cb756-1" tabindex="-1"></a><span class="co"># ATK = 0.89, sample</span></span>
<span id="cb756-2"><a href="mathematics.html#cb756-2" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_onerich, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.9027248</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="mathematics.html#cb758-1" tabindex="-1"></a><span class="co"># ATK = 0.89, drv, uniform weight</span></span>
<span id="cb758-2"><a href="mathematics.html#cb758-2" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_data_onerich, ar_drv_onerich_prob_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.9027248</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="mathematics.html#cb760-1" tabindex="-1"></a><span class="co"># ATK = 0.49, drv, less weight on rich</span></span>
<span id="cb760-2"><a href="mathematics.html#cb760-2" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_data_onerich, ar_drv_onerich_prob_richlswgt, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.4965518</code></pre>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="mathematics.html#cb762-1" tabindex="-1"></a><span class="co"># ATK = 0.97, drv, more weight on rich</span></span>
<span id="cb762-2"><a href="mathematics.html#cb762-2" tabindex="-1"></a><span class="fu">ffi_atkinson_random_var_ineq</span>(ar_data_onerich, ar_drv_onerich_prob_richmrwgt, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.9821147</code></pre>
<p>Create vector of inequality aversion parameters and graph legends.</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="mathematics.html#cb764-1" tabindex="-1"></a>ar_log_1_minus_rho <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>ar_rho)</span>
<span id="cb764-2"><a href="mathematics.html#cb764-2" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;log(1-rho), rho is Planner</span><span class="sc">\&#39;</span><span class="st">s Inequality Aversion</span><span class="sc">\n</span><span class="st">Efficiency (rho=0.99, left); log utility (rho = 0, middle); Equality (rho=-99, right)&#39;</span></span>
<span id="cb764-3"><a href="mathematics.html#cb764-3" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;Index: 0 = Total Equality, 1 = Total Inequality&#39;</span></span></code></pre></div>
</div>
<div id="atkinson-inequality-and-normally-distributed-data" class="section level5 hasAnchor" number="8.3.3.3.3">
<h5><span class="header-section-number">8.3.3.3.3</span> Atkinson Inequality and Normally Distributed Data<a href="mathematics.html#atkinson-inequality-and-normally-distributed-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>How does Atkinson Inequality measure change with respect to a vector of normal random data as inequality aversion shifts? Note that in the example below, the bionomial approximated version is very similar to the normally drawn sample version. until rho beocmes very negative.</p>
<p>At very negative rho values, the binomial approximation has very tiny, but positive mass for all small values starting from 0, the normally drawn sample has no mass at those points. The Atkinson inequality planner increasingly only cares about the individual with the lowest value from the binomial approximated version, and given the low value of those individuals compared to others, despite having no mass, the inequality index is almost 1.</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="mathematics.html#cb765-1" tabindex="-1"></a>ar_ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb765-2"><a href="mathematics.html#cb765-2" tabindex="-1"></a><span class="co"># First line</span></span>
<span id="cb765-3"><a href="mathematics.html#cb765-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span>
<span id="cb765-4"><a href="mathematics.html#cb765-4" tabindex="-1"></a>ar_atkinson_sample <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){</span>
<span id="cb765-5"><a href="mathematics.html#cb765-5" tabindex="-1"></a>  <span class="fu">ffi_atkinson_ineq</span>(ar_data_rnorm, row[<span class="dv">1</span>])})</span>
<span id="cb765-6"><a href="mathematics.html#cb765-6" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_sample,</span>
<span id="cb765-7"><a href="mathematics.html#cb765-7" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb765-8"><a href="mathematics.html#cb765-8" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb765-9"><a href="mathematics.html#cb765-9" tabindex="-1"></a><span class="co"># Second line</span></span>
<span id="cb765-10"><a href="mathematics.html#cb765-10" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb765-11"><a href="mathematics.html#cb765-11" tabindex="-1"></a>ar_atkinson_drv <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){</span>
<span id="cb765-12"><a href="mathematics.html#cb765-12" tabindex="-1"></a>  <span class="fu">ffi_atkinson_random_var_ineq</span>(ar_drv_rbinom_xval, ar_drv_rbinom_prob, row[<span class="dv">1</span>])})</span>
<span id="cb765-13"><a href="mathematics.html#cb765-13" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv,</span>
<span id="cb765-14"><a href="mathematics.html#cb765-14" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb765-15"><a href="mathematics.html#cb765-15" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb765-16"><a href="mathematics.html#cb765-16" tabindex="-1"></a><span class="co"># Title</span></span>
<span id="cb765-17"><a href="mathematics.html#cb765-17" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;Atkinson Inequality and Random data&#39;</span>,</span>
<span id="cb765-18"><a href="mathematics.html#cb765-18" tabindex="-1"></a>      <span class="at">sub =</span> <span class="st">&#39;Red Line=sample, Blue Dots=discrete random variable&#39;</span>)</span>
<span id="cb765-19"><a href="mathematics.html#cb765-19" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-383-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="atkinson-inequality-with-an-extremely-wealthy-individual" class="section level5 hasAnchor" number="8.3.3.3.4">
<h5><span class="header-section-number">8.3.3.3.4</span> Atkinson Inequality with an Extremely Wealthy Individual<a href="mathematics.html#atkinson-inequality-with-an-extremely-wealthy-individual" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Now with the one person has the wealth of all others in the vector times 10.</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="mathematics.html#cb766-1" tabindex="-1"></a><span class="co"># First line</span></span>
<span id="cb766-2"><a href="mathematics.html#cb766-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span>
<span id="cb766-3"><a href="mathematics.html#cb766-3" tabindex="-1"></a>ar_atkinson <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_ineq</span>(</span>
<span id="cb766-4"><a href="mathematics.html#cb766-4" tabindex="-1"></a>  ar_data_onerich, row[<span class="dv">1</span>])})</span>
<span id="cb766-5"><a href="mathematics.html#cb766-5" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson,</span>
<span id="cb766-6"><a href="mathematics.html#cb766-6" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label,</span>
<span id="cb766-7"><a href="mathematics.html#cb766-7" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb766-8"><a href="mathematics.html#cb766-8" tabindex="-1"></a><span class="co"># Second line</span></span>
<span id="cb766-9"><a href="mathematics.html#cb766-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb766-10"><a href="mathematics.html#cb766-10" tabindex="-1"></a>ar_atkinson_drv <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_random_var_ineq</span>(</span>
<span id="cb766-11"><a href="mathematics.html#cb766-11" tabindex="-1"></a>  ar_data_onerich, ar_drv_onerich_prob_unif, row[<span class="dv">1</span>])})</span>
<span id="cb766-12"><a href="mathematics.html#cb766-12" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv,</span>
<span id="cb766-13"><a href="mathematics.html#cb766-13" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb766-14"><a href="mathematics.html#cb766-14" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb766-15"><a href="mathematics.html#cb766-15" tabindex="-1"></a><span class="co"># Third line</span></span>
<span id="cb766-16"><a href="mathematics.html#cb766-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb766-17"><a href="mathematics.html#cb766-17" tabindex="-1"></a>ar_atkinson_drv_richlswgt <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_random_var_ineq</span>(</span>
<span id="cb766-18"><a href="mathematics.html#cb766-18" tabindex="-1"></a>  ar_data_onerich, ar_drv_onerich_prob_richlswgt, row[<span class="dv">1</span>])})</span>
<span id="cb766-19"><a href="mathematics.html#cb766-19" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv_richlswgt,</span>
<span id="cb766-20"><a href="mathematics.html#cb766-20" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb766-21"><a href="mathematics.html#cb766-21" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb766-22"><a href="mathematics.html#cb766-22" tabindex="-1"></a><span class="co"># Fourth line</span></span>
<span id="cb766-23"><a href="mathematics.html#cb766-23" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)</span>
<span id="cb766-24"><a href="mathematics.html#cb766-24" tabindex="-1"></a>ar_atkinson_drv_richmrwgt <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_random_var_ineq</span>(</span>
<span id="cb766-25"><a href="mathematics.html#cb766-25" tabindex="-1"></a>  ar_data_onerich, ar_drv_onerich_prob_richmrwgt, row[<span class="dv">1</span>])})</span>
<span id="cb766-26"><a href="mathematics.html#cb766-26" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson_drv_richmrwgt,</span>
<span id="cb766-27"><a href="mathematics.html#cb766-27" tabindex="-1"></a>     <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb766-28"><a href="mathematics.html#cb766-28" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">col =</span> <span class="st">&#39;darkorange&#39;</span>)</span>
<span id="cb766-29"><a href="mathematics.html#cb766-29" tabindex="-1"></a><span class="co"># Title</span></span>
<span id="cb766-30"><a href="mathematics.html#cb766-30" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;One Person has Income of All Others Summed up Times 10&#39;</span>,</span>
<span id="cb766-31"><a href="mathematics.html#cb766-31" tabindex="-1"></a>      <span class="at">sub  =</span> <span class="st">&#39;Red=sample, Blue=drv, Oranges=more richest, Black=less richest&#39;</span>)</span>
<span id="cb766-32"><a href="mathematics.html#cb766-32" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-384-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="atkinson-inequality-with-an-uniform-distribution" class="section level5 hasAnchor" number="8.3.3.3.5">
<h5><span class="header-section-number">8.3.3.3.5</span> Atkinson Inequality with an Uniform Distribution<a href="mathematics.html#atkinson-inequality-with-an-uniform-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The Uniform Results, since allocations are uniform, zero for all.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="mathematics.html#cb767-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">FALSE</span>)</span>
<span id="cb767-2"><a href="mathematics.html#cb767-2" tabindex="-1"></a><span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="mathematics.html#cb769-1" tabindex="-1"></a>ar_atkinson <span class="ot">&lt;-</span> <span class="fu">apply</span>(mt_rho, <span class="dv">1</span>, <span class="cf">function</span>(row){<span class="fu">ffi_atkinson_ineq</span>(ar_data_unif, row[<span class="dv">1</span>])})</span>
<span id="cb769-2"><a href="mathematics.html#cb769-2" tabindex="-1"></a><span class="fu">plot</span>(ar_log_1_minus_rho, ar_atkinson, <span class="at">ylim =</span> ar_ylim, <span class="at">xlab =</span> st_x_label, <span class="at">ylab =</span> st_y_label)</span>
<span id="cb769-3"><a href="mathematics.html#cb769-3" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&#39;Atkinson Inequality and Uniform Distribution&#39;</span>)</span>
<span id="cb769-4"><a href="mathematics.html#cb769-4" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-385-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="analyzing-equation-mechanics" class="section level4 hasAnchor" number="8.3.3.4">
<h4><span class="header-section-number">8.3.3.4</span> Analyzing Equation Mechanics<a href="mathematics.html#analyzing-equation-mechanics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>How does the Aktinson Family utility function work? THe Atkinson Family Utility has the following functional form.</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
\alpha
\cdot
A^{\lambda}
+
\beta
\cdot
B^{\lambda}
\right)^{\frac{1}{\lambda}}
\]</span></p>
<p>Several key issues here:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(V^{\text{social}}\)</span> is the utility of some social planner</li>
<li><span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are allocations for Alex and Ben.</li>
<li><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are biases that a social planner has for Alex and Ben: <span class="math inline">\(\alpha+\beta=1\)</span>, <span class="math inline">\(\alpha&gt;0\)</span>, and <span class="math inline">\(\beta&gt;0\)</span></li>
<li><span class="math inline">\(-\infty &lt; \lambda \le 1\)</span> is a measure of inequality aversion
<ul>
<li><span class="math inline">\(\lambda=1\)</span> is when the planner cares about weighted total allocations (efficient, Utilitarian)</li>
<li><span class="math inline">\(\lambda=-\infty\)</span> is when the planner cares about only the minimum between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> allocations (equality, Rawlsian)</li>
</ul></li>
</ol>
<p>What if only care about Alex? Clearly, if the planner only cares about Ben, <span class="math inline">\(\beta=1\)</span>, then:</p>
<p><span class="math display">\[
V^{\text{social}}
=
\left(
B^{\lambda}
\right)^{\frac{1}{\lambda}}
= B
\]</span></p>
<p>Clearly, regardless of the value of <span class="math inline">\(\lambda\)</span>, as <span class="math inline">\(B\)</span> increases <span class="math inline">\(V\)</span> increases. What Happens to V when A or B increases? What is the derivative of <span class="math inline">\(V\)</span> with respect to <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>?</p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \frac{1}{\lambda}
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1}{\lambda}-1}
    \cdot
    \lambda
    \alpha
    A^{\lambda -1}
\]</span></p>
<p><span class="math display">\[
    \frac{\partial V}{\partial A}
    =
    \left(
    \alpha
    A^{\lambda}
    +
    \beta
    B^{\lambda}
    \right)^{\frac{1-\lambda}{\lambda}}
    \cdot
    \alpha
    A^{\lambda -1}
    &gt;0
\]</span></p>
<p>Note that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span>. When <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(Z^{\lambda}&gt;0\)</span>. For example <span class="math inline">\(10^{-2}=\frac{1}{100}\)</span>. And For example <span class="math inline">\(0.1^{\frac{3}{-2}}=\frac{1}{0.1^{1.5}}\)</span>. Still Positive.</p>
<p>While the overall <span class="math inline">\(V\)</span> increases with increasing <span class="math inline">\(A\)</span>, but if we did not have the outter power term, the situation is different. In particular, when <span class="math inline">\(\lambda &lt; 0\)</span>:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{d \left(\alpha A^{\lambda} + \beta B^{\lambda}\right)}{dA}=\alpha\lambda A^{\lambda -1}&lt;0
\]</span>
Without the outter <span class="math inline">\(\frac{1}{\lambda}\)</span> power, negative <span class="math inline">\(\lambda\)</span> would lead to decreasing weighted sum. But:
<span class="math display">\[
\text{ if } \lambda &lt;0
\thinspace\thinspace
\text{ then }
\thinspace\thinspace
\frac{dG^{\frac{1}{\lambda}}}{dG}=\frac{1}{\lambda}\cdot G^{\frac{1-\lambda}{\lambda}}&lt;0
\]</span>
so when <span class="math inline">\(G\)</span> is increasing and <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> would decrease. But when <span class="math inline">\(G\left(A,B\right)\)</span> is decreasing, as is the case with increasing <span class="math inline">\(A\)</span> when <span class="math inline">\(\lambda &lt;0\)</span>, <span class="math inline">\(V\)</span> will actually increase. This confirms that <span class="math inline">\(\frac{\partial V}{\partial A}&gt;0\)</span> for <span class="math inline">\(\lambda &lt;0\)</span>. The result is symmetric for <span class="math inline">\(\lambda &gt;0\)</span>.</p>
</div>
<div id="indifference-curve-graph" class="section level4 hasAnchor" number="8.3.3.5">
<h4><span class="header-section-number">8.3.3.5</span> Indifference Curve Graph<a href="mathematics.html#indifference-curve-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given <span class="math inline">\(V^{\ast}\)</span>, we can show the combinations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> points that provide the same utility. We want to be able to potentially draw multiple indifference curves at the same time. Note that indifference curves are defined by <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\lambda\)</span> only. Each indifference curve is a set of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> coordinates. So to generate multiple indifference curves means to generate many sets of <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> associated with different planner preferences, and then these could be graphed out.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="mathematics.html#cb770-1" tabindex="-1"></a><span class="co"># A as x-axis, need bounds on A</span></span>
<span id="cb770-2"><a href="mathematics.html#cb770-2" tabindex="-1"></a>fl_A_min <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb770-3"><a href="mathematics.html#cb770-3" tabindex="-1"></a>fl_A_max <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb770-4"><a href="mathematics.html#cb770-4" tabindex="-1"></a>it_A_grid <span class="ot">=</span> <span class="dv">50000</span></span>
<span id="cb770-5"><a href="mathematics.html#cb770-5" tabindex="-1"></a></span>
<span id="cb770-6"><a href="mathematics.html#cb770-6" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb770-7"><a href="mathematics.html#cb770-7" tabindex="-1"></a><span class="co"># ar_lambda &lt;- 1 - (10^(c(seq(-2,2, length.out=3))))</span></span>
<span id="cb770-8"><a href="mathematics.html#cb770-8" tabindex="-1"></a>ar_lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.06</span>, <span class="sc">-</span><span class="dv">6</span>)</span>
<span id="cb770-9"><a href="mathematics.html#cb770-9" tabindex="-1"></a>ar_beta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="at">length.out =</span> <span class="dv">3</span>)</span>
<span id="cb770-10"><a href="mathematics.html#cb770-10" tabindex="-1"></a>ar_beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>)</span>
<span id="cb770-11"><a href="mathematics.html#cb770-11" tabindex="-1"></a>ar_v_star <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">1</span>)</span>
<span id="cb770-12"><a href="mathematics.html#cb770-12" tabindex="-1"></a>tb_pref <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_lambda)) <span class="sc">%&gt;%</span></span>
<span id="cb770-13"><a href="mathematics.html#cb770-13" tabindex="-1"></a>  <span class="fu">expand_grid</span>(ar_beta) <span class="sc">%&gt;%</span> <span class="fu">expand_grid</span>(ar_v_star) <span class="sc">%&gt;%</span></span>
<span id="cb770-14"><a href="mathematics.html#cb770-14" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(<span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb770-15"><a href="mathematics.html#cb770-15" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;indiff_id&quot;</span>)</span>
<span id="cb770-16"><a href="mathematics.html#cb770-16" tabindex="-1"></a></span>
<span id="cb770-17"><a href="mathematics.html#cb770-17" tabindex="-1"></a><span class="co"># Generate indifference points with apply and anonymous function</span></span>
<span id="cb770-18"><a href="mathematics.html#cb770-18" tabindex="-1"></a><span class="co"># tb_pref, whatever is selected from it, must be all numeric</span></span>
<span id="cb770-19"><a href="mathematics.html#cb770-19" tabindex="-1"></a><span class="co"># if there are strings, would cause conversion error.</span></span>
<span id="cb770-20"><a href="mathematics.html#cb770-20" tabindex="-1"></a>ls_df_indiff <span class="ot">&lt;-</span> <span class="fu">apply</span>(tb_pref, <span class="dv">1</span>, <span class="cf">function</span>(x){</span>
<span id="cb770-21"><a href="mathematics.html#cb770-21" tabindex="-1"></a>  indiff_id <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb770-22"><a href="mathematics.html#cb770-22" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb770-23"><a href="mathematics.html#cb770-23" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb770-24"><a href="mathematics.html#cb770-24" tabindex="-1"></a>  vstar <span class="ot">&lt;-</span> x[<span class="dv">4</span>]</span>
<span id="cb770-25"><a href="mathematics.html#cb770-25" tabindex="-1"></a>  ar_fl_A_indiff <span class="ot">&lt;-</span> <span class="fu">seq</span>(fl_A_min, fl_A_max, <span class="at">length.out=</span>it_A_grid)</span>
<span id="cb770-26"><a href="mathematics.html#cb770-26" tabindex="-1"></a>  ar_fl_B_indiff <span class="ot">&lt;-</span> (((vstar<span class="sc">^</span>lambda) <span class="sc">-</span></span>
<span id="cb770-27"><a href="mathematics.html#cb770-27" tabindex="-1"></a>                        (beta<span class="sc">*</span>ar_fl_A_indiff<span class="sc">^</span>(lambda)))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>beta))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb770-28"><a href="mathematics.html#cb770-28" tabindex="-1"></a>  mt_A_B_indiff <span class="ot">&lt;-</span> <span class="fu">cbind</span>(indiff_id, lambda, beta, vstar,</span>
<span id="cb770-29"><a href="mathematics.html#cb770-29" tabindex="-1"></a>                         ar_fl_A_indiff, ar_fl_B_indiff)</span>
<span id="cb770-30"><a href="mathematics.html#cb770-30" tabindex="-1"></a>  <span class="fu">colnames</span>(mt_A_B_indiff) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;indiff_id&#39;</span>, <span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;beta&#39;</span>, <span class="st">&#39;vstar&#39;</span>,</span>
<span id="cb770-31"><a href="mathematics.html#cb770-31" tabindex="-1"></a>                               <span class="st">&#39;indiff_A&#39;</span>, <span class="st">&#39;indiff_B&#39;</span>)</span>
<span id="cb770-32"><a href="mathematics.html#cb770-32" tabindex="-1"></a>  tb_A_B_indiff <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_A_B_indiff) <span class="sc">%&gt;%</span></span>
<span id="cb770-33"><a href="mathematics.html#cb770-33" tabindex="-1"></a>    <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;A_grid_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb770-34"><a href="mathematics.html#cb770-34" tabindex="-1"></a>    <span class="fu">filter</span>(indiff_B <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> indiff_B <span class="sc">&lt;=</span> <span class="fu">max</span>(ar_fl_A_indiff))</span>
<span id="cb770-35"><a href="mathematics.html#cb770-35" tabindex="-1"></a>  <span class="fu">return</span>(tb_A_B_indiff)</span>
<span id="cb770-36"><a href="mathematics.html#cb770-36" tabindex="-1"></a>})</span>
<span id="cb770-37"><a href="mathematics.html#cb770-37" tabindex="-1"></a>df_indiff <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, ls_df_indiff) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code></pre></div>
<p>Note that many more A grid points are needed to fully plot out the leontief line.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="mathematics.html#cb771-1" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb771-2"><a href="mathematics.html#cb771-2" tabindex="-1"></a>st_title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Indifference Curves Aktinson Atkinson Utility (CES)&#39;</span>)</span>
<span id="cb771-3"><a href="mathematics.html#cb771-3" tabindex="-1"></a>st_subtitle <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Each Panel Different beta=A</span><span class="sc">\&#39;</span><span class="st">s Weight lambda=inequality aversion</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb771-4"><a href="mathematics.html#cb771-4" tabindex="-1"></a>                      <span class="st">&#39;https://fanwangecon.github.io/&#39;</span>,</span>
<span id="cb771-5"><a href="mathematics.html#cb771-5" tabindex="-1"></a>                      <span class="st">&#39;R4Econ/math/func_ineq/htmlpdfr/fs_atkinson_ces.html&#39;</span>)</span>
<span id="cb771-6"><a href="mathematics.html#cb771-6" tabindex="-1"></a>st_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Indifference Curve 2 Individuals, &#39;</span>,</span>
<span id="cb771-7"><a href="mathematics.html#cb771-7" tabindex="-1"></a>                     <span class="st">&#39;https://fanwangecon.github.io/R4Econ/&#39;</span>)</span>
<span id="cb771-8"><a href="mathematics.html#cb771-8" tabindex="-1"></a>st_x_label <span class="ot">&lt;-</span> <span class="st">&#39;A&#39;</span></span>
<span id="cb771-9"><a href="mathematics.html#cb771-9" tabindex="-1"></a>st_y_label <span class="ot">&lt;-</span> <span class="st">&#39;B&#39;</span></span>
<span id="cb771-10"><a href="mathematics.html#cb771-10" tabindex="-1"></a></span>
<span id="cb771-11"><a href="mathematics.html#cb771-11" tabindex="-1"></a><span class="co"># Graphing</span></span>
<span id="cb771-12"><a href="mathematics.html#cb771-12" tabindex="-1"></a>plt_indiff <span class="ot">&lt;-</span></span>
<span id="cb771-13"><a href="mathematics.html#cb771-13" tabindex="-1"></a>  df_indiff <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">lambda =</span> <span class="fu">as_factor</span>(lambda),</span>
<span id="cb771-14"><a href="mathematics.html#cb771-14" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fu">as_factor</span>(beta),</span>
<span id="cb771-15"><a href="mathematics.html#cb771-15" tabindex="-1"></a>                       <span class="at">vstar =</span> <span class="fu">as_factor</span>(vstar)) <span class="sc">%&gt;%</span></span>
<span id="cb771-16"><a href="mathematics.html#cb771-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>indiff_A, <span class="at">y=</span>indiff_B,</span>
<span id="cb771-17"><a href="mathematics.html#cb771-17" tabindex="-1"></a>             <span class="at">colour=</span>lambda)) <span class="sc">+</span></span>
<span id="cb771-18"><a href="mathematics.html#cb771-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> beta) <span class="sc">+</span></span>
<span id="cb771-19"><a href="mathematics.html#cb771-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb771-20"><a href="mathematics.html#cb771-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> st_title, <span class="at">subtitle =</span> st_subtitle,</span>
<span id="cb771-21"><a href="mathematics.html#cb771-21" tabindex="-1"></a>       <span class="at">x =</span> st_x_label, <span class="at">y =</span> st_y_label, <span class="at">caption =</span> st_caption) <span class="sc">+</span></span>
<span id="cb771-22"><a href="mathematics.html#cb771-22" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb771-23"><a href="mathematics.html#cb771-23" tabindex="-1"></a></span>
<span id="cb771-24"><a href="mathematics.html#cb771-24" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb771-25"><a href="mathematics.html#cb771-25" tabindex="-1"></a><span class="fu">print</span>(plt_indiff)</span></code></pre></div>
<p><img src="Panel-Data-and-Optimization-with-R_files/figure-html/unnamed-chunk-387-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="optimization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Panel-Data-and-Optimization-with-R.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
